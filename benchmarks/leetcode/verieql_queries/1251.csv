qid,mysql_can_execute?,mysql_correct?,mysql_query
0,Y,Y,"SELECT A.PRODUCT_ID, ROUND(SUM(UNITS * PRICE) / SUM(UNITS), 2) AS AVERAGE_PRICE FROM PRICES A INNER JOIN UNITSSOLD B ON A.PRODUCT_ID=B.PRODUCT_ID AND B.PURCHASE_DATE BETWEEN A.START_DATE AND A.END_DATE GROUP BY A.PRODUCT_ID"
1,Y,Y,"SELECT A.PRODUCT_ID, ROUND(SUM(A.PRICE * B.UNITS) / SUM(B.UNITS), 2 ) AS AVERAGE_PRICE FROM PRICES AS A LEFT JOIN UNITSSOLD AS B ON A.PRODUCT_ID = B.PRODUCT_ID WHERE B.PURCHASE_DATE >= A.START_DATE AND B.PURCHASE_DATE <= A.END_DATE GROUP BY A.PRODUCT_ID"
2,Y,Y,"SELECT A.PRODUCT_ID, ROUND(SUM(A.PRICE * B.UNITS) / SUM(B.UNITS), 2 ) AS AVERAGE_PRICE FROM PRICES AS A LEFT JOIN UNITSSOLD AS B ON A.PRODUCT_ID = B.PRODUCT_ID WHERE B.PURCHASE_DATE BETWEEN A.START_DATE AND A.END_DATE GROUP BY A.PRODUCT_ID"
3,Y,N,"SELECT B.PRODUCT_ID, ROUND(SUM(B.UNITS*A.PRICE)/SUM(B.UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD B LEFT JOIN PRICES A ON A.PRODUCT_ID = B.PRODUCT_ID AND A.START_DATE <= B.PURCHASE_DATE AND B.PURCHASE_DATE <= A.END_DATE GROUP BY 1"
4,Y,Y,"SELECT DISTINCT P.PRODUCT_ID, ROUND((SUM(P.PRICE * US.UNITS) / SUM(US.UNITS)), 2) AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD US ON P.PRODUCT_ID = US.PRODUCT_ID AND US.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
5,Y,Y,"SELECT DISTINCT P.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY 1"
6,Y,N,"SELECT DISTINCT U.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD U LEFT JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY U.PRODUCT_ID"
7,Y,Y,"SELECT P.PRODUCT_ID ,ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD U ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
8,Y,Y,"SELECT P.PRODUCT_ID, ROUND( SUM(UNITS * PRICE) / SUM(UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD AS S JOIN PRICES AS P ON S.PRODUCT_ID = P.PRODUCT_ID AND (S.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) GROUP BY P.PRODUCT_ID"
9,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE * U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND (U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) GROUP BY PRODUCT_ID"
10,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE * U.UNITS)/ SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM PRICES AS P JOIN UNITSSOLD AS U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
11,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
12,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
13,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(U.UNITS *P.PRICE)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND(U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) GROUP BY PRODUCT_ID"
14,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(U.UNITS*P.PRICE) / SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID ORDER BY P.PRODUCT_ID ASC"
15,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE * U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD U JOIN PRICES P ON (P.PRODUCT_ID=U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) GROUP BY P.PRODUCT_ID"
16,Y,Y,"SELECT PRICES.PRODUCT_ID, ROUND((SUM(PRICE * UNITS) / SUM(UNITS)),2) AS AVERAGE_PRICE FROM PRICES INNER JOIN UNITSSOLD ON UNITSSOLD.PRODUCT_ID = PRICES.PRODUCT_ID WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRODUCT_ID"
17,Y,Y,"SELECT PRICES.PRODUCT_ID, ROUND(SUM(PRICES.PRICE * UNITSSOLD.UNITS) / SUM(UNITSSOLD.UNITS), 2) AS AVERAGE_PRICE FROM PRICES LEFT JOIN UNITSSOLD ON PRICES.PRODUCT_ID = UNITSSOLD.PRODUCT_ID AND PRICES.START_DATE <= UNITSSOLD.PURCHASE_DATE AND UNITSSOLD.PURCHASE_DATE <= PRICES.END_DATE GROUP BY PRICES.PRODUCT_ID"
18,Y,Y,"SELECT PRICES.PRODUCT_ID, ROUND(SUM(UNITSSOLD.UNITS * PRICES.PRICE) / SUM(UNITSSOLD.UNITS), 2) AS AVERAGE_PRICE FROM PRICES LEFT JOIN UNITSSOLD ON PRICES.PRODUCT_ID = UNITSSOLD.PRODUCT_ID AND UNITSSOLD.PURCHASE_DATE BETWEEN PRICES.START_DATE AND PRICES.END_DATE GROUP BY PRICES.PRODUCT_ID"
19,Y,Y,"SELECT PRICES.PRODUCT_ID, ROUND(SUM(PRICE * UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES INNER JOIN UNITSSOLD ON PRICES.PRODUCT_ID = UNITSSOLD.PRODUCT_ID WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRICES.PRODUCT_ID"
20,Y,Y,"SELECT PRICES.PRODUCT_ID, ROUND(SUM(UNITS*PRICE) / SUM(UNITS), 2) AVERAGE_PRICE FROM PRICES JOIN UNITSSOLD US ON PRICES.PRODUCT_ID = US.PRODUCT_ID AND US.PURCHASE_DATE BETWEEN PRICES.START_DATE AND PRICES.END_DATE GROUP BY PRICES.PRODUCT_ID"
21,Y,Y,"SELECT PRICES.PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/ SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES INNER JOIN UNITSSOLD ON PRICES.PRODUCT_ID = UNITSSOLD.PRODUCT_ID AND (UNITSSOLD.PURCHASE_DATE BETWEEN PRICES.START_DATE AND PRICES.END_DATE) GROUP BY PRICES.PRODUCT_ID"
22,Y,Y,"SELECT T.ID AS PRODUCT_ID, ROUND(SUM(T.UNIT*T.PRICE)/SUM(T.UNIT), 2) AS AVERAGE_PRICE FROM (SELECT U.PRODUCT_ID AS ID, U.UNITS AS UNIT, P.PRICE AS PRICE FROM PRICES AS P, UNITSSOLD AS U WHERE (U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) AND P.PRODUCT_ID = U.PRODUCT_ID ) AS T GROUP BY T.ID"
23,Y,Y,"SELECT T.PRODUCT_ID, ROUND(SUM(T.TOTAL_PRICE)/SUM(T.UNITS),2) AS AVERAGE_PRICE FROM ( SELECT P.PRODUCT_ID, (UNITS*PRICE) AS TOTAL_PRICE, PRICE, UNITS FROM PRICES AS P JOIN UNITSSOLD AS US ON P.PRODUCT_ID = US.PRODUCT_ID WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE ) AS T GROUP BY T.PRODUCT_ID"
24,Y,Y,"SELECT T.PRODUCT_ID, ROUND(TOTAL_P/TOTAL_Q,2) AS AVERAGE_PRICE FROM ( SELECT P.PRODUCT_ID, SUM(PRICE*UNITS) AS TOTAL_P, SUM(UNITS) AS TOTAL_Q FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY P.PRODUCT_ID) T ORDER BY T.PRODUCT_ID"
25,Y,Y,"SELECT U.PRODUCT_ID , ROUND(SUM(U.UNITS*P.PRICE)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD U JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY U.PRODUCT_ID ORDER BY U.PRODUCT_ID"
26,Y,Y,"SELECT U.PRODUCT_ID , ROUND(SUM(U.UNITS*P.PRICE)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD U LEFT JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY U.PRODUCT_ID ORDER BY U.PRODUCT_ID"
27,Y,Y,"SELECT U.PRODUCT_ID, ROUND((SUM(U.UNITS*P.PRICE)/SUM(U.UNITS)),2) AS AVERAGE_PRICE FROM UNITSSOLD AS U INNER JOIN PRICES AS P ON U.PRODUCT_ID=P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY U.PRODUCT_ID"
28,Y,Y,"SELECT UNITSSOLD.PRODUCT_ID, ROUND(SUM(PRICES.PRICE * UNITSSOLD.UNITS) / SUM(UNITSSOLD.UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD INNER JOIN PRICES ON UNITSSOLD.PRODUCT_ID = PRICES.PRODUCT_ID AND (UNITSSOLD.PURCHASE_DATE BETWEEN PRICES.START_DATE AND PRICES.END_DATE) GROUP BY UNITSSOLD.PRODUCT_ID"
29,Y,Y,"SELECT A.PRODUCT_ID , ROUND(SUM(B.UNITS*A.PRICE)/SUM(B.UNITS),2) AS AVERAGE_PRICE FROM PRICES AS A JOIN UNITSSOLD AS B ON A.PRODUCT_ID=B.PRODUCT_ID AND (B.PURCHASE_DATE BETWEEN A.START_DATE AND A.END_DATE) GROUP BY PRODUCT_ID"
30,Y,Y,"SELECT A.PRODUCT_ID AS PRODUCT_ID, ROUND(SUM(A.UNITS * B.PRICE)/SUM(A.UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD A JOIN PRICES B ON A.PRODUCT_ID = B.PRODUCT_ID AND A.PURCHASE_DATE BETWEEN B.START_DATE AND B.END_DATE GROUP BY 1"
31,Y,N,"SELECT A.PRODUCT_ID, ROUND(CAST(SUM(A.UNITS*B.PRICE) AS DECIMAL (7,2))/CAST(SUM(A.UNITS) AS DECIMAL (7,2)),2) AS AVERAGE_PRICE FROM UNITSSOLD A LEFT JOIN PRICES B ON A.PRODUCT_ID=B.PRODUCT_ID AND A.PURCHASE_DATE BETWEEN B.START_DATE AND B.END_DATE GROUP BY A.PRODUCT_ID"
32,Y,Y,"SELECT A.PRODUCT_ID, ROUND(SUM(A.PRICE*B.UNITS)/SUM(B.UNITS),2) AS AVERAGE_PRICE FROM PRICES A JOIN UNITSSOLD B ON A.PRODUCT_ID=B.PRODUCT_ID AND B.PURCHASE_DATE BETWEEN A.START_DATE AND A.END_DATE GROUP BY PRODUCT_ID"
33,Y,N,"SELECT A.PRODUCT_ID, ROUND(SUM(A.UNITS*B.PRICE) / SUM(A.UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD A LEFT JOIN PRICES B ON A.PRODUCT_ID = B.PRODUCT_ID AND A.PURCHASE_DATE BETWEEN B.START_DATE AND B.END_DATE GROUP BY 1"
34,Y,Y,"SELECT A.PRODUCT_ID, ROUND(SUM(A.UNITS*B.PRICE)/SUM(A.UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD A INNER JOIN PRICES B ON A.PRODUCT_ID=B.PRODUCT_ID AND A.PURCHASE_DATE BETWEEN B.START_DATE AND B.END_DATE GROUP BY 1 ORDER BY 1"
35,Y,Y,"SELECT A.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AVERAGE_PRICE FROM UNITSSOLD A JOIN PRICES B ON A.PRODUCT_ID = B.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY 1"
36,Y,Y,"SELECT A.PRODUCT_ID, ROUND((SUM(A.PRICE*B.UNITS)+0.00)/(SUM(B.UNITS)+0.00), 2) AS AVERAGE_PRICE FROM PRICES A INNER JOIN UNITSSOLD B USING(PRODUCT_ID) WHERE B.PURCHASE_DATE BETWEEN A.START_DATE AND A.END_DATE GROUP BY A.PRODUCT_ID"
37,Y,Y,"SELECT A.PRODUCT_ID, ROUND(SUM(A.PRICE*B.UNITS)/SUM(B.UNITS), 2) AS AVERAGE_PRICE FROM PRICES A INNER JOIN UNITSSOLD B USING(PRODUCT_ID) WHERE B.PURCHASE_DATE BETWEEN A.START_DATE AND A.END_DATE GROUP BY A.PRODUCT_ID"
38,Y,Y,"SELECT A.PRODUCT_ID,ROUND(SUM(B.UNITS*A.PRICE)/SUM(B.UNITS),2) AS AVERAGE_PRICE FROM PRICES AS A INNER JOIN UNITSSOLD AS B ON A.PRODUCT_ID=B.PRODUCT_ID AND (B.PURCHASE_DATE BETWEEN A.START_DATE AND A.END_DATE) GROUP BY PRODUCT_ID"
39,Y,Y,"SELECT A.PRODUCT_ID,ROUND(SUM(B.UNITS*A.PRICE)/SUM(B.UNITS),2) AS AVERAGE_PRICE FROM PRICES AS A JOIN UNITSSOLD AS B WHERE A.PRODUCT_ID=B.PRODUCT_ID AND (B.PURCHASE_DATE BETWEEN A.START_DATE AND A.END_DATE) GROUP BY PRODUCT_ID"
40,Y,Y,"SELECT A.PRODUCT_ID,ROUND(SUM(B.UNITS*A.PRICE)/SUM(B.UNITS),2) AS AVERAGE_PRICE FROM PRICES AS A LEFT JOIN UNITSSOLD AS B ON A.PRODUCT_ID=B.PRODUCT_ID AND (B.PURCHASE_DATE BETWEEN A.START_DATE AND A.END_DATE) GROUP BY PRODUCT_ID"
41,Y,Y,"SELECT A.PRODUCT_ID,ROUND(SUM(A.PRICE*B.UNITS)/SUM(B.UNITS),2) AS AVERAGE_PRICE FROM PRICES A JOIN UNITSSOLD B ON A.PRODUCT_ID=B.PRODUCT_ID AND B.PURCHASE_DATE BETWEEN A.START_DATE AND A.END_DATE GROUP BY A.PRODUCT_ID"
42,Y,Y,"SELECT DISTINCT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS) ,2) AS AVERAGE_PRICE FROM PRICES AS P LEFT JOIN UNITSSOLD AS U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
43,Y,Y,"SELECT P.PRODUCT_ID ,ROUND(SUM(P.PRICE * U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY 1"
44,Y,Y,"SELECT P.PRODUCT_ID AS PRODUCT_ID , ROUND(SUM(PRICE*UNITS) / SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
45,Y,Y,"SELECT P.PRODUCT_ID AS PRODUCT_ID, ROUND((SUM(U.UNITS*P.PRICE)/SUM(U.UNITS)),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND (U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) GROUP BY P.PRODUCT_ID"
46,Y,N,"SELECT P.PRODUCT_ID AS PRODUCT_ID, ROUND(SUM(UNITS * PRICE) / SUM(UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD US LEFT JOIN PRICES P ON US.PRODUCT_ID = P.PRODUCT_ID AND P.START_DATE <= US.PURCHASE_DATE AND P.END_DATE >= US.PURCHASE_DATE GROUP BY P.PRODUCT_ID ORDER BY P.PRODUCT_ID"
47,Y,Y,"SELECT P.PRODUCT_ID PRODUCT_ID, ROUND((SUM(U.UNITS*P.PRICE) / SUM(U.UNITS)),2) AVERAGE_PRICE FROM UNITSSOLD U JOIN PRICES P ON P.PRODUCT_ID = U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY 1"
48,Y,Y,"SELECT P.PRODUCT_ID, CAST(SUM(SOLD.UNITS * P.PRICE)/SUM(SOLD.UNITS) AS DECIMAL(18,2)) AS AVERAGE_PRICE FROM UNITSSOLD SOLD INNER JOIN PRICES P ON P.PRODUCT_ID = SOLD.PRODUCT_ID AND SOLD.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY PRODUCT_ID"
49,Y,Y,"SELECT P.PRODUCT_ID, IFNULL(ROUND((SUM(P.PRICE * U.UNITS) / SUM(U.UNITS)), 2), 0) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE U.PURCHASE_DATE <= P.END_DATE AND U.PURCHASE_DATE >= P.START_DATE GROUP BY P.PRODUCT_ID ORDER BY 1"
50,Y,Y,"SELECT P.PRODUCT_ID, ROUND((SUM(P.PRICE * S.UNITS) / SUM(S.UNITS)), 2) AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD S ON P.PRODUCT_ID = S.PRODUCT_ID AND S.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY PRODUCT_ID"
51,Y,Y,"SELECT P.PRODUCT_ID, ROUND((SUM(P.PRICE * U.UNITS) / SUM(U.UNITS)), 2) AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON (P.PRODUCT_ID = U.PRODUCT_ID) AND (U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) GROUP BY 1"
52,Y,Y,"SELECT P.PRODUCT_ID, ROUND((SUM(P.PRICE * U.UNITS) / SUM(U.UNITS)), 2) AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
53,Y,Y,"SELECT P.PRODUCT_ID, ROUND((SUM(P.PRICE * US.UNITS) / SUM(US.UNITS)), 2) AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD US ON P.PRODUCT_ID = US.PRODUCT_ID AND US.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
54,Y,Y,"SELECT P.PRODUCT_ID, ROUND((SUM(P.PRICE * US.UNITS) / SUM(US.UNITS)), 2) AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD US ON P.PRODUCT_ID = US.PRODUCT_ID AND US.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
55,Y,Y,"SELECT P.PRODUCT_ID, ROUND((SUM(U.UNITS * P.PRICE) / SUM(U.UNITS)), 2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
56,Y,Y,"SELECT P.PRODUCT_ID, ROUND(IFNULL(SUM(P.PRICE*U.UNITS) / SUM(U.UNITS),0),2) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
57,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE * U.UNITS) / SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY PRODUCT_ID"
58,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE * U.UNITS) / SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM PRICES P, UNITSSOLD U WHERE P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE >= P.START_DATE AND U.PURCHASE_DATE <= P.END_DATE GROUP BY P.PRODUCT_ID"
59,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE * US.UNITS) / SUM(US.UNITS), 2) AS AVERAGE_PRICE FROM PRICES AS P LEFT OUTER JOIN UNITSSOLD AS US ON P.PRODUCT_ID = US.PRODUCT_ID AND P.START_DATE <= US.PURCHASE_DATE AND US.PURCHASE_DATE <= P.END_DATE GROUP BY P.PRODUCT_ID"
60,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID AND (U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) GROUP BY P.PRODUCT_ID"
61,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE DATE(PURCHASE_DATE) BETWEEN DATE(START_DATE) AND DATE(END_DATE) GROUP BY PRODUCT_ID"
62,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
63,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE * UNITS) / SUM(UNITS), 2) AS AVERAGE_PRICE FROM PRICES AS P LEFT JOIN UNITSSOLD AS U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY P.PRODUCT_ID"
64,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE * UNITS) / SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE >= START_DATE AND U.PURCHASE_DATE <= END_DATE GROUP BY 1"
65,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS), 2) AS AVERAGE_PRICE FROM PRICES AS P JOIN UNITSSOLD AS U ON P.PRODUCT_ID = U.PRODUCT_ID AND (U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) GROUP BY P.PRODUCT_ID"
66,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS), 2) AS AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY P.PRODUCT_ID"
67,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(U.UNITS * P.PRICE) / SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES AS P LEFT JOIN UNITSSOLD AS U ON (P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) GROUP BY P.PRODUCT_ID"
68,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(U.UNITS * P.PRICE)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
69,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(U.UNITS*P.PRICE) / SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
70,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(U.UNITS*P.PRICE)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND (U.PURCHASE_DATE BETWEEN P.START_DATE AND END_DATE) GROUP BY PRODUCT_ID"
71,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/SUM(UNITS), 2) AS AVERAGE_PRICE FROM PRICES AS P JOIN UNITSSOLD AS S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY P.PRODUCT_ID"
72,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE * U.UNITS)/SUM(U.UNITS), 2) AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND (U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) GROUP BY P.PRODUCT_ID"
73,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE * U.UNITS) / SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
74,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON U.PRODUCT_ID=P.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY P.PRODUCT_ID"
75,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(U.UNITS*P.PRICE)/SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND (U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) GROUP BY P.PRODUCT_ID"
76,Y,Y,"SELECT P.PRODUCT_ID,ROUND(SUM(U.UNITS*P.PRICE)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES AS P JOIN UNITSSOLD AS U ON P.PRODUCT_ID=U.PRODUCT_ID AND (U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) GROUP BY PRODUCT_ID"
77,Y,Y,"SELECT PRICES.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES JOIN UNITSSOLD ON PRICES.PRODUCT_ID = UNITSSOLD.PRODUCT_ID AND UNITSSOLD.PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRICES.PRODUCT_ID"
78,Y,Y,"SELECT PRODUCT_ID, CAST(SUM(TOTAL_PRICE) / SUM(TOTAL_UNITS) AS DECIMAL(10, 2)) AS AVERAGE_PRICE FROM ( SELECT P.PRODUCT_ID AS PRODUCT_ID, P.PRICE * U.UNITS AS TOTAL_PRICE, U.UNITS AS TOTAL_UNITS FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE >= P.START_DATE AND U.PURCHASE_DATE <= END_DATE ) AS S GROUP BY S.PRODUCT_ID"
79,Y,Y,"SELECT PRODUCT_ID, CAST(SUM(TOTAL_PRICE) / SUM(TOTAL_UNITS) AS DECIMAL(10, 2)) AS AVERAGE_PRICE FROM ( SELECT P.PRODUCT_ID AS PRODUCT_ID, P.PRICE * U.UNITS AS TOTAL_PRICE, U.UNITS AS TOTAL_UNITS FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE ) AS S GROUP BY S.PRODUCT_ID"
80,Y,Y,"SELECT PRODUCT_ID, IFNULL(ROUND(SUM(TEMP_SUM)/SUM(UNITS),2),0) AS AVERAGE_PRICE FROM ( SELECT P1.PRODUCT_ID, (P1.PRICE * U1.UNITS) AS TEMP_SUM, U1.UNITS FROM PRICES P1 JOIN UNITSSOLD U1 ON P1.PRODUCT_ID = U1.PRODUCT_ID AND U1.PURCHASE_DATE BETWEEN P1.START_DATE AND P1.END_DATE) A GROUP BY A.PRODUCT_ID"
81,Y,Y,"SELECT PRODUCT_ID, ROUND(SUM(TEMP_SUM)/SUM(UNITS),2) AS AVERAGE_PRICE FROM ( SELECT P1.PRODUCT_ID, (P1.PRICE * U1.UNITS) AS TEMP_SUM, U1.UNITS FROM PRICES P1 JOIN UNITSSOLD U1 ON P1.PRODUCT_ID = U1.PRODUCT_ID AND U1.PURCHASE_DATE BETWEEN P1.START_DATE AND P1.END_DATE) A GROUP BY A.PRODUCT_ID"
82,Y,Y,"SELECT PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM (SELECT U.PRODUCT_ID, U.UNITS, P.PRICE FROM UNITSSOLD U LEFT JOIN PRICES P USING(PRODUCT_ID) WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) SUB GROUP BY PRODUCT_ID"
83,Y,Y,"SELECT PRODUCT_ID, ROUND(SUM(A) / SUM(UNITS), 2) AS AVERAGE_PRICE FROM (SELECT P.PRODUCT_ID AS PRODUCT_ID, PRICE, UNITS, PRICE * UNITS AS A FROM PRICES AS P LEFT JOIN UNITSSOLD AS U ON P.PRODUCT_ID = U.PRODUCT_ID AND (PURCHASE_DATE <= END_DATE AND PURCHASE_DATE >= START_DATE) ) AS T GROUP BY PRODUCT_ID"
84,Y,Y,"SELECT PRODUCT_ID, ROUND(TOTAL_COST/UNITS, 2) AS AVERAGE_PRICE FROM (SELECT P.PRODUCT_ID, SUM(UNITS*PRICE) AS TOTAL_COST, SUM(UNITS) AS UNITS FROM PRICES P JOIN UNITSSOLD U ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE >= P.START_DATE AND U.PURCHASE_DATE <= P.END_DATE GROUP BY PRODUCT_ID) AS T"
85,Y,Y,"SELECT PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES LEFT JOIN UNITSSOLD USING(PRODUCT_ID) WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRODUCT_ID"
86,Y,Y,"SELECT T1.PRODUCT_ID , ROUND(SUM(T2.UNITS*T1.PRICE)/SUM(T2.UNITS),2) AS AVERAGE_PRICE FROM PRICES AS T1 INNER JOIN UNITSSOLD AS T2 USING(PRODUCT_ID) WHERE T2.PURCHASE_DATE BETWEEN T1.START_DATE AND T1.END_DATE GROUP BY PRODUCT_ID"
87,Y,Y,"SELECT U.PRODUCT_ID, ROUND((SUM(U.UNITS*P.PRICE) / SUM(U.UNITS)), 2) AS AVERAGE_PRICE FROM UNITSSOLD U JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE >= P.START_DATE AND U.PURCHASE_DATE <= P.END_DATE GROUP BY U.PRODUCT_ID"
88,Y,N,"SELECT U.PRODUCT_ID, ROUND(SUM(P.PRICE * U.UNITS) / SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD U LEFT JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY U.PRODUCT_ID"
89,Y,Y,"SELECT U.PRODUCT_ID, ROUND(SUM(P.PRICE * U.UNITS)/SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY 1"
90,Y,Y,"SELECT U.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD U JOIN PRICES P ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY U.PRODUCT_ID"
91,Y,N,"SELECT U.PRODUCT_ID, ROUND(SUM(PRICE * UNITS) / SUM(UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD U LEFT JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND (PURCHASE_DATE BETWEEN START_DATE AND END_DATE) GROUP BY U.PRODUCT_ID"
92,Y,Y,"SELECT U.PRODUCT_ID, ROUND(SUM(U.UNITS * P.PRICE) / SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD U LEFT JOIN PRICES P ON P.PRODUCT_ID = U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY U.PRODUCT_ID"
93,Y,N,"SELECT U.PRODUCT_ID, ROUND(SUM(U.UNITS * P.PRICE) / SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD U LEFT JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY 1"
94,Y,Y,"SELECT U.PRODUCT_ID, ROUND(SUM(U.UNITS*P.PRICE)/ SUM(U.UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD U JOIN PRICES P ON (U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) AND P.PRODUCT_ID = U.PRODUCT_ID GROUP BY U.PRODUCT_ID"
95,Y,Y,"SELECT U.PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/SUM(UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD U JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY U.PRODUCT_ID"
96,Y,Y,"SELECT U.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/ SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID AND (PURCHASE_DATE BETWEEN START_DATE AND END_DATE) GROUP BY 1"
97,Y,N,"SELECT U.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2)AS AVERAGE_PRICE FROM UNITSSOLD U LEFT JOIN PRICES P ON U.PRODUCT_ID=P.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY U.PRODUCT_ID"
98,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(U.UNITS*P.PRICE) / SUM(U.UNITS) , 2) AS AVERAGE_PRICE FROM PRICES AS P INNER JOIN UNITSSOLD AS U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY PRODUCT_ID"
99,Y,Y,"SELECT PRICES.PRODUCT_ID,ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES INNER JOIN UNITSSOLD USING(PRODUCT_ID) WHERE UNITSSOLD.PURCHASE_DATE BETWEEN PRICES.START_DATE AND PRICES.END_DATE GROUP BY PRICES.PRODUCT_ID"
100,Y,Y,"SELECT A.PRODUCT_ID, ROUND((SUM((A.PRICE * B.UNITS)) / SUM(B.UNITS)), 2) AS AVERAGE_PRICE FROM PRICES A JOIN UNITSSOLD B ON A.PRODUCT_ID = B.PRODUCT_ID AND (B.PURCHASE_DATE >= A.START_DATE AND B.PURCHASE_DATE <= A.END_DATE) GROUP BY A.PRODUCT_ID"
101,Y,Y,"SELECT A.PRODUCT_ID,ROUND(SUM(A.UNITS*B.PRICE)/SUM(A.UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD A JOIN PRICES B ON A.PRODUCT_ID = B.PRODUCT_ID AND A.PURCHASE_DATE BETWEEN B.START_DATE AND B.END_DATE GROUP BY A.PRODUCT_ID"
102,Y,Y,"SELECT D.PRODUCT_ID, ROUND((SUM(PRICE*UNITS)+0.00)/(SUM(UNITS)+0.00),2) AS AVERAGE_PRICE FROM( SELECT * FROM PRICES P NATURAL JOIN UNITSSOLD U WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) D GROUP BY D.PRODUCT_ID"
103,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY 1"
104,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY 1"
105,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY 1"
106,Y,Y,"SELECT PRODUCT_ID,ROUND((TOTAL)/TOTAL_UNITS,2) AS AVERAGE_PRICE FROM ( SELECT SUM(PRICE*UNITS) AS TOTAL ,P.PRODUCT_ID, SUM(UNITS) AS TOTAL_UNITS FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID )A"
107,Y,Y,"SELECT U.PRODUCT_ID, ROUND(SUM(U.UNITS*P.PRICE)/SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM PRICES AS P JOIN UNITSSOLD AS U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY U.PRODUCT_ID"
108,Y,N,"WITH CTE1 AS ( SELECT DISTINCT * FROM UNITSSOLD ), CTE2 AS ( SELECT P.PRODUCT_ID, START_DATE, END_DATE, PURCHASE_DATE, PRICE, UNITS FROM PRICES AS P JOIN CTE1 AS U ON P.PRODUCT_ID = U.PRODUCT_ID HAVING START_DATE<=PURCHASE_DATE AND END_DATE>=PURCHASE_DATE) SELECT PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS), 2) AS AVERAGE_PRICE FROM CTE2 GROUP BY PRODUCT_ID"
109,Y,Y,"WITH PPUS AS ( SELECT PRICES.PRODUCT_ID, START_DATE, END_DATE, PRICE, PURCHASE_DATE, UNITS FROM PRICES INNER JOIN UNITSSOLD ON PRICES.PRODUCT_ID = UNITSSOLD.PRODUCT_ID WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE) SELECT PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PPUS GROUP BY PRODUCT_ID"
110,Y,Y,"WITH TA AS (SELECT P.PRODUCT_ID, U.PURCHASE_DATE, PRICE, UNITS FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) SELECT PRODUCT_ID, ROUND(SUM(PRICE * UNITS)/SUM(UNITS), 2) AS AVERAGE_PRICE FROM TA GROUP BY PRODUCT_ID"
111,Y,N,"WITH COST AS (SELECT P.PRODUCT_ID, (P.PRICE * U.UNITS) AS TOTAL_COST, U.UNITS, U.PURCHASE_DATE FROM UNITSSOLD U LEFT JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND (U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) GROUP BY P.PRODUCT_ID, U.PURCHASE_DATE) SELECT PRODUCT_ID, ROUND(SUM(TOTAL_COST)/SUM(UNITS), 2) AS AVERAGE_PRICE FROM COST GROUP BY PRODUCT_ID"
112,Y,Y,"WITH CTE AS ( SELECT P.PRODUCT_ID, P.PRICE*U.UNITS AS SALES, U.UNITS FROM PRICES P JOIN UNITSSOLD U ON U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE AND P.PRODUCT_ID = U.PRODUCT_ID ) SELECT PRODUCT_ID, ROUND(SUM(SALES)/SUM(UNITS),2) AS AVERAGE_PRICE FROM CTE GROUP BY PRODUCT_ID"
113,Y,Y,"WITH CTE AS (SELECT U.PRODUCT_ID, U.UNITS, P.PRICE, U.UNITS*P.PRICE AS TOTAL FROM PRICES P JOIN UNITSSOLD U ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) SELECT PRODUCT_ID, ROUND(SUM(TOTAL)/SUM(UNITS),2) AS AVERAGE_PRICE FROM CTE GROUP BY PRODUCT_ID"
114,Y,Y,"WITH CTE AS (SELECT U.PRODUCT_ID, U.UNITS, P.PRICE, U.UNITS*P.PRICE AS TOTAL FROM PRICES P JOIN UNITSSOLD U ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) SELECT PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM CTE GROUP BY PRODUCT_ID"
115,Y,Y,"WITH CTE AS( SELECT U.PRODUCT_ID, U.PURCHASE_DATE, U.UNITS, P.PRICE FROM UNITSSOLD U JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND (PURCHASE_DATE BETWEEN START_DATE AND END_DATE)) SELECT PRODUCT_ID, ROUND(SUM(PRICE * UNITS) / SUM(UNITS),2) AS AVERAGE_PRICE FROM CTE GROUP BY PRODUCT_ID ORDER BY PRODUCT_ID"
116,Y,Y,"WITH RAW_DATA AS ( SELECT U.*, PRICE, UNITS*PRICE AS VALUE FROM UNITSSOLD AS U INNER JOIN PRICES AS P ON U.PRODUCT_ID = P.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE ) SELECT PRODUCT_ID, ROUND(SUM(VALUE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM RAW_DATA GROUP BY PRODUCT_ID"
117,Y,Y,"WITH T1 AS (SELECT P.PRODUCT_ID, P.PRICE, U.UNITS FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE >= P.START_DATE AND U.PURCHASE_DATE <= P.END_DATE) SELECT PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM T1 GROUP BY 1"
118,Y,Y,"WITH TEMP AS ( SELECT U.PRODUCT_ID, SUM(P.PRICE * U.UNITS) AS TOTAL_PRICE, SUM(U.UNITS) AS TOTAL_UNITS FROM UNITSSOLD U INNER JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY U.PRODUCT_ID ) SELECT PRODUCT_ID, ROUND(TOTAL_PRICE / TOTAL_UNITS,2) AS AVERAGE_PRICE FROM TEMP"
119,Y,Y,"WITH TEMP AS (SELECT U.PRODUCT_ID, U.PURCHASE_DATE, U.UNITS, P.PRICE, U.UNITS*P.PRICE AS TOT_PRICE FROM UNITSSOLD U LEFT JOIN PRICES P ON P.PRODUCT_ID = U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) SELECT PRODUCT_ID, ROUND(SUM(TOT_PRICE)/SUM(UNITS), 2) AS AVERAGE_PRICE FROM TEMP GROUP BY 1"
120,Y,Y,"WITH TEMP AS( SELECT U.PRODUCT_ID, U.UNITS AS TOTALUNITS, U.UNITS * P.PRICE AS TOTALPRICE FROM PRICES P JOIN UNITSSOLD U ON U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE AND P.PRODUCT_ID = U.PRODUCT_ID) SELECT PRODUCT_ID, ROUND(SUM(TOTALPRICE)/SUM(TOTALUNITS),2) AS AVERAGE_PRICE FROM TEMP GROUP BY PRODUCT_ID"
121,Y,N,"WITH TOTAL_UNITS AS (SELECT U1.PRODUCT_ID, SUM(U1.UNITS) TOTAL_UNITS FROM UNITSSOLD U1 GROUP BY U1.PRODUCT_ID), TOTAL_DAILY_REVENUE AS ( SELECT P.PRODUCT_ID, U2.PURCHASE_DATE, (P.PRICE * U2.UNITS) TOTAL_DAILY_REVENUE FROM PRICES P INNER JOIN UNITSSOLD U2 ON P.PRODUCT_ID = U2.PRODUCT_ID WHERE U2.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE ), TOTAL_REVENUE AS ( SELECT TOTAL_DAILY_REVENUE.PRODUCT_ID, SUM(TOTAL_DAILY_REVENUE.TOTAL_DAILY_REVENUE) TOTAL_REVENUE FROM TOTAL_DAILY_REVENUE GROUP BY TOTAL_DAILY_REVENUE.PRODUCT_ID ) SELECT TOTAL_UNITS.PRODUCT_ID, ROUND((TOTAL_REVENUE.TOTAL_REVENUE / TOTAL_UNITS.TOTAL_UNITS), 2) AVERAGE_PRICE FROM TOTAL_UNITS JOIN TOTAL_REVENUE ON TOTAL_UNITS.PRODUCT_ID = TOTAL_REVENUE.PRODUCT_ID"
122,Y,Y,"WITH TEMP AS ( SELECT A.PRODUCT_ID, A.PURCHASE_DATE, A.UNITS, B.PRICE FROM UNITSSOLD A, PRICES B WHERE A.PRODUCT_ID = B.PRODUCT_ID AND A.PURCHASE_DATE BETWEEN B.START_DATE AND B.END_DATE) SELECT PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM TEMP GROUP BY PRODUCT_ID"
123,Y,Y,"SELECT A.PRODUCT_ID,ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES AS A LEFT JOIN UNITSSOLD AS B ON A.PRODUCT_ID=B.PRODUCT_ID AND B.PURCHASE_DATE BETWEEN A.START_DATE AND A.END_DATE GROUP BY 1"
124,Y,Y,"SELECT P.PRODUCT_ID , ROUND(SUM(P.PRICE * S.UNITS) / SUM(S.UNITS) ,2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE S.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY 1"
125,Y,Y,"SELECT P.PRODUCT_ID , ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD U JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND (PURCHASE_DATE BETWEEN START_DATE AND END_DATE) GROUP BY P.PRODUCT_ID"
126,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE * U.UNITS) / SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY 1"
127,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID AND (U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) GROUP BY P.PRODUCT_ID"
128,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS), 2) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID =U.PRODUCT_ID WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRODUCT_ID"
129,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY P.PRODUCT_ID"
130,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/SUM(UNITS),2)AS AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
131,Y,Y,"SELECT PRICES.PRODUCT_ID , ROUND((SUM( UNITS * PRICE) / SUM(UNITS)),2) AS AVERAGE_PRICE FROM PRICES,UNITSSOLD WHERE PRICES.PRODUCT_ID = UNITSSOLD.PRODUCT_ID AND UNITSSOLD.PURCHASE_DATE >= PRICES.START_DATE AND UNITSSOLD.PURCHASE_DATE <= PRICES.END_DATE GROUP BY PRODUCT_ID"
132,Y,N,"SELECT PRICES.PRODUCT_ID, ROUND(SUM(PRICES.PRICE*UNITSSOLD.UNITS)/SUM(UNITSSOLD.UNITS),2) AS AVERAGE_PRICE FROM PRICES INNER JOIN (SELECT DISTINCT * FROM UNITSSOLD) UNITSSOLD ON PRICES.PRODUCT_ID = UNITSSOLD.PRODUCT_ID WHERE PURCHASE_DATE>=START_DATE AND PURCHASE_DATE<=END_DATE GROUP BY PRICES.PRODUCT_ID"
133,Y,Y,"SELECT PRICES.PRODUCT_ID, ROUND(SUM(PRICE*UNITS) / SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES JOIN UNITSSOLD ON PRICES.PRODUCT_ID=UNITSSOLD.PRODUCT_ID WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRODUCT_ID"
134,Y,Y,"SELECT PRICES.PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES, UNITSSOLD WHERE PRICES.PRODUCT_ID = UNITSSOLD.PRODUCT_ID AND UNITSSOLD.PURCHASE_DATE <= PRICES.END_DATE AND UNITSSOLD.PURCHASE_DATE >= PRICES.START_DATE GROUP BY PRICES.PRODUCT_ID"
135,Y,N,"SELECT U.PRODUCT_ID, CAST(SUM(UNITS*PRICE)/SUM(UNITS) AS DECIMAL(36,2)) AS AVERAGE_PRICE FROM UNITSSOLD U LEFT JOIN PRICES P ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY U.PRODUCT_ID"
136,Y,Y,"SELECT U.PRODUCT_ID, ROUND(SUM(U.UNITS * P.PRICE)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD AS U LEFT JOIN PRICES AS P ON U.PRODUCT_ID = P.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY U.PRODUCT_ID"
137,Y,Y,"SELECT A.PRODUCT_ID , ROUND(SUM(A.PRICE*B.UNITS)/SUM(B.UNITS),2) AS AVERAGE_PRICE FROM (SELECT DISTINCT * FROM PRICES) AS A INNER JOIN UNITSSOLD AS B ON A.START_DATE <= B.PURCHASE_DATE AND A.END_DATE >= B.PURCHASE_DATE AND A.PRODUCT_ID = B.PRODUCT_ID GROUP BY 1"
138,Y,Y,"SELECT A.PRODUCT_ID AS PRODUCT_ID, ROUND(SUM(A.PRICE*B.UNITS)/SUM(B.UNITS),2) AS AVERAGE_PRICE FROM PRICES A LEFT JOIN UNITSSOLD B ON A.PRODUCT_ID=B.PRODUCT_ID AND B.PURCHASE_DATE BETWEEN A.START_DATE AND A.END_DATE GROUP BY 1"
139,Y,Y,"SELECT A.PRODUCT_ID, ROUND(SUM(A.UNITS*B.PRICE)/SUM(A.UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD A, PRICES B WHERE A.PRODUCT_ID = B.PRODUCT_ID AND A.PURCHASE_DATE BETWEEN B.START_DATE AND B.END_DATE GROUP BY A.PRODUCT_ID"
140,Y,Y,"SELECT A.PRODUCT_ID, ROUND((SUM(A.PRICE*B.UNITS)/SUM(B.UNITS)),2) AS AVERAGE_PRICE FROM PRICES A JOIN UNITSSOLD B ON A.PRODUCT_ID = B.PRODUCT_ID AND (B.PURCHASE_DATE BETWEEN A.START_DATE AND A.END_DATE) GROUP BY A.PRODUCT_ID"
141,Y,Y,"SELECT A.PRODUCT_ID, ROUND(IFNULL(SUM(UNITS*PRICE)/SUM(UNITS), 0), 2) AS AVERAGE_PRICE FROM PRICES A LEFT JOIN UNITSSOLD B ON A.PRODUCT_ID = B.PRODUCT_ID AND B.PURCHASE_DATE BETWEEN A.START_DATE AND A.END_DATE GROUP BY 1"
142,Y,Y,"SELECT A.PRODUCT_ID, ROUND(SUM(A.COST)/SUM(A.UNITS), 2) AS AVERAGE_PRICE FROM ( SELECT UNITSSOLD.PRODUCT_ID AS PRODUCT_ID, UNITS, (UNITS * PRICES.PRICE) AS COST FROM UNITSSOLD LEFT JOIN PRICES ON UNITSSOLD.PRODUCT_ID = PRICES.PRODUCT_ID WHERE PURCHASE_DATE BETWEEN PRICES.START_DATE AND PRICES.END_DATE ) A GROUP BY PRODUCT_ID"
143,Y,Y,"SELECT A.PRODUCT_ID, ROUND(SUM(A.PRICE * B.UNITS) / SUM(B.UNITS),2) AS AVERAGE_PRICE FROM PRICES A JOIN UNITSSOLD B ON B.PURCHASE_DATE BETWEEN A.START_DATE AND A.END_DATE AND A.PRODUCT_ID = B.PRODUCT_ID GROUP BY 1"
144,Y,Y,"SELECT A.PRODUCT_ID, ROUND(SUM(A.PRICE * B.UNITS)/SUM(B.UNITS),2) AS AVERAGE_PRICE FROM PRICES A JOIN UNITSSOLD B ON A.PRODUCT_ID = B.PRODUCT_ID AND A.START_DATE <= B.PURCHASE_DATE AND A.END_DATE >= B.PURCHASE_DATE GROUP BY A.PRODUCT_ID"
145,Y,Y,"SELECT A.PRODUCT_ID, ROUND(SUM(A.UNITS*B.PRICE)/SUM(A.UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD A INNER JOIN PRICES B ON A.PRODUCT_ID = B.PRODUCT_ID AND A.PURCHASE_DATE BETWEEN B.START_DATE AND B.END_DATE GROUP BY A.PRODUCT_ID"
146,Y,N,"SELECT A.PRODUCT_ID, ROUND(SUM(A.UNITS*B.PRICE)/SUM(A.UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD AS A LEFT JOIN PRICES AS B ON A.PRODUCT_ID=B.PRODUCT_ID AND START_DATE <= A.PURCHASE_DATE AND END_DATE >= A.PURCHASE_DATE GROUP BY A.PRODUCT_ID"
147,Y,Y,"SELECT A.PRODUCT_ID, ROUND(SUM(PRICE * UNITS) / SUM(UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD A JOIN PRICES B ON A.PRODUCT_ID = B.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY A.PRODUCT_ID"
148,Y,Y,"SELECT A.PRODUCT_ID, ROUND(SUM(PRICE * UNITS)/SUM(UNITS), 2) AVERAGE_PRICE FROM PRICES A JOIN UNITSSOLD B ON A.PRODUCT_ID = B.PRODUCT_ID AND A.START_DATE <= B.PURCHASE_DATE AND A.END_DATE >= B.PURCHASE_DATE GROUP BY A.PRODUCT_ID"
149,Y,Y,"SELECT A.PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES A JOIN UNITSSOLD B ON A.PRODUCT_ID = B.PRODUCT_ID AND B.PURCHASE_DATE >= A.START_DATE AND B.PURCHASE_DATE <= A.END_DATE GROUP BY A.PRODUCT_ID"
150,Y,Y,"SELECT A.PRODUCT_ID,ROUND (SUM(A.PRICE*B.UNITS)/ SUM(B.UNITS),2) AS AVERAGE_PRICE FROM PRICES A, UNITSSOLD B WHERE B.PURCHASE_DATE BETWEEN A.START_DATE AND A.END_DATE AND A.PRODUCT_ID = B.PRODUCT_ID GROUP BY PRODUCT_ID"
151,Y,Y,"SELECT A.PRODUCT_ID,ROUND(SUM((A.PRICE*B.UNITS))/SUM(B.UNITS),2) AS AVERAGE_PRICE FROM PRICES A JOIN UNITSSOLD B ON A.PRODUCT_ID=B.PRODUCT_ID WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRODUCT_ID"
152,Y,Y,"SELECT A.PRODUCT_ID,ROUND(SUM(A.PRICE*B.UNITS)/SUM(B.UNITS),2) AS AVERAGE_PRICE FROM PRICES AS A JOIN UNITSSOLD AS B ON A.PRODUCT_ID=B.PRODUCT_ID AND (B.PURCHASE_DATE BETWEEN A.START_DATE AND A.END_DATE) GROUP BY A.PRODUCT_ID"
153,Y,N,"SELECT B.PRODUCT_ID, ROUND(SUM(UNITS * PRICE) / SUM(UNITS) , 2) AS AVERAGE_PRICE FROM UNITSSOLD B LEFT JOIN PRICES A ON B.PRODUCT_ID = A.PRODUCT_ID AND B.PURCHASE_DATE BETWEEN A.START_DATE AND END_DATE GROUP BY 1"
154,Y,Y,"SELECT B.PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES A, UNITSSOLD B WHERE A.PRODUCT_ID = B.PRODUCT_ID AND B.PURCHASE_DATE BETWEEN A.START_DATE AND A.END_DATE GROUP BY B.PRODUCT_ID"
155,Y,Y,"SELECT DISTINCT A.PRODUCT_ID, ROUND(SUM(A.PRICE*B.UNITS)/SUM(B.UNITS),2) AS AVERAGE_PRICE FROM PRICES A JOIN UNITSSOLD B ON A.PRODUCT_ID=B.PRODUCT_ID AND (B.PURCHASE_DATE BETWEEN A.START_DATE AND A.END_DATE) GROUP BY A.PRODUCT_ID"
156,Y,Y,"SELECT DISTINCT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD U JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
157,Y,Y,"SELECT P.PRODUCT_ID , ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID AND (PURCHASE_DATE<=END_DATE AND PURCHASE_DATE>=START_DATE) GROUP BY 1"
158,Y,Y,"SELECT P.PRODUCT_ID , ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2)AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY 1 ORDER BY 1"
159,Y,Y,"SELECT P.PRODUCT_ID ,ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES AS P LEFT JOIN UNITSSOLD U ON(P.PRODUCT_ID =U.PRODUCT_ID) WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY PRODUCT_ID"
160,Y,Y,"SELECT P.PRODUCT_ID ,ROUND(SUM(U.UNITS*P.PRICE)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P, UNITSSOLD U WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE AND P.PRODUCT_ID = U.PRODUCT_ID GROUP BY U.PRODUCT_ID"
161,Y,Y,"SELECT P.PRODUCT_ID, ROUND((SUM(P.PRICE * U.UNITS) / SUM(U.UNITS)), 2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
162,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY P.PRODUCT_ID"
163,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(U.UNITS*P.PRICE) / SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY 1"
164,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(U.UNITS*P.PRICE)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES AS P JOIN UNITSSOLD AS U ON P.PRODUCT_ID=U.PRODUCT_ID WHERE U.PURCHASE_DATE>=P.START_DATE AND U.PURCHASE_DATE<=P.END_DATE GROUP BY P.PRODUCT_ID"
165,Y,Y,"SELECT P.PRODUCT_ID, ROUND(((SUM(P.PRICE*U.UNITS)) / (SUM(U.UNITS))),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U WHERE P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID ORDER BY P.PRODUCT_ID"
166,Y,Y,"SELECT P.PRODUCT_ID, ROUND((SUM(P.PRICE * S.UNITS)/SUM(S.UNITS)), 2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD S ON (P.PRODUCT_ID = S.PRODUCT_ID AND S.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) GROUP BY 1"
167,Y,Y,"SELECT P.PRODUCT_ID, ROUND((SUM(P.PRICE * US.UNITS) / SUM(US.UNITS)), 2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD US ON P.PRODUCT_ID = US.PRODUCT_ID AND US.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
168,Y,Y,"SELECT P.PRODUCT_ID, ROUND((SUM(P.PRICE*S.UNITS)/SUM(S.UNITS)),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD S ON P.PRODUCT_ID =S.PRODUCT_ID AND S.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
169,Y,Y,"SELECT P.PRODUCT_ID, ROUND((SUM(P.PRICE*U.UNITS))/(SUM(U.UNITS)),2) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
170,Y,Y,"SELECT P.PRODUCT_ID, ROUND((SUM(P.PRICE*U.UNITS)/SUM(U.UNITS)),2) AS AVERAGE_PRICE FROM PRICES AS P, UNITSSOLD AS U WHERE P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE >= P.START_DATE AND U.PURCHASE_DATE <= P.END_DATE GROUP BY P.PRODUCT_ID"
171,Y,Y,"SELECT P.PRODUCT_ID, ROUND((SUM(P.PRICE*U.UNITS)/SUM(U.UNITS)),2) AS AVERAGE_PRICE FROM UNITSSOLD U JOIN PRICES P ON P.PRODUCT_ID=U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
172,Y,Y,"SELECT P.PRODUCT_ID, ROUND((SUM(U.UNITS * P.PRICE)/SUM(UNITS)), 2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY 1"
173,Y,Y,"SELECT P.PRODUCT_ID, ROUND((SUM(UNITS * PRICE) / SUM(UNITS)),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
174,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE * U.UNITS)/SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM PRICES P, UNITSSOLD U WHERE P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
175,Y,N,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE * U.UNITS)/SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD U LEFT JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
176,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE * U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY 1"
177,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE * U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P, UNITSSOLD U WHERE (U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) AND (U.PRODUCT_ID = P.PRODUCT_ID) GROUP BY P.PRODUCT_ID ORDER BY P.PRODUCT_ID ASC"
178,Y,N,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE * U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD AS U LEFT JOIN PRICES AS P ON U.PRODUCT_ID = P.PRODUCT_ID AND P.START_DATE <= U.PURCHASE_DATE AND P.END_DATE >= U.PURCHASE_DATE GROUP BY P.PRODUCT_ID"
179,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE* U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES AS P INNER JOIN UNITSSOLD AS U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE U.PURCHASE_DATE >= P.START_DATE AND U.PURCHASE_DATE <= P.END_DATE GROUP BY P.PRODUCT_ID"
180,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS) / SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY PRODUCT_ID"
181,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/ SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND DATEDIFF(U.PURCHASE_DATE, P.START_DATE) >= 0 AND DATEDIFF(P.END_DATE, U.PURCHASE_DATE) >= 0 GROUP BY PRODUCT_ID"
182,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/ SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
183,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS), 2) AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
184,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY U.PRODUCT_ID"
185,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD U ON (P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE<= P.END_DATE AND U.PURCHASE_DATE>=P.START_DATE ) GROUP BY PRODUCT_ID"
186,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
187,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
188,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND END_DATE GROUP BY P.PRODUCT_ID"
189,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID AND U.PURCHASE_DATE>=P.START_DATE AND U.PURCHASE_DATE<=P.END_DATE GROUP BY 1"
190,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES AS P LEFT JOIN UNITSSOLD AS U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
191,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY PRODUCT_ID"
192,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE * UNITS) / SUM(UNITS), 2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRODUCT_ID"
193,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE * UNITS) / SUM(UNITS), 2) AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD S ON P.PRODUCT_ID = S.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY 1"
194,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE * UNITS) / SUM(UNITS), 2) AVERAGE_PRICE FROM PRICES P, UNITSSOLD S WHERE P.PRODUCT_ID = S.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY 1"
195,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE * UNITS)/SUM(UNITS), 2) AS AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY 1"
196,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE *UNITS)/SUM(UNITS),2 )AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND PURCHASE_DATE <= END_DATE AND PURCHASE_DATE>=START_DATE GROUP BY P.PRODUCT_ID"
197,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE*UNITS) / SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY P.PRODUCT_ID"
198,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/ SUM(UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD U JOIN PRICES P ON P.PRODUCT_ID= U.PRODUCT_ID AND (U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) GROUP BY PRODUCT_ID"
199,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AVERAGE_PRICE FROM PRICES P, UNITSSOLD U WHERE P.PRODUCT_ID=U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
200,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES AS P LEFT JOIN UNITSSOLD AS U ON P.PRODUCT_ID=U.PRODUCT_ID AND (PURCHASE_DATE BETWEEN START_DATE AND END_DATE) GROUP BY 1"
201,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD U ON (P.PRODUCT_ID=U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN START_DATE AND END_DATE) GROUP BY P.PRODUCT_ID"
202,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID AND (PURCHASE_DATE BETWEEN START_DATE AND END_DATE) GROUP BY P.PRODUCT_ID"
203,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID AND (PURCHASE_DATE BETWEEN START_DATE AND END_DATE) GROUP BY PRODUCT_ID"
204,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRODUCT_ID ORDER BY PRODUCT_ID"
205,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD S ON P.PRODUCT_ID=S.PRODUCT_ID AND S.PURCHASE_DATE>=START_DATE AND S.PURCHASE_DATE<=END_DATE GROUP BY 1"
206,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND (U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) GROUP BY P.PRODUCT_ID"
207,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P, UNITSSOLD U WHERE U.PRODUCT_ID=P.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY P.PRODUCT_ID"
208,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
209,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2)AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD US ON P.PRODUCT_ID=US.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRODUCT_ID"
210,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(S.UNITS * P.PRICE)/SUM(S.UNITS),2) AS AVERAGE_PRICE FROM PRICES AS P JOIN UNITSSOLD AS S ON P.PRODUCT_ID = S.PRODUCT_ID AND S.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
211,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(TOTAL_UNITS*PRICE) / SUM(TOTAL_UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN (SELECT PRODUCT_ID, PURCHASE_DATE, SUM(UNITS) AS TOTAL_UNITS FROM UNITSSOLD GROUP BY 1,2) US ON P.PRODUCT_ID = US.PRODUCT_ID AND US.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY 1"
212,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(U.UNITS * P.PRICE) / SUM(U.UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD U, PRICES P WHERE (P.PRODUCT_ID = U.PRODUCT_ID) AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY U.PRODUCT_ID"
213,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(U.UNITS * P.PRICE)/ SUM(U.UNITS), 2) AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND (U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) GROUP BY P.PRODUCT_ID"
214,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(U.UNITS * P.PRICE)/ SUM(U.UNITS), 2) AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND (U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) GROUP BY PRODUCT_ID"
215,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(U.UNITS * P.PRICE)/ SUM(U.UNITS), 2) AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE (U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) GROUP BY 1"
216,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(U.UNITS * P.PRICE)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY U.PRODUCT_ID ORDER BY U.PRODUCT_ID"
217,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(U.UNITS * P.PRICE)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD U JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
218,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(U.UNITS*P.PRICE)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND (U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) GROUP BY PRODUCT_ID"
219,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(U.UNITS*P.PRICE)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
220,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(U.UNITS*P.PRICE)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON U.PRODUCT_ID=P.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY P.PRODUCT_ID"
221,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(U.UNITS*P.PRICE)/SUM(UNITS), 2) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
222,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(U.UNITS*P.PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY P.PRODUCT_ID"
223,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(U.UNITS*PRICE)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID AND U.PURCHASE_DATE>=P.START_DATE AND U.PURCHASE_DATE<=P.END_DATE GROUP BY P.PRODUCT_ID"
224,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(UNITS*PRICE) / SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD U ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
225,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY 1"
226,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRODUCT_ID"
227,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID AND PURCHASE_DATE<=END_DATE AND PURCHASE_DATE>=START_DATE GROUP BY P.PRODUCT_ID"
228,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/SUM(UNITS),2) AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD US ON P.PRODUCT_ID = US.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY P.PRODUCT_ID"
229,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/SUM(UNITS),2)AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRODUCT_ID"
230,Y,Y,"SELECT P.PRODUCT_ID,ROUND((SUM(PRICE*UNITS)/SUM(UNITS)),2) AS AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY P.PRODUCT_ID"
231,Y,Y,"SELECT P.PRODUCT_ID,ROUND(SUM(P.PRICE* U.UNITS)/SUM(U.UNITS),2) AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD U ON U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE AND P.PRODUCT_ID = U.PRODUCT_ID GROUP BY 1 ORDER BY 1"
232,Y,Y,"SELECT P.PRODUCT_ID,ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD U JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
233,Y,Y,"SELECT P.PRODUCT_ID,ROUND(SUM(P.PRICE*U.UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY P.PRODUCT_ID"
234,Y,Y,"SELECT P.PRODUCT_ID,ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD U ON (P.PRODUCT_ID=U.PRODUCT_ID AND (PURCHASE_DATE BETWEEN START_DATE AND END_DATE)) GROUP BY PRODUCT_ID"
235,Y,Y,"SELECT P.PRODUCT_ID,ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON U.PURCHASE_DATE<=P.END_DATE AND U.PURCHASE_DATE>=P.START_DATE AND P.PRODUCT_ID=U.PRODUCT_ID GROUP BY PRODUCT_ID"
236,Y,Y,"SELECT P.PRODUCT_ID,ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES AS P JOIN UNITSSOLD AS U ON P.PRODUCT_ID=U.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY P.PRODUCT_ID"
237,Y,Y,"SELECT P.PRODUCT_ID,ROUND(SUM(U.UNITS*P.PRICE)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY U.PRODUCT_ID"
238,Y,Y,"SELECT P.PRODUCT_ID,ROUND(SUM(UNITS*PRICE)/COALESCE(SUM(UNITS),1),2) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND PURCHASE_DATE>=START_DATE AND PURCHASE_DATE<=END_DATE GROUP BY P.PRODUCT_ID"
239,Y,Y,"SELECT P.PRODUCT_ID,ROUND(SUM(UNITS*PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY PRODUCT_ID"
240,Y,Y,"SELECT PRICES.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES JOIN UNITSSOLD ON PRICES.PRODUCT_ID = UNITSSOLD.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRICES.PRODUCT_ID"
241,Y,Y,"SELECT PRICES.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AVERAGE_PRICE FROM PRICES JOIN UNITSSOLD USING(PRODUCT_ID) WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY 1 ORDER BY 1"
242,Y,Y,"SELECT PRICES.PRODUCT_ID, ROUND(SUM(PRICES.PRICE*UNITSSOLD.UNITS)/SUM(UNITSSOLD.UNITS), 2) AS AVERAGE_PRICE FROM PRICES INNER JOIN UNITSSOLD ON PRICES.PRODUCT_ID = UNITSSOLD.PRODUCT_ID WHERE UNITSSOLD.PURCHASE_DATE BETWEEN PRICES.START_DATE AND PRICES.END_DATE GROUP BY PRICES.PRODUCT_ID"
243,Y,Y,"SELECT PRICES.PRODUCT_ID, ROUND(SUM(PRICES.PRICE*UNITSSOLD.UNITS)/SUM(UNITSSOLD.UNITS), 2) AS AVERAGE_PRICE FROM PRICES JOIN UNITSSOLD ON PRICES.PRODUCT_ID=UNITSSOLD.PRODUCT_ID AND UNITSSOLD.PURCHASE_DATE BETWEEN PRICES.START_DATE AND PRICES.END_DATE GROUP BY PRODUCT_ID"
244,Y,Y,"SELECT PRODUCT_ID , ROUND(SUM(X) / SUM(UNITS), 2) AS AVERAGE_PRICE FROM ( SELECT A.PRODUCT_ID , SUM(PRICE * UNITS) AS X , SUM(UNITS) AS UNITS FROM UNITSSOLD A JOIN PRICES B ON A.PRODUCT_ID = B.PRODUCT_ID AND PURCHASE_DATE BETWEEN B.START_DATE AND B.END_DATE GROUP BY 1 ) X GROUP BY 1"
245,Y,Y,"SELECT PRODUCT_ID, ROUND((SUM(PRICE * UNITS) / SUM(UNITS) ), 2) AS AVERAGE_PRICE FROM (SELECT * FROM PRICES LEFT JOIN UNITSSOLD USING (PRODUCT_ID) WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE) AS T GROUP BY PRODUCT_ID"
246,Y,Y,"SELECT PRODUCT_ID, ROUND((SUM(PRICE*UNITS)/SUM(UNITS)), 2) AS AVERAGE_PRICE FROM PRICES JOIN UNITSSOLD USING(PRODUCT_ID) WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRODUCT_ID"
247,Y,Y,"SELECT PRODUCT_ID, ROUND(IFNULL(SUM(PRICE*UNITS)/SUM(UNITS),0),2) AS AVERAGE_PRICE FROM (SELECT * FROM (SELECT A.PRODUCT_ID, A.START_DATE,A.END_DATE,A.PRICE,B.PURCHASE_DATE,B.UNITS FROM PRICES A LEFT JOIN UNITSSOLD B ON A.PRODUCT_ID = B.PRODUCT_ID ) C WHERE PURCHASE_DATE>=START_DATE AND PURCHASE_DATE<=END_DATE) D GROUP BY PRODUCT_ID"
248,Y,Y,"SELECT PRODUCT_ID, ROUND(SUM(PRICE)/ SUM(UNITS),2) AS AVERAGE_PRICE FROM(SELECT X.PRODUCT_ID, X.PURCHASE_DATE, X.UNITS, X.UNITS * Y.PRICE AS PRICE FROM UNITSSOLD X JOIN PRICES Y ON X.PRODUCT_ID = Y.PRODUCT_ID AND X.PURCHASE_DATE BETWEEN Y.START_DATE AND Y.END_DATE) A GROUP BY 1"
249,Y,Y,"SELECT PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM (SELECT P.PRODUCT_ID, PRICE, UNITS FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE ) A GROUP BY PRODUCT_ID"
250,N,N,"SELECT PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM (SELECT PRODUCT_ID, PURCHASE_DATE, (SELECT PRICE FROM PRICES P WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE AND P.PRODUCT_ID=U.PRODUCT_ID) AS PRICE, UNITS FROM UNITSSOLD U)T GROUP BY PRODUCT_ID"
251,Y,Y,"SELECT PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U USING(PRODUCT_ID) WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY P.PRODUCT_ID"
252,Y,Y,"SELECT PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AVERAGE_PRICE FROM (SELECT P.PRODUCT_ID, PRICE, UNITS FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) A GROUP BY PRODUCT_ID"
253,Y,Y,"SELECT PRODUCT_ID, ROUND(SUM(REVENUE)/SUM(TOTAL_UNITS),2) AS AVERAGE_PRICE FROM (SELECT PRICES.PRODUCT_ID, SUM(PRICE*UNITS) AS REVENUE, SUM(UNITS) AS TOTAL_UNITS FROM PRICES JOIN UNITSSOLD ON PRICES.PRODUCT_ID=UNITSSOLD.PRODUCT_ID WHERE UNITSSOLD.PURCHASE_DATE BETWEEN PRICES.START_DATE AND PRICES.END_DATE GROUP BY PRICES.PRODUCT_ID,PURCHASE_DATE) AS TEM GROUP BY PRODUCT_ID"
254,Y,Y,"SELECT PRODUCT_ID, ROUND(SUM(TOTAL_DAILY_PRICE) / SUM(UNITS),2) AS AVERAGE_PRICE FROM (SELECT UNI.PRODUCT_ID, UNI.PURCHASE_DATE, UNI.UNITS, P.PRICE * UNI.UNITS AS TOTAL_DAILY_PRICE FROM UNITSSOLD UNI JOIN PRICES P ON P.PRODUCT_ID = UNI.PRODUCT_ID AND UNI.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) SUB GROUP BY PRODUCT_ID"
255,N,N,"SELECT PRODUCT_ID, ROUND(SUM(UNITS*(SELECT PRICE FROM PRICES WHERE PRODUCT_ID=A.PRODUCT_ID AND START_DATE <= A.PURCHASE_DATE AND END_DATE >= A.PURCHASE_DATE))/SUM(UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD AS A GROUP BY PRODUCT_ID"
256,Y,N,"SELECT PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/SUM(UNITS), 2) AS AVERAGE_PRICE FROM ( SELECT DISTINCT A.PRODUCT_ID, A.PURCHASE_DATE, A.UNITS, B.PRICE FROM UNITSSOLD A JOIN PRICES B ON A.PRODUCT_ID = B.PRODUCT_ID AND A.PURCHASE_DATE >= B.START_DATE AND A.PURCHASE_DATE <= B.END_DATE ) AS T1 GROUP BY PRODUCT_ID ORDER BY PRODUCT_ID"
257,Y,Y,"SELECT PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/SUM(UNITS), 2) AVERAGE_PRICE FROM PRICES JOIN UNITSSOLD USING (PRODUCT_ID) WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRODUCT_ID"
258,Y,Y,"SELECT PRODUCT_ID,ROUND(SUM(SELLINGPRICE)/SUM(UNITS),2) AVERAGE_PRICE FROM ( (SELECT U.PRODUCT_ID,U.PURCHASE_DATE,U.UNITS,P.PRICE, UNITS*PRICE SELLINGPRICE FROM UNITSSOLD U JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE>=P.START_DATE AND U.PURCHASE_DATE <=P.END_DATE) )A GROUP BY 1"
259,Y,Y,"SELECT PRODUCT_ID,ROUND(SUM(UNITS*PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM (SELECT PRICES.PRODUCT_ID AS PRODUCT_ID,UNITS,PRICE FROM PRICES JOIN UNITSSOLD ON PRICES.PRODUCT_ID = UNITSSOLD.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE)T1 GROUP BY PRODUCT_ID"
260,Y,Y,"SELECT PRODUCT_ID,ROUND(SUM(UNITS*PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD JOIN PRICES USING (PRODUCT_ID) WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRODUCT_ID"
261,Y,Y,"SELECT T.ID PRODUCT_ID, ROUND(PROD/SUMS, 2) AVERAGE_PRICE FROM (SELECT SUM(P.PRICE*U.UNITS) PROD, P.PRODUCT_ID ID, SUM(U.UNITS) SUMS FROM PRICES P INNER JOIN UNITSSOLD U ON U.PURCHASE_DATE <= P.END_DATE AND U.PURCHASE_DATE >= P.START_DATE AND P.PRODUCT_ID = U.PRODUCT_ID GROUP BY P.PRODUCT_ID) T"
262,Y,Y,"SELECT T1.ID PRODUCT_ID, ROUND(SUM(T1.PROD/T2.SUMS), 2) AVERAGE_PRICE FROM (SELECT (P.PRICE*U.UNITS) PROD, P.PRODUCT_ID ID FROM PRICES P INNER JOIN UNITSSOLD U ON U.PURCHASE_DATE <= P.END_DATE AND U.PURCHASE_DATE >= P.START_DATE AND P.PRODUCT_ID = U.PRODUCT_ID ) T1 INNER JOIN (SELECT SUM(U.UNITS) SUMS, P.PRODUCT_ID FROM PRICES P INNER JOIN UNITSSOLD U ON U.PURCHASE_DATE <= P.END_DATE AND U.PURCHASE_DATE >= P.START_DATE AND P.PRODUCT_ID = U.PRODUCT_ID GROUP BY U.PRODUCT_ID) T2 ON T1.ID = T2.PRODUCT_ID GROUP BY T1.ID"
263,Y,Y,"SELECT T1.PRODUCT_ID AS PRODUCT_ID, ROUND(SUM(T1.TOTAL_PRICE)/SUM(T1.UNITS),2) AS AVERAGE_PRICE FROM (SELECT PRICES.PRODUCT_ID AS PRODUCT_ID, PRICES.PRICE * UNITSSOLD.UNITS AS TOTAL_PRICE, UNITSSOLD.UNITS AS UNITS FROM PRICES INNER JOIN UNITSSOLD ON PRICES.PRODUCT_ID = UNITSSOLD.PRODUCT_ID AND UNITSSOLD.PURCHASE_DATE BETWEEN PRICES.START_DATE AND PRICES.END_DATE) AS T1 GROUP BY PRODUCT_ID"
264,Y,N,"SELECT T2.PRODUCT_ID, ROUND((T1.MUL/T2.SUM),2) AS AVERAGE_PRICE FROM (SELECT P.PRODUCT_ID, SUM((P.PRICE * UNITS)) AS MUL FROM PRICES P LEFT JOIN UNITSSOLD U ON (P.PRODUCT_ID = U.PRODUCT_ID) WHERE START_DATE <= PURCHASE_DATE AND END_DATE >= PURCHASE_DATE GROUP BY P.PRODUCT_ID) T1 LEFT JOIN (SELECT PRODUCT_ID, SUM(UNITS) AS SUM FROM UNITSSOLD GROUP BY PRODUCT_ID) T2 ON (T1.PRODUCT_ID = T2.PRODUCT_ID)"
265,Y,Y,"SELECT U.PRODUCT_ID, ROUND(SUM(U.UNITS*P.PRICE)/SUM(U.UNITS),2) AVERAGE_PRICE FROM UNITSSOLD U JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY U.PRODUCT_ID"
266,Y,Y,"SELECT U.PRODUCT_ID, ROUND( SUM( CASE WHEN U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE THEN P.PRICE ELSE 0 END * U.UNITS) / SUM(CASE WHEN U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE THEN U.UNITS ELSE 0 END) ,2) AS AVERAGE_PRICE FROM PRICES P, UNITSSOLD U WHERE U.PRODUCT_ID = P.PRODUCT_ID GROUP BY U.PRODUCT_ID"
267,Y,Y,"SELECT U.PRODUCT_ID, ROUND( SUM(P.PRICE * U.UNITS) / SUM(U.UNITS) , 2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON U.PRODUCT_ID = P.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY U.PRODUCT_ID"
268,Y,Y,"SELECT U.PRODUCT_ID, ROUND( SUM(U.UNITS * P.PRICE) / SUM(U.UNITS) , 2) AS AVERAGE_PRICE FROM UNITSSOLD U INNER JOIN PRICES P ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY U.PRODUCT_ID"
269,Y,Y,"SELECT U.PRODUCT_ID, ROUND((SUM((U.UNITS * P.PRICE)))/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD U JOIN PRICES P ON P.PRODUCT_ID = U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY U.PRODUCT_ID"
270,Y,Y,"SELECT U.PRODUCT_ID, ROUND((SUM(U.UNITS * P.PRICE)/ SUM(U.UNITS)),2) AS AVERAGE_PRICE FROM UNITSSOLD U JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY 1"
271,Y,Y,"SELECT U.PRODUCT_ID, ROUND(SUM(P.PRICE * U.UNITS)/SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD AS U JOIN PRICES AS P ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY U.PRODUCT_ID"
272,Y,Y,"SELECT U.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS) / SUM(UNITS), 2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY U.PRODUCT_ID"
273,Y,Y,"SELECT U.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE AND U.PRODUCT_ID = P.PRODUCT_ID GROUP BY PRODUCT_ID"
274,Y,N,"SELECT U.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD U LEFT JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND PURCHASE_DATE <= END_DATE AND PURCHASE_DATE >= START_DATE GROUP BY PRODUCT_ID"
275,Y,Y,"SELECT U.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AVERAGE_PRICE FROM UNITSSOLD U JOIN PRICES P WHERE U.PRODUCT_ID = P.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY U.PRODUCT_ID"
276,Y,Y,"SELECT U.PRODUCT_ID, ROUND(SUM(U.UNITS * P.PRICE) / SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY U.PRODUCT_ID"
277,Y,Y,"SELECT U.PRODUCT_ID, ROUND(SUM(U.UNITS * P.PRICE) / SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD U JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY 1 ORDER BY 1"
278,Y,Y,"SELECT U.PRODUCT_ID, ROUND(SUM(U.UNITS*P.PRICE)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD U JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY U.PRODUCT_ID"
279,Y,N,"SELECT U.PRODUCT_ID, ROUND(SUM(U.UNITS*P.PRICE)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD U LEFT JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
280,Y,N,"SELECT U.PRODUCT_ID, ROUND(SUM(U.UNITS*P.PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD U LEFT JOIN PRICES P ON U.PRODUCT_ID=P.PRODUCT_ID AND (U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) GROUP BY U.PRODUCT_ID"
281,Y,Y,"SELECT U.PRODUCT_ID, ROUND(SUM(UNITS * PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD U JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY 1"
282,Y,N,"SELECT U.PRODUCT_ID, ROUND(SUM(UNITS*P.PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD U LEFT JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY U.PRODUCT_ID"
283,Y,Y,"SELECT U.PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD U JOIN PRICES P USING(PRODUCT_ID) WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY 1"
284,Y,Y,"SELECT U.PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P, UNITSSOLD U WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE AND U.PRODUCT_ID = P.PRODUCT_ID GROUP BY 1"
285,Y,Y,"SELECT U.PRODUCT_ID,ROUND((SUM(UNITS * PRICE) / SUM(UNITS)),2) AS AVERAGE_PRICE FROM UNITSSOLD U JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY PRODUCT_ID"
286,Y,Y,"SELECT U.PRODUCT_ID,CAST(SUM(P.PRICE * U.UNITS)/SUM(U.UNITS) AS DECIMAL(10,2)) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY U.PRODUCT_ID"
287,Y,N,"SELECT US.PRODUCT_ID, ROUND(SUM(P.PRICE*US.UNITS)/SUM(US.UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD US LEFT JOIN PRICES P ON P.PRODUCT_ID=US.PRODUCT_ID AND US.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY US.PRODUCT_ID"
288,Y,Y,"SELECT US.PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD US ON P.PRODUCT_ID = US.PRODUCT_ID AND US.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY 1"
289,Y,Y,"SELECT US.PRODUCT_ID,ROUND(SUM(UNITS * PRICE) / SUM(UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD US JOIN PRICES P ON US.PRODUCT_ID = P.PRODUCT_ID AND US.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY 1"
290,Y,Y,"WITH CTE AS( SELECT P.PRODUCT_ID, P.PRICE, U.UNITS FROM UNITSSOLD U JOIN PRICES P ON U.PRODUCT_ID=P.PRODUCT_ID AND PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) SELECT C.PRODUCT_ID, ROUND(SUM(C.UNITS*C.PRICE)/ SUM(C.UNITS),2)AS AVERAGE_PRICE FROM CTE C GROUP BY C.PRODUCT_ID"
291,Y,Y,"WITH C AS ( SELECT P.PRODUCT_ID, START_DATE, END_DATE, PURCHASE_DATE, UNITS, PRICE, UNITS*PRICE AS TOT_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID= U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE ) , B AS ( SELECT PRODUCT_ID, SUM(UNITS) AS TOT_UNITS FROM C GROUP BY PRODUCT_ID ) , A AS ( SELECT C.PRODUCT_ID,TOT_PRICE, TOT_UNITS FROM C, B WHERE C.PRODUCT_ID=B.PRODUCT_ID ) SELECT A.PRODUCT_ID, ROUND(SUM(TOT_PRICE)*1.0/ MIN(TOT_UNITS), 2) AS AVERAGE_PRICE FROM A GROUP BY PRODUCT_ID"
292,Y,Y,"WITH COMBINED AS ( SELECT P.PRODUCT_ID, PRICE, UNITS, START_DATE, END_DATE, PURCHASE_DATE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID) SELECT PRODUCT_ID, ROUND(SUM(TOL)/SUM(UNITS),2) AS AVERAGE_PRICE FROM (SELECT PRODUCT_ID, PRICE*UNITS AS TOL, UNITS FROM COMBINED WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE) AS T GROUP BY PRODUCT_ID"
293,Y,Y,"WITH CTE AS ( SELECT P.PRODUCT_ID, P.PRICE, U.UNITS FROM PRICES P INNER JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE ) SELECT PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM CTE GROUP BY PRODUCT_ID"
294,Y,Y,"WITH CTE AS ( SELECT P.PRODUCT_ID, P.START_DATE, P.END_DATE, U.UNITS AS QUANTITY, (P.PRICE*U.UNITS) AS SELLING_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE ) SELECT PRODUCT_ID, ROUND ((SUM(SELLING_PRICE) * 1.00 /SUM(QUANTITY)),2) AS AVERAGE_PRICE FROM CTE GROUP BY PRODUCT_ID"
295,Y,Y,"WITH CTE AS ( SELECT P.PRODUCT_ID, PRICE, UNITS, PRICE*UNITS AS TOTAL FROM PRICES P INNER JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE ) SELECT PRODUCT_ID, ROUND(SUM(TOTAL)/ SUM(UNITS),2) AS AVERAGE_PRICE FROM CTE GROUP BY PRODUCT_ID"
296,Y,N,"WITH CTE AS ( SELECT PRODUCT_ID,SUM(UNITS) SUMM FROM UNITSSOLD U GROUP BY 1) SELECT Z.PRODUCT_ID,ROUND(AVERAGE_PRICE/C.SUMM,2) AS AVERAGE_PRICE FROM ( SELECT P.PRODUCT_ID,SUM(CASE WHEN PURCHASE_DATE BETWEEN START_DATE AND END_DATE THEN PRICE*UNITS END) AVERAGE_PRICE FROM PRICES P ,UNITSSOLD U WHERE U.PRODUCT_ID=P.PRODUCT_ID GROUP BY 1 ) Z, CTE C WHERE C.PRODUCT_ID=Z.PRODUCT_ID"
297,Y,Y,"WITH CTE AS ( SELECT U.PRODUCT_ID, (UNITS*PRICE) AS PRICE, SUM(UNITS) OVER (PARTITION BY PRODUCT_ID) AS UNITS_SOLD FROM UNITSSOLD U INNER JOIN PRICES P ON U.PURCHASE_DATE >= P.START_DATE AND U.PURCHASE_DATE <= P.END_DATE AND U.PRODUCT_ID = P.PRODUCT_ID ) SELECT PRODUCT_ID, ROUND(SUM(PRICE)/MAX(UNITS_SOLD),2) AS AVERAGE_PRICE FROM CTE GROUP BY PRODUCT_ID"
298,Y,Y,"WITH CTE AS ( SELECT U.PRODUCT_ID, U.PURCHASE_DATE, U.UNITS, P.PRICE FROM UNITSSOLD U JOIN PRICES P ON U.PRODUCT_ID=P.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) SELECT PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM CTE GROUP BY 1"
299,Y,N,"WITH CTE AS ( SELECT U.PRODUCT_ID, U.UNITS, P.PRICE FROM UNITSSOLD U LEFT JOIN PRICES P ON (U.PRODUCT_ID = P.PRODUCT_ID) AND (U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) ) SELECT PRODUCT_ID, ROUND(SUM(UNITS*PRICE) / SUM(UNITS), 2) AS AVERAGE_PRICE FROM CTE GROUP BY 1"
300,Y,Y,"WITH CTE AS (SELECT P.PRODUCT_ID AS ID,PRICE,UNITS,U.PRODUCT_ID AS ID2 FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) SELECT ID AS PRODUCT_ID, ROUND((SUM(PRICE*UNITS))/SUM(UNITS),2) AS AVERAGE_PRICE FROM CTE GROUP BY PRODUCT_ID"
301,Y,Y,"WITH CTE AS (SELECT P.PRODUCT_ID, P.PRICE*U.UNITS AS TOTAL, U.UNITS AS UNITS FROM PRICES AS P INNER JOIN UNITSSOLD AS U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) SELECT PRODUCT_ID, ROUND(SUM(TOTAL)/SUM(UNITS),2) AS AVERAGE_PRICE FROM CTE GROUP BY PRODUCT_ID"
302,Y,Y,"WITH CTE AS( SELECT P.PRODUCT_ID, PRICE, UNITS, (PRICE * UNITS) TOTAL_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) SELECT DISTINCT PRODUCT_ID, ROUND(SUM(TOTAL_PRICE) / SUM(UNITS),2) AVERAGE_PRICE FROM CTE GROUP BY PRODUCT_ID"
303,Y,Y,"WITH NEW AS ( SELECT U.PRODUCT_ID, U.PURCHASE_DATE, U.UNITS, P.PRICE FROM UNITSSOLD U JOIN PRICES P ON P.PRODUCT_ID = U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE ) SELECT PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/ SUM(UNITS),2) AS AVERAGE_PRICE FROM NEW GROUP BY PRODUCT_ID ORDER BY PRODUCT_ID"
304,Y,Y,"WITH REVENUE AS ( SELECT A.*, B.PURCHASE_DATE, B.UNITS, A.PRICE * B.UNITS AS REVENUE FROM PRICES AS A LEFT JOIN UNITSSOLD AS B ON A.PRODUCT_ID = B.PRODUCT_ID AND A.START_DATE <= B.PURCHASE_DATE AND A.END_DATE >= B.PURCHASE_DATE ) SELECT PRODUCT_ID, ROUND(SUM(REVENUE) / SUM(UNITS), 2) AS AVERAGE_PRICE FROM REVENUE GROUP BY PRODUCT_ID"
305,Y,Y,"WITH SALES AS (SELECT PRICES.PRODUCT_ID,(PRICES.PRICE*UNITSSOLD.UNITS) AS TOTAL_PRICE,UNITSSOLD.UNITS FROM PRICES JOIN UNITSSOLD ON PRICES.PRODUCT_ID=UNITSSOLD.PRODUCT_ID AND UNITSSOLD.PURCHASE_DATE BETWEEN PRICES.START_DATE AND PRICES.END_DATE) SELECT PRODUCT_ID,ROUND(SUM(TOTAL_PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM SALES GROUP BY PRODUCT_ID"
306,Y,Y,"WITH T AS ( SELECT P.PRODUCT_ID,P.PRICE,U.UNITS, P.PRICE*U.UNITS AS TOTAL_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) SELECT PRODUCT_ID,ROUND(SUM(TOTAL_PRICE)/ SUM(UNITS),2)AS AVERAGE_PRICE FROM T GROUP BY PRODUCT_ID"
307,Y,Y,"WITH T AS ( SELECT PRODUCT_ID, PRICE*UNITS AS TOTAL, UNITS FROM PRICES JOIN UNITSSOLD USING(PRODUCT_ID) WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE ) SELECT PRODUCT_ID, ROUND(SUM(TOTAL)/SUM(UNITS), 2) AS AVERAGE_PRICE FROM T GROUP BY PRODUCT_ID ORDER BY PRODUCT_ID"
308,Y,N,"WITH T1 AS ( SELECT PRODUCT_ID, PURCHASE_DATE, SUM(UNITS) AS TOTAL_SOLD FROM UNITSSOLD GROUP BY PRODUCT_ID), T2 AS ( SELECT PRICES.PRODUCT_ID, SUM(PRICE * UNITS) AS TOTAL_DOLLAR_AMOUNT FROM PRICES JOIN UNITSSOLD ON PURCHASE_DATE >= START_DATE AND PURCHASE_DATE <= END_DATE AND PRICES.PRODUCT_ID = UNITSSOLD.PRODUCT_ID GROUP BY PRODUCT_ID) SELECT T1.PRODUCT_ID, ROUND(T2.TOTAL_DOLLAR_AMOUNT/T1.TOTAL_SOLD,2) AS AVERAGE_PRICE FROM T1 JOIN T2 ON T1.PRODUCT_ID = T2.PRODUCT_ID"
309,Y,Y,"WITH TB AS( SELECT P.PRODUCT_ID, U.UNITS, P.PRICE*U.UNITS AS SALES FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) SELECT PRODUCT_ID, ROUND(SUM(SALES)/SUM(UNITS),2) AS AVERAGE_PRICE FROM TB GROUP BY 1"
310,Y,N,"WITH TCTE AS ( SELECT P.PRODUCT_ID, U.PURCHASE_DATE, (P.PRICE * U.UNITS) AS TOTAL FROM PRICES P, UNITSSOLD U WHERE P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE ) SELECT T.PRODUCT_ID,ROUND(SUM(T.TOTAL)/ SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM TCTE T, UNITSSOLD U WHERE T.PRODUCT_ID = U.PRODUCT_ID AND T.PURCHASE_DATE = U.PURCHASE_DATE GROUP BY T.PRODUCT_ID"
311,Y,Y,"WITH TEMP AS ( SELECT P.PRODUCT_ID , PRICE , UNITS , PRICE * UNITS AS TOT_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE ) SELECT PRODUCT_ID , ROUND(SUM(TOT_PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM TEMP GROUP BY PRODUCT_ID"
312,Y,Y,"WITH TEMP AS ( SELECT PR.PRODUCT_ID, PR.START_DATE, PR.END_DATE, PR.PRICE, UN.PURCHASE_DATE, UN.UNITS,PR.PRICE*UN.UNITS AS SALES FROM PRICES PR JOIN UNITSSOLD UN ON UN.PRODUCT_ID=PR.PRODUCT_ID HAVING PURCHASE_DATE BETWEEN START_DATE AND END_DATE ) SELECT PRODUCT_ID, ROUND(SUM(SALES)/SUM(UNITS),2) AS AVERAGE_PRICE FROM TEMP GROUP BY PRODUCT_ID"
313,Y,Y,"WITH TEMP AS ( SELECT U.PRODUCT_ID, U.UNITS, P.PRICE*U.UNITS AS TOTAL_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE ) SELECT PRODUCT_ID, ROUND(SUM(TOTAL_PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM TEMP GROUP BY PRODUCT_ID"
314,Y,Y,"WITH TEMP AS (SELECT U.PRODUCT_ID, SUM(UNITS) AS TOT_UNITS, SUM(PRICE*UNITS) AS TOTAL FROM UNITSSOLD U JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY 1) SELECT PRODUCT_ID, ROUND(TOTAL/TOT_UNITS,2) AS AVERAGE_PRICE FROM TEMP"
315,Y,Y,"WITH TEMP AS( SELECT A.PRODUCT_ID,PRICE,UNITS, SUM(A.PRICE*B.UNITS) AS TOT , SUM(B.UNITS) AS A FROM PRICES A INNER JOIN UNITSSOLD B USING(PRODUCT_ID) WHERE B.PURCHASE_DATE BETWEEN A.START_DATE AND A.END_DATE GROUP BY A.PRODUCT_ID) SELECT PRODUCT_ID , COALESCE(ROUND((TOT/A),2),0) AS AVERAGE_PRICE FROM TEMP GROUP BY PRODUCT_ID"
316,Y,N,"WITH TEMP AS( SELECT P.PRODUCT_ID,P.PRICE,U.UNITS, (PRICE*UNITS) AS TOTAL FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY P.PRODUCT_ID, START_DATE, END_DATE, PURCHASE_DATE, P.PRICE, U.UNITS) SELECT PRODUCT_ID, ROUND((SUM(TEMP.TOTAL)/SUM(TEMP.UNITS)),2) AS AVERAGE_PRICE FROM TEMP GROUP BY PRODUCT_ID"
317,Y,Y,"WITH TEMP(PRODUCT_ID, PRICE, UNITS) AS (SELECT P.PRODUCT_ID, P.PRICE, U.UNITS FROM PRICES P, UNITSSOLD U WHERE P.PRODUCT_ID = U.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE) SELECT PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM TEMP GROUP BY PRODUCT_ID"
318,Y,Y,"WITH TEMP(PRODUCT_ID, PRICE_UNIT, UNITS) AS (SELECT A.PRODUCT_ID, (A.PRICE*B.UNITS) AS PRICE_UNIT, B.UNITS FROM PRICES A INNER JOIN UNITSSOLD B ON A.PRODUCT_ID = B.PRODUCT_ID AND B.PURCHASE_DATE BETWEEN START_DATE AND END_DATE ) SELECT PRODUCT_ID, ROUND(SUM(PRICE_UNIT)/SUM(UNITS), 2) AS AVERAGE_PRICE FROM TEMP GROUP BY PRODUCT_ID ORDER BY PRODUCT_ID"
319,Y,N,"WITH TEMP_PRICE AS ( SELECT U.PRODUCT_ID, P.PRICE*U.UNITS AS T_PRICE, U.UNITS FROM UNITSSOLD U LEFT JOIN PRICES P ON U.PRODUCT_ID=P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE ) SELECT PRODUCT_ID, ROUND(SUM(T_PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM TEMP_PRICE GROUP BY PRODUCT_ID"
320,Y,Y,"WITH TOTALPURCHASE AS ( SELECT PRI.PRODUCT_ID ,SUM(PRICE*UNITS) AS TOTALPRICE ,SUM(UNITS) AS TOTALUNITS FROM PRICES AS PRI JOIN UNITSSOLD AS US ON PRI.PRODUCT_ID = US.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRI.PRODUCT_ID ) SELECT PRODUCT_ID ,ROUND(TOTALPRICE/TOTALUNITS,2) AS AVERAGE_PRICE FROM TOTALPURCHASE"
321,Y,N,"WITH TOTAL_DOLLAR_STEP1 AS( SELECT U.PRODUCT_ID,P.PRICE*U.UNITS AS TOTAL_LINES FROM UNITSSOLD U LEFT JOIN PRICES P ON U.PRODUCT_ID=P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE), TOTAL_DOLLAR_STEP2 AS ( SELECT PRODUCT_ID,SUM(TOTAL_LINES) AS TOTAL_PRICE FROM TOTAL_DOLLAR_STEP1 GROUP BY PRODUCT_ID), UNITS_TOTAL AS(SELECT PRODUCT_ID,SUM(UNITS) AS TOTAL_U FROM UNITSSOLD GROUP BY PRODUCT_ID) SELECT A.PRODUCT_ID,ROUND(A.TOTAL_PRICE/B.TOTAL_U,2) AS AVERAGE_PRICE FROM TOTAL_DOLLAR_STEP2 A INNER JOIN UNITS_TOTAL B ON A.PRODUCT_ID=B.PRODUCT_ID"
322,Y,Y,"WITH U AS ( SELECT PRICES.PRODUCT_ID, PRICES.PRICE, UNITSSOLD.UNITS FROM PRICES, UNITSSOLD WHERE PRICES.START_DATE<=UNITSSOLD.PURCHASE_DATE AND PRICES.END_DATE>=UNITSSOLD.PURCHASE_DATE AND PRICES.PRODUCT_ID=UNITSSOLD.PRODUCT_ID) SELECT PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM U GROUP BY PRODUCT_ID"
323,Y,Y,"WITH W AS ( SELECT A.*, B.UNITS, A.PRICE*B.UNITS AS TOTAL_PRICE FROM PRICES A JOIN UNITSSOLD B ON A.PRODUCT_ID = B.PRODUCT_ID AND B.PURCHASE_DATE BETWEEN A.START_DATE AND A.END_DATE) SELECT PRODUCT_ID, ROUND(SUM(TOTAL_PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM W GROUP BY PRODUCT_ID"
324,Y,Y,"WITH X AS (SELECT P.PRODUCT_ID, P.PRICE , U.UNITS, (P.PRICE*U.UNITS) AS TOTAL_MONEY FROM PRICES AS P JOIN UNITSSOLD AS U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE ) SELECT PRODUCT_ID, ROUND(SUM(TOTAL_MONEY)/SUM(UNITS), 2 ) AS AVERAGE_PRICE FROM X GROUP BY PRODUCT_ID"
325,Y,Y,"SELECT PRICES.PRODUCT_ID, ROUND(SUM(PRICE * UNITS) / SUM(UNITS), 2) AS AVERAGE_PRICE FROM PRICES JOIN UNITSSOLD ON PRICES.PRODUCT_ID = UNITSSOLD.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRODUCT_ID"
326,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE * UNITS) / SUM(UNITS), 2) AS AVERAGE_PRICE FROM PRICES AS P JOIN UNITSSOLD AS U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRODUCT_ID"
327,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY P.PRODUCT_ID"
328,Y,Y,"SELECT PRODUCT_ID, ROUND(SUM(PRICE * UNITS) / SUM(UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD S INNER JOIN PRICES P USING (PRODUCT_ID) WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRODUCT_ID"
329,Y,Y,"SELECT PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U USING(PRODUCT_ID) WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRODUCT_ID"
330,Y,Y,"SELECT S.PRODUCT_ID, ROUND(SUM(P.PRICE*S.UNITS)/SUM(S.UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD S JOIN PRICES P ON S.PRODUCT_ID=P.PRODUCT_ID AND S.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY 1"
331,Y,Y,"SELECT PRICES.PRODUCT_ID,ROUND((SUM(PRICE*UNITS)/SUM(UNITS)),2) AS AVERAGE_PRICE FROM PRICES,UNITSSOLD WHERE PRICES.PRODUCT_ID=UNITSSOLD.PRODUCT_ID AND PURCHASE_DATE>=START_DATE AND PURCHASE_DATE<=END_DATE GROUP BY PRODUCT_ID"
332,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE* UNITS) / SUM(UNITS), 2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRODUCT_ID"
333,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(US.UNITS * P.PRICE) / SUM(US.UNITS), 2) AS AVERAGE_PRICE FROM PRICES AS P JOIN UNITSSOLD AS US ON P.PRODUCT_ID = US.PRODUCT_ID AND US.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
334,Y,Y,"SELECT US.PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/SUM(UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD AS US, PRICES AS P WHERE (US.PRODUCT_ID = P.PRODUCT_ID) AND (PURCHASE_DATE BETWEEN START_DATE AND END_DATE) GROUP BY PRODUCT_ID"
335,Y,Y,"SELECT US.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD AS US INNER JOIN PRICES ON PRICES.PRODUCT_ID = US.PRODUCT_ID WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY US.PRODUCT_ID"
336,Y,Y,"SELECT A.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES A LEFT JOIN UNITSSOLD B ON A.PRODUCT_ID = B.PRODUCT_ID AND B.PURCHASE_DATE >= A.START_DATE AND B.PURCHASE_DATE <= A.END_DATE GROUP BY 1"
337,Y,Y,"WITH CTE AS ( SELECT P.PRODUCT_ID, CASE WHEN U.PURCHASE_DATE BETWEEN START_DATE AND END_DATE THEN UNITS ELSE 0 END AS UNITS_SOLD, PRICE FROM PRICES P INNER JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID) SELECT PRODUCT_ID, ROUND((SUM(PRICE * UNITS_SOLD) / SUM(UNITS_SOLD)),2) AS AVERAGE_PRICE FROM CTE GROUP BY PRODUCT_ID"
338,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE * U.UNITS) / SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
339,Y,Y,"SELECT U.PRODUCT_ID, ( ROUND(SUM(U.UNITS * P.PRICE) / SUM(U.UNITS), 2) ) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
340,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD U ON U.PRODUCT_ID = P.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY PRODUCT_ID"
341,Y,N,"SELECT U.PRODUCT_ID AS PRODUCT_ID, ROUND(SUM(U.UNITS * P.PRICE)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD AS U LEFT OUTER JOIN PRICES AS P ON START_DATE <= PURCHASE_DATE AND PURCHASE_DATE <= END_DATE AND U.PRODUCT_ID = P.PRODUCT_ID GROUP BY PRODUCT_ID"
342,Y,Y,"WITH TMP_TABLE AS ( SELECT PRICES.PRODUCT_ID, PRICE, UNITS, (PRICE * UNITS) AS TOTAL_PRICE FROM PRICES INNER JOIN UNITSSOLD ON PRICES.PRODUCT_ID = UNITSSOLD.PRODUCT_ID AND (UNITSSOLD.PURCHASE_DATE BETWEEN PRICES.START_DATE AND PRICES.END_DATE) ) SELECT PRODUCT_ID, ROUND((SUM(TOTAL_PRICE)/ SUM(UNITS)), 2) AS AVERAGE_PRICE FROM TMP_TABLE GROUP BY PRODUCT_ID"
343,Y,Y,"SELECT T1.PRODUCT_ID, ROUND(SUM(T1.PRICE*T2.UNITS)/SUM(T2.UNITS),2) AVERAGE_PRICE FROM PRICES T1 JOIN UNITSSOLD T2 ON T2.PRODUCT_ID=T1.PRODUCT_ID AND T2.PURCHASE_DATE BETWEEN T1.START_DATE AND T1.END_DATE GROUP BY T1.PRODUCT_ID"
344,Y,Y,"SELECT A.PRODUCT_ID, ROUND(SUM(A.PRICE*B.UNITS)/SUM(B.UNITS),2) AS AVERAGE_PRICE FROM PRICES A INNER JOIN UNITSSOLD B ON A.PRODUCT_ID=B.PRODUCT_ID WHERE B.PURCHASE_DATE BETWEEN A.START_DATE AND A.END_DATE GROUP BY A.PRODUCT_ID"
345,Y,Y,"SELECT P.PRODUCT_ID AS PRODUCT_ID, ROUND((SUM(P.PRICE*U.UNITS)/SUM(U.UNITS)),2) AS AVERAGE_PRICE FROM (SELECT PRODUCT_ID,START_DATE,END_DATE,PRICE FROM PRICES)P LEFT JOIN( SELECT PRODUCT_ID,PURCHASE_DATE,UNITS FROM UNITSSOLD)U ON ((P.PRODUCT_ID = U.PRODUCT_ID) AND (U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE )) GROUP BY PRODUCT_ID"
346,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(U.UNITS*P.PRICE)/SUM(U.UNITS),2) AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
347,Y,Y,"SELECT U.PRODUCT_ID, ROUND(SUM(U.UNITS*P.PRICE)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD U LEFT JOIN PRICES P ON U.PRODUCT_ID=P.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY U.PRODUCT_ID"
348,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS), 2) AS AVERAGE_PRICE FROM PRICES AS P INNER JOIN UNITSSOLD AS S ON P.PRODUCT_ID = S.PRODUCT_ID AND S.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY PRODUCT_ID"
349,Y,Y,"SELECT US.PRODUCT_ID, CAST((SUM(PRICE*UNITS)/SUM(UNITS)) AS DECIMAL(38,2)) AS AVERAGE_PRICE FROM UNITSSOLD US JOIN PRICES P ON US.PRODUCT_ID=P.PRODUCT_ID WHERE US.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY US.PRODUCT_ID"
350,Y,Y,"SELECT PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AVERAGE_PRICE FROM (SELECT P.PRODUCT_ID, P.PRICE, U.UNITS FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND P.START_DATE <= U.PURCHASE_DATE AND P.END_DATE >= U.PURCHASE_DATE) P GROUP BY PRODUCT_ID"
351,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(U.UNITS*P.PRICE)/SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM PRICES AS P LEFT JOIN UNITSSOLD AS U ON P.PRODUCT_ID = U.PRODUCT_ID AND P.START_DATE <= U.PURCHASE_DATE AND U.PURCHASE_DATE <= P.END_DATE GROUP BY PRODUCT_ID"
352,Y,Y,"SELECT PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS), 2) AS AVERAGE_PRICE FROM ( SELECT PRICES.PRODUCT_ID AS PRODUCT_ID, PRICE, UNITSSOLD.UNITS AS UNITS FROM PRICES JOIN UNITSSOLD ON PRICES.PRODUCT_ID = UNITSSOLD.PRODUCT_ID AND PRICES.START_DATE <= UNITSSOLD.PURCHASE_DATE AND PRICES.END_DATE >= UNITSSOLD.PURCHASE_DATE) A GROUP BY PRODUCT_ID"
353,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE * U.UNITS)/SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY PRODUCT_ID"
354,Y,Y,"SELECT A.PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD A JOIN PRICES B ON A.PRODUCT_ID = B.PRODUCT_ID AND A.PURCHASE_DATE BETWEEN B.START_DATE AND B.END_DATE GROUP BY 1"
355,Y,Y,"SELECT P.PRODUCT_ID,ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY 1"
356,Y,Y,"SELECT P.PRODUCT_ID AS PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES AS P LEFT JOIN UNITSSOLD AS U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
357,Y,Y,"SELECT PRICES.PRODUCT_ID, ROUND(SUM(PRICES.PRICE * UNITSSOLD.UNITS) / SUM(UNITSSOLD.UNITS), 2) AS AVERAGE_PRICE FROM PRICES INNER JOIN UNITSSOLD ON UNITSSOLD.PURCHASE_DATE BETWEEN PRICES.START_DATE AND PRICES.END_DATE AND UNITSSOLD.PRODUCT_ID = PRICES.PRODUCT_ID GROUP BY PRICES.PRODUCT_ID"
358,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(U.UNITS * P.PRICE) / SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM PRICES P, UNITSSOLD U WHERE P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY U.PRODUCT_ID"
359,Y,Y,"SELECT P.PRODUCT_ID , ROUND(SUM(P.PRICE * U.UNITS) / SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
360,Y,Y,"SELECT U.PRODUCT_ID, ROUND(SUM(P.PRICE * U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD U JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE >= P.START_DATE AND U.PURCHASE_DATE <= P.END_DATE GROUP BY 1"
361,Y,Y,"SELECT A.PRODUCT_ID, ROUND(SUM(A.PRICE*B.UNITS)/SUM(B.UNITS),2) AS AVERAGE_PRICE FROM PRICES A LEFT JOIN UNITSSOLD B ON A.PRODUCT_ID= B.PRODUCT_ID AND B.PURCHASE_DATE BETWEEN A.START_DATE AND A.END_DATE GROUP BY PRODUCT_ID"
362,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE * IFNULL(UNITS,0)) / SUM(IFNULL(UNITS,0)),2) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY PRODUCT_ID"
363,Y,Y,"SELECT UNITSSOLD.PRODUCT_ID, ROUND(SUM(UNITSSOLD.UNITS * PRICES.PRICE) / SUM(UNITSSOLD.UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD JOIN PRICES ON UNITSSOLD.PRODUCT_ID = PRICES.PRODUCT_ID WHERE UNITSSOLD.PURCHASE_DATE BETWEEN PRICES.START_DATE AND PRICES.END_DATE GROUP BY UNITSSOLD.PRODUCT_ID"
364,Y,Y,"SELECT A.PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES A JOIN UNITSSOLD B ON A.PRODUCT_ID = B.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY A.PRODUCT_ID"
365,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE * U.UNITS) / SUM(UNITS), 2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE <= P.END_DATE AND U.PURCHASE_DATE >= P.START_DATE GROUP BY PRODUCT_ID"
366,Y,Y,"SELECT P.PRODUCT_ID, ROUND((SUM(P.PRICE*US.UNITS)/SUM(US.UNITS)),2) AS AVERAGE_PRICE FROM PRICES P, UNITSSOLD US WHERE P.PRODUCT_ID = US.PRODUCT_ID AND US.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY 1"
367,Y,N,"WITH T1 AS ( SELECT P.PRODUCT_ID, SUM(UNITS*PRICE) AS TOTAL_PRICE FROM UNITSSOLD AS U JOIN PRICES AS P ON PURCHASE_DATE BETWEEN START_DATE AND END_DATE AND U.PRODUCT_ID=P.PRODUCT_ID GROUP BY P.PRODUCT_ID), T2 AS (SELECT PRODUCT_ID, SUM(UNITS) AS TOTAL_UNITS FROM UNITSSOLD GROUP BY PRODUCT_ID) SELECT T1.PRODUCT_ID, ROUND(TOTAL_PRICE/TOTAL_UNITS,2) AS AVERAGE_PRICE FROM T1 JOIN T2 USING(PRODUCT_ID)"
368,Y,Y,"WITH PRICED_UNITS AS ( SELECT U.PRODUCT_ID, U.UNITS, P.PRICE FROM UNITSSOLD U JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE ) ,TOTAL_PRICES AS ( SELECT PRODUCT_ID, UNITS, UNITS*PRICE AS TOTAL_PRICE FROM PRICED_UNITS ) SELECT PRODUCT_ID, ROUND(SUM(TOTAL_PRICE)/SUM(UNITS), 2) AS AVERAGE_PRICE FROM TOTAL_PRICES GROUP BY PRODUCT_ID"
369,Y,Y,"SELECT PID1 AS PRODUCT_ID, ROUND(TOTAL_PRICE / TOTAL_COUNT, 2) AS AVERAGE_PRICE FROM (SELECT PID1, SUM(U * P) AS TOTAL_PRICE, SUM(U) AS TOTAL_COUNT FROM (SELECT PRODUCT_ID AS PID1, PRICE AS P, START_DATE AS S_DATE, END_DATE AS E_DATE FROM PRICES) D1 RIGHT OUTER JOIN (SELECT PRODUCT_ID AS PID2, UNITS AS U, PURCHASE_DATE AS DATE FROM UNITSSOLD) D2 ON D1.PID1 = D2.PID2 WHERE D1.S_DATE <= D2.DATE AND D1.E_DATE >= D2.DATE GROUP BY PID1) D3"
370,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE * T.UNITS) / SUM(T.UNITS), 2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD T ON P.PRODUCT_ID = T.PRODUCT_ID AND T.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
371,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE * U.UNITS) / SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE <= P.END_DATE AND U.PURCHASE_DATE >= P.START_DATE GROUP BY P.PRODUCT_ID"
372,Y,Y,"SELECT A.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES A JOIN UNITSSOLD B ON A.PRODUCT_ID=B.PRODUCT_ID WHERE B.PURCHASE_DATE BETWEEN A.START_DATE AND A.END_DATE GROUP BY 1"
373,Y,Y,"SELECT PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM (SELECT P.*, U.UNITS FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) SUB GROUP BY PRODUCT_ID ORDER BY PRODUCT_ID"
374,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(U.UNITS * P.PRICE)/SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY U.PRODUCT_ID"
375,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE * UNITS) / SUM(UNITS), 2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY P.PRODUCT_ID"
376,Y,Y,"SELECT U.PRODUCT_ID, ROUND(SUM(U.UNITS*P.PRICE)/SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD U JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID WHERE U.PURCHASE_DATE >= P.START_DATE AND U.PURCHASE_DATE <= P.END_DATE GROUP BY U.PRODUCT_ID"
377,Y,Y,"SELECT PRODUCT_ID, IFNULL(ROUND(SUM(TOTAL_PRICE) / SUM(UNITS), 2), 0) AS AVERAGE_PRICE FROM ( SELECT P.PRODUCT_ID AS PRODUCT_ID, UNITS, PRICE * UNITS AS TOTAL_PRICE FROM PRICES P LEFT JOIN UNITSSOLD US ON P.PRODUCT_ID = US.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE ) AS DATES GROUP BY PRODUCT_ID"
378,Y,Y,"SELECT P.PRODUCT_ID, ROUND(IFNULL(SUM(P.PRICE*U.UNITS)/SUM(UNITS),0),2) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY 1"
379,Y,Y,"WITH T1 AS( SELECT *, UNITS * PRICE AS TOTAL FROM (SELECT U.* , P.START_DATE, P.END_DATE, P.PRICE FROM UNITSSOLD U LEFT JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID) AS T WHERE PURCHASE_DATE >= START_DATE AND PURCHASE_DATE <= END_DATE) SELECT PRODUCT_ID, ROUND(SUM(TOTAL)/SUM(UNITS), 2) AS AVERAGE_PRICE FROM T1 GROUP BY PRODUCT_ID"
380,Y,N,"SELECT X.PRODUCT_ID, ROUND((SUM(P.PRICE*X.UNITS)/SUM(X.UNITS)),2) AS AVERAGE_PRICE FROM UNITSSOLD X LEFT JOIN PRICES P ON (X.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE AND X.PRODUCT_ID=P.PRODUCT_ID) GROUP BY 1"
381,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(S.UNITS*P.PRICE) / SUM(S.UNITS),2)AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD S ON P.PRODUCT_ID = S.PRODUCT_ID AND S.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
382,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
383,Y,N,"SELECT U.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD U LEFT JOIN PRICES P ON P.PRODUCT_ID=U.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY U.PRODUCT_ID ORDER BY U.PRODUCT_ID"
384,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE * U.UNITS)/SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE>= P.START_DATE AND U.PURCHASE_DATE<= P.END_DATE GROUP BY P.PRODUCT_ID"
385,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*UNITS)/SUM(UNITS),2) AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID AND U.PURCHASE_DATE >=P.START_DATE AND U.PURCHASE_DATE <=P.END_DATE GROUP BY 1"
386,Y,Y,"WITH SELL AS (SELECT P.PRODUCT_ID, PRICE,UNITS FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE PURCHASE_DATE >= START_DATE AND PURCHASE_DATE <= END_DATE) SELECT PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM SELL GROUP BY PRODUCT_ID"
387,Y,Y,"SELECT PRICES.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES JOIN UNITSSOLD ON PRICES.PRODUCT_ID = UNITSSOLD.PRODUCT_ID WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRICES.PRODUCT_ID"
388,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*S.UNITS) / SUM(S.UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE S.PURCHASE_DATE >= P.START_DATE AND S.PURCHASE_DATE <= P.END_DATE GROUP BY P.PRODUCT_ID"
389,Y,Y,"SELECT PRICES.PRODUCT_ID, ROUND(SUM(PRICES.PRICE*UNITSSOLD.UNITS)/SUM(UNITSSOLD.UNITS),2) AS AVERAGE_PRICE FROM PRICES INNER JOIN UNITSSOLD ON UNITSSOLD.PURCHASE_DATE BETWEEN PRICES.START_DATE AND PRICES.END_DATE AND UNITSSOLD.PRODUCT_ID = PRICES.PRODUCT_ID GROUP BY UNITSSOLD.PRODUCT_ID"
390,Y,Y,"WITH CTE AS ( SELECT A.PRODUCT_ID, SUM(A.PRICE*B.UNITS) AS TOTAL,SUM(B.UNITS) AS UNITS FROM PRICES A LEFT JOIN UNITSSOLD B ON A.PRODUCT_ID=B.PRODUCT_ID WHERE B.PURCHASE_DATE>=A.START_DATE AND B.PURCHASE_DATE<= A.END_DATE GROUP BY A.PRODUCT_ID ) SELECT PRODUCT_ID,ROUND(TOTAL/SUM(UNITS),2) AS AVERAGE_PRICE FROM CTE GROUP BY 1 ORDER BY 1 ASC"
391,Y,Y,"SELECT DISTINCT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
392,Y,N,"SELECT UNITSSOLD.PRODUCT_ID, ROUND(SUM(UNITS * PRICE) / SUM(UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD LEFT JOIN PRICES ON PRICES.START_DATE <= UNITSSOLD.PURCHASE_DATE AND UNITSSOLD.PURCHASE_DATE <= PRICES.END_DATE AND PRICES.PRODUCT_ID = UNITSSOLD.PRODUCT_ID GROUP BY UNITSSOLD.PRODUCT_ID"
393,Y,Y,"SELECT P.PRODUCT_ID, ROUND( SUM(UNITS*PRICE )/ SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID AND PURCHASE_DATE<=END_DATE AND PURCHASE_DATE>=START_DATE GROUP BY P.PRODUCT_ID"
394,Y,Y,"SELECT T.PRODUCT_ID, ROUND(SUM(PRICE*UNITS) / SUM(UNITS), 2) AS AVERAGE_PRICE FROM PRICES T JOIN UNITSSOLD S ON T.PRODUCT_ID = S.PRODUCT_ID AND S.PURCHASE_DATE BETWEEN T.START_DATE AND T.END_DATE GROUP BY PRODUCT_ID"
395,Y,Y,"SELECT P.PRODUCT_ID AS PRODUCT_ID,ROUND(SUM(U.UNITS * P.PRICE)/ SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID AND (PURCHASE_DATE BETWEEN START_DATE AND END_DATE) GROUP BY P.PRODUCT_ID"
396,Y,Y,"WITH PRICED_UNITS AS ( SELECT U.PRODUCT_ID, U.UNITS, P.PRICE*U.UNITS AS TOTAL_PRICE FROM UNITSSOLD U INNER JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE ) SELECT PRODUCT_ID, ROUND(SUM(TOTAL_PRICE)/SUM(UNITS), 2) AS AVERAGE_PRICE FROM PRICED_UNITS GROUP BY PRODUCT_ID"
397,Y,Y,"SELECT U.PRODUCT_ID, ROUND(SUM(U.UNITS*P.PRICE)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
398,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE U.PURCHASE_DATE >= P.START_DATE AND U.PURCHASE_DATE<=P.END_DATE GROUP BY P.PRODUCT_ID"
399,Y,Y,"SELECT S.PRODUCT_ID, ROUND(SUM(S.UNITS*P.PRICE)/SUM(S.UNITS),2) AS AVERAGE_PRICE FROM PRICES AS P INNER JOIN UNITSSOLD AS S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE S.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY S.PRODUCT_ID"
400,Y,Y,"SELECT PRICES.PRODUCT_ID AS PRODUCT_ID,ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES, UNITSSOLD WHERE PRICES.PRODUCT_ID=UNITSSOLD.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRODUCT_ID"
401,Y,N,"SELECT T2.PRODUCT_ID, ROUND(T2.REVENUE/T2.AMT,2) AS AVERAGE_PRICE FROM (SELECT A.PRODUCT_ID, SUM(A.UNITS*B.PRICE) AS REVENUE, SUM(A.UNITS) AS AMT FROM UNITSSOLD A LEFT JOIN PRICES B ON (A.PRODUCT_ID=B.PRODUCT_ID AND A.PURCHASE_DATE>=B.START_DATE AND A.PURCHASE_DATE<=B.END_DATE) GROUP BY A.PRODUCT_ID)T2"
402,Y,Y,"SELECT PRODUCT_ID,ROUND(SUM(SALES)/SUM(UNITS),2) AS AVERAGE_PRICE FROM (SELECT P.PRODUCT_ID,P.PRICE*U.UNITS AS SALES, U.UNITS FROM PRICES AS P JOIN UNITSSOLD AS U ON P.PRODUCT_ID=U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) AS J GROUP BY PRODUCT_ID"
403,Y,N,"SELECT U.PRODUCT_ID, ROUND(SUM(P.PRICE * U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD U LEFT JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY U.PRODUCT_ID"
404,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(U.UNITS * P.PRICE) / SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY PRODUCT_ID"
405,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE START_DATE<=PURCHASE_DATE AND PURCHASE_DATE<=END_DATE GROUP BY P.PRODUCT_ID"
406,Y,Y,"SELECT PRICES.PRODUCT_ID, ROUND((SUM(PRICE*UNITS) / SUM(UNITS)), 2) AS AVERAGE_PRICE FROM PRICES JOIN UNITSSOLD ON PRICES.PRODUCT_ID = UNITSSOLD.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRODUCT_ID"
407,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES AS P LEFT JOIN UNITSSOLD AS U ON P.PRODUCT_ID = U.PRODUCT_ID AND P.START_DATE<=U.PURCHASE_DATE AND P.END_DATE>=U.PURCHASE_DATE GROUP BY 1"
408,Y,Y,"WITH AVG_PRICE AS ( SELECT U.PRODUCT_ID, SUM(P.PRICE * U.UNITS) AS TOT_PRICE, SUM(U.UNITS) AS CNT FROM UNITSSOLD U INNER JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY U.PRODUCT_ID ) SELECT PRODUCT_ID, ROUND(TOT_PRICE / CNT, 2) AS AVERAGE_PRICE FROM AVG_PRICE"
409,Y,Y,"WITH T1 AS( SELECT P.PRODUCT_ID AS PRODUCT_ID, S.UNITS AS QUANTITY, P.PRICE*S.UNITS AS SALES FROM PRICES P LEFT JOIN UNITSSOLD S ON P.PRODUCT_ID=S.PRODUCT_ID AND S.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE ) SELECT T1.PRODUCT_ID AS PRODUCT_ID, ROUND(SUM(T1.SALES)/SUM(T1.QUANTITY),2) AS AVERAGE_PRICE FROM T1 GROUP BY T1.PRODUCT_ID"
410,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE * U.UNITS)/ SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE AND P.PRODUCT_ID = U.PRODUCT_ID GROUP BY 1"
411,Y,N,"SELECT U.PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/SUM(UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD U LEFT JOIN PRICES P ON U.PRODUCT_ID=P.PRODUCT_ID AND (PURCHASE_DATE BETWEEN START_DATE AND END_DATE) GROUP BY U.PRODUCT_ID"
412,Y,Y,"SELECT TEMP.PRODUCT_ID AS PRODUCT_ID, ROUND(SUM(TEMP.UNITS * TEMP.PRODUCT_PRICE) / SUM(TEMP.UNITS), 2) AS AVERAGE_PRICE FROM (SELECT PRICES.PRICE AS PRODUCT_PRICE, PRICES.PRODUCT_ID, UNITSSOLD.UNITS FROM UNITSSOLD JOIN PRICES ON UNITSSOLD.PRODUCT_ID = PRICES.PRODUCT_ID WHERE UNITSSOLD.PURCHASE_DATE BETWEEN PRICES.START_DATE AND PRICES.END_DATE ) AS TEMP GROUP BY TEMP.PRODUCT_ID"
413,Y,Y,"SELECT U.PRODUCT_ID, ROUND(SUM(PRICE * UNITS) / SUM(UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD U JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND (U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) GROUP BY U.PRODUCT_ID"
414,Y,Y,"SELECT U.PRODUCT_ID, ROUND(SUM(UNITS * P.PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD U ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY U.PRODUCT_ID"
415,Y,Y,"SELECT DISTINCT P.PRODUCT_ID, ROUND(( SUM(P.PRICE * U.UNITS) OVER(PARTITION BY P.PRODUCT_ID) / SUM(U.UNITS) OVER (PARTITION BY P.PRODUCT_ID) ), 2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE"
416,Y,Y,"SELECT DISTINCT P.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/(SUM(UNITS)),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY 1"
417,Y,Y,"SELECT P.PRODUCT_ID,ROUND(SUM(S.UNITS*P.PRICE)/SUM(S.UNITS),2) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD S ON P.PRODUCT_ID=S.PRODUCT_ID AND S.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
418,Y,Y,"SELECT U.PRODUCT_ID, ROUND(SUM(U.UNITS * P.PRICE) / SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRODUCT_ID"
419,Y,Y,"SELECT P.PRODUCT_ID,ROUND(SUM(P.PRICE*U.UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND P.START_DATE<=U.PURCHASE_DATE AND U.PURCHASE_DATE<=P.END_DATE GROUP BY 1"
420,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE * U.UNITS) / SUM(UNITS), 2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY PRODUCT_ID"
421,Y,Y,"SELECT A.PRODUCT_ID, ROUND(SUM(A.PRICE*B.UNITS)/SUM(B.UNITS),2) AS AVERAGE_PRICE FROM PRICES AS A INNER JOIN UNITSSOLD AS B ON B.PURCHASE_DATE BETWEEN A.START_DATE AND A.END_DATE AND A.PRODUCT_ID =B.PRODUCT_ID GROUP BY A.PRODUCT_ID"
422,Y,Y,"WITH T1 AS ( SELECT U.PRODUCT_ID, PRICE, UNITS FROM UNITSSOLD U JOIN PRICES P ON U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE AND U.PRODUCT_ID = P.PRODUCT_ID ) SELECT PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM T1 GROUP BY 1"
423,Y,Y,"SELECT UNITSSOLD.PRODUCT_ID, ROUND(SUM(UNITSSOLD.UNITS*PRICES.PRICE)/SUM(UNITSSOLD.UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD INNER JOIN PRICES ON UNITSSOLD.PRODUCT_ID = PRICES.PRODUCT_ID WHERE UNITSSOLD.PURCHASE_DATE BETWEEN PRICES.START_DATE AND PRICES.END_DATE GROUP BY UNITSSOLD.PRODUCT_ID"
424,Y,Y,"SELECT P.PRODUCT_ID , ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD U ON U.PRODUCT_ID = P.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
425,Y,Y,"SELECT U.PRODUCT_ID, ROUND(SUM(P.PRICE * U.UNITS)/ IFNULL(SUM(U.UNITS), 0 ), 2) AS AVERAGE_PRICE FROM PRICES AS P LEFT JOIN UNITSSOLD AS U ON U.PRODUCT_ID = P.PRODUCT_ID WHERE P.START_DATE <= U.PURCHASE_DATE AND P.END_DATE >= U.PURCHASE_DATE GROUP BY P.PRODUCT_ID"
426,Y,Y,"SELECT A.PRODUCT_ID AS PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES A INNER JOIN UNITSSOLD B ON A.PRODUCT_ID = B.PRODUCT_ID AND (PURCHASE_DATE BETWEEN START_DATE AND END_DATE ) GROUP BY A.PRODUCT_ID"
427,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY PRODUCT_ID"
428,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(U.UNITS*P.PRICE) / SUM(U.UNITS) , 2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND (U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) GROUP BY P.PRODUCT_ID"
429,Y,Y,"SELECT A.PRODUCT_ID,ROUND(SUM(A.PRICE*B.UNITS)/SUM(B.UNITS),2) AS AVERAGE_PRICE FROM PRICES A JOIN UNITSSOLD B ON A.PRODUCT_ID=B.PRODUCT_ID AND PURCHASE_DATE<=END_DATE AND PURCHASE_DATE>=START_DATE GROUP BY A.PRODUCT_ID"
430,Y,Y,"WITH TB1 AS (SELECT U.PRODUCT_ID, UNITS, PRICE * UNITS AS REVENUE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) SELECT PRODUCT_ID, ROUND(SUM(REVENUE) / SUM(UNITS), 2) AS AVERAGE_PRICE FROM TB1 GROUP BY PRODUCT_ID"
431,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*S.UNITS)/ SUM(S.UNITS) ,2) AS AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD S ON S.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE AND S.PRODUCT_ID = P.PRODUCT_ID GROUP BY P.PRODUCT_ID"
432,Y,Y,"WITH A AS ( SELECT P.PRODUCT_ID AS PRODUCT_ID, P.START_DATE AS START_DATE, P.END_DATE AS END_DATE, P.PRICE AS PRICE, U.PURCHASE_DATE AS P_DATE, U.UNITS AS UNITS FROM PRICES P JOIN UNITSSOLD U WHERE P.PRODUCT_ID = U.PRODUCT_ID AND P.START_DATE <= U.PURCHASE_DATE AND P.END_DATE >= U.PURCHASE_DATE ) SELECT PRODUCT_ID, ROUND(SUM(PRICE * UNITS) / SUM(UNITS), 2) AS AVERAGE_PRICE FROM A GROUP BY PRODUCT_ID"
433,Y,Y,"SELECT P.PRODUCT_ID, IF(SUM(U.UNITS) IS NOT NULL, ROUND(SUM(P.PRICE * U.UNITS)/SUM(U.UNITS),2),0 ) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY 1"
434,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE * U.UNITS) / SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES AS P JOIN UNITSSOLD AS U ON ((U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) AND (P.PRODUCT_ID = U.PRODUCT_ID)) GROUP BY P.PRODUCT_ID"
435,Y,Y,"SELECT PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS), 2) AS AVERAGE_PRICE FROM ( SELECT * FROM UNITSSOLD LEFT JOIN PRICES USING(PRODUCT_ID) ) T WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRODUCT_ID"
436,Y,Y,"SELECT P.PRODUCT_ID, IF(SUM(U.UNITS) IS NOT NULL, ROUND(SUM(P.PRICE * U.UNITS) / SUM(U.UNITS), 2), 0) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY PRODUCT_ID"
437,N,N,"SELECT U1.PRODUCT_ID, ROUND((SUM( (SELECT P1.PRICE FROM PRICES AS P1 WHERE U1.PURCHASE_DATE BETWEEN P1.START_DATE AND P1.END_DATE AND P1.PRODUCT_ID = U1.PRODUCT_ID) * U1.UNITS ) / SUM(UNITS)), 2) AS AVERAGE_PRICE FROM UNITSSOLD AS U1 GROUP BY U1.PRODUCT_ID"
438,Y,Y,"SELECT P.PRODUCT_ID PRODUCT_ID, ROUND(SUM(PRICE * UNITS)/SUM(UNITS), 2) AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
439,Y,Y,"WITH TB AS (SELECT U.PRODUCT_ID, U.PURCHASE_DATE, U.UNITS, P.PRICE FROM UNITSSOLD U INNER JOIN PRICES P ON U.PRODUCT_ID=P.PRODUCT_ID AND U.PURCHASE_DATE >= P.START_DATE AND U.PURCHASE_DATE <= P.END_DATE) SELECT PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM TB GROUP BY PRODUCT_ID"
440,Y,Y,"SELECT U.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD U JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY U.PRODUCT_ID"
441,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(UNITS * PRICE)/SUM(UNITS), 2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY P.PRODUCT_ID"
442,Y,Y,"SELECT PRODUCT_ID , ROUND(SUM(TOTAL_PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM ( SELECT US.PRODUCT_ID ,UNITS , (PRICE*UNITS) AS TOTAL_PRICE FROM UNITSSOLD US JOIN PRICES P ON US.PRODUCT_ID = P.PRODUCT_ID AND US.PURCHASE_DATE >= P.START_DATE AND US.PURCHASE_DATE <=P.END_DATE ) A GROUP BY PRODUCT_ID"
443,Y,Y,"SELECT UNITSSOLD.PRODUCT_ID , ROUND( SUM(PRICE*UNITS)/SUM(UNITS) ,2) AS AVERAGE_PRICE FROM UNITSSOLD INNER JOIN PRICES ON UNITSSOLD.PRODUCT_ID = PRICES.PRODUCT_ID WHERE PURCHASE_DATE BETWEEN START_DATE AND IFNULL(END_DATE , DATE'9999-12-01') GROUP BY UNITSSOLD.PRODUCT_ID"
444,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(UNITS*PRICE) / SUM(UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD U JOIN PRICES P ON START_DATE <= PURCHASE_DATE AND END_DATE >= PURCHASE_DATE AND U.PRODUCT_ID = P.PRODUCT_ID GROUP BY P.PRODUCT_ID"
445,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2)AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRODUCT_ID"
446,Y,N,"SELECT A.PRODUCT_ID, ROUND(SUM(REV_BY_DATE)/SUM(A.UNITS),2) AS AVERAGE_PRICE FROM ( SELECT P.PRODUCT_ID, US.PURCHASE_DATE, P.PRICE*US.UNITS AS REV_BY_DATE, US.UNITS FROM PRICES P JOIN UNITSSOLD US ON US.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE AND P.PRODUCT_ID = US.PRODUCT_ID GROUP BY P.PRODUCT_ID, US.PURCHASE_DATE ) A GROUP BY A.PRODUCT_ID"
447,Y,N,"WITH SOLD_PRICE AS ( SELECT U.PRODUCT_ID, U.UNITS, U.UNITS * P.PRICE AS TOTAL_PRICE FROM UNITSSOLD AS U LEFT JOIN PRICES AS P ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE >= P.START_DATE AND U.PURCHASE_DATE <= P.END_DATE ) SELECT PRODUCT_ID, ROUND(SUM(TOTAL_PRICE)/SUM(UNITS), 2) AS AVERAGE_PRICE FROM SOLD_PRICE GROUP BY PRODUCT_ID"
448,Y,N,"SELECT T1.PRODUCT_ID, ROUND(SUM(T1.TTL_SALES)/T2.TTL_UNITS,2) AS AVERAGE_PRICE FROM (SELECT P1.PRODUCT_ID, (P1.PRICE*U1.UNITS) AS TTL_SALES FROM PRICES AS P1 JOIN UNITSSOLD AS U1 ON P1.PRODUCT_ID = U1.PRODUCT_ID WHERE U1.PURCHASE_DATE BETWEEN P1.START_DATE AND P1.END_DATE) AS T1 JOIN (SELECT PRODUCT_ID, SUM(UNITS) AS TTL_UNITS FROM UNITSSOLD GROUP BY PRODUCT_ID) AS T2 ON T1.PRODUCT_ID = T2.PRODUCT_ID GROUP BY T1.PRODUCT_ID"
449,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE * U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE <= P.END_DATE AND U.PURCHASE_DATE >= P.START_DATE GROUP BY P.PRODUCT_ID"
450,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD U ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY PRODUCT_ID"
451,Y,Y,"SELECT PRICES.PRODUCT_ID, IF(SUM(UNITSSOLD.UNITS) IS NOT NULL, ROUND(SUM(UNITSSOLD.UNITS * PRICES.PRICE) / SUM(UNITSSOLD.UNITS), 2), 0) AS AVERAGE_PRICE FROM PRICES LEFT JOIN UNITSSOLD ON PRICES.PRODUCT_ID = UNITSSOLD.PRODUCT_ID AND UNITSSOLD.PURCHASE_DATE BETWEEN PRICES.START_DATE AND PRICES.END_DATE GROUP BY PRICES.PRODUCT_ID"
452,Y,Y,"SELECT PRODUCT_ID, ROUND(SUM(SUBTOTAL)/SUM(UNITS),2) AS AVERAGE_PRICE FROM ( SELECT A.PRODUCT_ID, A.UNITS, B.PRICE * A.UNITS AS SUBTOTAL FROM UNITSSOLD A JOIN PRICES B ON A.PRODUCT_ID = B.PRODUCT_ID AND A.PURCHASE_DATE BETWEEN B.START_DATE AND B.END_DATE ) T GROUP BY PRODUCT_ID"
453,Y,N,"SELECT A.PRODUCT_ID, ROUND( SUM(A.PRICE * B.UNITS) / SUM(B.UNITS), 2 ) AS AVERAGE_PRICE FROM PRICES AS A RIGHT JOIN UNITSSOLD AS B ON A.PRODUCT_ID = B.PRODUCT_ID AND (B.PURCHASE_DATE BETWEEN A.START_DATE AND A.END_DATE) GROUP BY A.PRODUCT_ID"
454,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(UNITS * PRICE)*1.0 / SUM(UNITS) * 1.0 , 2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY P.PRODUCT_ID"
455,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE PURCHASE_DATE >= START_DATE AND PURCHASE_DATE <= END_DATE GROUP BY PRODUCT_ID"
456,Y,Y,"WITH JOINED_TABLE AS ( SELECT P.PRODUCT_ID, P.PRICE, U.UNITS, P.PRICE * U.UNITS AS TOTAL_PAID FROM PRICES P JOIN UNITSSOLD U USING (PRODUCT_ID) WHERE U.PURCHASE_DATE >= P.START_DATE AND U.PURCHASE_DATE <= P.END_DATE ), AGGREGATED_DATA AS ( SELECT PRODUCT_ID, SUM(TOTAL_PAID) AS TOTAL_PAID, SUM(UNITS) AS TOTAL_UNITS FROM JOINED_TABLE GROUP BY PRODUCT_ID ) SELECT PRODUCT_ID, ROUND(TOTAL_PAID/TOTAL_UNITS, 2) AS AVERAGE_PRICE FROM AGGREGATED_DATA"
457,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE * U.UNITS) / SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON U.PURCHASE_DATE >= P.START_DATE AND U.PURCHASE_DATE <= P.END_DATE AND P.PRODUCT_ID = U.PRODUCT_ID GROUP BY P.PRODUCT_ID"
458,Y,Y,"SELECT P.PRODUCT_ID , ROUND(SUM(P.PRICE * U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES AS P JOIN UNITSSOLD AS U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY 1"
459,Y,N,"SELECT U.PRODUCT_ID, ROUND(SUM(U.UNITS*P.PRICE)/SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD U LEFT JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY U.PRODUCT_ID"
460,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(SALESAMOUNT) / SUM(TOTALSOLD), 2 ) AS AVERAGE_PRICE FROM PRICES P INNER JOIN ( SELECT P.PRODUCT_ID AS P_ID , UNITS AS TOTALSOLD , P.PRICE AS PRICING , UNITS * P.PRICE AS SALESAMOUNT FROM PRICES P INNER JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE ) AS SALES ON P.PRODUCT_ID=SALES.P_ID GROUP BY PRODUCT_ID"
461,Y,Y,"SELECT U.PRODUCT_ID, ROUND(SUM(U.UNITS * P.PRICE) / SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P, UNITSSOLD U WHERE P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY U.PRODUCT_ID"
462,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(UNITS * PRICE)*1.0 / SUM(UNITS) * 1.0 , 2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
463,Y,Y,"SELECT P.PRODUCT_ID,ROUND(SUM(PRICE*UNITS) / SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
464,Y,N,"SELECT PRODUCT_ID, ROUND(SUM(INCOME)/SUM(UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD JOIN (SELECT U.PRODUCT_ID, PRICE * UNITS AS INCOME FROM UNITSSOLD U JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) G USING (PRODUCT_ID) GROUP BY PRODUCT_ID"
465,Y,Y,"SELECT U.PRODUCT_ID, ROUND(SUM( U.UNITS * P.PRICE ) / SUM( U.UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD U INNER JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID WHERE U.PURCHASE_DATE >= P.START_DATE AND U.PURCHASE_DATE <= P.END_DATE GROUP BY U.PRODUCT_ID"
466,Y,Y,"SELECT U.PRODUCT_ID, ROUND(SUM(U.UNITS*P.PRICE)/SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD AS U JOIN PRICES AS P ON U.PRODUCT_ID=P.PRODUCT_ID AND P.START_DATE <= U.PURCHASE_DATE AND U.PURCHASE_DATE <=P.END_DATE GROUP BY U.PRODUCT_ID"
467,Y,Y,"WITH PRICED_UNITS AS ( SELECT U.PRODUCT_ID, U.UNITS, P.PRICE FROM UNITSSOLD U JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE >= P.START_DATE AND U.PURCHASE_DATE <= P.END_DATE ) ,TOTAL_PRICES AS ( SELECT PRODUCT_ID, UNITS, UNITS*PRICE AS TOTAL_PRICE FROM PRICED_UNITS ) SELECT PRODUCT_ID, ROUND(SUM(TOTAL_PRICE)/SUM(UNITS), 2) AS AVERAGE_PRICE FROM TOTAL_PRICES GROUP BY PRODUCT_ID"
468,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE * U.UNITS) / SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD U ON U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE AND U.PRODUCT_ID = P.PRODUCT_ID GROUP BY PRODUCT_ID"
469,Y,Y,"SELECT US.PRODUCT_ID, ROUND((SUM(PRICE * UNITS)/ SUM(UNITS)),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD US ON P.PRODUCT_ID = US.PRODUCT_ID AND (PURCHASE_DATE BETWEEN START_DATE AND END_DATE) GROUP BY US.PRODUCT_ID"
470,Y,N,"SELECT U.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD U LEFT JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY U.PRODUCT_ID"
471,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES AS P INNER JOIN UNITSSOLD AS U ON P.PRODUCT_ID=U.PRODUCT_ID AND U.PURCHASE_DATE>=P.START_DATE AND U.PURCHASE_DATE<=P.END_DATE GROUP BY 1"
472,Y,Y,"SELECT PRODUCT_ID, ROUND(SUM(PRICE * UNITS) / SUM(UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD U JOIN PRICES P USING (PRODUCT_ID) WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY 1"
473,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*US.UNITS) / SUM(US.UNITS), 2) AS AVERAGE_PRICE FROM PRICES AS P LEFT JOIN UNITSSOLD AS US ON P.PRODUCT_ID = US.PRODUCT_ID AND US.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
474,Y,Y,"SELECT P.PRODUCT_ID, ROUND((SUM(UNITS*PRICE) / SUM(UNITS)), 2) AS AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY P.PRODUCT_ID"
475,Y,Y,"WITH A AS ( SELECT A.PRODUCT_ID, A.PRICE*B.UNITS AS P, B.UNITS AS T FROM PRICES A JOIN UNITSSOLD B ON A.PRODUCT_ID = B.PRODUCT_ID AND B.PURCHASE_DATE BETWEEN A.START_DATE AND A.END_DATE ) SELECT PRODUCT_ID, ROUND(SUM(P)/SUM(T),2) AS AVERAGE_PRICE FROM A GROUP BY PRODUCT_ID"
476,Y,Y,"SELECT U.PRODUCT_ID , ROUND(SUM(U.UNITS*P.PRICE)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD U JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY PRODUCT_ID"
477,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P, UNITSSOLD U WHERE (P.PRODUCT_ID=U.PRODUCT_ID) AND (U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) GROUP BY P.PRODUCT_ID"
478,Y,Y,"SELECT U.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS), 2) AVERAGE_PRICE FROM UNITSSOLD U INNER JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY 1"
479,Y,Y,"WITH CTE AS( SELECT P.PRODUCT_ID,PRICE,UNITS FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE) SELECT PRODUCT_ID, ROUND((SUM(PRICE*UNITS)/SUM(UNITS)),2) AS AVERAGE_PRICE FROM CTE GROUP BY PRODUCT_ID"
480,Y,Y,"SELECT P.PRODUCT_ID , ROUND(SUM(P.PRICE * S.UNITS) / SUM(UNITS), 2) AS AVERAGE_PRICE FROM PRICES P, UNITSSOLD S WHERE P.PRODUCT_ID = S.PRODUCT_ID AND PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY PRODUCT_ID"
481,Y,Y,"SELECT A.PRODUCT_ID, CAST(SUM(UNITS*PRICE)/SUM(UNITS) AS DECIMAL(19,2)) AS AVERAGE_PRICE FROM UNITSSOLD A JOIN PRICES B ON A.PRODUCT_ID = B.PRODUCT_ID AND A.PURCHASE_DATE BETWEEN B.START_DATE AND B.END_DATE GROUP BY PRODUCT_ID"
482,Y,Y,"SELECT U.PRODUCT_ID AS PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD U LEFT JOIN PRICES P ON P.PRODUCT_ID=U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY U.PRODUCT_ID"
483,Y,Y,"SELECT PRODUCT_ID, ROUND(SUM(AMOUNT) / SUM(SOLD_UNITS), 2) AS AVERAGE_PRICE FROM ( SELECT A.PRODUCT_ID, A.PRICE * B.UNITS AS AMOUNT, B.UNITS AS SOLD_UNITS FROM PRICES AS A INNER JOIN UNITSSOLD AS B ON B.PRODUCT_ID = A.PRODUCT_ID AND B.PURCHASE_DATE >= A.START_DATE AND B.PURCHASE_DATE <= A.END_DATE ) AS T GROUP BY PRODUCT_ID"
484,Y,N,"SELECT PRODUCT_ID, ROUND(SUM(PRICE * UNITS) / SUM(UNITS), 2) AS AVERAGE_PRICE FROM (SELECT U.PRODUCT_ID, START_DATE, PRICE, SUM(UNITS) AS UNITS FROM PRICES AS P JOIN UNITSSOLD AS U ON P.PRODUCT_ID = U.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY U.PRODUCT_ID, START_DATE) AS T GROUP BY PRODUCT_ID"
485,Y,N,"WITH UNIQUES AS ( SELECT DISTINCT PRODUCT_ID, PURCHASE_DATE, UNITS FROM UNITSSOLD ) SELECT U.PRODUCT_ID, ROUND(SUM(U.UNITS * P.PRICE) / SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM UNIQUES U JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY U.PRODUCT_ID"
486,Y,Y,"SELECT P.PRODUCT_ID, ROUND((SUM(P.PRICE * U.UNITS)/SUM(U.UNITS)),2) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
487,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE * U.UNITS)/ IFNULL(SUM(U.UNITS), 0 ), 2) AS AVERAGE_PRICE FROM PRICES AS P INNER JOIN UNITSSOLD AS U ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
488,Y,N,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD U LEFT JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE >= P.START_DATE AND U.PURCHASE_DATE <= P.END_DATE GROUP BY 1"
489,Y,Y,"SELECT U.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES AS P, UNITSSOLD AS U WHERE U.PRODUCT_ID=P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY U.PRODUCT_ID"
490,Y,Y,"SELECT U.PRODUCT_ID , ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD U JOIN PRICES P ON U.PRODUCT_ID=P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY U.PRODUCT_ID"
491,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(U.UNITS*P.PRICE)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
492,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/SUM(UNITS), 2) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY P.PRODUCT_ID"
493,Y,Y,"SELECT UNITSSOLD.PRODUCT_ID, ROUND(SUM(UNITS * PRICE) / SUM(UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD LEFT JOIN PRICES ON PRICES.PRODUCT_ID = UNITSSOLD.PRODUCT_ID WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY 1"
494,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(U.UNITS*P.PRICE)/ SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY PRODUCT_ID"
495,Y,Y,"SELECT P.PRODUCT_ID,ROUND(SUM(U.UNITS*P.PRICE)/SUM(U.UNITS),2)AS AVERAGE_PRICE FROM PRICES AS P JOIN UNITSSOLD AS U ON P.PRODUCT_ID=U.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRODUCT_ID"
496,Y,Y,"SELECT PRODUCT_ID, ROUND(SUM(US.UNITS * P.PRICE) / SUM(US.UNITS), 2) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD US USING (PRODUCT_ID) WHERE US.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY PRODUCT_ID"
497,Y,Y,"SELECT PRODUCT_ID, ROUND(SUM(PRICE * UNITS) / SUM(UNITS), 2) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U USING (PRODUCT_ID) WHERE U.PURCHASE_DATE >= P.START_DATE AND U.PURCHASE_DATE <= P.END_DATE GROUP BY PRODUCT_ID"
498,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(U.UNITS*P.PRICE)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRODUCT_ID"
499,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE*UNITS) / SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P, UNITSSOLD U WHERE P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
500,Y,Y,"SELECT U.PRODUCT_ID, ROUND(SUM(PRICE*UNITS) / SUM(UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD U JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID WHERE PURCHASE_DATE >= START_DATE AND PURCHASE_DATE <= END_DATE GROUP BY 1"
501,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P, UNITSSOLD U WHERE P.PRODUCT_ID = U.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY U.PRODUCT_ID"
502,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY 1"
503,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE >= P.START_DATE AND U.PURCHASE_DATE <= P.END_DATE GROUP BY 1"
504,Y,Y,"SELECT UNITS.PRODUCT_ID , ROUND(SUM(PRICES.PRICE * UNITS.UNITS) / SUM(UNITS.UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD AS UNITS LEFT JOIN PRICES AS PRICES USING (PRODUCT_ID) WHERE UNITS.PURCHASE_DATE BETWEEN PRICES.START_DATE AND PRICES.END_DATE GROUP BY UNITS.PRODUCT_ID"
505,Y,Y,"SELECT UNITSSOLD.PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/SUM(UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD INNER JOIN PRICES ON UNITSSOLD.PRODUCT_ID = PRICES.PRODUCT_ID AND UNITSSOLD.PURCHASE_DATE BETWEEN PRICES.START_DATE AND PRICES.END_DATE GROUP BY UNITSSOLD.PRODUCT_ID"
506,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY P.PRODUCT_ID"
507,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY P.PRODUCT_ID"
508,Y,Y,"WITH RECURSIVE CTE (PURCHASE_DATE) AS ( SELECT MIN(START_DATE) FROM PRICES UNION ALL SELECT DATE_ADD(PURCHASE_DATE, INTERVAL 1 DAY) FROM CTE WHERE PURCHASE_DATE <= (SELECT MAX(END_DATE) FROM PRICES) ) SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE * U.UNITS)/SUM(UNITS),2) AVERAGE_PRICE FROM PRICES P LEFT JOIN CTE D ON (D.PURCHASE_DATE >= P.START_DATE) AND (D.PURCHASE_DATE <= P.END_DATE) INNER JOIN UNITSSOLD U ON ((U.PRODUCT_ID = P.PRODUCT_ID) AND (D.PURCHASE_DATE = U.PURCHASE_DATE)) GROUP BY P.PRODUCT_ID"
509,Y,Y,"SELECT PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U USING (PRODUCT_ID) WHERE U.PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRODUCT_ID"
510,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(U.UNITS * P.PRICE)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD U JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
511,Y,N,"SELECT U.PRODUCT_ID AS PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD AS U LEFT JOIN PRICES AS P ON U.PRODUCT_ID = P.PRODUCT_ID AND P.START_DATE <= U.PURCHASE_DATE AND (P.END_DATE >= U.PURCHASE_DATE) GROUP BY U.PRODUCT_ID"
512,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(U.UNITS * P.PRICE) / SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON (P.PRODUCT_ID = U.PRODUCT_ID) AND (U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) GROUP BY P.PRODUCT_ID"
513,Y,N,"SELECT UNITSSOLD.PRODUCT_ID, ROUND(SUM(UNITS * PRICE) / SUM(UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD LEFT JOIN PRICES ON (UNITSSOLD.PURCHASE_DATE BETWEEN PRICES.START_DATE AND PRICES.END_DATE) AND PRICES.PRODUCT_ID = UNITSSOLD.PRODUCT_ID GROUP BY UNITSSOLD.PRODUCT_ID"
514,Y,Y,"SELECT P.PRODUCT_ID AS PRODUCT_ID, ROUND(SUM(P.PRICE * U.UNITS) / SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY PRODUCT_ID"
515,Y,N,"WITH T AS ( SELECT A.PRODUCT_ID, A.UNITS, B.PRICE FROM UNITSSOLD A LEFT JOIN PRICES B ON A.PRODUCT_ID = B.PRODUCT_ID AND A.PURCHASE_DATE BETWEEN B.START_DATE AND B.END_DATE ) SELECT PRODUCT_ID, ROUND(SUM(UNITS * PRICE) / SUM(UNITS),2) AS AVERAGE_PRICE FROM T GROUP BY 1"
516,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES AS P JOIN UNITSSOLD AS US ON P.PRODUCT_ID =US.PRODUCT_ID AND (US.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) GROUP BY P.PRODUCT_ID"
517,Y,Y,"SELECT A.PRODUCT_ID, ROUND(SUM(A.PRICE*B.UNITS)/SUM(B.UNITS),2) AS AVERAGE_PRICE FROM PRICES A INNER JOIN UNITSSOLD B ON A.PRODUCT_ID = B.PRODUCT_ID AND B.PURCHASE_DATE BETWEEN A.START_DATE AND A.END_DATE GROUP BY 1"
518,Y,Y,"SELECT U.PRODUCT_ID, ROUND(SUM(U.UNITS*P.PRICE)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD U JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND (U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) GROUP BY PRODUCT_ID"
519,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD U ON U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE AND P.PRODUCT_ID = U.PRODUCT_ID GROUP BY P.PRODUCT_ID"
520,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/ SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY 1"
521,Y,N,"SELECT PRODUCT_ID, ROUND(TOTAL_SALES / TOTAL_UNITS, 2) AS AVERAGE_PRICE FROM ( SELECT U.PRODUCT_ID, SUM(U.UNITS * P.PRICE) AS TOTAL_SALES, SUM(U.UNITS) AS TOTAL_UNITS FROM UNITSSOLD U LEFT JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY 1 ) SUB"
522,Y,Y,"SELECT P.PRODUCT_ID, ROUND((SUM(PRICE*UNITS)/SUM(UNITS)),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U USING(PRODUCT_ID) WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY 1"
523,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE * U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND (U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) GROUP BY 1"
524,Y,Y,"SELECT PR.PRODUCT_ID, ROUND(SUM(PR.PRICE*US.UNITS)/SUM(US.UNITS),2) AS AVERAGE_PRICE FROM PRICES AS PR LEFT JOIN UNITSSOLD AS US ON PR.PRODUCT_ID = US.PRODUCT_ID WHERE US.PURCHASE_DATE BETWEEN PR.START_DATE AND PR.END_DATE GROUP BY PRODUCT_ID"
525,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD U JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE >= P.START_DATE AND U.PURCHASE_DATE <= P.END_DATE GROUP BY P.PRODUCT_ID"
526,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE * U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES AS P JOIN UNITSSOLD AS U ON U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE AND P.PRODUCT_ID = U.PRODUCT_ID GROUP BY P.PRODUCT_ID"
527,Y,Y,"SELECT A.PRODUCT_ID,ROUND(SUM(A.PRICE*A.UNITS)/SUM(A.UNITS),2) AVERAGE_PRICE FROM (SELECT US.*,P.PRICE FROM UNITSSOLD US JOIN PRICES P ON US.PRODUCT_ID=P.PRODUCT_ID AND US.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE)A GROUP BY A.PRODUCT_ID"
528,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE * UNITS) / SUM(UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD U LEFT JOIN PRICES P ON P.PRODUCT_ID = U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY 1"
529,Y,Y,"SELECT DISTINCT PRODUCT_ID, AVERAGE_PRICE FROM (SELECT US.PRODUCT_ID, ROUND(SUM(P.PRICE*US.UNITS) OVER (PARTITION BY US.PRODUCT_ID)/SUM(US.UNITS) OVER (PARTITION BY US.PRODUCT_ID),2) AS AVERAGE_PRICE FROM UNITSSOLD AS US JOIN PRICES AS P ON US.PRODUCT_ID = P.PRODUCT_ID AND US.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE ) A"
530,Y,N,"SELECT UNITSSOLD.PRODUCT_ID, ROUND(SUM(PRICE * UNITS) / SUM(UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD LEFT JOIN PRICES ON UNITSSOLD.PRODUCT_ID = PRICES.PRODUCT_ID AND DATE(PURCHASE_DATE) >= DATE(START_DATE) AND DATE(PURCHASE_DATE) <= DATE(END_DATE) GROUP BY PRODUCT_ID"
531,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(U.UNITS*P.PRICE)/SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM PRICES AS P JOIN UNITSSOLD AS U WHERE U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE <= P.END_DATE AND U.PURCHASE_DATE >= P.START_DATE GROUP BY P.PRODUCT_ID"
532,Y,Y,"SELECT P1.PRODUCT_ID,ROUND(SUM(P1.PRICE*U1.UNITS)/SUM(U1.UNITS),2) AS AVERAGE_PRICE FROM PRICES AS P1 JOIN UNITSSOLD AS U1 ON P1.PRODUCT_ID = U1.PRODUCT_ID WHERE U1.PURCHASE_DATE BETWEEN P1.START_DATE AND P1.END_DATE GROUP BY P1.PRODUCT_ID"
533,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*US.UNITS)/SUM(US.UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD US ON P.PRODUCT_ID = US.PRODUCT_ID AND US.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
534,Y,Y,"SELECT PR.PRODUCT_ID, ROUND (SUM(PR.PRICE * US.UNITS) / SUM(US.UNITS), 2) AS AVERAGE_PRICE FROM PRICES PR INNER JOIN UNITSSOLD US ON (US.PRODUCT_ID = PR.PRODUCT_ID AND US.PURCHASE_DATE BETWEEN PR.START_DATE AND PR.END_DATE) GROUP BY PR.PRODUCT_ID"
535,Y,Y,"SELECT A.PRODUCT_ID , ROUND(SUM(A.PRICE * B.UNITS) / SUM(B.UNITS),2) AS AVERAGE_PRICE FROM PRICES A INNER JOIN UNITSSOLD B ON A.PRODUCT_ID = B.PRODUCT_ID AND B.PURCHASE_DATE BETWEEN A.START_DATE AND A.END_DATE GROUP BY A.PRODUCT_ID"
536,Y,Y,"SELECT PRICES.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES, UNITSSOLD WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE AND PRICES.PRODUCT_ID = UNITSSOLD.PRODUCT_ID GROUP BY 1"
537,Y,Y,"SELECT P.PRODUCT_ID PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/ SUM(U.UNITS),2) AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID WHERE (U.PURCHASE_DATE>=P.START_DATE AND U.PURCHASE_DATE<=P.END_DATE) GROUP BY 1"
538,Y,Y,"SELECT PRODUCT_ID, ROUND(SUM(TTL_PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM ( SELECT PRICES.PRODUCT_ID, PRICE, UNITS, PRICE*UNITS AS TTL_PRICE FROM PRICES JOIN UNITSSOLD WHERE PRICES.PRODUCT_ID = UNITSSOLD.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE) SQ GROUP BY PRODUCT_ID"
539,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE P.START_DATE <= U.PURCHASE_DATE AND U.PURCHASE_DATE <= P.END_DATE GROUP BY P.PRODUCT_ID"
540,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE * U.UNITS)/ IFNULL(SUM(U.UNITS), 0 ), 2) AS AVERAGE_PRICE FROM PRICES AS P LEFT JOIN UNITSSOLD AS U ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
541,Y,Y,"SELECT PRODUCT_ID, ROUND(SUM(TOTSALE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM ( SELECT A.PRODUCT_ID, A.PRICE, B.UNITS, A.PRICE*B.UNITS AS TOTSALE FROM PRICES A INNER JOIN UNITSSOLD B ON A.PRODUCT_ID=B.PRODUCT_ID AND B.PURCHASE_DATE BETWEEN A.START_DATE AND A.END_DATE ) C GROUP BY PRODUCT_ID"
542,Y,Y,"SELECT P.PRODUCT_ID , ROUND(SUM(P.PRICE * U.UNITS)/SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM PRICES AS P JOIN UNITSSOLD AS U ON P.PRODUCT_ID = U.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY 1"
543,Y,Y,"SELECT DISTINCT C.PRODUCT_ID, CAST((SUM(C.TOTPRICE)/SUM(C.UNITS)) AS DECIMAL(5,2)) AVERAGE_PRICE FROM ( SELECT B.PRODUCT_ID, A.PRICE*B.UNITS AS TOTPRICE, B.UNITS FROM UNITSSOLD B LEFT JOIN PRICES A ON B.PRODUCT_ID = A.PRODUCT_ID WHERE B.PURCHASE_DATE BETWEEN A.START_DATE AND A.END_DATE ) AS C GROUP BY C.PRODUCT_ID"
544,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U USING(PRODUCT_ID) WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY 1"
545,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES AS P LEFT JOIN UNITSSOLD AS U ON P.PRODUCT_ID=U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
546,Y,Y,"SELECT UNITSSOLD.PRODUCT_ID, ROUND((SUM(UNITSSOLD.UNITS*PRICES.PRICE)/SUM(UNITSSOLD.UNITS)),2) AS AVERAGE_PRICE FROM UNITSSOLD JOIN PRICES ON UNITSSOLD.PRODUCT_ID = PRICES.PRODUCT_ID WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY UNITSSOLD.PRODUCT_ID"
547,Y,Y,"SELECT P.PRODUCT_ID, ROUND((SUM(U.UNITS * P.PRICE) / SUM(UNITS)), 2) AS AVERAGE_PRICE FROM PRICES P, UNITSSOLD U WHERE P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
548,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE * U.UNITS)/SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND DATEDIFF(U.PURCHASE_DATE, P.START_DATE) >= 0 AND DATEDIFF(P.END_DATE, U.PURCHASE_DATE) >= 0 GROUP BY P.PRODUCT_ID"
549,Y,Y,"SELECT A.PRODUCT_ID ,ROUND(SUM(A.UNITS*P.PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD A INNER JOIN PRICES P ON A.PRODUCT_ID = P.PRODUCT_ID AND A.PURCHASE_DATE >= P.START_DATE AND A.PURCHASE_DATE <= P.END_DATE GROUP BY A.PRODUCT_ID"
550,Y,Y,"SELECT US.PRODUCT_ID, ROUND(SUM(UNITS * PRICE)/SUM(UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD US LEFT JOIN PRICES P USING(PRODUCT_ID) WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRODUCT_ID"
551,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*S.UNITS)/ SUM(S.UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD S ON S.PRODUCT_ID=P.PRODUCT_ID AND (S.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) GROUP BY 1"
552,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
553,Y,Y,"SELECT DISTINCT P.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS), 2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE AND P.PRODUCT_ID = U.PRODUCT_ID GROUP BY P.PRODUCT_ID"
554,Y,Y,"SELECT DISTINCT US.PRODUCT_ID, ROUND( SUM(US.UNITS*P.PRICE)/SUM(US.UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD US, PRICES P WHERE US.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE AND US.PRODUCT_ID = P.PRODUCT_ID GROUP BY US.PRODUCT_ID"
555,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(UNITS),2) AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD U ON U.PRODUCT_ID = P.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
556,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U WHERE P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRODUCT_ID"
557,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS) / SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY P.PRODUCT_ID"
558,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD U JOIN PRICES P ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
559,Y,Y,"SELECT A.PRODUCT_ID, ROUND(SUM(A.PRICE * B.UNITS)/SUM(B.UNITS),2) AS AVERAGE_PRICE FROM PRICES AS A INNER JOIN UNITSSOLD AS B ON A.PRODUCT_ID = B.PRODUCT_ID WHERE A.START_DATE <= B.PURCHASE_DATE AND B.PURCHASE_DATE <= A.END_DATE GROUP BY PRODUCT_ID"
560,Y,Y,"SELECT PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES JOIN UNITSSOLD USING(PRODUCT_ID) WHERE PURCHASE_DATE >= START_DATE AND PURCHASE_DATE <= END_DATE GROUP BY PRODUCT_ID"
561,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(US.UNITS*P.PRICE)/SUM(US.UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD AS US INNER JOIN PRICES AS P ON US.PRODUCT_ID = P.PRODUCT_ID WHERE US.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY PRODUCT_ID"
562,Y,Y,"SELECT P.PRODUCT_ID, ROUND((SUM(P.PRICE*U.UNITS)/(SUM(U.UNITS))),2) AS AVERAGE_PRICE FROM PRICES AS P, UNITSSOLD AS U WHERE P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
563,Y,Y,"SELECT UNITSSOLD.PRODUCT_ID, ROUND(SUM(PRICES.PRICE * UNITSSOLD.UNITS) / SUM(UNITSSOLD.UNITS), 2) AS AVERAGE_PRICE FROM PRICES INNER JOIN UNITSSOLD ON UNITSSOLD.PURCHASE_DATE BETWEEN PRICES.START_DATE AND PRICES.END_DATE AND UNITSSOLD.PRODUCT_ID = PRICES.PRODUCT_ID GROUP BY PRICES.PRODUCT_ID"
564,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND (PURCHASE_DATE BETWEEN START_DATE AND END_DATE) GROUP BY P.PRODUCT_ID"
565,Y,N,"SELECT PRODUCT_ID, ROUND(SUM(REVENUE) / SUM(UNITS),2) AS AVERAGE_PRICE FROM ( SELECT A.PRODUCT_ID, A.UNITS, B.PRICE*A.UNITS AS REVENUE FROM UNITSSOLD A LEFT JOIN PRICES B ON B.START_DATE <= A.PURCHASE_DATE AND A.PURCHASE_DATE <= B.END_DATE AND A.PRODUCT_ID = B.PRODUCT_ID ) T GROUP BY PRODUCT_ID"
566,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/SUM(UNITS),2) AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND (U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE ) GROUP BY PRODUCT_ID"
567,Y,N,"WITH A AS ( SELECT U.PRODUCT_ID, U.UNITS, P.PRICE FROM UNITSSOLD U LEFT JOIN PRICES P ON U.PURCHASE_DATE >= P.START_DATE AND U.PURCHASE_DATE <= P.END_DATE AND U.PRODUCT_ID = P.PRODUCT_ID ) SELECT PRODUCT_ID, ROUND(TOTAL_SALE/TOTAL_UNIT, 2) AS AVERAGE_PRICE FROM ( SELECT PRODUCT_ID, SUM(UNITS*PRICE) AS TOTAL_SALE, SUM(UNITS) AS TOTAL_UNIT FROM A GROUP BY PRODUCT_ID) AS B"
568,Y,Y,"SELECT PRODUCT_ID, ROUND(SUM(INDIV_PRICE) / SUM(UNITS), 2) AS AVERAGE_PRICE FROM (SELECT P.PRODUCT_ID, U.UNITS, U.UNITS * P.PRICE AS INDIV_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE <= P.END_DATE AND U.PURCHASE_DATE >= P.START_DATE ) DT GROUP BY PRODUCT_ID"
569,Y,Y,"SELECT A.PRODUCT_ID , ROUND(SUM(A.PRICE * B.UNITS) / SUM(B.UNITS),2) AS AVERAGE_PRICE FROM PRICES A INNER JOIN UNITSSOLD B ON A.PRODUCT_ID = B.PRODUCT_ID AND A.START_DATE <= B.PURCHASE_DATE AND B.PURCHASE_DATE <= A.END_DATE GROUP BY A.PRODUCT_ID"
570,Y,Y,"WITH T1 AS ( SELECT US.PRODUCT_ID, SUM(CASE WHEN PURCHASE_DATE BETWEEN START_DATE AND END_DATE THEN US.UNITS * P.PRICE ELSE 0 END) TOTAL_PRICE, SUM(CASE WHEN PURCHASE_DATE BETWEEN START_DATE AND END_DATE THEN US.UNITS END) TOTAL_UNITS FROM UNITSSOLD US JOIN PRICES P ON US.PRODUCT_ID = P.PRODUCT_ID GROUP BY 1 ) SELECT T1.PRODUCT_ID, ROUND(SUM(TOTAL_PRICE/ TOTAL_UNITS),2) AVERAGE_PRICE FROM T1 GROUP BY 1"
571,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE*UNITS) / SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
572,Y,N,"SELECT P.PRODUCT_ID , ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AVERAGE_PRICE FROM UNITSSOLD U LEFT JOIN PRICES P ON P.PRODUCT_ID = U.PRODUCT_ID AND PURCHASE_DATE>=START_DATE AND PURCHASE_DATE<=END_DATE GROUP BY 1"
573,Y,Y,"SELECT P.PRODUCT_ID ,ROUND(SUM(UNITS*PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY 1"
574,Y,N,"SELECT PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM (SELECT U.PRODUCT_ID, PRICE, UNITS FROM PRICES P RIGHT JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND PURCHASE_DATE>= START_DATE AND PURCHASE_DATE<=END_DATE) A GROUP BY PRODUCT_ID ORDER BY PRODUCT_ID"
575,Y,Y,"SELECT A.PRODUCT_ID, ROUND(SUM(B.UNITS*A.PRICE)/(SUM(B.UNITS)),2) AS AVERAGE_PRICE FROM PRICES AS A JOIN UNITSSOLD AS B ON A.PRODUCT_ID = B.PRODUCT_ID WHERE B.PURCHASE_DATE BETWEEN A.START_DATE AND A.END_DATE GROUP BY A.PRODUCT_ID"
576,Y,Y,"SELECT UNITSSOLD.PRODUCT_ID, ROUND(SUM(PRICES.PRICE * UNITSSOLD.UNITS) / SUM(UNITSSOLD.UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD JOIN PRICES ON UNITSSOLD.PRODUCT_ID = PRICES.PRODUCT_ID AND UNITSSOLD.PURCHASE_DATE BETWEEN PRICES.START_DATE AND PRICES.END_DATE GROUP BY UNITSSOLD.PRODUCT_ID"
577,Y,N,"SELECT U.PRODUCT_ID, ROUND(SUM(U.UNITS * P.PRICE) / SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD AS U LEFT JOIN PRICES AS P ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE >= P.START_DATE AND U.PURCHASE_DATE <= P.END_DATE GROUP BY U.PRODUCT_ID"
578,Y,Y,"SELECT TEMP.PRODUCT_ID, ROUND (TEMP.TOTAL_PRICE*1.00 /TEMP.TOTAL_UNIT,2) AS AVERAGE_PRICE FROM ( SELECT P.PRODUCT_ID, SUM(P.PRICE*U.UNITS) AS TOTAL_PRICE, SUM(UNITS) AS TOTAL_UNIT FROM PRICES P JOIN UNITSSOLD U ON U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE AND P.PRODUCT_ID =U.PRODUCT_ID GROUP BY P.PRODUCT_ID ) AS TEMP"
579,Y,N,"SELECT PRODUCT_ID, ROUND(SUM(A.SALES)/ SUM(A.NUMBERS),2) AS AVERAGE_PRICE FROM (SELECT PRODUCT_ID, PRICE*UNITS AS SALES, UNITS AS NUMBERS FROM UNITSSOLD JOIN PRICES USING(PRODUCT_ID) WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRODUCT_ID, PURCHASE_DATE ) AS A GROUP BY A.PRODUCT_ID"
580,Y,Y,"WITH PRICE_SOLD AS ( SELECT PR.PRODUCT_ID, PR.PRICE, US.UNITS FROM PRICES AS PR LEFT JOIN UNITSSOLD AS US ON PR.PRODUCT_ID = US.PRODUCT_ID WHERE US.PURCHASE_DATE <= PR.END_DATE AND US.PURCHASE_DATE >= PR.START_DATE ) SELECT PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICE_SOLD GROUP BY PRODUCT_ID"
581,Y,Y,"SELECT TMP.PRODUCT_ID, ROUND(SUM(TMP.TOTAL) / SUM(TMP.UNITS), 2) AS AVERAGE_PRICE FROM ( SELECT P.PRODUCT_ID, U.UNITS, U.UNITS * P.PRICE AS TOTAL FROM PRICES AS P LEFT JOIN UNITSSOLD AS U ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE ) AS TMP GROUP BY TMP.PRODUCT_ID ORDER BY TMP.PRODUCT_ID"
582,Y,Y,"SELECT A.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES A JOIN UNITSSOLD B ON A.PRODUCT_ID = B.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY 1"
583,Y,N,"SELECT U.PRODUCT_ID,ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD U LEFT JOIN PRICES P ON U.PRODUCT_ID=P.PRODUCT_ID AND (U.PURCHASE_DATE >=P.START_DATE) AND (U.PURCHASE_DATE <=P.END_DATE) GROUP BY U.PRODUCT_ID"
584,Y,Y,"SELECT A.PRODUCT_ID, ROUND(SUM(A.PRICE*B.UNITS)/SUM(B.UNITS),2) AS AVERAGE_PRICE FROM PRICES A JOIN UNITSSOLD B ON A.PRODUCT_ID=B.PRODUCT_ID AND PURCHASE_DATE>=START_DATE AND PURCHASE_DATE<=END_DATE GROUP BY A.PRODUCT_ID"
585,Y,Y,"SELECT UNITSSOLD.PRODUCT_ID, ROUND( SUM(PRICE*UNITS) / SUM(UNITS), 2) AS AVERAGE_PRICE FROM PRICES INNER JOIN UNITSSOLD ON PRICES.PRODUCT_ID = UNITSSOLD.PRODUCT_ID AND UNITSSOLD.PURCHASE_DATE BETWEEN PRICES.START_DATE AND PRICES.END_DATE GROUP BY PRODUCT_ID"
586,Y,Y,"WITH PRICED_UNITS AS ( SELECT U.PRODUCT_ID, U.UNITS, P.PRICE, P.PRICE*U.UNITS AS TOTAL_PRICE FROM UNITSSOLD U INNER JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE ) SELECT PRODUCT_ID, ROUND(SUM(TOTAL_PRICE)/SUM(UNITS), 2) AS AVERAGE_PRICE FROM PRICED_UNITS GROUP BY PRODUCT_ID"
587,Y,N,"SELECT U.PRODUCT_ID, IF(SUM(U.UNITS) IS NOT NULL, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2), 0) AS AVERAGE_PRICE FROM UNITSSOLD U LEFT JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY U.PRODUCT_ID"
588,Y,Y,"WITH CTE AS ( SELECT P.PRODUCT_ID, UNITS, UNITS*PRICE AS TOT_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE) SELECT PRODUCT_ID, ROUND(SUM(TOT_PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM CTE GROUP BY PRODUCT_ID"
589,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND END_DATE GROUP BY 1"
590,Y,Y,"WITH TMP AS ( SELECT P.PRODUCT_ID ,PRICE ,UNITS FROM PRICES P LEFT JOIN UNITSSOLD U ON (P.PRODUCT_ID = U.PRODUCT_ID) AND (U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) ) SELECT PRODUCT_ID ,CAST(SUM(PRICE * UNITS)/SUM(UNITS) AS DECIMAL (10,2)) AS AVERAGE_PRICE FROM TMP GROUP BY 1"
591,Y,Y,"SELECT U.PRODUCT_ID, ROUND(SUM(U.UNITS*P.PRICE)/SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM PRICES AS P JOIN UNITSSOLD AS U ON U.PRODUCT_ID = P.PRODUCT_ID AND (U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) GROUP BY PRODUCT_ID"
592,Y,Y,"WITH A AS (SELECT P.PRODUCT_ID,PRICE*UNITS AS PC,UNITS FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE) SELECT PRODUCT_ID,ROUND(SUM(PC)/SUM(UNITS),2) AS AVERAGE_PRICE FROM A GROUP BY PRODUCT_ID"
593,Y,Y,"WITH T AS ( SELECT P.PRODUCT_ID, P.PRICE, S.UNITS FROM PRICES AS P, UNITSSOLD AS S WHERE P.PRODUCT_ID = S.PRODUCT_ID AND P.START_DATE <= S.PURCHASE_DATE AND P.END_DATE >= S.PURCHASE_DATE) SELECT PRODUCT_ID, ROUND(SUM(PRICE * UNITS)/SUM(UNITS) , 2) AS AVERAGE_PRICE FROM T GROUP BY PRODUCT_ID"
594,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE >= P.START_DATE AND U.PURCHASE_DATE <=P.END_DATE GROUP BY P.PRODUCT_ID"
595,Y,N,"SELECT PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM (SELECT U.PRODUCT_ID, PRICE, UNITS FROM PRICES P RIGHT JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND PURCHASE_DATE>= START_DATE AND PURCHASE_DATE<=END_DATE) A GROUP BY PRODUCT_ID"
596,Y,N,"SELECT U.PRODUCT_ID, ROUND(SUM(UNITS*PRICE) / SUM(UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD U LEFT JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND (U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) GROUP BY 1"
597,Y,Y,"SELECT P.PRODUCT_ID, ROUND(IFNULL(SUM(PRICE*UNITS)/SUM(UNITS),PRICE),2) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY 1"
598,Y,Y,"WITH PRICED_UNITS AS ( SELECT U.PRODUCT_ID, U.UNITS, P.PRICE FROM UNITSSOLD U INNER JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE ) ,TOTAL_PRICES AS ( SELECT PRODUCT_ID, UNITS, 1.0*UNITS*PRICE AS TOTAL_PRICE FROM PRICED_UNITS ) SELECT PRODUCT_ID, ROUND(SUM(TOTAL_PRICE)/SUM(UNITS), 2) AS AVERAGE_PRICE FROM TOTAL_PRICES GROUP BY PRODUCT_ID"
599,Y,Y,"SELECT P.PRODUCT_ID,ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P CROSS JOIN UNITSSOLD U WHERE P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
600,Y,Y,"SELECT P.PRODUCT_ID AS PRODUCT_ID, ROUND(SUM(U.UNITS * P.PRICE)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
601,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE * U.UNITS) / SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND (U.PURCHASE_DATE >= P.START_DATE AND U.PURCHASE_DATE <= P.END_DATE) GROUP BY P.PRODUCT_ID"
602,Y,Y,"SELECT A.PRODUCT_ID, ROUND(SUM(A.UNITS*B.PRICE)/SUM(A.UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD AS A JOIN PRICES AS B ON A.PRODUCT_ID = B.PRODUCT_ID AND A.PURCHASE_DATE BETWEEN B.START_DATE AND B.END_DATE GROUP BY A.PRODUCT_ID"
603,Y,Y,"SELECT PRICES.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS), 2) AS AVERAGE_PRICE FROM PRICES LEFT JOIN UNITSSOLD ON PRICES.PRODUCT_ID = UNITSSOLD.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRICES.PRODUCT_ID"
604,Y,Y,"SELECT T1.PRODUCT_ID, ROUND(SUM(T1.PRICE * T2.UNITS) / SUM(T2.UNITS), 2) AVERAGE_PRICE FROM PRICES T1 INNER JOIN UNITSSOLD T2 ON T1.PRODUCT_ID = T2.PRODUCT_ID AND T2.PURCHASE_DATE BETWEEN T1.START_DATE AND T1.END_DATE GROUP BY T1.PRODUCT_ID"
605,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD B ON P.PRODUCT_ID = B.PRODUCT_ID AND B.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY 1"
606,Y,Y,"SELECT PRODUCT_ID, IFNULL(ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2),0) AS AVERAGE_PRICE FROM PRICES JOIN UNITSSOLD USING(PRODUCT_ID) WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRODUCT_ID ORDER BY PRODUCT_ID"
607,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(U.UNITS * P.PRICE)/SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE U.PURCHASE_DATE <= P.END_DATE AND U.PURCHASE_DATE >= P.START_DATE GROUP BY P.PRODUCT_ID"
608,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(UNITS * PRICE)/SUM(UNITS), 2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE S.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
609,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY PRODUCT_ID"
610,Y,Y,"SELECT UNITSSOLD.PRODUCT_ID, ROUND(SUM(UNITS * PRICE) / SUM(UNITS), 2) AS AVERAGE_PRICE FROM PRICES JOIN UNITSSOLD ON PRICES.PRODUCT_ID = UNITSSOLD.PRODUCT_ID WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRODUCT_ID"
611,Y,Y,"WITH TEMP AS ( SELECT U.PRODUCT_ID, U.UNITS, P.PRICE FROM UNITSSOLD U LEFT JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) SELECT PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/SUM(UNITS), 2) AS AVERAGE_PRICE FROM TEMP GROUP BY PRODUCT_ID"
612,Y,Y,"SELECT PRODUCT_ID, ROUND(SUM(TOTALPRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM (SELECT P.PRODUCT_ID, P.PRICE * U.UNITS AS TOTALPRICE, U.UNITS FROM PRICES AS P JOIN UNITSSOLD AS U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) AS TEMP GROUP BY PRODUCT_ID"
613,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE * U.UNITS) / SUM(U.UNITS),2) AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY PRODUCT_ID"
614,Y,Y,"SELECT TABLE1.PRODUCT_ID, ROUND(SUM(TOTALPRICE)/SUM(TOTALUNIT),2) AS AVERAGE_PRICE FROM (SELECT P.PRODUCT_ID, U.UNITS*P.PRICE AS TOTALPRICE, U.UNITS AS TOTALUNIT FROM PRICES P JOIN UNITSSOLD U WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE AND P.PRODUCT_ID = U.PRODUCT_ID) AS TABLE1 GROUP BY PRODUCT_ID"
615,Y,Y,"SELECT P.PRODUCT_ID , ROUND(SUM(PRICE *UNITS) / SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
616,Y,Y,"SELECT PRODUCT_ID,ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM (SELECT U.*,P.PRICE FROM UNITSSOLD AS U LEFT JOIN PRICES AS P ON P.PRODUCT_ID=U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) AS T1 GROUP BY PRODUCT_ID"
617,Y,Y,"SELECT PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM( SELECT PRICES.PRODUCT_ID, PURCHASE_DATE, PRICE, UNITS FROM PRICES, UNITSSOLD WHERE PURCHASE_DATE >= START_DATE AND PURCHASE_DATE <= END_DATE AND PRICES.PRODUCT_ID = UNITSSOLD.PRODUCT_ID) AS PRICE_INFO GROUP BY 1"
618,Y,Y,"SELECT P.PRODUCT_ID , ROUND(SUM(U.UNITS *P.PRICE )/SUM(U.UNITS) ,2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON (P.PRODUCT_ID =U.PRODUCT_ID ) WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY P.PRODUCT_ID"
619,Y,Y,"SELECT A.PRODUCT_ID PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/SUM(UNITS) ,2) AS AVERAGE_PRICE FROM PRICES A INNER JOIN UNITSSOLD B ON A.PRODUCT_ID = B.PRODUCT_ID AND B.PURCHASE_DATE BETWEEN A.START_DATE AND A.END_DATE GROUP BY A.PRODUCT_ID"
620,Y,Y,"WITH TBL AS ( SELECT PRODUCT_ID,SUM(PRICE*UNITS) AS COST, SUM(UNITS) AS UNITS FROM PRICES INNER JOIN UNITSSOLD USING (PRODUCT_ID) WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE AND DATE(PURCHASE_DATE)<=DATE(END_DATE) GROUP BY PRODUCT_ID ) SELECT PRODUCT_ID, ROUND((COST/UNITS),2) AS AVERAGE_PRICE FROM TBL"
621,Y,Y,"SELECT PRICES.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS), 2) AS AVERAGE_PRICE FROM PRICES INNER JOIN UNITSSOLD ON PRICES.PRODUCT_ID = UNITSSOLD.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRICES.PRODUCT_ID"
622,Y,N,"SELECT UNITSSOLD.PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/SUM(UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD LEFT JOIN PRICES ON PRICES.PRODUCT_ID = UNITSSOLD.PRODUCT_ID AND PURCHASE_DATE >= START_DATE AND PURCHASE_DATE <= END_DATE GROUP BY UNITSSOLD.PRODUCT_ID"
623,Y,Y,"WITH TEMP AS ( SELECT A.PRODUCT_ID, A.PRICE, B.UNITS FROM PRICES A LEFT OUTER JOIN UNITSSOLD B ON (A.PRODUCT_ID = B.PRODUCT_ID AND A.START_DATE <= B.PURCHASE_DATE AND A.END_DATE >= B.PURCHASE_DATE)) SELECT PRODUCT_ID, ROUND(SUM(PRICE * UNITS)/SUM(UNITS), 2) AS AVERAGE_PRICE FROM TEMP GROUP BY PRODUCT_ID"
624,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE * U.UNITS) / SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY 1"
625,Y,Y,"WITH CTE AS( SELECT U.PRODUCT_ID, U.UNITS, CASE WHEN U.PURCHASE_DATE >= P.START_DATE AND U.PURCHASE_DATE <= P.END_DATE THEN P.PRICE END AS PRICE_DAY FROM PRICES AS P LEFT JOIN UNITSSOLD AS U ON P.PRODUCT_ID = U.PRODUCT_ID ) SELECT PRODUCT_ID, ROUND(SUM(UNITS * PRICE_DAY) / SUM(UNITS),2) AS AVERAGE_PRICE FROM CTE WHERE PRICE_DAY IS NOT NULL GROUP BY PRODUCT_ID"
626,Y,N,"SELECT UNITSSOLD.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD LEFT JOIN PRICES ON PRICES.PRODUCT_ID = UNITSSOLD.PRODUCT_ID AND PRICES.START_DATE <= UNITSSOLD.PURCHASE_DATE AND UNITSSOLD.PURCHASE_DATE <= PRICES.END_DATE GROUP BY UNITSSOLD.PRODUCT_ID"
627,Y,Y,"SELECT U.PRODUCT_ID ,ROUND(SUM(U.UNITS*P.PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD U, PRICES P WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE AND P.PRODUCT_ID =U.PRODUCT_ID GROUP BY U.PRODUCT_ID"
628,Y,Y,"SELECT T1.PRODUCT_ID, ROUND(SUM(T2.PRICE * T1.UNITS) / SUM(T1.UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD T1 JOIN PRICES T2 ON T1.PRODUCT_ID = T2.PRODUCT_ID AND T1.PURCHASE_DATE BETWEEN T2.START_DATE AND T2.END_DATE GROUP BY 1 ORDER BY 1"
629,Y,Y,"SELECT A.PRODUCT_ID, ROUND(SUM(A.PRICE*B.UNITS)/ SUM(B.UNITS),2) AS AVERAGE_PRICE FROM PRICES A LEFT JOIN UNITSSOLD B ON A.PRODUCT_ID = B.PRODUCT_ID AND (B.PURCHASE_DATE BETWEEN A.START_DATE AND A.END_DATE) GROUP BY A.PRODUCT_ID"
630,Y,Y,"SELECT T2.PRODUCT_ID, ROUND(SUM(T2.UNITS*T1.PRICE) / SUM(T2.UNITS), 2) AVERAGE_PRICE FROM PRICES T1 INNER JOIN UNITSSOLD T2 ON T1.PRODUCT_ID = T2.PRODUCT_ID AND T2.PURCHASE_DATE BETWEEN T1.START_DATE AND T1.END_DATE GROUP BY T2.PRODUCT_ID"
631,Y,Y,"SELECT DISTINCT P.PRODUCT_ID,ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY PRODUCT_ID"
632,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE * UNITS)/SUM(UNITS), 2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON (P.PRODUCT_ID = U.PRODUCT_ID AND P.START_DATE <= U.PURCHASE_DATE AND U.PURCHASE_DATE <= P.END_DATE) GROUP BY P.PRODUCT_ID"
633,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD D ON P.PRODUCT_ID = D.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY 1"
634,Y,Y,"SELECT DISTINCT P.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON U.PRODUCT_ID=P.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY 1"
635,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P, UNITSSOLD U WHERE U.PRODUCT_ID=P.PRODUCT_ID AND DATE(U.PURCHASE_DATE) BETWEEN P.START_DATE AND P.END_DATE GROUP BY PRODUCT_ID"
636,Y,Y,"SELECT U.PRODUCT_ID AS PRODUCT_ID,ROUND(SUM(U.UNITS*P.PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD U INNER JOIN PRICES P ON U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE AND U.PRODUCT_ID = P.PRODUCT_ID GROUP BY U.PRODUCT_ID"
637,Y,Y,"SELECT T1.PRODUCT_ID , ROUND(SUM(T1.UNITS*T2.PRICE)/SUM(T1.UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD T1 JOIN PRICES T2 ON T1.PRODUCT_ID = T2.PRODUCT_ID AND T1.PURCHASE_DATE BETWEEN T2.START_DATE AND T2.END_DATE GROUP BY T1.PRODUCT_ID"
638,Y,Y,"SELECT T.PRODUCT_ID, ROUND(T.TOTAL_SUM / T.COUNTS, 2) AVERAGE_PRICE FROM ( SELECT P.PRODUCT_ID, SUM(U.UNITS * P.PRICE) TOTAL_SUM, SUM(U.UNITS) COUNTS FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID) T"
639,Y,Y,"SELECT PRICES.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES JOIN UNITSSOLD ON PRICES.PRODUCT_ID=UNITSSOLD.PRODUCT_ID AND UNITSSOLD.PURCHASE_DATE BETWEEN PRICES.START_DATE AND PRICES.END_DATE GROUP BY PRODUCT_ID"
640,Y,Y,"SELECT UNITSSOLD.PRODUCT_ID , ROUND(SUM(PRICE*UNITS)/ SUM(UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD LEFT JOIN PRICES ON PRICES.PRODUCT_ID = UNITSSOLD.PRODUCT_ID WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY UNITSSOLD.PRODUCT_ID"
641,Y,Y,"WITH TEMP AS ( SELECT P.PRODUCT_ID, P.START_DATE, P.END_DATE, P.PRICE, U.PURCHASE_DATE, U.UNITS FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE ) SELECT PRODUCT_ID, ROUND((SUM(PRICE * UNITS) / SUM(UNITS)), 2) AS AVERAGE_PRICE FROM TEMP GROUP BY PRODUCT_ID"
642,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY P.PRODUCT_ID"
643,Y,Y,"SELECT U.PRODUCT_ID, ROUND(SUM(PRICE * UNITS)*1.0 / SUM(UNITS)*1.0,2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY U.PRODUCT_ID"
644,Y,N,"SELECT U.PRODUCT_ID AS PRODUCT_ID, ROUND(SUM(P.PRICE * U.UNITS) / SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD U LEFT JOIN PRICES P ON ( U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE ) GROUP BY U.PRODUCT_ID"
645,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)*1.0/SUM(U.UNITS)*1.0,2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY P.PRODUCT_ID"
646,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(U.UNITS * P.PRICE)/SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD U LEFT JOIN PRICES P USING(PRODUCT_ID) WHERE U.PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY 1"
647,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES AS P JOIN UNITSSOLD AS U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE START_DATE<=PURCHASE_DATE AND PURCHASE_DATE<=END_DATE GROUP BY P.PRODUCT_ID"
648,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE * US.UNITS)/SUM(US.UNITS),2) AS AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD US ON P.PRODUCT_ID = US.PRODUCT_ID AND US.PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY P.PRODUCT_ID"
649,Y,Y,"SELECT PRODUCT_ID,ROUND(SUM(SALES)/SUM(UNITS),2) AS AVERAGE_PRICE FROM (SELECT P.PRODUCT_ID,P.PRICE,U.UNITS,PRICE*UNITS AS SALES FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) AS A GROUP BY PRODUCT_ID"
650,Y,N,"WITH ORDERS AS ( SELECT U.PRODUCT_ID, UNITS, PRICE FROM UNITSSOLD U LEFT JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE ) SELECT PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/ SUM(UNITS),2) AS AVERAGE_PRICE FROM ORDERS GROUP BY PRODUCT_ID"
651,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS) / SUM(U.UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD AS U JOIN PRICES AS P ON (U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) AND (U.PRODUCT_ID = P.PRODUCT_ID) GROUP BY P.PRODUCT_ID"
652,Y,Y,"SELECT DISTINCT T1.PRODUCT_ID, ROUND(SUM(T1.UNITS*T1.PRICE)/SUM(T1.UNITS), 2) AS AVERAGE_PRICE FROM (SELECT A.PRODUCT_ID, A.UNITS, B.PRICE FROM UNITSSOLD A JOIN PRICES B ON A.PRODUCT_ID = B.PRODUCT_ID AND A.PURCHASE_DATE BETWEEN B.START_DATE AND B.END_DATE) AS T1 GROUP BY T1.PRODUCT_ID"
653,Y,Y,"SELECT A.PRODUCT_ID,ROUND(SUM(A.PRICE*B.UNITS)/SUM(B.UNITS),2) AS AVERAGE_PRICE FROM PRICES A JOIN UNITSSOLD B ON A.PRODUCT_ID = B.PRODUCT_ID AND (B.PURCHASE_DATE BETWEEN A.START_DATE AND A.END_DATE) GROUP BY A.PRODUCT_ID"
654,Y,Y,"SELECT P.PRODUCT_ID, ROUND(IFNULL(SUM(PRICE * UNITS) / SUM(UNITS), 0) , 2) AS AVERAGE_PRICE FROM PRICES AS P LEFT JOIN UNITSSOLD AS S ON P.PRODUCT_ID=S.PRODUCT_ID AND S.PURCHASE_DATE <= P.END_DATE AND S.PURCHASE_DATE >= P.START_DATE GROUP BY PRODUCT_ID"
655,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE P.PRODUCT_ID=U.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRODUCT_ID"
656,Y,N,"WITH TOTAL_UNITS AS ( SELECT U1.PRODUCT_ID, SUM(UNITS) AS TU FROM UNITSSOLD U1 GROUP BY U1.PRODUCT_ID ),TOTAL_PRICE_BY_DATE AS ( SELECT P.PRODUCT_ID, CASE WHEN PURCHASE_DATE BETWEEN START_DATE AND END_DATE THEN UNITS * PRICE ELSE 0 END AS TOTAL_COST FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID ), TOTAL_PRICE AS ( SELECT PRODUCT_ID, SUM(TOTAL_COST) AS TOTAL_COST FROM TOTAL_PRICE_BY_DATE GROUP BY PRODUCT_ID ) SELECT U.PRODUCT_ID, ROUND(TOTAL_COST/TU, 2) AS AVERAGE_PRICE FROM TOTAL_PRICE P JOIN TOTAL_UNITS U ON P.PRODUCT_ID = U.PRODUCT_ID"
657,Y,N,"WITH TEMP AS( SELECT U.PRODUCT_ID PRODUCT_ID, UNITS, PRICE, UNITS * PRICE TOTAL FROM UNITSSOLD U LEFT JOIN PRICES P ON P.PRODUCT_ID = U.PRODUCT_ID AND PURCHASE_DATE >= START_DATE AND PURCHASE_DATE <= END_DATE ) SELECT PRODUCT_ID, ROUND(SUM(TOTAL)/SUM(UNITS), 2) AVERAGE_PRICE FROM TEMP GROUP BY PRODUCT_ID"
658,Y,N,"SELECT PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM (SELECT A.PRODUCT_ID, A.PURCHASE_DATE, A.UNITS, B.PRICE FROM UNITSSOLD A LEFT JOIN PRICES B ON A.PRODUCT_ID = B.PRODUCT_ID AND A.PURCHASE_DATE BETWEEN B.START_DATE AND B.END_DATE)A GROUP BY 1"
659,Y,Y,"SELECT U.PRODUCT_ID, ROUND(SUM(P.PRICE * U.UNITS) / SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY U.PRODUCT_ID"
660,Y,Y,"SELECT U.PRODUCT_ID, ROUND((SUM(U.UNITS*P.PRICE)/SUM(U.UNITS)),2) AS AVERAGE_PRICE FROM UNITSSOLD AS U INNER JOIN PRICES AS P ON U.PRODUCT_ID = P.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY U.PRODUCT_ID"
661,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(U.UNITS*P.PRICE)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P, UNITSSOLD U WHERE (U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) AND U.PRODUCT_ID = P.PRODUCT_ID GROUP BY PRODUCT_ID"
662,Y,Y,"WITH TOTAL_SALE AS (SELECT P.PRODUCT_ID, P.PRICE, US.UNITS, P.PRICE * US.UNITS AS TOTAL_SALE FROM PRICES P JOIN UNITSSOLD US WHERE P.PRODUCT_ID = US.PRODUCT_ID AND US.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) SELECT PRODUCT_ID, ROUND(SUM(TOTAL_SALE)/SUM(UNITS),2) AVERAGE_PRICE FROM TOTAL_SALE GROUP BY PRODUCT_ID"
663,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/(SUM(U.UNITS)),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
664,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(UNITS * PRICE)/SUM(UNITS),2) AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD US ON P.PRODUCT_ID = US.PRODUCT_ID WHERE US.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY 1"
665,Y,Y,"SELECT P.PRODUCT_ID, COALESCE(ROUND(SUM(P.PRICE * U.UNITS) / SUM(U.UNITS), 2), 0) AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON (U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE >= P.START_DATE AND U.PURCHASE_DATE <= P.END_DATE) GROUP BY P.PRODUCT_ID"
666,Y,Y,"SELECT P.PRODUCT_ID,ROUND(SUM(P.PRICE * US.UNITS) / SUM(US.UNITS),2) AS AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD US ON P.PRODUCT_ID = US.PRODUCT_ID AND US.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE AND US.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
667,Y,N,"WITH CTE AS ( SELECT U.PRODUCT_ID AS PRODUCT_ID, UNITS, PRICE FROM UNITSSOLD U LEFT JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE >= P.START_DATE AND U.PURCHASE_DATE <= P.END_DATE) SELECT PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM CTE GROUP BY PRODUCT_ID"
668,Y,Y,"SELECT U.PRODUCT_ID ,ROUND(SUM(U.UNITS * P.PRICE) / SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD U ON U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE AND P.PRODUCT_ID=U.PRODUCT_ID GROUP BY U.PRODUCT_ID"
669,Y,Y,"WITH A AS ( SELECT U.PRODUCT_ID, PURCHASE_DATE, UNITS, PRICE FROM PRICES P INNER JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE U.PURCHASE_DATE >= P.START_DATE AND U.PURCHASE_DATE <= P.END_DATE ) SELECT DISTINCT PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM A GROUP BY PRODUCT_ID"
670,Y,N,"SELECT UNITSSOLD.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AVERAGE_PRICE FROM UNITSSOLD LEFT JOIN PRICES ON UNITSSOLD.PURCHASE_DATE BETWEEN PRICES.START_DATE AND PRICES.END_DATE AND UNITSSOLD.PRODUCT_ID = PRICES.PRODUCT_ID GROUP BY UNITSSOLD.PRODUCT_ID"
671,Y,Y,"SELECT P1.PRODUCT_ID, ROUND(SUM(P1.PRICE*S1.UNITS)/(SUM(S1.UNITS)),2) AS AVERAGE_PRICE FROM PRICES P1, UNITSSOLD S1 WHERE S1.PURCHASE_DATE>=P1.START_DATE AND S1.PURCHASE_DATE<=P1.END_DATE AND P1.PRODUCT_ID=S1.PRODUCT_ID GROUP BY P1.PRODUCT_ID"
672,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID AND (U.PURCHASE_DATE>=P.START_DATE AND U.PURCHASE_DATE<=P.END_DATE) GROUP BY P.PRODUCT_ID"
673,Y,N,"SELECT U.PRODUCT_ID, ROUND(S.TOTAL_SALES/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD AS U LEFT JOIN (SELECT P.PRODUCT_ID, SUM(CASE WHEN U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE THEN P.PRICE*U.UNITS END) AS TOTAL_SALES FROM PRICES AS P LEFT JOIN UNITSSOLD AS U ON P.PRODUCT_ID = U.PRODUCT_ID GROUP BY P.PRODUCT_ID) AS S ON U.PRODUCT_ID = S.PRODUCT_ID GROUP BY U.PRODUCT_ID"
674,Y,Y,"SELECT S.PRODUCT_ID, ROUND(SUM(S.UNITS*P.PRICE)/SUM(S.UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD S JOIN PRICES P ON P.PRODUCT_ID = S.PRODUCT_ID AND S.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY S.PRODUCT_ID"
675,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(CASE WHEN PURCHASE_DATE BETWEEN START_DATE AND END_DATE THEN PRICE*UNITS ELSE 0 END)/SUM(CASE WHEN PURCHASE_DATE BETWEEN START_DATE AND END_DATE THEN UNITS ELSE 0 END),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID GROUP BY 1"
676,Y,Y,"WITH CTE AS ( SELECT P.PRODUCT_ID, PRICE * UNITS AS SELLINGPRICE, U.UNITS FROM PRICES P JOIN UNITSSOLD U WHERE P.PRODUCT_ID = U.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE ) SELECT PRODUCT_ID, ROUND(SUM(SELLINGPRICE) / SUM(UNITS),2) AS AVERAGE_PRICE FROM CTE GROUP BY PRODUCT_ID"
677,Y,Y,"SELECT A.PRODUCT_ID, ROUND((SUM(PRICE*UNITS))/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES A LEFT JOIN UNITSSOLD B ON A.PRODUCT_ID = B.PRODUCT_ID AND (PURCHASE_DATE BETWEEN START_DATE AND END_DATE) GROUP BY 1"
678,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD U JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY 1"
679,Y,Y,"SELECT PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES NATURAL JOIN UNITSSOLD WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRODUCT_ID"
680,Y,Y,"SELECT PRODUCT_ID,ROUND(SUM(UNITS*PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM( SELECT U.*, PRICE FROM UNITSSOLD U JOIN PRICES P ON U.PRODUCT_ID=P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) T GROUP BY 1"
681,Y,Y,"SELECT PRODUCT_ID, ROUND(SUM(TOTAL_SALES)/TOTAL_UNITS,2) AS AVERAGE_PRICE FROM ( SELECT A.PRODUCT_ID, A.UNITS * B.PRICE AS TOTAL_SALES, SUM(UNITS) OVER(PARTITION BY PRODUCT_ID) AS TOTAL_UNITS FROM UNITSSOLD A INNER JOIN PRICES B ON A.PURCHASE_DATE BETWEEN B.START_DATE AND B.END_DATE AND A.PRODUCT_ID = B.PRODUCT_ID ) A GROUP BY A.PRODUCT_ID"
682,Y,Y,"SELECT S.PRODUCT_ID, ROUND(SUM(P.PRICE * S.UNITS)/SUM(S.UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD S JOIN PRICES P USING (PRODUCT_ID) WHERE S.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY S.PRODUCT_ID"
683,Y,N,"SELECT T.PRODUCT_ID, ROUND(SUM(T.PRICE) / SUM(T.UNITS), 2) AS AVERAGE_PRICE FROM ( SELECT U.PRODUCT_ID, U.UNITS, U.UNITS * P.PRICE AS PRICE FROM UNITSSOLD U LEFT JOIN PRICES P ON U.PURCHASE_DATE >= P.START_DATE AND U.PURCHASE_DATE <= P.END_DATE AND U.PRODUCT_ID = P.PRODUCT_ID ) AS T GROUP BY T.PRODUCT_ID"
684,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(U.UNITS * P.PRICE) / SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY 1"
685,Y,N,"SELECT T1.PRODUCT_ID, ROUND(SUM((UNITS*PRICE))/SUM(UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD T1 LEFT JOIN PRICES T2 ON T1.PRODUCT_ID = T2.PRODUCT_ID AND (PURCHASE_DATE BETWEEN START_DATE AND END_DATE) GROUP BY T1.PRODUCT_ID"
686,Y,N,"SELECT A.PRODUCT_ID, ROUND(SUM(A.UNITS * B.PRICE)/SUM(A.UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD A LEFT JOIN PRICES B ON A.PRODUCT_ID = B.PRODUCT_ID AND A.PURCHASE_DATE BETWEEN B.START_DATE AND B.END_DATE GROUP BY 1 ORDER BY 1"
687,Y,Y,"SELECT P.PRODUCT_ID, ROUND(IFNULL(SUM(PRICE * UNITS) / SUM(UNITS), 0) , 2) AS AVERAGE_PRICE FROM PRICES AS P LEFT JOIN UNITSSOLD AS S ON P.PRODUCT_ID=S.PRODUCT_ID AND S.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY PRODUCT_ID"
688,Y,Y,"SELECT T1.PRODUCT_ID , ROUND(SUM(T2.UNITS*T1.PRICE)/SUM(T2.UNITS),2) AS AVERAGE_PRICE FROM PRICES AS T1 INNER JOIN UNITSSOLD AS T2 ON T1.PRODUCT_ID = T2.PRODUCT_ID AND T2.PURCHASE_DATE BETWEEN T1.START_DATE AND T1.END_DATE GROUP BY PRODUCT_ID"
689,Y,Y,"SELECT PRODUCT_ID, ROUND(SUM(BUY_PRICE) / SUM(UNITS), 2) AVERAGE_PRICE FROM ( SELECT P.PRODUCT_ID, (US.UNITS * P.PRICE) BUY_PRICE, US.UNITS FROM PRICES P JOIN UNITSSOLD US ON P.PRODUCT_ID = US.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE ) T GROUP BY 1"
690,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE * UNITS) / SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY 1"
691,Y,Y,"SELECT U.PRODUCT_ID, ROUND(SUM(PRICE * UNITS)/SUM(UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD U JOIN PRICES P ON P.PRODUCT_ID = U.PRODUCT_ID WHERE PURCHASE_DATE >= START_DATE AND PURCHASE_DATE <= END_DATE GROUP BY 1"
692,Y,Y,"SELECT DISTINCT(U.PRODUCT_ID) ,ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P RIGHT JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY PRODUCT_ID"
693,Y,N,"SELECT U.PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/SUM(UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD U LEFT JOIN PRICES P ON U.PRODUCT_ID=P.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY U.PRODUCT_ID"
694,Y,N,"SELECT PRODUCT_ID, ROUND(SUM(UNITS * PRICE) / SUM(UNITS), 2) AVERAGE_PRICE FROM ( SELECT US.PRODUCT_ID, US.PURCHASE_DATE, US.UNITS, P.PRICE FROM UNITSSOLD US LEFT JOIN PRICES P ON US.PRODUCT_ID = P.PRODUCT_ID AND (US.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) ) T GROUP BY PRODUCT_ID"
695,Y,Y,"SELECT PRICES.PRODUCT_ID, ROUND(SUM(PRICES.PRICE*UNITSSOLD.UNITS)/SUM(UNITSSOLD.UNITS),2) AS AVERAGE_PRICE FROM PRICES JOIN UNITSSOLD ON PRICES.PRODUCT_ID = UNITSSOLD.PRODUCT_ID AND UNITSSOLD.PURCHASE_DATE BETWEEN PRICES.START_DATE AND PRICES.END_DATE GROUP BY PRICES.PRODUCT_ID"
696,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID= U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
697,Y,N,"SELECT PRODUCT_ID, ROUND(SUM(PRICE * UNITS) / SUM(UNITS), 2) AS AVERAGE_PRICE FROM ( SELECT U.PRODUCT_ID, U.PURCHASE_DATE, U.UNITS, PRICES.PRICE FROM UNITSSOLD U LEFT JOIN PRICES ON U.PRODUCT_ID = PRICES.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN PRICES.START_DATE AND PRICES.END_DATE ) AS T GROUP BY PRODUCT_ID"
698,Y,Y,"SELECT P.PRODUCT_ID, IFNULL(ROUND(SUM(PRICE*UNITS)/ SUM(UNITS),2),0) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON U.PRODUCT_ID = P.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRODUCT_ID"
699,Y,Y,"WITH T AS ( SELECT P.PRODUCT_ID, P.PRICE*U.UNITS AS REV , U.UNITS FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) SELECT PRODUCT_ID, ROUND(SUM(REV)/SUM(UNITS),2) AS AVERAGE_PRICE FROM T GROUP BY PRODUCT_ID"
700,Y,Y,"SELECT P.PRODUCT_ID, CAST(SUM(P.PRICE * U.UNITS)/SUM(U.UNITS) AS DECIMAL(10,2)) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY 1"
701,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(U.UNITS*P.PRICE)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND (U.PURCHASE_DATE >= P.START_DATE AND U.PURCHASE_DATE <= P.END_DATE) GROUP BY PRODUCT_ID"
702,Y,Y,"WITH PRICED_UNITS AS ( SELECT U.PRODUCT_ID, U.UNITS, 1.0*P.PRICE*U.UNITS AS TOTAL_PRICE FROM UNITSSOLD U INNER JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE ) SELECT PRODUCT_ID, ROUND(SUM(TOTAL_PRICE)/SUM(UNITS), 2) AS AVERAGE_PRICE FROM PRICED_UNITS GROUP BY PRODUCT_ID"
703,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE * US.UNITS) / SUM(US.UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD US ON P.PRODUCT_ID=US.PRODUCT_ID AND (US.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) GROUP BY P.PRODUCT_ID"
704,Y,Y,"WITH T AS (SELECT PRICES.PRODUCT_ID, PRICES.PRICE, UNITS FROM PRICES LEFT JOIN UNITSSOLD ON PRICES.PRODUCT_ID = UNITSSOLD.PRODUCT_ID WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE) SELECT DISTINCT PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM T GROUP BY 1"
705,Y,N,"SELECT PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/SUM(UNITS), 2) AS AVERAGE_PRICE FROM ( SELECT U.PRODUCT_ID, U.PURCHASE_DATE, U.UNITS, P.PRICE FROM UNITSSOLD U LEFT JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND START_DATE <= U.PURCHASE_DATE AND U.PURCHASE_DATE <= END_DATE ) T GROUP BY 1"
706,Y,Y,"SELECT ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE, US.PRODUCT_ID FROM UNITSSOLD AS US INNER JOIN PRICES ON PRICES.PRODUCT_ID = US.PRODUCT_ID WHERE PURCHASE_DATE>= START_DATE AND PURCHASE_DATE <= END_DATE GROUP BY US.PRODUCT_ID"
707,Y,Y,"SELECT A.PRODUCT_ID, ROUND(SUM(A.PRICE*B.UNITS)/SUM(B.UNITS), 2) AS AVERAGE_PRICE FROM PRICES AS A JOIN UNITSSOLD AS B ON A.PRODUCT_ID = B.PRODUCT_ID WHERE B.PURCHASE_DATE BETWEEN A.START_DATE AND A.END_DATE GROUP BY A.PRODUCT_ID"
708,Y,Y,"SELECT PRICES.PRODUCT_ID AS PRODUCT_ID, ROUND(SUM(PRICE*UNITS)*1.0/SUM(UNITS)*1.0,2) AS AVERAGE_PRICE FROM PRICES JOIN UNITSSOLD ON PRICES.PRODUCT_ID = UNITSSOLD.PRODUCT_ID AND UNITSSOLD.PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRODUCT_ID"
709,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE* U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND P.START_DATE<= U.PURCHASE_DATE AND P.END_DATE >= U.PURCHASE_DATE GROUP BY 1"
710,Y,Y,"SELECT P.PRODUCT_ID AS PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY P.PRODUCT_ID"
711,Y,Y,"SELECT P.PRODUCT_ID, (ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2)) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND (U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) GROUP BY P.PRODUCT_ID"
712,Y,Y,"SELECT A.PRODUCT_ID, ROUND(SUM(B.UNITS * A.PRICE) / SUM(B.UNITS), 2) AS AVERAGE_PRICE FROM PRICES AS A JOIN UNITSSOLD AS B ON A.PRODUCT_ID = B.PRODUCT_ID AND (B.PURCHASE_DATE BETWEEN A.START_DATE AND A.END_DATE) GROUP BY A.PRODUCT_ID"
713,Y,Y,"SELECT US.PRODUCT_ID, ROUND(SUM(US.UNITS * P.PRICE) / SUM(US.UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD US INNER JOIN PRICES P ON US.PRODUCT_ID = P.PRODUCT_ID AND US.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY US.PRODUCT_ID"
714,Y,Y,"SELECT U.PRODUCT_ID, ROUND(SUM(UNITS * PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD AS U INNER JOIN PRICES AS P ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY 1"
715,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(US.UNITS * P.PRICE)/SUM(US.UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD US INNER JOIN PRICES P ON P.PRODUCT_ID = US.PRODUCT_ID AND US.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY 1"
716,Y,Y,"SELECT PRICES.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AVERAGE_PRICE FROM UNITSSOLD INNER JOIN PRICES ON UNITSSOLD.PRODUCT_ID=PRICES.PRODUCT_ID AND UNITSSOLD.PURCHASE_DATE BETWEEN PRICES.START_DATE AND PRICES.END_DATE GROUP BY PRODUCT_ID"
717,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(U.UNITS * P.PRICE) / SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD AS U JOIN PRICES AS P ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
718,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE * U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES AS P INNER JOIN UNITSSOLD AS U ON U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE AND P.PRODUCT_ID = U.PRODUCT_ID GROUP BY P.PRODUCT_ID"
719,Y,Y,"SELECT T.PRODUCT_ID, ROUND((SUM(T.PRICE*U.UNITS))/SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM PRICES T LEFT JOIN UNITSSOLD U ON T.PRODUCT_ID = U.PRODUCT_ID AND T.START_DATE <= U.PURCHASE_DATE AND T.END_DATE >= U.PURCHASE_DATE GROUP BY T.PRODUCT_ID"
720,Y,Y,"SELECT U.PRODUCT_ID, ROUND(SUM(P.PRICE * U.UNITS) / SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD AS U INNER JOIN PRICES AS P ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY U.PRODUCT_ID"
721,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P INNER JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
722,Y,N,"SELECT P.PRODUCT_ID , ROUND(SUM(P.PRICE * U.UNITS)/SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD U LEFT JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND DATEDIFF(U.PURCHASE_DATE, P.START_DATE) >= 0 AND DATEDIFF(P.END_DATE, U.PURCHASE_DATE) >= 0 GROUP BY PRODUCT_ID"
723,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/ SUM(UNITS),2)AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD Q ON (P.PRODUCT_ID = Q.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE) GROUP BY 1"
724,Y,Y,"SELECT PRICES.PRODUCT_ID, ROUND(SUM((PRICES.PRICE * U.UNITS))/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES LEFT JOIN UNITSSOLD U ON PRICES.PRODUCT_ID = U.PRODUCT_ID WHERE U.PURCHASE_DATE BETWEEN PRICES.START_DATE AND PRICES.END_DATE GROUP BY PRICES.PRODUCT_ID"
725,Y,N,"WITH TOTAL AS (SELECT PRODUCT_ID, SUM(PRICE*UNITS) AS TOTAL FROM PRICES JOIN UNITSSOLD USING(PRODUCT_ID) WHERE PURCHASE_DATE >= START_DATE AND PURCHASE_DATE<=END_DATE GROUP BY PRODUCT_ID), TOTAL_UNITS AS ( SELECT PRODUCT_ID, SUM(UNITS) AS QUANTITY FROM UNITSSOLD GROUP BY PRODUCT_ID) SELECT PRODUCT_ID, ROUND(TOTAL/QUANTITY,2) AS AVERAGE_PRICE FROM TOTAL JOIN TOTAL_UNITS USING(PRODUCT_ID)"
726,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*S.UNITS) / SUM(S.UNITS), 2) AVERAGE_PRICE FROM UNITSSOLD S JOIN PRICES P ON P.PRODUCT_ID = S.PRODUCT_ID AND S.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
727,Y,Y,"SELECT T2.PRODUCT_ID, ROUND(SUM(T2.UNITS*T1.PRICE)/SUM(T2.UNITS),2) AS AVERAGE_PRICE FROM PRICES T1 JOIN UNITSSOLD T2 ON T2.PURCHASE_DATE>=T1.START_DATE AND T2.PURCHASE_DATE<=T1.END_DATE AND T1.PRODUCT_ID = T2.PRODUCT_ID GROUP BY T2.PRODUCT_ID"
728,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(UNITS * PRICE)/SUM(UNITS),2) AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD US USING(PRODUCT_ID) WHERE US.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY PRODUCT_ID"
729,Y,Y,"SELECT U.PRODUCT_ID ,ROUND(SUM(PRICE*UNITS)/SUM(UNITS), 2) AVERAGE_PRICE FROM UNITSSOLD U LEFT JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY U.PRODUCT_ID"
730,Y,Y,"SELECT PRODUCT_ID,ROUND(SUM(PRICING)/SUM(UNITS),2) AS AVERAGE_PRICE FROM ( SELECT A.PRODUCT_ID,A.PRICE,B.UNITS, A.PRICE*B.UNITS AS PRICING FROM PRICES A INNER JOIN UNITSSOLD B ON A.PRODUCT_ID =B.PRODUCT_ID AND B.PURCHASE_DATE BETWEEN A.START_DATE AND A.END_DATE ) A GROUP BY 1"
731,Y,Y,"SELECT PRICES.PRODUCT_ID , ROUND(SUM(UNITS*PRICE) / SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES INNER JOIN UNITSSOLD ON PRICES.PRODUCT_ID = UNITSSOLD.PRODUCT_ID WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRODUCT_ID"
732,Y,Y,"SELECT A.PRODUCT_ID, ROUND(SUM(B.UNITS * A.PRICE) / SUM(B.UNITS), 2) AS AVERAGE_PRICE FROM PRICES AS A JOIN UNITSSOLD AS B ON A.PRODUCT_ID = B.PRODUCT_ID AND B.PURCHASE_DATE BETWEEN A.START_DATE AND A.END_DATE GROUP BY A.PRODUCT_ID"
733,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE * U.UNITS) / SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM PRICES P, UNITSSOLD U WHERE P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE >= P.START_DATE AND U.PURCHASE_DATE <= P.END_DATE GROUP BY 1"
734,Y,N,"WITH PRICE_PER_PERIOD AS ( SELECT A.PRODUCT_ID, A.PURCHASE_DATE, CASE WHEN A.PRODUCT_ID = B.PRODUCT_ID AND A.PURCHASE_DATE BETWEEN B.START_DATE AND B.END_DATE THEN B.PRICE ELSE 0 END AS PRODUCT_PRICE, CASE WHEN A.PRODUCT_ID = B.PRODUCT_ID AND A.PURCHASE_DATE BETWEEN B.START_DATE AND B.END_DATE THEN A.UNITS ELSE 0 END AS UNITS FROM UNITSSOLD A LEFT JOIN PRICES B ON A.PRODUCT_ID = B.PRODUCT_ID AND A.PURCHASE_DATE BETWEEN B.START_DATE AND B.END_DATE ) , TOTAL_PRODUCT_PRICE AS ( SELECT PRODUCT_ID, PURCHASE_DATE, UNITS, PRODUCT_PRICE * UNITS AS TOTAL_PRICE FROM PRICE_PER_PERIOD ) SELECT PRODUCT_ID, ROUND(SUM(TOTAL_PRICE) / SUM(UNITS),2) AS AVERAGE_PRICE FROM TOTAL_PRODUCT_PRICE GROUP BY 1 ORDER BY 1"
735,Y,Y,"SELECT P.PRODUCT_ID, ROUND((SUM(P.PRICE*U.UNITS)/SUM(U.UNITS)),2) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRODUCT_ID"
736,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(U.UNITS*P.PRICE)/SUM(U.UNITS),2)AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON U.PRODUCT_ID =P.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY P.PRODUCT_ID"
737,Y,Y,"SELECT A.PRODUCT_ID ,ROUND(SUM(A.UNITS*A.PRICE)/SUM(A.UNITS),2) AS AVERAGE_PRICE FROM (SELECT U.PRODUCT_ID, U.UNITS ,P.PRICE FROM UNITSSOLD U INNER JOIN PRICES P ON U.PRODUCT_ID =P.PRODUCT_ID WHERE (U.PURCHASE_DATE <=P.END_DATE AND U.PURCHASE_DATE >=P.START_DATE) ) AS A GROUP BY A.PRODUCT_ID"
738,Y,Y,"SELECT A.PRODUCT_ID, ROUND(SUM(B.UNITS*A.PRICE)/SUM(B.UNITS),2) AS AVERAGE_PRICE FROM PRICES AS A JOIN UNITSSOLD AS B USING (PRODUCT_ID) WHERE B.PURCHASE_DATE BETWEEN A.START_DATE AND A.END_DATE GROUP BY 1"
739,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY 1"
740,Y,Y,"SELECT P1.PRODUCT_ID, ROUND(SUM(P1.PRICE*S1.UNITS)/(SUM(S1.UNITS)),2) AS AVERAGE_PRICE FROM PRICES P1 LEFT JOIN UNITSSOLD S1 ON P1.PRODUCT_ID=S1.PRODUCT_ID AND S1.PURCHASE_DATE BETWEEN P1.START_DATE AND P1.END_DATE GROUP BY P1.PRODUCT_ID"
741,Y,Y,"SELECT PRODUCT_ID,ROUND(SUM(UNITS*PRICE)/SUM(UNITS),2) AVERAGE_PRICE FROM UNITSSOLD JOIN PRICES USING (PRODUCT_ID) WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRODUCT_ID"
742,Y,Y,"WITH TEMP AS (SELECT A.PRODUCT_ID, A.UNITS,B.PRICE,(A.UNITS * B.PRICE) AS TOTAL_COST FROM UNITSSOLD A INNER JOIN PRICES B ON A.PRODUCT_ID=B.PRODUCT_ID WHERE A.PURCHASE_DATE BETWEEN B.START_DATE AND B.END_DATE) SELECT PRODUCT_ID, ROUND(SUM(TOTAL_COST)/SUM(UNITS),2) AS AVERAGE_PRICE FROM TEMP GROUP BY 1"
743,Y,N,"WITH T AS (SELECT U.PRODUCT_ID, PURCHASE_DATE, UNITS, P.PRICE FROM UNITSSOLD U LEFT JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) SELECT PRODUCT_ID, ROUND(SUM(UNITS * PRICE) / SUM(UNITS),2) AS AVERAGE_PRICE FROM T GROUP BY PRODUCT_ID"
744,Y,Y,"SELECT P.PRODUCT_ID , ROUND(SUM(U.UNITS*P.PRICE)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD U JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE >= P.START_DATE AND U.PURCHASE_DATE <= P.END_DATE GROUP BY PRODUCT_ID"
745,Y,Y,"WITH CTE AS( SELECT UNITSSOLD.PRODUCT_ID AS PRODUCT_ID, UNITS*PRICE AS TOTAL_PAID, UNITS FROM PRICES JOIN UNITSSOLD ON PRICES.PRODUCT_ID = UNITSSOLD.PRODUCT_ID WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE ) SELECT PRODUCT_ID, ROUND( SUM(TOTAL_PAID) / SUM(UNITS), 2) AS AVERAGE_PRICE FROM CTE GROUP BY PRODUCT_ID"
746,Y,N,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS), 2) AVERAGE_PRICE FROM PRICES P RIGHT JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY PRODUCT_ID"
747,Y,Y,"SELECT U.PRODUCT_ID , ROUND(SUM(U.UNITS*P.PRICE)/SUM(U.UNITS),2) AVERAGE_PRICE FROM UNITSSOLD U JOIN PRICES P ON U.PRODUCT_ID=P.PRODUCT_ID WHERE P.START_DATE <= U.PURCHASE_DATE AND P.END_DATE >= U.PURCHASE_DATE GROUP BY U.PRODUCT_ID"
748,Y,Y,"WITH T AS ( SELECT U.PRODUCT_ID, U.PURCHASE_DATE, U.UNITS, P.PRICE, U.UNITS*P.PRICE REVENUE FROM UNITSSOLD U, PRICES P WHERE U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE >= P.START_DATE AND U.PURCHASE_DATE <= P.END_DATE ) SELECT T.PRODUCT_ID, ROUND(SUM(T.REVENUE)/SUM(T.UNITS),2) AVERAGE_PRICE FROM T GROUP BY T.PRODUCT_ID"
749,Y,Y,"SELECT U.PRODUCT_ID,ROUND((SUM(U.UNITS * P.PRICE)*1.0)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD U JOIN PRICES P ON U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE AND U.PRODUCT_ID = P.PRODUCT_ID GROUP BY U.PRODUCT_ID"
750,Y,N,"SELECT US.PRODUCT_ID, ROUND(SUM(US.UNITS * P.PRICE)/SUM(US.UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD AS US LEFT JOIN PRICES AS P ON US.PRODUCT_ID = P.PRODUCT_ID AND US.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY US.PRODUCT_ID"
751,Y,Y,"SELECT A.PRODUCT_ID, ROUND(SUM(A.PRICE*B.UNITS)/SUM(B.UNITS),2) AS AVERAGE_PRICE FROM PRICES AS A JOIN UNITSSOLD AS B ON A.PRODUCT_ID =B.PRODUCT_ID AND B.PURCHASE_DATE BETWEEN A.START_DATE AND A.END_DATE GROUP BY A.PRODUCT_ID"
752,Y,Y,"SELECT U.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY U.PRODUCT_ID"
753,Y,Y,"SELECT P.PRODUCT_ID AS PRODUCT_ID, ROUND(SUM(P.PRICE * U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND (U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE) GROUP BY PRODUCT_ID"
754,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(U.UNITS*P.PRICE) /SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON (P.PRODUCT_ID = U.PRODUCT_ID) WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY PRODUCT_ID"
755,Y,Y,"SELECT PRICES.PRODUCT_ID, ROUND(SUM(UNITS * PRICE) / SUM(UNITS), 2) AS AVERAGE_PRICE FROM UNITSSOLD RIGHT JOIN PRICES ON UNITSSOLD.PRODUCT_ID = PRICES.PRODUCT_ID WHERE START_DATE <= PURCHASE_DATE AND END_DATE >= PURCHASE_DATE GROUP BY PRICES.PRODUCT_ID"
756,Y,Y,"SELECT U.PRODUCT_ID, ROUND((SUM(P.PRICE * U.UNITS) / SUM(U.UNITS)), 2) AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U USING (PRODUCT_ID) WHERE U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY U.PRODUCT_ID"
757,Y,N,"SELECT U.PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD U LEFT JOIN PRICES P ON U.PRODUCT_ID = P.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRODUCT_ID"
758,Y,Y,"SELECT A.PRODUCT_ID, ROUND(SUM(UNITS*PRICE)/SUM(UNITS),2) AVERAGE_PRICE FROM UNITSSOLD A LEFT JOIN PRICES B ON A.PRODUCT_ID=B.PRODUCT_ID WHERE PURCHASE_DATE >= START_DATE AND PURCHASE_DATE <= END_DATE GROUP BY A.PRODUCT_ID"
759,Y,N,"WITH PRICE_LOOKUP AS (SELECT UNITSSOLD.*, UNITS*PRICE AS TOTAL_PRICE FROM UNITSSOLD LEFT JOIN PRICES ON UNITSSOLD.PRODUCT_ID = PRICES.PRODUCT_ID AND UNITSSOLD.PURCHASE_DATE >= PRICES.START_DATE AND UNITSSOLD.PURCHASE_DATE <= PRICES.END_DATE) SELECT PRODUCT_ID, ROUND(SUM(TOTAL_PRICE) / SUM(UNITS), 2) AS AVERAGE_PRICE FROM PRICE_LOOKUP GROUP BY PRODUCT_ID"
760,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(PRICE * UNITS) / SUM(UNITS), 2) AS AVERAGE_PRICE FROM PRICES AS P JOIN UNITSSOLD AS U ON P.PRODUCT_ID = U.PRODUCT_ID AND PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRODUCT_ID"
761,Y,Y,"SELECT P.PRODUCT_ID AS PRODUCT_ID, ROUND(SUM(P.PRICE * U.UNITS)/SUM( U.UNITS), 2) AS AVERAGE_PRICE FROM PRICES P LEFT JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
762,Y,Y,"WITH TABLE1 AS ( SELECT PR.PRODUCT_ID,PR.PRICE,US.UNITS FROM PRICES AS PR LEFT JOIN UNITSSOLD US ON PR.PRODUCT_ID=US.PRODUCT_ID WHERE US.PURCHASE_DATE<=PR.END_DATE AND US.PURCHASE_DATE>=PR.START_DATE ) SELECT PRODUCT_ID, ROUND(SUM(PRICE*UNITS)/SUM(UNITS),2) AS AVERAGE_PRICE FROM TABLE1 GROUP BY PRODUCT_ID"
763,Y,Y,"SELECT DISTINCT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P, UNITSSOLD U WHERE U.PRODUCT_ID=P.PRODUCT_ID AND DATE(U.PURCHASE_DATE) BETWEEN P.START_DATE AND P.END_DATE GROUP BY PRODUCT_ID"
764,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/ SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID AND U.PURCHASE_DATE>=P.START_DATE AND U.PURCHASE_DATE<=P.END_DATE GROUP BY 1"
765,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(U.UNITS*P.PRICE)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM UNITSSOLD AS U INNER JOIN PRICES AS P ON P.PRODUCT_ID = U.PRODUCT_ID WHERE PURCHASE_DATE BETWEEN START_DATE AND END_DATE GROUP BY PRODUCT_ID"
766,Y,Y,"WITH AUX_TABLE AS ( SELECT P.PRODUCT_ID, SUM(U.UNITS) AS TOTAL_UNITS, SUM(P.PRICE*U.UNITS) AS TOTAL_PRICE FROM PRICES AS P INNER JOIN UNITSSOLD AS U ON P.START_DATE <= U.PURCHASE_DATE AND P.END_DATE >= U.PURCHASE_DATE AND P.PRODUCT_ID = U.PRODUCT_ID GROUP BY P.PRODUCT_ID ) SELECT PRODUCT_ID, ROUND(TOTAL_PRICE/TOTAL_UNITS,2) AS AVERAGE_PRICE FROM AUX_TABLE"
767,Y,Y,"SELECT P.PRODUCT_ID, ROUND(SUM(U.UNITS * P.PRICE)/ SUM(U.UNITS), 2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID = U.PRODUCT_ID AND (U.PURCHASE_DATE >= P.START_DATE AND U.PURCHASE_DATE <= P.END_DATE) GROUP BY P.PRODUCT_ID"
768,Y,Y,"SELECT U.PRODUCT_ID, ROUND(SUM(P.PRICE*U.UNITS)/SUM(U.UNITS),2) AS AVERAGE_PRICE FROM PRICES P JOIN UNITSSOLD U ON P.PRODUCT_ID=U.PRODUCT_ID AND U.PURCHASE_DATE BETWEEN P.START_DATE AND P.END_DATE GROUP BY P.PRODUCT_ID"
