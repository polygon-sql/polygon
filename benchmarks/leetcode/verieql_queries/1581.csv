qid,mysql_can_execute?,mysql_correct?,mysql_query
0,Y,Y,"(SELECT V.CUSTOMER_ID,COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID=T.VISIT_ID WHERE AMOUNT IS NULL GROUP BY V.CUSTOMER_ID)"
1,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT DISTINCT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
2,Y,Y,"SELECT DISTINCT VISITS.CUSTOMER_ID, COUNT(IF(TRANSACTIONS.VISIT_ID IS NULL, 1, 0)) OVER (PARTITION BY VISITS.CUSTOMER_ID)AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTIONS.VISIT_ID IS NULL"
3,Y,Y,"SELECT DISTINCT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTIONS.VISIT_ID IS NULL GROUP BY CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC"
4,Y,Y,"SELECT DISTINCT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT DISTINCT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
5,Y,Y,"SELECT DISTINCT V.CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY V.CUSTOMER_ID"
6,Y,Y,"SELECT DISTINCT V.CUSTOMER_ID, COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC"
7,Y,Y,"SELECT T1.CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS AS T1 LEFT JOIN TRANSACTIONS AS T2 ON T1.VISIT_ID = T2.VISIT_ID WHERE T2.TRANSACTION_ID IS NULL GROUP BY T1.CUSTOMER_ID HAVING COUNT(*) > 0"
8,Y,Y,"SELECT V.CUSTOMER_ID CUSTOMER_ID, COUNT(DISTINCT V.VISIT_ID) COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY 1"
9,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM (SELECT * FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS)) V GROUP BY 1"
10,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID"
11,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(T.TRANSACTION_ID IS NULL) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY V.CUSTOMER_ID"
12,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID WHERE ISNULL(T.TRANSACTION_ID) GROUP BY V.CUSTOMER_ID"
13,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID"
14,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID"
15,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY 1"
16,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID=T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY V.CUSTOMER_ID"
17,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID WHERE T.AMOUNT IS NULL GROUP BY V.CUSTOMER_ID"
18,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY 1"
19,Y,Y,"SELECT VISITS.CUSTOMER_ID AS CUSTOMER_ID, SUM(IF(P.TOTAL_TIMES IS NULL, 1, 0)) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN (SELECT VISIT_ID, COUNT(TRANSACTION_ID) AS TOTAL_TIMES, TRANSACTION_ID FROM TRANSACTIONS GROUP BY VISIT_ID) P ON P.VISIT_ID=VISITS.VISIT_ID WHERE P.TRANSACTION_ID IS NULL GROUP BY VISITS.CUSTOMER_ID"
20,Y,Y,"SELECT VISITS.CUSTOMER_ID, COUNT(VISITS.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON TRANSACTIONS.VISIT_ID = VISITS.VISIT_ID WHERE TRANSACTIONS.TRANSACTION_ID IS NULL GROUP BY 1"
21,Y,Y,"SELECT VISITS.CUSTOMER_ID, COUNT(VISITS.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTIONS.AMOUNT IS NULL GROUP BY VISITS.CUSTOMER_ID"
22,Y,Y,"SELECT VISITS.CUSTOMER_ID, COUNT(VISITS.VISIT_ID) AS COUNT_NO_TRANS FROM TRANSACTIONS RIGHT JOIN VISITS ON TRANSACTIONS.VISIT_ID = VISITS.VISIT_ID WHERE TRANSACTIONS.AMOUNT IS NULL GROUP BY 1"
23,Y,Y,"SELECT A.CUSTOMER_ID , COUNT(A.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS A LEFT JOIN TRANSACTIONS B ON A.VISIT_ID = B.VISIT_ID WHERE B.TRANSACTION_ID IS NULL GROUP BY 1"
24,Y,Y,"SELECT A.CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS AS A LEFT JOIN TRANSACTIONS AS B ON A.VISIT_ID = B.VISIT_ID WHERE B.AMOUNT IS NULL GROUP BY 1"
25,Y,Y,"SELECT A.CUSTOMER_ID, COUNT(A.VISIT_ID) COUNT_NO_TRANS FROM VISITS A LEFT JOIN TRANSACTIONS B ON A.VISIT_ID = B.VISIT_ID WHERE B.VISIT_ID IS NULL GROUP BY A.CUSTOMER_ID"
26,Y,Y,"SELECT CUSTOMER_ID , COUNT(DISTINCT VISIT_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
27,Y,Y,"SELECT CUSTOMER_ID , SUM(CASE WHEN T.VISIT_ID IS NULL THEN 1 ELSE 0 END) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID GROUP BY CUSTOMER_ID HAVING COUNT_NO_TRANS > 0"
28,Y,Y,"SELECT CUSTOMER_ID ,SUM(CASE WHEN CT_TRANS=0 THEN 1 ELSE 0 END) AS COUNT_NO_TRANS FROM (SELECT V.VISIT_ID ,V.CUSTOMER_ID ,COUNT(T.TRANSACTION_ID) AS CT_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID GROUP BY 1,2) A GROUP BY 1 HAVING COUNT_NO_TRANS > 0"
29,Y,Y,"SELECT CUSTOMER_ID ,SUM(CASE WHEN TRANSACTION_CT=0 THEN 1 ELSE 0 END) AS COUNT_NO_TRANS FROM (SELECT V.CUSTOMER_ID ,V.VISIT_ID ,COUNT(T.TRANSACTION_ID) AS TRANSACTION_CT FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID GROUP BY 1,2) A GROUP BY 1 HAVING COUNT_NO_TRANS > 0"
30,Y,Y,"SELECT CUSTOMER_ID AS CUSTOMER_ID, COUNT(1) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
31,Y,Y,"SELECT CUSTOMER_ID AS CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN( SELECT VISIT_ID FROM TRANSACTIONS ) GROUP BY CUSTOMER_ID"
32,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM ( SELECT T1.VISIT_ID, T1.CUSTOMER_ID, T2.VISIT_ID AS TRANS_ID FROM VISITS T1 LEFT JOIN TRANSACTIONS T2 ON T1.VISIT_ID = T2.VISIT_ID) T WHERE T.TRANS_ID IS NULL GROUP BY 1 ORDER BY 2 DESC"
33,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM (SELECT CUSTOMER_ID,TRANSACTION_ID FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID) SUB WHERE SUB.TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
34,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID=T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID"
35,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON TRANSACTIONS.VISIT_ID = VISITS.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
36,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
37,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID=TRANSACTIONS.VISIT_ID WHERE TRANSACTIONS.VISIT_ID IS NULL GROUP BY CUSTOMER_ID"
38,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN ( SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
39,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY 1"
40,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN( SELECT DISTINCT VISIT_ID FROM TRANSACTIONS WHERE AMOUNT > 0 ) GROUP BY CUSTOMER_ID"
41,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
42,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID=T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID"
43,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T USING(VISIT_ID) WHERE T.VISIT_ID IS NULL GROUP BY 1"
44,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS USING(VISIT_ID) WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
45,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID ORDER BY COUNT(*)"
46,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS WHERE VISITS.VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
47,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS NATURAL LEFT JOIN TRANSACTIONS WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
48,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT DISTINCT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
49,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE AMOUNT IS NULL GROUP BY CUSTOMER_ID"
50,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
51,Y,Y,"SELECT CUSTOMER_ID, COUNT(DISTINCT A1.VISIT_ID) AS COUNT_NO_TRANS FROM (SELECT CUSTOMER_ID, VISITS.VISIT_ID FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE AMOUNT IS NULL) A1 GROUP BY CUSTOMER_ID"
52,Y,Y,"SELECT CUSTOMER_ID, COUNT(IFNULL(TID, 0)) AS COUNT_NO_TRANS FROM ( SELECT V.CUSTOMER_ID AS CUSTOMER_ID, V.VISIT_ID AS VISIT_ID, T.TRANSACTION_ID AS TID FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID)A WHERE TID IS NULL GROUP BY CUSTOMER_ID"
53,Y,Y,"SELECT CUSTOMER_ID, COUNT(IFNULL(TRANSACTION_ID, 0)) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
54,Y,Y,"SELECT CUSTOMER_ID, COUNT(IFNULL(TRANSACTION_ID, 0)) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
55,Y,Y,"SELECT CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC, V.CUSTOMER_ID ASC"
56,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISITS.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTIONS.VISIT_ID IS NULL GROUP BY CUSTOMER_ID"
57,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISITS.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
58,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM ( SELECT CUSTOMER_ID FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTION_ID IS NULL ) AS A GROUP BY CUSTOMER_ID"
59,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS AS V WHERE V.VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
60,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTIONS.TRANSACTION_ID IS NULL GROUP BY VISITS.CUSTOMER_ID"
61,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTIONS.VISIT_ID IS NULL GROUP BY VISITS.CUSTOMER_ID"
62,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTIONS.VISIT_ID IS NULL GROUP BY CUSTOMER_ID"
63,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
64,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS USING(VISIT_ID) WHERE AMOUNT IS NULL GROUP BY CUSTOMER_ID"
65,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS WHERE NOT EXISTS( SELECT NULL FROM TRANSACTIONS WHERE VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID ) GROUP BY CUSTOMER_ID"
66,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT DISTINCT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
67,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT V.VISIT_ID FROM VISITS V INNER JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID) GROUP BY CUSTOMER_ID"
68,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
69,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY V.CUSTOMER_ID"
70,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE AMOUNT IS NULL GROUP BY CUSTOMER_ID"
71,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY V.CUSTOMER_ID"
72,Y,Y,"SELECT CUSTOMER_ID, COUNT(T.TRANSACTION_ID IS NULL) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
73,Y,Y,"SELECT CUSTOMER_ID, COUNT(TRANSACTION_ID IS NULL) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
74,Y,Y,"SELECT CUSTOMER_ID, COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON T.VISIT_ID = V.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
75,Y,Y,"SELECT CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON T.VISIT_ID = V.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
76,Y,Y,"SELECT CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
77,Y,Y,"SELECT CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY CUSTOMER_ID"
78,Y,Y,"SELECT CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
79,Y,Y,"SELECT CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T USING (VISIT_ID) WHERE T.VISIT_ID IS NULL GROUP BY CUSTOMER_ID"
80,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT DISTINCT VISIT_ID FROM TRANSACTIONS) GROUP BY 1"
81,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS USING(VISIT_ID) WHERE TRANSACTIONS.VISIT_ID IS NULL GROUP BY CUSTOMER_ID"
82,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS USING(VISIT_ID) WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
83,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN ( SELECT VISIT_ID FROM TRANSACTIONS ) GROUP BY CUSTOMER_ID"
84,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT DISTINCT(VISIT_ID) FROM TRANSACTIONS) GROUP BY 1"
85,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T USING (VISIT_ID) WHERE T.TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
86,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T USING(VISIT_ID) WHERE T.VISIT_ID IS NULL GROUP BY 1"
87,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V WHERE VISIT_ID NOT IN (SELECT DISTINCT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
88,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V WHERE VISIT_ID NOT IN(SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID ORDER BY COUNT_NO_TRANS"
89,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID ORDER BY 2"
90,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM( SELECT V.VISIT_ID, V.CUSTOMER_ID, TRANSACTION_ID, AMOUNT FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE AMOUNT IS NULL ) SUB GROUP BY CUSTOMER_ID"
91,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISIT_ID) COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS USING(VISIT_ID) WHERE AMOUNT IS NULL GROUP BY CUSTOMER_ID"
92,Y,Y,"SELECT CUSTOMER_ID, SUM(CASE WHEN T.AMOUNT IS NULL THEN 1 ELSE 0 END) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID GROUP BY 1 HAVING COUNT_NO_TRANS > 0"
93,Y,Y,"SELECT CUSTOMER_ID, SUM(NO_TRANS) AS COUNT_NO_TRANS FROM (SELECT V.CUSTOMER_ID, V.VISIT_ID, T.AMOUNT, CASE WHEN T.AMOUNT IS NULL THEN 1 ELSE 0 END AS NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID) T GROUP BY 1 HAVING COUNT_NO_TRANS >0"
94,Y,Y,"SELECT CUSTOMER_ID, SUM(NUM_TRANSACTIONS IS NULL) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN ( SELECT COUNT(TRANSACTION_ID) AS NUM_TRANSACTIONS, VISIT_ID FROM TRANSACTIONS GROUP BY VISIT_ID ) N ON V.VISIT_ID = N.VISIT_ID GROUP BY CUSTOMER_ID HAVING SUM(NUM_TRANSACTIONS IS NULL) > 0"
95,Y,Y,"SELECT CUSTOMER_ID, SUM(TRANS) AS COUNT_NO_TRANS FROM (SELECT CUSTOMER_ID , COALESCE(TRANSACTION_ID, 1) AS TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON T.VISIT_ID = V.VISIT_ID WHERE T.TRANSACTION_ID IS NULL ) NO_TRANS GROUP BY 1"
96,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS V LEFT OUTER JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID"
97,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS USING (VISIT_ID) WHERE AMOUNT IS NULL GROUP BY CUSTOMER_ID ORDER BY 2,1"
98,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY CUSTOMER_ID"
99,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
100,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY 1"
101,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISIT_ID) COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY 1"
102,Y,Y,"SELECT CUSTOMER_ID, COUNT_NO_TRANS FROM (SELECT CUSTOMER_ID, SUM(ISNULL(TRANSACTION_ID)) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID GROUP BY CUSTOMER_ID) AS A WHERE COUNT_NO_TRANS != 0"
103,Y,Y,"SELECT CUSTOMER_ID,COUNT(*) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE AMOUNT IS NULL GROUP BY CUSTOMER_ID"
104,Y,Y,"SELECT CUSTOMER_ID,COUNT(*) AS COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS ) GROUP BY CUSTOMER_ID"
105,Y,Y,"SELECT CUSTOMER_ID,COUNT(*) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT DISTINCT VISIT_ID FROM TRANSACTIONS) GROUP BY 1"
106,Y,Y,"SELECT FIN.CUSTOMER_ID, COUNT(FIN.CUSTOMER_ID) COUNT_NO_TRANS FROM (SELECT V.CUSTOMER_ID AS CUSTOMER_ID FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL) FIN GROUP BY FIN.CUSTOMER_ID ORDER BY COUNT(FIN.CUSTOMER_ID) DESC"
107,Y,Y,"SELECT V.CUSTOMER_ID ,COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.AMOUNT IS NULL GROUP BY V.CUSTOMER_ID"
108,Y,Y,"SELECT V.CUSTOMER_ID AS CUSTOMER_ID, COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY V.CUSTOMER_ID"
109,Y,Y,"SELECT V.CUSTOMER_ID AS CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY V.CUSTOMER_ID"
110,Y,Y,"SELECT V.CUSTOMER_ID AS CUSTOMER_ID ,COUNT(*) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY 1 ORDER BY 2 DESC"
111,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID WHERE ISNULL(T.TRANSACTION_ID) GROUP BY V.CUSTOMER_ID"
112,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID ORDER BY CUSTOMER_ID"
113,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY V.CUSTOMER_ID"
114,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(*) COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY 1"
115,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(1) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY 1"
116,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID"
117,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID"
118,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID"
119,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T USING (VISIT_ID) WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID"
120,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON T.VISIT_ID = V.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY V.CUSTOMER_ID"
121,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY 1"
122,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN (SELECT T.VISIT_ID FROM TRANSACTIONS T) GROUP BY V.CUSTOMER_ID"
123,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY CUSTOMER_ID"
124,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY V.CUSTOMER_ID"
125,Y,Y,"SELECT V.CUSTOMER_ID, SUM( CASE WHEN T.TRANSACTION_ID IS NULL THEN 1 ELSE 0 END ) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID GROUP BY V.CUSTOMER_ID HAVING COUNT_NO_TRANS != 0"
126,Y,Y,"SELECT V.CUSTOMER_ID, SUM(CASE WHEN T.VISIT_ID IS NULL THEN 1 END) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY V.CUSTOMER_ID"
127,Y,Y,"SELECT V.CUSTOMER_ID, SUM(T.TRANSACTION_ID IS NULL) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID GROUP BY CUSTOMER_ID HAVING SUM(T.TRANSACTION_ID IS NULL) > 0"
128,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(DISTINCT(V.VISIT_ID)) AS COUNT_NO_TRANS FROM VISITS AS V, TRANSACTIONS AS T WHERE V.VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
129,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE AMOUNT IS NULL GROUP BY V.CUSTOMER_ID"
130,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID"
131,Y,Y,"SELECT V.CUSTOMER_ID,COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN (SELECT DISTINCT T.VISIT_ID FROM TRANSACTIONS T) GROUP BY 1 ORDER BY 2"
132,Y,Y,"SELECT V1.CUSTOMER_ID, COUNT(V1.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V1 WHERE V1.VISIT_ID NOT IN ( SELECT V.VISIT_ID FROM TRANSACTIONS T LEFT JOIN VISITS V ON T.VISIT_ID = V.VISIT_ID) GROUP BY 1"
133,Y,Y,"SELECT VISITS.CUSTOMER_ID, COUNT(VISITS.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN ( SELECT VISIT_ID, AMOUNT FROM TRANSACTIONS GROUP BY VISIT_ID ) AS T ON VISITS.VISIT_ID = T.VISIT_ID WHERE T.AMOUNT IS NULL GROUP BY VISITS.CUSTOMER_ID"
134,Y,Y,"SELECT VISITS.CUSTOMER_ID AS CUSTOMER_ID, COUNT(VISITS.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON TRANSACTIONS.VISIT_ID = VISITS.VISIT_ID WHERE TRANSACTIONS.VISIT_ID IS NULL GROUP BY VISITS.CUSTOMER_ID"
135,Y,Y,"SELECT VISITS.CUSTOMER_ID,COUNT(VISITS.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTIONS.TRANSACTION_ID IS NULL GROUP BY VISITS.CUSTOMER_ID"
136,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) COUNT_NO_TRANS FROM VISITS A LEFT JOIN TRANSACTIONS T ON A.VISIT_ID = T.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY 1"
137,Y,Y,"SELECT CUSTOMER_ID, COUNT(DISTINCT VISIT_ID) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T USING(VISIT_ID) WHERE V.VISIT_ID NOT IN ( SELECT DISTINCT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
138,Y,Y,"SELECT CUSTOMER_ID,COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT V.VISIT_ID FROM VISITS AS V INNER JOIN TRANSACTIONS USING (VISIT_ID) ) GROUP BY CUSTOMER_ID"
139,Y,Y,"SELECT V.CUSTOMER_ID AS CUSTOMER_ID , COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID"
140,Y,Y,"WITH CTE1 AS ( SELECT VISITS.VISIT_ID, VISITS.CUSTOMER_ID, TRANSACTIONS.TRANSACTION_ID FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID HAVING TRANSACTION_ID IS NULL) SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM CTE1 GROUP BY CUSTOMER_ID"
141,Y,Y,"WITH NO_VISITS AS ( SELECT V.CUSTOMER_ID, V.VISIT_ID FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL ) SELECT NO_VISITS.CUSTOMER_ID, COUNT(DISTINCT NO_VISITS.VISIT_ID) COUNT_NO_TRANS FROM NO_VISITS GROUP BY NO_VISITS.CUSTOMER_ID"
142,Y,Y,"WITH TABLE1 AS (SELECT VISITS.VISIT_ID,CUSTOMER_ID, AMOUNT FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE AMOUNT IS NULL) SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM TABLE1 GROUP BY CUSTOMER_ID"
143,Y,Y,"WITH TEMP AS ( SELECT V.CUSTOMER_ID, V.VISIT_ID FROM VISITS V LEFT OUTER JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL ), FINALTABLE AS ( SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM TEMP GROUP BY CUSTOMER_ID ) SELECT * FROM FINALTABLE"
144,Y,Y,"WITH TEMP AS ( SELECT V.CUSTOMER_ID, V.VISIT_ID, T.VISIT_ID AS HASTRANSACTION FROM VISITS V LEFT OUTER JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID HAVING T.VISIT_ID IS NULL ), FINALTABLE AS ( SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM TEMP GROUP BY CUSTOMER_ID ) SELECT * FROM FINALTABLE"
145,Y,Y,"WITH VISITS AS ( SELECT V.CUSTOMER_ID, V.VISIT_ID, COUNT(TRANSACTION_ID) NUM_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID GROUP BY VISIT_ID ) SELECT CUSTOMER_ID, COUNT(NUM_TRANS) COUNT_NO_TRANS FROM VISITS WHERE NUM_TRANS = 0 GROUP BY CUSTOMER_ID"
146,Y,Y,"SELECT A.CUSTOMER_ID AS CUSTOMER_ID ,COUNT(A.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS A WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY A.CUSTOMER_ID"
147,Y,Y,"SELECT V.CUSTOMER_ID AS CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID=T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY 1"
148,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(*) COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.AMOUNT IS NULL GROUP BY V.CUSTOMER_ID"
149,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(T.TRANSACTION_ID IS NULL) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID"
150,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY V.CUSTOMER_ID"
151,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS AS V LEFT OUTER JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY V.CUSTOMER_ID"
152,Y,Y,"SELECT VISITS.CUSTOMER_ID, COUNT(VISITS.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN (SELECT T.VISIT_ID, V.CUSTOMER_ID FROM TRANSACTIONS T LEFT JOIN VISITS V ON V.VISIT_ID = T.VISIT_ID) A ON VISITS.VISIT_ID = A.VISIT_ID WHERE A.VISIT_ID IS NULL GROUP BY VISITS.CUSTOMER_ID"
153,Y,Y,"SELECT VISITS.CUSTOMER_ID, COUNT(VISITS.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTIONS.VISIT_ID IS NULL GROUP BY CUSTOMER_ID"
154,Y,Y,"SELECT VISITS.CUSTOMER_ID, SUM( CASE WHEN TRANSACTIONS.AMOUNT IS NULL THEN 1 ELSE 0 END ) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID GROUP BY VISITS.CUSTOMER_ID HAVING COUNT_NO_TRANS>0"
155,Y,Y,"SELECT A. CUSTOMER_ID CUSTOMER_ID , COUNT(CUSTOMER_ID) COUNT_NO_TRANS FROM VISITS A LEFT OUTER JOIN TRANSACTIONS B ON (A.VISIT_ID = B. VISIT_ID) WHERE B.VISIT_ID IS NULL GROUP BY 1 ORDER BY 1"
156,Y,Y,"SELECT A.CUSTOMER_ID , COUNT(*) COUNT_NO_TRANS FROM VISITS A LEFT JOIN TRANSACTIONS B USING(VISIT_ID) WHERE TRANSACTION_ID IS NULL GROUP BY A.CUSTOMER_ID"
157,Y,Y,"SELECT A.CUSTOMER_ID ,COUNT(*) AS COUNT_NO_TRANS FROM VISITS AS A LEFT JOIN TRANSACTIONS AS B ON A.VISIT_ID = B.VISIT_ID WHERE B.TRANSACTION_ID IS NULL GROUP BY A.CUSTOMER_ID"
158,Y,Y,"SELECT A.CUSTOMER_ID AS CUSTOMER_ID, COUNT(A.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS A LEFT JOIN TRANSACTIONS B ON A.VISIT_ID=B.VISIT_ID WHERE B.VISIT_ID IS NULL GROUP BY A.CUSTOMER_ID"
159,Y,Y,"SELECT A.CUSTOMER_ID AS CUSTOMER_ID, COUNT(A.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS A LEFT JOIN TRANSACTIONS B USING(VISIT_ID) WHERE B.VISIT_ID IS NULL GROUP BY A.CUSTOMER_ID"
160,Y,Y,"SELECT A.CUSTOMER_ID, COUNT(A.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS A WHERE A.VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS ) GROUP BY A.CUSTOMER_ID"
161,Y,Y,"SELECT A.CUSTOMER_ID, COUNT(A.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS A LEFT JOIN TRANSACTIONS B ON A.VISIT_ID = B.VISIT_ID WHERE B.VISIT_ID IS NULL GROUP BY 1"
162,Y,Y,"SELECT A.CUSTOMER_ID, COUNT(A.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS A LEFT OUTER JOIN TRANSACTIONS B ON A.VISIT_ID = B.VISIT_ID WHERE B.TRANSACTION_ID IS NULL GROUP BY A.CUSTOMER_ID"
163,Y,Y,"SELECT A.CUSTOMER_ID, COUNT(DISTINCT A.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS A LEFT OUTER JOIN TRANSACTIONS B ON A.VISIT_ID = B.VISIT_ID WHERE B.VISIT_ID IS NULL GROUP BY A.CUSTOMER_ID"
164,Y,Y,"SELECT A.CUSTOMER_ID, COUNT(IFNULL(A.AMOUNT,1)) COUNT_NO_TRANS FROM (SELECT A.CUSTOMER_ID, B.AMOUNT FROM VISITS A LEFT JOIN TRANSACTIONS B ON A.VISIT_ID=B.VISIT_ID WHERE B.AMOUNT IS NULL) A GROUP BY A.CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC"
165,Y,Y,"SELECT A.CUSTOMER_ID, SUM(CASE WHEN TRANSACTION_ID IS NULL THEN 1 ELSE 0 END) AS COUNT_NO_TRANS FROM VISITS AS A LEFT JOIN TRANSACTIONS AS B ON A.VISIT_ID = B.VISIT_ID GROUP BY 1 HAVING SUM(CASE WHEN TRANSACTION_ID IS NULL THEN 1 ELSE 0 END) <>0"
166,Y,Y,"SELECT AGG.CUSTOMER_ID , COUNT(*) AS COUNT_NO_TRANS FROM ( SELECT V.VISIT_ID, V.CUSTOMER_ID FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL ) AGG GROUP BY 1"
167,Y,Y,"SELECT B.CUSTOMER_ID, SUM(IFNULL(A.TRANSACTION_ID ,1)) AS COUNT_NO_TRANS FROM TRANSACTIONS A RIGHT JOIN VISITS B ON A.VISIT_ID = B.VISIT_ID WHERE A.TRANSACTION_ID IS NULL GROUP BY 1 ORDER BY 1 DESC"
168,Y,Y,"SELECT B.CUSTOMER_ID,COUNT(B.VISIT_ID) AS COUNT_NO_TRANS FROM ( SELECT CUSTOMER_ID , VISIT_ID FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) ) B GROUP BY 1"
169,Y,Y,"SELECT C.CUSTOMER_ID, COUNT(C.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS C WHERE C.VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
170,Y,Y,"SELECT CUSTOMER_ID , COUNT(*) COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS ) GROUP BY CUSTOMER_ID"
171,Y,Y,"SELECT CUSTOMER_ID , COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY 1"
172,Y,Y,"SELECT CUSTOMER_ID , COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE AMOUNT IS NULL GROUP BY CUSTOMER_ID"
173,Y,Y,"SELECT CUSTOMER_ID , SUM(IF(TRANSACTION_ID IS NULL, 1,0))COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON T.VISIT_ID = V.VISIT_ID GROUP BY CUSTOMER_ID HAVING COUNT_NO_TRANS > 0"
174,Y,Y,"SELECT CUSTOMER_ID ,COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN ( SELECT VISIT_ID FROM TRANSACTIONS ) GROUP BY CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC"
175,Y,Y,"SELECT CUSTOMER_ID, COUNT( V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY 1"
176,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM (SELECT CUSTOMER_ID FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS)) A GROUP BY 1"
177,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID WHERE AMOUNT IS NULL GROUP BY CUSTOMER_ID"
178,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS T1 LEFT JOIN (SELECT VISIT_ID, SUM(AMOUNT) AS AMOUNT FROM TRANSACTIONS T2 GROUP BY VISIT_ID) T2 ON T1.VISIT_ID = T2.VISIT_ID WHERE T2.VISIT_ID IS NULL GROUP BY CUSTOMER_ID"
179,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON T.VISIT_ID = V.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY CUSTOMER_ID"
180,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE AMOUNT IS NULL GROUP BY 1"
181,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY 1"
182,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS VIS WHERE VISIT_ID NOT IN ( SELECT VISIT_ID FROM TRANSACTIONS ) GROUP BY 1"
183,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT DISTINCT VISIT_ID FROM TRANSACTIONS) GROUP BY 1 ORDER BY 1"
184,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
185,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS LEFT OUTER JOIN TRANSACTIONS USING(VISIT_ID) WHERE AMOUNT IS NULL GROUP BY CUSTOMER_ID"
186,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY 1"
187,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM( SELECT CUSTOMER_ID, TRANSACTION_ID FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID ) A WHERE A.TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
188,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T USING (VISIT_ID) WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
189,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID=T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY 1"
190,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) COUNT_NO_TRANS FROM VISITS V WHERE VISIT_ID NOT IN (SELECT DISTINCT VISIT_ID FROM TRANSACTIONS) GROUP BY 1"
191,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS USING(VISIT_ID) WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
192,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID ORDER BY 2 DESC"
193,Y,Y,"SELECT CUSTOMER_ID, COUNT(1) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE AMOUNT IS NULL GROUP BY 1"
194,Y,Y,"SELECT CUSTOMER_ID, COUNT(1) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY CUSTOMER_ID"
195,Y,Y,"SELECT CUSTOMER_ID, COUNT(1) COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE V.VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY 1"
196,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISITS.VISIT_ID) AS COUNT_NO_TRANS FROM TRANSACTIONS RIGHT JOIN VISITS ON TRANSACTIONS.VISIT_ID = VISITS.VISIT_ID WHERE TRANSACTIONS.TRANSACTION_ID IS NULL GROUP BY VISITS.CUSTOMER_ID"
197,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM ( SELECT V.VISIT_ID,CUSTOMER_ID, T.AMOUNT FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE AMOUNT IS NULL) G GROUP BY CUSTOMER_ID"
198,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM ( SELECT VISITS.VISIT_ID, VISITS.CUSTOMER_ID, TRANSACTIONS.AMOUNT FROM VISITS LEFT OUTER JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID HAVING AMOUNT IS NULL ) T GROUP BY CUSTOMER_ID"
199,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM (SELECT TRANSACTIONS.VISIT_ID AS VISITSID, VISITS.CUSTOMER_ID AS CUSTOMER_ID, TRANSACTIONS.TRANSACTION_ID, TRANSACTIONS.AMOUNT AS AMOUNT FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE AMOUNT IS NULL) AS A GROUP BY CUSTOMER_ID"
200,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM (SELECT CUSTOMER_ID FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T USING(VISIT_ID) WHERE AMOUNT IS NULL) AS TEMP GROUP BY CUSTOMER_ID"
201,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTIONS.TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
202,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
203,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT DISTINCT VISIT_ID FROM TRANSACTIONS) GROUP BY 1 ORDER BY 2 DESC"
204,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC"
205,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID=T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY 1"
206,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN (SELECT DISTINCT(VISIT_ID) FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
207,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS ) GROUP BY CUSTOMER_ID"
208,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT DISTINCT VISIT_ID FROM TRANSACTIONS) GROUP BY 1"
209,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY 1"
210,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) COUNT_NO_TRANS FROM ( SELECT VISITS.VISIT_ID, CUSTOMER_ID, COUNT(TRANSACTION_ID) NUM FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID=TRANSACTIONS.VISIT_ID GROUP BY VISIT_ID) AS NUMS WHERE NUM=0 GROUP BY CUSTOMER_ID"
211,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS USING(VISIT_ID) WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
212,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
213,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTIONS.VISIT_ID IS NULL GROUP BY CUSTOMER_ID ORDER BY COUNT(CUSTOMER_ID) DESC"
214,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID=T.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
215,Y,Y,"SELECT CUSTOMER_ID, COUNT(DISTINCT V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY 1"
216,Y,Y,"SELECT CUSTOMER_ID, COUNT(DISTINCT VISIT_ID) COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T USING (VISIT_ID) WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
217,Y,Y,"SELECT CUSTOMER_ID, COUNT(T.TRANSACTION_ID IS NULL) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID=T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
218,Y,Y,"SELECT CUSTOMER_ID, COUNT(T.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS AS V JOIN (SELECT V.VISIT_ID FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID WHERE TRANSACTION_ID IS NULL) AS T ON V.VISIT_ID = T.VISIT_ID GROUP BY V.CUSTOMER_ID"
219,Y,Y,"SELECT CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID"
220,Y,Y,"SELECT CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY 1 ORDER BY 1"
221,Y,Y,"SELECT CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN (SELECT DISTINCT VISIT_ID FROM TRANSACTIONS)A ON V.VISIT_ID = A.VISIT_ID WHERE A.VISIT_ID IS NULL GROUP BY CUSTOMER_ID"
222,Y,Y,"SELECT CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.AMOUNT IS NULL GROUP BY V.CUSTOMER_ID"
223,Y,Y,"SELECT CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY V.CUSTOMER_ID"
224,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISIT_ID) COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT DISTINCT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
225,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
226,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS USING (VISIT_ID) WHERE TRANSACTION_ID IS NULL GROUP BY 1"
227,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V WHERE NOT EXISTS(SELECT * FROM TRANSACTIONS T WHERE T.VISIT_ID = V.VISIT_ID) GROUP BY CUSTOMER_ID"
228,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT DISTINCT VISIT_ID FROM TRANSACTIONS ) GROUP BY CUSTOMER_ID ORDER BY COUNT(VISIT_ID)"
229,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS GROUP BY VISIT_ID ) GROUP BY CUSTOMER_ID"
230,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID HAVING COUNT(VISIT_ID)>0"
231,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID ORDER BY COUNT(VISIT_ID) DESC"
232,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC, CUSTOMER_ID ASC"
233,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISIT_ID) COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T USING (VISIT_ID) WHERE T.VISIT_ID IS NULL GROUP BY CUSTOMER_ID"
234,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISITS.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY 1"
235,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISITS.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID=TRANSACTIONS.VISIT_ID WHERE TRANSACTIONS.TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
236,Y,Y,"SELECT CUSTOMER_ID, COUNT_NO_TRANS FROM ( SELECT CUSTOMER_ID, SUM(CASE WHEN T.VISIT_ID IS NULL THEN 1 ELSE 0 END) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID GROUP BY 1) T1 WHERE T1.COUNT_NO_TRANS<>0"
237,Y,Y,"SELECT CUSTOMER_ID, COUNT_NO_TRANS FROM ( SELECT V.CUSTOMER_ID AS CUSTOMER_ID , T.TRANSACTION_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID) A"
238,Y,Y,"SELECT CUSTOMER_ID, SUM(CASE WHEN T.TRANSACTION_ID IS NULL THEN 1 ELSE 0 END ) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID=T.VISIT_ID GROUP BY 1 HAVING COUNT_NO_TRANS>0"
239,Y,Y,"SELECT CUSTOMER_ID, SUM(CASE WHEN TRANSACTION_ID IS NULL THEN 1 ELSE 0 END) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T USING (VISIT_ID) GROUP BY CUSTOMER_ID HAVING SUM(CASE WHEN TRANSACTION_ID IS NULL THEN 1 ELSE 0 END) > 0"
240,Y,Y,"SELECT CUSTOMER_ID, SUM(CASE WHEN TRANSACTION_ID IS NULL THEN 1 ELSE 0 END)AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS USING (VISIT_ID) GROUP BY 1 HAVING SUM(CASE WHEN TRANSACTION_ID IS NULL THEN 1 ELSE 0 END)>0"
241,Y,Y,"SELECT CUSTOMER_ID,COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT DISTINCT VISIT_ID FROM TRANSACTIONS) GROUP BY 1 ORDER BY 2"
242,Y,Y,"SELECT CUSTOMER_ID,COUNT(*) AS COUNT_NO_TRANS FROM (SELECT CUSTOMER_ID,TRANSACTION_ID FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTION_ID IS NULL )A GROUP BY CUSTOMER_ID"
243,Y,Y,"SELECT CUSTOMER_ID,COUNT(*) COUNT_NO_TRANS FROM ( SELECT CUSTOMER_ID,V.VISIT_ID V,T.VISIT_ID T FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID=T.VISIT_ID WHERE T.VISIT_ID IS NULL) TT GROUP BY 1"
244,Y,Y,"SELECT CUSTOMER_ID,COUNT(*) COUNT_NO_TRANS FROM ( SELECT CUSTOMER_ID,V.VISIT_ID V,T.VISIT_ID T FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID=T.VISIT_ID) TT WHERE T IS NULL GROUP BY 1"
245,Y,Y,"SELECT CUSTOMER_ID,COUNT(A.VISIT_ID) AS COUNT_NO_TRANS FROM ( SELECT V.CUSTOMER_ID,V.VISIT_ID FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID=T.VISIT_ID WHERE T.VISIT_ID IS NULL ) A GROUP BY CUSTOMER_ID"
246,Y,Y,"SELECT CUSTOMER_ID,COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT DISTINCT VISIT_ID FROM TRANSACTIONS ) GROUP BY CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC"
247,Y,Y,"SELECT CUSTOMER_ID,COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T USING (VISIT_ID) WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
248,Y,Y,"SELECT CUSTOMER_ID,COUNT(CUSTOMER_ID) COUNT_NO_TRANS FROM VISITS V WHERE NOT EXISTS (SELECT 1 FROM TRANSACTIONS WHERE VISIT_ID=V.VISIT_ID) GROUP BY CUSTOMER_ID"
249,Y,Y,"SELECT CUSTOMER_ID,COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT DISTINCT VISIT_ID FROM TRANSACTIONS) GROUP BY 1 ORDER BY 2 DESC"
250,Y,Y,"SELECT CUSTOMER_ID,COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN ( SELECT VISIT_ID FROM TRANSACTIONS ) GROUP BY 1 ORDER BY 2 DESC,1"
251,Y,Y,"SELECT CUSTOMER_ID,COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID ORDER BY CUSTOMER_ID"
252,Y,Y,"SELECT CUSTOMER_ID,COUNT(VISIT_ID) COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
253,Y,Y,"SELECT CUSTOMER_ID,COUNT(VISIT_ID) COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT DISTINCT VISIT_ID FROM TRANSACTIONS) GROUP BY 1"
254,Y,Y,"SELECT CUSTOMER_ID,COUNT(VISITS.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTIONS.AMOUNT IS NULL GROUP BY CUSTOMER_ID"
255,Y,Y,"SELECT DISTINCT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS AS V WHERE V.VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
256,Y,Y,"SELECT DISTINCT CUSTOMER_ID, COUNT(*) OVER (PARTITION BY CUSTOMER_ID) COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS USING(VISIT_ID) WHERE TRANSACTION_ID IS NULL"
257,Y,Y,"SELECT DISTINCT CUSTOMER_ID, COUNT(V.VISIT_ID) OVER(PARTITION BY CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT OUTER JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY V.VISIT_ID"
258,Y,Y,"SELECT DISTINCT CUSTOMER_ID, COUNT(VISIT_ID)OVER(PARTITION BY CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN( SELECT DISTINCT VISIT_ID FROM TRANSACTIONS)"
259,Y,Y,"SELECT DISTINCT CUSTOMER_ID, SUM(CASE WHEN T.TRANSACTION_ID IS NULL THEN 1 ELSE 0 END) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON T.VISIT_ID = V.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY 1"
260,Y,Y,"SELECT DISTINCT(CUSTOMER_ID), COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN(SELECT DISTINCT(VISIT_ID) FROM TRANSACTIONS) GROUP BY CUSTOMER_ID ORDER BY COUNT(CUSTOMER_ID)"
261,Y,Y,"SELECT DISTINCT(CUSTOMER_ID), COUNT(VISIT_ID) OVER (PARTITION BY CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) ORDER BY 2 DESC"
262,Y,Y,"SELECT T1.CUSTOMER_ID, COUNT(T1.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS AS T1 LEFT JOIN TRANSACTIONS AS T2 ON T1.VISIT_ID = T2.VISIT_ID WHERE T2.TRANSACTION_ID IS NULL GROUP BY T1.CUSTOMER_ID"
263,Y,Y,"SELECT V.CUSTOMER_ID , COUNT(DISTINCT(V.VISIT_ID)) AS COUNT_NO_TRANS FROM VISITS V WHERE VISIT_ID NOT IN ( SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY V.CUSTOMER_ID"
264,Y,Y,"SELECT V.CUSTOMER_ID AS CUSTOMER_ID , COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID"
265,Y,Y,"SELECT V.CUSTOMER_ID AS CUSTOMER_ID , COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT OUTER JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY V.CUSTOMER_ID"
266,Y,Y,"SELECT V.CUSTOMER_ID AS CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY V.CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC"
267,Y,Y,"SELECT V.CUSTOMER_ID AS CUSTOMER_ID, COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID"
268,Y,Y,"SELECT V.CUSTOMER_ID AS CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY V.CUSTOMER_ID ORDER BY 2 DESC"
269,Y,Y,"SELECT V.CUSTOMER_ID AS CUSTOMER_ID,COUNT(DISTINCT V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID=T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY 1 ORDER BY 2 DESC"
270,Y,Y,"SELECT V.CUSTOMER_ID CUSTOMER_ID, COUNT(1) COUNT_NO_TRANS FROM VISITS V LEFT OUTER JOIN TRANSACTIONS TXN ON (V.VISIT_ID = TXN.VISIT_ID) WHERE TXN.VISIT_ID IS NULL GROUP BY V.CUSTOMER_ID"
271,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY V.CUSTOMER_ID"
272,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID=T.VISIT_ID WHERE T.AMOUNT IS NULL GROUP BY 1"
273,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID=T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY 1"
274,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID WHERE T.AMOUNT IS NULL GROUP BY V.CUSTOMER_ID"
275,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON T.VISIT_ID = V.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID"
276,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(*) COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON T.VISIT_ID = V.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID"
277,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(*) COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY V.CUSTOMER_ID"
278,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(1) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID=T.VISIT_ID WHERE T.AMOUNT IS NULL GROUP BY V.CUSTOMER_ID"
279,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(1) AS COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN ( SELECT DISTINCT VISIT_ID FROM TRANSACTIONS) GROUP BY V.CUSTOMER_ID"
280,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(1) COUNT_NO_TRANS FROM VISITS V WHERE NOT EXISTS ( SELECT 1 FROM TRANSACTIONS T WHERE V.VISIT_ID = T.VISIT_ID ) GROUP BY V.CUSTOMER_ID"
281,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(1) COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY 1"
282,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE AMOUNT IS NULL GROUP BY CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC"
283,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
284,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(DISTINCT V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID= T.VISIT_ID WHERE V.VISIT_ID NOT IN( SELECT VISIT_ID FROM TRANSACTIONS T ) GROUP BY CUSTOMER_ID"
285,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(DISTINCT V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY 1"
286,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN (SELECT T.VISIT_ID FROM TRANSACTIONS T) GROUP BY V.CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC"
287,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.AMOUNT IS NULL GROUP BY V.CUSTOMER_ID"
288,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE V.VISIT_ID = T.VISIT_ID IS NULL GROUP BY V.CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC"
289,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN ( SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY V.CUSTOMER_ID"
290,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE (V.VISIT_ID,T.TRANSACTION_ID) NOT IN (SELECT VISIT_ID, TRANSACTION_ID FROM TRANSACTIONS) GROUP BY V.CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC"
291,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE V.VISIT_ID NOT IN (SELECT T.VISIT_ID FROM TRANSACTIONS T) GROUP BY V.CUSTOMER_ID"
292,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN (SELECT DISTINCT T.VISIT_ID FROM TRANSACTIONS T) GROUP BY V.CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC"
293,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY CUSTOMER_ID"
294,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS TR USING(VISIT_ID) WHERE TR.TRANSACTION_ID IS NULL GROUP BY 1"
295,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON T.VISIT_ID = V.VISIT_ID WHERE V.VISIT_ID NOT IN ( SELECT VISIT_ID FROM TRANSACTIONS ) GROUP BY V.CUSTOMER_ID"
296,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY CUSTOMER_ID"
297,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID=T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY 1 ORDER BY 2 DESC, 1"
298,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN ( SELECT VISIT_ID FROM TRANSACTIONS ) GROUP BY V.CUSTOMER_ID"
299,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS AS V WHERE NOT EXISTS (SELECT TRANSACTION_ID FROM TRANSACTIONS AS T WHERE V.VISIT_ID = T.VISIT_ID) GROUP BY V.CUSTOMER_ID"
300,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY V.CUSTOMER_ID"
301,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
302,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY 1 ORDER BY COUNT( V.VISIT_ID) DESC"
303,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN (SELECT DISTINCT VISIT_ID FROM TRANSACTIONS) GROUP BY 1"
304,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON T.VISIT_ID = V.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID"
305,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY V.CUSTOMER_ID"
306,Y,Y,"SELECT V.CUSTOMER_ID, SUM(CASE WHEN T.TRANSACTION_ID IS NULL THEN 1 ELSE 0 END) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID GROUP BY CUSTOMER_ID HAVING COUNT_NO_TRANS >= 1"
307,Y,Y,"SELECT V.CUSTOMER_ID, SUM(IF(T.TRANSACTION_ID IS NULL, 1, 0)) COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T USING(VISIT_ID) WHERE T.TRANSACTION_ID IS NULL GROUP BY 1"
308,Y,Y,"SELECT V.CUSTOMER_ID,COUNT(*) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID"
309,Y,Y,"SELECT V.CUSTOMER_ID,COUNT(*) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY 1"
310,Y,Y,"SELECT V.CUSTOMER_ID,COUNT(*) COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY V.CUSTOMER_ID"
311,Y,Y,"SELECT V.CUSTOMER_ID,COUNT(1) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID"
312,Y,Y,"SELECT V.CUSTOMER_ID,COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V INNER JOIN ( SELECT VISIT_ID FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) ) AS T ON V.VISIT_ID =T.VISIT_ID GROUP BY V.CUSTOMER_ID"
313,Y,Y,"SELECT V.CUSTOMER_ID,COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.AMOUNT IS NULL GROUP BY 1"
314,Y,Y,"SELECT V.CUSTOMER_ID,COUNT(V.VISIT_ID) COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON (T.VISIT_ID=V.VISIT_ID) WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID"
315,Y,Y,"SELECT V.CUSTOMER_ID,COUNT(V.VISIT_ID) COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID=T.VISIT_ID WHERE V.VISIT_ID IS NOT NULL AND T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID ORDER BY COUNT(V.VISIT_ID) DESC"
316,Y,Y,"SELECT V1.CUSTOMER_ID, COUNT(V1.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V1 LEFT JOIN TRANSACTIONS T ON V1.VISIT_ID = T.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY V1.CUSTOMER_ID"
317,Y,Y,"SELECT VI.CUSTOMER_ID,COUNT(*) AS COUNT_NO_TRANS FROM VISITS VI LEFT JOIN TRANSACTIONS TRN ON VI.VISIT_ID = TRN.VISIT_ID WHERE TRN.TRANSACTION_ID IS NULL GROUP BY 1"
318,Y,Y,"SELECT VISITS.CUSTOMER_ID AS CUSTOMER_ID,COUNT(VISITS.VISIT_ID)AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
319,Y,Y,"SELECT VISITS.CUSTOMER_ID, COUNT(VISITS.VISIT_ID)AS COUNT_NO_TRANS FROM VISITS LEFT OUTER JOIN TRANSACTIONS ON VISITS.VISIT_ID= TRANSACTIONS.VISIT_ID WHERE TRANSACTIONS.TRANSACTION_ID IS NULL GROUP BY VISITS.CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC"
320,Y,Y,"WITH A AS (SELECT V.CUSTOMER_ID, V.VISIT_ID, T.TRANSACTION_ID, T.AMOUNT FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE TRANSACTION_ID IS NULL) SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM A GROUP BY CUSTOMER_ID"
321,Y,Y,"WITH CTE AS ( SELECT V.*,T.TRANSACTION_ID FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE TRANSACTION_ID IS NULL ) SELECT CUSTOMER_ID ,COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM CTE GROUP BY CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC"
322,Y,Y,"WITH CTE AS ( SELECT V.CUSTOMER_ID,T.TRANSACTION_ID FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID=T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL ) SELECT CUSTOMER_ID,COUNT(*) AS COUNT_NO_TRANS FROM CTE GROUP BY CUSTOMER_ID"
323,Y,Y,"WITH CTE AS( SELECT * FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) ) SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM CTE GROUP BY CUSTOMER_ID"
324,Y,Y,"WITH CTE_AGG_FILTER AS ( SELECT CUSTOMER_ID, COUNT(DISTINCT V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY 1 ) SELECT * FROM CTE_AGG_FILTER"
325,Y,N,"WITH NEW AS ( SELECT V.CUSTOMER_ID, IFNULL(T.VISIT_ID,0) AS COUNTING FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID ) SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM NEW WHERE COUNTING = 0 GROUP BY CUSTOMER_ID"
326,Y,Y,"WITH TA AS (SELECT V.*, T.VISIT_ID AS T_VISIT, T.TRANSACTION_ID FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL) SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM TA GROUP BY CUSTOMER_ID"
327,Y,Y,"WITH TRAN_PER_VISIT AS ( SELECT VISIT_ID, SUM(AMOUNT) AS TOTAL_AMOUNT FROM TRANSACTIONS GROUP BY VISIT_ID ), VISITS_TRANS AS ( SELECT A.*, B.TOTAL_AMOUNT FROM VISITS AS A LEFT JOIN TRAN_PER_VISIT AS B ON A.VISIT_ID = B.VISIT_ID ) SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS_TRANS WHERE TOTAL_AMOUNT IS NULL GROUP BY CUSTOMER_ID"
328,Y,Y,"WITH VISIT_TOTALS AS ( SELECT V.CUSTOMER_ID, V.VISIT_ID, COALESCE(SUM(T.AMOUNT),0) AS VISIT_TOTAL FROM VISITS V LEFT JOIN TRANSACTIONS T ON T.VISIT_ID = V.VISIT_ID GROUP BY V.VISIT_ID ) SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISIT_TOTALS WHERE VISIT_TOTAL = 0 GROUP BY CUSTOMER_ID"
329,Y,Y,"SELECT A.CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS A LEFT JOIN TRANSACTIONS B ON A.VISIT_ID = B.VISIT_ID WHERE B.TRANSACTION_ID IS NULL GROUP BY 1"
330,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY V.CUSTOMER_ID"
331,Y,Y,"SELECT CUSTOMER_ID , COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT DISTINCT(VISIT_ID) FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
332,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS T) GROUP BY CUSTOMER_ID"
333,Y,Y,"SELECT VISITS.CUSTOMER_ID, COUNT(TRANSACTIONS.VISIT_ID IS NULL) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTIONS.VISIT_ID IS NULL GROUP BY VISITS.CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC"
334,Y,Y,"SELECT CUSTOMER_ID, COUNT(1) COUNT_NO_TRANS FROM VISITS V LEFT OUTER JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
335,Y,Y,"SELECT CUSTOMER_ID,COUNT(VISITS.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON TRANSACTIONS.VISIT_ID=VISITS.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
336,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(1) COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.AMOUNT IS NULL GROUP BY V.CUSTOMER_ID"
337,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISITS.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISITS.VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
338,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY V.CUSTOMER_ID"
339,Y,Y,"WITH VISIT_T AS ( SELECT VISIT_ID, SUM(AMOUNT) AS TOTAL FROM TRANSACTIONS GROUP BY VISIT_ID ) ,VISIT_C AS ( SELECT V.VISIT_ID, V.CUSTOMER_ID, VT.TOTAL FROM VISITS V LEFT JOIN VISIT_T VT ON V.VISIT_ID = VT.VISIT_ID ) SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISIT_C VC WHERE VC.TOTAL IS NULL GROUP BY CUSTOMER_ID"
340,Y,Y,"SELECT V.CUSTOMER_ID , COUNT(V.VISIT_ID) COUNT_NO_TRANS FROM VISITS V WHERE NOT EXISTS (SELECT * FROM TRANSACTIONS T WHERE V.VISIT_ID = T.VISIT_ID ) GROUP BY CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC"
341,Y,Y,"SELECT VISITS.CUSTOMER_ID, COUNT(VISITS.VISIT_ID)AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY VISITS.CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC"
342,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS T ON T.VISIT_ID = V.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC"
343,Y,Y,"SELECT CUSTOMER_ID, COUNT(DISTINCT V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN (SELECT * FROM TRANSACTIONS) T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY 1"
344,Y,Y,"SELECT T1.CUSTOMER_ID, COUNT(T1.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS T1 LEFT JOIN TRANSACTIONS T2 ON T1.VISIT_ID = T2.VISIT_ID WHERE T2.TRANSACTION_ID IS NULL GROUP BY T1.CUSTOMER_ID"
345,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM (SELECT CUSTOMER_ID, IFNULL(AMOUNT, 0) AS AMOUNT FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID) T WHERE AMOUNT = 0 GROUP BY CUSTOMER_ID"
346,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON TRANSACTIONS.VISIT_ID = VISITS.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
347,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
348,Y,Y,"SELECT V.CUSTOMER_ID,COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN ( SELECT VISIT_ID FROM TRANSACTIONS ) GROUP BY CUSTOMER_ID"
349,Y,Y,"SELECT CUSTOMER_ID,COUNT(*) AS COUNT_NO_TRANS FROM VISITS A LEFT OUTER JOIN TRANSACTIONS B ON A.VISIT_ID = B.VISIT_ID WHERE B.VISIT_ID IS NULL GROUP BY CUSTOMER_ID"
350,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.AMOUNT IS NULL GROUP BY V.CUSTOMER_ID"
351,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC, CUSTOMER_ID ASC"
352,Y,Y,"SELECT CUSTOMER_ID, COUNT(V.VISIT_ID) COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
353,Y,Y,"SELECT DISTINCT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN (SELECT T.VISIT_ID FROM TRANSACTIONS T) GROUP BY V.CUSTOMER_ID"
354,Y,Y,"SELECT V.CUSTOMER_ID,COUNT(*) COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID=T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC"
355,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS AS V WHERE NOT EXISTS (SELECT * FROM TRANSACTIONS AS TS WHERE TS.VISIT_ID = V.VISIT_ID) GROUP BY V.CUSTOMER_ID"
356,Y,Y,"SELECT V2.CUSTOMER_ID, COUNT(V2.VISIT_ID) AS COUNT_NO_TRANS FROM (SELECT * FROM VISITS V1 WHERE V1.VISIT_ID NOT IN (SELECT T1.VISIT_ID FROM TRANSACTIONS T1)) AS V2 GROUP BY V2.CUSTOMER_ID"
357,Y,Y,"SELECT VISITS.CUSTOMER_ID, COUNT(VISITS.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE AMOUNT IS NULL GROUP BY VISITS.CUSTOMER_ID"
358,Y,Y,"SELECT T1.CUSTOMER_ID, COUNT(T1.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS T1 LEFT JOIN TRANSACTIONS T2 ON T1.VISIT_ID = T2.VISIT_ID WHERE T2.VISIT_ID IS NULL GROUP BY T1.CUSTOMER_ID"
359,Y,Y,"SELECT VISITS.CUSTOMER_ID, SUM(CASE WHEN TRANSACTIONS.TRANSACTION_ID IS NULL THEN 1 ELSE 0 END) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID GROUP BY VISITS.CUSTOMER_ID HAVING COUNT_NO_TRANS > 0"
360,Y,Y,"SELECT A.CUSTOMER_ID, COUNT(A.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS AS A LEFT JOIN TRANSACTIONS AS B ON A.VISIT_ID = B.VISIT_ID WHERE B.TRANSACTION_ID IS NULL GROUP BY A.CUSTOMER_ID"
361,Y,Y,"SELECT CUSTOMER_ID, COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON T.VISIT_ID = V.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID"
362,Y,Y,"SELECT A.CUSTOMER_ID, COUNT(1) - SUM(IF(B.VISIT_ID IS NOT NULL, 1, 0)) COUNT_NO_TRANS FROM VISITS A LEFT JOIN (SELECT VISIT_ID FROM TRANSACTIONS GROUP BY VISIT_ID) B ON A.VISIT_ID = B.VISIT_ID GROUP BY A.CUSTOMER_ID HAVING COUNT_NO_TRANS > 0"
363,Y,Y,"SELECT CUSTOMER_ID ,COUNT(V1.VISIT_ID) COUNT_NO_TRANS FROM VISITS V1 LEFT JOIN TRANSACTIONS ON V1.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTIONS.VISIT_ID IS NULL GROUP BY CUSTOMER_ID"
364,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISIT_ID) COUNT_NO_TRANS FROM (SELECT V.* FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID GROUP BY VISIT_ID HAVING COUNT(TRANSACTION_ID) = 0) A GROUP BY CUSTOMER_ID"
365,Y,Y,"SELECT DISTINCT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY V.CUSTOMER_ID"
366,Y,Y,"SELECT DISTINCT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
367,Y,Y,"SELECT VISITS.CUSTOMER_ID AS CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON TRANSACTIONS.VISIT_ID = VISITS.VISIT_ID WHERE TRANSACTIONS.TRANSACTION_ID IS NULL GROUP BY VISITS.CUSTOMER_ID"
368,Y,Y,"SELECT V.CUSTOMER_ID AS CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON T.VISIT_ID = V.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
369,Y,Y,"SELECT CUSTOMER_ID , COUNT(*) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T USING (VISIT_ID) WHERE AMOUNT IS NULL GROUP BY CUSTOMER_ID"
370,Y,Y,"SELECT VISITS.CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTIONS.VISIT_ID IS NULL GROUP BY VISITS.CUSTOMER_ID"
371,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTIONS.TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC"
372,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC"
373,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V1 LEFT JOIN TRANSACTIONS T1 ON V1.VISIT_ID=T1.VISIT_ID WHERE T1.TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
374,Y,Y,"SELECT V.CUSTOMER_ID AS CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY CUSTOMER_ID"
375,Y,Y,"SELECT VISITS.CUSTOMER_ID, COUNT(VISITS .VISIT_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID= TRANSACTIONS.VISIT_ID WHERE TRANSACTIONS.AMOUNT IS NULL GROUP BY CUSTOMER_ID"
376,Y,Y,"SELECT V.CUSTOMER_ID AS CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
377,Y,Y,"SELECT CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
378,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID"
379,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(DISTINCT V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS AS V WHERE V.VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY V.CUSTOMER_ID"
380,Y,Y,"SELECT V.CUSTOMER_ID, SUM(T.TRANSACTION_ID IS NULL) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID GROUP BY V.CUSTOMER_ID HAVING COUNT_NO_TRANS > 0"
381,Y,Y,"SELECT VISITS.CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS LEFT OUTER JOIN TRANSACTIONS ON TRANSACTIONS.VISIT_ID = VISITS.VISIT_ID WHERE TRANSACTIONS.VISIT_ID IS NULL GROUP BY VISITS.CUSTOMER_ID"
382,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN (SELECT A.* FROM (SELECT T1.VISIT_ID FROM TRANSACTIONS T1) A) GROUP BY V.CUSTOMER_ID"
383,Y,Y,"SELECT DISTINCT(CUSTOMER_ID), COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT DISTINCT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
384,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(DISTINCT(V.VISIT_ID)) AS COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY V.CUSTOMER_ID"
385,Y,Y,"WITH R AS(SELECT V.VISIT_ID,V.CUSTOMER_ID,T.TRANSACTION_ID AS TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID=T.VISIT_ID) SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM R WHERE TRANS IS NULL GROUP BY CUSTOMER_ID"
386,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(CUSTOMER_ID) COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID=T.VISIT_ID WHERE T.AMOUNT IS NULL GROUP BY CUSTOMER_ID"
387,Y,Y,"SELECT VISITS.CUSTOMER_ID, COUNT(VISITS.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISITS.VISIT_ID NOT IN ( SELECT VISIT_ID FROM TRANSACTIONS ) GROUP BY VISITS.CUSTOMER_ID"
388,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T USING (VISIT_ID) WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
389,Y,Y,"SELECT CUSTOMER_ID, COUNT(1) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT DISTINCT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
390,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(DISTINCT V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID"
391,Y,Y,"SELECT CUSTOMER_ID,COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID"
392,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT DISTINCT VISIT_ID FROM TRANSACTIONS) GROUP BY 1"
393,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.CUSTOMER_ID) COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY V.CUSTOMER_ID"
394,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(*) COUNT_NO_TRANS FROM VISITS V WHERE VISIT_ID NOT IN (SELECT DISTINCT VISIT_ID FROM TRANSACTIONS) GROUP BY V.CUSTOMER_ID"
395,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(1) COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN (SELECT T.VISIT_ID FROM TRANSACTIONS T) GROUP BY V.CUSTOMER_ID"
396,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN (SELECT VISIT_ID, COUNT(*) AS NUM_VISITS FROM TRANSACTIONS GROUP BY VISIT_ID) AS T ON VISITS.VISIT_ID = T.VISIT_ID WHERE T.NUM_VISITS IS NULL GROUP BY VISITS.CUSTOMER_ID"
397,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(1) AS COUNT_NO_TRANS FROM VISITS V WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY V.CUSTOMER_ID"
398,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC,CUSTOMER_ID ASC"
399,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTIONS.TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
400,Y,Y,"SELECT V.CUSTOMER_ID,COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID=T.VISIT_ID WHERE V.VISIT_ID NOT IN (SELECT T1.VISIT_ID FROM TRANSACTIONS T1) GROUP BY V.CUSTOMER_ID"
401,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON T.VISIT_ID = V.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
402,Y,Y,"SELECT T.CUSTOMER_ID, COUNT(T.VISIT_ID) AS COUNT_NO_TRANS FROM (SELECT * FROM VISITS LEFT JOIN TRANSACTIONS USING(VISIT_ID))AS T WHERE T.AMOUNT IS NULL GROUP BY T.CUSTOMER_ID"
403,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY 1"
404,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(DISTINCT V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V WHERE NOT EXISTS (SELECT 1 FROM TRANSACTIONS T WHERE T.VISIT_ID = V.VISIT_ID) GROUP BY V.CUSTOMER_ID"
405,Y,Y,"SELECT DISTINCT CUSTOMER_ID ,COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY 1"
406,Y,Y,"SELECT CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT OUTER JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID"
407,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID WHERE T.AMOUNT IS NULL GROUP BY V.CUSTOMER_ID"
408,Y,Y,"SELECT VIS.CUSTOMER_ID AS CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS AS VIS LEFT JOIN TRANSACTIONS AS TRX ON VIS.VISIT_ID = TRX.VISIT_ID WHERE TRX.VISIT_ID IS NULL GROUP BY VIS.CUSTOMER_ID"
409,Y,Y,"WITH FULL_TABLE AS ( SELECT VISITS.VISIT_ID, VISITS.CUSTOMER_ID, TRANSACTIONS.TRANSACTION_ID, TRANSACTIONS.AMOUNT FROM VISITS LEFT OUTER JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID UNION SELECT VISITS.VISIT_ID, VISITS.CUSTOMER_ID, TRANSACTIONS.TRANSACTION_ID, TRANSACTIONS.AMOUNT FROM VISITS RIGHT OUTER JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID ) SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM ( SELECT CUSTOMER_ID FROM FULL_TABLE WHERE AMOUNT IS NULL ) AS SUBQUERY GROUP BY CUSTOMER_ID ORDER BY COUNT(*) DESC, CUSTOMER_ID"
410,Y,Y,"SELECT CUSTOMER_ID , COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS ) GROUP BY CUSTOMER_ID ORDER BY 2 DESC"
411,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY CUSTOMER_ID"
412,Y,Y,"SELECT VISITS.CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTIONS.TRANSACTION_ID IS NULL GROUP BY VISITS.CUSTOMER_ID"
413,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE AMOUNT IS NULL GROUP BY CUSTOMER_ID"
414,Y,Y,"WITH T AS (SELECT CUSTOMER_ID, COUNT(TRANSACTION_ID) CNT FROM VISITS LEFT JOIN TRANSACTIONS USING(VISIT_ID) GROUP BY 1, VISIT_ID HAVING COUNT(TRANSACTION_ID)=0) SELECT CUSTOMER_ID, COUNT(CNT) COUNT_NO_TRANS FROM T GROUP BY 1"
415,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS AS V WHERE NOT EXISTS (SELECT T.VISIT_ID FROM TRANSACTIONS AS T WHERE T.VISIT_ID=V.VISIT_ID) GROUP BY V.CUSTOMER_ID"
416,Y,Y,"SELECT VISITS.CUSTOMER_ID, COUNT(VISITS.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTIONS.VISIT_ID IS NULL GROUP BY VISITS.CUSTOMER_ID"
417,Y,Y,"SELECT CUSTOMER_ID , COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON T.VISIT_ID = V.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY CUSTOMER_ID"
418,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(CUSTOMER_ID)COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.AMOUNT IS NULL GROUP BY V.CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC, CUSTOMER_ID"
419,Y,Y,"SELECT CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID=T.VISIT_ID WHERE AMOUNT IS NULL GROUP BY CUSTOMER_ID"
420,Y,Y,"SELECT CUSTOMER_ID, COUNT(AMOUNT IS NULL) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID=TRANSACTIONS.VISIT_ID WHERE TRANSACTIONS.VISIT_ID IS NULL GROUP BY CUSTOMER_ID"
421,Y,Y,"SELECT CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS T ON T.VISIT_ID = V.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
422,Y,Y,"SELECT CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V NATURAL LEFT JOIN TRANSACTIONS T WHERE T.VISIT_ID IS NULL GROUP BY CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC"
423,Y,Y,"SELECT CUSTOMER_ID , COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON T.VISIT_ID = V.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
424,Y,Y,"WITH CTE AS ( SELECT CUSTOMER_ID,AMOUNT FROM ( SELECT V.VISIT_ID,V.CUSTOMER_ID ,T.AMOUNT FROM VISITS V LEFT OUTER JOIN TRANSACTIONS T ON V.VISIT_ID=T.VISIT_ID) A WHERE A.AMOUNT IS NULL ) SELECT CUSTOMER_ID , COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM CTE GROUP BY CUSTOMER_ID"
425,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS WHERE NOT EXISTS (SELECT TRANSACTION_ID FROM TRANSACTIONS WHERE VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID) GROUP BY CUSTOMER_ID"
426,Y,Y,"WITH TEMP AS (SELECT VISITS.VISIT_ID, TRANSACTIONS.TRANSACTION_ID FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID), NULLEDTEMP AS (SELECT * FROM TEMP WHERE TEMP.TRANSACTION_ID IS NULL) SELECT CUSTOMER_ID,COUNT(*) AS COUNT_NO_TRANS FROM VISITS INNER JOIN NULLEDTEMP ON NULLEDTEMP.VISIT_ID=VISITS.VISIT_ID GROUP BY CUSTOMER_ID ORDER BY COUNT(*) DESC"
427,Y,Y,"SELECT VISITS.CUSTOMER_ID AS CUSTOMER_ID, SUM(IFNULL(TRANSACTIONS.TRANSACTION_ID, 1)) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON TRANSACTIONS.VISIT_ID = VISITS.VISIT_ID WHERE TRANSACTIONS.TRANSACTION_ID IS NULL GROUP BY VISITS.CUSTOMER_ID"
428,Y,Y,"WITH CTE AS ( SELECT VISIT_ID, COUNT(TRANSACTION_ID) AS COUNT_TRANS , SUM(AMOUNT) AS TOTAL FROM TRANSACTIONS GROUP BY VISIT_ID ) SELECT CUSTOMER_ID, COUNT(IFNULL(CTE.COUNT_TRANS,0)) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN CTE USING(VISIT_ID) WHERE IFNULL(TOTAL, 0) = 0 GROUP BY CUSTOMER_ID ORDER BY 2"
429,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT DISTINCT(VISIT_ID) FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
430,Y,Y,"SELECT A.CUSTOMER_ID, (COUNT(A.VISIT_ID) - COUNT(B.VISIT_ID)) AS COUNT_NO_TRANS FROM VISITS AS A LEFT JOIN TRANSACTIONS AS B ON A.VISIT_ID = B.VISIT_ID GROUP BY A.CUSTOMER_ID HAVING (COUNT(A.VISIT_ID) - COUNT(B.VISIT_ID)) > 0"
431,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS AS V WHERE V.VISIT_ID NOT IN ( SELECT VISIT_ID FROM TRANSACTIONS ) GROUP BY V.CUSTOMER_ID"
432,Y,Y,"SELECT DISTINCT(CUSTOMER_ID) AS CUSTOMER_ID, COUNT(VISITS.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID =TRANSACTIONS.VISIT_ID WHERE TRANSACTIONS.AMOUNT IS NULL GROUP BY VISITS.CUSTOMER_ID"
433,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISITS.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE (TRANSACTION_ID IS NULL) GROUP BY CUSTOMER_ID"
434,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(DISTINCT V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY V.CUSTOMER_ID"
435,Y,Y,"SELECT TB1.CUSTOMER_ID,COUNT(TB1.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS AS TB1 LEFT JOIN (SELECT TB3.VISIT_ID, SUM(TB3.AMOUNT) AS AMOUNT FROM TRANSACTIONS AS TB3 GROUP BY TB3.VISIT_ID) AS TB2 ON TB1.VISIT_ID = TB2.VISIT_ID WHERE TB2.AMOUNT IS NULL GROUP BY TB1.CUSTOMER_ID"
436,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(1) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY V.CUSTOMER_ID"
437,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN (SELECT DISTINCT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
438,Y,Y,"SELECT CUSTOMER_ID, COUNT(DISTINCT VISIT_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS USING (VISIT_ID) WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
439,Y,Y,"SELECT CUSTOMER_ID , COUNT(DISTINCT VISIT_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT DISTINCT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
440,Y,Y,"WITH T AS (SELECT DISTINCT VISIT_ID FROM TRANSACTIONS), T1 AS (SELECT *, CASE WHEN VISIT_ID IN (SELECT VISIT_ID FROM T) THEN 0 ELSE 1 END AS IF_NO_TRANS FROM VISITS) SELECT CUSTOMER_ID,SUM(IF_NO_TRANS) AS COUNT_NO_TRANS FROM T1 GROUP BY 1 HAVING SUM(IF_NO_TRANS)>0"
441,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON T.VISIT_ID = V.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
442,Y,Y,"SELECT DISTINCT CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.AMOUNT IS NULL GROUP BY V.CUSTOMER_ID"
443,Y,Y,"SELECT CUSTOMER_ID, COUNT( VISITS.VISIT_ID ) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTIONS.VISIT_ID IS NULL GROUP BY CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC"
444,Y,Y,"SELECT V.CUSTOMER_ID, SUM(CASE WHEN T.TRANSACTION_ID IS NULL THEN 1 ELSE 0 END) AS COUNT_NO_TRANS FROM VISITS V LEFT OUTER JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID"
445,Y,Y,"SELECT CUSTOMER_ID , COUNT(1) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
446,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON T.VISIT_ID = V.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID"
447,Y,Y,"WITH TEMP_CDE AS (SELECT DISTINCT CUSTOMER_ID,VISIT_ID FROM VISITS WHERE VISIT_ID NOT IN (SELECT DISTINCT VISIT_ID FROM TRANSACTIONS)) SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM TEMP_CDE GROUP BY CUSTOMER_ID"
448,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISITS.VISIT_ID NOT IN ( SELECT DISTINCT VISIT_ID FROM TRANSACTIONS ) GROUP BY CUSTOMER_ID"
449,Y,Y,"SELECT CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY 1 ORDER BY 1"
450,Y,Y,"SELECT V.CUSTOMER_ID,COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID=T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID ORDER BY COUNT(VISIT_ID) DESC"
451,Y,Y,"SELECT CUSTOMER_ID,COUNT(*) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID=T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY CUSTOMER_ID ORDER BY CUSTOMER_ID"
452,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID"
453,Y,Y,"SELECT DISTINCT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
454,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.AMOUNT IS NULL GROUP BY CUSTOMER_ID"
455,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID ) AS COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN ( SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY 1"
456,Y,Y,"SELECT CUSTOMER_ID, (COUNT(VISITS.VISIT_ID)) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTIONS.VISIT_ID IS NULL GROUP BY 1"
457,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) COUNT_NO_TRANS FROM (SELECT V.VISIT_ID,CUSTOMER_ID, TRANSACTION_ID FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID=T.VISIT_ID) S WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
458,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS WHERE NOT EXISTS( SELECT VISIT_ID FROM TRANSACTIONS WHERE VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID ) GROUP BY CUSTOMER_ID"
459,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC"
460,Y,Y,"SELECT DISTINCT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID ORDER BY NULL"
461,Y,Y,"SELECT P.CID AS CUSTOMER_ID , COUNT(*) AS COUNT_NO_TRANS FROM ( SELECT V.CUSTOMER_ID AS CID ,T.TRANSACTION_ID AS TID FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID ) P WHERE P.TID IS NULL GROUP BY 1"
462,Y,Y,"SELECT T.CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM (SELECT T1.VISIT_ID , T1.CUSTOMER_ID , T2.TRANSACTION_ID FROM VISITS AS T1 LEFT JOIN TRANSACTIONS AS T2 ON T1.VISIT_ID = T2.VISIT_ID ) AS T WHERE T.TRANSACTION_ID IS NULL GROUP BY T.CUSTOMER_ID"
463,Y,Y,"SELECT CUSTOMER_ID, COUNT(DISTINCT(VISIT_ID)) AS COUNT_NO_TRANS FROM VISITS WHERE VISITS.VISIT_ID NOT IN(SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
464,Y,Y,"SELECT CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID=T.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
465,Y,Y,"SELECT CUSTOMER_ID,COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY 1 ORDER BY 2 DESC"
466,Y,Y,"SELECT A.CUSTOMER_ID, COUNT(1) - SUM(IF(B.VISIT_ID IS NOT NULL, 1, 0)) COUNT_NO_TRANS FROM VISITS A LEFT JOIN (SELECT VISIT_ID FROM TRANSACTIONS GROUP BY VISIT_ID) B ON A.VISIT_ID = B.VISIT_ID GROUP BY A.CUSTOMER_ID HAVING COUNT(1) - SUM(IF(B.VISIT_ID IS NOT NULL, 1, 0)) > 0"
467,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID=T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
468,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS NATURAL LEFT JOIN TRANSACTIONS WHERE TRANSACTIONS.VISIT_ID IS NULL GROUP BY VISITS.CUSTOMER_ID"
469,Y,Y,"SELECT CUSTOMER_ID, SUM(CASE WHEN TRANSACTION_ID IS NULL THEN 1 END) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
470,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISITS.VISIT_ID)-COUNT(TRANSACTIONS.TRANSACTION_ID) AS COUNT_NO_TRANS FROM VISITS LEFT OUTER JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID GROUP BY VISITS.CUSTOMER_ID HAVING COUNT(VISITS.VISIT_ID)-COUNT(TRANSACTIONS.TRANSACTION_ID) <> 0"
471,Y,Y,"SELECT DISTINCT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISITS.VISIT_ID FROM VISITS INNER JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID) GROUP BY CUSTOMER_ID ORDER BY COUNT(CUSTOMER_ID) DESC"
472,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON T.VISIT_ID = V.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY V.CUSTOMER_ID ORDER BY COUNT_NO_TRANS"
473,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS ) GROUP BY 1"
474,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS AS V WHERE V.VISIT_ID NOT IN(SELECT T.VISIT_ID FROM TRANSACTIONS AS T) GROUP BY V.CUSTOMER_ID"
475,Y,Y,"WITH NULL_VISIT AS( SELECT CUSTOMER_ID, TRANSACTION_ID FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE TRANSACTION_ID IS NULL) SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM NULL_VISIT GROUP BY 1"
476,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN(SELECT DISTINCT(VISIT_ID) FROM TRANSACTIONS GROUP BY VISIT_ID) GROUP BY CUSTOMER_ID"
477,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT V.VISIT_ID FROM VISITS V JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID) GROUP BY CUSTOMER_ID"
478,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT V.VISIT_ID FROM TRANSACTIONS AS T LEFT JOIN VISITS AS V ON T.VISIT_ID = V.VISIT_ID ) GROUP BY CUSTOMER_ID"
479,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID"
480,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM (SELECT V.CUSTOMER_ID, V.VISIT_ID FROM VISITS V LEFT JOIN TRANSACTIONS T ON (V.VISIT_ID = T.VISIT_ID) WHERE T.TRANSACTION_ID IS NULL) A GROUP BY CUSTOMER_ID"
481,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE V.VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
482,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTIONS.AMOUNT IS NULL GROUP BY CUSTOMER_ID"
483,Y,Y,"SELECT VISITS.CUSTOMER_ID AS CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISITS.VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY VISITS.CUSTOMER_ID"
484,Y,Y,"SELECT A.CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM ( SELECT CUSTOMER_ID FROM VISITS V LEFT JOIN TRANSACTIONS T USING (VISIT_ID) WHERE T.TRANSACTION_ID IS NULL ) A GROUP BY A.CUSTOMER_ID"
485,Y,Y,"SELECT VISITS.CUSTOMER_ID, COUNT(VISITS.VISIT_ID ) AS COUNT_NO_TRANS FROM VISITS AS VISITS WHERE VISITS.VISIT_ID NOT IN ( SELECT TRANSACTIONS.VISIT_ID FROM TRANSACTIONS AS TRANSACTIONS) GROUP BY VISITS.CUSTOMER_ID"
486,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID=T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY V.CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC"
487,Y,Y,"SELECT CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID"
488,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) - COUNT(TRANSACTION_ID) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID GROUP BY CUSTOMER_ID HAVING COUNT(TRANSACTION_ID) < COUNT(CUSTOMER_ID)"
489,Y,Y,"SELECT CUSTOMER_ID ,COUNT(*) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT DISTINCT TRANSACTIONS.VISIT_ID FROM TRANSACTIONS LEFT JOIN VISITS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID ) GROUP BY CUSTOMER_ID"
490,Y,Y,"SELECT A.CUSTOMER_ID , COUNT(1) AS COUNT_NO_TRANS FROM VISITS A WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY A.CUSTOMER_ID"
491,Y,Y,"SELECT CUSTOMER_ID, COUNT(V.VISIT_ID) COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
492,Y,Y,"SELECT V.CUSTOMER_ID , COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN ( SELECT T.VISIT_ID FROM TRANSACTIONS T ) GROUP BY V.CUSTOMER_ID"
493,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT TRANSACTIONS.VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
494,Y,Y,"SELECT A.CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM (SELECT VISIT_ID, CUSTOMER_ID FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS)) AS A GROUP BY A.CUSTOMER_ID"
495,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS AS V WHERE V.VISIT_ID NOT IN ( SELECT DISTINCT T.VISIT_ID FROM TRANSACTIONS AS T ) GROUP BY CUSTOMER_ID"
496,Y,Y,"SELECT DISTINCT V.CUSTOMER_ID,COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY V.CUSTOMER_ID ORDER BY COUNT_NO_TRANS"
497,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM ( SELECT * FROM VISITS V WHERE VISIT_ID NOT IN ( SELECT VISIT_ID FROM TRANSACTIONS T ) ) A GROUP BY CUSTOMER_ID"
498,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE V.VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
499,Y,Y,"WITH TMP AS (SELECT CUSTOMER_ID, SUM(IF(TRANSACTION_ID IS NULL, 1, 0)) COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID GROUP BY CUSTOMER_ID) SELECT * FROM TMP WHERE COUNT_NO_TRANS != 0"
500,Y,Y,"SELECT VISITS.CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON TRANSACTIONS.VISIT_ID = VISITS.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY VISITS.CUSTOMER_ID"
501,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY V.CUSTOMER_ID"
502,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON T.VISIT_ID = V.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID"
503,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) COUNT_NO_TRANS FROM VISITS A LEFT JOIN TRANSACTIONS B ON A.VISIT_ID = B.VISIT_ID WHERE B.TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
504,Y,Y,"SELECT DISTINCT(CUSTOMER_ID),COUNT(VISITS.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTIONS.VISIT_ID IS NULL GROUP BY CUSTOMER_ID"
505,Y,Y,"SELECT DISTINCT CUSTOMER_ID, COUNT(*) OVER (PARTITION BY CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT DISTINCT VISIT_ID FROM TRANSACTIONS) ORDER BY COUNT_NO_TRANS"
506,Y,Y,"SELECT A.CUSTOMER_ID, SUM(1) COUNT_NO_TRANS FROM VISITS A LEFT JOIN TRANSACTIONS B ON A.VISIT_ID=B.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
507,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY(V.CUSTOMER_ID)"
508,Y,Y,"SELECT DISTINCT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE AMOUNT IS NULL GROUP BY CUSTOMER_ID ORDER BY CUSTOMER_ID"
509,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS WHERE NOT EXISTS (SELECT * FROM TRANSACTIONS WHERE VISITS.VISIT_ID=TRANSACTIONS.VISIT_ID) GROUP BY CUSTOMER_ID"
510,Y,Y,"WITH T1 AS ( SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID)-SUM(CASE WHEN T.TRANSACTION_ID IS NOT NULL THEN 1 ELSE 0 END) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID GROUP BY V.CUSTOMER_ID) SELECT * FROM T1 WHERE COUNT_NO_TRANS != 0"
511,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(DISTINCT (V.VISIT_ID)) AS COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY 1"
512,Y,Y,"SELECT DISTINCT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT DISTINCT VISIT_ID FROM TRANSACTIONS) GROUP BY 1"
513,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN (SELECT TT.VISIT_ID FROM TRANSACTIONS TT) GROUP BY V.CUSTOMER_ID"
514,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC"
515,Y,Y,"SELECT V.CUSTOMER_ID,COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
516,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM (SELECT CUSTOMER_ID, TRANSACTION_ID FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID) AS NEWTABLE WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
517,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
518,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS A LEFT JOIN TRANSACTIONS B ON A.VISIT_ID = B.VISIT_ID WHERE B.TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
519,Y,Y,"SELECT DISTINCT(CUSTOMER_ID),COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
520,Y,Y,"SELECT V.CUSTOMER_ID,COUNT(V.VISIT_ID) COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC"
521,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE AMOUNT IS NULL GROUP BY CUSTOMER_ID"
522,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM( SELECT CUSTOMER_ID, AMOUNT FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID WHERE AMOUNT IS NULL) AS T1 GROUP BY CUSTOMER_ID ORDER BY COUNT_NO_TRANS"
523,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS WHERE VISITS.VISIT_ID NOT IN (SELECT TRANSACTIONS.VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
524,Y,Y,"SELECT CUSTOMER_ID,COUNT(*) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS USING (VISIT_ID) WHERE AMOUNT IS NULL GROUP BY CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC"
525,Y,Y,"SELECT DISTINCT(CUSTOMER_ID), COUNT(VISIT_ID) OVER (PARTITION BY CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT DISTINCT(VISIT_ID) FROM TRANSACTIONS)"
526,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(DISTINCT V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID=T.VISIT_ID WHERE T.AMOUNT IS NULL GROUP BY V.CUSTOMER_ID"
527,Y,Y,"SELECT T.CUSTOMER_ID AS CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM (SELECT CUSTOMER_ID, TRANSACTION_ID FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID=TRANSACTIONS.VISIT_ID) AS T WHERE T.TRANSACTION_ID IS NULL GROUP BY T.CUSTOMER_ID"
528,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
529,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY CUSTOMER_ID"
530,Y,Y,"SELECT DISTINCT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
531,Y,Y,"SELECT VISITS.CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS USING(VISIT_ID) WHERE AMOUNT IS NULL GROUP BY VISITS.CUSTOMER_ID"
532,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.CUSTOMER_ID) COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID ORDER BY V.CUSTOMER_ID"
533,Y,Y,"SELECT CUSTOMER_ID , (COUNT(*)) AS COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID ORDER BY CUSTOMER_ID"
534,Y,Y,"SELECT CUSTOMER_ID,COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISITS.VISIT_ID FROM VISITS INNER JOIN TRANSACTIONS ON VISITS.VISIT_ID=TRANSACTIONS.VISIT_ID ) GROUP BY (CUSTOMER_ID)"
535,Y,Y,"SELECT CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V NATURAL LEFT JOIN TRANSACTIONS T WHERE T.VISIT_ID IS NULL GROUP BY CUSTOMER_ID"
536,Y,Y,"SELECT A.CUSTOMER_ID, COUNT(A.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS A WHERE A.VISIT_ID NOT IN (SELECT B.VISIT_ID FROM TRANSACTIONS B) GROUP BY A.CUSTOMER_ID"
537,Y,Y,"SELECT CUSTOMER_ID, COUNT(DISTINCT V.VISIT_ID ) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON T.VISIT_ID=V.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
538,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM (SELECT V.CUSTOMER_ID FROM VISITS V WHERE V.VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS)) T GROUP BY CUSTOMER_ID"
539,Y,Y,"SELECT COUNT(VISITS.VISIT_ID) AS COUNT_NO_TRANS, CUSTOMER_ID FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTIONS.VISIT_ID IS NULL GROUP BY CUSTOMER_ID"
540,Y,Y,"SELECT CUSTOMER_ID, COUNT(IF(AMOUNT = NULL, 1, 0)) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE AMOUNT IS NULL GROUP BY CUSTOMER_ID"
541,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(DISTINCT V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY V.CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC, CUSTOMER_ID"
542,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V WHERE NOT EXISTS (SELECT * FROM TRANSACTIONS T WHERE V.VISIT_ID = T.VISIT_ID) GROUP BY V.CUSTOMER_ID"
543,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM (SELECT VISITS.VISIT_ID, VISITS.CUSTOMER_ID FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTIONS.VISIT_ID IS NULL) AS TEMP GROUP BY CUSTOMER_ID"
544,Y,Y,"SELECT CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE V.VISIT_ID NOT IN (SELECT T.VISIT_ID FROM TRANSACTIONS T) GROUP BY CUSTOMER_ID"
545,Y,Y,"SELECT VISITS.CUSTOMER_ID, COUNT(VISITS.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE VISITS.VISIT_ID NOT IN (SELECT TRANSACTIONS.VISIT_ID FROM TRANSACTIONS) GROUP BY VISITS.CUSTOMER_ID"
546,Y,Y,"SELECT VI.CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS VI LEFT JOIN TRANSACTIONS T ON VI.VISIT_ID = T.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY VI.CUSTOMER_ID ORDER BY COUNT_NO_TRANS"
547,Y,Y,"SELECT DISTINCT V.CUSTOMER_ID ,COUNT(V.VISIT_ID) - COUNT(T.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V NATURAL LEFT JOIN TRANSACTIONS T GROUP BY V.CUSTOMER_ID HAVING COUNT_NO_TRANS > 0"
548,Y,Y,"SELECT CUSTOMER_ID , COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY CUSTOMER_ID"
549,Y,Y,"SELECT A.CUSTOMER_ID, COUNT(A.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS AS A LEFT JOIN TRANSACTIONS AS B USING(VISIT_ID) WHERE B.AMOUNT IS NULL GROUP BY A.CUSTOMER_ID"
550,Y,Y,"SELECT CUSTOMER_ID, COUNT(A.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS AS A LEFT JOIN TRANSACTIONS AS B ON A.VISIT_ID = B.VISIT_ID WHERE B.VISIT_ID IS NULL GROUP BY CUSTOMER_ID"
551,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM ( SELECT VISITS.CUSTOMER_ID AS CUSTOMER_ID FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTIONS.TRANSACTION_ID IS NULL ) AS T GROUP BY CUSTOMER_ID"
552,Y,Y,"SELECT A.CUSTOMER_ID, COUNT(A.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS AS A LEFT JOIN TRANSACTIONS AS B ON A.VISIT_ID = B.VISIT_ID WHERE B.TRANSACTION_ID IS NULL GROUP BY A.CUSTOMER_ID"
553,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN(SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
554,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM(SELECT VISITS.CUSTOMER_ID FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTION_ID IS NULL) AS TEMP GROUP BY CUSTOMER_ID"
555,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
556,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT V.VISIT_ID FROM VISITS V JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID) GROUP BY CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC"
557,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISITS.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS WHERE VISIT_ID IS NOT NULL) GROUP BY CUSTOMER_ID"
558,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISIT_ID) COUNT_NO_TRANS FROM ( SELECT V.VISIT_ID, V.CUSTOMER_ID FROM VISITS V LEFT JOIN TRANSACTIONS T ON T.VISIT_ID = V.VISIT_ID WHERE TRANSACTION_ID IS NULL ) VISITS_WITHOUT_TRANSACTIONS GROUP BY CUSTOMER_ID"
559,Y,Y,"SELECT DISTINCT CUSTOMER_ID, COUNT(VISITS.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTIONS.VISIT_ID IS NULL GROUP BY CUSTOMER_ID"
560,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS AS V LEFT OUTER JOIN TRANSACTIONS AS T ON T.VISIT_ID = V.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID ORDER BY V.CUSTOMER_ID"
561,Y,Y,"SELECT DISTINCT CUSTOMER_ID,COUNT(*) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T USING (VISIT_ID) WHERE T.VISIT_ID IS NULL GROUP BY 1"
562,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY V.CUSTOMER_ID"
563,Y,Y,"WITH T0 AS ( SELECT DISTINCT VISIT_ID,'T' AS TRANS FROM TRANSACTIONS ), T1 AS ( SELECT V.VISIT_ID,CUSTOMER_ID, TRANS FROM VISITS V LEFT JOIN T0 ON V.VISIT_ID = T0.VISIT_ID ) SELECT CUSTOMER_ID, COUNT(1) AS COUNT_NO_TRANS FROM T1 WHERE TRANS IS NULL GROUP BY CUSTOMER_ID"
564,Y,Y,"SELECT A.CUSTOMER_ID , COUNT(1) AS COUNT_NO_TRANS FROM VISITS A LEFT JOIN TRANSACTIONS B ON A.VISIT_ID = B.VISIT_ID WHERE B.TRANSACTION_ID IS NULL GROUP BY A.CUSTOMER_ID"
565,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS AS V WHERE V.VISIT_ID NOT IN (SELECT V.VISIT_ID FROM VISITS AS V JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID) GROUP BY V.CUSTOMER_ID"
566,Y,Y,"SELECT A.CUSTOMER_ID, COUNT(0) AS COUNT_NO_TRANS FROM ( SELECT * FROM VISITS WHERE VISIT_ID NOT IN ( SELECT DISTINCT VISIT_ID FROM TRANSACTIONS ) ) A GROUP BY CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC"
567,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTIONS.TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
568,Y,Y,"SELECT CUSTOMER_ID,COUNT(*) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN(SELECT DISTINCT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID ORDER BY COUNT(*) DESC"
569,Y,Y,"SELECT V.CUSTOMER_ID ,COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID"
570,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.AMOUNT IS NULL GROUP BY V.CUSTOMER_ID"
571,Y,Y,"SELECT CUSTOMER_ID , COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS USING (VISIT_ID) WHERE TRANSACTIONS.VISIT_ID IS NULL GROUP BY 1"
572,Y,Y,"SELECT VISITS.CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN (SELECT DISTINCT TRANSACTIONS.VISIT_ID AS A FROM TRANSACTIONS) AS TMP ON VISITS.VISIT_ID = TMP.A WHERE TMP.A IS NULL GROUP BY VISITS.CUSTOMER_ID"
573,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM ( SELECT VISIT_ID,CUSTOMER_ID FROM VISITS WHERE VISIT_ID NOT IN (SELECT DISTINCT VISIT_ID FROM TRANSACTIONS) ) AS TMP GROUP BY CUSTOMER_ID"
574,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(1) COUNT_NO_TRANS FROM VISITS V LEFT OUTER JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID"
575,Y,Y,"WITH A AS( SELECT V.VISIT_ID, V.CUSTOMER_ID, T.TRANSACTION_ID FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID ) SELECT A.CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM A WHERE A.TRANSACTION_ID IS NULL GROUP BY A.CUSTOMER_ID"
576,Y,Y,"SELECT CUSTOMER_ID, COUNT(V.VISIT_ID) COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY 1"
577,Y,Y,"WITH CTE AS (SELECT V.CUSTOMER_ID, T.VISIT_ID, T.TRANSACTION_ID FROM TRANSACTIONS T RIGHT JOIN VISITS V ON V.VISIT_ID = T.VISIT_ID) SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM CTE WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
578,Y,Y,"SELECT CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN ( SELECT VISIT_ID FROM TRANSACTIONS ) GROUP BY CUSTOMER_ID"
579,Y,Y,"SELECT VISITS.CUSTOMER_ID, COUNT(DISTINCT VISITS.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISITS.VISIT_ID NOT IN(SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
580,Y,Y,"SELECT CUSTOMER_ID, COUNT(DISTINCT VISIT_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT DISTINCT VISIT_ID FROM TRANSACTIONS) GROUP BY 1 ORDER BY 2 DESC"
581,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISITS.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID ORDER BY VISITS.VISIT_ID ASC"
582,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON T.VISIT_ID=V.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY V.CUSTOMER_ID"
583,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT OUTER JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID"
584,Y,Y,"SELECT A.CUSTOMER_ID , COUNT(*) AS COUNT_NO_TRANS FROM VISITS A WHERE A.VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY A.CUSTOMER_ID"
585,Y,Y,"SELECT DISTINCT(CUSTOMER_ID), COUNT(CUSTOMER_ID) OVER (PARTITION BY CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE TRANSACTION_ID IS NULL"
586,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID=T.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID ORDER BY COUNT_NO_TRANS"
587,Y,Y,"SELECT CUSTOMER_ID, COUNT(1) AS COUNT_NO_TRANS FROM VISITS T1 LEFT JOIN TRANSACTIONS T2 ON T1.VISIT_ID = T2.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
588,Y,Y,"SELECT CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY CUSTOMER_ID"
589,Y,Y,"SELECT DISTINCT CUSTOMER_ID, COUNT(CUSTOMER_ID) COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
590,Y,Y,"SELECT VISITS.CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTIONS.AMOUNT IS NULL GROUP BY VISITS.CUSTOMER_ID"
591,Y,Y,"SELECT CUSTOMER_ID,COUNT(*) AS COUNT_NO_TRANS FROM (SELECT CUSTOMER_ID,TRANSACTION_ID FROM VISITS A LEFT JOIN TRANSACTIONS B ON A.VISIT_ID = B.VISIT_ID) AS NEWTABLE WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
592,Y,Y,"SELECT C.CUSTOMER_ID, COUNT(C.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS C LEFT JOIN TRANSACTIONS T ON C.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY C.CUSTOMER_ID"
593,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN (SELECT T.VISIT_ID FROM TRANSACTIONS T) GROUP BY 1"
594,Y,Y,"SELECT DISTINCT CUSTOMER_ID, COUNT(VISITS.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
595,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(DISTINCT V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V, TRANSACTIONS T WHERE V.VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY V.CUSTOMER_ID"
596,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON T.VISIT_ID = V.VISIT_ID WHERE AMOUNT IS NULL GROUP BY CUSTOMER_ID"
597,Y,Y,"SELECT VISITS.CUSTOMER_ID, COUNT(VISITS.VISIT_ID) COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTIONS.VISIT_ID IS NULL GROUP BY VISITS.CUSTOMER_ID"
598,Y,Y,"WITH CTE AS ( SELECT VISIT_ID, CUSTOMER_ID FROM VISITS WHERE VISIT_ID NOT IN ( SELECT VISIT_ID FROM TRANSACTIONS) ) SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM CTE GROUP BY CUSTOMER_ID"
599,Y,Y,"SELECT A.CUSTOMER_ID, COUNT(A.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS A LEFT JOIN TRANSACTIONS B ON A.VISIT_ID = B.VISIT_ID WHERE B.VISIT_ID IS NULL GROUP BY A.CUSTOMER_ID"
600,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE ISNULL(TRANSACTIONS.AMOUNT) GROUP BY CUSTOMER_ID ORDER BY COUNT_NO_TRANS"
601,Y,Y,"SELECT CUSTOMER_ID , COUNT(*) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT DISTINCT VISIT_ID FROM VISITS AS V JOIN TRANSACTIONS AS T USING (VISIT_ID)) GROUP BY 1"
602,Y,Y,"SELECT CUSTOMER_ID, COUNT(DISTINCT VISIT_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT DISTINCT VISIT_ID FROM TRANSACTIONS) GROUP BY 1"
603,Y,Y,"WITH T1 AS( SELECT V.CUSTOMER_ID , V.VISIT_ID FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL ) SELECT CUSTOMER_ID , COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM T1 GROUP BY CUSTOMER_ID"
604,Y,Y,"SELECT CUSTOMER_ID, COUNT(DISTINCT V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY CUSTOMER_ID"
605,Y,Y,"SELECT CUSTOMER_ID , COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE V.VISIT_ID NOT IN (SELECT T1.VISIT_ID FROM TRANSACTIONS T1) GROUP BY CUSTOMER_ID"
606,Y,Y,"SELECT CUSTOMER_ID, COUNT(A.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS AS A LEFT JOIN TRANSACTIONS AS B ON A.VISIT_ID = B.VISIT_ID WHERE A.VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
607,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
608,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISITS.VISIT_ID) COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON TRANSACTIONS.VISIT_ID = VISITS.VISIT_ID WHERE TRANSACTIONS.TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
609,Y,Y,"SELECT C.CUSTOMER_ID, COUNT(C.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS C LEFT JOIN TRANSACTIONS T ON C.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY C.CUSTOMER_ID"
610,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(DISTINCT VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY V.CUSTOMER_ID"
611,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN( SELECT DISTINCT VISIT_ID FROM TRANSACTIONS ) GROUP BY CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC"
612,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS AS V WHERE V.VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY V.CUSTOMER_ID"
613,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID=T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY 1"
614,Y,Y,"SELECT A.CUSTOMER_ID, COUNT(A.COUNT_NO_TRANS) AS COUNT_NO_TRANS FROM ( SELECT VISITS.VISIT_ID, VISITS.CUSTOMER_ID, SUM( CASE WHEN TRANSACTION_ID IS NULL THEN 0 ELSE 1 END ) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID GROUP BY VISITS.VISIT_ID ) AS A WHERE COUNT_NO_TRANS = 0 GROUP BY A.CUSTOMER_ID"
615,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS AS V WHERE VISIT_ID NOT IN (SELECT DISTINCT VISIT_ID FROM TRANSACTIONS) GROUP BY V.CUSTOMER_ID"
616,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS V LEFT OUTER JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY CUSTOMER_ID"
617,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(DISTINCT(V.VISIT_ID)) AS COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN(SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
618,Y,Y,"WITH CTE AS (SELECT CUSTOMER_ID FROM VISITS WHERE VISIT_ID NOT IN (SELECT DISTINCT VISIT_ID FROM TRANSACTIONS)) SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM CTE GROUP BY CUSTOMER_ID"
619,Y,Y,"SELECT CUSTOMER_ID,COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON TRANSACTIONS.VISIT_ID=VISITS.VISIT_ID WHERE TRANSACTIONS.VISIT_ID IS NULL GROUP BY CUSTOMER_ID"
620,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY V.CUSTOMER_ID"
621,Y,Y,"SELECT CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS P ON V.VISIT_ID = P.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID"
622,Y,Y,"SELECT CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS AS V WHERE V.VISIT_ID NOT IN ( SELECT DISTINCT T.VISIT_ID FROM TRANSACTIONS AS T ) GROUP BY CUSTOMER_ID"
623,Y,Y,"SELECT DISTINCT CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY CUSTOMER_ID"
624,Y,Y,"SELECT CUSTOMER_ID, COUNT(DISTINCT VISIT_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISITS.VISIT_ID NOT IN (SELECT T.VISIT_ID FROM TRANSACTIONS T) GROUP BY CUSTOMER_ID"
625,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS V LEFT OUTER JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID"
626,Y,Y,"SELECT V.CUSTOMER_ID,COUNT(*) AS COUNT_NO_TRANS FROM VISITS V LEFT OUTER JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY V.CUSTOMER_ID"
627,Y,Y,"SELECT CUSTOMER_ID,COUNT(*) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID=TRANSACTIONS.VISIT_ID WHERE TRANSACTIONS.AMOUNT IS NULL GROUP BY VISITS.CUSTOMER_ID"
628,Y,Y,"SELECT CUSTOMER_ID,COUNT(*) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID WHERE T.AMOUNT IS NULL GROUP BY CUSTOMER_ID"
629,Y,Y,"SELECT DISTINCT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN ( SELECT VISIT_ID FROM TRANSACTIONS ) GROUP BY 1"
630,Y,Y,"WITH TEMP AS ( SELECT V.*,T.TRANSACTION_ID FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID), TEMP1 AS ( SELECT CUSTOMER_ID,TEMP.TRANSACTION_ID FROM TEMP WHERE TRANSACTION_ID IS NULL) SELECT CUSTOMER_ID,COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM TEMP1 GROUP BY CUSTOMER_ID"
631,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V NATURAL LEFT JOIN TRANSACTIONS T WHERE T.VISIT_ID IS NULL GROUP BY CUSTOMER_ID"
632,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISITS.VISIT_ID NOT IN (SELECT TRANSACTIONS.VISIT_ID FROM TRANSACTIONS) GROUP BY VISITS.CUSTOMER_ID"
633,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(*) COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID=T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
634,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTIONS.TRANSACTION_ID IS NULL GROUP BY 1"
635,Y,Y,"SELECT V.CUSTOMER_ID AS CUSTOMER_ID, COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID"
636,Y,Y,"SELECT CUSTOMER_ID , COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN( SELECT DISTINCT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC"
637,Y,Y,"SELECT CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T USING (VISIT_ID) WHERE T.VISIT_ID IS NULL GROUP BY V.CUSTOMER_ID"
638,Y,Y,"SELECT CUSTOMER_ID, COUNT(DISTINCT(VISIT_ID)) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
639,Y,Y,"WITH A AS (SELECT V.VISIT_ID,V.CUSTOMER_ID,T.TRANSACTION_ID,T.AMOUNT FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID=T.VISIT_ID) SELECT A.CUSTOMER_ID,COUNT(A.VISIT_ID) AS COUNT_NO_TRANS FROM A WHERE A.AMOUNT IS NULL GROUP BY 1"
640,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.AMOUNT IS NULL GROUP BY CUSTOMER_ID"
641,Y,Y,"SELECT CUSTOMER_ID,COUNT(VISITS.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISITS.VISIT_ID NOT IN (SELECT T.VISIT_ID FROM TRANSACTIONS T ) GROUP BY CUSTOMER_ID"
642,Y,Y,"SELECT A.CUSTOMER_ID , COUNT(1) AS COUNT_NO_TRANS FROM VISITS A LEFT JOIN TRANSACTIONS B ON A.VISIT_ID = B.VISIT_ID WHERE B.TRANSACTION_ID IS NULL GROUP BY 1"
643,Y,Y,"SELECT VISITS.CUSTOMER_ID, COUNT(VISITS.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISITS.VISIT_ID NOT IN (SELECT TRANSACTIONS.VISIT_ID FROM TRANSACTIONS) GROUP BY VISITS.CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC"
644,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM (SELECT CUSTOMER_ID, TRANSACTION_ID FROM VISITS A LEFT JOIN TRANSACTIONS B ON A.VISIT_ID = B.VISIT_ID) AS NEWTABLE WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC"
645,Y,Y,"SELECT CUSTOMER_ID, COUNT(DISTINCT V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID=T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY 1"
646,Y,Y,"SELECT CUSTOMER_ID,COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN ( SELECT V.VISIT_ID FROM VISITS V JOIN TRANSACTIONS T ON V.VISIT_ID=T.VISIT_ID ) GROUP BY CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC"
647,Y,Y,"SELECT V.CUSTOMER_ID,COUNT(V.CUSTOMER_ID ) AS COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN (SELECT DISTINCT VISIT_ID FROM TRANSACTIONS) GROUP BY V.CUSTOMER_ID"
648,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS CS ON V.VISIT_ID = CS.VISIT_ID WHERE CS.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID"
649,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS A WHERE VISIT_ID NOT IN ( SELECT VISIT_ID FROM TRANSACTIONS B WHERE A.VISIT_ID = B.VISIT_ID ) GROUP BY CUSTOMER_ID"
650,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISITS.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON TRANSACTIONS.VISIT_ID = VISITS.VISIT_ID WHERE TRANSACTIONS.VISIT_ID IS NULL GROUP BY CUSTOMER_ID"
651,Y,Y,"SELECT CUSTOMER_ID ,COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM ( SELECT CUSTOMER_ID ,TRANSACTION_ID FROM ( SELECT VISIT_ID ,CUSTOMER_ID FROM VISITS ) V LEFT JOIN ( SELECT TRANSACTION_ID ,VISIT_ID FROM TRANSACTIONS ) T ON V.VISIT_ID = T.VISIT_ID ) A WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
652,Y,Y,"WITH BASE AS ( SELECT CUSTOMER_ID, V.VISIT_ID AS V1, T.VISIT_ID AS V2, AMOUNT FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL ) SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM BASE GROUP BY CUSTOMER_ID"
653,Y,Y,"SELECT CUSTOMER_ID, COUNT(TRANS_COUNT) AS COUNT_NO_TRANS FROM ( SELECT V.CUSTOMER_ID, COUNT(T.TRANSACTION_ID) AS TRANS_COUNT FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON T.VISIT_ID = V.VISIT_ID GROUP BY V.VISIT_ID HAVING TRANS_COUNT = 0 ) AS T GROUP BY CUSTOMER_ID"
654,Y,Y,"WITH TEMP AS ( SELECT V.CUSTOMER_ID , V.VISIT_ID FROM VISITS AS V LEFT OUTER JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL ) SELECT CUSTOMER_ID , COUNT(*) AS COUNT_NO_TRANS FROM TEMP GROUP BY CUSTOMER_ID"
655,Y,Y,"SELECT DISTINCT CUSTOMER_ID, COUNT(CUSTOMER_ID) OVER (PARTITION BY CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTION_ID IS NULL"
656,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(1) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID"
657,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY VISITS.CUSTOMER_ID"
658,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISITS.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
659,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T USING(VISIT_ID) WHERE T.VISIT_ID IS NULL GROUP BY V.CUSTOMER_ID"
660,Y,Y,"SELECT V.CUSTOMER_ID AS CUSTOMER_ID, COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.AMOUNT IS NULL GROUP BY V.CUSTOMER_ID"
661,Y,Y,"SELECT V.CUSTOMER_ID , COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
662,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS AS V LEFT OUTER JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC,CUSTOMER_ID ASC"
663,Y,Y,"SELECT CUSTOMER_ID,COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE V.VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
664,Y,Y,"SELECT CUSTOMER_ID, COUNT(DISTINCT V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY V.CUSTOMER_ID"
665,Y,Y,"SELECT DISTINCT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
666,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISITS.VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
667,Y,Y,"SELECT CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS AS V NATURAL LEFT JOIN TRANSACTIONS AS T WHERE T.VISIT_ID IS NULL GROUP BY CUSTOMER_ID"
668,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISITS.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTIONS.VISIT_ID IS NULL GROUP BY VISITS.CUSTOMER_ID"
669,Y,Y,"SELECT CUSTOMER_ID, COUNT(1) COUNT_NO_TRANS FROM VISITS LEFT OUTER JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTIONS.VISIT_ID IS NULL GROUP BY CUSTOMER_ID"
670,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY 1"
671,Y,Y,"WITH T AS ( SELECT V.CUSTOMER_ID, T.VISIT_ID FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL ) SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM T GROUP BY CUSTOMER_ID"
672,Y,Y,"SELECT CUSTOMER_ID,COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM ( SELECT CUSTOMER_ID FROM VISITS AS V WHERE NOT EXISTS(SELECT * FROM TRANSACTIONS AS T WHERE V.VISIT_ID = T.VISIT_ID) ) AS P GROUP BY CUSTOMER_ID"
673,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID IN ( SELECT VISIT_ID FROM VISITS WHERE VISIT_ID NOT IN( SELECT VISIT_ID FROM TRANSACTIONS)) GROUP BY CUSTOMER_ID"
674,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.CUSTOMER_ID) COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.AMOUNT IS NULL GROUP BY V.CUSTOMER_ID"
675,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY V.CUSTOMER_ID"
676,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID GROUP BY VISITS.CUSTOMER_ID, TRANSACTIONS.AMOUNT HAVING TRANSACTIONS.AMOUNT IS NULL"
677,Y,Y,"SELECT CUSTOMER_ID,COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID ORDER BY COUNT(CUSTOMER_ID) DESC"
678,Y,Y,"SELECT CUSTOMER_ID, COUNT(1) AS COUNT_NO_TRANS FROM VISITS V NATURAL LEFT JOIN TRANSACTIONS T WHERE T.TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
679,Y,Y,"SELECT CUSTOMER_ID,COUNT(*) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID ORDER BY CUSTOMER_ID"
680,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS USING(VISIT_ID) WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
681,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS AS V WHERE V.VISIT_ID NOT IN (SELECT T.VISIT_ID FROM TRANSACTIONS T) GROUP BY V.CUSTOMER_ID"
682,Y,Y,"SELECT VISITS.CUSTOMER_ID, SUM(IF(TRANSACTIONS.AMOUNT IS NULL, 1,0)) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID GROUP BY VISITS.CUSTOMER_ID HAVING COUNT_NO_TRANS > 0"
683,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.CUSTOMER_ID ) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON T.VISIT_ID=V.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY 1"
684,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN ( SELECT VISIT_ID FROM TRANSACTIONS ) GROUP BY 1"
685,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS AS V WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
686,Y,Y,"SELECT V.CUSTOMER_ID AS CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE V.VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
687,Y,Y,"SELECT VISITS.CUSTOMER_ID, COUNT(DISTINCT VISITS.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISITS.VISIT_ID NOT IN(SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY VISITS.CUSTOMER_ID"
688,Y,Y,"SELECT X.CUSTOMER_ID, COUNT(DISTINCT VISIT_ID) AS COUNT_NO_TRANS FROM (SELECT V.CUSTOMER_ID, V.VISIT_ID, T.TRANSACTION_ID FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL)X GROUP BY 1"
689,Y,Y,"SELECT CUSTOMER_ID,COUNT(*) AS COUNT_NO_TRANS FROM VISITS A LEFT JOIN TRANSACTIONS B ON A.VISIT_ID= B.VISIT_ID WHERE B.TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID ORDER BY CUSTOMER_ID DESC"
690,Y,Y,"SELECT A.CUSTOMER_ID,COUNT(A.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS AS A LEFT JOIN TRANSACTIONS AS B ON A.VISIT_ID = B.VISIT_ID WHERE B.AMOUNT IS NULL GROUP BY A.CUSTOMER_ID"
691,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
692,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM (SELECT CUSTOMER_ID FROM TRANSACTIONS RIGHT JOIN VISITS ON TRANSACTIONS.VISIT_ID = VISITS.VISIT_ID WHERE TRANSACTION_ID IS NULL) AS TEMP GROUP BY CUSTOMER_ID"
693,Y,Y,"SELECT A.CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS A LEFT JOIN TRANSACTIONS B USING (VISIT_ID) WHERE B.TRANSACTION_ID IS NULL GROUP BY 1"
694,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID=T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC"
695,Y,Y,"SELECT CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID"
696,Y,Y,"SELECT CUSTOMER_ID,COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN(SELECT T.VISIT_ID FROM TRANSACTIONS T) GROUP BY CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC"
697,Y,Y,"SELECT V.CUSTOMER_ID ,COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID=T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC"
698,Y,Y,"WITH MPP AS (SELECT A.CUSTOMER_ID, A.VISIT_ID, B.VISIT_ID AS T_ID FROM VISITS A LEFT JOIN TRANSACTIONS B ON A.VISIT_ID=B.VISIT_ID) SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM MPP WHERE T_ID IS NULL GROUP BY CUSTOMER_ID"
699,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISITS.VISIT_ID NOT IN (SELECT T.VISIT_ID FROM VISITS V INNER JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID) GROUP BY CUSTOMER_ID"
700,Y,Y,"SELECT V.CUSTOMER_ID , COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID=T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY V.CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC"
701,Y,Y,"WITH TRANS AS ( SELECT VISIT_ID, COUNT(AMOUNT) N_TRANS FROM TRANSACTIONS GROUP BY VISIT_ID ) SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANS T USING (VISIT_ID) WHERE N_TRANS IS NULL GROUP BY CUSTOMER_ID"
702,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS NATURAL LEFT JOIN TRANSACTIONS WHERE TRANSACTIONS.VISIT_ID IS NULL GROUP BY CUSTOMER_ID"
703,Y,Y,"SELECT V.CUSTOMER_ID AS CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON (V.VISIT_ID = T.VISIT_ID) WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID"
704,Y,Y,"SELECT DISTINCT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY 1"
705,Y,Y,"SELECT CUSTOMER_ID, COUNT(CURRENT_VISIT_COUNT) AS COUNT_NO_TRANS FROM ( SELECT CUSTOMER_ID, (SELECT COUNT(VISIT_ID) FROM TRANSACTIONS WHERE TRANSACTIONS.VISIT_ID = VISITS.VISIT_ID) AS CURRENT_VISIT_COUNT FROM VISITS ) AS VISITCOUNT WHERE CURRENT_VISIT_COUNT = 0 GROUP BY CUSTOMER_ID"
706,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V JOIN (SELECT VISIT_ID FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS))X ON V.VISIT_ID = X.VISIT_ID GROUP BY CUSTOMER_ID"
707,Y,Y,"SELECT CUSTOMER_ID,COUNT(VISITS.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS LEFT OUTER JOIN TRANSACTIONS ON VISITS.VISIT_ID=TRANSACTIONS.VISIT_ID WHERE TRANSACTIONS.AMOUNT IS NULL GROUP BY CUSTOMER_ID"
708,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE AMOUNT IS NULL GROUP BY V.CUSTOMER_ID"
709,Y,Y,"SELECT CUSTOMER_ID, COUNT(1) COUNT_NO_TRANS FROM VISITS NATURAL LEFT JOIN TRANSACTIONS WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
710,Y,Y,"SELECT CUSTOMER_ID,COUNT(CUSTOMER_ID) COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT DISTINCT VISIT_ID FROM TRANSACTIONS) GROUP BY 1"
711,Y,Y,"SELECT DISTINCT(V.CUSTOMER_ID), COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN (SELECT T.VISIT_ID FROM TRANSACTIONS T WHERE V.VISIT_ID=T.VISIT_ID) GROUP BY V.CUSTOMER_ID"
712,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID=TRANSACTIONS.VISIT_ID WHERE TRANSACTIONS.AMOUNT IS NULL GROUP BY CUSTOMER_ID"
713,Y,Y,"SELECT NEW.CUSTOMER_ID, COUNT(NEW.CUSTOMER_ID) AS COUNT_NO_TRANS FROM ( SELECT V.CUSTOMER_ID, T.TRANSACTION_ID FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID=T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL) AS NEW GROUP BY NEW.CUSTOMER_ID"
714,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISIT_ID) COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T USING(VISIT_ID) WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
715,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) COUNT_NO_TRANS FROM VISITS WHERE VISITS.VISIT_ID NOT IN (SELECT DISTINCT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID ORDER BY COUNT_NO_TRANS"
716,Y,Y,"SELECT CUSTOMER_ID, SUM(IF(TRANSACTION_ID IS NULL,1,0)) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS USING(VISIT_ID) WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
717,Y,Y,"SELECT CUSTOMER_ID, COUNT_NO_TRANS FROM ( SELECT CUSTOMER_ID, COUNT(DISTINCT V.VISIT_ID) COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE AMOUNT IS NULL GROUP BY CUSTOMER_ID ) A WHERE COUNT_NO_TRANS >= 1"
718,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM (SELECT VISITS.CUSTOMER_ID AS CUSTOMER_ID, VISITS.VISIT_ID AS VISIT_ID FROM VISITS LEFT JOIN TRANSACTIONS ON TRANSACTIONS.VISIT_ID = VISITS.VISIT_ID GROUP BY VISITS.VISIT_ID HAVING COUNT(TRANSACTION_ID) = 0) NO_TRANS_VISITS GROUP BY CUSTOMER_ID"
719,Y,Y,"SELECT A.CUSTOMER_ID, COUNT(A.CUSTOMER_ID) COUNT_NO_TRANS FROM VISITS A WHERE A.VISIT_ID NOT IN (SELECT DISTINCT VISIT_ID FROM TRANSACTIONS) GROUP BY A.CUSTOMER_ID"
720,Y,Y,"SELECT CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON T.VISIT_ID = V.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
721,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT V.VISIT_ID FROM VISITS V JOIN TRANSACTIONS T ON VISITS.VISIT_ID = T.VISIT_ID GROUP BY CUSTOMER_ID) GROUP BY CUSTOMER_ID"
722,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS WHERE NOT EXISTS (SELECT 1 FROM TRANSACTIONS WHERE TRANSACTIONS.VISIT_ID = VISITS.VISIT_ID) GROUP BY CUSTOMER_ID"
723,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC"
724,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE AMOUNT IS NULL GROUP BY CUSTOMER_ID"
725,Y,Y,"SELECT V.CUSTOMER_ID,COUNT(*) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID ORDER BY V.CUSTOMER_ID"
726,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISITS.VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
727,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY V.CUSTOMER_ID ORDER BY 2 DESC"
728,Y,Y,"WITH CTE AS (SELECT VISITS.VISIT_ID, CUSTOMER_ID, TRANSACTION_ID FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTION_ID IS NULL ) SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM CTE GROUP BY 1"
729,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM ( SELECT CUSTOMER_ID, VISIT_ID FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) ) TEMP1 GROUP BY 1"
730,Y,Y,"SELECT * FROM( SELECT CUSTOMER_ID, COUNT(*) - COUNT(T.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN (SELECT DISTINCT(VISIT_ID) FROM TRANSACTIONS) T ON T.VISIT_ID = V.VISIT_ID GROUP BY CUSTOMER_ID ) A WHERE A.COUNT_NO_TRANS > 0"
731,Y,Y,"SELECT A.CUSTOMER_ID, COUNT(A.CUSTOMER_ID) AS COUNT_NO_TRANS FROM (SELECT V.CUSTOMER_ID, COUNT(T.TRANSACTION_ID) AS TR FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID=T.VISIT_ID GROUP BY V.VISIT_ID)A WHERE A.TR=0 GROUP BY A.CUSTOMER_ID"
732,Y,Y,"SELECT DISTINCT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T USING(VISIT_ID) WHERE T.VISIT_ID IS NULL GROUP BY CUSTOMER_ID"
733,Y,Y,"SELECT DISTINCT(A.CUSTOMER_ID), (SELECT COUNT(*) FROM VISITS AS B WHERE A.CUSTOMER_ID = B.CUSTOMER_ID AND B.VISIT_ID NOT IN (SELECT DISTINCT VISIT_ID FROM TRANSACTIONS)) AS COUNT_NO_TRANS FROM VISITS AS A WHERE A.VISIT_ID NOT IN (SELECT DISTINCT VISIT_ID FROM TRANSACTIONS)"
734,Y,Y,"SELECT V.CUSTOMER_ID, SUM(IF(T.TRANSACTION_ID IS NULL, 1, 0)) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID GROUP BY V.CUSTOMER_ID HAVING COUNT_NO_TRANS > 0"
735,Y,Y,"SELECT CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE V.VISIT_ID NOT IN (SELECT DISTINCT VISIT_ID FROM TRANSACTIONS) GROUP BY 1"
736,Y,Y,"SELECT CUSTOMER_ID, (COUNT(VISITS.VISIT_ID)-COUNT(TRANSACTION_ID)) AS COUNT_NO_TRANS FROM VISITS LEFT OUTER JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID GROUP BY CUSTOMER_ID HAVING COUNT_NO_TRANS != 0"
737,Y,Y,"WITH NO_TRANSACTION_VISITS AS ( SELECT CUSTOMER_ID, VISIT_ID FROM VISITS WHERE VISIT_ID NOT IN ( SELECT VISIT_ID FROM TRANSACTIONS ) ) SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM NO_TRANSACTION_VISITS GROUP BY CUSTOMER_ID"
738,Y,Y,"SELECT DISTINCT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS USING(VISIT_ID) WHERE TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
739,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM ( SELECT V.CUSTOMER_ID, V.VISIT_ID, T.TRANSACTION_ID FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL ) ABC GROUP BY CUSTOMER_ID"
740,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN (SELECT DISTINCT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
741,Y,Y,"SELECT VISITS.CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISITS.VISIT_ID NOT IN(SELECT TRANSACTIONS.VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
742,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V1 WHERE VISIT_ID NOT IN (SELECT DISTINCT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
743,Y,Y,"SELECT CUSTOMER_ID , COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT DISTINCT(VISIT_ID) FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
744,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON (V.VISIT_ID = T.VISIT_ID) WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID"
745,Y,Y,"WITH CTE AS ( SELECT CUSTOMER_ID, CASE WHEN AMOUNT IS NULL THEN 1 ELSE 0 END AS TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID) SELECT CUSTOMER_ID, SUM(TRANS) AS COUNT_NO_TRANS FROM CTE GROUP BY CUSTOMER_ID HAVING SUM(TRANS) >= 1"
746,Y,Y,"SELECT VISITS.CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS WHERE VISITS.VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY VISITS.CUSTOMER_ID"
747,Y,Y,"SELECT NEWTABLE.CUSTOMER_ID, COUNT(NEWTABLE.VISIT_ID) AS COUNT_NO_TRANS FROM (SELECT VISITS.CUSTOMER_ID, VISITS.VISIT_ID FROM VISITS LEFT OUTER JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTION_ID IS NULL) AS NEWTABLE GROUP BY NEWTABLE.CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC"
748,Y,Y,"SELECT CUSTOMER_ID, SUM(IF(T.VISIT_ID IS NULL, 1, 0)) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID GROUP BY 1 HAVING COUNT_NO_TRANS > 0"
749,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY CUSTOMER_ID"
750,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS A WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY 1"
751,Y,Y,"SELECT CUSTOMER_ID, COUNT(1) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON TRANSACTIONS.VISIT_ID = VISITS.VISIT_ID WHERE TRANSACTIONS.TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
752,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) - COUNT(T.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID GROUP BY CUSTOMER_ID HAVING COUNT_NO_TRANS > 0"
753,Y,Y,"SELECT V.CUSTOMER_ID AS CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN ( SELECT T.VISIT_ID FROM TRANSACTIONS T ) GROUP BY V.CUSTOMER_ID"
754,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(*) COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID=T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY 1"
755,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
756,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
757,Y,Y,"SELECT DISTINCT CUSTOMER_ID, COUNT(VISITS.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT TRANSACTIONS.VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC"
758,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY V.CUSTOMER_ID"
759,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN ( SELECT DISTINCT(T.VISIT_ID) FROM TRANSACTIONS AS T ) GROUP BY CUSTOMER_ID ORDER BY CUSTOMER_ID"
760,Y,Y,"SELECT (CUSTOMER_ID),COUNT(VISITS.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT DISTINCT(VISIT_ID) FROM TRANSACTIONS) GROUP BY CUSTOMER_ID"
761,Y,Y,"SELECT V.CUSTOMER_ID AS CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS) GROUP BY V.CUSTOMER_ID"
762,Y,Y,"SELECT V.CUSTOMER_ID, SUM(CASE WHEN T.TRANSACTION_ID IS NULL THEN 1 ELSE 0 END) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON T.VISIT_ID = V.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
763,Y,Y,"SELECT DISTINCT(CUSTOMER_ID) , COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM ( SELECT CUSTOMER_ID FROM VISITS WHERE VISIT_ID NOT IN ( SELECT DISTINCT(VISIT_ID) FROM TRANSACTIONS ) ) AS N GROUP BY CUSTOMER_ID"
764,Y,Y,"SELECT VISITS.CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON TRANSACTIONS.VISIT_ID = VISITS.VISIT_ID WHERE TRANSACTIONS.TRANSACTION_ID IS NULL GROUP BY VISITS.CUSTOMER_ID"
765,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN (SELECT DISTINCT VISIT_ID FROM TRANSACTIONS) GROUP BY V.CUSTOMER_ID"
766,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT DISTINCT VISIT_ID FROM TRANSACTIONS) GROUP BY CUSTOMER_ID ORDER BY COUNT_NO_TRANS DESC"
767,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTION_ID IS NULL GROUP BY 1"
768,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(COALESCE(T.TRANSACTION_ID, 0)) AS COUNT_NO_TRANS FROM TRANSACTIONS AS T RIGHT JOIN VISITS AS V ON T.VISIT_ID = V.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID"
769,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL AND T.AMOUNT IS NULL GROUP BY CUSTOMER_ID"
770,Y,Y,"SELECT CUSTOMER_ID, COUNT(1) AS COUNT_NO_TRANS FROM VISITS V LEFT OUTER JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY CUSTOMER_ID"
771,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM (SELECT V.VISIT_ID,CUSTOMER_ID,AMOUNT,TRANSACTION_ID FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE TRANSACTION_ID IS NULL) A GROUP BY CUSTOMER_ID"
772,Y,Y,"SELECT V2.CUSTOMER_ID ,COUNT(*) AS COUNT_NO_TRANS FROM ( SELECT V1.CUSTOMER_ID FROM ( SELECT V.VISIT_ID,V.CUSTOMER_ID,T.TRANSACTION_ID FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID=T.VISIT_ID) AS V1 WHERE TRANSACTION_ID IS NULL) AS V2 GROUP BY V2.CUSTOMER_ID"
773,Y,Y,"SELECT T1.CUSTOMER_ID, COUNT(T1.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS AS T1 LEFT JOIN TRANSACTIONS AS T2 ON T1.VISIT_ID=T2.VISIT_ID WHERE T2.VISIT_ID IS NULL GROUP BY T1.CUSTOMER_ID"
774,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS V LEFT JOIN TRANSACTIONS T USING(VISIT_ID) WHERE T.VISIT_ID IS NULL GROUP BY CUSTOMER_ID"
775,Y,Y,"SELECT CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS WHERE NOT EXISTS ( SELECT 1 FROM TRANSACTIONS WHERE VISITS.VISIT_ID = VISIT_ID ) GROUP BY CUSTOMER_ID"
776,Y,Y,"SELECT CUSTOMER_ID,COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM (SELECT CUSTOMER_ID,VISIT_ID FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS))AS AL GROUP BY CUSTOMER_ID"
777,Y,Y,"SELECT V.CUSTOMER_ID AS CUSTOMER_ID, COUNT(V.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS V WHERE V.VISIT_ID NOT IN ( SELECT DISTINCT T.VISIT_ID FROM TRANSACTIONS T ) GROUP BY V.CUSTOMER_ID"
778,Y,Y,"SELECT CUSTOMER_ID, COUNT(VISIT_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISIT_ID NOT IN (SELECT T.VISIT_ID FROM TRANSACTIONS T) GROUP BY CUSTOMER_ID"
779,Y,Y,"SELECT VISITS.CUSTOMER_ID, COUNT(VISITS.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS WHERE VISITS.VISIT_ID NOT IN ( SELECT TRANSACTIONS.VISIT_ID FROM TRANSACTIONS ) GROUP BY 1"
780,Y,Y,"SELECT CUSTOMER_ID , COUNT(*) AS COUNT_NO_TRANS FROM ( SELECT V.* FROM VISITS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID=T.VISIT_ID WHERE T.VISIT_ID IS NULL) X GROUP BY CUSTOMER_ID"
781,Y,Y,"SELECT DISTINCT CUSTOMER_ID, COUNT(VISITS.VISIT_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTIONS.TRANSACTION_ID IS NULL GROUP BY CUSTOMER_ID"
782,Y,Y,"SELECT CUSTOMER_ID, COUNT(CUSTOMER_ID) AS COUNT_NO_TRANS FROM(SELECT CUSTOMER_ID FROM VISITS WHERE VISIT_ID NOT IN (SELECT VISIT_ID FROM TRANSACTIONS)) AS T GROUP BY CUSTOMER_ID ORDER BY CUSTOMER_ID ASC"
783,Y,Y,"SELECT CUSTOMER_ID, COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID WHERE T.VISIT_ID IS NULL GROUP BY CUSTOMER_ID UNION SELECT CUSTOMER_ID, COUNT(V.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS AS V RIGHT JOIN TRANSACTIONS AS T ON V.VISIT_ID = T.VISIT_ID WHERE V.VISIT_ID IS NULL GROUP BY CUSTOMER_ID"
784,Y,Y,"SELECT V.CUSTOMER_ID, COUNT(*) AS COUNT_NO_TRANS FROM VISITS AS V LEFT JOIN TRANSACTIONS T ON V.VISIT_ID = T.VISIT_ID WHERE T.TRANSACTION_ID IS NULL GROUP BY V.CUSTOMER_ID"
785,Y,Y,"SELECT VISITS.CUSTOMER_ID, COUNT(VISITS.CUSTOMER_ID) AS COUNT_NO_TRANS FROM VISITS LEFT JOIN TRANSACTIONS ON VISITS.VISIT_ID = TRANSACTIONS.VISIT_ID WHERE TRANSACTIONS.VISIT_ID IS NULL GROUP BY VISITS.CUSTOMER_ID"
