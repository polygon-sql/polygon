qid,mysql_can_execute?,mysql_correct?,mysql_query
0,Y,Y,"SELECT A.REPORTS_TO EMPLOYEE_ID,B.NAME NAME,COUNT(A.REPORTS_TO) REPORTS_COUNT,ROUND(AVG(A.AGE)) AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO=B.EMPLOYEE_ID WHERE A.REPORTS_TO IS NOT NULL GROUP BY 1 ORDER BY 1"
1,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(B.NAME) REPORTS_COUNT, ROUND(AVG(B.AGE) )AVERAGE_AGE FROM EMPLOYEES A LEFT JOIN EMPLOYEES B ON A.EMPLOYEE_ID = B.REPORTS_TO WHERE B.NAME IS NOT NULL GROUP BY A.EMPLOYEE_ID, A.NAME ORDER BY A.EMPLOYEE_ID"
2,Y,Y,"SELECT B.EMPLOYEE_ID, B.NAME, COUNT(A.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(A.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A LEFT JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID WHERE ISNULL(B.EMPLOYEE_ID) = FALSE GROUP BY B.EMPLOYEE_ID ORDER BY 1"
3,Y,Y,"SELECT DISTINCT A.REPORTS_TO AS EMPLOYEE_ID, B.NAME, COUNT(DISTINCT A.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(A.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES A LEFT JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY 1,2 HAVING COUNT(DISTINCT A.EMPLOYEE_ID)>=1 AND A.REPORTS_TO IS NOT NULL"
4,Y,Y,"SELECT DISTINCT B.EMPLOYEE_ID, B.NAME, COUNT(A.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(A.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES A LEFT JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID WHERE A.REPORTS_TO IS NOT NULL GROUP BY B.EMPLOYEE_ID ORDER BY B.EMPLOYEE_ID"
5,Y,Y,"SELECT E.EMPLOYEE_ID, E.NAME, COUNT(*) REPORTS_COUNT, ROUND(AVG(M.AGE)) AVERAGE_AGE FROM EMPLOYEES E, EMPLOYEES M WHERE M.REPORTS_TO = E.EMPLOYEE_ID GROUP BY E.EMPLOYEE_ID, E.NAME ORDER BY E.EMPLOYEE_ID"
6,Y,Y,"SELECT E1.EMPLOYEE_ID , E1.NAME , COUNT(*) AS REPORTS_COUNT , ROUND(AVG(E2.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY 1,2 ORDER BY 1,2"
7,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(E2.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(E2.AGE)) AS AVERAGE_AGE FROM EMPLOYEES AS E1 JOIN EMPLOYEES AS E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID ORDER BY E1.EMPLOYEE_ID"
8,Y,N,"SELECT E1.EMPLOYEE_ID, E1.NAME, SUM(IF(E2.REPORTS_TO, 1, 0)) AS REPORTS_COUNT, ROUND(AVG(E2.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY 1, 2 ORDER BY 1"
9,Y,Y,"SELECT E1.REPORTS_TO AS EMPLOYEE_ID, E2.NAME AS NAME, COUNT(E1.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E1.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES AS E1 INNER JOIN EMPLOYEES AS E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY E1.REPORTS_TO HAVING COUNT(E1.EMPLOYEE_ID)>0 ORDER BY E1.REPORTS_TO"
10,Y,Y,"SELECT E1.REPORTS_TO AS EMPLOYEE_ID, E2.NAME AS NAME, COUNT(E1.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E1.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES AS E1 INNER JOIN EMPLOYEES AS E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY E1.REPORTS_TO HAVING COUNT(E1.EMPLOYEE_ID)>0 ORDER BY EMPLOYEE_ID"
11,Y,Y,"SELECT E2.EMPLOYEE_ID, E2.NAME, COUNT(DISTINCT E1.EMPLOYEE_ID) REPORTS_COUNT, ROUND(AVG(E1.AGE)) AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY 1,2 ORDER BY 1"
12,Y,Y,"SELECT E2.EMPLOYEE_ID, E2.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E1.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 INNER JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY 1 ORDER BY 1"
13,Y,Y,"SELECT M.EMPLOYEE_ID, M.NAME, COUNT(M.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES E JOIN (SELECT DISTINCT EMPLOYEE_ID, NAME FROM EMPLOYEES) AS M ON E.REPORTS_TO = M.EMPLOYEE_ID GROUP BY M.EMPLOYEE_ID ORDER BY M.EMPLOYEE_ID"
14,Y,Y,"SELECT M.MANAGER_ID AS EMPLOYEE_ID, M.MANAGER_NAME AS NAME, COUNT(M.MANAGER_ID) AS REPORTS_COUNT, ROUND(AVG(E.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES E JOIN (SELECT DISTINCT EMPLOYEE_ID AS MANAGER_ID, NAME AS MANAGER_NAME FROM EMPLOYEES) AS M ON E.REPORTS_TO = M.MANAGER_ID GROUP BY M.MANAGER_ID ORDER BY M.MANAGER_ID"
15,Y,Y,"SELECT MANAGERS.EMPLOYEE_ID, EMPLOYEES.NAME, MANAGERS.REPORTS_COUNT, MANAGERS.AVERAGE_AGE FROM ( SELECT E.REPORTS_TO AS EMPLOYEE_ID, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES AS E WHERE E.REPORTS_TO IS NOT NULL GROUP BY E.REPORTS_TO) MANAGERS JOIN EMPLOYEES ON MANAGERS.EMPLOYEE_ID = EMPLOYEES.EMPLOYEE_ID ORDER BY MANAGERS.EMPLOYEE_ID"
16,Y,Y,"SELECT T1.EMPLOYEE_ID, T1.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(T2.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES AS T1 JOIN EMPLOYEES AS T2 ON T1.EMPLOYEE_ID = T2.REPORTS_TO GROUP BY T1.EMPLOYEE_ID HAVING COUNT(*) > 0 ORDER BY T1.EMPLOYEE_ID"
17,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(B.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(B.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A, EMPLOYEES B WHERE A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY A.EMPLOYEE_ID ORDER BY A.EMPLOYEE_ID"
18,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(B.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A, EMPLOYEES B WHERE A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY 1 ORDER BY 1"
19,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(B.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY 1, 2 ORDER BY 1"
20,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(DISTINCT B.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(B.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON B.REPORTS_TO = A.EMPLOYEE_ID GROUP BY 1,2 ORDER BY 1"
21,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(A.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(B.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY B.REPORTS_TO ORDER BY 1"
22,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(B.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(B.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY B.REPORTS_TO ORDER BY 1"
23,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(B.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(B.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY 1, 2 ORDER BY 1"
24,Y,Y,"SELECT A.EMPLOYEE_ID, B.NAME, REPORTS_COUNT, AVERAGE_AGE FROM (SELECT REPORTS_TO AS EMPLOYEE_ID, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO HAVING COUNT(*) > 0) AS A LEFT JOIN EMPLOYEES B ON A.EMPLOYEE_ID = B.EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
25,Y,Y,"SELECT A.MANAGER_ID AS EMPLOYEE_ID,A.MANAGER_NAME AS NAME, COUNT(*) AS REPORTS_COUNT,ROUND(AVG(A.AGE),0) AS AVERAGE_AGE FROM (SELECT E.EMPLOYEE_ID,E.NAME AS EMPLOYEE_NAME, M.EMPLOYEE_ID AS MANAGER_ID,M.NAME AS MANAGER_NAME,E.AGE FROM EMPLOYEES E JOIN EMPLOYEES M ON E.REPORTS_TO = M.EMPLOYEE_ID)A GROUP BY A.MANAGER_ID,A.MANAGER_NAME ORDER BY EMPLOYEE_ID"
26,Y,Y,"SELECT A.REPORTS_TO AS EMPLOYEE_ID, B.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(A.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY A.REPORTS_TO HAVING A.REPORTS_TO IS NOT NULL ORDER BY EMPLOYEE_ID"
27,Y,Y,"SELECT A.REPORTS_TO AS EMPLOYEE_ID, B.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(A.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY A.REPORTS_TO ORDER BY EMPLOYEE_ID"
28,Y,Y,"SELECT A.REPORTS_TO AS EMPLOYEE_ID, B.NAME, COUNT(DISTINCT A.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(A.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO=B.EMPLOYEE_ID WHERE A.REPORTS_TO IS NOT NULL GROUP BY 1 ORDER BY 1"
29,Y,Y,"SELECT B.EMPLOYEE_ID AS EMPLOYEE_ID, B.NAME AS NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(A.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY 1 ORDER BY 1"
30,Y,Y,"SELECT B.EMPLOYEE_ID AS EMPLOYEE_ID, B.NAME AS NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(A.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY 1, 2 ORDER BY 1"
31,Y,Y,"SELECT B.EMPLOYEE_ID AS EMPLOYEE_ID, B.NAME AS NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(A.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY B.EMPLOYEE_ID ORDER BY B.EMPLOYEE_ID"
32,Y,Y,"SELECT B.EMPLOYEE_ID AS EMPLOYEE_ID, B.NAME AS NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(A.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
33,Y,Y,"SELECT B.EMPLOYEE_ID AS EMPLOYEE_ID, B.NAME AS NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(A.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY 1 ORDER BY 1"
34,Y,Y,"SELECT B.EMPLOYEE_ID, B.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(A.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY B.EMPLOYEE_ID ORDER BY B.EMPLOYEE_ID"
35,Y,Y,"SELECT B.EMPLOYEE_ID, B.NAME, COUNT(DISTINCT A.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(A.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY B.EMPLOYEE_ID, B.NAME"
36,Y,Y,"SELECT B.EMPLOYEE_ID, B.NAME, COUNT(A.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(A.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY 1, 2 ORDER BY 1"
37,Y,Y,"SELECT E.EMPLOYEE_ID, E.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E1.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E INNER JOIN EMPLOYEES E1 ON E1.REPORTS_TO = E.EMPLOYEE_ID GROUP BY 1,2 ORDER BY 1"
38,Y,Y,"SELECT E.EMPLOYEE_ID, E.NAME, T.REPORTS_COUNT, T.AVERAGE_AGE FROM EMPLOYEES E RIGHT JOIN (SELECT REPORTS_TO AS MANAGER, COUNT(DISTINCT EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(AGE),0) AS AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY 1) T ON E.EMPLOYEE_ID = T.MANAGER"
39,Y,Y,"SELECT E.REPORTS_TO AS EMPLOYEE_ID, R.NAME, COUNT(E.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E JOIN EMPLOYEES R ON R.EMPLOYEE_ID = E.REPORTS_TO GROUP BY E.REPORTS_TO ORDER BY E.REPORTS_TO"
40,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(E2.NAME) AS REPORTS_COUNT, ROUND(AVG(E2.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 LEFT JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID=E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID HAVING COUNT(E2.NAME) >= 1 ORDER BY E1.EMPLOYEE_ID"
41,Y,Y,"SELECT E1.EMPLOYEE_ID AS EMPLOYEE_ID, E1.NAME AS NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E2.AGE)) AS AVERAGE_AGE FROM EMPLOYEES AS E1 JOIN EMPLOYEES AS E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
42,Y,Y,"SELECT E1.EMPLOYEE_ID AS EMPLOYEE_ID, E1.NAME, COUNT(E1.EMPLOYEE_ID) AS REPORTS_COUNT , ROUND(AVG(E2.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
43,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E2.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID=E2.REPORTS_TO GROUP BY 1 ORDER BY 1"
44,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E2.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 WHERE E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY EMPLOYEE_ID HAVING COUNT(*) >= 1 ORDER BY E1.EMPLOYEE_ID"
45,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E2.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES AS E1 JOIN EMPLOYEES AS E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID ORDER BY E1.EMPLOYEE_ID"
46,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(*) REPORTS_COUNT, ROUND(AVG(E2.AGE)) AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID ORDER BY E1.EMPLOYEE_ID"
47,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(E2.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E2.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID=E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID ORDER BY E1.EMPLOYEE_ID"
48,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(E2.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E2.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 INNER JOIN EMPLOYEES E2 WHERE E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID ORDER BY E1.EMPLOYEE_ID"
49,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(E2.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(E2.AGE)) AS AVERAGE_AGE FROM EMPLOYEES AS E1, EMPLOYEES AS E2 WHERE E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
50,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(E2.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(E2.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1, EMPLOYEES E2 WHERE E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID ORDER BY EMPLOYEE_ID ASC"
51,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E2.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 LEFT JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO WHERE E2.EMPLOYEE_ID IS NOT NULL GROUP BY 1 ORDER BY 1"
52,Y,Y,"SELECT E1.EMPLOYEE_ID,E1.NAME,COUNT(E2.REPORTS_TO)AS REPORTS_COUNT,ROUND(AVG(E2.AGE))AS AVERAGE_AGE FROM EMPLOYEES AS E1 LEFT JOIN EMPLOYEES AS E2 ON E1.EMPLOYEE_ID=E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID HAVING REPORTS_COUNT>=1 ORDER BY E1.EMPLOYEE_ID"
53,Y,Y,"SELECT E1.REPORTS_TO AS EMPLOYEE_ID, E2.NAME AS NAME, COUNT(DISTINCT E1.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E1.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES E1 LEFT JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID WHERE E1.REPORTS_TO IS NOT NULL GROUP BY 1, 2"
54,Y,Y,"SELECT E1.REPORTS_TO AS EMPLOYEE_ID, E2.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E1.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES AS E1 JOIN EMPLOYEES AS E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
55,Y,Y,"SELECT E1.REPORTS_TO AS EMPLOYEE_ID, E2.NAME, COUNT(E1.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E1.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY E1.REPORTS_TO, E2.NAME ORDER BY E1.REPORTS_TO"
56,Y,Y,"SELECT E1.REPORTS_TO AS EMPLOYEE_ID, E2.NAME, COUNT(E1.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E1.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 INNER JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY E1.REPORTS_TO, E2.NAME ORDER BY EMPLOYEE_ID"
57,Y,Y,"SELECT E1.REPORTS_TO AS EMPLOYEE_ID, E2.NAME, COUNT(E2.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E1.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY 1 ORDER BY 1"
58,Y,Y,"SELECT E1.REPORTS_TO AS EMPLOYEE_ID, E2.NAME, COUNT(E1.NAME) AS REPORTS_COUNT, ROUND(AVG(E1.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 INNER JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY E1.REPORTS_TO ORDER BY E1.REPORTS_TO"
59,Y,Y,"SELECT E2.EMPLOYEE_ID , E2.NAME , COUNT(DISTINCT E1.EMPLOYEE_ID) AS REPORTS_COUNT , ROUND(AVG(E1.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.REPORTS_TO=E2.EMPLOYEE_ID GROUP BY E2.EMPLOYEE_ID"
60,Y,Y,"SELECT E2.EMPLOYEE_ID AS EMPLOYEE_ID, E2.NAME AS NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E1.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY 1 ORDER BY 1"
61,Y,Y,"SELECT E2.EMPLOYEE_ID, E2.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E1.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY E2.EMPLOYEE_ID ORDER BY E2.EMPLOYEE_ID"
62,Y,Y,"SELECT E2.EMPLOYEE_ID, E2.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E1.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY E2.EMPLOYEE_ID ORDER BY E2.EMPLOYEE_ID"
63,Y,Y,"SELECT E2.EMPLOYEE_ID, E2.NAME, COUNT(E1.EMPLOYEE_ID) AS REPORTS_COUNT , ROUND(AVG(E1.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E2 INNER JOIN EMPLOYEES E1 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY E1.REPORTS_TO ORDER BY E2.EMPLOYEE_ID"
64,Y,Y,"SELECT E2.EMPLOYEE_ID, E2.NAME, COUNT(E1.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E1.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY E2.EMPLOYEE_ID ORDER BY E2.EMPLOYEE_ID"
65,Y,Y,"SELECT E2.EMPLOYEE_ID, E2.NAME, COUNT(E1.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E1.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID WHERE E1.REPORTS_TO IS NOT NULL GROUP BY E1.REPORTS_TO ORDER BY E2.EMPLOYEE_ID"
66,Y,Y,"SELECT E2.EMPLOYEE_ID, E2.NAME, COUNT(E1.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(E1.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES AS E1 INNER JOIN EMPLOYEES AS E2 ON E1.REPORTS_TO=E2.EMPLOYEE_ID GROUP BY E2.EMPLOYEE_ID, NAME ORDER BY E2.EMPLOYEE_ID"
67,Y,Y,"SELECT E2.EMPLOYEE_ID, E2.NAME, COUNT(E1.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(E1.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 LEFT JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID WHERE E1.REPORTS_TO IS NOT NULL GROUP BY 1 ORDER BY 1"
68,Y,Y,"SELECT E2.EMPLOYEE_ID, E2.NAME, COUNT(*) REPORTS_COUNT, ROUND( AVG(E1.AGE),0 ) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.REPORTS_TO=E2.EMPLOYEE_ID GROUP BY E2.EMPLOYEE_ID, E2.NAME ORDER BY EMPLOYEE_ID"
69,Y,Y,"SELECT E2.EMPLOYEE_ID, E2.NAME, COUNT(E1.NAME) AS REPORTS_COUNT, ROUND(AVG(E1.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 INNER JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID AND E1.REPORTS_TO IS NOT NULL GROUP BY E2.EMPLOYEE_ID, E2.NAME HAVING COUNT(E1.NAME) >= 1 ORDER BY EMPLOYEE_ID"
70,Y,Y,"SELECT E2.REPORTS_TO AS EMPLOYEE_ID, E1.NAME, COUNT(E2.EMPLOYEE_ID) AS REPORTS_COUNT , ROUND(AVG(E2.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
71,Y,Y,"SELECT E2.REPORTS_TO EMPLOYEE_ID, E1.NAME ,COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E2.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY E2.REPORTS_TO ORDER BY E2.REPORTS_TO"
72,Y,Y,"SELECT EMPLOYEE_ID, NAME, REPORTS_COUNT, AVERAGE_AGE FROM ( SELECT DISTINCT REPORTS_TO, COUNT(*) REPORTS_COUNT, ROUND(AVG(AGE)) AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO ) S LEFT JOIN EMPLOYEES E ON S.REPORTS_TO = E.EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
73,Y,Y,"SELECT M.EMPLOYEE_ID, M.NAME AS NAME, COUNT(E.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES M JOIN EMPLOYEES E ON M.EMPLOYEE_ID = E.REPORTS_TO GROUP BY EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
74,Y,Y,"SELECT M.EMPLOYEE_ID, M.NAME, COUNT(DISTINCT E.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E JOIN EMPLOYEES M ON E.REPORTS_TO=M.EMPLOYEE_ID GROUP BY 1,2"
75,Y,Y,"SELECT M.EMPLOYEE_ID, M.NAME, COUNT(DISTINCT(E.EMPLOYEE_ID)) AS REPORTS_COUNT, ROUND(AVG(E.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E INNER JOIN EMPLOYEES M ON E.REPORTS_TO = M.EMPLOYEE_ID WHERE E.REPORTS_TO IS NOT NULL GROUP BY M.EMPLOYEE_ID"
76,Y,Y,"SELECT M.EMPLOYEE_ID, M.NAME, COUNT(E.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E INNER JOIN EMPLOYEES M ON E.REPORTS_TO = M.EMPLOYEE_ID WHERE E.REPORTS_TO IS NOT NULL GROUP BY M.EMPLOYEE_ID ORDER BY M.EMPLOYEE_ID"
77,Y,Y,"SELECT M.EMPLOYEE_ID, M.NAME, COUNT(E.EMPLOYEE_ID) REPORTS_COUNT, ROUND(AVG(E.AGE),0) AVERAGE_AGE FROM EMPLOYEES E JOIN EMPLOYEES M ON E.REPORTS_TO = M.EMPLOYEE_ID GROUP BY M.EMPLOYEE_ID, M.NAME ORDER BY M.EMPLOYEE_ID"
78,Y,Y,"SELECT M.EMPLOYEE_ID, M.NAME, COUNT(E.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(E.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES E JOIN EMPLOYEES M ON E.REPORTS_TO = M.EMPLOYEE_ID GROUP BY 1 ORDER BY EMPLOYEE_ID"
79,Y,Y,"SELECT MANAGER AS EMPLOYEE_ID, NAME, COUNT(EMPLOYEE) AS REPORTS_COUNT, ROUND(AVG(AGE)) AS AVERAGE_AGE FROM (SELECT E1.EMPLOYEE_ID AS MANAGER, E2.EMPLOYEE_ID AS EMPLOYEE, E2.AGE AS AGE, E1.NAME AS NAME FROM EMPLOYEES AS E1 INNER JOIN EMPLOYEES AS E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO ) AS ABC GROUP BY EMPLOYEE_ID ORDER BY 1"
80,Y,Y,"SELECT T1.EMPLOYEE_ID, T1.NAME, COUNT(T2.EMPLOYEE_ID) REPORTS_COUNT, ROUND(AVG(T2.AGE), 0) AVERAGE_AGE FROM EMPLOYEES T1 LEFT JOIN EMPLOYEES T2 ON T1.EMPLOYEE_ID = T2.REPORTS_TO WHERE T2.REPORTS_TO IS NOT NULL GROUP BY 1 ORDER BY EMPLOYEE_ID"
81,Y,Y,"SELECT T1.EMPLOYEE_ID,T1.NAME,COUNT(T2.AGE) AS REPORTS_COUNT, ROUND(AVG(T2.AGE))AS AVERAGE_AGE FROM EMPLOYEES T1 JOIN EMPLOYEES T2 ON T1.EMPLOYEE_ID=T2.REPORTS_TO GROUP BY T1.EMPLOYEE_ID ORDER BY T1.EMPLOYEE_ID"
82,Y,Y,"SELECT T1.REPORTS_TO AS EMPLOYEE_ID, T2.NAME AS NAME, COUNT(T1.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(T1.AGE)) AS AVERAGE_AGE FROM EMPLOYEES T1, EMPLOYEES T2 WHERE T1.REPORTS_TO = T2.EMPLOYEE_ID GROUP BY T2.EMPLOYEE_ID ORDER BY 1"
83,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(B.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(B.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A, EMPLOYEES B WHERE A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY A.EMPLOYEE_ID ORDER BY A.EMPLOYEE_ID"
84,Y,N,"SELECT EMPLOYEES.EMPLOYEE_ID,EMPLOYEES.NAME,TAB1.CNT AS REPORTS_COUNT,TAB1.AVERAGE_AGE AS AVERAGE_AGE FROM EMPLOYEES INNER JOIN (SELECT COALESCE(REPORTS_TO,0) AS RT,COUNT(REPORTS_TO) AS CNT,ROUND(AVG(AGE)) AS AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO<>0 GROUP BY REPORTS_TO HAVING COUNT(REPORTS_TO)>=1) TAB1 ON TAB1.RT=EMPLOYEES.EMPLOYEE_ID ORDER BY EMPLOYEES.EMPLOYEE_ID"
85,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, B.REPORTS_COUNT, B.AVERAGE_AGE FROM EMPLOYEES A LEFT JOIN ( SELECT REPORTS_TO, COUNT(REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(AGE),0) AS AVERAGE_AGE FROM EMPLOYEES GROUP BY REPORTS_TO) AS B ON A.EMPLOYEE_ID = B.REPORTS_TO WHERE B.REPORTS_COUNT IS NOT NULL ORDER BY 1"
86,Y,Y,"SELECT B.EMPLOYEE_ID, B.NAME, COUNT(DISTINCT A.EMPLOYEE_ID) REPORTS_COUNT, ROUND(AVG(A.AGE)) AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY B.EMPLOYEE_ID, B.NAME"
87,Y,Y,"SELECT DISTINCT B.EMPLOYEE_ID, B.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(A.AGE),0) AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY B.EMPLOYEE_ID ORDER BY B.EMPLOYEE_ID"
88,Y,Y,"SELECT E.EMPLOYEE_ID AS EMPLOYEE_ID, E.NAME AS NAME, REPORTS_COUNT, GH.AGE AS AVERAGE_AGE FROM EMPLOYEES E JOIN (SELECT DISTINCT REPORTS_TO,COUNT(REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(AGE)) AS AGE FROM EMPLOYEES GROUP BY REPORTS_TO) GH ON GH.REPORTS_TO = E.EMPLOYEE_ID ORDER BY EMPLOYEE_ID ASC"
89,Y,Y,"SELECT E1.EMPLOYEE_ID EMPLOYEE_ID, E1.NAME NAME, COUNT(E2.EMPLOYEE_ID) REPORTS_COUNT, ROUND(AVG(E2.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES AS E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID, E1.NAME ORDER BY E1.EMPLOYEE_ID"
90,Y,Y,"SELECT E1.REPORTS_TO AS EMPLOYEE_ID, E2.NAME, COUNT(E1.REPORTS_TO) REPORTS_COUNT, ROUND(AVG(E1.AGE),0) AVERAGE_AGE FROM EMPLOYEES E1, EMPLOYEES E2 WHERE E1.REPORTS_TO=E2.EMPLOYEE_ID GROUP BY E1.REPORTS_TO ORDER BY E1.REPORTS_TO"
91,Y,Y,"SELECT R.EMPLOYEE_ID AS EMPLOYEE_ID, R.NAME, COUNT(E.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E JOIN EMPLOYEES R ON R.EMPLOYEE_ID = E.REPORTS_TO GROUP BY E.REPORTS_TO ORDER BY E.REPORTS_TO"
92,Y,Y,"SELECT REPORTS_TO AS EMPLOYEE_ID, (SELECT NAME FROM EMPLOYEES WHERE EMPLOYEE_ID = EMP.REPORTS_TO) AS NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(AGE)) AS AVERAGE_AGE FROM EMPLOYEES EMP WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO ORDER BY EMPLOYEE_ID"
93,Y,Y,"SELECT X.EMPLOYEE_ID, NAME,REPORTS_COUNT, AVERAGE_AGE FROM EMPLOYEES E INNER JOIN (SELECT REPORTS_TO AS EMPLOYEE_ID,COUNT(*) AS REPORTS_COUNT, ROUND(AVG(AGE),0) AS AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO) X ON E.EMPLOYEE_ID = X.EMPLOYEE_ID ORDER BY X.EMPLOYEE_ID"
94,Y,Y,"WITH CTE1 AS ( SELECT REPORTS_TO AS EMPLOYEE_ID, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO) SELECT CTE1.EMPLOYEE_ID, EMPLOYEES.NAME, REPORTS_COUNT, AVERAGE_AGE FROM CTE1 JOIN EMPLOYEES ON CTE1.EMPLOYEE_ID = EMPLOYEES.EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
95,Y,Y,"WITH MANAGERTEAMDETAILS AS (SELECT REPORTS_TO ,COUNT(EMPLOYEE_ID) AS COUNTER ,AVG(AGE) AS AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO) SELECT E.EMPLOYEE_ID ,E.NAME ,MTD.COUNTER AS REPORTS_COUNT ,ROUND(MTD.AVERAGE_AGE,0) AS AVERAGE_AGE FROM EMPLOYEES E INNER JOIN MANAGERTEAMDETAILS MTD ON MTD.REPORTS_TO = E.EMPLOYEE_ID ORDER BY 1 ASC"
96,Y,Y,"WITH TEAMSTATS AS (SELECT REPORTS_TO AS EMPLOYEE_ID ,COUNT(EMPLOYEE_ID) AS REPORTS_COUNT ,ROUND(AVG(AGE)) AS AVERAGE_AGE FROM EMPLOYEES GROUP BY REPORTS_TO) SELECT E.EMPLOYEE_ID ,E.NAME ,TS.REPORTS_COUNT ,TS.AVERAGE_AGE FROM EMPLOYEES E INNER JOIN TEAMSTATS TS ON E.EMPLOYEE_ID = TS.EMPLOYEE_ID ORDER BY 1 ASC"
97,Y,Y,"WITH A AS ( SELECT REPORTS_TO, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO) SELECT A.REPORTS_TO AS EMPLOYEE_ID, EMPLOYEES.NAME, A.REPORTS_COUNT, A.AVERAGE_AGE FROM A JOIN EMPLOYEES ON A.REPORTS_TO = EMPLOYEES.EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
98,Y,Y,"WITH AGE AS (SELECT A.EMPLOYEE_ID, A.NAME AS MANAGER_NAME, B.NAME AS DIRECT_REPORT_NAME, B.AGE FROM EMPLOYEES A INNER JOIN EMPLOYEES B ON A.EMPLOYEE_ID = B.REPORTS_TO) SELECT EMPLOYEE_ID, MANAGER_NAME AS NAME, COUNT(DIRECT_REPORT_NAME) AS REPORTS_COUNT, ROUND(AVG(AGE)) AS AVERAGE_AGE FROM AGE GROUP BY 1,2 ORDER BY 1"
99,Y,Y,"WITH C1 AS (SELECT E2.EMPLOYEE_ID, E2.NAME, E1.EMPLOYEE_ID AS REPORTS_FROM, E1.AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID) SELECT EMPLOYEE_ID, NAME , COUNT(REPORTS_FROM) AS REPORTS_COUNT, ROUND(AVG(AGE)) AS AVERAGE_AGE FROM C1 GROUP BY EMPLOYEE_ID, NAME ORDER BY EMPLOYEE_ID"
100,Y,Y,"WITH COUNTS AS ( SELECT REPORTS_TO, COUNT(DISTINCT EMPLOYEE_ID) AS REPORTS_COUNT, AVG(AGE) AS AVERAGE_AGE FROM EMPLOYEES GROUP BY 1 ) SELECT C.REPORTS_TO AS EMPLOYEE_ID, E.NAME, C.REPORTS_COUNT, ROUND(C.AVERAGE_AGE, 0) AS AVERAGE_AGE FROM COUNTS C JOIN EMPLOYEES E ON C.REPORTS_TO = E.EMPLOYEE_ID WHERE C.REPORTS_COUNT IS NOT NULL ORDER BY 1"
101,Y,Y,"WITH CTE AS (SELECT DISTINCT REPORTS_TO AS EMPLOYEE_ID, COUNT(EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO) SELECT CTE.EMPLOYEE_ID, E.NAME, CTE.REPORTS_COUNT, CTE.AVERAGE_AGE FROM EMPLOYEES AS E JOIN CTE ON E.EMPLOYEE_ID = CTE.EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
102,Y,Y,"WITH MANAGER_IDS AS ( SELECT REPORTS_TO AS MANAGER_ID, COUNT(*) AS REPORTS_COUNT,AVG(AGE) AS AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY 1 ) SELECT EMPLOYEE_ID, NAME,REPORTS_COUNT,ROUND(AVERAGE_AGE,0) AS AVERAGE_AGE FROM EMPLOYEES INNER JOIN MANAGER_IDS ON MANAGER_IDS.MANAGER_ID = EMPLOYEES.EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
103,Y,Y,"WITH MANAGERS AS ( SELECT B.EMPLOYEE_ID,A.NAME,A.EMPLOYEE_ID AS SUBORDINATE,B.NAME AS MANAGER,A.AGE FROM (EMPLOYEES AS A) JOIN (EMPLOYEES AS B) ON A.REPORTS_TO = B.EMPLOYEE_ID ) SELECT EMPLOYEE_ID, MANAGER AS NAME, COUNT(SUBORDINATE) AS REPORTS_COUNT, ROUND(AVG(AGE)) AS AVERAGE_AGE FROM MANAGERS GROUP BY EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
104,Y,Y,"WITH MANAGERS AS( SELECT REPORTS_TO AS EMPLOYEE_ID, COUNT(DISTINCT EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(AGE)) AS AVERAGE_AGE FROM EMPLOYEES GROUP BY REPORTS_TO HAVING REPORTS_TO IS NOT NULL ) SELECT M.EMPLOYEE_ID, E.NAME, REPORTS_COUNT, AVERAGE_AGE FROM MANAGERS M JOIN EMPLOYEES E ON M.EMPLOYEE_ID = E.EMPLOYEE_ID ORDER BY 1"
105,Y,Y,"WITH RESULT AS (SELECT M.EMPLOYEE_ID, M.NAME, E.EMPLOYEE_ID AS REPORTS, E.AGE FROM EMPLOYEES AS M JOIN EMPLOYEES AS E ON M.EMPLOYEE_ID = E.REPORTS_TO) SELECT EMPLOYEE_ID, NAME, COUNT(REPORTS) AS REPORTS_COUNT, ROUND(AVG(AGE)) AS AVERAGE_AGE FROM RESULT GROUP BY 1, 2 ORDER BY 1"
106,Y,Y,"WITH T AS (SELECT A.EMPLOYEE_ID, A.NAME, B.EMPLOYEE_ID AS REPORTER, B.AGE AS REPORTER_AGE FROM EMPLOYEES A INNER JOIN EMPLOYEES B ON A.EMPLOYEE_ID = B.REPORTS_TO) SELECT EMPLOYEE_ID, NAME, COUNT(REPORTER) REPORTS_COUNT, ROUND(AVG(REPORTER_AGE),0) AS AVERAGE_AGE FROM T GROUP BY EMPLOYEE_ID ORDER BY EMPLOYEE_ID ASC"
107,Y,Y,"WITH TEMP AS (SELECT REPORTS_TO, COUNT(REPORTS_TO) AS COUNTS, ROUND(AVG(AGE)) AS AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO) SELECT EMPLOYEES.EMPLOYEE_ID, EMPLOYEES.NAME, TEMP.COUNTS AS REPORTS_COUNT, TEMP.AGE AS AVERAGE_AGE FROM EMPLOYEES LEFT JOIN TEMP ON TEMP.REPORTS_TO=EMPLOYEES.EMPLOYEE_ID WHERE TEMP.COUNTS>0 ORDER BY EMPLOYEES.EMPLOYEE_ID"
108,Y,Y,"SELECT E.EMPLOYEE_ID, E.NAME, COUNT(EE.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(EE.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E LEFT JOIN EMPLOYEES EE ON E.EMPLOYEE_ID = EE.REPORTS_TO GROUP BY 1 HAVING COUNT(EE.REPORTS_TO) >=1 ORDER BY 1"
109,Y,Y,"SELECT E1.REPORTS_TO AS EMPLOYEE_ID, E.NAME, COUNT(E1.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E1.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E ON E1.REPORTS_TO = E.EMPLOYEE_ID WHERE E1.REPORTS_TO IS NOT NULL GROUP BY E1.REPORTS_TO ORDER BY EMPLOYEE_ID"
110,Y,Y,"SELECT M.EMPLOYEE_ID, M.NAME, COUNT(E.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E INNER JOIN EMPLOYEES M ON E.REPORTS_TO = M.EMPLOYEE_ID GROUP BY M.EMPLOYEE_ID, M.NAME ORDER BY M.EMPLOYEE_ID"
111,Y,Y,"SELECT M.EMPLOYEE_ID, M.NAME, COUNT(E.REPORTS_TO) AS REPORTS_COUNT, ROUND(((SUM(E.AGE))/COUNT(E.REPORTS_TO))) AS AVERAGE_AGE FROM EMPLOYEES E INNER JOIN EMPLOYEES M ON E.REPORTS_TO = M.EMPLOYEE_ID GROUP BY M.EMPLOYEE_ID ORDER BY M.EMPLOYEE_ID"
112,Y,Y,"SELECT A.EMPLOYEE_ID ,A.NAME ,COUNT(B.EMPLOYEE_ID) AS REPORTS_COUNT ,ROUND(AVG(B.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES A INNER JOIN EMPLOYEES B ON A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY 1,2 ORDER BY 1,2"
113,Y,Y,"SELECT A.EMPLOYEE_ID ,A.NAME ,COUNT(B.EMPLOYEE_ID) AS REPORTS_COUNT ,ROUND(AVG(B.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES A INNER JOIN EMPLOYEES B ON A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
114,Y,Y,"SELECT A.EMPLOYEE_ID AS EMPLOYEE_ID , A.NAME AS NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(B.AGE ),0) AS AVERAGE_AGE FROM EMPLOYEES AS A INNER JOIN EMPLOYEES AS B ON A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY A.EMPLOYEE_ID ORDER BY A.EMPLOYEE_ID"
115,Y,Y,"SELECT A.EMPLOYEE_ID AS EMPLOYEE_ID, A.NAME AS NAME, COUNT(B.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(B.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A INNER JOIN EMPLOYEES B ON A.EMPLOYEE_ID=B.REPORTS_TO GROUP BY A.EMPLOYEE_ID ORDER BY A.EMPLOYEE_ID"
116,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME AS NAME, COUNT(DISTINCT B.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(B.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY A.EMPLOYEE_ID ORDER BY 1"
117,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME AS NAME, COUNT(DISTINCT B.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(B.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY A.EMPLOYEE_ID,A.NAME ORDER BY 1"
118,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(*) REPORTS_COUNT , ROUND(AVG(B.AGE)) AVERAGE_AGE FROM EMPLOYEES A INNER JOIN EMPLOYEES B ON A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY 1 ORDER BY 1 ASC"
119,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(B.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A INNER JOIN EMPLOYEES B ON A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY EMPLOYEE_ID ORDER BY EMPLOYEE_ID ASC"
120,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(B.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY 1 ORDER BY 1"
121,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(B.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A, EMPLOYEES B WHERE A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY 1,2 ORDER BY 1"
122,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(B.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A, EMPLOYEES B WHERE A.EMPLOYEE_ID=B.REPORTS_TO GROUP BY A.EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
123,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(B.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(B.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES A, EMPLOYEES B WHERE A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY A.EMPLOYEE_ID ORDER BY A.EMPLOYEE_ID"
124,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(B.EMPLOYEE_ID)AS REPORTS_COUNT , ROUND(AVG(B.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES A INNER JOIN EMPLOYEES B ON A.EMPLOYEE_ID = B.REPORTS_TO WHERE B.REPORTS_TO IS NOT NULL GROUP BY 1,2 ORDER BY A.EMPLOYEE_ID ASC"
125,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(B.NAME) AS REPORTS_COUNT, ROUND(AVG(B.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A. EMPLOYEE_ID = B.REPORTS_TO GROUP BY A.EMPLOYEE_ID ORDER BY A.EMPLOYEE_ID"
126,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(B.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(B.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY 1 ORDER BY 1"
127,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(B.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(B.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A, EMPLOYEES B WHERE A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY 1 ORDER BY 1"
128,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(B.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(B.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY A.EMPLOYEE_ID ORDER BY A.EMPLOYEE_ID"
129,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(B.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(B.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY A.EMPLOYEE_ID, A.NAME ORDER BY A.EMPLOYEE_ID"
130,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(B.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(B.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY A.EMPLOYEE_ID, A.NAME ORDER BY 1"
131,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(B.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(B.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY A.EMPLOYEE_ID, A.NAME ORDER BY A.EMPLOYEE_ID"
132,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(B.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(B.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B WHERE A.EMPLOYEE_ID=B.REPORTS_TO GROUP BY EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
133,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(B.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(B.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES AS A JOIN EMPLOYEES AS B ON A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY A.EMPLOYEE_ID ORDER BY A.EMPLOYEE_ID"
134,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(DISTINCT B.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(B.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES AS A JOIN EMPLOYEES AS B ON A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY A.EMPLOYEE_ID, A.NAME ORDER BY A.EMPLOYEE_ID"
135,Y,Y,"SELECT A.EMPLOYEE_ID,A.NAME, COUNT(B.NAME) REPORTS_COUNT, ROUND(AVG(B.AGE),0) AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY A.EMPLOYEE_ID ORDER BY A.EMPLOYEE_ID"
136,Y,Y,"SELECT A.EMPLOYEE_ID,A.NAME,B.REPORTS_COUNT,B.AVERAGE_AGE FROM EMPLOYEES A JOIN (SELECT DISTINCT(REPORTS_TO) AS MANAGER, COUNT(REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(AGE)) AS AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO) B ON A.EMPLOYEE_ID = B.MANAGER ORDER BY A.EMPLOYEE_ID"
137,Y,Y,"SELECT A.EMPLOYEE_ID,A.NAME,COUNT(B.EMPLOYEE_ID) AS REPORTS_COUNT,ROUND(AVG(B.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.EMPLOYEE_ID=B.REPORTS_TO GROUP BY A.EMPLOYEE_ID,A.NAME ORDER BY A.EMPLOYEE_ID"
138,Y,Y,"SELECT A.EMPLOYEE_ID,A.NAME,COUNT(DISTINCT B.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(B.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY 1 ORDER BY 1"
139,Y,Y,"SELECT A.REPORTS_TO AS EMPLOYEE_ID, B.NAME , COUNT(A.EMPLOYEE_ID) REPORTS_COUNT, ROUND(AVG(A.AGE),0) AVERAGE_AGE FROM EMPLOYEES A LEFT JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY 1 HAVING EMPLOYEE_ID IS NOT NULL ORDER BY 1"
140,Y,Y,"SELECT A.REPORTS_TO AS EMPLOYEE_ID, B.NAME , COUNT(A.EMPLOYEE_ID) REPORTS_COUNT, ROUND(AVG(A.AGE),0) AVERAGE_AGE FROM EMPLOYEES A LEFT JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY A.REPORTS_TO HAVING EMPLOYEE_ID IS NOT NULL ORDER BY A.REPORTS_TO"
141,Y,Y,"SELECT A.REPORTS_TO AS EMPLOYEE_ID, B.NAME AS NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(A.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A INNER JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
142,Y,Y,"SELECT A.REPORTS_TO AS EMPLOYEE_ID, B.NAME AS NAME, COUNT(B.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(A.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO=B.EMPLOYEE_ID GROUP BY A.REPORTS_TO HAVING COUNT(A.REPORTS_TO)>=1 ORDER BY B.EMPLOYEE_ID"
143,Y,Y,"SELECT A.REPORTS_TO AS EMPLOYEE_ID, B.NAME AS NAME, COUNT(DISTINCT A.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(A.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A INNER JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
144,Y,Y,"SELECT A.REPORTS_TO AS EMPLOYEE_ID, B.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(A.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES A INNER JOIN EMPLOYEES B ON A.REPORTS_TO=B.EMPLOYEE_ID GROUP BY A.REPORTS_TO ORDER BY A.REPORTS_TO"
145,Y,Y,"SELECT A.REPORTS_TO AS EMPLOYEE_ID, B.NAME, COUNT(A.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(A.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES AS A LEFT JOIN EMPLOYEES AS B ON A.REPORTS_TO = B.EMPLOYEE_ID WHERE A.REPORTS_TO IS NOT NULL GROUP BY 1,2 ORDER BY 1"
146,Y,Y,"SELECT A.REPORTS_TO AS EMPLOYEE_ID, B.NAME, COUNT(A.NAME) AS REPORTS_COUNT, ROUND(AVG(A.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO=B.EMPLOYEE_ID GROUP BY 1,2 ORDER BY 1,2"
147,Y,Y,"SELECT A.REPORTS_TO AS EMPLOYEE_ID, B.NAME, COUNT(DISTINCT A.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(A.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY 1 HAVING REPORTS_COUNT >= 1"
148,Y,Y,"SELECT A.REPORTS_TO AS EMPLOYEE_ID, B.NAME, COUNT(DISTINCT A.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(A.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
149,Y,Y,"SELECT A.REPORTS_TO AS EMPLOYEE_ID, B.NAME, COUNT(DISTINCT A.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(A.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY 1 ORDER BY 1"
150,Y,Y,"SELECT A.REPORTS_TO AS EMPLOYEE_ID, B.NAME, COUNT(DISTINCT A.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(A.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES A LEFT JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID WHERE A.REPORTS_TO IS NOT NULL GROUP BY 1,2"
151,Y,Y,"SELECT B.EMPLOYEE_ID AS EMPLOYEE_ID, B.NAME AS NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(A.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A, EMPLOYEES B WHERE A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY B.EMPLOYEE_ID ORDER BY B.EMPLOYEE_ID"
152,Y,Y,"SELECT B.EMPLOYEE_ID AS EMPLOYEE_ID, B.NAME AS NAME, COUNT(A.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(A.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY 1,2 ORDER BY EMPLOYEE_ID"
153,Y,Y,"SELECT B.EMPLOYEE_ID, B.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(A.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A, EMPLOYEES B WHERE A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY B.EMPLOYEE_ID ORDER BY B.EMPLOYEE_ID"
154,Y,Y,"SELECT B.EMPLOYEE_ID, B.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(A.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A, EMPLOYEES B WHERE A.REPORTS_TO=B.EMPLOYEE_ID GROUP BY A.REPORTS_TO ORDER BY B.EMPLOYEE_ID"
155,Y,Y,"SELECT B.EMPLOYEE_ID, B.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(A.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES A INNER JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID WHERE B.EMPLOYEE_ID IS NOT NULL GROUP BY 1 ORDER BY 1"
156,Y,Y,"SELECT B.EMPLOYEE_ID, B.NAME, COUNT(A.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(A.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO=B.EMPLOYEE_ID GROUP BY 1 ORDER BY 1"
157,Y,Y,"SELECT B.EMPLOYEE_ID, B.NAME, COUNT(A.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(A.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES A INNER JOIN EMPLOYEES B ON A.REPORTS_TO=B.EMPLOYEE_ID GROUP BY 1, 2 ORDER BY 1"
158,Y,Y,"SELECT B.EMPLOYEE_ID,B.NAME,COUNT(*)REPORTS_COUNT,IFNULL(ROUND(AVG(E.AGE)),0)AVERAGE_AGE FROM EMPLOYEES B JOIN EMPLOYEES E ON B.EMPLOYEE_ID = E.REPORTS_TO GROUP BY 1 ORDER BY 1"
159,Y,Y,"SELECT B.REPORTS_TO EMPLOYEE_ID, A.NAME NAME, COUNT(B.EMPLOYEE_ID) REPORTS_COUNT, ROUND(AVG(B.AGE),0) AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.EMPLOYEE_ID=B.REPORTS_TO GROUP BY B.REPORTS_TO, A.NAME ORDER BY 1"
160,Y,Y,"SELECT D.EMPLOYEE_ID, D.NAME, COUNT(E.EMPLOYEE_ID) REPORTS_COUNT, ROUND(AVG(E.AGE)) AVERAGE_AGE FROM EMPLOYEES E JOIN EMPLOYEES D ON E.REPORTS_TO = D.EMPLOYEE_ID GROUP BY D.EMPLOYEE_ID, D.NAME ORDER BY 1"
161,Y,Y,"SELECT DISTINCT E.EMPLOYEE_ID,E.NAME, COUNT(E.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E1.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E, EMPLOYEES E1 WHERE E.EMPLOYEE_ID=E1.REPORTS_TO GROUP BY E.EMPLOYEE_ID ORDER BY E.EMPLOYEE_ID"
162,Y,Y,"SELECT DISTINCT A.REPORTS_TO AS EMPLOYEE_ID, B.NAME, COUNT(A.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(A.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO = B. EMPLOYEE_ID WHERE A.REPORTS_TO IS NOT NULL GROUP BY A.REPORTS_TO ORDER BY A.REPORTS_TO"
163,Y,Y,"SELECT DISTINCT E.REPORTS_TO AS EMPLOYEE_ID,E1.NAME,COUNT(E1.EMPLOYEE_ID) AS REPORTS_COUNT,ROUND(AVG(E.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E ON E1.EMPLOYEE_ID=E.REPORTS_TO GROUP BY E.REPORTS_TO HAVING COUNT(E.REPORTS_TO)>=1 ORDER BY E1.EMPLOYEE_ID"
164,Y,Y,"SELECT DISTINCT E1.EMPLOYEE_ID, E1.NAME, COUNT(E2.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(E2.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 LEFT JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO WHERE E2.NAME IS NOT NULL GROUP BY E1.EMPLOYEE_ID ORDER BY 1"
165,Y,Y,"SELECT DISTINCT E2.EMPLOYEE_ID, E2.NAME, COUNT(E1.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E1.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY 1, 2 ORDER BY EMPLOYEE_ID"
166,Y,Y,"SELECT E.EMPLOYEE_ID AS EMPLOYEE_ID, E.NAME AS NAME, COUNT(M.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(M.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E , EMPLOYEES M WHERE E.EMPLOYEE_ID = M.REPORTS_TO GROUP BY E.EMPLOYEE_ID ORDER BY E.EMPLOYEE_ID"
167,Y,Y,"SELECT E.EMPLOYEE_ID EMPLOYEE_ID, E.NAME NAME, COUNT(*) REPORTS_COUNT, ROUND(AVG(E2.AGE)) AVERAGE_AGE FROM EMPLOYEES E JOIN EMPLOYEES E2 ON E.EMPLOYEE_ID=E2.REPORTS_TO GROUP BY E2.REPORTS_TO ORDER BY E.EMPLOYEE_ID"
168,Y,Y,"SELECT E.EMPLOYEE_ID EMPLOYEE_ID,E.NAME NAME ,COUNT(B.EMPLOYEE_ID) REPORTS_COUNT,ROUND(AVG(B.AGE),0) AVERAGE_AGE FROM EMPLOYEES E JOIN EMPLOYEES B ON B.REPORTS_TO=E.EMPLOYEE_ID GROUP BY 1 ORDER BY 1"
169,Y,Y,"SELECT E.EMPLOYEE_ID, E.NAME, (SELECT COUNT(*) FROM EMPLOYEES R1 WHERE R1.REPORTS_TO=E.EMPLOYEE_ID GROUP BY R1.REPORTS_TO) REPORTS_COUNT, (SELECT ROUND(AVG(AGE)) FROM EMPLOYEES R2 WHERE R2.REPORTS_TO=E.EMPLOYEE_ID GROUP BY R2.REPORTS_TO) AVERAGE_AGE FROM EMPLOYEES E WHERE E.EMPLOYEE_ID IN ( SELECT REPORTS_TO FROM EMPLOYEES R3 WHERE R3.REPORTS_TO=E.EMPLOYEE_ID ) ORDER BY E.EMPLOYEE_ID"
170,Y,Y,"SELECT E.EMPLOYEE_ID, E.NAME, CNT AS REPORTS_COUNT, ROUND(AAGE,0) AS AVERAGE_AGE FROM EMPLOYEES E JOIN (SELECT DISTINCT REPORTS_TO, COUNT(REPORTS_TO) AS CNT, AVG(AGE) AS AAGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY 1) A ON E.EMPLOYEE_ID = A.REPORTS_TO ORDER BY E.EMPLOYEE_ID"
171,Y,Y,"SELECT E.EMPLOYEE_ID, E.NAME, COUNT(1) AS REPORTS_COUNT, ROUND(AVG(R.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES R JOIN EMPLOYEES E ON R.REPORTS_TO = E.EMPLOYEE_ID GROUP BY 1 ORDER BY 1"
172,Y,Y,"SELECT E.EMPLOYEE_ID, E.NAME, COUNT(DISTINCT R.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(R.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES E JOIN EMPLOYEES R ON E.EMPLOYEE_ID = R.REPORTS_TO GROUP BY EMPLOYEE_ID"
173,Y,Y,"SELECT E.EMPLOYEE_ID, E.NAME, COUNT(DISTINCT R.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(R.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES AS E LEFT JOIN EMPLOYEES AS R ON R.REPORTS_TO = E.EMPLOYEE_ID WHERE R.EMPLOYEE_ID IS NOT NULL GROUP BY 1, 2 ORDER BY 1"
174,Y,Y,"SELECT E.EMPLOYEE_ID, E.NAME, COUNT(E1.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E1.AGE) )AS AVERAGE_AGE FROM EMPLOYEES E JOIN EMPLOYEES E1 ON E.EMPLOYEE_ID=E1.REPORTS_TO GROUP BY 1 ORDER BY 1"
175,Y,Y,"SELECT E.EMPLOYEE_ID, E.NAME, COUNT(M.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(M.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E, EMPLOYEES M WHERE M.REPORTS_TO = E.EMPLOYEE_ID GROUP BY M.REPORTS_TO ORDER BY E.EMPLOYEE_ID"
176,Y,Y,"SELECT E.EMPLOYEE_ID, E.NAME, COUNT(M.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(M.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E INNER JOIN EMPLOYEES M ON E.EMPLOYEE_ID=M.REPORTS_TO WHERE M.REPORTS_TO IS NOT NULL GROUP BY M.REPORTS_TO ORDER BY 1"
177,Y,Y,"SELECT E.EMPLOYEE_ID, E.NAME, R.REPORTS_COUNT, R.AVERAGE_AGE FROM (SELECT REPORTS_TO, COUNT(REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IN (SELECT EMPLOYEE_ID FROM EMPLOYEES) GROUP BY REPORTS_TO) R LEFT JOIN EMPLOYEES E ON E.EMPLOYEE_ID = R.REPORTS_TO ORDER BY E.EMPLOYEE_ID"
178,Y,Y,"SELECT E.EMPLOYEE_ID,E.NAME,COUNT(DISTINCT F.EMPLOYEE_ID) AS REPORTS_COUNT,ROUND(AVG(F.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E JOIN EMPLOYEES F ON E.EMPLOYEE_ID = F.REPORTS_TO GROUP BY E.EMPLOYEE_ID,E.NAME ORDER BY EMPLOYEE_ID"
179,Y,Y,"SELECT E.REPORTS_TO AS EMPLOYEE_ID, M.NAME AS NAME, COUNT(DISTINCT E.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E JOIN EMPLOYEES M ON E.REPORTS_TO = M.EMPLOYEE_ID GROUP BY E.REPORTS_TO ORDER BY E.REPORTS_TO"
180,Y,Y,"SELECT E.REPORTS_TO AS EMPLOYEE_ID,EE.NAME AS NAME,COUNT(*)AS REPORTS_COUNT,ROUND(AVG(E.AGE))AVERAGE_AGE FROM EMPLOYEES E JOIN EMPLOYEES EE ON E.REPORTS_TO = EE.EMPLOYEE_ID GROUP BY EE.EMPLOYEE_ID ORDER BY EE.EMPLOYEE_ID"
181,Y,Y,"SELECT E.REPORTS_TO EMPLOYEE_ID, M.NAME NAME, COUNT(E.EMPLOYEE_ID) REPORTS_COUNT, ROUND(AVG(E.AGE)) AVERAGE_AGE FROM EMPLOYEES E JOIN EMPLOYEES M ON E.REPORTS_TO=M.EMPLOYEE_ID GROUP BY 1 ORDER BY 1"
182,Y,Y,"SELECT E1.EMPLOYEE_ID , E1.NAME ,COUNT(*) AS REPORTS_COUNT ,ROUND(AVG(E2.AGE)) AS AVERAGE_AGE FROM EMPLOYEES AS E1 JOIN EMPLOYEES AS E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID ORDER BY E1.EMPLOYEE_ID"
183,Y,Y,"SELECT E1.EMPLOYEE_ID , E1.NAME ,COUNT(E2.REPORTS_TO)AS REPORTS_COUNT , ROUND(AVG(E2.AGE)) AS AVERAGE_AGE FROM EMPLOYEES AS E1 JOIN EMPLOYEES AS E2 ON (E1.EMPLOYEE_ID = E2.REPORTS_TO) GROUP BY E1.EMPLOYEE_ID ORDER BY E1.EMPLOYEE_ID"
184,Y,Y,"SELECT E1.EMPLOYEE_ID AS EMPLOYEE_ID, E1.NAME AS NAME, COUNT(E2.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E2.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E2.REPORTS_TO=E1.EMPLOYEE_ID GROUP BY 1,2 ORDER BY 1"
185,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E2.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E2.REPORTS_TO = E1.EMPLOYEE_ID GROUP BY 1 ORDER BY 1"
186,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(*) REPORTS_COUNT, ROUND(AVG(E2.AGE),0) AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID, E1.NAME HAVING COUNT(*) > 0 ORDER BY EMPLOYEE_ID"
187,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(*)AS REPORTS_COUNT, ROUND(AVG(E2.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E2.REPORTS_TO = E1.EMPLOYEE_ID GROUP BY 1 ORDER BY 1"
188,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(DISTINCT E2.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E2.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 INNER JOIN EMPLOYEES E2 ON E2.REPORTS_TO = E1.EMPLOYEE_ID GROUP BY 1,2 ORDER BY 1"
189,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(E1.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E2.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES AS E1 JOIN EMPLOYEES AS E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY E2.REPORTS_TO ORDER BY E1.EMPLOYEE_ID"
190,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(E1.EMPLOYEE_ID=E2.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(E2.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID=E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID ORDER BY E1.EMPLOYEE_ID"
191,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(E2.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E2.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 INNER JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID ORDER BY E1.EMPLOYEE_ID"
192,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(E2.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E2.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES AS E1 JOIN EMPLOYEES AS E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY 1, 2 ORDER BY 1"
193,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(E2.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E2.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E2.REPORTS_TO = E1.EMPLOYEE_ID GROUP BY E1.EMPLOYEE_ID ORDER BY E1.EMPLOYEE_ID"
194,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(E2.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E2.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E2.REPORTS_TO = E1.EMPLOYEE_ID GROUP BY 1 ORDER BY 1"
195,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(E2.EMPLOYEE_ID) REPORTS_COUNT, ROUND(AVG(E2.AGE)) AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E2.REPORTS_TO = E1.EMPLOYEE_ID GROUP BY E1.EMPLOYEE_ID ORDER BY 1"
196,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(E2.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(E2.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 INNER JOIN EMPLOYEES E2 ON E2.REPORTS_TO = E1.EMPLOYEE_ID GROUP BY E1.EMPLOYEE_ID, E1.NAME ORDER BY E1.EMPLOYEE_ID"
197,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(E2.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(E2.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID=E2.REPORTS_TO GROUP BY 1,2 ORDER BY 1"
198,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(E2.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(E2.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E2.REPORTS_TO = E1.EMPLOYEE_ID GROUP BY E1.EMPLOYEE_ID ORDER BY E1.EMPLOYEE_ID"
199,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(E2.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(E2.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 INNER JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY 1,2 ORDER BY 1"
200,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, E2.REPORTS_COUNT, E2.AVERAGE_AGE FROM EMPLOYEES E1 JOIN (SELECT COUNT(NAME) AS REPORTS_COUNT,REPORTS_TO, ROUND(AVG(AGE)) AS AVERAGE_AGE FROM EMPLOYEES GROUP BY REPORTS_TO) E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO ORDER BY E1.EMPLOYEE_ID"
201,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, SUM(CASE WHEN E2.REPORTS_TO IS NOT NULL THEN 1 END) AS REPORTS_COUNT, ROUND(AVG(E2.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 INNER JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID, E1.NAME ORDER BY E1.EMPLOYEE_ID"
202,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME,COUNT(E2.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(E2.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY 1,2 ORDER BY E1.EMPLOYEE_ID"
203,Y,Y,"SELECT E1.EMPLOYEE_ID, IFNULL(E1.NAME, 0) AS NAME, IFNULL(COUNT(E2.REPORTS_TO),0) AS REPORTS_COUNT, IFNULL(ROUND(AVG(E2.AGE)),0) AS AVERAGE_AGE FROM EMPLOYEES E1, EMPLOYEES E2 WHERE E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID ORDER BY E1.EMPLOYEE_ID"
204,Y,Y,"SELECT E1.EMPLOYEE_ID,E1.NAME, COUNT(E2.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(E2.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID=E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID, E1.NAME ORDER BY E1.EMPLOYEE_ID"
205,Y,Y,"SELECT E1.EMPLOYEE_ID,E1.NAME,COUNT(E1.EMPLOYEE_ID)AS REPORTS_COUNT, ROUND(AVG(E2.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 INNER JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID=E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID ORDER BY E1.EMPLOYEE_ID"
206,Y,Y,"SELECT E1.EMPLOYEE_ID,E1.NAME,ROUND(COUNT(E2.EMPLOYEE_ID)) REPORTS_COUNT, ROUND(AVG(E2.AGE)) AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID ORDER BY E1.EMPLOYEE_ID"
207,Y,Y,"SELECT E1.EMPLOYEE_ID,E1.NAME,ROUND(COUNT(M.EMPLOYEE_ID)) REPORTS_COUNT, ROUND(AVG(M.AGE)) AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES M ON E1.EMPLOYEE_ID = M.REPORTS_TO GROUP BY E1.EMPLOYEE_ID ORDER BY E1.EMPLOYEE_ID"
208,Y,Y,"SELECT E1.REPORTS_TO AS EMPLOYEE_ID , E2.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E1.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 LEFT JOIN EMPLOYEES E2 ON(E1.REPORTS_TO=E2.EMPLOYEE_ID) WHERE E1.REPORTS_TO IS NOT NULL GROUP BY E1.REPORTS_TO ORDER BY E1.REPORTS_TO"
209,Y,Y,"SELECT E1.REPORTS_TO AS EMPLOYEE_ID, E2.NAME AS NAME, COUNT(E1.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E1.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID WHERE E1.REPORTS_TO IS NOT NULL GROUP BY 1 ORDER BY 1"
210,Y,Y,"SELECT E1.REPORTS_TO AS EMPLOYEE_ID, E2.NAME AS NAME, COUNT(E1.NAME) AS REPORTS_COUNT, ROUND(AVG(E1.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES AS E1 JOIN EMPLOYEES AS E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
211,Y,Y,"SELECT E1.REPORTS_TO AS EMPLOYEE_ID, E2.NAME AS NAME, COUNT(E1.NAME) AS REPORTS_COUNT, ROUND(AVG(E1.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID WHERE E1.REPORTS_TO IS NOT NULL GROUP BY 1 ORDER BY 1"
212,Y,Y,"SELECT E1.REPORTS_TO AS EMPLOYEE_ID, E2.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E1.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY 1, 2 ORDER BY 1"
213,Y,Y,"SELECT E1.REPORTS_TO AS EMPLOYEE_ID, E2.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E1.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY 1,2 ORDER BY 1,2"
214,Y,Y,"SELECT E1.REPORTS_TO AS EMPLOYEE_ID, E2.NAME, COUNT(DISTINCT E1.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E1.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 LEFT JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID WHERE E1.REPORTS_TO IS NOT NULL GROUP BY 1,2 ORDER BY 1"
215,Y,Y,"SELECT E1.REPORTS_TO AS EMPLOYEE_ID, E2.NAME, COUNT(E1.NAME) AS REPORTS_COUNT, ROUND(AVG(E1.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES AS E1 JOIN EMPLOYEES AS E2 ON E1.REPORTS_TO=E2.EMPLOYEE_ID WHERE E1.REPORTS_TO IS NOT NULL GROUP BY E1.REPORTS_TO ORDER BY EMPLOYEE_ID"
216,Y,Y,"SELECT E1.REPORTS_TO AS EMPLOYEE_ID, E2.NAME, COUNT(E1.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(E1.AGE)) AS AVERAGE_AGE FROM EMPLOYEES AS E1 JOIN EMPLOYEES AS E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY E1.REPORTS_TO ORDER BY E1.REPORTS_TO"
217,Y,Y,"SELECT E1.REPORTS_TO AS EMPLOYEE_ID, E2.NAME, COUNT(E1.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(E1.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.REPORTS_TO=E2.EMPLOYEE_ID GROUP BY E1.REPORTS_TO ORDER BY E1.REPORTS_TO"
218,Y,Y,"SELECT E1.REPORTS_TO AS EMPLOYEE_ID, E2.NAME, COUNT(E2.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E1.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 INNER JOIN EMPLOYEES E2 ON E1.REPORTS_TO=E2.EMPLOYEE_ID GROUP BY EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
219,Y,Y,"SELECT E1.REPORTS_TO AS EMPLOYEE_ID, E2.NAME, COUNT(E2.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E1.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1, EMPLOYEES E2 WHERE E1.REPORTS_TO=E2.EMPLOYEE_ID GROUP BY E1.REPORTS_TO ORDER BY E1.REPORTS_TO"
220,Y,Y,"SELECT E1.REPORTS_TO AS EMPLOYEE_ID, E2.NAME,COUNT(E1.REPORTS_TO)AS REPORTS_COUNT, ROUND(AVG(E1.AGE))AS AVERAGE_AGE FROM EMPLOYEES E1 LEFT JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID WHERE E1.REPORTS_TO IS NOT NULL GROUP BY 1 ORDER BY 1"
221,Y,Y,"SELECT E1.REPORTS_TO AS EMPLOYEE_ID,E2.NAME,COUNT(DISTINCT E1.EMPLOYEE_ID)AS REPORTS_COUNT, ROUND(AVG(E1.AGE))AS AVERAGE_AGE FROM EMPLOYEES E1 LEFT JOIN EMPLOYEES E2 ON E1.REPORTS_TO=E2.EMPLOYEE_ID WHERE E1.REPORTS_TO IS NOT NULL GROUP BY 1 ORDER BY 1"
222,Y,Y,"SELECT E1.REPORTS_TO AS EMPLOYEE_ID,E2.NAME,COUNT(E1.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E1.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES AS E1 LEFT JOIN EMPLOYEES AS E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY E1.REPORTS_TO HAVING E1.REPORTS_TO IS NOT NULL ORDER BY EMPLOYEE_ID"
223,Y,Y,"SELECT E1.REPORTS_TO EMPLOYEE_ID, E2.NAME NAME, COUNT(E1.EMPLOYEE_ID) REPORTS_COUNT, ROUND(AVG(E1.AGE),0) AVERAGE_AGE FROM EMPLOYEES E1 LEFT JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID WHERE E1.REPORTS_TO IS NOT NULL GROUP BY 1 ORDER BY 1"
224,Y,Y,"SELECT E2.EMPLOYEE_ID AS EMPLOYEE_ID, E2.NAME AS NAME, COUNT(E1.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(E1.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 , EMPLOYEES E2 WHERE E2.EMPLOYEE_ID = E1.REPORTS_TO GROUP BY E2.EMPLOYEE_ID ORDER BY E2.EMPLOYEE_ID"
225,Y,Y,"SELECT E2.EMPLOYEE_ID, E2.NAME AS NAME, COUNT(E1.NAME) AS REPORTS_COUNT, ROUND(AVG(E1.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E2.EMPLOYEE_ID=E1.REPORTS_TO GROUP BY 1 ORDER BY 1"
226,Y,Y,"SELECT E2.EMPLOYEE_ID, E2.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E1.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.REPORTS_TO=E2.EMPLOYEE_ID GROUP BY E2.EMPLOYEE_ID ORDER BY 1"
227,Y,Y,"SELECT E2.EMPLOYEE_ID, E2.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E1.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES AS E1, EMPLOYEES AS E2 WHERE E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY 1 ORDER BY 1"
228,Y,Y,"SELECT E2.EMPLOYEE_ID, E2.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E1.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY 1 ORDER BY 1"
229,Y,Y,"SELECT E2.EMPLOYEE_ID, E2.NAME, COUNT(DISTINCT E1.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E1.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES E1 LEFT JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID WHERE E1.REPORTS_TO IS NOT NULL GROUP BY 1,2 ORDER BY 1"
230,Y,Y,"SELECT E2.EMPLOYEE_ID, E2.NAME, COUNT(E1.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND((AVG(E1.AGE))) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY E2.EMPLOYEE_ID ORDER BY E2.EMPLOYEE_ID"
231,Y,Y,"SELECT E2.EMPLOYEE_ID, E2.NAME, COUNT(E1.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(E1.AGE)) AS AVERAGE_AGE FROM EMPLOYEES AS E1 JOIN EMPLOYEES AS E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY E2.EMPLOYEE_ID ORDER BY E2.EMPLOYEE_ID"
232,Y,Y,"SELECT E2.EMPLOYEE_ID, E2.NAME, COUNT(E1.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(E1.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E2.EMPLOYEE_ID=E1.REPORTS_TO GROUP BY 1 ORDER BY 1"
233,Y,Y,"SELECT E2.EMPLOYEE_ID, E2.NAME, COUNT(E1.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(E1.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1, EMPLOYEES E2 WHERE E2.EMPLOYEE_ID=E1.REPORTS_TO GROUP BY E2.EMPLOYEE_ID ORDER BY E2.EMPLOYEE_ID"
234,Y,Y,"SELECT E2.EMPLOYEE_ID,E2.NAME, COUNT(E1.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E1.AGE),0) AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY E2.EMPLOYEE_ID ORDER BY E2.EMPLOYEE_ID"
235,Y,Y,"SELECT E2.REPORTS_TO AS EMPLOYEE_ID, E1.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E2.AGE)) AS AVERAGE_AGE FROM EMPLOYEES AS E1 JOIN EMPLOYEES AS E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY E2.REPORTS_TO ORDER BY E2.REPORTS_TO"
236,Y,Y,"SELECT E2.REPORTS_TO AS EMPLOYEE_ID, NAME, REPORTS_COUNT, ROUND(AVERAGE_AGE,0) AS AVERAGE_AGE FROM EMPLOYEES E1 INNER JOIN ( SELECT REPORTS_TO, COUNT(EMPLOYEE_ID) AS REPORTS_COUNT, AVG(AGE) AS AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO) E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO ORDER BY 1"
237,Y,Y,"SELECT EMPLOYEE_ID, NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(AGE),0) AS AVERAGE_AGE FROM ( SELECT E1.EMPLOYEE_ID, E1.NAME, E2.AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO AND E1.EMPLOYEE_ID IS NOT NULL AND E2.REPORTS_TO IS NOT NULL ) A GROUP BY 1,2 ORDER BY 1"
238,Y,Y,"SELECT EMPLOYEE_ID, NAME, COUNT(DISTINCT ID) AS REPORTS_COUNT, ROUND(AVG(AGE),0) AS AVERAGE_AGE FROM (SELECT A.EMPLOYEE_ID, B.EMPLOYEE_ID AS ID,A.NAME,B.AGE FROM EMPLOYEES A INNER JOIN EMPLOYEES B ON A.EMPLOYEE_ID=B.REPORTS_TO) C GROUP BY EMPLOYEE_ID,NAME"
239,Y,Y,"SELECT M.EMPLOYEE_ID , M.NAME , COUNT(E.EMPLOYEE_ID) REPORTS_COUNT, ROUND(AVG(E.AGE)) AVERAGE_AGE FROM EMPLOYEES E , EMPLOYEES M WHERE E.REPORTS_TO = M.EMPLOYEE_ID GROUP BY M.EMPLOYEE_ID ORDER BY 1"
240,Y,Y,"SELECT M.EMPLOYEE_ID EMPLOYEE_ID, M.NAME NAME, COUNT(*) REPORTS_COUNT, ROUND(AVG(E.AGE), 0) AVERAGE_AGE FROM EMPLOYEES M INNER JOIN EMPLOYEES E ON E.REPORTS_TO = M.EMPLOYEE_ID GROUP BY M.EMPLOYEE_ID ORDER BY M.EMPLOYEE_ID"
241,Y,Y,"SELECT M.EMPLOYEE_ID, M.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E.AGE)) AS AVERAGE_AGE FROM EMPLOYEES M, EMPLOYEES E WHERE E.REPORTS_TO = M.EMPLOYEE_ID GROUP BY M.EMPLOYEE_ID ORDER BY M.EMPLOYEE_ID"
242,Y,Y,"SELECT M.EMPLOYEE_ID, M.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E, EMPLOYEES M WHERE E.REPORTS_TO=M.EMPLOYEE_ID GROUP BY 1 HAVING COUNT(DISTINCT E.NAME) >= 1"
243,Y,Y,"SELECT M.EMPLOYEE_ID, M.NAME, COUNT(DISTINCT E.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E.AGE)) AS AVERAGE_AGE FROM EMPLOYEES M JOIN EMPLOYEES E ON E.REPORTS_TO = M.EMPLOYEE_ID GROUP BY 1"
244,Y,Y,"SELECT M.EMPLOYEE_ID, M.NAME, COUNT(DISTINCT E.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E.AGE)) AS AVERAGE_AGE FROM EMPLOYEES M JOIN EMPLOYEES E ON E.REPORTS_TO = M.EMPLOYEE_ID GROUP BY 1 ORDER BY 1"
245,Y,Y,"SELECT M.EMPLOYEE_ID, M.NAME, COUNT(E.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES E INNER JOIN EMPLOYEES M ON E.REPORTS_TO = M.EMPLOYEE_ID GROUP BY M.EMPLOYEE_ID ORDER BY M.EMPLOYEE_ID"
246,Y,Y,"SELECT M.EMPLOYEE_ID, M.NAME, COUNT(M.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E JOIN EMPLOYEES M ON E.REPORTS_TO = M.EMPLOYEE_ID GROUP BY M.EMPLOYEE_ID HAVING COUNT(*)>=1 ORDER BY 1"
247,Y,Y,"SELECT M.EMPLOYEE_ID, M.NAME, COUNT(R.REPORTS_TO) AS REPORTS_COUNT,ROUND(AVG(R.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES M JOIN EMPLOYEES R ON M.EMPLOYEE_ID = R.REPORTS_TO GROUP BY M.EMPLOYEE_ID ORDER BY M.EMPLOYEE_ID"
248,Y,Y,"SELECT M.EMPLOYEE_ID, M.NAME,COUNT(E.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(E.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES M, EMPLOYEES E WHERE M.EMPLOYEE_ID = E.REPORTS_TO GROUP BY 1 ORDER BY 1"
249,Y,Y,"SELECT M.EMPLOYEE_ID, M.NAME,COUNT(E.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(E.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES M, EMPLOYEES E WHERE M.EMPLOYEE_ID = E.REPORTS_TO GROUP BY E.REPORTS_TO ORDER BY 1"
250,Y,Y,"SELECT M.EMPLOYEE_ID,M.NAME, COUNT(M.EMPLOYEE_ID) REPORTS_COUNT,ROUND(AVG(E.AGE)) AVERAGE_AGE FROM EMPLOYEES E JOIN EMPLOYEES M ON E.REPORTS_TO=M.EMPLOYEE_ID GROUP BY M.EMPLOYEE_ID,M.NAME ORDER BY EMPLOYEE_ID ASC"
251,Y,Y,"SELECT M.EMPLOYEE_ID,MAX(M.NAME) AS NAME, COUNT(E.EMPLOYEE_ID) AS REPORTS_COUNT , ROUND(AVG(E.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES AS M JOIN EMPLOYEES AS E ON M.EMPLOYEE_ID=E.REPORTS_TO GROUP BY M.EMPLOYEE_ID ORDER BY M.EMPLOYEE_ID"
252,Y,Y,"SELECT MANAGER_ID AS EMPLOYEE_ID, NAME, VAL AS REPORTS_COUNT, AVERAGE_AGE FROM EMPLOYEES E JOIN ( SELECT REPORTS_TO AS MANAGER_ID, COUNT(EMPLOYEE_ID) AS VAL, ROUND(AVG(AGE)) AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO) O ON E.EMPLOYEE_ID=O.MANAGER_ID ORDER BY EMPLOYEE_ID"
253,Y,Y,"SELECT MNG.EMPLOYEE_ID, MNG.NAME, COUNT(EE.NAME) AS REPORTS_COUNT, ROUND(AVG(EE.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES EE, EMPLOYEES MNG WHERE EE.REPORTS_TO = MNG. EMPLOYEE_ID GROUP BY MNG.EMPLOYEE_ID ORDER BY MNG.EMPLOYEE_ID"
254,Y,Y,"SELECT P1.REPORTS_TO AS EMPLOYEE_ID, P2.NAME, COUNT(P1.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(P1.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES AS P1 JOIN EMPLOYEES AS P2 ON P1.REPORTS_TO=P2.EMPLOYEE_ID GROUP BY P1.REPORTS_TO ORDER BY P1.REPORTS_TO"
255,Y,Y,"SELECT R1.REPORTS_TO AS EMPLOYEE_ID, NAME, REPORTS_COUNT, AVERAGE_AGE FROM ( SELECT REPORTS_TO, COUNT(EMPLOYEE_ID) REPORTS_COUNT, ROUND(AVG(AGE),0) AVERAGE_AGE FROM EMPLOYEES GROUP BY REPORTS_TO ) R1 JOIN EMPLOYEES ON R1.REPORTS_TO=EMPLOYEES.EMPLOYEE_ID ORDER BY 1"
256,Y,Y,"SELECT REPORTS_TO AS EMPLOYEE_ID, (SELECT E1.NAME FROM EMPLOYEES E1 WHERE E1.EMPLOYEE_ID = EMPLOYEES.REPORTS_TO) AS NAME, COUNT(EMPLOYEE_ID) REPORTS_COUNT, ROUND(SUM(AGE)/COUNT(EMPLOYEE_ID)) AS AVERAGE_AGE FROM EMPLOYEES GROUP BY REPORTS_TO HAVING REPORTS_TO IS NOT NULL ORDER BY EMPLOYEE_ID"
257,Y,Y,"SELECT REPORTS_TO AS EMPLOYEE_ID, MANAGERNAME AS NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(AGE),0) AS AVERAGE_AGE FROM ( SELECT E.*, M.NAME AS MANAGERNAME FROM EMPLOYEES E JOIN EMPLOYEES M ON E.REPORTS_TO = M.EMPLOYEE_ID WHERE E.REPORTS_TO IS NOT NULL )T1 GROUP BY REPORTS_TO, MANAGERNAME ORDER BY REPORTS_TO ASC"
258,Y,Y,"SELECT REPORTS_TO AS EMPLOYEE_ID, NAMEE AS NAME, COUNT(EMPLOYEE_ID) AS REPORTS_COUNT, ROUND( AVG(AGE) , 0) AS AVERAGE_AGE FROM ( SELECT E.* , E1.NAME AS NAMEE FROM EMPLOYEES E JOIN EMPLOYEES E1 ON E1.EMPLOYEE_ID = E.REPORTS_TO) T GROUP BY REPORTS_TO ORDER BY EMPLOYEE_ID"
259,Y,Y,"SELECT REPORTS_TO EMPLOYEE_ID, (SELECT B.NAME FROM EMPLOYEES B WHERE B.EMPLOYEE_ID=A.REPORTS_TO) NAME, COUNT(*) REPORTS_COUNT, ROUND(AVG(AGE), 0) AVERAGE_AGE FROM EMPLOYEES A WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO ORDER BY 1"
260,Y,Y,"SELECT T.EMPLOYEE_ID , T.NAME , COUNT(T.EMPLOYEE_ID) AS REPORTS_COUNT , ROUND(AVG(T.AGE)) AS AVERAGE_AGE FROM (SELECT L.EMPLOYEE_ID,L.NAME,R.AGE FROM EMPLOYEES L JOIN EMPLOYEES R ON L.EMPLOYEE_ID = R.REPORTS_TO) AS T GROUP BY T.EMPLOYEE_ID ORDER BY T.EMPLOYEE_ID"
261,Y,Y,"SELECT T.REPORTS_TO AS EMPLOYEE_ID, E.NAME AS NAME, T.REPORTS_COUNT, T.AVERAGE_AGE FROM (SELECT REPORTS_TO, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(AGE),0) AS AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO) T JOIN EMPLOYEES E ON T.REPORTS_TO = E.EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
262,Y,Y,"SELECT T1.EMPLOYEE_ID, NAME, REPORTS_COUNT, AVERAGE_AGE FROM (SELECT REPORTS_TO AS EMPLOYEE_ID, COUNT(1) AS REPORTS_COUNT, ROUND(AVG(AGE)) AS AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO) T1 JOIN EMPLOYEES T2 ON T1.EMPLOYEE_ID = T2.EMPLOYEE_ID ORDER BY T1.EMPLOYEE_ID"
263,Y,Y,"SELECT T1.EMPLOYEE_ID, T1.NAME, COUNT(T1.NAME) REPORTS_COUNT,ROUND(AVG(T1.AGE)) AVERAGE_AGE FROM (SELECT E1.EMPLOYEE_ID EMPLOYEE_ID, E1.NAME NAME,E2.NAME EMPLOYEE,E2.AGE AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID=E2.REPORTS_TO)T1 GROUP BY 1,2 ORDER BY 1"
264,Y,Y,"SELECT T1.EMPLOYEE_ID, T1.NAME, SUM(CASE WHEN T2.REPORTS_TO IS NOT NULL THEN 1 ELSE 0 END) AS REPORTS_COUNT, ROUND(AVG(T2.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES T1 JOIN EMPLOYEES T2 ON T1.EMPLOYEE_ID = T2.REPORTS_TO GROUP BY 1 ORDER BY 1"
265,Y,Y,"SELECT T2.EMPLOYEE_ID, T2.NAME, COUNT(*) REPORTS_COUNT, ROUND(AVG(T1.AGE)) AVERAGE_AGE FROM EMPLOYEES T1 JOIN EMPLOYEES T2 ON T1.REPORTS_TO = T2.EMPLOYEE_ID GROUP BY T2.EMPLOYEE_ID ORDER BY T2.EMPLOYEE_ID"
266,Y,Y,"SELECT TB1.EMPLOYEE_ID,TB1.NAME,COUNT(TB2.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(TB2.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES TB2 JOIN EMPLOYEES TB1 ON TB1.EMPLOYEE_ID=TB2.REPORTS_TO GROUP BY TB1.EMPLOYEE_ID,TB1.NAME ORDER BY TB1.EMPLOYEE_ID"
267,Y,Y,"WITH A AS (SELECT REPORTS_TO AS EMPLOYER, COUNT(EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO) SELECT EMPLOYEE_ID, NAME, REPORTS_COUNT, AVERAGE_AGE FROM EMPLOYEES, A WHERE EMPLOYEE_ID = EMPLOYER ORDER BY EMPLOYEE_ID"
268,Y,Y,"WITH CET AS (SELECT E.EMPLOYEE_ID, E.NAME, E.REPORTS_TO, M.NAME AS MANAGER_NAME, E.AGE FROM EMPLOYEES E LEFT JOIN EMPLOYEES M ON E.REPORTS_TO=M.EMPLOYEE_ID) SELECT REPORTS_TO AS EMPLOYEE_ID, MANAGER_NAME AS NAME, COUNT(REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(AGE)) AVERAGE_AGE FROM CET WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO, MANAGER_NAME ORDER BY 1"
269,Y,Y,"WITH CTE AS ( SELECT COUNT(NAME) AS REPORTS_COUNT, REPORTS_TO, ROUND(AVG(AGE),0) AS AVERAGE_AGE FROM EMPLOYEES GROUP BY REPORTS_TO) SELECT EMPLOYEE_ID, NAME, REPORTS_COUNT, AVERAGE_AGE FROM EMPLOYEES E JOIN CTE ON E.EMPLOYEE_ID = CTE.REPORTS_TO ORDER BY EMPLOYEE_ID"
270,Y,Y,"WITH CTE AS ( SELECT E.EMPLOYEE_ID, E.NAME AS EMPLOYEE_NAME, E.REPORTS_TO AS MANAGER_ID, M.NAME AS MANAGER, E.AGE AS EMPLOYEE_AGE FROM EMPLOYEES E JOIN EMPLOYEES M ON M.EMPLOYEE_ID = E.REPORTS_TO) SELECT MANAGER_ID AS EMPLOYEE_ID, MANAGER AS NAME , COUNT(EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(EMPLOYEE_AGE),0) AS AVERAGE_AGE FROM CTE GROUP BY 1,2 ORDER BY 1"
271,Y,Y,"WITH CTE AS ( SELECT REPORTS_TO AS EMPLOYEE_ID, COUNT(REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(AGE)) AS AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IN (SELECT DISTINCT EMPLOYEE_ID FROM EMPLOYEES) GROUP BY 1) SELECT CTE.EMPLOYEE_ID,E.NAME,CTE.REPORTS_COUNT, CTE.AVERAGE_AGE FROM EMPLOYEES E JOIN CTE ON E.EMPLOYEE_ID = CTE.EMPLOYEE_ID ORDER BY 1"
272,Y,Y,"WITH CTE AS ( SELECT REPORTS_TO, COUNT(DISTINCT EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES GROUP BY REPORTS_TO ) SELECT E.EMPLOYEE_ID, E.NAME, CTE.REPORTS_COUNT, CTE.AVERAGE_AGE FROM EMPLOYEES E JOIN CTE ON E.EMPLOYEE_ID = CTE.REPORTS_TO ORDER BY EMPLOYEE_ID"
273,Y,Y,"WITH CTE AS ( SELECT REPORTS_TO,COUNT(DISTINCT EMPLOYEE_ID) AS TOTAL, ROUND(AVG(AGE),0) AS AVERAGE_AGE FROM EMPLOYEES GROUP BY REPORTS_TO ) SELECT CTE.REPORTS_TO AS EMPLOYEE_ID,E.NAME,CTE.TOTAL AS REPORTS_COUNT, CTE.AVERAGE_AGE FROM CTE JOIN EMPLOYEES AS E ON CTE.REPORTS_TO=E.EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
274,Y,Y,"WITH CTE AS (SELECT REPORTS_TO , COUNT(EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(AGE)) AS AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO) SELECT A.EMPLOYEE_ID, A.NAME, REPORTS_COUNT, AVERAGE_AGE FROM CTE INNER JOIN EMPLOYEES A ON CTE.REPORTS_TO = A.EMPLOYEE_ID ORDER BY A.EMPLOYEE_ID"
275,Y,Y,"WITH CTE AS (SELECT REPORTS_TO , COUNT(EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(AGE)) AS AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO) SELECT EMPLOYEE_ID, NAME, REPORTS_COUNT, AVERAGE_AGE FROM CTE INNER JOIN EMPLOYEES A ON CTE.REPORTS_TO = A.EMPLOYEE_ID ORDER BY A.EMPLOYEE_ID"
276,Y,Y,"WITH CTE AS (SELECT REPORTS_TO , ROUND(AVG(AGE)) AS AVERAGE_AGE , COUNT(EMPLOYEE_ID) REPORTS_COUNT FROM EMPLOYEES AS MNG WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO) SELECT E.EMPLOYEE_ID , E.NAME , REPORTS_COUNT,AVERAGE_AGE FROM CTE JOIN EMPLOYEES AS E ON CTE.REPORTS_TO = E.EMPLOYEE_ID ORDER BY E.EMPLOYEE_ID"
277,Y,Y,"WITH CTE AS (SELECT REPORTS_TO, COUNT(EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(AGE)) AS AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO) SELECT C.REPORTS_TO AS EMPLOYEE_ID, E.NAME, C.REPORTS_COUNT, C.AVERAGE_AGE FROM EMPLOYEES E JOIN CTE C ON C.REPORTS_TO=E.EMPLOYEE_ID ORDER BY 1"
278,Y,Y,"WITH CTE AS (SELECT REPORTS_TO, COUNT(EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(AGE)) AS AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO) SELECT E.EMPLOYEE_ID, E.NAME, C.REPORTS_COUNT, C.AVERAGE_AGE FROM EMPLOYEES AS E JOIN CTE AS C ON E.EMPLOYEE_ID = C.REPORTS_TO ORDER BY E.EMPLOYEE_ID"
279,Y,Y,"WITH CTE AS( SELECT REPORTS_TO, COUNT(EMPLOYEE_ID)AS REPORTS_COUNT, ROUND(AVG(AGE),0) AS AVERAGE_AGE FROM EMPLOYEES GROUP BY REPORTS_TO) SELECT E.EMPLOYEE_ID, E.NAME, CTE.REPORTS_COUNT, CTE.AVERAGE_AGE FROM EMPLOYEES E INNER JOIN CTE ON E.EMPLOYEE_ID = CTE.REPORTS_TO WHERE CTE.REPORTS_TO IS NOT NULL ORDER BY EMPLOYEE_ID"
280,Y,Y,"WITH CTE AS(SELECT A.EMPLOYEE_ID,A.NAME,B.AGE FROM EMPLOYEES A LEFT JOIN EMPLOYEES B ON A.EMPLOYEE_ID=B.REPORTS_TO) SELECT EMPLOYEE_ID,NAME,COUNT(AGE) AS REPORTS_COUNT, ROUND(AVG(AGE),0) AS AVERAGE_AGE FROM CTE WHERE AGE IS NOT NULL GROUP BY 1 ORDER BY 1"
281,Y,Y,"WITH CTE1 AS(SELECT EMPLOYEE_ID, NAME FROM EMPLOYEES), CTE2 AS (SELECT REPORTS_TO, COUNT(*) OVER(PARTITION BY REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(AGE) OVER(PARTITION BY REPORTS_TO),0) AS AVERAGE_AGE FROM EMPLOYEES), CTE3 AS (SELECT DISTINCT REPORTS_TO, REPORTS_COUNT, AVERAGE_AGE FROM CTE2 WHERE REPORTS_TO IS NOT NULL) SELECT T2.EMPLOYEE_ID, T2.NAME, T1.REPORTS_COUNT, T1.AVERAGE_AGE FROM CTE3 T1 LEFT JOIN CTE1 T2 ON T1.REPORTS_TO=T2.EMPLOYEE_ID"
282,Y,Y,"WITH MANAGER_INFO AS ( SELECT REPORTS_TO,COUNT(DISTINCT EMPLOYEE_ID) AS REPORTS_COUNT,ROUND(AVG(AGE),0) AS AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO ) SELECT M.REPORTS_TO EMPLOYEE_ID,E.NAME,M.REPORTS_COUNT,M.AVERAGE_AGE FROM MANAGER_INFO M INNER JOIN EMPLOYEES E ON E.EMPLOYEE_ID=M.REPORTS_TO ORDER BY M.REPORTS_TO"
283,Y,Y,"WITH NEW AS (SELECT E1.EMPLOYEE_ID, E2.NAME, E1.REPORTS_TO, E1.AGE FROM EMPLOYEES E1 LEFT JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID) SELECT REPORTS_TO AS EMPLOYEE_ID, NAME, COUNT(*) REPORTS_COUNT, ROUND(AVG(AGE),0) AVERAGE_AGE FROM NEW WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO ORDER BY EMPLOYEE_ID"
284,Y,Y,"WITH RPT_INFO AS ( SELECT REPORTS_TO AS MGR_ID, COUNT(*) AS CT, AVG(AGE) AS AVG_AGE FROM EMPLOYEES GROUP BY REPORTS_TO ) SELECT RI.MGR_ID AS EMPLOYEE_ID, E.NAME, RI.CT AS REPORTS_COUNT, ROUND(RI.AVG_AGE) AS AVERAGE_AGE FROM RPT_INFO AS RI INNER JOIN EMPLOYEES AS E ON RI.MGR_ID = E.EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
285,Y,Y,"WITH SS AS ( SELECT*FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL) SELECT E.EMPLOYEE_ID, E.NAME, COUNT(SS.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(SS.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E JOIN SS ON E.EMPLOYEE_ID = SS.REPORTS_TO GROUP BY E.EMPLOYEE_ID ORDER BY E.EMPLOYEE_ID"
286,Y,Y,"WITH TEMP AS ( SELECT REPORTS_TO ,SUM(1) AS REPORTS_COUNT ,ROUND(AVG(AGE)) AS AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO ) SELECT EMPLOYEES.EMPLOYEE_ID ,EMPLOYEES.NAME ,TEMP.REPORTS_COUNT ,TEMP.AVERAGE_AGE FROM TEMP INNER JOIN EMPLOYEES ON TEMP.REPORTS_TO = EMPLOYEES.EMPLOYEE_ID ORDER BY EMPLOYEES.EMPLOYEE_ID"
287,Y,Y,"WITH TEMP AS (SELECT REPORTS_TO AS EMPLOYEE_ID, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(AGE),0) AS AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY 1) SELECT E1.EMPLOYEE_ID, NAME, REPORTS_COUNT, AVERAGE_AGE FROM TEMP E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID=E2.EMPLOYEE_ID ORDER BY E1.EMPLOYEE_ID"
288,Y,Y,"WITH TEMP AS (SELECT REPORTS_TO AS EMPLOYEE_ID, COUNT(EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(AGE),0) AS AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO) SELECT TEMP.EMPLOYEE_ID, EMPLOYEES.NAME, REPORTS_COUNT, AVERAGE_AGE FROM TEMP LEFT JOIN EMPLOYEES ON TEMP.EMPLOYEE_ID = EMPLOYEES.EMPLOYEE_ID ORDER BY TEMP.EMPLOYEE_ID"
289,Y,Y,"WITH A1 AS ( SELECT DISTINCT A.EMPLOYEE_ID AS MANAGER_ID, B.EMPLOYEE_ID AS EMPLOYEE_ID, A.NAME AS MANAGER_NAME, B.NAME AS EMPLOYEE_NAME, B.AGE AS EMPLOYEE_AGE FROM EMPLOYEES AS A JOIN EMPLOYEES AS B ON A.EMPLOYEE_ID = B.REPORTS_TO) SELECT MANAGER_ID AS EMPLOYEE_ID, MANAGER_NAME AS NAME, COUNT(DISTINCT EMPLOYEE_ID) AS REPORTS_COUNT , ROUND(AVG(EMPLOYEE_AGE),0) AS AVERAGE_AGE FROM A1 GROUP BY MANAGER_ID"
290,Y,Y,"SELECT B.EMPLOYEE_ID, B.NAME, COUNT(*) REPORTS_COUNT, ROUND(AVG(A.AGE), 0) AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON B.EMPLOYEE_ID = A.REPORTS_TO GROUP BY 1 ORDER BY 1"
291,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(E2.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(E2.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 INNER JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID=E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID ORDER BY E1.EMPLOYEE_ID"
292,Y,Y,"WITH TMP AS( SELECT REPORTS_TO AS EMPLOYEE_ID , COUNT(EMPLOYEE_ID) AS REPORTS_COUNT , ROUND(AVG(AGE),0) AS AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO) SELECT A.EMPLOYEE_ID , B.NAME , A.REPORTS_COUNT , A.AVERAGE_AGE FROM TMP A JOIN EMPLOYEES B ON A.EMPLOYEE_ID = B.EMPLOYEE_ID ORDER BY A.EMPLOYEE_ID"
293,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(E2.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(E2.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY EMPLOYEE_ID, NAME ORDER BY EMPLOYEE_ID"
294,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(E2.EMPLOYEE_ID) REPORTS_COUNT ,ROUND(AVG(E2.AGE)) AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY 1 ORDER BY 1"
295,Y,Y,"SELECT M1.EMPLOYEE_ID ,M1.NAME ,COUNT(E1.EMPLOYEE_ID) REPORTS_COUNT ,ROUND(AVG(E1.AGE)) AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES M1 ON E1.REPORTS_TO = M1.EMPLOYEE_ID GROUP BY 1,2 ORDER BY 1"
296,Y,Y,"SELECT DISTINCT EMPLOYEE_ID,NAME,REPORTS_COUNT,ROUND(AVERAGE_AGE) AVERAGE_AGE FROM ( SELECT E1.EMPLOYEE_ID,E1.NAME,COUNT(E2.REPORTS_TO) OVER( PARTITION BY E1.EMPLOYEE_ID) REPORTS_COUNT,AVG(E2.AGE) OVER(PARTITION BY E1.EMPLOYEE_ID) AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO) X ORDER BY EMPLOYEE_ID"
297,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(E2.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E2.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 LEFT JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID=E2.REPORTS_TO WHERE E2.EMPLOYEE_ID IS NOT NULL GROUP BY E1.EMPLOYEE_ID ORDER BY E1.EMPLOYEE_ID"
298,Y,Y,"SELECT A.REPORTS_TO AS EMPLOYEE_ID, B.NAME, COUNT(A.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(A.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID WHERE A.REPORTS_TO IS NOT NULL GROUP BY 1 ORDER BY 1"
299,Y,Y,"SELECT M.EMPLOYEE_ID, M.NAME, COUNT(E.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES M JOIN EMPLOYEES E ON E.REPORTS_TO = M.EMPLOYEE_ID GROUP BY 1, 2 HAVING COUNT(E.EMPLOYEE_ID) > 0 ORDER BY 1"
300,Y,Y,"SELECT DISTINCT A.EMPLOYEE_ID, A.NAME, COUNT(B.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(B.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B WHERE A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY 1 ORDER BY 1"
301,Y,Y,"WITH TMP AS (SELECT E2.EMPLOYEE_ID, E2.NAME, COUNT(E2.EMPLOYEE_ID) AS REPORTS_COUNT , ROUND(AVG(E1.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY E2.EMPLOYEE_ID) SELECT TMP.EMPLOYEE_ID, TMP.NAME, TMP.REPORTS_COUNT, TMP.AVERAGE_AGE FROM TMP WHERE TMP.REPORTS_COUNT >= 1 ORDER BY TMP.EMPLOYEE_ID"
302,Y,Y,"SELECT R.EMPLOYEE_ID , R.NAME , COUNT(E.EMPLOYEE_ID) AS REPORTS_COUNT , ROUND(AVG(E.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E JOIN EMPLOYEES R ON E.REPORTS_TO = R.EMPLOYEE_ID GROUP BY 1,2 ORDER BY 1"
303,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME ,COUNT(E2.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(E2.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 LEFT JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO WHERE E2.AGE IS NOT NULL GROUP BY 1 ORDER BY 1"
304,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME,COUNT(*) AS REPORTS_COUNT,ROUND(AVG(E2.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES AS E1 INNER JOIN EMPLOYEES AS E2 WHERE E1.EMPLOYEE_ID=E2.REPORTS_TO GROUP BY 1 ORDER BY 1"
305,Y,Y,"SELECT E.EMPLOYEE_ID, E.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(SUM(E1.AGE)/COUNT(*),0) AS AVERAGE_AGE FROM (SELECT DISTINCT EMPLOYEE_ID, NAME FROM EMPLOYEES) E JOIN EMPLOYEES E1 ON E.EMPLOYEE_ID = E1.REPORTS_TO GROUP BY E.EMPLOYEE_ID, E.NAME ORDER BY E.EMPLOYEE_ID"
306,Y,Y,"WITH TEMP1 AS ( SELECT REPORTS_TO, COUNT(REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(AGE),0) AS AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO) SELECT E.EMPLOYEE_ID, E.NAME, T.REPORTS_COUNT, T.AVERAGE_AGE FROM EMPLOYEES E JOIN TEMP1 T ON E.EMPLOYEE_ID = T.REPORTS_TO ORDER BY E.EMPLOYEE_ID"
307,Y,Y,"SELECT B.EMPLOYEE_ID, B.NAME, COUNT(A.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(A.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO=B.EMPLOYEE_ID GROUP BY B.EMPLOYEE_ID ORDER BY B.EMPLOYEE_ID"
308,Y,Y,"SELECT E.EMPLOYEE_ID, E.NAME, COUNT(Q.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(SUM(Q.AGE)/COUNT(Q.EMPLOYEE_ID), 0) AS AVERAGE_AGE FROM EMPLOYEES E JOIN (SELECT * FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL) AS Q ON E.EMPLOYEE_ID=Q.REPORTS_TO GROUP BY E.EMPLOYEE_ID ORDER BY E.EMPLOYEE_ID"
309,Y,Y,"SELECT E.REPORTS_TO AS EMPLOYEE_ID, E1.NAME, COUNT(E.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E JOIN EMPLOYEES E1 ON E.REPORTS_TO=E1.EMPLOYEE_ID WHERE E.REPORTS_TO IS NOT NULL GROUP BY E.REPORTS_TO ORDER BY 1"
310,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E2.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 LEFT JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO WHERE E2.EMPLOYEE_ID IS NOT NULL GROUP BY E1.EMPLOYEE_ID ORDER BY E1.EMPLOYEE_ID"
311,Y,Y,"WITH REPORTS_AVG AS ( SELECT REPORTS_TO MANAGER_ID, COUNT(REPORTS_TO) REPORTS_COUNT , ROUND(AVG(AGE)) AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO ) SELECT E.EMPLOYEE_ID, E.NAME, R.REPORTS_COUNT, R.AVERAGE_AGE FROM EMPLOYEES E JOIN REPORTS_AVG R ON R.MANAGER_ID = E.EMPLOYEE_ID ORDER BY 1"
312,Y,Y,"SELECT E1.REPORTS_TO AS EMPLOYEE_ID, E2.NAME AS NAME, COUNT(E1.REPORTS_TO) AS REPORTS_COUNT, IFNULL(ROUND(AVG(E1.AGE),0),0) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY 1 ORDER BY 1"
313,Y,Y,"SELECT E2.EMPLOYEE_ID AS EMPLOYEE_ID, E2.NAME AS NAME, COUNT(E1.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(E1.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID WHERE E1.REPORTS_TO IS NOT NULL GROUP BY E2.EMPLOYEE_ID, E2.NAME ORDER BY E2.EMPLOYEE_ID"
314,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(B.EMPLOYEE_ID) REPORTS_COUNT, ROUND(AVG(B.AGE)) AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B WHERE B.REPORTS_TO IS NOT NULL AND A.EMPLOYEE_ID=B.REPORTS_TO GROUP BY 1, 2 ORDER BY 1"
315,Y,Y,"SELECT M.EMPLOYEE_ID, M.NAME, COUNT(E.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E.AGE)) AS AVERAGE_AGE FROM EMPLOYEES M JOIN EMPLOYEES E ON M.EMPLOYEE_ID = E.REPORTS_TO GROUP BY M.EMPLOYEE_ID, M.NAME ORDER BY M.EMPLOYEE_ID"
316,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E2.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID ORDER BY E1.EMPLOYEE_ID"
317,Y,N,"SELECT E2.EMPLOYEE_ID, E2.NAME, COUNT(E1.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(E1.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 LEFT JOIN EMPLOYEES E2 ON E1.REPORTS_TO=E2.EMPLOYEE_ID WHERE E2.EMPLOYEE_ID != 'NULL' GROUP BY 1 ORDER BY 1"
318,Y,Y,"SELECT E1.EMPLOYEE_ID,E1.NAME,COUNT(E.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E JOIN EMPLOYEES E1 ON E.REPORTS_TO = E1.EMPLOYEE_ID GROUP BY 1 ORDER BY 1"
319,Y,Y,"SELECT E1.REPORTS_TO AS EMPLOYEE_ID, E2.NAME AS NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E1.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.REPORTS_TO=E2.EMPLOYEE_ID WHERE E1.REPORTS_TO IS NOT NULL GROUP BY 1 ORDER BY 1"
320,Y,Y,"SELECT A.REPORTS_TO AS EMPLOYEE_ID, B.NAME AS NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(A.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY 1 ORDER BY 1"
321,Y,Y,"WITH COMBINE AS ( SELECT M.EMPLOYEE_ID, M.NAME, E.AGE FROM EMPLOYEES M LEFT JOIN EMPLOYEES E ON E.REPORTS_TO=M.EMPLOYEE_ID WHERE E.AGE IS NOT NULL) SELECT EMPLOYEE_ID, NAME, COUNT(AGE) AS REPORTS_COUNT, ROUND(AVG(AGE)) AS AVERAGE_AGE FROM COMBINE GROUP BY EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
322,Y,Y,"WITH CTE AS ( SELECT T.EMPLOYEE_ID,T.NAME,T.REPORTS_TO,S.AGE FROM EMPLOYEES AS T JOIN EMPLOYEES AS S ON T.EMPLOYEE_ID=S.REPORTS_TO ) SELECT EMPLOYEE_ID,NAME, COUNT(*) AS REPORTS_COUNT, ROUND(SUM(AGE)/COUNT(*)) AS AVERAGE_AGE FROM CTE GROUP BY EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
323,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, B.REPORTS_COUNT, B.AVERAGE_AGE FROM EMPLOYEES A JOIN ( SELECT REPORTS_TO, COUNT(EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(AGE)) AS AVERAGE_AGE FROM EMPLOYEES GROUP BY REPORTS_TO ) B ON A.EMPLOYEE_ID = B.REPORTS_TO ORDER BY EMPLOYEE_ID"
324,Y,Y,"SELECT E1.REPORTS_TO AS EMPLOYEE_ID, E2.NAME, COUNT(E1.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E1.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 LEFT JOIN EMPLOYEES E2 ON E1.REPORTS_TO=E2.EMPLOYEE_ID WHERE E1.REPORTS_TO IS NOT NULL GROUP BY E1.REPORTS_TO ORDER BY EMPLOYEE_ID"
325,Y,Y,"SELECT E.EMPLOYEE_ID, E.NAME, REPORTS_COUNT, AVERAGE_AGE FROM EMPLOYEES E JOIN (SELECT REPORTS_TO, COUNT(EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(AGE),0) AS AVERAGE_AGE FROM EMPLOYEES GROUP BY 1 HAVING COUNT(EMPLOYEE_ID) >=1 ) M ON M.REPORTS_TO = E.EMPLOYEE_ID ORDER BY 1"
326,Y,Y,"SELECT E1.REPORTS_TO AS EMPLOYEE_ID, E2.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E1.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID WHERE E1.REPORTS_TO IS NOT NULL GROUP BY E1.REPORTS_TO ORDER BY E1.REPORTS_TO"
327,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(1) REPORTS_COUNT, ROUND(AVG(B.AGE)) AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON B.REPORTS_TO = A.EMPLOYEE_ID GROUP BY 1 ORDER BY 1"
328,Y,Y,"SELECT A.REPORTS_TO AS EMPLOYEE_ID ,B.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(A.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY A.REPORTS_TO ORDER BY A.REPORTS_TO"
329,Y,Y,"SELECT E2.EMPLOYEE_ID AS EMPLOYEE_ID, E2.NAME AS NAME, COUNT(E1.REPORTS_TO) AS REPORTS_COUNT, CAST(AVG(E1.AGE) AS UNSIGNED) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID WHERE E1.REPORTS_TO IS NOT NULL GROUP BY 1 ORDER BY 1"
330,Y,Y,"SELECT E.EMPLOYEE_ID, E.NAME, E2.REPORTS_COUNT, E2.AVERAGE_AGE FROM EMPLOYEES E INNER JOIN ( SELECT REPORTS_TO, COUNT(*) REPORTS_COUNT, ROUND(AVG(AGE), 0) AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO ) E2 ON E.EMPLOYEE_ID = E2.REPORTS_TO ORDER BY E.EMPLOYEE_ID"
331,Y,Y,"SELECT E2.REPORTS_TO AS EMPLOYEE_ID, E1.NAME, COUNT(E2.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E2.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY 1 ORDER BY 1"
332,Y,Y,"WITH MANAGER AS ( SELECT REPORTS_TO AS ID, COUNT(EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(AGE)) AS AVERAGE_AGE FROM EMPLOYEES GROUP BY REPORTS_TO ) SELECT M.ID AS EMPLOYEE_ID, NAME, M.REPORTS_COUNT, M.AVERAGE_AGE FROM MANAGER M JOIN EMPLOYEES E ON M.ID = E.EMPLOYEE_ID ORDER BY 1"
333,Y,Y,"SELECT A.REPORTS_TO AS EMPLOYEE_ID, B.NAME, COUNT(DISTINCT A.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(A.AGE),0) AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY 1 ORDER BY 1"
334,Y,Y,"WITH MANAGERS AS (SELECT REPORTS_TO, ROUND(AVG(AGE)) AS AVG_AGE , COUNT(NAME) AS E_COUNT FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO) SELECT MANAGERS.REPORTS_TO AS EMPLOYEE_ID, EMPLOYEES.NAME, MANAGERS.E_COUNT AS REPORTS_COUNT, MANAGERS.AVG_AGE AS AVERAGE_AGE FROM MANAGERS LEFT JOIN EMPLOYEES ON MANAGERS.REPORTS_TO = EMPLOYEES.EMPLOYEE_ID ORDER BY MANAGERS.REPORTS_TO"
335,Y,Y,"SELECT MANAGER.EMPLOYEE_ID, MANAGER.NAME, COUNT(EMPLOYEES.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(EMPLOYEES.AGE)) AS AVERAGE_AGE FROM EMPLOYEES JOIN EMPLOYEES MANAGER ON EMPLOYEES.REPORTS_TO = MANAGER.EMPLOYEE_ID GROUP BY EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
336,Y,Y,"SELECT E1.REPORTS_TO AS EMPLOYEE_ID, E2.NAME, COUNT(E1.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(SUM(E1.AGE)/COUNT(E1.EMPLOYEE_ID),0) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY E1.REPORTS_TO ORDER BY E1.REPORTS_TO"
337,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E2.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES E1, EMPLOYEES E2 WHERE E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY 1 ORDER BY 1"
338,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(E2.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E2.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID=E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID, E1.NAME ORDER BY E1.EMPLOYEE_ID"
339,Y,Y,"SELECT E.EMPLOYEE_ID, E.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(C.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E JOIN EMPLOYEES C ON C.REPORTS_TO = E.EMPLOYEE_ID GROUP BY C.REPORTS_TO ORDER BY C.REPORTS_TO"
340,Y,Y,"SELECT B.EMPLOYEE_ID, B.NAME, COUNT(A.REPORTS_TO) REPORTS_COUNT, ROUND(AVG(A.AGE)) AVERAGE_AGE FROM EMPLOYEES A, EMPLOYEES B WHERE A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY 1 ORDER BY 1"
341,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(DISTINCT B.EMPLOYEE_ID) REPORTS_COUNT ,ROUND(AVG(B.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON B.REPORTS_TO=A.EMPLOYEE_ID GROUP BY 1,2 ORDER BY 1"
342,Y,Y,"SELECT E.EMPLOYEE_ID,E.NAME,COUNT(R.REPORTS_TO) REPORTS_COUNT,ROUND(AVG(R.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E JOIN EMPLOYEES R ON E.EMPLOYEE_ID =R.REPORTS_TO GROUP BY 1 ORDER BY 1"
343,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME,COUNT(B.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(B.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A LEFT JOIN EMPLOYEES B ON A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY 1 HAVING COUNT(B.EMPLOYEE_ID) >= 1 ORDER BY 1"
344,Y,Y,"SELECT EMPLOYEE_ID,NAME, COUNT(*) AS REPORTS_COUNT ,ROUND(AVG(AGE),0) AS AVERAGE_AGE FROM ( SELECT E1.EMPLOYEE_ID, E1.NAME, E2.AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO ) A GROUP BY 1,2 ORDER BY 1"
345,Y,Y,"SELECT E.REPORTS_TO AS EMPLOYEE_ID, T.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES AS E JOIN ( SELECT * FROM EMPLOYEES ) AS T ON E.REPORTS_TO = T.EMPLOYEE_ID WHERE E.REPORTS_TO IS NOT NULL GROUP BY E.REPORTS_TO ORDER BY E.REPORTS_TO ASC"
346,Y,Y,"SELECT B.EMPLOYEE_ID, B.NAME, COUNT(A.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(A.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO = B. EMPLOYEE_ID GROUP BY B.EMPLOYEE_ID ORDER BY B.EMPLOYEE_ID"
347,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(E1.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E2.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES E1 LEFT JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID HAVING AVERAGE_AGE IS NOT NULL ORDER BY E1.EMPLOYEE_ID"
348,Y,Y,"SELECT S.EMPLOYEE_ID, E.NAME, S.REPORTS_COUNT, ROUND(S.AVERAGE_AGE, 0) AS AVERAGE_AGE FROM ( SELECT REPORTS_TO AS EMPLOYEE_ID, COUNT(*) AS REPORTS_COUNT, AVG(AGE) AS AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY 1) S LEFT JOIN EMPLOYEES E ON S.EMPLOYEE_ID=E.EMPLOYEE_ID ORDER BY S.EMPLOYEE_ID"
349,Y,Y,"SELECT GE.EMPLOYEE_ID, E.NAME, GE.REPORTS_COUNT, ROUND(GE.AVERAGE_AGE) AS AVERAGE_AGE FROM (SELECT REPORTS_TO AS EMPLOYEE_ID, COUNT(EMPLOYEE_ID) AS REPORTS_COUNT, AVG(AGE) AS AVERAGE_AGE FROM EMPLOYEES GROUP BY REPORTS_TO HAVING REPORTS_TO IS NOT NULL) GE LEFT JOIN EMPLOYEES E ON GE.EMPLOYEE_ID=E.EMPLOYEE_ID ORDER BY GE.EMPLOYEE_ID"
350,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(B.NAME) AS REPORTS_COUNT, ROUND(AVG(B.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES AS A JOIN EMPLOYEES AS B ON A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY A.EMPLOYEE_ID ORDER BY A.EMPLOYEE_ID"
351,Y,Y,"SELECT T0.REPORTS_TO AS EMPLOYEE_ID, E.NAME, REPORTS_COUNT,AVERAGE_AGE FROM (SELECT REPORTS_TO, COUNT(EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(AGE)) AS AVERAGE_AGE FROM EMPLOYEES GROUP BY REPORTS_TO HAVING ISNULL(REPORTS_TO) = 0) T0 JOIN EMPLOYEES E ON T0.REPORTS_TO = E.EMPLOYEE_ID ORDER BY 1"
352,Y,Y,"WITH CTE AS( SELECT REPORTS_TO AS EMPLOYEE_ID, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(AGE),0) AS AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY 1) SELECT CTE.EMPLOYEE_ID, NAME, REPORTS_COUNT, AVERAGE_AGE FROM CTE JOIN EMPLOYEES ON EMPLOYEES.EMPLOYEE_ID = CTE.EMPLOYEE_ID ORDER BY 1"
353,Y,Y,"SELECT E2.EMPLOYEE_ID, E2.NAME, COUNT(E1.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E1.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 LEFT JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID WHERE E2.NAME IS NOT NULL GROUP BY E2.EMPLOYEE_ID, E2.NAME ORDER BY E2.EMPLOYEE_ID"
354,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E2.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
355,Y,Y,"SELECT E2.EMPLOYEE_ID, E2.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E1.AGE)) AS AVERAGE_AGE FROM EMPLOYEES AS E1 JOIN EMPLOYEES AS E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY 1 ORDER BY 1"
356,Y,Y,"SELECT E2.EMPLOYEE_ID, E2.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E1.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY E2.EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
357,Y,Y,"SELECT M.EMPLOYEE_ID,M.NAME,COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E JOIN EMPLOYEES M ON E.REPORTS_TO = M.EMPLOYEE_ID GROUP BY M.EMPLOYEE_ID ORDER BY M.EMPLOYEE_ID"
358,Y,Y,"SELECT DISTINCT E1.REPORTS_TO AS EMPLOYEE_ID, E2.NAME AS NAME, COUNT(E1.EMPLOYEE_ID) OVER (PARTITION BY E1.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(E1.AGE) OVER (PARTITION BY E1.REPORTS_TO)) AS AVERAGE_AGE FROM EMPLOYEES E1 LEFT JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID WHERE E1.REPORTS_TO IS NOT NULL ORDER BY EMPLOYEE_ID"
359,Y,Y,"WITH TMP AS ( SELECT REPORTS_TO, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(AGE),0) AS AVERAGE_AGE FROM EMPLOYEES GROUP BY 1 ) SELECT E.EMPLOYEE_ID, E.NAME, T.REPORTS_COUNT, T.AVERAGE_AGE FROM EMPLOYEES AS E INNER JOIN TMP AS T ON E.EMPLOYEE_ID = T.REPORTS_TO ORDER BY 1"
360,Y,Y,"SELECT EMPLOYEE_ID, NAME, REPORTS_COUNT, AVERAGE_AGE FROM EMPLOYEES JOIN ( SELECT REPORTS_TO, COUNT(REPORTS_TO ) AS REPORTS_COUNT, ROUND(AVG(AGE)) AS AVERAGE_AGE FROM EMPLOYEES GROUP BY REPORTS_TO) T ON T.REPORTS_TO = EMPLOYEES.EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
361,Y,Y,"SELECT B.EMPLOYEE_ID, B.NAME AS NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(A.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY A.REPORTS_TO ORDER BY B.EMPLOYEE_ID"
362,Y,Y,"SELECT MANAGER_ID AS EMPLOYEE_ID ,NAME ,EMP_CNT AS REPORTS_COUNT ,AVG_AGE AS AVERAGE_AGE FROM (SELECT REPORTS_TO AS MANAGER_ID ,COUNT(DISTINCT EMPLOYEE_ID) AS EMP_CNT ,ROUND(AVG(AGE),0) AS AVG_AGE FROM EMPLOYEES GROUP BY 1) E1 JOIN EMPLOYEES E2 ON E1.MANAGER_ID = E2.EMPLOYEE_ID ORDER BY 1"
363,Y,Y,"SELECT B.EMPLOYEE_ID AS EMPLOYEE_ID, B.NAME AS NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(A.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A INNER JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY 1 ORDER BY 1"
364,Y,Y,"SELECT M.EMPLOYEE_ID, M.NAME, COUNT(E.EMPLOYEE_ID) REPORTS_COUNT, ROUND(AVG(E.AGE)) AVERAGE_AGE FROM EMPLOYEES M INNER JOIN EMPLOYEES E ON M.EMPLOYEE_ID = E.REPORTS_TO GROUP BY 1 ORDER BY 1"
365,Y,Y,"SELECT E1.EMPLOYEE_ID,E1.NAME,COUNT(E.EMPLOYEE_ID) AS REPORTS_COUNT ,ROUND(AVG(E.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E JOIN EMPLOYEES E1 ON E.REPORTS_TO =E1.EMPLOYEE_ID GROUP BY E1.EMPLOYEE_ID ORDER BY E1.EMPLOYEE_ID"
366,Y,Y,"SELECT E.EMPLOYEE_ID, E.NAME, T.REP_CT AS REPORTS_COUNT, T.AVG_AGE AS AVERAGE_AGE FROM EMPLOYEES AS E LEFT JOIN ( SELECT REPORTS_TO, COUNT(*) AS REP_CT, ROUND(AVG(AGE), 0) AS AVG_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO ) AS T ON E.EMPLOYEE_ID = T.REPORTS_TO WHERE T.REP_CT IS NOT NULL ORDER BY 1"
367,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(E1.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E2.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID ORDER BY E1.EMPLOYEE_ID ASC"
368,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(DISTINCT E2.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E2.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID=E2.REPORTS_TO GROUP BY 1,2 ORDER BY 1"
369,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(DISTINCT B.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(AGE),0) AS AVERAGE_AGE FROM (SELECT EMPLOYEE_ID, NAME FROM EMPLOYEES GROUP BY EMPLOYEE_ID, NAME) A JOIN (SELECT EMPLOYEE_ID, NAME, REPORTS_TO, AGE FROM EMPLOYEES) B ON A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY A.EMPLOYEE_ID, A.NAME"
370,Y,Y,"SELECT M.EMPLOYEE_ID, M.NAME, COUNT(E.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES M JOIN EMPLOYEES E ON M.EMPLOYEE_ID = E.REPORTS_TO GROUP BY 1 ORDER BY 1"
371,Y,Y,"SELECT B.EMPLOYEE_ID, B.NAME, COUNT(A.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(A.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES A INNER JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY B.EMPLOYEE_ID ORDER BY B.EMPLOYEE_ID"
372,Y,Y,"WITH GROUPED AS ( SELECT REPORTS_TO AS EMPLOYEE_ID, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO ) SELECT G.EMPLOYEE_ID, E.NAME, REPORTS_COUNT, AVERAGE_AGE FROM GROUPED G JOIN EMPLOYEES E ON E.EMPLOYEE_ID = G.EMPLOYEE_ID ORDER BY 1"
373,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E2.AGE)) AS AVERAGE_AGE FROM EMPLOYEES AS E1 INNER JOIN EMPLOYEES AS E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY E2.REPORTS_TO ORDER BY E2.REPORTS_TO"
374,Y,Y,"SELECT EMPLOYEE_ID, NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(AGE),0) AS AVERAGE_AGE FROM (SELECT EM.REPORTS_TO AS EMPLOYEE_ID, EM2.NAME, EM.AGE FROM EMPLOYEES EM JOIN EMPLOYEES EM2 ON EM.REPORTS_TO = EM2.EMPLOYEE_ID WHERE EM.REPORTS_TO IS NOT NULL) MYTABLE GROUP BY EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
375,Y,Y,"SELECT EMPLOYEE_ID,NAME,REPORTS_COUNT,AVERAGE_AGE FROM EMPLOYEES E JOIN( SELECT DISTINCT REPORTS_TO, COUNT(REPORTS_TO) AS REPORTS_COUNT,ROUND(AVG(AGE),0) AS AVERAGE_AGE FROM EMPLOYEES GROUP BY REPORTS_TO HAVING REPORTS_COUNT>=1) A ON E.EMPLOYEE_ID=A.REPORTS_TO ORDER BY E.EMPLOYEE_ID"
376,Y,Y,"SELECT E2.EMPLOYEE_ID, E2.NAME, COUNT(DISTINCT E1.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E1.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY 1,2 ORDER BY 1"
377,Y,Y,"WITH MANAGERS AS ( SELECT REPORTS_TO AS EMPLOYEE_ID, COUNT(*) REPORTS_COUNT, AVG(AGE) AS AVERAGE_AGE FROM EMPLOYEES GROUP BY 1 ) SELECT A.EMPLOYEE_ID, B.NAME, A.REPORTS_COUNT, ROUND(A.AVERAGE_AGE) AVERAGE_AGE FROM MANAGERS A JOIN EMPLOYEES B ON A.EMPLOYEE_ID = B.EMPLOYEE_ID ORDER BY 1"
378,Y,Y,"SELECT A.REPORTS_TO AS EMPLOYEE_ID, B.NAME, COUNT(A.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(A.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES AS A INNER JOIN EMPLOYEES AS B ON A.REPORTS_TO = B.EMPLOYEE_ID WHERE A.EMPLOYEE_ID IN (SELECT DISTINCT(EMPLOYEE_ID) FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL) GROUP BY A.REPORTS_TO ORDER BY A.REPORTS_TO"
379,Y,Y,"SELECT M.EMPLOYEE_ID, M.NAME, COUNT(E.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(E.AGE)) AVERAGE_AGE FROM EMPLOYEES M JOIN EMPLOYEES E ON M.EMPLOYEE_ID = E.REPORTS_TO GROUP BY 1 ORDER BY 1"
380,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(B.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY A.EMPLOYEE_ID ORDER BY A.EMPLOYEE_ID"
381,Y,Y,"SELECT A.REPORTS_TO AS EMPLOYEE_ID, B.NAME AS NAME, COUNT(A.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(A.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A LEFT JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID WHERE A.REPORTS_TO IS NOT NULL GROUP BY A.REPORTS_TO, B.NAME ORDER BY A.REPORTS_TO"
382,Y,Y,"WITH TEMP AS ( SELECT A.EMPLOYEE_ID, A.NAME, B.EMPLOYEE_ID AS DIRECT_REPORT, B.AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.EMPLOYEE_ID = B.REPORTS_TO ) SELECT EMPLOYEE_ID, NAME, COUNT(DIRECT_REPORT) AS REPORTS_COUNT, ROUND(AVG(AGE)) AS AVERAGE_AGE FROM TEMP GROUP BY 1, 2 ORDER BY 1"
383,Y,Y,"SELECT E1.REPORTS_TO EMPLOYEE_ID, E2.NAME, COUNT(*) REPORTS_COUNT, ROUND(AVG(E1.AGE)) AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY 1,2 ORDER BY 1"
384,Y,Y,"SELECT M.EMPLOYEE_ID AS EMPLOYEE_ID, M.NAME AS NAME, COUNT(E.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES M JOIN EMPLOYEES E ON E.REPORTS_TO = M.EMPLOYEE_ID GROUP BY M.EMPLOYEE_ID ORDER BY M.EMPLOYEE_ID"
385,Y,Y,"SELECT E1.REPORTS_TO AS EMPLOYEE_ID, E2.NAME, COUNT(E1.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(E1.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 LEFT JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID WHERE E1.REPORTS_TO IS NOT NULL GROUP BY E1.REPORTS_TO ORDER BY EMPLOYEE_ID"
386,Y,Y,"SELECT E2.EMPLOYEE_ID, E2.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E1.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES E1 LEFT JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY E2.EMPLOYEE_ID HAVING E2.EMPLOYEE_ID IS NOT NULL ORDER BY E2.EMPLOYEE_ID"
387,Y,Y,"SELECT M.REPORTS_TO AS EMPLOYEE_ID, E.NAME, COUNT(M.AGE) AS REPORTS_COUNT, ROUND(AVG(M.AGE)) AS AVERAGE_AGE FROM EMPLOYEES M, EMPLOYEES E WHERE M.REPORTS_TO = E.EMPLOYEE_ID GROUP BY M.REPORTS_TO ORDER BY EMPLOYEE_ID"
388,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(A.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(B.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY A.EMPLOYEE_ID ORDER BY A.EMPLOYEE_ID"
389,Y,Y,"SELECT T2.EMPLOYEE_ID, T2.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(T1.AGE)) AS AVERAGE_AGE FROM EMPLOYEES T1 JOIN EMPLOYEES T2 ON T1.REPORTS_TO = T2.EMPLOYEE_ID GROUP BY 1 ORDER BY 1"
390,Y,Y,"SELECT E.EMPLOYEE_ID,E.NAME,COUNT(*) AS REPORTS_COUNT,ROUND(AVG(F.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E INNER JOIN EMPLOYEES F ON E.EMPLOYEE_ID = F.REPORTS_TO GROUP BY E.EMPLOYEE_ID,E.NAME ORDER BY E.EMPLOYEE_ID"
391,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(B.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A, EMPLOYEES B WHERE A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY A.EMPLOYEE_ID ORDER BY A.EMPLOYEE_ID"
392,Y,Y,"SELECT E.REPORTS_TO AS EMPLOYEE_ID, E1.NAME, COUNT(*) AS REPORTS_COUNT,ROUND(AVG(E.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E JOIN EMPLOYEES E1 ON E.REPORTS_TO =E1.EMPLOYEE_ID GROUP BY 1,2 ORDER BY 1"
393,Y,Y,"SELECT E2.EMPLOYEE_ID,E2.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E1.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1, EMPLOYEES E2 WHERE E1.REPORTS_TO=E2.EMPLOYEE_ID GROUP BY EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
394,Y,Y,"SELECT B.EMPLOYEE_ID, B.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(A.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A INNER JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY B.EMPLOYEE_ID ORDER BY B.EMPLOYEE_ID"
395,Y,Y,"WITH CTE AS (SELECT REPORTS_TO AS ID, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(AGE)) AS AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY ID) SELECT A.EMPLOYEE_ID, A.NAME, B.REPORTS_COUNT, B.AVERAGE_AGE FROM EMPLOYEES AS A JOIN CTE AS B ON A.EMPLOYEE_ID = B.ID ORDER BY EMPLOYEE_ID"
396,Y,Y,"SELECT M.EMPLOYEE_ID, M.NAME, COUNT(E.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES E JOIN EMPLOYEES M ON E.REPORTS_TO = M.EMPLOYEE_ID GROUP BY M.NAME, M.EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
397,Y,Y,"SELECT M.EMPLOYEE_ID, M.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E JOIN EMPLOYEES M ON E.REPORTS_TO = M.EMPLOYEE_ID GROUP BY 1 ORDER BY 1"
398,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT( E1.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E2.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID ORDER BY 1"
399,Y,Y,"SELECT M.EMPLOYEE_ID, M.NAME, COUNT(E.EMPLOYEE_ID) REPORTS_COUNT , ROUND(AVG(E.AGE)) AVERAGE_AGE FROM EMPLOYEES M INNER JOIN EMPLOYEES E ON E.REPORTS_TO = M.EMPLOYEE_ID GROUP BY M.EMPLOYEE_ID, M.NAME ORDER BY M.EMPLOYEE_ID"
400,Y,Y,"WITH MANAGER AS ( SELECT REPORTS_TO AS EMPLOYEE_ID,COUNT(*) AS REPORTS_COUNT, ROUND(AVG(AGE)) AS AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO ) SELECT M.EMPLOYEE_ID, NAME, REPORTS_COUNT, AVERAGE_AGE FROM MANAGER M JOIN EMPLOYEES E ON M.EMPLOYEE_ID = E.EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
401,Y,Y,"SELECT EMPLOYEE_ID,NAME,REPORTS_COUNT,AVERAGE_AGE FROM EMPLOYEES E1 JOIN (SELECT REPORTS_TO,COUNT(*) AS REPORTS_COUNT,ROUND(AVG(AGE),0) AS AVERAGE_AGE FROM EMPLOYEES GROUP BY REPORTS_TO)E2 ON E1.EMPLOYEE_ID=E2.REPORTS_TO ORDER BY EMPLOYEE_ID"
402,Y,Y,"SELECT MANAGER_GROUPINGS.EMPLOYEE_ID, EMPLOYEES.NAME, MANAGER_GROUPINGS.REPORTS_COUNT, MANAGER_GROUPINGS.AVERAGE_AGE FROM ( SELECT EMPLOYEES.REPORTS_TO AS EMPLOYEE_ID, COUNT( DISTINCT EMPLOYEES.EMPLOYEE_ID ) AS REPORTS_COUNT, ROUND( AVG( EMPLOYEES.AGE ), 0 ) AS AVERAGE_AGE FROM EMPLOYEES GROUP BY EMPLOYEES.REPORTS_TO HAVING EMPLOYEES.REPORTS_TO IS NOT NULL ) AS MANAGER_GROUPINGS JOIN EMPLOYEES ON MANAGER_GROUPINGS.EMPLOYEE_ID = EMPLOYEES.EMPLOYEE_ID GROUP BY EMPLOYEES.EMPLOYEE_ID ORDER BY EMPLOYEES.EMPLOYEE_ID ASC"
403,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(IFNULL(AVG(E2.AGE), 0)) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY 1, 2 ORDER BY 1"
404,Y,Y,"SELECT B.EMPLOYEE_ID AS EMPLOYEE_ID, B.NAME AS NAME , COUNT(A.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(A.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A LEFT JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY EMPLOYEE_ID HAVING EMPLOYEE_ID IS NOT NULL ORDER BY EMPLOYEE_ID"
405,Y,Y,"SELECT E.EMPLOYEE_ID, E.NAME, COUNT(E_M.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(E_M.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E JOIN EMPLOYEES E_M ON (E.EMPLOYEE_ID=E_M.REPORTS_TO) GROUP BY E.EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
406,Y,Y,"WITH TEMP_TABLE AS (SELECT E1.EMPLOYEE_ID, E1.NAME, E2.REPORTS_TO, E2.AGE FROM EMPLOYEES E1 INNER JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO) SELECT REPORTS_TO AS EMPLOYEE_ID, NAME, COUNT(REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(AGE), 0) AS AVERAGE_AGE FROM TEMP_TABLE GROUP BY REPORTS_TO ORDER BY EMPLOYEE_ID"
407,Y,Y,"SELECT M.EMPLOYEE_ID, M.NAME, S.REPORTS_COUNT, S.AVERAGE_AGE FROM EMPLOYEES M JOIN ( SELECT E.REPORTS_TO, COUNT(*) AS REPORTS_COUNT , ROUND(AVG(AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E GROUP BY E.REPORTS_TO ) S ON S.REPORTS_TO = M.EMPLOYEE_ID ORDER BY M.EMPLOYEE_ID"
408,Y,Y,"SELECT E.EMPLOYEE_ID, E.NAME, R.REPORTS_COUNT, R.AVERAGE_AGE FROM EMPLOYEES E JOIN ( SELECT REPORTS_TO AS MANAGER_ID, COUNT(EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(AGE),0) AS AVERAGE_AGE FROM EMPLOYEES GROUP BY REPORTS_TO ) AS R ON E.EMPLOYEE_ID = R.MANAGER_ID WHERE R.REPORTS_COUNT >0 ORDER BY E.EMPLOYEE_ID"
409,Y,Y,"WITH EMPLOYEE_TABLE AS (SELECT A.EMPLOYEE_ID, A.NAME, B.EMPLOYEE_ID AS REPORTING, B.AGE FROM EMPLOYEES AS A JOIN EMPLOYEES AS B ON A.EMPLOYEE_ID = B.REPORTS_TO ) SELECT EMPLOYEE_ID, NAME, COUNT(REPORTING) AS REPORTS_COUNT, ROUND(AVG(AGE),0) AS AVERAGE_AGE FROM EMPLOYEE_TABLE GROUP BY 1, 2 ORDER BY EMPLOYEE_ID"
410,Y,Y,"SELECT E.EMPLOYEE_ID,E.NAME,A.REPORTS_COUNT,A.AVERAGE_AGE FROM (SELECT REPORTS_TO, COUNT(1) AS REPORTS_COUNT, ROUND(AVG(AGE)) AS AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO) A LEFT OUTER JOIN EMPLOYEES E ON E.EMPLOYEE_ID=A.REPORTS_TO ORDER BY E.EMPLOYEE_ID"
411,Y,Y,"WITH A1 AS ( SELECT REPORTS_TO AS EMPLOYEE_ID , ROUND(AVG(AGE),0) AS AVERAGE_AGE, COUNT(REPORTS_TO) AS REPORTS_COUNT FROM EMPLOYEES GROUP BY REPORTS_TO HAVING EMPLOYEE_ID IS NOT NULL ) SELECT A1.EMPLOYEE_ID, E.NAME, A1.REPORTS_COUNT, A1.AVERAGE_AGE FROM A1 LEFT JOIN EMPLOYEES E ON A1.EMPLOYEE_ID = E.EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
412,Y,Y,"SELECT E1. EMPLOYEE_ID, E1.NAME, COUNT(E2.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E2.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 WHERE E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY 1 ORDER BY 1"
413,Y,Y,"SELECT EMPLOYEE_ID, NAME, T.REPORTS_COUNT, T.AVERAGE_AGE FROM EMPLOYEES AS E INNER JOIN (SELECT REPORTS_TO, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(AGE),0) AS AVERAGE_AGE FROM EMPLOYEES GROUP BY REPORTS_TO) AS T ON E.EMPLOYEE_ID=T.REPORTS_TO ORDER BY EMPLOYEE_ID"
414,Y,Y,"SELECT E1.REPORTS_TO AS EMPLOYEE_ID, E2.NAME, COUNT(E1.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E1.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 LEFT JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID WHERE E1.REPORTS_TO IS NOT NULL GROUP BY E1.REPORTS_TO ORDER BY E1.REPORTS_TO"
415,Y,Y,"SELECT M.EMPLOYEE_ID, M.NAME, COUNT(E.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E JOIN EMPLOYEES M ON M.EMPLOYEE_ID = E.REPORTS_TO GROUP BY M.EMPLOYEE_ID ORDER BY M.EMPLOYEE_ID"
416,Y,Y,"SELECT * FROM ( SELECT A.EMPLOYEE_ID, A.NAME, COUNT(B.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(B.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY A.EMPLOYEE_ID ORDER BY A.EMPLOYEE_ID ) S WHERE S.EMPLOYEE_ID IS NOT NULL"
417,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME,COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E2.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY 1,2 ORDER BY 1"
418,Y,Y,"SELECT MGR.EMPLOYEE_ID, MGR.NAME, COUNT(EMP.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(EMP.AGE)) AS AVERAGE_AGE FROM EMPLOYEES EMP JOIN EMPLOYEES MGR ON EMP.REPORTS_TO = MGR.EMPLOYEE_ID GROUP BY EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
419,Y,Y,"SELECT E.EMPLOYEE_ID, E.NAME, T.REPORTS_COUNT, T.AVERAGE_AGE FROM EMPLOYEES E INNER JOIN ( SELECT REPORTS_TO AS MANAGER_ID, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(AGE)) AS AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO ) T ON E.EMPLOYEE_ID = T.MANAGER_ID ORDER BY E.EMPLOYEE_ID"
420,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(B.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(B.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES A LEFT JOIN EMPLOYEES B ON A.EMPLOYEE_ID = B.REPORTS_TO WHERE B.REPORTS_TO IS NOT NULL GROUP BY EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
421,Y,Y,"WITH TMP AS (SELECT REPORTS_TO, ROUND(AVG(AGE)) AVERAGE_AGE, COUNT(1) REPORTS_COUNT FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO) SELECT EMPLOYEE_ID, NAME, REPORTS_COUNT, AVERAGE_AGE FROM TMP INNER JOIN EMPLOYEES ON TMP.REPORTS_TO = EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
422,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(E2.REPORTS_TO)AS REPORTS_COUNT, ROUND(AVG(E2.AGE),0)AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID ORDER BY 1"
423,Y,Y,"SELECT T2.EMPLOYEE_ID, T2.NAME, COUNT(T1.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(T1.AGE)) AS AVERAGE_AGE FROM EMPLOYEES T1 INNER JOIN EMPLOYEES T2 ON T1.REPORTS_TO = T2.EMPLOYEE_ID GROUP BY T2.EMPLOYEE_ID, T2.NAME ORDER BY T2.EMPLOYEE_ID"
424,Y,Y,"SELECT MGR.EMPLOYEE_ID, MGR.NAME, COUNT(1) AS REPORTS_COUNT, ROUND(AVG(RPT.AGE)) AS AVERAGE_AGE FROM EMPLOYEES MGR, EMPLOYEES RPT WHERE RPT.REPORTS_TO = MGR.EMPLOYEE_ID GROUP BY MGR.EMPLOYEE_ID, MGR.NAME ORDER BY MGR.EMPLOYEE_ID"
425,Y,Y,"SELECT MANAGERS.EMPLOYEE_ID AS EMPLOYEE_ID, MANAGERS.NAME AS NAME, COUNT(EMPLOYEES.NAME) AS REPORTS_COUNT, ROUND(AVG(EMPLOYEES.AGE)) AS AVERAGE_AGE FROM EMPLOYEES AS MANAGERS JOIN EMPLOYEES ON MANAGERS.EMPLOYEE_ID = EMPLOYEES.REPORTS_TO GROUP BY MANAGERS.EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
426,Y,Y,"SELECT A.REPORT AS EMPLOYEE_ID, A.MAN_NAME AS NAME, COUNT(A.REPORT) AS REPORTS_COUNT, ROUND(AVG(A.AGE_NEW),0) AS AVERAGE_AGE FROM (SELECT E.EMPLOYEE_ID, E.NAME AS EMP_NAME, E.REPORTS_TO AS REPORT, E.AGE AS AGE_NEW, M.EMPLOYEE_ID AS MAN_ID, M.NAME AS MAN_NAME, M.REPORTS_TO, M.AGE FROM EMPLOYEES AS E JOIN EMPLOYEES AS M ON E.REPORTS_TO = M.EMPLOYEE_ID WHERE E.REPORTS_TO IS NOT NULL) AS A GROUP BY A.REPORT ORDER BY EMPLOYEE_ID"
427,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, (CASE WHEN COUNT(B.REPORTS_TO)=0 THEN NULL ELSE COUNT(B.REPORTS_TO) END) AS REPORTS_COUNT, ROUND(AVG(B.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY EMPLOYEE_ID ORDER BY 1"
428,Y,Y,"SELECT M.EMPLOYEE_ID, M.NAME, COUNT(E.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES AS M JOIN EMPLOYEES AS E ON E.REPORTS_TO = M.EMPLOYEE_ID GROUP BY M.EMPLOYEE_ID ORDER BY M.EMPLOYEE_ID"
429,Y,Y,"SELECT E.EMPLOYEE_ID, E.NAME,M.REPORTS_COUNT,M.AVERAGE_AGE FROM (SELECT REPORTS_TO, COUNT(*) REPORTS_COUNT, ROUND(AVG(AGE),0) AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO) M LEFT JOIN EMPLOYEES E ON M.REPORTS_TO = E.EMPLOYEE_ID ORDER BY E.EMPLOYEE_ID"
430,Y,Y,"SELECT E1.REPORTS_TO AS EMPLOYEE_ID, E2.NAME AS NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E1.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 LEFT JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID WHERE E1.REPORTS_TO IS NOT NULL GROUP BY E1.REPORTS_TO ORDER BY EMPLOYEE_ID"
431,Y,Y,"SELECT A.REPORTS_TO AS EMPLOYEE_ID,B.NAME,COUNT(A.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(A.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A LEFT JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID WHERE A.REPORTS_TO IS NOT NULL GROUP BY 1 ORDER BY 1 ASC"
432,Y,Y,"SELECT A.REPORTS_TO AS EMPLOYEE_ID,B.NAME,COUNT(A.REPORTS_TO) AS REPORTS_COUNT,ROUND(AVG(A.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES A LEFT JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID WHERE A.REPORTS_TO IS NOT NULL GROUP BY 1 ORDER BY 1 ASC"
433,Y,Y,"SELECT B.EMPLOYEE_ID,B.NAME, COUNT(A.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(A.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY 1,2 ORDER BY 1"
434,Y,Y,"SELECT M.EMPLOYEE_ID , M.NAME , COUNT(*) AS REPORTS_COUNT , ROUND(AVG(E.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E INNER JOIN EMPLOYEES M ON E.REPORTS_TO = M.EMPLOYEE_ID GROUP BY M.EMPLOYEE_ID ORDER BY M.EMPLOYEE_ID"
435,Y,Y,"SELECT T2.EMPLOYEE_ID, T2.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(T1.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES T1 LEFT JOIN EMPLOYEES T2 ON T1.REPORTS_TO = T2.EMPLOYEE_ID WHERE T1.REPORTS_TO IS NOT NULL GROUP BY T1.REPORTS_TO ORDER BY EMPLOYEE_ID"
436,Y,Y,"(SELECT A.REPORTS_TO AS EMPLOYEE_ID, B.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(A.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES A LEFT JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID WHERE A.REPORTS_TO IS NOT NULL GROUP BY 1 ORDER BY 1)"
437,Y,Y,"SELECT E2.EMPLOYEE_ID, E2.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E1.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 LEFT JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID WHERE E1.REPORTS_TO IS NOT NULL GROUP BY 1,2 ORDER BY EMPLOYEE_ID"
438,Y,Y,"WITH TMP AS( SELECT T2.EMPLOYEE_ID, T2.NAME, T1.EMPLOYEE_ID AS EMP_ID, T1.AGE FROM EMPLOYEES T1 INNER JOIN EMPLOYEES T2 ON T1.REPORTS_TO = T2.EMPLOYEE_ID ) SELECT EMPLOYEE_ID, NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(AGE),0) AS AVERAGE_AGE FROM TMP GROUP BY EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
439,Y,Y,"SELECT E2.EMPLOYEE_ID, E2.NAME, COUNT(*) REPORTS_COUNT, ROUND(AVG(E1.AGE)) AVERAGE_AGE FROM EMPLOYEES E1 INNER JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY 1 ORDER BY 1"
440,Y,Y,"SELECT E2.EMPLOYEE_ID, E2.NAME,COUNT(E1.REPORTS_TO) AS REPORTS_COUNT,ROUND(AVG(E1.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 RIGHT JOIN EMPLOYEES E2 ON E1.REPORTS_TO =E2.EMPLOYEE_ID WHERE E1.REPORTS_TO IS NOT NULL GROUP BY E2.EMPLOYEE_ID UNION SELECT E2.EMPLOYEE_ID,E2.NAME,COUNT(E1.REPORTS_TO) AS REPORTS_COUNT,ROUND(AVG(E1.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES AS E1 RIGHT JOIN EMPLOYEES AS E2 ON E1.REPORTS_TO =E2.EMPLOYEE_ID WHERE E2.REPORTS_TO IS NULL AND E1.REPORTS_TO IS NOT NULL GROUP BY E2.EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
441,Y,Y,"SELECT B.EMPLOYEE_ID,B.NAME,COUNT(*) AS REPORTS_COUNT,ROUND(AVG(A.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO=B.EMPLOYEE_ID GROUP BY 1 ORDER BY 1"
442,Y,Y,"SELECT B.EMPLOYEE_ID, B.NAME, COUNT(A.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(A.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES A INNER JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY 1,2 ORDER BY 1"
443,Y,Y,"SELECT E.REPORTS_TO AS EMPLOYEE_ID, M.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES AS E, EMPLOYEES AS M WHERE E.REPORTS_TO = M.EMPLOYEE_ID GROUP BY E.REPORTS_TO HAVING COUNT(*) >= 1 ORDER BY EMPLOYEE_ID"
444,Y,Y,"SELECT M.EMPLOYEE_ID, M.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES AS E INNER JOIN EMPLOYEES AS M ON E.REPORTS_TO = M.EMPLOYEE_ID GROUP BY 1,2 ORDER BY 1"
445,Y,Y,"SELECT B.EMPLOYEE_ID, B.NAME, COUNT(*) REPORTS_COUNT, ROUND(AVG(E.AGE),0) AVERAGE_AGE FROM EMPLOYEES B JOIN EMPLOYEES E ON B.EMPLOYEE_ID = E.REPORTS_TO GROUP BY B.EMPLOYEE_ID ORDER BY B.EMPLOYEE_ID"
446,Y,Y,"SELECT E.EMPLOYEE_ID, E.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(M.AGE)) AS AVERAGE_AGE FROM EMPLOYEES AS E JOIN EMPLOYEES AS M ON E.EMPLOYEE_ID = M.REPORTS_TO GROUP BY E.EMPLOYEE_ID ORDER BY E.EMPLOYEE_ID ASC"
447,Y,Y,"SELECT A.REPORTS_TO AS EMPLOYEE_ID, B.NAME, COUNT(A.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(A.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES A LEFT OUTER JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID WHERE A.REPORTS_TO IS NOT NULL GROUP BY A.REPORTS_TO ORDER BY EMPLOYEE_ID"
448,Y,Y,"SELECT E.EMPLOYEE_ID, NAME, REPORTS_COUNT, AVERAGE_AGE FROM ( SELECT DISTINCT(REPORTS_TO) AS EMPLOYEE_ID, COUNT(REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO ) TMP JOIN EMPLOYEES AS E ON E.EMPLOYEE_ID = TMP.EMPLOYEE_ID ORDER BY E.EMPLOYEE_ID"
449,Y,Y,"WITH CTE AS (SELECT B.EMPLOYEE_ID AS EMPLOYEE_ID, B.NAME AS NAME, A.AGE AS AGE FROM EMPLOYEES A, EMPLOYEES B WHERE B.EMPLOYEE_ID = A.REPORTS_TO) SELECT EMPLOYEE_ID, NAME, COUNT(EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(AGE), 0) AS AVERAGE_AGE FROM CTE GROUP BY EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
450,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(*) REPORTS_COUNT, ROUND(AVG(E2.AGE)) AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID, E1.NAME ORDER BY E1.EMPLOYEE_ID"
451,Y,Y,"SELECT E2.EMPLOYEE_ID, E2.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E1.AGE)) AS AVERAGE_AGE FROM EMPLOYEES AS E1 INNER JOIN EMPLOYEES AS E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY E1.REPORTS_TO ORDER BY E1.REPORTS_TO"
452,Y,Y,"SELECT E2.EMPLOYEE_ID, E2.NAME, COUNT(E1.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E1.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID WHERE E1.REPORTS_TO IS NOT NULL GROUP BY E2.EMPLOYEE_ID, E2.NAME ORDER BY E2.EMPLOYEE_ID"
453,Y,Y,"SELECT A.* FROM ( SELECT A.REPORTS_TO AS EMPLOYEE_ID, A.NAME, COUNT(*) AS REPORTS_COUNT , ROUND(AVG(A.AGE)) AS AVERAGE_AGE FROM ( SELECT E.EMPLOYEE_ID, E.REPORTS_TO, E1.NAME, E.AGE FROM EMPLOYEES E JOIN EMPLOYEES E1 ON E.REPORTS_TO =E1.EMPLOYEE_ID ORDER BY 1 DESC)A GROUP BY 1,2 ORDER BY 1)A WHERE A.EMPLOYEE_ID IS NOT NULL"
454,Y,Y,"WITH COUNTS AS (SELECT REPORTS_TO EMPLOYEE_ID, COUNT(EMPLOYEE_ID) REPORTS_COUNT, ROUND(AVG(AGE), 0) AVERAGE_AGE FROM EMPLOYEES GROUP BY REPORTS_TO) SELECT COUNTS.EMPLOYEE_ID, EMPLOYEES.NAME, COUNTS.REPORTS_COUNT, COUNTS.AVERAGE_AGE FROM COUNTS INNER JOIN EMPLOYEES ON COUNTS.EMPLOYEE_ID = EMPLOYEES.EMPLOYEE_ID ORDER BY EMPLOYEE_ID ASC"
455,Y,Y,"SELECT E2.EMPLOYEE_ID, E2.NAME, COUNT(E1.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(E1.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.REPORTS_TO=E2.EMPLOYEE_ID GROUP BY E2.EMPLOYEE_ID ORDER BY E2.EMPLOYEE_ID"
456,Y,Y,"SELECT E2.EMPLOYEE_ID, E2.NAME, COUNT(*) REPORTS_COUNT, ROUND(AVG(E1.AGE),0) AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E2.EMPLOYEE_ID=E1.REPORTS_TO GROUP BY 1,2 ORDER BY 1"
457,Y,Y,"SELECT EMPLOYEE_ID, NAME, REPORTS_COUNT, AVERAGE_AGE FROM EMPLOYEES JOIN ( SELECT REPORTS_TO, COUNT(REPORTS_TO ) AS REPORTS_COUNT, CAST(AVG(AGE) AS UNSIGNED) AS AVERAGE_AGE FROM EMPLOYEES GROUP BY REPORTS_TO) T ON T.REPORTS_TO = EMPLOYEES.EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
458,Y,Y,"SELECT E2.EMPLOYEE_ID, E2.NAME, COUNT(DISTINCT E1.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E1.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 LEFT JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID WHERE E2.EMPLOYEE_ID IS NOT NULL GROUP BY E1.REPORTS_TO ORDER BY E2.EMPLOYEE_ID"
459,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(E2.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E2.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON (E1.EMPLOYEE_ID = E2.REPORTS_TO) GROUP BY E1.EMPLOYEE_ID, E1.NAME ORDER BY E1.EMPLOYEE_ID"
460,Y,Y,"SELECT B.EMPLOYEE_ID, B.NAME, COUNT(A.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(A.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES A INNER JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY B.EMPLOYEE_ID ORDER BY 1"
461,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(B.AGE)) AS AVERAGE_AGE FROM EMPLOYEES AS A JOIN EMPLOYEES AS B ON A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY A.EMPLOYEE_ID, A.NAME ORDER BY EMPLOYEE_ID"
462,Y,Y,"SELECT DISTINCT A.REPORTS_TO AS EMPLOYEE_ID, B.NAME, COUNT(A.EMPLOYEE_ID) OVER(PARTITION BY A.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(A.AGE) OVER(PARTITION BY A.REPORTS_TO),0) AS AVERAGE_AGE FROM EMPLOYEES A, EMPLOYEES B WHERE A.REPORTS_TO=B.EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
463,Y,Y,"SELECT M.EMPLOYEE_ID AS EMPLOYEE_ID, M.NAME, COUNT(DISTINCT E.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E.AGE)) AS AVERAGE_AGE FROM EMPLOYEES M INNER JOIN EMPLOYEES E ON E.REPORTS_TO = M.EMPLOYEE_ID GROUP BY 1,2"
464,Y,Y,"SELECT E.EMPLOYEE_ID, E.NAME, MANAGER.REPORTS_COUNT, ROUND(MANAGER.AVERAGE_AGE) AS AVERAGE_AGE FROM EMPLOYEES AS E JOIN (SELECT REPORTS_TO AS ID, COUNT(REPORTS_TO) AS REPORTS_COUNT , AVG(AGE) AS AVERAGE_AGE FROM EMPLOYEES GROUP BY REPORTS_TO) AS MANAGER ON MANAGER.ID = E.EMPLOYEE_ID ORDER BY E.EMPLOYEE_ID"
465,Y,Y,"WITH CTE1 AS( SELECT REPORTS_TO, COUNT(REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(AGE),0) AS AVERAGE_AGE FROM EMPLOYEES GROUP BY 1) SELECT CTE1.REPORTS_TO AS EMPLOYEE_ID, NAME, REPORTS_COUNT, AVERAGE_AGE FROM CTE1 JOIN EMPLOYEES E ON CTE1.REPORTS_TO = E.EMPLOYEE_ID ORDER BY 1"
466,Y,Y,"SELECT E.REPORTS_TO EMPLOYEE_ID, E1.NAME, COUNT(E.EMPLOYEE_ID) REPORTS_COUNT, ROUND(AVG(E.AGE),0) AVERAGE_AGE FROM EMPLOYEES E INNER JOIN EMPLOYEES E1 ON E.REPORTS_TO=E1.EMPLOYEE_ID GROUP BY E.REPORTS_TO ORDER BY 1"
467,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, SUM(E1.EMPLOYEE_ID=E2.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(E2.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID=E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID ORDER BY E1.EMPLOYEE_ID ASC"
468,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, IFNULL(COUNT(B.REPORTS_TO), 0) REPORTS_COUNT, ROUND(AVG(B.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES A, EMPLOYEES B WHERE A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY A.EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
469,Y,Y,"SELECT B.EMPLOYEE_ID, B.NAME, COUNT(A.NAME) AS REPORTS_COUNT , ROUND(AVG(A.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES A LEFT JOIN EMPLOYEES B ON (A.REPORTS_TO - B.EMPLOYEE_ID ) = 0 WHERE A.REPORTS_TO IS NOT NULL GROUP BY B.EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
470,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(B.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(B.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES A, EMPLOYEES B WHERE A.EMPLOYEE_ID=B.REPORTS_TO GROUP BY 1, 2 ORDER BY 1"
471,Y,Y,"SELECT E.REPORTS_TO AS EMPLOYEE_ID, M.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E JOIN EMPLOYEES M ON E.REPORTS_TO = M.EMPLOYEE_ID GROUP BY M.EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
472,Y,Y,"WITH T1 AS (SELECT EMPLOYEE_ID, NAME, REPORTS_TO, AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL) SELECT DISTINCT T1.REPORTS_TO AS EMPLOYEE_ID, E.NAME AS NAME, COUNT(T1.EMPLOYEE_ID) OVER (PARTITION BY T1.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(T1.AGE) OVER (PARTITION BY T1.REPORTS_TO),0) AS AVERAGE_AGE FROM T1 JOIN EMPLOYEES E ON T1.REPORTS_TO = E.EMPLOYEE_ID"
473,Y,Y,"SELECT T1.REPORTS_TO AS EMPLOYEE_ID, T2.NAME, T1.REPORTS_COUNT, T1.AVERAGE_AGE FROM (SELECT REPORTS_TO, COUNT(DISTINCT(EMPLOYEE_ID)) AS REPORTS_COUNT, ROUND(AVG(AGE)) AS AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO ) T1 JOIN EMPLOYEES T2 ON T1.REPORTS_TO = T2.EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
474,Y,Y,"WITH TEMP AS (SELECT REPORTS_TO AS MANAGER_ID, COUNT(EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(AGE),0) AS AVG_AGE FROM EMPLOYEES GROUP BY 1 HAVING REPORTS_TO IS NOT NULL) SELECT E.EMPLOYEE_ID, E.NAME, T.REPORTS_COUNT, T.AVG_AGE AS AVERAGE_AGE FROM TEMP T JOIN EMPLOYEES E WHERE T.MANAGER_ID = E.EMPLOYEE_ID ORDER BY 1"
475,Y,Y,"SELECT M.EMPLOYEE_ID, M.NAME, COUNT(E.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES M JOIN EMPLOYEES E ON M.EMPLOYEE_ID = E.REPORTS_TO GROUP BY 1 HAVING COUNT(E.EMPLOYEE_ID) >= 1 ORDER BY 1"
476,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(B.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(B.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES A INNER JOIN EMPLOYEES B ON A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY A.EMPLOYEE_ID ORDER BY A.EMPLOYEE_ID"
477,Y,Y,"SELECT T1.REPORTS_TO AS EMPLOYEE_ID, T2.NAME, T1.REPORTS_COUNT, T1.AVERAGE_AGE FROM (SELECT REPORTS_TO, COUNT(EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(AGE)) AS AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO) T1 JOIN EMPLOYEES T2 WHERE T1.REPORTS_TO = T2.EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
478,Y,Y,"SELECT B.EMPLOYEE_ID, B.NAME, COUNT(*) REPORTS_COUNT, ROUND(AVG(A.AGE)) AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY 1 ORDER BY 1"
479,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(1) AS REPORTS_COUNT, ROUND(AVG(E2.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES E1, EMPLOYEES E2 WHERE E2.REPORTS_TO= E1.EMPLOYEE_ID GROUP BY E1.EMPLOYEE_ID, E1.NAME ORDER BY E1.EMPLOYEE_ID"
480,Y,Y,"SELECT A.EMPLOYEE_ID AS EMPLOYEE_ID, A.NAME AS NAME, COUNT(B.AGE) AS REPORTS_COUNT, ROUND(AVG(B.AGE)) AS AVERAGE_AGE FROM EMPLOYEES AS A JOIN EMPLOYEES AS B ON A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY A.EMPLOYEE_ID ORDER BY A.EMPLOYEE_ID"
481,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, REPORTS_COUNT, AVERAGE_AGE FROM EMPLOYEES E1 ,(SELECT E.REPORTS_TO, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES E WHERE E.REPORTS_TO IS NOT NULL GROUP BY E.REPORTS_TO) MANAGER WHERE MANAGER.REPORTS_TO = E1.EMPLOYEE_ID ORDER BY E1.EMPLOYEE_ID"
482,Y,Y,"SELECT T0.EMPLOYEE_ID, T0.NAME, COUNT(DISTINCT T1.EMPLOYEE_ID) REPORTS_COUNT, ROUND(AVG(T1.AGE),0) AVERAGE_AGE FROM EMPLOYEES T0 INNER JOIN EMPLOYEES T1 ON T0.EMPLOYEE_ID = T1.REPORTS_TO GROUP BY 1,2 ORDER BY 1"
483,Y,Y,"SELECT E2.EMPLOYEE_ID,E2.NAME,COUNT(E1.EMPLOYEE_ID) AS REPORTS_COUNT,ROUND(AVG(E1.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1, EMPLOYEES E2 WHERE E1.REPORTS_TO=E2.EMPLOYEE_ID GROUP BY 1 ORDER BY 1"
484,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(*) REPORTS_COUNT, ROUND(AVG(E2.AGE),0) AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID, E1.NAME ORDER BY E1.EMPLOYEE_ID"
485,Y,Y,"SELECT A.EMPLOYEE_ID AS EMPLOYEE_ID , A.NAME AS NAME , COUNT(B.EMPLOYEE_ID) AS REPORTS_COUNT , ROUND(AVG(B.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON B.REPORTS_TO = A.EMPLOYEE_ID GROUP BY 1 ORDER BY 1"
486,Y,Y,"SELECT A.REPORTS_TO AS EMPLOYEE_ID, B.NAME, COUNT(A.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(A.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY A.REPORTS_TO ORDER BY A.REPORTS_TO"
487,Y,Y,"SELECT B.EMPLOYEE_ID, A.NAME, B.REPORTS_COUNT,B.AVERAGE_AGE FROM EMPLOYEES A RIGHT JOIN ( SELECT REPORTS_TO AS EMPLOYEE_ID, ROUND(AVG(AGE),0) AS AVERAGE_AGE, COUNT(DISTINCT EMPLOYEE_ID) AS REPORTS_COUNT FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO ) B ON A.EMPLOYEE_ID=B.EMPLOYEE_ID"
488,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(*) REPORTS_COUNT, ROUND(AVG(E2.AGE)) AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID=E2.REPORTS_TO GROUP BY 1,2 ORDER BY 1,2"
489,Y,Y,"SELECT M.EMPLOYEE_ID, M.NAME, COUNT(E.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES M INNER JOIN EMPLOYEES E ON M.EMPLOYEE_ID=E.REPORTS_TO GROUP BY M.EMPLOYEE_ID ORDER BY M.EMPLOYEE_ID"
490,Y,Y,"SELECT A.EMPLOYEE_ID,A.NAME,COUNT(DISTINCT B.EMPLOYEE_ID) REPORTS_COUNT, ROUND(AVG(B.AGE)) AVERAGE_AGE FROM EMPLOYEES A, EMPLOYEES B WHERE A.EMPLOYEE_ID=B.REPORTS_TO GROUP BY 1,2"
491,Y,Y,"SELECT E1.REPORTS_TO AS EMPLOYEE_ID, E2.NAME, COUNT(E1.NAME) AS REPORTS_COUNT, ROUND(AVG(E1.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1, EMPLOYEES E2 WHERE E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
492,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(1) AS REPORTS_COUNT, ROUND(AVG(B.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES A, EMPLOYEES B WHERE A.EMPLOYEE_ID=B.REPORTS_TO GROUP BY A.EMPLOYEE_ID, A.NAME ORDER BY A.EMPLOYEE_ID"
493,Y,Y,"SELECT E2.EMPLOYEE_ID, E2.NAME, COUNT(E1.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(SUM(E1.AGE)/COUNT(*),0) AS AVERAGE_AGE FROM EMPLOYEES E1, EMPLOYEES E2 WHERE E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY 1 ORDER BY 1"
494,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E2.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY 1 ORDER BY 1"
495,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(B.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(B.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY EMPLOYEE_ID ORDER BY 1"
496,Y,Y,"WITH CTE AS ( SELECT REPORTS_TO AS EMPLOYEE_ID, COUNT(EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(AGE)) AS AVERAGE_AGE FROM EMPLOYEES GROUP BY REPORTS_TO) SELECT CTE.EMPLOYEE_ID, E.NAME, CTE.REPORTS_COUNT, CTE.AVERAGE_AGE FROM CTE JOIN EMPLOYEES AS E ON CTE.EMPLOYEE_ID = E.EMPLOYEE_ID ORDER BY 1"
497,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(DISTINCT E2.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E2.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY 1,2"
498,Y,Y,"SELECT T1.REPORTS_TO AS EMPLOYEE_ID, T2.NAME, COUNT(T1.EMPLOYEE_ID) AS REPORTS_COUNT, CAST(AVG(T1.AGE) AS DECIMAL(15,0)) AS AVERAGE_AGE FROM EMPLOYEES T1 JOIN EMPLOYEES T2 ON T1.REPORTS_TO=T2.EMPLOYEE_ID GROUP BY 1,2 HAVING COUNT(T1.EMPLOYEE_ID)>=1 ORDER BY 1"
499,Y,Y,"SELECT M.EMPLOYEE_ID,M.NAME,COUNT(E.EMPLOYEE_ID) AS REPORTS_COUNT,ROUND(AVG(E.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E JOIN EMPLOYEES M ON E.REPORTS_TO=M.EMPLOYEE_ID AND E.REPORTS_TO IS NOT NULL GROUP BY E.REPORTS_TO ORDER BY M.EMPLOYEE_ID"
500,Y,N,"SELECT REPORTS_TO AS EMPLOYEE_ID , (SELECT NAME FROM EMPLOYEES WHERE EMPLOYEE_ID = E.REPORTS_TO) AS NAME , COUNT(*) AS REPORTS_COUNT , ROUND(AVG(AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E GROUP BY REPORTS_TO HAVING REPORTS_TO <> 'NULL' ORDER BY REPORTS_TO"
501,Y,Y,"SELECT T1.EMPLOYEE_ID, T1.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(T2.AGE)) AS AVERAGE_AGE FROM EMPLOYEES T1 JOIN EMPLOYEES T2 ON T1.EMPLOYEE_ID = T2.REPORTS_TO AND T2.EMPLOYEE_ID IS NOT NULL GROUP BY T1.EMPLOYEE_ID ORDER BY T1.EMPLOYEE_ID"
502,Y,Y,"SELECT EMPLOYEES.EMPLOYEE_ID, NAME, A.CNT AS REPORTS_COUNT, ROUND(A.AGE) AS AVERAGE_AGE FROM EMPLOYEES INNER JOIN ( SELECT REPORTS_TO, AVG(AGE) AS AGE,COUNT(*) AS CNT FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY 1) A ON EMPLOYEES.EMPLOYEE_ID = A.REPORTS_TO GROUP BY 1 ORDER BY 1"
503,Y,Y,"SELECT A.REPORTS_TO AS EMPLOYEE_ID, B.NAME, COUNT(DISTINCT A.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(A.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY 1 ORDER BY 1"
504,Y,Y,"SELECT E2.EMPLOYEE_ID, E2.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E1.AGE)) AS AVERAGE_AGE FROM EMPLOYEES AS E1 INNER JOIN EMPLOYEES AS E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY E1.REPORTS_TO, E2.NAME ORDER BY E1.REPORTS_TO"
505,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(B.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B WHERE A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY 1 ORDER BY 1"
506,Y,Y,"SELECT E2.EMPLOYEE_ID AS EMPLOYEE_ID, E2.NAME AS NAME, COUNT(E1.REPORTS_TO) AS REPORTS_COUNT, CAST(AVG(E1.AGE) AS UNSIGNED) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID WHERE E1.REPORTS_TO IS NOT NULL GROUP BY E2.EMPLOYEE_ID, E2.NAME ORDER BY E2.EMPLOYEE_ID"
507,Y,Y,"SELECT B.EMPLOYEE_ID, B.NAME, COUNT(B.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(A.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY 1 ORDER BY 1"
508,Y,Y,"WITH TABLE1 AS (SELECT REPORTS_TO, COUNT(*) AS REPORTS_COUNT, ROUND(SUM(AGE)/COUNT(*),0) AS AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO) SELECT DISTINCT E.EMPLOYEE_ID, NAME, T1.REPORTS_COUNT, T1.AVERAGE_AGE FROM EMPLOYEES E, TABLE1 T1 WHERE E.EMPLOYEE_ID = T1.REPORTS_TO ORDER BY E.EMPLOYEE_ID"
509,Y,Y,"SELECT E.EMPLOYEE_ID , E.NAME , COUNT(*) AS REPORTS_COUNT , ROUND(AVG(E1.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E JOIN EMPLOYEES E1 ON (E.EMPLOYEE_ID = E1.REPORTS_TO) GROUP BY E.EMPLOYEE_ID , E.NAME ORDER BY EMPLOYEE_ID"
510,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(E2.REPORTS_TO) REPORTS_COUNT, ROUND(AVG(E2.AGE),0) AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E2.REPORTS_TO=E1.EMPLOYEE_ID GROUP BY E1.EMPLOYEE_ID ORDER BY E1.EMPLOYEE_ID"
511,Y,Y,"SELECT A.REPORTS_TO AS EMPLOYEE_ID, B.NAME AS NAME, COUNT(A.EMPLOYEE_ID) AS REPORTS_COUNT , ROUND(AVG(A.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A INNER JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID WHERE A.REPORTS_TO IS NOT NULL GROUP BY 1,2 ORDER BY 1,2"
512,Y,Y,"SELECT E1.REPORTS_TO AS EMPLOYEE_ID, E2.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E1.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES AS E1 JOIN EMPLOYEES AS E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY 1 ORDER BY 1"
513,Y,Y,"SELECT EM.EMPLOYEE_ID, EM.NAME, COUNT(E.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E LEFT JOIN EMPLOYEES EM ON E.REPORTS_TO = EM.EMPLOYEE_ID WHERE EM.EMPLOYEE_ID IS NOT NULL GROUP BY EMPLOYEE_ID, NAME HAVING REPORTS_COUNT>=1 ORDER BY EMPLOYEE_ID"
514,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(B.REPORTS_TO)REPORTS_COUNT, ROUND(AVG(B.AGE),0)AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY A.EMPLOYEE_ID ORDER BY 1"
515,Y,Y,"WITH T AS ( SELECT REPORTS_TO, COUNT(REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO ) SELECT EMPLOYEE_ID, NAME, REPORTS_COUNT, AVERAGE_AGE FROM EMPLOYEES E JOIN T ON E.EMPLOYEE_ID = T.REPORTS_TO ORDER BY EMPLOYEE_ID"
516,Y,Y,"SELECT M.EMPLOYEE_ID,M.NAME,COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E JOIN EMPLOYEES M ON E.REPORTS_TO = M.EMPLOYEE_ID GROUP BY 1 ORDER BY 1"
517,Y,Y,"SELECT A.REPORTS_TO AS EMPLOYEE_ID, B.NAME, COUNT(DISTINCT A.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(A.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY A.REPORTS_TO ORDER BY A.REPORTS_TO"
518,Y,Y,"SELECT M.EMPLOYEE_ID, M.NAME, COUNT(E.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E JOIN EMPLOYEES M ON E.REPORTS_TO = M.EMPLOYEE_ID GROUP BY M.EMPLOYEE_ID ORDER BY 1"
519,Y,Y,"SELECT MANAGERS.EMPLOYEE_ID, MANAGERS.NAME , COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES MANAGERS LEFT JOIN EMPLOYEES E ON MANAGERS.EMPLOYEE_ID=E.REPORTS_TO WHERE E.NAME IS NOT NULL GROUP BY MANAGERS.EMPLOYEE_ID ORDER BY MANAGERS.EMPLOYEE_ID"
520,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(E2.EMPLOYEE_ID) REPORTS_COUNT, ROUND(AVG(E2.AGE)) AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY 1,2 ORDER BY 1,2"
521,Y,Y,"SELECT DISTINCT A.EMPLOYEE_ID, A.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(B.AGE),0)AS AVERAGE_AGE FROM EMPLOYEES AS A LEFT JOIN EMPLOYEES AS B ON A.EMPLOYEE_ID=B.REPORTS_TO GROUP BY A.EMPLOYEE_ID HAVING COUNT(B.NAME)>=1 ORDER BY A.EMPLOYEE_ID"
522,Y,Y,"SELECT E.EMPLOYEE_ID, E.NAME, T1.REPORTS_COUNT, T1.AVG_AGE AVERAGE_AGE FROM ( SELECT REPORTS_TO, COUNT(REPORTS_TO) REPORTS_COUNT, ROUND(AVG(AGE),0) AVG_AGE FROM EMPLOYEES GROUP BY REPORTS_TO HAVING REPORTS_TO IS NOT NULL ) T1 LEFT JOIN EMPLOYEES E ON E.EMPLOYEE_ID = T1.REPORTS_TO ORDER BY E.EMPLOYEE_ID"
523,Y,Y,"SELECT E1.EMPLOYEE_ID AS EMPLOYEE_ID, E1.NAME AS NAME, COUNT(E2.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(E2.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY 1 ORDER BY 1"
524,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(B.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(B.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B WHERE A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY A.EMPLOYEE_ID ORDER BY A.EMPLOYEE_ID"
525,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(E2.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E2.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID ORDER BY E1.EMPLOYEE_ID"
526,Y,Y,"SELECT M.EMPLOYEE_ID,M.NAME,COUNT(E.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES E JOIN EMPLOYEES M ON E.REPORTS_TO=M.EMPLOYEE_ID GROUP BY M.EMPLOYEE_ID ORDER BY M.EMPLOYEE_ID"
527,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(B.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(B.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES A LEFT JOIN EMPLOYEES B ON A.EMPLOYEE_ID = B.REPORTS_TO WHERE B.EMPLOYEE_ID IS NOT NULL GROUP BY A.EMPLOYEE_ID, A.NAME ORDER BY A.EMPLOYEE_ID"
528,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, E2.SUBS AS REPORTS_COUNT, E2.AVERAGE_AGE FROM EMPLOYEES AS E1 LEFT JOIN ( SELECT REPORTS_TO AS MANAGER, COUNT(*) AS SUBS, ROUND(AVG(AGE)) AS AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO ) AS E2 ON E1.EMPLOYEE_ID = E2.MANAGER WHERE E2.SUBS IS NOT NULL ORDER BY E1.EMPLOYEE_ID"
529,Y,Y,"SELECT E1.REPORTS_TO AS EMPLOYEE_ID, E2.NAME AS NAME, COUNT(DISTINCT E1.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(SUM(E1.AGE)/COUNT(DISTINCT E1.EMPLOYEE_ID),0) AS AVERAGE_AGE FROM EMPLOYEES E1 LEFT JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID WHERE E1.REPORTS_TO IS NOT NULL GROUP BY 1,2"
530,Y,Y,"SELECT A.REPORTS_TO AS EMPLOYEE_ID,B.NAME,COUNT(*) AS REPORTS_COUNT, ROUND(AVG(A.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO=B.EMPLOYEE_ID WHERE A.REPORTS_TO IS NOT NULL GROUP BY 1 ORDER BY 1"
531,Y,Y,"SELECT E.EMPLOYEE_ID, E.NAME, S.REPORTS_COUNT, S.AVERAGE_AGE FROM EMPLOYEES E JOIN (SELECT REPORTS_TO, COUNT(EMPLOYEE_ID) REPORTS_COUNT, ROUND(AVG(AGE),0) AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO) S ON E.EMPLOYEE_ID = S.REPORTS_TO ORDER BY E.EMPLOYEE_ID"
532,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(DISTINCT E2.EMPLOYEE_ID) AS REPORTS_COUNT , ROUND(AVG(IFNULL(E2.AGE,0)), 0) AS AVERAGE_AGE FROM EMPLOYEES E1 INNER JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID, E1.NAME ORDER BY E1.EMPLOYEE_ID"
533,Y,Y,"SELECT B.EMPLOYEE_ID, B.NAME, COUNT(*) REPORTS_COUNT, ROUND(AVG(A.AGE)) AVERAGE_AGE FROM EMPLOYEES A, EMPLOYEES B WHERE A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY 1 ORDER BY 1"
534,Y,Y,"SELECT E2.EMPLOYEE_ID, E2.NAME, COUNT(E2.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E1.AGE)) AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY 1 ORDER BY 1"
535,Y,Y,"SELECT M.EMPLOYEE_ID, M.NAME, COUNT(E.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E.AGE)) AS AVERAGE_AGE FROM EMPLOYEES M JOIN EMPLOYEES E ON E.REPORTS_TO = M.EMPLOYEE_ID GROUP BY M.EMPLOYEE_ID ORDER BY 1"
536,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(E2.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E2.AGE)) AS AVERAGE_AGE FROM (SELECT DISTINCT EMPLOYEE_ID, NAME FROM EMPLOYEES WHERE EMPLOYEE_ID IN (SELECT REPORTS_TO FROM EMPLOYEES)) E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID ORDER BY 1"
537,Y,Y,"WITH ALLMANAGERS AS (SELECT DISTINCT REPORTS_TO AS EMPLOYEE_ID,COUNT(EMPLOYEE_ID) OVER(PARTITION BY REPORTS_TO) AS REPORTS_COUNT,ROUND(AVG(AGE) OVER(PARTITION BY REPORTS_TO)) AS AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL) SELECT A.EMPLOYEE_ID,E.NAME,A.REPORTS_COUNT,A.AVERAGE_AGE FROM ALLMANAGERS A,EMPLOYEES E WHERE A.EMPLOYEE_ID = E.EMPLOYEE_ID ORDER BY 1"
538,Y,Y,"WITH GET_DETAILS AS ( SELECT E.REPORTS_TO ,COUNT(EMPLOYEE_ID) AS REPORTS_COUNT ,ROUND(AVG(E.AGE)) AS AVERAGE_AGE FROM EMPLOYEES AS E GROUP BY E.REPORTS_TO ) SELECT E.EMPLOYEE_ID,E.NAME, G.REPORTS_COUNT,G.AVERAGE_AGE FROM GET_DETAILS AS G JOIN EMPLOYEES AS E ON E.EMPLOYEE_ID=G.REPORTS_TO ORDER BY E.EMPLOYEE_ID"
539,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(B.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON B.REPORTS_TO = A.EMPLOYEE_ID GROUP BY 1 ORDER BY 1"
540,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(B.EMPLOYEE_ID) AS REPORTS_COUNT , ROUND(AVG(B.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY 1 ORDER BY 1"
541,Y,Y,"SELECT A.EMPLOYEE_ID,A.NAME,COUNT(*) AS REPORTS_COUNT,ROUND(AVG(B.AGE))AS AVERAGE_AGE FROM EMPLOYEES AS A JOIN EMPLOYEES AS B ON A.EMPLOYEE_ID=B.REPORTS_TO GROUP BY 1 ORDER BY 1"
542,Y,Y,"SELECT M.EMPLOYEE_ID AS EMPLOYEE_ID, M.NAME AS NAME, COUNT(E.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES M INNER JOIN EMPLOYEES E ON E.REPORTS_TO = M.EMPLOYEE_ID GROUP BY M.EMPLOYEE_ID ORDER BY M.EMPLOYEE_ID"
543,Y,Y,"SELECT E.EMPLOYEE_ID, E.NAME, COUNT(S.REPORTS_TO) REPORTS_COUNT, ROUND(AVG(S.AGE)) AVERAGE_AGE FROM EMPLOYEES E JOIN EMPLOYEES S ON (E.EMPLOYEE_ID = S.REPORTS_TO) GROUP BY E.EMPLOYEE_ID ORDER BY E.EMPLOYEE_ID"
544,Y,Y,"SELECT S.EMPLOYEE_ID,S.NAME,COUNT(E.EMPLOYEE_ID) AS REPORTS_COUNT,ROUND(AVG(E.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E JOIN EMPLOYEES S ON E.REPORTS_TO = S.EMPLOYEE_ID GROUP BY S.EMPLOYEE_ID,S.NAME ORDER BY S.EMPLOYEE_ID"
545,Y,Y,"SELECT M.EMPLOYEE_ID , M.NAME , COUNT(DISTINCT E.EMPLOYEE_ID ) AS REPORTS_COUNT , ROUND(AVG(E.AGE )) AS AVERAGE_AGE FROM EMPLOYEES M JOIN EMPLOYEES E ON (M.EMPLOYEE_ID =E.REPORTS_TO) GROUP BY M.EMPLOYEE_ID , M.NAME ORDER BY 1"
546,Y,Y,"SELECT B.EMPLOYEE_ID, B.NAME, COUNT(A.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(A.AGE))AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
547,Y,Y,"SELECT DISTINCT E1.EMPLOYEE_ID , E1.NAME , COUNT(E2.REPORTS_TO) REPORTS_COUNT , ROUND(AVG(E2.AGE),0) AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY 1,2 ORDER BY 1"
548,Y,Y,"SELECT E1.EMPLOYEE_ID AS EMPLOYEE_ID, E1.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E2.AGE)) AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID HAVING REPORTS_COUNT>=1 ORDER BY EMPLOYEE_ID"
549,Y,Y,"WITH REPORTS AS ( SELECT E1.EMPLOYEE_ID AS MANAGER_ID, E1.NAME, E2.EMPLOYEE_ID AS REPORTEE_ID, E2.AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO ) SELECT MANAGER_ID AS EMPLOYEE_ID, NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(AGE)) AS AVERAGE_AGE FROM REPORTS GROUP BY MANAGER_ID ORDER BY MANAGER_ID"
550,Y,Y,"SELECT E2.EMPLOYEE_ID AS EMPLOYEE_ID, E2.NAME AS NAME, COUNT(E1.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E1.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.REPORTS_TO =E2.EMPLOYEE_ID GROUP BY E2.EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
551,Y,Y,"SELECT B.EMPLOYEE_ID, B.NAME, COUNT(A.REPORTS_TO) AS REPORTS_COUNT,ROUND(AVG(A.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A INNER JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY A.REPORTS_TO ORDER BY B.EMPLOYEE_ID"
552,Y,Y,"SELECT E1.REPORTS_TO AS EMPLOYEE_ID, E2.NAME AS NAME, COUNT(E1.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E1.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY 1,2 ORDER BY 1"
553,Y,Y,"SELECT M.EMPLOYEE_ID, M.NAME, COUNT(E.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(E.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E LEFT JOIN EMPLOYEES M ON E.REPORTS_TO = M.EMPLOYEE_ID GROUP BY M.EMPLOYEE_ID HAVING COUNT(E.REPORTS_TO) >= 1 ORDER BY EMPLOYEE_ID"
554,Y,Y,"SELECT M.EMPLOYEE_ID, M.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E.AGE)) AS AVERAGE_AGE FROM EMPLOYEES M, EMPLOYEES E WHERE M.EMPLOYEE_ID = E.REPORTS_TO GROUP BY M.EMPLOYEE_ID, M.NAME ORDER BY M.EMPLOYEE_ID"
555,Y,Y,"SELECT B.EMPLOYEE_ID AS EMPLOYEE_ID, B.NAME AS NAME, COUNT(A.EMPLOYEE_ID) AS REPORTS_COUNT , ROUND(SUM(A.AGE)/COUNT(A.EMPLOYEE_ID),0) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO =B.EMPLOYEE_ID GROUP BY A.REPORTS_TO ORDER BY B.EMPLOYEE_ID"
556,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(E2.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(E2.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID ORDER BY E1.EMPLOYEE_ID"
557,Y,Y,"SELECT A.REPORTS_TO AS EMPLOYEE_ID,B.NAME,COUNT(A.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(A.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A LEFT JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID WHERE A.REPORTS_TO IS NOT NULL GROUP BY 1,2 ORDER BY 1 ASC"
558,Y,Y,"SELECT E.EMPLOYEE_ID, E.NAME, R.REPORTS_COUNT, R.AVERAGE_AGE FROM EMPLOYEES E JOIN ( SELECT REPORTS_TO, COUNT(EMPLOYEE_ID) REPORTS_COUNT, ROUND(AVG(AGE),0) AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO ) R ON E.EMPLOYEE_ID = R.REPORTS_TO ORDER BY EMPLOYEE_ID"
559,Y,Y,"SELECT T1.EMPLOYEE_ID, T1.NAME, COUNT(T2.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(T2.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES T1 INNER JOIN EMPLOYEES T2 ON T2.REPORTS_TO = T1.EMPLOYEE_ID GROUP BY 1, 2 ORDER BY 1"
560,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(DISTINCT E2.EMPLOYEE_ID)AS REPORTS_COUNT, ROUND(AVG(E2.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID"
561,Y,Y,"SELECT TB1.EMPLOYEE_ID, TB1.NAME, COUNT(TB1.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(TB2.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES AS TB1 JOIN EMPLOYEES AS TB2 WHERE TB1.EMPLOYEE_ID = TB2.REPORTS_TO GROUP BY TB1.EMPLOYEE_ID ORDER BY TB1.EMPLOYEE_ID"
562,Y,Y,"SELECT A.REPORTS_TO AS EMPLOYEE_ID, B.NAME AS NAME, COUNT(A.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(A.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID WHERE A.REPORTS_TO IS NOT NULL GROUP BY A.REPORTS_TO ORDER BY A.REPORTS_TO"
563,Y,Y,"SELECT T.REPORTS_TO AS EMPLOYEE_ID , EMPLOYEES.NAME, T.REPORTS_COUNT, T.AVERAGE_AGE FROM( SELECT REPORTS_TO, COUNT(*) AS REPORTS_COUNT , ROUND(AVG(AGE),0) AS AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO)T JOIN EMPLOYEES ON T.REPORTS_TO=EMPLOYEES.EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
564,Y,Y,"SELECT B.EMPLOYEE_ID, B.NAME, COUNT(A.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(A.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY 1,2 ORDER BY EMPLOYEE_ID"
565,Y,Y,"SELECT A.REPORTS_TO AS EMPLOYEE_ID, B.NAME, A.REPORTS_COUNT, A.AVERAGE_AGE FROM ( SELECT REPORTS_TO , COUNT(EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(AGE)) AS AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO ) A JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID ORDER BY 1"
566,Y,Y,"SELECT MGR.EMPLOYEE_ID, MGR.NAME, COUNT(EMP.EMPLOYEE_ID) AS REPORTS_COUNT , ROUND(AVG(EMP.AGE)) AS AVERAGE_AGE FROM EMPLOYEES AS EMP JOIN EMPLOYEES AS MGR ON EMP.REPORTS_TO = MGR.EMPLOYEE_ID GROUP BY MGR.EMPLOYEE_ID, MGR.NAME ORDER BY MGR.EMPLOYEE_ID"
567,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(B.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(B.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON B.REPORTS_TO = A.EMPLOYEE_ID GROUP BY 1 ORDER BY 1"
568,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(E2.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E2.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES AS E1 JOIN EMPLOYEES AS E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID, E1.NAME ORDER BY E1.EMPLOYEE_ID"
569,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(B.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY 1 ORDER BY 1"
570,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(E2.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E2.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 INNER JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID, E1.NAME ORDER BY E1.EMPLOYEE_ID"
571,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(E2.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(E2.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2. REPORTS_TO GROUP BY E1.EMPLOYEE_ID ORDER BY E1.EMPLOYEE_ID"
572,Y,Y,"SELECT E2.EMPLOYEE_ID, E2.NAME, COUNT(E1.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E1.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES AS E1 INNER JOIN EMPLOYEES AS E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY E2.EMPLOYEE_ID ORDER BY E2.EMPLOYEE_ID"
573,Y,Y,"SELECT T2.EMPLOYEE_ID, T2.NAME, COUNT(*) REPORTS_COUNT, ROUND(AVG(T1.AGE)) AVERAGE_AGE FROM EMPLOYEES T1 INNER JOIN EMPLOYEES T2 ON T1.REPORTS_TO = T2.EMPLOYEE_ID GROUP BY T2.EMPLOYEE_ID ORDER BY T2.EMPLOYEE_ID"
574,Y,Y,"SELECT E.EMPLOYEE_ID AS EMPLOYEE_ID, E.NAME , COUNT(*) AS REPORTS_COUNT, ROUND(AVG(M.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES M JOIN EMPLOYEES E ON M.REPORTS_TO = E.EMPLOYEE_ID GROUP BY M.REPORTS_TO ORDER BY E.EMPLOYEE_ID"
575,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(DISTINCT E2.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E2.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID ORDER BY E1.EMPLOYEE_ID"
576,Y,Y,"SELECT EMPLOYEE_ID,NAME,REPORTS_COUNT,AVERAGE_AGE FROM EMPLOYEES E JOIN (SELECT REPORTS_TO,COUNT(REPORTS_TO) REPORTS_COUNT,ROUND(AVG(AGE)) AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY 1)ES ON (E.EMPLOYEE_ID=ES.REPORTS_TO) ORDER BY 1"
577,Y,Y,"SELECT E1.EMPLOYEE_ID,E1.NAME,COUNT(E2.REPORTS_TO) REPORTS_COUNT,ROUND(AVG(E2.AGE)) AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY 1 ORDER BY 1"
578,Y,Y,"SELECT M.EMPLOYEE_ID, M.NAME, COUNT(E.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES M INNER JOIN EMPLOYEES E ON E.REPORTS_TO = M.EMPLOYEE_ID GROUP BY 1,2 ORDER BY M.EMPLOYEE_ID"
579,Y,Y,"SELECT EMPLOYEE_ID, NAME, REPORTS_COUNT, AVERAGE_AGE FROM EMPLOYEES E JOIN (SELECT REPORTS_TO, COUNT(*) REPORTS_COUNT, ROUND(AVG(AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES GROUP BY 1) R ON E.EMPLOYEE_ID = R.REPORTS_TO ORDER BY 1"
580,Y,Y,"SELECT E1.EMPLOYEE_ID,E1.NAME,COUNT(E2.NAME) AS REPORTS_COUNT,ROUND(AVG(E2.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID=E2.REPORTS_TO GROUP BY EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
581,Y,Y,"WITH MANAGER AS ( SELECT EMPLOYEE_ID, NAME, AGE FROM EMPLOYEES WHERE EMPLOYEE_ID IN ( SELECT REPORTS_TO FROM EMPLOYEES ) ) SELECT DISTINCT M.EMPLOYEE_ID, M.NAME, COUNT(*) OVER (PARTITION BY M.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E.AGE) OVER (PARTITION BY M.EMPLOYEE_ID), 0) AS AVERAGE_AGE FROM EMPLOYEES E INNER JOIN MANAGER M ON M.EMPLOYEE_ID = E.REPORTS_TO ORDER BY M.EMPLOYEE_ID"
582,Y,Y,"SELECT E1.REPORTS_TO AS EMPLOYEE_ID , E2.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E1.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 LEFT JOIN EMPLOYEES E2 ON E1.REPORTS_TO =E2.EMPLOYEE_ID WHERE E1.REPORTS_TO IS NOT NULL GROUP BY E1.REPORTS_TO ORDER BY E2.EMPLOYEE_ID"
583,Y,Y,"SELECT A.REPORTS_TO AS EMPLOYEE_ID, B.NAME, COUNT(A.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(A.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY A.REPORTS_TO ORDER BY A.REPORTS_TO"
584,Y,Y,"SELECT E2.EMPLOYEE_ID, E2.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E1.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 INNER JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY E1.REPORTS_TO ORDER BY E2.EMPLOYEE_ID"
585,Y,Y,"WITH TEMP AS ( SELECT E1.EMPLOYEE_ID, E1.REPORTS_TO, E1.AGE, E2.NAME FROM EMPLOYEES AS E1 JOIN EMPLOYEES AS E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID ) SELECT REPORTS_TO AS EMPLOYEE_ID, NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(AGE),0) AS AVERAGE_AGE FROM TEMP GROUP BY REPORTS_TO ORDER BY REPORTS_TO"
586,Y,Y,"SELECT E1.REPORTS_TO AS EMPLOYEE_ID, E2.NAME AS NAME, COUNT(E1.NAME) AS REPORTS_COUNT, ROUND(AVG(E1.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES AS E1 JOIN EMPLOYEES AS E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY E1.REPORTS_TO ORDER BY E1.REPORTS_TO"
587,Y,Y,"SELECT B.EMPLOYEE_ID AS EMPLOYEE_ID,B.NAME AS NAME, COUNT(A.EMPLOYEE_ID) AS REPORTS_COUNT,ROUND(AVG(A.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY 1 ORDER BY 1"
588,Y,Y,"SELECT T2.EMPLOYEE_ID, T2.NAME, ROUND(COUNT(T1.EMPLOYEE_ID)) AS REPORTS_COUNT, ROUND(AVG(T1.AGE)) AS AVERAGE_AGE FROM EMPLOYEES T1 LEFT JOIN EMPLOYEES T2 ON T1.REPORTS_TO = T2.EMPLOYEE_ID WHERE T2.EMPLOYEE_ID IS NOT NULL GROUP BY T2.EMPLOYEE_ID, T2.NAME ORDER BY T2.EMPLOYEE_ID"
589,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(E2.EMPLOYEE_ID) REPORTS_COUNT, ROUND(AVG(E2.AGE)) AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID, E1.NAME ORDER BY E1.EMPLOYEE_ID"
590,Y,Y,"SELECT M.EMPLOYEE_ID,M.NAME,COUNT(*) REPORTS_COUNT, ROUND(AVG(E.AGE)) AVERAGE_AGE FROM EMPLOYEES M JOIN EMPLOYEES E ON M.EMPLOYEE_ID = E.REPORTS_TO GROUP BY 1 ORDER BY 1"
591,Y,Y,"SELECT E2.EMPLOYEE_ID, E2.NAME, COUNT(E1.EMPLOYEE_ID) REPORTS_COUNT, ROUND(AVG(E1.AGE),0) AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.REPORTS_TO=E2.EMPLOYEE_ID GROUP BY 1,2 ORDER BY 1"
592,Y,Y,"SELECT M.EMPLOYEE_ID, M.NAME, COUNT(E.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(E.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E LEFT JOIN EMPLOYEES M ON E.REPORTS_TO = M.EMPLOYEE_ID GROUP BY M.EMPLOYEE_ID HAVING COUNT(E.REPORTS_TO) >= 1 ORDER BY M.EMPLOYEE_ID"
593,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E2.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 INNER JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY 1, 2 ORDER BY 1"
594,Y,Y,"WITH ALLMANAGERS AS (SELECT DISTINCT REPORTS_TO AS EMPLOYEE_ID,COUNT(EMPLOYEE_ID) OVER(PARTITION BY REPORTS_TO) AS REPORTS_COUNT,ROUND(AVG(AGE) OVER(PARTITION BY REPORTS_TO)) AS AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL) SELECT A.EMPLOYEE_ID,(SELECT NAME FROM EMPLOYEES WHERE EMPLOYEE_ID = A.EMPLOYEE_ID) AS NAME,A.REPORTS_COUNT,A.AVERAGE_AGE FROM ALLMANAGERS A ORDER BY 1"
595,Y,Y,"SELECT A.REPORTS_TO AS EMPLOYEE_ID,B.NAME,COUNT(DISTINCT A.EMPLOYEE_ID) AS REPORTS_COUNT,ROUND(AVG(A.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO=B.EMPLOYEE_ID GROUP BY A.REPORTS_TO,B.NAME"
596,Y,Y,"SELECT MGR.EMPLOYEE_ID, MGR.NAME, COUNT(EMP.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(EMP.AGE)) AS AVERAGE_AGE FROM EMPLOYEES MGR JOIN EMPLOYEES EMP ON MGR.EMPLOYEE_ID = EMP.REPORTS_TO AND MGR.EMPLOYEE_ID <> EMP.EMPLOYEE_ID GROUP BY 1 ORDER BY 1"
597,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(E2.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(SUM(E2.AGE)/COUNT(E2.AGE)) AS AVERAGE_AGE FROM EMPLOYEES AS E1 JOIN EMPLOYEES AS E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID ORDER BY E1.EMPLOYEE_ID"
598,Y,Y,"SELECT B.EMPLOYEE_ID, B.NAME, COUNT(*) AS REPORTS_COUNT , ROUND(AVG(A.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
599,Y,Y,"SELECT A1.EMPLOYEE_ID, A1.NAME, COUNT(A2.REPORTS_TO) AS REPORTS_COUNT , ROUND(AVG(A2.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES AS A1 JOIN EMPLOYEES AS A2 ON A1.EMPLOYEE_ID=A2.REPORTS_TO GROUP BY 1 ORDER BY 1"
600,Y,Y,"SELECT TBL1.EMPLOYEE_ID, TBL1.NAME, COUNT(TBL2.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(SUM(TBL2.AGE)/COUNT(TBL2.EMPLOYEE_ID)) AS AVERAGE_AGE FROM EMPLOYEES TBL1 JOIN EMPLOYEES TBL2 ON TBL1.EMPLOYEE_ID = TBL2.REPORTS_TO GROUP BY TBL1.EMPLOYEE_ID,TBL1.NAME HAVING COUNT(TBL2.EMPLOYEE_ID)>0 ORDER BY TBL1.EMPLOYEE_ID"
601,Y,Y,"SELECT EMP.EMPLOYEE_ID, EMP.NAME, A.REPORTS_COUNT, A.AVERAGE_AGE FROM ( SELECT REPORTS_TO, COUNT(EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES GROUP BY REPORTS_TO HAVING COUNT(EMPLOYEE_ID)>=1 )A JOIN EMPLOYEES EMP ON EMP.EMPLOYEE_ID=A.REPORTS_TO ORDER BY EMP.EMPLOYEE_ID"
602,Y,Y,"SELECT B.EMPLOYEE_ID, B.NAME, COUNT(1) AS REPORTS_COUNT, ROUND(AVG(A.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY A.REPORTS_TO ORDER BY B.EMPLOYEE_ID"
603,Y,Y,"SELECT A.REPORTS_TO AS EMPLOYEE_ID, B.NAME, COUNT(A.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(A.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY 1 ORDER BY 1"
604,Y,Y,"SELECT B.EMPLOYEE_ID,B.NAME, COUNT(A.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(A.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
605,Y,Y,"SELECT E1.REPORTS_TO AS EMPLOYEE_ID, E2.NAME AS NAME, COUNT(E1.NAME) AS REPORTS_COUNT, ROUND(AVG(E1.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES AS E1 LEFT JOIN EMPLOYEES AS E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID WHERE E1.REPORTS_TO IS NOT NULL GROUP BY E1.REPORTS_TO ORDER BY E1.REPORTS_TO"
606,Y,Y,"SELECT E2.EMPLOYEE_ID, E2.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E1.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY E1.REPORTS_TO HAVING COUNT(*) >= 1 ORDER BY E2.EMPLOYEE_ID"
607,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(E2.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E2.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 INNER JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID ORDER BY E1.EMPLOYEE_ID"
608,Y,Y,"SELECT MGR.EMPLOYEE_ID, MGR.NAME, COUNT(EMP.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(EMP.AGE)) AS AVERAGE_AGE FROM EMPLOYEES EMP JOIN EMPLOYEES MGR ON EMP.REPORTS_TO = MGR.EMPLOYEE_ID GROUP BY MGR.EMPLOYEE_ID ORDER BY MGR.EMPLOYEE_ID"
609,Y,Y,"WITH MANAGER AS (SELECT M.EMPLOYEE_ID MANAGER_ID, M.NAME MANAGER_NAME FROM EMPLOYEES M WHERE M.EMPLOYEE_ID IN (SELECT DISTINCT REPORTS_TO FROM EMPLOYEES) ) SELECT M.MANAGER_ID EMPLOYEE_ID ,M.MANAGER_NAME NAME, COUNT(DISTINCT EMPLOYEE_ID) REPORTS_COUNT, ROUND(AVG(AGE)) AVERAGE_AGE FROM EMPLOYEES E INNER JOIN MANAGER M ON E.REPORTS_TO = M.MANAGER_ID GROUP BY M.MANAGER_ID,M.MANAGER_NAME ORDER BY M.MANAGER_ID"
610,Y,Y,"SELECT REPORTS_TO AS EMPLOYEE_ID , (SELECT NAME FROM EMPLOYEES WHERE EMPLOYEE_ID = E.REPORTS_TO) AS NAME , COUNT(*) AS REPORTS_COUNT , ROUND(AVG(AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E GROUP BY REPORTS_TO HAVING REPORTS_TO IS NOT NULL ORDER BY REPORTS_TO"
611,Y,Y,"SELECT M.EMPLOYEE_ID,M.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E JOIN EMPLOYEES M WHERE E.REPORTS_TO IS NOT NULL AND E.REPORTS_TO = M.EMPLOYEE_ID GROUP BY 1,2 ORDER BY 1"
612,Y,Y,"SELECT DISTINCT(E2.EMPLOYEE_ID) , E2.NAME, ROUND(COUNT(E1.EMPLOYEE_ID) OVER(PARTITION BY E1.REPORTS_TO),0) REPORTS_COUNT, ROUND(AVG(E1.AGE)OVER(PARTITION BY E1.REPORTS_TO),0) AVERAGE_AGE FROM EMPLOYEES E1 LEFT JOIN EMPLOYEES E2 ON E1.REPORTS_TO=E2.EMPLOYEE_ID WHERE E1.REPORTS_TO IS NOT NULL ORDER BY E2.EMPLOYEE_ID"
613,Y,Y,"SELECT E.REPORTS_TO AS EMPLOYEE_ID, M.NAME,COUNT(*) AS REPORTS_COUNT,ROUND(AVG(E.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E JOIN EMPLOYEES M ON E.REPORTS_TO=M.EMPLOYEE_ID GROUP BY 1,2 ORDER BY EMPLOYEE_ID"
614,Y,Y,"SELECT E2.REPORTS_TO AS EMPLOYEE_ID, E1.NAME, COUNT(E1.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E2.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY E2.REPORTS_TO ORDER BY E1.EMPLOYEE_ID"
615,Y,Y,"SELECT E.EMPLOYEE_ID,E.NAME, COUNT(E1.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(E1.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E JOIN EMPLOYEES E1 ON E.EMPLOYEE_ID = E1.REPORTS_TO GROUP BY 1,2 ORDER BY 1"
616,Y,Y,"SELECT M.EMPLOYEE_ID, M.NAME, COUNT(E.NAME) AS REPORTS_COUNT, ROUND(AVG(E.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES M LEFT JOIN EMPLOYEES E ON M.EMPLOYEE_ID = E.REPORTS_TO GROUP BY EMPLOYEE_ID HAVING COUNT(E.NAME) != 0 ORDER BY M.EMPLOYEE_ID"
617,Y,Y,"SELECT A.REPORTS_TO AS EMPLOYEE_ID, B.NAME AS NAME, COUNT(B.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(A.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID GROUP BY A.REPORTS_TO ORDER BY A.REPORTS_TO"
618,Y,Y,"SELECT M.EMPLOYEE_ID, M.NAME, COUNT(E.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E.AGE)) AS AVERAGE_AGE FROM EMPLOYEES M LEFT JOIN EMPLOYEES E ON M.EMPLOYEE_ID = E.REPORTS_TO GROUP BY 1 HAVING REPORTS_COUNT>=1 ORDER BY 1"
619,Y,Y,"WITH CTE AS ( SELECT REPORTS_TO AS EMPLOYEE_ID, COUNT(DISTINCT EMPLOYEE_ID) REPORTS_COUNT, ROUND(AVG(AGE)) AS AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO) SELECT A.EMPLOYEE_ID, B.NAME, REPORTS_COUNT, AVERAGE_AGE FROM CTE A INNER JOIN EMPLOYEES B ON A.EMPLOYEE_ID = B.EMPLOYEE_ID ORDER BY 1"
620,Y,Y,"SELECT M.EMPLOYEE_ID, M.NAME, COUNT(E.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(E.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E JOIN (SELECT NAME, EMPLOYEE_ID FROM EMPLOYEES WHERE REPORTS_TO IS NULL OR REPORTS_TO IN (SELECT EMPLOYEE_ID FROM EMPLOYEES)) M ON M.EMPLOYEE_ID = E.REPORTS_TO GROUP BY M.EMPLOYEE_ID ORDER BY M.EMPLOYEE_ID"
621,Y,Y,"SELECT T1.REPORTS_TO AS EMPLOYEE_ID, T2.NAME, COUNT(T1.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND ( AVG(T1.AGE) ) AS AVERAGE_AGE FROM EMPLOYEES AS T1 JOIN EMPLOYEES AS T2 ON T1.REPORTS_TO = T2. EMPLOYEE_ID WHERE T1.REPORTS_TO IS NOT NULL GROUP BY T1.REPORTS_TO ORDER BY EMPLOYEE_ID"
622,Y,Y,"SELECT M.EMPLOYEE_ID,M.NAME,COUNT(E.EMPLOYEE_ID) AS REPORTS_COUNT,ROUND(AVG(E.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E JOIN EMPLOYEES M ON E.REPORTS_TO=M.EMPLOYEE_ID GROUP BY E.REPORTS_TO ORDER BY M.EMPLOYEE_ID"
623,Y,Y,"SELECT MGR.EMPLOYEE_ID, MGR.NAME,COUNT(EMP.EMPLOYEE_ID) REPORTS_COUNT ,ROUND(AVG(EMP.AGE) )AVERAGE_AGE FROM EMPLOYEES EMP JOIN EMPLOYEES MGR ON EMP.REPORTS_TO=MGR.EMPLOYEE_ID GROUP BY MGR.EMPLOYEE_ID ORDER BY MGR.EMPLOYEE_ID"
624,Y,Y,"SELECT E1.EMPLOYEE_ID AS EMPLOYEE_ID, E1.NAME AS NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E2.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID ORDER BY E1.EMPLOYEE_ID"
625,Y,Y,"SELECT E2.EMPLOYEE_ID, E2.NAME, COUNT(E1.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(E1.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY E2.EMPLOYEE_ID, E2.NAME ORDER BY E2.EMPLOYEE_ID"
626,Y,Y,"WITH CTE AS(SELECT REPORTS_TO AS MANAGER, COUNT(EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(AGE),0) AS AVERAGE_AGE FROM EMPLOYEES GROUP BY REPORTS_TO ) SELECT C.MANAGER AS EMPLOYEE_ID, E.NAME, C.REPORTS_COUNT, C.AVERAGE_AGE FROM CTE C LEFT JOIN EMPLOYEES E ON C.MANAGER = E.EMPLOYEE_ID WHERE C.MANAGER IS NOT NULL ORDER BY EMPLOYEE_ID"
627,Y,Y,"SELECT E1.REPORTS_TO AS EMPLOYEE_ID, E2.NAME AS NAME, COUNT(E1.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E1.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY 1 ORDER BY 1"
628,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(E2.REPORTS_TO) AS REPORTS_COUNT, ROUND(AVG(E2.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY 1 ORDER BY 1"
629,Y,Y,"SELECT M.EMPLOYEE_ID, M.NAME, COUNT(*) REPORTS_COUNT , ROUND(AVG(E.AGE)) AVERAGE_AGE FROM EMPLOYEES M JOIN EMPLOYEES E ON E.REPORTS_TO = M.EMPLOYEE_ID WHERE E.EMPLOYEE_ID != M.EMPLOYEE_ID GROUP BY 1 HAVING COUNT(*)>= 1 ORDER BY 1"
630,Y,Y,"SELECT MANAGER.EMPLOYEE_ID, MANAGER.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(EMPLOYEE.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES MANAGER JOIN EMPLOYEES EMPLOYEE ON MANAGER.EMPLOYEE_ID=EMPLOYEE.REPORTS_TO GROUP BY 1 ORDER BY 1"
631,Y,Y,"SELECT A.EMPLOYEE_ID,A.NAME,B.REPORTS_COUNT,B.AVERAGE_AGE FROM EMPLOYEES A INNER JOIN (SELECT REPORTS_TO, COUNT(REPORTS_TO)AS REPORTS_COUNT, ROUND(AVG(AGE)) AS AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY 1 HAVING COUNT(REPORTS_TO) >= 1) B ON A.EMPLOYEE_ID = B.REPORTS_TO ORDER BY 1"
632,Y,Y,"SELECT E2.EMPLOYEE_ID, E2.NAME, COUNT(E2.EMPLOYEE_ID) REPORTS_COUNT, ROUND(AVG(E1.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY E2.EMPLOYEE_ID ORDER BY E2.EMPLOYEE_ID"
633,Y,Y,"SELECT A.REPORTS_TO AS EMPLOYEE_ID, B.NAME, COUNT(A.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(A.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON (A.REPORTS_TO = B.EMPLOYEE_ID) WHERE A.REPORTS_TO IS NOT NULL GROUP BY A.REPORTS_TO ORDER BY EMPLOYEE_ID"
634,Y,Y,"SELECT E2.EMPLOYEE_ID AS EMPLOYEE_ID, E2.NAME AS NAME, COUNT(E1.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E1.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY 1 ORDER BY 1"
635,Y,Y,"SELECT A.REPORTS_TO AS EMPLOYEE_ID,(SELECT B.NAME FROM EMPLOYEES AS B WHERE B.EMPLOYEE_ID = A.REPORTS_TO) AS NAME, SUM(IF(A.REPORTS_TO = A.REPORTS_TO,1,0)) AS REPORTS_COUNT, ROUND(AVG(A.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A WHERE A.REPORTS_TO IS NOT NULL GROUP BY A.REPORTS_TO ORDER BY EMPLOYEE_ID"
636,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E2.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1, EMPLOYEES E2 WHERE E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID ORDER BY E1.EMPLOYEE_ID"
637,Y,Y,"SELECT E1.REPORTS_TO AS EMPLOYEE_ID, E2.NAME, COUNT(E1.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(SUM(E1.AGE)/COUNT(E1.EMPLOYEE_ID)) AS AVERAGE_AGE FROM EMPLOYEES E1 INNER JOIN EMPLOYEES AS E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID WHERE E1.REPORTS_TO IS NOT NULL GROUP BY E1.REPORTS_TO ORDER BY E1.REPORTS_TO"
638,Y,Y,"SELECT E2.EMPLOYEE_ID, E2.NAME, COUNT(E1.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E1.AGE), 0) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY E2.EMPLOYEE_ID ORDER BY E2.EMPLOYEE_ID"
639,Y,Y,"SELECT E1.REPORTS_TO EMPLOYEE_ID, E2.NAME, E1.REPORTS_COUNT, E1.AVERAGE_AGE FROM EMPLOYEES E2 RIGHT JOIN ( SELECT REPORTS_TO, COUNT(*) REPORTS_COUNT, ROUND(AVG(AGE),0) AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO) E1 ON E1.REPORTS_TO = E2.EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
640,Y,Y,"WITH MANAGERS AS ( SELECT REPORTS_TO, COUNT(DISTINCT EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(AGE)) AS AVERAGE_AGE FROM EMPLOYEES E WHERE REPORTS_TO IS NOT NULL GROUP BY 1 HAVING COUNT(EMPLOYEE_ID) > 0 ) SELECT M.REPORTS_TO AS EMPLOYEE_ID, E.NAME, M.REPORTS_COUNT, M.AVERAGE_AGE FROM MANAGERS M JOIN EMPLOYEES E ON M.REPORTS_TO = E.EMPLOYEE_ID ORDER BY 1"
641,Y,Y,"SELECT TB1.EMPLOYEE_ID, TB1.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(TB2.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES AS TB1 JOIN EMPLOYEES AS TB2 ON TB1.EMPLOYEE_ID = TB2.REPORTS_TO GROUP BY TB1.EMPLOYEE_ID ORDER BY TB1.EMPLOYEE_ID"
642,Y,Y,"SELECT EMPLOYEE_ID, NAME, REPORTS_COUNT, AVERAGE_AGE FROM ( SELECT REPORTS_TO AS MANAGER, ROUND(AVG(AGE),0) AS AVERAGE_AGE, COUNT(*) AS REPORTS_COUNT FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO ) AS AAA LEFT JOIN EMPLOYEES ON EMPLOYEES.EMPLOYEE_ID=AAA.MANAGER ORDER BY EMPLOYEE_ID"
643,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(E2.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E2.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 INNER JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID, E1.NAME ORDER BY E1.EMPLOYEE_ID"
644,Y,Y,"SELECT M.EMPLOYEE_ID,M.NAME,COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES AS M JOIN EMPLOYEES AS E ON M.EMPLOYEE_ID=E.REPORTS_TO GROUP BY M.EMPLOYEE_ID,M.NAME ORDER BY M.EMPLOYEE_ID"
645,Y,Y,"SELECT A.REPORTS_TO AS EMPLOYEE_ID, B.NAME AS NAME, COUNT(A.EMPLOYEE_ID) AS REPORTS_COUNT , ROUND(AVG(A.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A LEFT JOIN EMPLOYEES B ON A.REPORTS_TO = B.EMPLOYEE_ID WHERE A.REPORTS_TO IS NOT NULL GROUP BY 1,2 ORDER BY 1,2"
646,Y,Y,"SELECT X.EMPLOYEE_ID, X.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(Y.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES X JOIN EMPLOYEES Y ON Y.REPORTS_TO = X.EMPLOYEE_ID GROUP BY X.EMPLOYEE_ID ORDER BY X.EMPLOYEE_ID"
647,Y,Y,"SELECT E1.EMPLOYEE_ID, E2.NAME, REPORTS_COUNT, AVERAGE_AGE FROM (SELECT REPORTS_TO EMPLOYEE_ID, COUNT(EMPLOYEE_ID) REPORTS_COUNT, ROUND(AVG(AGE)) AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO) E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.EMPLOYEE_ID ORDER BY E1.EMPLOYEE_ID"
648,Y,Y,"SELECT SUB1.EMPLOYEE_ID, SUB1.NAME, SUB1.REPORTS_COUNT, SUB1.AVERAGE_AGE FROM ( SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(*) REPORTS_COUNT, ROUND(AVG(E2.AGE), 0) AVERAGE_AGE FROM EMPLOYEES E1 INNER JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID ORDER BY E1.EMPLOYEE_ID ) SUB1 WHERE SUB1.EMPLOYEE_ID IS NOT NULL"
649,Y,Y,"SELECT T1.MANAGER_ID AS EMPLOYEE_ID, E.NAME AS NAME, T1.REPORTS_COUNT, T1.AVERAGE_AGE FROM (SELECT REPORTS_TO AS MANAGER_ID, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(AGE),0) AS AVERAGE_AGE FROM EMPLOYEES GROUP BY REPORTS_TO HAVING REPORTS_TO IS NOT NULL) T1 JOIN EMPLOYEES E ON T1.MANAGER_ID = E.EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
650,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.NAME, COUNT(E2.REPORTS_TO) REPORTS_COUNT, ROUND(AVG(E2.AGE)) AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E2.REPORTS_TO = E1.EMPLOYEE_ID GROUP BY EMPLOYEE_ID HAVING COUNT(E2.REPORTS_TO) >= 1 ORDER BY E1.EMPLOYEE_ID"
651,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(IFNULL(AVG(B.AGE),0)) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.EMPLOYEE_ID = B.REPORTS_TO GROUP BY A.EMPLOYEE_ID, A.NAME ORDER BY A.EMPLOYEE_ID"
652,Y,Y,"WITH MANAGERS AS (SELECT EMPLOYEE_ID, REPORTS_TO,NAME,AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL) SELECT M.REPORTS_TO AS EMPLOYEE_ID,E.NAME, COUNT(M.REPORTS_TO) AS REPORTS_COUNT,ROUND(AVG(M.AGE)) AS AVERAGE_AGE FROM MANAGERS M INNER JOIN EMPLOYEES E ON M.REPORTS_TO = E.EMPLOYEE_ID GROUP BY M.REPORTS_TO ORDER BY EMPLOYEE_ID"
653,Y,Y,"WITH CTE AS (SELECT REPORTS_TO AS EMPLOYEE_ID, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(AGE),0) AS AVERAGE_AGE FROM EMPLOYEES GROUP BY REPORTS_TO HAVING COUNT(*) >= 1 AND REPORTS_TO IS NOT NULL) SELECT CTE.EMPLOYEE_ID , EMPLOYEES.NAME, CTE.REPORTS_COUNT, CTE.AVERAGE_AGE FROM CTE JOIN EMPLOYEES ON CTE.EMPLOYEE_ID = EMPLOYEES.EMPLOYEE_ID ORDER BY 1 , 2 DESC"
654,Y,Y,"SELECT E2.EMPLOYEE_ID, E2.NAME, COUNT(E1.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(E1.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.REPORTS_TO = E2.EMPLOYEE_ID GROUP BY 1, 2 ORDER BY 1"
655,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, COUNT(B.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(B.AGE)) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON B.REPORTS_TO = A.EMPLOYEE_ID GROUP BY A.EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
656,Y,Y,"SELECT E1.EMPLOYEE_ID ,E1.NAME, COUNT(E2.EMPLOYEE_ID) AS REPORTS_COUNT , ROUND(AVG(E2.AGE)) AS AVERAGE_AGE FROM EMPLOYEES E1 INNER JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID=E2.REPORTS_TO GROUP BY E1.NAME, E1.EMPLOYEE_ID ORDER BY E1.EMPLOYEE_ID"
657,Y,Y,"SELECT A.EMPLOYEE_ID, A.NAME, B.REPORTS_COUNT, ROUND(B.AVERAGE_AGE) AS AVERAGE_AGE FROM EMPLOYEES A INNER JOIN (SELECT REPORTS_TO, COUNT(DISTINCT EMPLOYEE_ID) AS REPORTS_COUNT, AVG(AGE) AS AVERAGE_AGE FROM EMPLOYEES WHERE REPORTS_TO IS NOT NULL GROUP BY REPORTS_TO) B ON A.EMPLOYEE_ID = B.REPORTS_TO ORDER BY A.EMPLOYEE_ID"
658,Y,Y,"WITH A AS (SELECT REPORTS_TO, COUNT(EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(AGE)) AS AVERAGE_AGE FROM EMPLOYEES GROUP BY REPORTS_TO) SELECT E.EMPLOYEE_ID, E.NAME, A.REPORTS_COUNT, A.AVERAGE_AGE FROM EMPLOYEES AS E INNER JOIN A ON E.EMPLOYEE_ID = A.REPORTS_TO ORDER BY E.EMPLOYEE_ID"
659,Y,Y,"SELECT E1.EMPLOYEE_ID AS EMPLOYEE_ID, E1.NAME, COUNT(*) AS REPORTS_COUNT, ROUND(AVG(E2.AGE)) AVERAGE_AGE FROM EMPLOYEES E1 JOIN EMPLOYEES E2 ON E1.EMPLOYEE_ID = E2.REPORTS_TO GROUP BY E1.EMPLOYEE_ID ORDER BY EMPLOYEE_ID"
660,Y,Y,"SELECT A.REPORTS_TO AS EMPLOYEE_ID, B.NAME AS NAME, COUNT(A.EMPLOYEE_ID) AS REPORTS_COUNT, ROUND(AVG(A.AGE),0) AS AVERAGE_AGE FROM EMPLOYEES A JOIN EMPLOYEES B ON A.REPORTS_TO=B.EMPLOYEE_ID GROUP BY 1 ORDER BY 1"
