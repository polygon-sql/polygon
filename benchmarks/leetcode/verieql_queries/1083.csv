qid,mysql_can_execute?,mysql_correct?,mysql_query
0,Y,Y,SELECT A.BUYER_ID FROM SALES AS A INNER JOIN PRODUCT AS B ON A.PRODUCT_ID=B.PRODUCT_ID GROUP BY A.BUYER_ID HAVING SUM(CASE WHEN B.PRODUCT_NAME='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN B.PRODUCT_NAME='iPhone' THEN 1 ELSE 0 END)=0
1,Y,Y,SELECT BUYER_ID FROM SALES JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(PRODUCT_NAME = 'S8') > 0 AND SUM(PRODUCT_NAME = 'iPhone') = 0
2,Y,Y,"SELECT DISTINCT A.BUYER_ID FROM (SELECT S.BUYER_ID, P.PRODUCT_NAME FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8') A LEFT JOIN (SELECT S.BUYER_ID, P.PRODUCT_NAME FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone') B ON A.BUYER_ID = B.BUYER_ID WHERE B.PRODUCT_NAME IS NULL"
3,Y,Y,SELECT DISTINCT BUYER_ID FROM PRODUCT P RIGHT JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN ( SELECT BUYER_ID FROM PRODUCT P RIGHT JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone')
4,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
5,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE PRODUCT_NAME='S8' AND BUYER_ID NOT IN (SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE PRODUCT_NAME='iPhone' )
6,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM(CASE WHEN P.PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) >0 AND SUM(CASE WHEN P.PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) =0
7,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES S1 JOIN PRODUCT P1 ON S1.PRODUCT_ID = P1.PRODUCT_ID WHERE P1.PRODUCT_NAME = 'iPhone')
8,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN ( SELECT DISTINCT S.BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone' )
9,Y,Y,"SELECT DISTINCT S1.BUYER_ID FROM SALES S1, PRODUCT P WHERE S1.PRODUCT_ID = P.PRODUCT_ID AND P.PRODUCT_NAME = 'S8' AND S1.BUYER_ID NOT IN ( SELECT S1.BUYER_ID AS IPHONE FROM SALES S1, PRODUCT P WHERE S1.PRODUCT_ID = P.PRODUCT_ID AND P.PRODUCT_NAME = 'iPhone')"
10,Y,Y,"SELECT DISTINCT SALES.BUYER_ID FROM PRODUCT, SALES WHERE PRODUCT.PRODUCT_ID = SALES.PRODUCT_ID AND PRODUCT.PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT SALES.BUYER_ID FROM PRODUCT, SALES WHERE PRODUCT.PRODUCT_ID = SALES.PRODUCT_ID AND PRODUCT.PRODUCT_NAME = 'iPhone')"
11,Y,Y,SELECT DISTINCT SALES.BUYER_ID FROM SALES LEFT JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE PRODUCT.PRODUCT_NAME = 'S8' AND SALES.BUYER_ID NOT IN ( SELECT DISTINCT SALES.BUYER_ID FROM SALES LEFT JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE PRODUCT.PRODUCT_NAME = 'iPhone' )
12,Y,Y,SELECT DISTINCT SALES.BUYER_ID FROM SALES LEFT JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE PRODUCT.PRODUCT_NAME = 'S8' AND SALES.BUYER_ID NOT IN (SELECT SALES.BUYER_ID FROM SALES LEFT JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE PRODUCT.PRODUCT_NAME = 'iPhone')
13,Y,N,SELECT DISTINCT SALES.BUYER_ID FROM SALES WHERE SALES.BUYER_ID IN (SELECT B.BUYER_ID FROM PRODUCT A LEFT JOIN SALES B ON A.PRODUCT_ID = B.PRODUCT_ID WHERE A.PRODUCT_NAME = 'S8') AND SALES.BUYER_ID NOT IN ( SELECT B.BUYER_ID FROM PRODUCT A LEFT JOIN SALES B ON A.PRODUCT_ID = B.PRODUCT_ID WHERE A.PRODUCT_NAME = 'iPhone')
14,Y,Y,SELECT DISTINCT A.BUYER_ID FROM (SELECT BUYER_ID FROM SALES WHERE PRODUCT_ID IN (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME LIKE S8 ) ) A JOIN (SELECT BUYER_ID FROM SALES WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES WHERE PRODUCT_ID IN (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME LIKE IPHONE ) ) ) B ON A.BUYER_ID=B.BUYER_ID
15,Y,Y,"SELECT DISTINCT BUYER_ID FROM ( SELECT BUYER_ID, CASE WHEN PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END AS S8, CASE WHEN PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END AS IPHONE FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID) AS SUB GROUP BY BUYER_ID HAVING SUM(S8) >0 AND SUM(IPHONE) = 0"
16,Y,Y,SELECT DISTINCT BUYER_ID FROM PRODUCT AS T1 RIGHT JOIN SALES AS T2 ON T1.PRODUCT_ID = T2.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN ( SELECT DISTINCT BUYER_ID FROM PRODUCT AS T1 RIGHT JOIN SALES AS T2 ON T1.PRODUCT_ID = T2.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone' )
17,Y,Y,SELECT DISTINCT BUYER_ID FROM PRODUCT JOIN SALES WHERE PRODUCT.PRODUCT_ID = SALES.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(PRODUCT.PRODUCT_NAME='S8')>0 AND SUM(PRODUCT.PRODUCT_NAME = 'iPhone') =0
18,Y,Y,SELECT DISTINCT BUYER_ID FROM PRODUCT LEFT JOIN SALES USING(PRODUCT_ID) WHERE PRODUCT_NAME='S8' AND BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES LEFT JOIN PRODUCT USING(PRODUCT_ID) WHERE PRODUCT_NAME='iPhone' )
19,Y,Y,SELECT DISTINCT BUYER_ID FROM PRODUCT NATURAL JOIN SALES WHERE BUYER_ID NOT IN ( SELECT BUYER_ID FROM PRODUCT NATURAL JOIN SALES WHERE PRODUCT_NAME = 'iPhone' ) AND PRODUCT_NAME = 'S8'
20,Y,Y,SELECT DISTINCT BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN ( SELECT DISTINCT BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone' )
21,Y,Y,SELECT DISTINCT BUYER_ID FROM PRODUCT P RIGHT JOIN SALES S ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT DISTINCT BUYER_ID FROM PRODUCT P RIGHT JOIN SALES S ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
22,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES AS S INNER JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID AND P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN( SELECT DISTINCT BUYER_ID FROM SALES INNER JOIN PRODUCT WHERE SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID AND PRODUCT_NAME = 'iPhone' )
23,Y,Y,"SELECT DISTINCT BUYER_ID FROM SALES AS S JOIN PRODUCT AS P USING(PRODUCT_ID) GROUP BY BUYER_ID HAVING SUM(IF(PRODUCT_NAME = 'S8', 1, 0)) > 0 AND SUM(IF(PRODUCT_NAME = 'iPhone', 1, 0)) = 0"
24,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES INNER JOIN PRODUCT ON PRODUCT.PRODUCT_ID = SALES.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT SALES.BUYER_ID FROM SALES INNER JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone')
25,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES INNER JOIN PRODUCT ON SALES.PRODUCT_ID=PRODUCT.PRODUCT_ID WHERE PRODUCT_NAME='S8' AND BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES INNER JOIN PRODUCT ON SALES.PRODUCT_ID=PRODUCT.PRODUCT_ID WHERE PRODUCT_NAME='iPhone' )
26,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES JOIN PRODUCT ON PRODUCT.PRODUCT_ID = SALES.PRODUCT_ID WHERE BUYER_ID NOT IN( SELECT BUYER_ID FROM SALES JOIN PRODUCT ON PRODUCT.PRODUCT_ID = SALES.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone') AND PRODUCT_NAME = 'S8'
27,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN ( SELECT DISTINCT BUYER_ID FROM SALES JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone' )
28,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES JOIN PRODUCT USING(PRODUCT_ID) WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES JOIN PRODUCT USING(PRODUCT_ID) WHERE PRODUCT_NAME = 'iPhone')
29,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE PRODUCT.PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE PRODUCT.PRODUCT_NAME = 'iPhone' )
30,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES LEFT JOIN PRODUCT USING (PRODUCT_ID) WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT DISTINCT BUYER_ID FROM SALES LEFT JOIN PRODUCT USING (PRODUCT_ID) WHERE PRODUCT_NAME = 'iPhone')
31,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES LEFT JOIN PRODUCT USING(PRODUCT_ID) WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES JOIN PRODUCT USING (PRODUCT_ID) WHERE PRODUCT_NAME = 'iPhone' GROUP BY BUYER_ID)
32,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES LEFT JOIN PRODUCT USING(PRODUCT_ID) WHERE PRODUCT_NAME='S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES LEFT JOIN PRODUCT USING(PRODUCT_ID) WHERE PRODUCT_NAME='iPhone')
33,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID IN ( SELECT DISTINCT BUYER_ID FROM SALES INNER JOIN PRODUCT USING(PRODUCT_ID) WHERE PRODUCT_NAME = 'S8' ) AND BUYER_ID NOT IN ( SELECT DISTINCT BUYER_ID FROM SALES INNER JOIN PRODUCT USING(PRODUCT_ID) WHERE PRODUCT_NAME = 'iPhone' ) ORDER BY BUYER_ID
34,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID IN ( SELECT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN ( SELECT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
35,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID IN (SELECT BUYER_ID FROM SALES JOIN PRODUCT USING(PRODUCT_ID) WHERE PRODUCT_NAME='S8') AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES JOIN PRODUCT USING(PRODUCT_ID) WHERE PRODUCT_NAME='iPhone')
36,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES LEFT JOIN PRODUCT USING(PRODUCT_ID) WHERE PRODUCT_NAME = 'iPhone') AND BUYER_ID IN (SELECT BUYER_ID FROM SALES LEFT JOIN PRODUCT USING(PRODUCT_ID) WHERE PRODUCT_NAME = 'S8')
37,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES WHERE PRODUCT_ID = (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN ( SELECT DISTINCT BUYER_ID FROM SALES WHERE PRODUCT_ID = (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'iPhone') )
38,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE BUYER_ID IN (SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME='S8') AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME='iPhone')
39,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone' )
40,Y,Y,"SELECT DISTINCT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME IN ('S8', 'iPhone') GROUP BY BUYER_ID HAVING COUNT(DISTINCT PRODUCT_NAME) = 1 AND MAX(PRODUCT_NAME) = 'S8'"
41,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone')
42,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID AND PRODUCT.PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID AND PRODUCT.PRODUCT_NAME = 'iPhone')
43,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE BUYER_ID NOT IN (SELECT DISTINCT BUYER_ID FROM SALES JOIN PRODUCT USING(PRODUCT_ID) WHERE PRODUCT.PRODUCT_NAME = 'iPhone') AND PRODUCT.PRODUCT_NAME = 'S8'
44,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES JOIN PRODUCT USING(PRODUCT_ID) WHERE PRODUCT_NAME = 'S8' AND (BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES JOIN PRODUCT USING(PRODUCT_ID) WHERE PRODUCT_NAME = 'iPhone' ))
45,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID IN (SELECT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone')
46,Y,Y,SELECT DISTINCT S.BUYER_ID AS BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
47,Y,Y,SELECT DISTINCT S.BUYER_ID AS BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
48,Y,Y,SELECT DISTINCT S.BUYER_ID FROM PRODUCT P JOIN SALES S USING (PRODUCT_ID) WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT BUYER_ID FROM PRODUCT JOIN SALES USING (PRODUCT_ID) WHERE PRODUCT_NAME = 'iPhone')
49,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES AS S LEFT JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT S.BUYER_ID FROM SALES AS S LEFT JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
50,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID AND P.PRODUCT_NAME = 'S8' WHERE S.BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID AND P.PRODUCT_NAME = 'iPhone')
51,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM(P.PRODUCT_NAME = 'S8') > 0 AND SUM(P.PRODUCT_NAME = 'iPhone') = 0
52,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT S.BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
53,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID AND P.PRODUCT_NAME = 'S8' WHERE S.BUYER_ID NOT IN ( SELECT DISTINCT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID AND P.PRODUCT_NAME = 'iPhone' )
54,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN ( SELECT S2.BUYER_ID FROM SALES S2 JOIN PRODUCT P2 ON S2.PRODUCT_ID = P2.PRODUCT_ID WHERE P2.PRODUCT_NAME = 'iPhone' )
55,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT DISTINCT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
56,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
57,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' OR PRODUCT_NAME = 'iPhone' GROUP BY S.BUYER_ID HAVING SUM(CASE WHEN PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) != 0 AND SUM(CASE WHEN PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) = 0
58,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone' )
59,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES SX INNER JOIN PRODUCT PX ON PX.PRODUCT_ID = SX.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone')
60,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE S.BUYER_ID NOT IN (SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone') AND P.PRODUCT_NAME = 'S8'
61,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone')
62,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN ( SELECT DISTINCT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone' )
63,Y,Y,SELECT DISTINCT S2.BUYER_ID FROM SALES S2 INNER JOIN PRODUCT P2 ON S2.PRODUCT_ID = P2.PRODUCT_ID WHERE P2.PRODUCT_NAME = 'S8' AND S2.BUYER_ID NOT IN ( SELECT DISTINCT SA.BUYER_ID FROM SALES SA INNER JOIN PRODUCT PA ON SA.PRODUCT_ID = PA.PRODUCT_ID WHERE PA.PRODUCT_NAME = 'iPhone' )
64,Y,Y,SELECT DISTINCT(BUYER_ID) FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID =P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone' )
65,Y,Y,SELECT DISTINCT(BUYER_ID) FROM SALES AS S JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE S.BUYER_ID IN (SELECT BUYER_ID FROM SALES AS S JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8') AND S.BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES AS S JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
66,Y,Y,SELECT DISTINCT(BUYER_ID) FROM SALES WHERE BUYER_ID IN ( SELECT BUYER_ID FROM SALES AS S JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' ) AND BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES AS S JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone' )
67,Y,Y,SELECT DISTINCT(BUYER_ID) FROM SALES WHERE BUYER_ID IN ( SELECT BUYER_ID FROM SALES AS S LEFT JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' ) AND BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES AS S LEFT JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone' )
68,Y,Y,SELECT DISTINCT(BUYER_ID) FROM SALES WHERE BUYER_ID IN ( SELECT BUYER_ID FROM SALES AS S LEFT JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' ) AND BUYER_ID NOT IN( SELECT BUYER_ID FROM SALES AS S LEFT JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone' )
69,Y,Y,SELECT DISTINCT(BUYER_ID) FROM SALES WHERE BUYER_ID IN (SELECT S.BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN (SELECT S.BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
70,Y,Y,SELECT DISTINCT(BUYER_ID) FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
71,Y,Y,SELECT DISTINCT(BUYER_ID) FROM SALES SS JOIN PRODUCT PP ON SS.PRODUCT_ID = PP.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN( SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone' )
72,Y,Y,SELECT DISTINCT(S.BUYER_ID) FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
73,Y,Y,SELECT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM(P.PRODUCT_NAME = 'S8')>0 AND SUM(P.PRODUCT_NAME ='iPhone')=0
74,Y,Y,SELECT S.BUYER_ID FROM SALES AS S INNER JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM(CASE WHEN P.PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN P.PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) = 0
75,Y,Y,SELECT S.BUYER_ID FROM SALES AS S JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM(P.PRODUCT_NAME = 'S8') > 0 AND SUM(P.PRODUCT_NAME = 'iPhone') = 0
76,Y,Y,SELECT S.BUYER_ID FROM SALES AS S JOIN PRODUCT P USING(PRODUCT_ID) GROUP BY S.BUYER_ID HAVING SUM('S8' = P.PRODUCT_NAME) > 0 AND SUM('iPhone' = P.PRODUCT_NAME) = 0
77,Y,Y,SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM(CASE WHEN P.PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN P.PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) = 0
78,Y,Y,SELECT A.BUYER_ID FROM SALES A INNER JOIN PRODUCT P ON A.PRODUCT_ID = P.PRODUCT_ID WHERE 1=1 AND P.PRODUCT_NAME = 'S8' AND A.BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES S INNER JOIN PRODUCT B ON B.PRODUCT_ID = S.PRODUCT_ID WHERE B.PRODUCT_NAME = 'iPhone' ) GROUP BY 1
79,Y,Y,SELECT B.BUYER_ID FROM PRODUCT AS A JOIN SALES AS B ON A.PRODUCT_ID = B.PRODUCT_ID GROUP BY B.BUYER_ID HAVING SUM(A.PRODUCT_NAME = 'S8') > 0 AND SUM(A.PRODUCT_NAME = 'iPhone') = 0
80,Y,Y,SELECT B.BUYER_ID FROM PRODUCT AS A JOIN SALES AS B ON B.PRODUCT_ID = A.PRODUCT_ID GROUP BY B.BUYER_ID HAVING SUM(A.PRODUCT_NAME = 'S8') > 0 AND SUM(A.PRODUCT_NAME = 'iPhone') = 0
81,Y,Y,"SELECT BUYER_ID FROM ( SELECT BUYER_ID, CASE WHEN PRODUCT.PRODUCT_NAME = 'S8' THEN 1 WHEN PRODUCT.PRODUCT_NAME = 'iPhone' THEN -1 END AS COEFF FROM PRODUCT JOIN SALES ON PRODUCT.PRODUCT_ID = SALES.PRODUCT_ID AND ( PRODUCT.PRODUCT_NAME = 'S8' OR PRODUCT.PRODUCT_NAME = 'iPhone' ) GROUP BY BUYER_ID, PRODUCT.PRODUCT_NAME ) AS SALES_INFO GROUP BY BUYER_ID HAVING SUM(COEFF) = 1"
82,Y,Y,"SELECT BUYER_ID FROM ( SELECT BUYER_ID, GROUP_CONCAT(PRODUCT_NAME) AS PRODUCT_NAMES FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY BUYER_ID HAVING PRODUCT_NAMES LIKE '%S8%' AND PRODUCT_NAMES NOT LIKE '%IPHONE%') A"
83,Y,Y,"SELECT BUYER_ID FROM PRODUCT AS P JOIN SALES AS S ON P.PRODUCT_ID = S.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(IF(PRODUCT_NAME = 'S8', 1, 0)) > 0 AND SUM(IF(PRODUCT_NAME = 'iPhone', 1, 0)) = 0"
84,Y,Y,SELECT BUYER_ID FROM SALES JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE SALES.PRODUCT_ID IN (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'S8' OR PRODUCT_NAME = 'iPhone') GROUP BY BUYER_ID HAVING SUM(CASE WHEN PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) = 0
85,Y,Y,SELECT BUYER_ID FROM SALES JOIN PRODUCT USING (PRODUCT_ID) GROUP BY 1 HAVING SUM(CASE WHEN PRODUCT_NAME='S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN PRODUCT_NAME='iPhone' THEN 1 ELSE 0 END) = 0
86,Y,Y,SELECT BUYER_ID FROM SALES JOIN PRODUCT USING(PRODUCT_ID) GROUP BY BUYER_ID HAVING SUM(CASE WHEN PRODUCT_NAME='S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN PRODUCT_NAME='iPhone' THEN 1 ELSE 0 END) = 0
87,Y,Y,SELECT BUYER_ID FROM SALES JOIN PRODUCT USING(PRODUCT_ID) GROUP BY BUYER_ID HAVING SUM(CASE PRODUCT_NAME WHEN 'S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE PRODUCT_NAME WHEN 'iPhone' THEN 1 ELSE 0 END)=0
88,Y,Y,SELECT BUYER_ID FROM SALES LEFT JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(CASE PRODUCT_NAME WHEN 'S8' THEN 1 ELSE 0 END) >= 1 AND SUM(CASE PRODUCT_NAME WHEN 'iPhone' THEN 1 ELSE 0 END) = 0
89,Y,Y,SELECT BUYER_ID FROM SALES LEFT JOIN PRODUCT USING (PRODUCT_ID) GROUP BY BUYER_ID HAVING SUM(CASE WHEN PRODUCT_NAME='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN PRODUCT_NAME='iPhone' THEN 1 ELSE 0 END)=0
90,Y,Y,SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(PRODUCT_NAME = 'S8') >0 AND SUM(PRODUCT_NAME = 'iPhone') = 0
91,Y,Y,SELECT BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(PRODUCT_NAME = 'S8') > 0 AND SUM(PRODUCT_NAME = 'iPhone') = 0
92,Y,Y,SELECT BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(PRODUCT_NAME = 'S8') AND SUM(PRODUCT_NAME = 'iPhone') = 0
93,Y,Y,SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(CASE WHEN PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) = 0
94,Y,Y,SELECT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID GROUP BY BUYER_ID HAVING MAX(PRODUCT_NAME = 'S8') AND MAX(PRODUCT_NAME = 'iPhone') = 0
95,Y,Y,SELECT BUYER_ID FROM SALES S LEFT JOIN PRODUCT T USING(PRODUCT_ID) GROUP BY BUYER_ID HAVING SUM(CASE WHEN PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) = 0
96,Y,Y,"SELECT BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE PRODUCT_NAME IN ('S8','iPhone') GROUP BY BUYER_ID HAVING COUNT(DISTINCT PRODUCT_NAME) =1 AND MIN(PRODUCT_NAME) = 'S8'"
97,Y,Y,SELECT BUYER_ID FROM SALES AS T1 INNER JOIN PRODUCT USING(PRODUCT_ID) GROUP BY BUYER_ID HAVING SUM(CASE WHEN PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) = 0
98,Y,Y,SELECT BUYER_ID FROM SALES INNER JOIN PRODUCT USING(PRODUCT_ID) GROUP BY BUYER_ID HAVING SUM(CASE WHEN PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) = 0
99,Y,Y,SELECT BUYER_ID FROM SALES LEFT JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID GROUP BY 1 HAVING MAX(PRODUCT_NAME = 'S8') AND MAX(PRODUCT_NAME = 'iPhone') = 0
100,Y,Y,"SELECT BUYER_ID FROM(SALES JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID) WHERE PRODUCT_NAME IN ('S8','iPhone') GROUP BY BUYER_ID HAVING SUM(CASE PRODUCT_NAME WHEN 'iPhone' THEN 1 ELSE 0 END) = 0"
101,Y,Y,SELECT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES WHERE PRODUCT_ID IN ( SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'iPhone')) GROUP BY 1
102,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S WHERE BUYER_ID IN (SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME ='S8') AND BUYER_ID NOT IN (SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME ='iPhone')
103,Y,Y,"SELECT DISTINCT BUYER_ID FROM SALES S, PRODUCT P WHERE S.PRODUCT_ID = P.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(PRODUCT_NAME = 'S8')>0 AND SUM(PRODUCT_NAME = 'iPhone')=0"
104,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID IN (SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID AND P.PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID AND P.PRODUCT_NAME = 'iPhone')
105,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID IN ( SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' ) AND BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone' )
106,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES WHERE PRODUCT_ID IN ( SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'S8' ) AND BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES WHERE PRODUCT_ID IN ( SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'iPhone' ) )
107,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P USING (PRODUCT_ID) WHERE P.PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES S JOIN PRODUCT P USING (PRODUCT_ID) WHERE P.PRODUCT_NAME = 'iPhone' )
108,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON P. PRODUCT_ID = S.PRODUCT_ID WHERE PRODUCT_NAME= 'S8' AND BUYER_ID NOT IN (SELECT DISTINCT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON P. PRODUCT_ID = S.PRODUCT_ID WHERE PRODUCT_NAME= 'iPhone')
109,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES AS S INNER JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM(CASE WHEN P.PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN P.PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) = 0
110,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES AS S INNER JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' HAVING BUYER_ID NOT IN ( SELECT S.BUYER_ID FROM SALES AS S INNER JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone' )
111,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE PRODUCT_NAME='S8' AND S.BUYER_ID NOT IN (SELECT S.BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE PRODUCT_NAME='iPhone')
112,Y,Y,SELECT DISTINCT(S.BUYER_ID) FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID=S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT S.BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID=S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
113,Y,Y,SELECT DISTINCT(S.BUYER_ID) FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT DISTINCT(S.BUYER_ID) AS IPHONEBUYER FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone')
114,Y,Y,SELECT DISTINCT(BUYER_ID) FROM SALES WHERE BUYER_ID IN (SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE P.PRODUCT_NAME='S8' ) AND BUYER_ID NOT IN (SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE P.PRODUCT_NAME='iPhone' )
115,Y,Y,SELECT DISTINCT(S.BUYER_ID) FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT DISTINCT(S.BUYER_ID) AS IPHONEBUYER FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone' )
116,Y,Y,SELECT S.BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM(P.PRODUCT_NAME = 'S8') > 0 AND SUM(P.PRODUCT_NAME = 'iPhone') = 0
117,Y,Y,SELECT S.BUYER_ID FROM SALES AS S LEFT JOIN PRODUCT AS P ON S.PRODUCT_ID=P.PRODUCT_ID GROUP BY S.BUYER_ID HAVING GROUP_CONCAT(DISTINCT P.PRODUCT_NAME) LIKE '%S8%' AND GROUP_CONCAT(DISTINCT P.PRODUCT_NAME) NOT LIKE '%IPHONE%'
118,Y,Y,SELECT S.BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(PRODUCT_NAME = 'S8')>0 AND SUM(PRODUCT_NAME = 'iPhone')=0
119,Y,Y,SELECT S.BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(CASE WHEN P.PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN P.PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) = 0
120,Y,Y,SELECT S.BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM(CASE WHEN P.PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN P.PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) = 0
121,Y,Y,SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM(CASE WHEN (P.PRODUCT_NAME = 'iPhone') THEN 1 ELSE 0 END)=0 AND SUM(CASE WHEN (P.PRODUCT_NAME = 'S8') THEN 1 ELSE 0 END)>0
122,Y,Y,SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY 1 HAVING SUM(P.PRODUCT_NAME = 'S8') > 0 AND SUM(P.PRODUCT_NAME = 'iPhone') = 0
123,Y,Y,SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM( CASE WHEN P.PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END ) = 0 AND SUM( CASE WHEN P.PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END ) >= 1
124,Y,Y,SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM(P.PRODUCT_NAME='S8')>=1 AND SUM(P.PRODUCT_NAME='iPhone')=0
125,Y,Y,SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID GROUP BY 1 HAVING SUM(CASE WHEN P.PRODUCT_NAME LIKE S8 THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN P.PRODUCT_NAME LIKE IPHONE THEN 1 ELSE 0 END)=0
126,Y,Y,SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P USING(PRODUCT_ID) GROUP BY S.BUYER_ID HAVING SUM(P.PRODUCT_NAME = 'S8') > 0 AND SUM(P.PRODUCT_NAME = 'iPhone') = 0
127,Y,Y,SELECT T1.BUYER_ID FROM SALES AS T1 INNER JOIN PRODUCT AS T2 ON T1.PRODUCT_ID = T2.PRODUCT_ID GROUP BY T1.BUYER_ID HAVING SUM(CASE WHEN T2.PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN T2.PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) = 0
128,Y,Y,"SELECT BUYER_ID FROM (SELECT S.PRODUCT_ID, P.PRODUCT_NAME, S.BUYER_ID FROM PRODUCT P LEFT JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID) AS T1 GROUP BY BUYER_ID HAVING SUM(T1.PRODUCT_NAME = 'S8') > 0 AND SUM(T1.PRODUCT_NAME = 'iPhone') = 0"
129,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES WHERE PRODUCT_ID = (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES WHERE PRODUCT_ID = (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'iPhone'))
130,Y,Y,SELECT DISTINCT A.BUYER_ID FROM SALES A JOIN PRODUCT B ON A.PRODUCT_ID = B.PRODUCT_ID WHERE B.PRODUCT_NAME = 'S8' AND A.BUYER_ID NOT IN (SELECT A.BUYER_ID FROM SALES A JOIN PRODUCT B ON A.PRODUCT_ID = B.PRODUCT_ID WHERE B.PRODUCT_NAME = 'iPhone' )
131,Y,Y,SELECT DISTINCT A.BUYER_ID FROM SALES A JOIN PRODUCT B ON A.PRODUCT_ID = B.PRODUCT_ID WHERE A.BUYER_ID IN (SELECT A.BUYER_ID FROM SALES A JOIN PRODUCT B ON A.PRODUCT_ID = B.PRODUCT_ID WHERE B.PRODUCT_NAME = 'S8') AND A.BUYER_ID NOT IN (SELECT A.BUYER_ID FROM SALES A JOIN PRODUCT B ON A.PRODUCT_ID = B.PRODUCT_ID WHERE B.PRODUCT_NAME = 'iPhone')
132,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(P.PRODUCT_NAME = 'S8')>0 AND SUM(P.PRODUCT_NAME ='iPhone')=0
133,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone') AND BUYER_ID IN (SELECT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8')
134,Y,Y,SELECT DISTINCT S.BUYER_ID FROM PRODUCT P JOIN SALES S ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME LIKE S8 AND S.BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES WHERE PRODUCT_ID IN ( SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME LIKE IPHONE ))
135,Y,Y,SELECT DISTINCT T3.BUYER_ID FROM SALES AS T3 JOIN PRODUCT AS T4 ON T3.PRODUCT_ID=T4.PRODUCT_ID WHERE T4.PRODUCT_NAME ='S8' AND T3.BUYER_ID NOT IN (SELECT T1.BUYER_ID FROM SALES AS T1 LEFT JOIN PRODUCT AS T2 ON T1.PRODUCT_ID=T2.PRODUCT_ID WHERE T2.PRODUCT_NAME ='iPhone')
136,Y,Y,SELECT DISTINCT(S.BUYER_ID) FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME ='S8' AND S.BUYER_ID NOT IN (SELECT DISTINCT(S.BUYER_ID) FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
137,Y,Y,SELECT S.BUYER_ID FROM SALES AS S JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM(CASE WHEN P.PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) >= 1 AND SUM(CASE WHEN P.PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) = 0
138,Y,Y,"WITH A AS ( SELECT DISTINCT BUYER_ID, PRODUCT_NAME FROM PRODUCT AS P JOIN SALES AS S ON P.PRODUCT_ID = S.PRODUCT_ID), B AS ( SELECT BUYER_ID, SUM(CASE WHEN PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) AS BUY_S8, SUM(CASE WHEN PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) AS BUY_IP FROM A GROUP BY BUYER_ID) SELECT BUYER_ID FROM B WHERE BUY_S8>0 AND BUY_IP = 0"
139,Y,N,"WITH A AS( SELECT SALES.BUYER_ID FROM PRODUCT LEFT JOIN SALES ON PRODUCT.PRODUCT_ID = SALES.PRODUCT_ID WHERE PRODUCT.PRODUCT_NAME = 'S8' ), B AS( SELECT SALES.BUYER_ID FROM PRODUCT LEFT JOIN SALES ON PRODUCT.PRODUCT_ID = SALES.PRODUCT_ID WHERE PRODUCT.PRODUCT_NAME = 'iPhone' ) SELECT DISTINCT A.BUYER_ID FROM A WHERE BUYER_ID NOT IN ( SELECT SALES.BUYER_ID FROM PRODUCT LEFT JOIN SALES ON PRODUCT.PRODUCT_ID = SALES.PRODUCT_ID WHERE PRODUCT.PRODUCT_NAME = 'iPhone' )"
140,Y,Y,"WITH BUYER AS ( SELECT BUYER_ID, PRODUCT_NAME FROM SALES LEFT JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE PRODUCT_NAME IN ('iPhone', 'S8') GROUP BY 1,2 ) SELECT DISTINCT T1.BUYER_ID FROM (SELECT BUYER_ID FROM BUYER WHERE PRODUCT_NAME = 'S8') T1 JOIN (SELECT BUYER_ID FROM BUYER GROUP BY 1 HAVING COUNT(*) = 1) T2 ON T1.BUYER_ID = T2.BUYER_ID"
141,Y,Y,"WITH BOUGHTS8 AS (SELECT BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8'), BOUGHTIPHONE AS (SELECT BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone') SELECT DISTINCT BUYER_ID FROM BOUGHTS8 WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM BOUGHTIPHONE)"
142,Y,Y,"WITH CTE AS ( SELECT A.BUYER_ID FROM SALES A INNER JOIN PRODUCT B ON A.PRODUCT_ID=B.PRODUCT_ID AND PRODUCT_NAME='S8'), CTE1 AS( SELECT A.BUYER_ID FROM SALES A INNER JOIN PRODUCT B ON A.PRODUCT_ID=B.PRODUCT_ID AND PRODUCT_NAME='iPhone') SELECT DISTINCT BUYER_ID FROM CTE A WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE1)"
143,Y,Y,WITH CTE AS ( SELECT BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone' ) SELECT BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE BUYER_ID NOT IN (SELECT * FROM CTE) AND P.PRODUCT_NAME = 'S8' GROUP BY 1
144,Y,Y,"WITH CTE AS ( SELECT DISTINCT(BUYER_ID) FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID AND P.PRODUCT_NAME = 'iPhone'), TEMP AS ( SELECT DISTINCT(BUYER_ID) FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID AND P.PRODUCT_NAME = 'S8') SELECT T.BUYER_ID FROM TEMP T LEFT JOIN CTE C ON T.BUYER_ID = C.BUYER_ID WHERE C.BUYER_ID IS NULL"
145,Y,Y,"WITH CTE AS( SELECT BUYER_ID,PRODUCT_NAME FROM SALES LEFT JOIN PRODUCT ON SALES.PRODUCT_ID=PRODUCT.PRODUCT_ID ) SELECT DISTINCT BUYER_ID FROM CTE WHERE BUYER_ID IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME='S8') AND BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME='iPhone')"
146,Y,Y,"WITH S8BUYERS AS (SELECT DISTINCT BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID AND P.PRODUCT_NAME = 'S8'), IPHONEBUYERS AS (SELECT DISTINCT BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID AND P.PRODUCT_NAME = 'iPhone') SELECT BUYER_ID FROM S8BUYERS WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM IPHONEBUYERS)"
147,Y,Y,"WITH S8_ID AS ( SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'S8' ), I_ID AS( SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'iPhone' ), S8_BUYER AS ( SELECT SALES.BUYER_ID FROM S8_ID, SALES WHERE SALES.PRODUCT_ID = S8_ID.PRODUCT_ID ), I_BUYER AS ( SELECT SALES.BUYER_ID FROM I_ID, SALES WHERE SALES.PRODUCT_ID = I_ID.PRODUCT_ID ) SELECT DISTINCT(S8_BUYER.BUYER_ID) FROM S8_BUYER WHERE S8_BUYER.BUYER_ID NOT IN ( SELECT BUYER_ID FROM I_BUYER)"
148,Y,Y,"WITH T1 AS ( SELECT * FROM SALES JOIN PRODUCT USING(PRODUCT_ID) WHERE PRODUCT_NAME = 'S8'), T2 AS ( SELECT * FROM SALES JOIN PRODUCT USING(PRODUCT_ID) WHERE PRODUCT_NAME = 'iPhone') SELECT DISTINCT T1.BUYER_ID FROM T1 LEFT JOIN T2 USING(BUYER_ID) WHERE T2.SELLER_ID IS NULL"
149,Y,Y,"WITH TEMP AS ( SELECT A.*,B.PRODUCT_NAME FROM SALES A LEFT JOIN PRODUCT B ON A.PRODUCT_ID = B.PRODUCT_ID) SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID IN (SELECT BUYER_ID FROM TEMP WHERE PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN (SELECT BUYER_ID FROM TEMP WHERE PRODUCT_NAME = 'iPhone')"
150,Y,Y,"WITH A AS ( SELECT A.BUYER_ID, MAX(CASE WHEN PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) AS BOUGHT_S8, MAX(CASE WHEN PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) AS BOUGHT_IPHONE FROM SALES A INNER JOIN PRODUCT B ON B.PRODUCT_ID = A.PRODUCT_ID GROUP BY 1 ) SELECT BUYER_ID FROM A WHERE BOUGHT_S8 = 1 AND BOUGHT_IPHONE = 0"
151,Y,Y,"WITH BUYER_S8 AS (SELECT BUYER_ID FROM SALES JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE PRODUCT.PRODUCT_NAME = 'S8'), BUYER_NO_IPHONE AS (SELECT BUYER_ID FROM SALES JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE PRODUCT.PRODUCT_NAME = 'iPhone') SELECT DISTINCT BUYER_ID FROM BUYER_S8 WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM BUYER_NO_IPHONE)"
152,Y,Y,"WITH BUYERTABLE AS( SELECT S.BUYER_ID, P.PRODUCT_NAME FROM SALES AS S LEFT JOIN PRODUCT AS P ON S.PRODUCT_ID=P.PRODUCT_ID ) SELECT DISTINCT BUYER_ID FROM BUYERTABLE WHERE PRODUCT_NAME='S8' AND BUYER_ID NOT IN( SELECT BUYER_ID FROM BUYERTABLE WHERE PRODUCT_NAME='iPhone' )"
153,Y,Y,"WITH COMB AS (SELECT P.PRODUCT_ID AS PID, P.PRODUCT_NAME AS NAME, S.BUYER_ID AS BID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID) SELECT DISTINCT(BID) AS BUYER_ID FROM COMB WHERE BID IN (SELECT BID FROM COMB WHERE NAME = 'S8') AND BID NOT IN (SELECT BID FROM COMB WHERE NAME = 'iPhone')"
154,Y,Y,WITH CTE AS (SELECT * FROM SALES LEFT JOIN PRODUCT USING (PRODUCT_ID)) SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME='S8') AND BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME='iPhone')
155,Y,Y,"WITH CTE AS (SELECT A.PRODUCT_ID, B.PRODUCT_NAME, A.BUYER_ID FROM SALES A LEFT JOIN PRODUCT B ON A.PRODUCT_ID = B.PRODUCT_ID) SELECT DISTINCT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'iPhone')"
156,Y,Y,WITH IPHONE AS ( SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone' ) SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM IPHONE)
157,Y,Y,"WITH IPHONE_BUYERS AS ( SELECT DISTINCT BUYER_ID AS BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID=S.PRODUCT_ID WHERE P.PRODUCT_NAME='iPhone' ), S_BUYERS AS (SELECT DISTINCT BUYER_ID AS BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID=S.PRODUCT_ID WHERE P.PRODUCT_NAME='S8') SELECT BUYER_ID FROM S_BUYERS WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM IPHONE_BUYERS)"
158,Y,Y,"WITH S8_BUYERS AS ( SELECT DISTINCT A.BUYER_ID AS BUYER_ID FROM SALES A, PRODUCT B WHERE A.PRODUCT_ID=B.PRODUCT_ID AND B.PRODUCT_NAME='S8' ), IPHONE_BUYERS AS ( SELECT DISTINCT A.BUYER_ID AS BUYER_ID FROM SALES A, PRODUCT B WHERE A.PRODUCT_ID=B.PRODUCT_ID AND B.PRODUCT_NAME='iPhone' ) SELECT BUYER_ID FROM S8_BUYERS WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM IPHONE_BUYERS)"
159,Y,Y,"WITH SOLD_PRODUCTS AS ( SELECT S.BUYER_ID, SUM(CASE WHEN P.PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) S8, SUM(CASE WHEN P.PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) IPHONE FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY S.BUYER_ID ) SELECT DISTINCT BUYER_ID FROM SOLD_PRODUCTS WHERE S8 > 0 AND IPHONE = 0"
160,Y,Y,"WITH T AS ( SELECT P.PRODUCT_NAME, S.BUYER_ID FROM PRODUCT P RIGHT JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID) SELECT BUYER_ID FROM (SELECT BUYER_ID, GROUP_CONCAT(PRODUCT_NAME SEPARATOR ',') AS PRO FROM T GROUP BY 1) T1 WHERE PRO LIKE '%S8%' AND PRO NOT LIKE '%IPHONE%'"
161,Y,Y,WITH T(BUYER_ID) AS ( SELECT BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE P.PRODUCT_NAME ='iPhone' ) SELECT DISTINCT S.BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID LEFT JOIN T ON T.BUYER_ID=S.BUYER_ID WHERE P.PRODUCT_NAME='S8' AND T.BUYER_ID IS NULL
162,Y,Y,"WITH T1 AS ( SELECT S.BUYER_ID, P.PRODUCT_NAME FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID) SELECT DISTINCT BUYER_ID FROM T1 WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM T1 WHERE PRODUCT_NAME = 'iPhone')"
163,Y,Y,"WITH T1 AS (SELECT BUYER_ID, PRODUCT_NAME FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID), T2 AS (SELECT DISTINCT(BUYER_ID) AS IB FROM T1 WHERE PRODUCT_NAME = 'iPhone') SELECT DISTINCT(BUYER_ID) FROM T1 WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT IB FROM T2)"
164,Y,Y,"WITH T1 AS (SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8'), T2 AS (SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone' ) SELECT DISTINCT BUYER_ID FROM T1 WHERE BUYER_ID NOT IN (SELECT * FROM T2) ORDER BY BUYER_ID"
165,Y,Y,WITH TEMP AS ( SELECT * FROM PRODUCT AS P JOIN SALES AS S USING(PRODUCT_ID) ) SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID IN (SELECT BUYER_ID FROM TEMP WHERE PRODUCT_NAME='S8') AND BUYER_ID NOT IN (SELECT BUYER_ID FROM TEMP WHERE PRODUCT_NAME='iPhone')
166,Y,Y,WITH TEMP AS ( SELECT * FROM SALES JOIN PRODUCT USING(PRODUCT_ID) ) SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID IN (SELECT BUYER_ID FROM TEMP WHERE PRODUCT_NAME='S8') AND BUYER_ID NOT IN (SELECT BUYER_ID FROM TEMP WHERE PRODUCT_NAME = 'iPhone')
167,Y,Y,WITH TEMP AS ( SELECT * FROM SALES LEFT JOIN PRODUCT USING (PRODUCT_ID) ) SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID IN (SELECT BUYER_ID FROM TEMP WHERE PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN (SELECT BUYER_ID FROM TEMP WHERE PRODUCT_NAME = 'iPhone')
168,Y,Y,"WITH TEMP AS ( SELECT BUYER_ID AS BUYER_ID , PRODUCT_NAME FROM SALES AS A JOIN (SELECT PRODUCT_ID, PRODUCT_NAME FROM PRODUCT) AS B ON A.PRODUCT_ID = B.PRODUCT_ID GROUP BY BUYER_ID , PRODUCT_NAME ) SELECT DISTINCT(BUYER_ID) FROM TEMP WHERE BUYER_ID IN (SELECT BUYER_ID FROM TEMP WHERE PRODUCT_NAME='S8') AND BUYER_ID NOT IN (SELECT BUYER_ID FROM TEMP WHERE PRODUCT_NAME='iPhone')"
169,Y,Y,WITH TEMP AS (SELECT * FROM SALES LEFT JOIN PRODUCT USING (PRODUCT_ID)) SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID NOT IN (SELECT TEMP.BUYER_ID FROM TEMP WHERE PRODUCT_NAME='iPhone' ) AND BUYER_ID IN (SELECT TEMP.BUYER_ID FROM TEMP WHERE PRODUCT_NAME='S8')
170,Y,Y,"WITH CTE AS ( SELECT S.PRODUCT_ID, P.PRODUCT_NAME, S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME IN ('S8', 'iPhone') ) SELECT DISTINCT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'iPhone')"
171,Y,Y,"WITH IPHONE_BUYERS AS ( SELECT DISTINCT S.BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone' ) , S8_BUYERS AS ( SELECT DISTINCT S.BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' ) SELECT * FROM S8_BUYERS WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM IPHONE_BUYERS)"
172,Y,Y,SELECT A.BUYER_ID FROM SALES A LEFT JOIN PRODUCT B USING(PRODUCT_ID) GROUP BY A.BUYER_ID HAVING SUM(CASE WHEN B.PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN B.PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) = 0
173,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES WHERE (BUYER_ID) IN (SELECT BUYER_ID FROM PRODUCT RIGHT JOIN SALES USING(PRODUCT_ID) WHERE PRODUCT_NAME='S8') AND (BUYER_ID) NOT IN (SELECT BUYER_ID FROM PRODUCT RIGHT JOIN SALES USING(PRODUCT_ID) WHERE PRODUCT_NAME='iPhone')
174,Y,Y,SELECT DISTINCT(SALES.BUYER_ID) FROM SALES INNER JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE PRODUCT.PRODUCT_NAME = 'S8' AND SALES.BUYER_ID NOT IN (SELECT DISTINCT(SALES.BUYER_ID) FROM SALES INNER JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE PRODUCT.PRODUCT_NAME = 'iPhone')
175,Y,Y,"SELECT S.BUYER_ID FROM PRODUCT AS P, SALES AS S WHERE P.PRODUCT_ID = S.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM(P.PRODUCT_NAME = 'iPhone') = 0 AND SUM(P.PRODUCT_NAME = 'S8') > 0"
176,Y,Y,SELECT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES WHERE PRODUCT_ID IN ( SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'iPhone')) GROUP BY 1
177,Y,Y,SELECT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID= P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES WHERE PRODUCT_ID = (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'iPhone')) GROUP BY 1
178,Y,Y,SELECT S.BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT S.BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone' GROUP BY BUYER_ID) GROUP BY BUYER_ID
179,Y,Y,SELECT SALES.BUYER_ID FROM SALES LEFT JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID GROUP BY SALES.BUYER_ID HAVING SUM(PRODUCT_NAME='S8') >0 AND SUM(PRODUCT_NAME='iPhone')=0
180,Y,Y,SELECT A.BUYER_ID FROM SALES A LEFT JOIN PRODUCT B ON A.PRODUCT_ID = B.PRODUCT_ID GROUP BY A.BUYER_ID HAVING SUM(B.PRODUCT_NAME = 'S8') > 0 AND SUM(B.PRODUCT_NAME = 'iPhone') = 0
181,Y,Y,SELECT A.BUYER_ID FROM SALES A LEFT JOIN PRODUCT B ON A.PRODUCT_ID=B.PRODUCT_ID GROUP BY A.BUYER_ID HAVING GROUP_CONCAT(DISTINCT PRODUCT_NAME) LIKE'%S8%' AND GROUP_CONCAT(DISTINCT PRODUCT_NAME) NOT LIKE '%IPHONE%'
182,Y,Y,SELECT B.BUYER_ID FROM PRODUCT A RIGHT JOIN SALES B ON A.PRODUCT_ID = B.PRODUCT_ID GROUP BY B.BUYER_ID HAVING SUM(CASE WHEN A.PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) >=1 AND SUM(CASE WHEN A.PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) = 0
183,Y,Y,"SELECT BUYER_ID FROM ( SELECT BUYER_ID, MAX(CASE WHEN PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) AS BOUGHT_IPHONE, MAX(CASE WHEN PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) AS BOUGHT_S8 FROM SALES JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID GROUP BY BUYER_ID ) A WHERE BOUGHT_IPHONE = 0 AND BOUGHT_S8 = 1"
184,Y,Y,"SELECT BUYER_ID FROM ( SELECT BUYER_ID, SUM(CASE WHEN PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) AS S8, SUM(CASE WHEN PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) AS IPHONE FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID GROUP BY BUYER_ID ) X WHERE S8 > 0 AND IPHONE = 0"
185,Y,Y,"SELECT BUYER_ID FROM ( SELECT BUYER_ID, SUM(CASE WHEN PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) AS S8_FLAG, SUM(CASE WHEN PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) AS IPHONE_FLAG FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID GROUP BY BUYER_ID ) A WHERE S8_FLAG>=1 AND IPHONE_FLAG=0"
186,Y,Y,"SELECT BUYER_ID FROM ( SELECT S.BUYER_ID, MAX(IF(P.PRODUCT_NAME='S8', 1, 0)) AS B_S8, MAX(IF(P.PRODUCT_NAME='iPhone', 1, 0)) AS B_IP FROM PRODUCT P RIGHT JOIN SALES S USING (PRODUCT_ID) GROUP BY S.BUYER_ID) AS TEMP WHERE B_S8=1 AND B_IP=0"
187,Y,Y,"SELECT BUYER_ID FROM ( SELECT S.BUYER_ID, SUM(CASE WHEN P.PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) AS S8_FLAG, SUM(CASE WHEN P.PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) AS IPHONE_FLAG FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY 1 ) A WHERE S8_FLAG > 0 AND IPHONE_FLAG = 0"
188,Y,Y,SELECT BUYER_ID FROM (SALES S INNER JOIN PRODUCT P ON P.PRODUCT_ID=S.PRODUCT_ID) GROUP BY BUYER_ID HAVING SUM(CASE WHEN P.PRODUCT_NAME='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN P.PRODUCT_NAME= 'iPhone' THEN 1 ELSE 0 END)=0
189,Y,Y,"SELECT BUYER_ID FROM (SELECT A.BUYER_ID, SUM(CASE WHEN B.PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) AS IPHONE_SALES, SUM(CASE WHEN B.PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) AS S8_SALES FROM SALES A LEFT JOIN PRODUCT B ON A.PRODUCT_ID = B.PRODUCT_ID GROUP BY A.BUYER_ID) C WHERE IPHONE_SALES = 0 AND S8_SALES >= 1"
190,Y,Y,"SELECT BUYER_ID FROM (SELECT BUYER_ID, GROUP_CONCAT(DISTINCT PRODUCT_NAME) AS PRODUCTS FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY BUYER_ID) AS T WHERE PRODUCTS LIKE '%S8%' AND PRODUCTS NOT LIKE '%IPHONE%'"
191,N,N,"SELECT BUYER_ID FROM (SELECT BUYER_ID, PRODUCT_NAME FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE PRODUCT_NAME IN ('iPhone','S8') GROUP BY BUYER_ID HAVING COUNT(DISTINCT PRODUCT_NAME)=1 AND PRODUCT_NAME='S8')TMP"
192,Y,Y,SELECT BUYER_ID FROM (SELECT DISTINCT S.BUYER_ID AS BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8') S1 WHERE BUYER_ID NOT IN (SELECT DISTINCT S.BUYER_ID AS BUYER_ID FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
193,Y,Y,SELECT BUYER_ID FROM (SELECT DISTINCT(BUYER_ID) FROM SALES) S WHERE EXISTS (SELECT * FROM (SELECT DISTINCT(BUYER_ID) FROM SALES JOIN PRODUCT USING (PRODUCT_ID) WHERE PRODUCT_NAME = 'S8') S1 WHERE S1.BUYER_ID = S.BUYER_ID) AND NOT EXISTS (SELECT * FROM (SELECT DISTINCT(BUYER_ID) FROM SALES JOIN PRODUCT USING (PRODUCT_ID) WHERE PRODUCT_NAME = 'iPhone') S2 WHERE S2.BUYER_ID = S.BUYER_ID)
194,Y,Y,"SELECT BUYER_ID FROM PRODUCT AS P JOIN SALES AS S ON P.PRODUCT_ID = S.PRODUCT_ID GROUP BY BUYER_ID HAVING COUNT(IF(P.PRODUCT_NAME='S8',1,NULL)) > 0 AND COUNT(IF(P.PRODUCT_NAME='iPhone',1,NULL)) = 0"
195,Y,Y,SELECT BUYER_ID FROM PRODUCT JOIN SALES ON PRODUCT. PRODUCT_ID = SALES. PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(PRODUCT_NAME = 'S8') > 0 AND SUM(PRODUCT_NAME = 'iPhone') =0
196,Y,Y,SELECT BUYER_ID FROM PRODUCT JOIN SALES USING (PRODUCT_ID) GROUP BY BUYER_ID HAVING SUM(PRODUCT_NAME='S8')>0 AND SUM(PRODUCT_NAME='iPhone')=0
197,Y,Y,SELECT BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(PRODUCT_NAME = 'S8') > 0 AND SUM(PRODUCT_NAME = 'iPhone') = 0
198,Y,Y,SELECT BUYER_ID FROM SALES A JOIN PRODUCT B USING (PRODUCT_ID) GROUP BY BUYER_ID HAVING SUM(CASE WHEN B.PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) >0 AND SUM(CASE WHEN B.PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) = 0
199,Y,Y,SELECT BUYER_ID FROM SALES A LEFT JOIN PRODUCT B ON A.PRODUCT_ID = B.PRODUCT_ID GROUP BY 1 HAVING SUM(CASE WHEN B.PRODUCT_NAME='S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN B.PRODUCT_NAME='iPhone' THEN 1 ELSE 0 END) = 0
200,Y,Y,SELECT BUYER_ID FROM SALES AS S JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(CASE WHEN PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) = 0
201,Y,Y,SELECT BUYER_ID FROM SALES INNER JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(CASE WHEN PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) = 0
202,Y,Y,SELECT BUYER_ID FROM SALES INNER JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE SALES.PRODUCT_ID IN (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'S8' OR PRODUCT_NAME = 'iPhone') GROUP BY BUYER_ID HAVING SUM(CASE WHEN PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) = 0
203,Y,Y,"SELECT BUYER_ID FROM SALES JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(IF(PRODUCT_NAME = 'S8',1,0)) >=1 AND SUM(IF(PRODUCT_NAME = 'iPhone',1,0)) = 0"
204,Y,Y,SELECT BUYER_ID FROM SALES JOIN PRODUCT USING (PRODUCT_ID) GROUP BY BUYER_ID HAVING GROUP_CONCAT(PRODUCT_NAME) LIKE '%S8%' AND GROUP_CONCAT(PRODUCT_NAME) NOT LIKE '%IPHONE%'
205,Y,Y,SELECT BUYER_ID FROM SALES JOIN PRODUCT USING(PRODUCT_ID) GROUP BY BUYER_ID HAVING SUM(CASE WHEN PRODUCT.PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN PRODUCT.PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) = 0
206,Y,Y,SELECT BUYER_ID FROM SALES JOIN PRODUCT USING(PRODUCT_ID) GROUP BY BUYER_ID HAVING SUM(PRODUCT.PRODUCT_NAME = 'S8') > 0 AND SUM(PRODUCT.PRODUCT_NAME = 'iPhone') = 0
207,Y,Y,SELECT BUYER_ID FROM SALES JOIN PRODUCT USING(PRODUCT_ID) GROUP BY BUYER_ID HAVING SUM(PRODUCT_NAME='S8')>0 AND SUM(PRODUCT_NAME='iPhone')=0
208,Y,Y,SELECT BUYER_ID FROM SALES LEFT JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID GROUP BY BUYER_ID HAVING (SUM(PRODUCT_NAME = 'S8') > 0) AND (SUM(PRODUCT_NAME = 'iPhone') = 0)
209,Y,Y,SELECT BUYER_ID FROM SALES S JOIN PRODUCT P USING(PRODUCT_ID) GROUP BY BUYER_ID HAVING SUM(P.PRODUCT_NAME='S8')>=1 AND SUM(P.PRODUCT_NAME='iPhone')=0
210,Y,Y,SELECT BUYER_ID FROM SALES S JOIN PRODUCT P WHERE S.PRODUCT_ID = P.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(PRODUCT_NAME = 'S8') > 0 AND SUM(PRODUCT_NAME = 'iPhone') = 0
211,Y,Y,"SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE S.PRODUCT_ID IN ( SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME IN ('S8','iPhone') ) GROUP BY BUYER_ID HAVING SUM(CASE WHEN PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) = 0"
212,Y,Y,"SELECT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(IF(PRODUCT_NAME='S8',1,0))>=1 AND SUM(IF(PRODUCT_NAME='iPhone',1,0))=0"
213,Y,Y,"SELECT BUYER_ID FROM PRODUCT JOIN SALES USING (PRODUCT_ID) WHERE PRODUCT_NAME='iPhone' OR PRODUCT_NAME='S8' GROUP BY BUYER_ID HAVING SUM(IF(PRODUCT_NAME='iPhone', 1, 0)) = 0"
214,Y,Y,SELECT BUYER_ID FROM PRODUCT P JOIN SALES S USING (PRODUCT_ID) GROUP BY BUYER_ID HAVING SUM(CASE WHEN P.PRODUCT_NAME='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN P.PRODUCT_NAME='iPhone' THEN 1 ELSE 0 END)=0
215,Y,Y,"SELECT BUYER_ID FROM SALES A, PRODUCT B WHERE A.PRODUCT_ID=B.PRODUCT_ID GROUP BY BUYER_ID HAVING MAX(PRODUCT_NAME='S8') AND MAX(PRODUCT_NAME='iPhone')=0"
216,Y,Y,"SELECT BUYER_ID FROM SALES A,PRODUCT B WHERE A.PRODUCT_ID=B.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(CASE WHEN PRODUCT_NAME='S8' THEN 1 ELSE 0 END) >0 AND SUM(CASE WHEN PRODUCT_NAME='iPhone' THEN 1 ELSE 0 END) =0"
217,Y,Y,SELECT BUYER_ID FROM SALES JOIN PRODUCT USING(PRODUCT_ID) WHERE PRODUCT_NAME='S8' AND BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES JOIN PRODUCT USING(PRODUCT_ID) WHERE PRODUCT_NAME='iPhone' ) GROUP BY BUYER_ID
218,Y,Y,SELECT BUYER_ID FROM SALES JOIN PRODUCT USING (PRODUCT_ID) GROUP BY BUYER_ID HAVING ( SUM(CASE WHEN PRODUCT_NAME ='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN PRODUCT_NAME ='iPhone' THEN 1 ELSE 0 END)=0)
219,Y,Y,"SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID=S.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(IF(P.PRODUCT_NAME='S8', 1, 0))>0 AND SUM(IF(P.PRODUCT_NAME='iPhone', 1, 0))=0"
220,Y,Y,SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY 1 HAVING MAX(PRODUCT_NAME = 'S8') AND MAX(PRODUCT_NAME = 'iPhone') = 0
221,Y,Y,SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY 1 HAVING MAX(PRODUCT_NAME = 'S8')>0 AND MAX(PRODUCT_NAME = 'iPhone') = 0
222,Y,Y,SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY S.BUYER_ID HAVING MAX(PRODUCT_NAME = 'S8')=1 AND MAX(PRODUCT_NAME = 'iPhone') = 0
223,Y,Y,SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(CASE WHEN P.PRODUCT_NAME='S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN P.PRODUCT_NAME='iPhone' THEN 1 ELSE 0 END)=0
224,Y,Y,"SELECT BUYER_ID FROM( SELECT BUYER_ID, (CASE WHEN PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) S8, (CASE WHEN PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) IPHONE FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID) Z GROUP BY 1 HAVING SUM(S8)>0 AND SUM(IPHONE)=0"
225,Y,Y,SELECT DISTINCT SALES.BUYER_ID FROM SALES INNER JOIN PRODUCT ON PRODUCT.PRODUCT_ID = SALES.PRODUCT_ID WHERE BUYER_ID IN ( SELECT DISTINCT SALES.BUYER_ID FROM SALES LEFT JOIN ( SELECT SALES.BUYER_ID FROM SALES INNER JOIN PRODUCT ON PRODUCT.PRODUCT_ID = SALES.PRODUCT_ID WHERE PRODUCT.PRODUCT_NAME='iPhone') IPHONEUSERS ON SALES.BUYER_ID = IPHONEUSERS.BUYER_ID WHERE IPHONEUSERS.BUYER_ID IS NULL ) AND PRODUCT_NAME='S8'
226,Y,Y,SELECT DISTINCT A.BUYER_ID FROM SALES A INNER JOIN PRODUCT B ON A.PRODUCT_ID = B.PRODUCT_ID WHERE A.BUYER_ID IN (SELECT C.BUYER_ID FROM SALES C INNER JOIN PRODUCT D ON C.PRODUCT_ID = D.PRODUCT_ID WHERE D.PRODUCT_NAME = 'S8') AND A.BUYER_ID NOT IN (SELECT C.BUYER_ID FROM SALES C INNER JOIN PRODUCT D ON C.PRODUCT_ID = D.PRODUCT_ID WHERE D.PRODUCT_NAME = 'iPhone' )
227,Y,Y,SELECT DISTINCT A.BUYER_ID FROM SALES A LEFT JOIN PRODUCT B ON A.PRODUCT_ID=B.PRODUCT_ID WHERE B. PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT A.BUYER_ID FROM SALES A LEFT JOIN PRODUCT B ON A.PRODUCT_ID=B.PRODUCT_ID WHERE B. PRODUCT_NAME = 'iPhone')
228,Y,Y,SELECT DISTINCT B.BUYER_ID FROM SALES B LEFT JOIN PRODUCT A ON A.PRODUCT_ID=B.PRODUCT_ID WHERE A.PRODUCT_NAME='S8' AND BUYER_ID NOT IN (SELECT DISTINCT B.BUYER_ID FROM SALES B LEFT JOIN PRODUCT A ON A.PRODUCT_ID=B.PRODUCT_ID WHERE A.PRODUCT_NAME='iPhone') GROUP BY 1
229,Y,Y,SELECT DISTINCT BUYER_ID FROM ( SELECT BUYER_ID FROM SALES WHERE PRODUCT_ID IN ( SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'S8' ) ) AS T WHERE T.BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES WHERE PRODUCT_ID = (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'iPhone' ) )
230,Y,Y,"SELECT DISTINCT BUYER_ID FROM (SELECT BUYER_ID FROM SALES S, PRODUCT P WHERE S.PRODUCT_ID = P.PRODUCT_ID AND P.PRODUCT_NAME = 'S8') S1 WHERE BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES S, PRODUCT P WHERE S.PRODUCT_ID = P.PRODUCT_ID AND P.PRODUCT_NAME = 'iPhone')"
231,Y,Y,"SELECT DISTINCT BUYER_ID FROM (SELECT S.BUYER_ID, CASE WHEN P.PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END AS S8, CASE WHEN P.PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END AS IPHONE FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID) TEMP1 GROUP BY BUYER_ID HAVING SUM(S8) > 0 AND SUM(IPHONE) = 0"
232,Y,Y,SELECT DISTINCT BUYER_ID FROM PRODUCT P INNER JOIN SALES S ON P.PRODUCT_ID=S.PRODUCT_ID WHERE P.PRODUCT_NAME='S8' AND S.BUYER_ID NOT IN (SELECT BUYER_ID FROM PRODUCT P INNER JOIN SALES S ON P.PRODUCT_ID=S.PRODUCT_ID WHERE P.PRODUCT_NAME='iPhone' )
233,Y,Y,SELECT DISTINCT BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE PRODUCT_NAME ='S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE PRODUCT_NAME ='iPhone' )
234,Y,Y,SELECT DISTINCT BUYER_ID FROM PRODUCT INNER JOIN SALES ON PRODUCT.PRODUCT_ID = SALES.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN ( SELECT DISTINCT BUYER_ID FROM PRODUCT INNER JOIN SALES ON PRODUCT.PRODUCT_ID = SALES.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone' )
235,Y,Y,SELECT DISTINCT BUYER_ID FROM PRODUCT P JOIN SALES S ON S.PRODUCT_ID=P.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN ( SELECT DISTINCT BUYER_ID FROM PRODUCT P JOIN SALES S ON S.PRODUCT_ID=P.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone' )
236,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID IN ( SELECT BUYER_ID FROM SALES WHERE PRODUCT_ID =(SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'S8')) AND BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES WHERE PRODUCT_ID =(SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'iPhone'))
237,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone')
238,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES A JOIN PRODUCT P USING(PRODUCT_ID) WHERE P.PRODUCT_NAME = 'S8' AND A.BUYER_ID NOT IN (SELECT DISTINCT BUYER_ID FROM SALES JOIN PRODUCT USING(PRODUCT_ID) WHERE PRODUCT_NAME='iPhone')
239,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES A LEFT JOIN PRODUCT B ON A.PRODUCT_ID = B.PRODUCT_ID WHERE B.PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT DISTINCT BUYER_ID FROM SALES A LEFT JOIN PRODUCT B ON A.PRODUCT_ID = B.PRODUCT_ID WHERE B.PRODUCT_NAME ='iPhone')
240,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES AS A LEFT JOIN PRODUCT AS B ON A.PRODUCT_ID =B.PRODUCT_ID WHERE (PRODUCT_NAME ='S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES AS A LEFT JOIN PRODUCT AS B ON A.PRODUCT_ID =B.PRODUCT_ID WHERE PRODUCT_NAME ='iPhone' ))
241,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES AS S INNER JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME ='S8' AND BUYER_ID NOT IN (SELECT S.BUYER_ID FROM PRODUCT AS P INNER JOIN SALES AS S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'IPHONE ')
242,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES INNER JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID AND PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES INNER JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID AND PRODUCT_NAME = 'iPhone')
243,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES INNER JOIN PRODUCT USING (PRODUCT_ID) WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT DISTINCT BUYER_ID FROM SALES INNER JOIN PRODUCT USING (PRODUCT_ID) WHERE PRODUCT_NAME = 'iPhone')
244,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE PRODUCT.PRODUCT_NAME ='S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone')
245,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES JOIN PRODUCT USING(PRODUCT_ID) WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT DISTINCT BUYER_ID FROM SALES JOIN PRODUCT USING(PRODUCT_ID) WHERE PRODUCT_NAME = 'iPhone')
246,Y,Y,"SELECT DISTINCT BUYER_ID FROM SALES LEFT JOIN PRODUCT ON SALES.PRODUCT_ID=PRODUCT.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(IF(PRODUCT_NAME='S8',1,0))>0 AND SUM(IF(PRODUCT_NAME='iPhone',1,0))=0"
247,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON (S.PRODUCT_ID = P.PRODUCT_ID) WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID AND PRODUCT_NAME = 'iPhone')
248,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON P.PRODUCT_ID=S.PRODUCT_ID WHERE PRODUCT_NAME='S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON P.PRODUCT_ID=S.PRODUCT_ID WHERE PRODUCT_NAME='iPhone')
249,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN ( SELECT DISTINCT BUYER_ID FROM SALES S1 INNER JOIN PRODUCT P1 ON S1.PRODUCT_ID =P1.PRODUCT_ID WHERE P1.PRODUCT_NAME = 'iPhone' )
250,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE P.PRODUCT_NAME='S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE P.PRODUCT_NAME='iPhone')
251,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE P.PRODUCT_NAME='S8' AND BUYER_ID NOT IN (SELECT DISTINCT BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE P.PRODUCT_NAME='iPhone')
252,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID=S.PRODUCT_ID WHERE P.PRODUCT_NAME='S8' AND BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID=S.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone')
253,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P USING(PRODUCT_ID) WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES SS JOIN PRODUCT PP USING(PRODUCT_ID) WHERE PRODUCT_NAME ='iPhone') AND PRODUCT_NAME ='S8'
254,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES WHERE (BUYER_ID IN (SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8')) AND (BUYER_ID NOT IN (SELECT DISTINCT BUYER_ID FROM SALES S2 JOIN PRODUCT P2 ON S2.PRODUCT_ID = P2.PRODUCT_ID WHERE P2.PRODUCT_NAME = 'iPhone'))
255,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID IN ( SELECT A.BUYER_ID FROM SALES AS A INNER JOIN PRODUCT AS B ON A.PRODUCT_ID=B.PRODUCT_ID WHERE B.PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN (SELECT A.BUYER_ID FROM SALES AS A INNER JOIN PRODUCT AS B ON A.PRODUCT_ID=B.PRODUCT_ID WHERE B.PRODUCT_NAME = 'iPhone')
256,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID IN ( SELECT BUYER_ID FROM SALES LEFT JOIN PRODUCT ON SALES.PRODUCT_ID=PRODUCT.PRODUCT_ID WHERE PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES LEFT JOIN PRODUCT ON SALES.PRODUCT_ID=PRODUCT.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone')
257,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID IN (SELECT DISTINCT BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME ='S8' ) AND BUYER_ID NOT IN (SELECT DISTINCT BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME ='iPhone')
258,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID IN (SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P USING (PRODUCT_ID) WHERE P.PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN (SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P USING (PRODUCT_ID) WHERE P.PRODUCT_NAME = 'iPhone')
259,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID= P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone') AND BUYER_ID IN (SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID= P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8')
260,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES WHERE PRODUCT_ID IN (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN ( SELECT DISTINCT BUYER_ID FROM SALES WHERE PRODUCT_ID IN (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'iPhone') )
261,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES WHERE PRODUCT_ID IN (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES WHERE PRODUCT_ID IN (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'iPhone')) ORDER BY 1
262,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES WHERE PRODUCT_ID IN (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID AND P.PRODUCT_NAME = 'iPhone' )
263,Y,Y,SELECT DISTINCT BUYER_ID FROM PRODUCT A JOIN SALES B ON A.PRODUCT_ID = B.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT DISTINCT BUYER_ID FROM PRODUCT A JOIN SALES B ON A.PRODUCT_ID = B.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone')
264,Y,Y,SELECT DISTINCT BUYER_ID FROM PRODUCT JOIN SALES USING (PRODUCT_ID) WHERE PRODUCT_NAME ='S8' AND BUYER_ID NOT IN ( SELECT BUYER_ID FROM PRODUCT JOIN SALES USING (PRODUCT_ID) WHERE PRODUCT_NAME ='iPhone')
265,Y,Y,SELECT DISTINCT BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone')
266,Y,Y,SELECT DISTINCT BUYER_ID FROM PRODUCT P JOIN SALES S ON S.PRODUCT_ID=P.PRODUCT_ID GROUP BY 1 HAVING SUM(PRODUCT_NAME='S8') > 0 AND SUM(PRODUCT_NAME='iPhone') = 0
267,Y,Y,SELECT DISTINCT BUYER_ID FROM PRODUCT P JOIN SALES S USING (PRODUCT_ID) WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT DISTINCT BUYER_ID FROM PRODUCT P JOIN SALES S USING (PRODUCT_ID) WHERE PRODUCT_NAME = 'iPhone')
268,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES AS S INNER JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME= 'S8' AND BUYER_ID NOT IN (SELECT S.BUYER_ID FROM SALES AS S INNER JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'IPHONE ')
269,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone' )
270,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES JOIN PRODUCT USING(PRODUCT_ID) WHERE PRODUCT_NAME = 'iPhone' )
271,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES JOIN PRODUCT USING (PRODUCT_ID) WHERE BUYER_ID NOT IN (SELECT DISTINCT BUYER_ID FROM SALES A JOIN PRODUCT B ON A.PRODUCT_ID = B.PRODUCT_ID WHERE B.PRODUCT_NAME = 'iPhone') AND PRODUCT_NAME = 'S8'
272,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES LEFT JOIN PRODUCT ON SALES.PRODUCT_ID= PRODUCT.PRODUCT_ID WHERE PRODUCT.PRODUCT_NAME ='S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES LEFT JOIN PRODUCT ON SALES.PRODUCT_ID=PRODUCT.PRODUCT_ID WHERE PRODUCT.PRODUCT_NAME = 'iPhone')
273,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES LEFT JOIN PRODUCT ON SALES.PRODUCT_ID=PRODUCT.PRODUCT_ID WHERE PRODUCT_NAME ='S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES LEFT JOIN PRODUCT ON SALES.PRODUCT_ID=PRODUCT.PRODUCT_ID WHERE PRODUCT_NAME ='iPhone')
274,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE S.BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone') AND P.PRODUCT_NAME = 'S8'
275,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(CASE WHEN P.PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) >= 1 AND SUM(CASE WHEN P.PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) = 0
276,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE (BUYER_ID) NOT IN( SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone') AND P.PRODUCT_NAME = 'S8'
277,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE P.PRODUCT_NAME='S8' AND BUYER_ID NOT IN ( SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE P.PRODUCT_NAME='iPhone')
278,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P USING(PRODUCT_ID) WHERE PRODUCT_NAME='S8' AND BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES S JOIN PRODUCT P USING (PRODUCT_ID) WHERE PRODUCT_NAME='iPhone' )
279,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
280,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone')
281,Y,Y,"SELECT DISTINCT BUYER_ID FROM SALES S, PRODUCT P WHERE S.PRODUCT_ID=P.PRODUCT_ID AND PRODUCT_NAME='S8' AND BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES S, PRODUCT P WHERE S.PRODUCT_ID=P.PRODUCT_ID AND PRODUCT_NAME='iPhone' )"
282,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID IN (SELECT BUYER_ID FROM SALES JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone')
283,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID IN (SELECT BUYER_ID FROM SALES S JOIN PRODUCT P USING(PRODUCT_ID) WHERE PRODUCT_NAME='S8') AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES S JOIN PRODUCT P USING(PRODUCT_ID) WHERE PRODUCT_NAME='iPhone')
284,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID IN (SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN (SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
285,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE PRODUCT_NAME='iPhone') AND BUYER_ID IN (SELECT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE PRODUCT_NAME='S8')
286,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID NOT IN(SELECT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone') AND BUYER_ID IN(SELECT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8')
287,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES WHERE PRODUCT_ID = (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES WHERE PRODUCT_ID IN (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'iPhone'))
288,Y,Y,"SELECT DISTINCT BUYER_ID FROM SALES WHERE PRODUCT_ID IN (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME IN ('S8')) AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES WHERE PRODUCT_ID IN (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME IN ('iPhone', 'G4')))"
289,Y,Y,SELECT DISTINCT C.BUYER_ID FROM SALES C LEFT JOIN PRODUCT G ON C.PRODUCT_ID = G.PRODUCT_ID LEFT JOIN (SELECT BUYER_ID FROM SALES A LEFT JOIN PRODUCT B ON A.PRODUCT_ID = B.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone')D ON C.BUYER_ID = D.BUYER_ID WHERE D.BUYER_ID IS NULL AND G.PRODUCT_NAME = 'S8'
290,Y,Y,"SELECT DISTINCT C.BUYER_ID FROM SALES C LEFT JOIN PRODUCT G ON C.PRODUCT_ID = G.PRODUCT_ID LEFT JOIN (SELECT BUYER_ID, PRODUCT_NAME FROM SALES A LEFT JOIN PRODUCT B ON A.PRODUCT_ID = B.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone')D ON C.BUYER_ID = D.BUYER_ID WHERE D.PRODUCT_NAME IS NULL AND G.PRODUCT_NAME = 'S8'"
291,Y,Y,"SELECT DISTINCT S.BUYER_ID FROM (SELECT S.PRODUCT_ID,PRODUCT_NAME,BUYER_ID FROM SALES S JOIN PRODUCT P USING(PRODUCT_ID) WHERE PRODUCT_NAME = 'S8') S LEFT JOIN (SELECT S.PRODUCT_ID,PRODUCT_NAME,BUYER_ID FROM SALES S JOIN PRODUCT P USING(PRODUCT_ID) WHERE PRODUCT_NAME = 'iPhone') I USING(BUYER_ID) WHERE I.BUYER_ID IS NULL"
292,Y,Y,SELECT DISTINCT S.BUYER_ID FROM PRODUCT P INNER JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN ( SELECT S.BUYER_ID FROM PRODUCT P INNER JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone' )
293,Y,Y,SELECT DISTINCT S.BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN ( SELECT DISTINCT S.BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone' )
294,Y,N,SELECT DISTINCT S.BUYER_ID FROM PRODUCT P LEFT JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT DISTINCT S.BUYER_ID FROM PRODUCT P LEFT JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone')
295,Y,Y,"SELECT DISTINCT S.BUYER_ID FROM PRODUCT P, SALES S WHERE P.PRODUCT_NAME = 'S8' AND P.PRODUCT_ID = S.PRODUCT_ID AND S.BUYER_ID NOT IN (SELECT DISTINCT S1.BUYER_ID FROM PRODUCT P1, SALES S1 WHERE P1.PRODUCT_ID = S1.PRODUCT_ID AND P1.PRODUCT_NAME = 'iPhone')"
296,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES AS S JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE (P.PRODUCT_NAME = 'S8') AND ( S.BUYER_ID NOT IN ( SELECT S.BUYER_ID FROM SALES AS S JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone' ) )
297,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES AS S JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT S.BUYER_ID FROM SALES AS S JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
298,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM(PRODUCT_NAME='S8')>0 AND SUM(PRODUCT_NAME='iPhone') = 0
299,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME IN ('S8') AND S.BUYER_ID NOT IN (SELECT DISTINCT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME IN ('iPhone'))
300,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S JOIN PRODUCT P USING (PRODUCT_ID) WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN ( SELECT DISTINCT S.BUYER_ID FROM SALES S JOIN PRODUCT P USING (PRODUCT_ID) WHERE P.PRODUCT_NAME = 'iPhone')
301,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT S1.BUYER_ID FROM SALES S1 JOIN PRODUCT P1 ON P1.PRODUCT_ID = S1.PRODUCT_ID AND P1.PRODUCT_NAME = 'iPhone')
302,Y,N,SELECT DISTINCT S.BUYER_ID FROM PRODUCT P LEFT JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT S.BUYER_ID FROM PRODUCT P LEFT JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
303,Y,Y,"SELECT DISTINCT S.BUYER_ID FROM SALES AS S , PRODUCT AS P WHERE S.PRODUCT_ID = P.PRODUCT_ID AND P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN ( SELECT S.BUYER_ID FROM SALES AS S , PRODUCT AS P WHERE S.PRODUCT_ID = P.PRODUCT_ID AND P.PRODUCT_NAME = 'iPhone' )"
304,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
305,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN ( SELECT DISTINCT S.BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone' GROUP BY S.BUYER_ID )
306,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE BUYER_ID IN (SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME ='S8' ) AND BUYER_ID NOT IN (SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME ='iPhone' )
307,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT DISTINCT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone') ORDER BY S.BUYER_ID
308,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID =P.PRODUCT_ID WHERE P.PRODUCT_NAME='S8' AND S.BUYER_ID NOT IN (SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID =P.PRODUCT_ID WHERE P.PRODUCT_NAME='iPhone')
309,Y,Y,"SELECT DISTINCT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE BUYER_ID IN ( SELECT S.BUYER_ID FROM SALES S, PRODUCT P WHERE P.PRODUCT_ID = S.PRODUCT_ID AND PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN ( SELECT S.BUYER_ID FROM SALES S, PRODUCT P WHERE P.PRODUCT_ID = S.PRODUCT_ID AND PRODUCT_NAME = 'iPhone')"
310,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE S.BUYER_ID NOT IN (SELECT S.BUYER_ID BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE P.PRODUCT_NAME='iPhone') AND P.PRODUCT_NAME='S8'
311,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S JOIN PRODUCT P USING(PRODUCT_ID) GROUP BY 1 HAVING SUM(CASE WHEN P.PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) >=1 AND SUM(CASE WHEN P.PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) = 0
312,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S JOIN PRODUCT P USING(PRODUCT_ID) WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P USING(PRODUCT_ID) WHERE P.PRODUCT_NAME = 'iPhone')
313,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM(CASE WHEN P.PRODUCT_NAME ='S8' THEN 1 ELSE 0 END)>=1 AND SUM(CASE WHEN P.PRODUCT_NAME= 'iPhone' THEN 1 ELSE 0 END)=0
314,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S WHERE S.PRODUCT_ID = (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'S8') AND S.BUYER_ID NOT IN (SELECT DISTINCT BUYER_ID FROM SALES WHERE PRODUCT_ID = ((SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'iPhone')))
315,Y,Y,"SELECT DISTINCT S.BUYER_ID FROM SALES S WHERE S.PRODUCT_ID = (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'S8') AND S.BUYER_ID NOT IN (SELECT DISTINCT SS.BUYER_ID FROM SALES SS, PRODUCT P WHERE P.PRODUCT_NAME = 'iPhone' AND P.PRODUCT_ID = SS.PRODUCT_ID )"
316,Y,Y,"SELECT DISTINCT S.BUYER_ID FROM SALES S, PRODUCT P WHERE S.PRODUCT_ID=P.PRODUCT_ID AND P.PRODUCT_NAME='S8' AND S.BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES S, PRODUCT P WHERE S.PRODUCT_ID=P.PRODUCT_ID AND P.PRODUCT_NAME='iPhone')"
317,Y,N,SELECT DISTINCT S1.BUYER_ID FROM PRODUCT P1 LEFT JOIN SALES S1 ON P1.PRODUCT_ID = S1.PRODUCT_ID WHERE P1.PRODUCT_NAME = 'S8' AND S1.BUYER_ID NOT IN ( SELECT DISTINCT S1.BUYER_ID FROM PRODUCT P1 LEFT JOIN SALES S1 ON P1.PRODUCT_ID = S1.PRODUCT_ID WHERE P1.PRODUCT_NAME = 'iPhone' )
318,Y,Y,SELECT DISTINCT S2.BUYER_ID FROM SALES S2 JOIN (SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8') X ON X.BUYER_ID = S2.BUYER_ID WHERE X.BUYER_ID NOT IN (SELECT A.BUYER_ID FROM SALES A JOIN PRODUCT B ON A.PRODUCT_ID = B.PRODUCT_ID WHERE B.PRODUCT_NAME = 'iPhone')
319,Y,Y,SELECT DISTINCT T1.BUYER_ID FROM (SELECT X.BUYER_ID FROM SALES AS X WHERE X.BUYER_ID NOT IN (SELECT S.BUYER_ID FROM SALES AS S WHERE S.PRODUCT_ID IN (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'iPhone'))) AS T1 WHERE T1.BUYER_ID IN (SELECT Y.BUYER_ID FROM SALES AS Y WHERE Y.PRODUCT_ID IN (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'S8'))
320,Y,Y,SELECT DISTINCT(B.BUYER_ID) FROM SALES B WHERE B.BUYER_ID IN( SELECT B.BUYER_ID FROM SALES B LEFT JOIN PRODUCT A ON A.PRODUCT_ID=B.PRODUCT_ID WHERE A.PRODUCT_NAME='S8') AND B.BUYER_ID NOT IN( SELECT B.BUYER_ID FROM SALES B LEFT JOIN PRODUCT A ON A.PRODUCT_ID=B.PRODUCT_ID WHERE A.PRODUCT_NAME='iPhone')
321,Y,Y,SELECT DISTINCT(BUYER_ID) FROM SALES LEFT JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES LEFT JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE PRODUCT_NAME ='iPhone') AND PRODUCT_NAME = 'S8'
322,Y,Y,SELECT DISTINCT(BUYER_ID) FROM SALES S WHERE EXISTS (SELECT * FROM (SELECT DISTINCT(BUYER_ID) FROM SALES JOIN PRODUCT USING (PRODUCT_ID) WHERE PRODUCT_NAME = 'S8') S1 WHERE S1.BUYER_ID = S.BUYER_ID) AND NOT EXISTS (SELECT * FROM (SELECT DISTINCT(BUYER_ID) FROM SALES JOIN PRODUCT USING (PRODUCT_ID) WHERE PRODUCT_NAME = 'iPhone') S2 WHERE S2.BUYER_ID = S.BUYER_ID)
323,Y,Y,SELECT DISTINCT(BUYER_ID) FROM SALES WHERE BUYER_ID IN (SELECT BUYER_ID FROM SALES LEFT JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES LEFT JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE PRODUCT_NAME ='iPhone')
324,Y,Y,SELECT DISTINCT(BUYER_ID) FROM SALES WHERE PRODUCT_ID IN (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME='S8') AND BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID AND P.PRODUCT_NAME = 'iPhone' )
325,Y,Y,SELECT DISTINCT(BUYER_ID) FROM SALES WHERE PRODUCT_ID IN (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME='S8') AND BUYER_ID NOT IN (SELECT DISTINCT(BUYER_ID) FROM SALES WHERE PRODUCT_ID IN (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME='iPhone'))
326,Y,Y,SELECT DISTINCT(BUYER_ID) FROM SALES JOIN PRODUCT USING (PRODUCT_ID) WHERE PRODUCT_NAME ='S8' AND BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES JOIN PRODUCT USING (PRODUCT_ID) WHERE PRODUCT_NAME = 'iPhone')
327,Y,Y,SELECT DISTINCT(BUYER_ID) FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
328,Y,Y,SELECT DISTINCT(BUYER_ID) FROM SALES WHERE BUYER_ID IN (SELECT S.BUYER_ID FROM SALES AS S JOIN PRODUCT AS P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN (SELECT S.BUYER_ID FROM SALES AS S JOIN PRODUCT AS P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
329,Y,Y,SELECT DISTINCT(BUYER_ID) FROM SALES WHERE PRODUCT_ID IN (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME ='S8') AND BUYER_ID NOT IN( SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone')
330,Y,Y,SELECT DISTINCT(S.BUYER_ID) FROM SALES AS S JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT S.BUYER_ID FROM SALES AS S JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
331,Y,Y,SELECT DISTINCT(S.BUYER_ID) FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN ( SELECT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone' )
332,N,N,"SELECT FINAL.BUYER_ID FROM (SELECT BOTHH.BUYER_ID BUYER_ID , BOTHH.PRODUCT_NAME PRODUCT_NAME FROM (SELECT S.PRODUCT_ID, P.PRODUCT_NAME PRODUCT_NAME , S.BUYER_ID BUYER_ID FROM SALES S, PRODUCT P WHERE S.PRODUCT_ID = P.PRODUCT_ID AND (P.PRODUCT_NAME = 'S8' OR P.PRODUCT_NAME = 'iPhone')) BOTHH GROUP BY BOTHH.BUYER_ID HAVING COUNT(DISTINCT BOTHH.PRODUCT_NAME) = 1) FINAL WHERE FINAL.PRODUCT_NAME = 'S8'"
333,Y,Y,SELECT S.BUYER_ID AS BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM(P.PRODUCT_NAME = 'S8') >0 AND SUM(P.PRODUCT_NAME = 'iPhone') = 0
334,Y,Y,SELECT S.BUYER_ID FROM ( SELECT DISTINCT BUYER_ID FROM SALES WHERE PRODUCT_ID IN (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'S8') ) S LEFT OUTER JOIN ( SELECT DISTINCT BUYER_ID FROM SALES WHERE PRODUCT_ID IN (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'iPhone') ) I ON S.BUYER_ID = I.BUYER_ID WHERE I.BUYER_ID IS NULL
335,Y,Y,SELECT S.BUYER_ID FROM PRODUCT AS P LEFT JOIN SALES AS S USING(PRODUCT_ID) GROUP BY 1 HAVING SUM(CASE WHEN PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) = 0
336,Y,Y,SELECT S.BUYER_ID FROM PRODUCT P INNER JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM(P.PRODUCT_NAME = 'S8') > 0 AND SUM(P.PRODUCT_NAME = 'iPhone') = 0
337,Y,Y,SELECT S.BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID=S.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(P.PRODUCT_NAME='S8') > 0 AND SUM(P.PRODUCT_NAME = 'iPhone') = 0
338,Y,Y,"SELECT S.BUYER_ID FROM SALES AS S JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM(IF(P.PRODUCT_NAME='S8',1,0))>0 AND SUM(IF(P.PRODUCT_NAME='iPhone',1,0))=0"
339,Y,Y,SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM(CASE WHEN P.PRODUCT_NAME= 'S8' THEN 1 ELSE 0 END) >= 1 AND SUM(P.PRODUCT_NAME = 'iPhone') = 0
340,Y,Y,SELECT S.BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(PRODUCT_NAME = 'iPhone') = 0 AND SUM(PRODUCT_NAME = 'S8') > 0
341,Y,Y,SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM(P.PRODUCT_NAME = 'S8') > 0 AND SUM(P.PRODUCT_NAME = 'iPhone') = 0
342,Y,Y,SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P USING(PRODUCT_ID) GROUP BY BUYER_ID HAVING SUM(CASE WHEN P.PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) = 0 AND SUM(CASE WHEN P.PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) > 0
343,Y,Y,SELECT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY S.BUYER_ID HAVING (MAX(CASE WHEN P.PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) + MIN(CASE WHEN P.PRODUCT_NAME = 'iPhone' THEN -1 ELSE 0 END)) = 1
344,Y,Y,SELECT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID GROUP BY BUYER_ID HAVING COUNT(CASE PRODUCT_NAME WHEN 'S8' THEN 1 ELSE NULL END)>=1 AND COUNT(CASE PRODUCT_NAME WHEN 'iPhone' THEN 1 ELSE NULL END) =0
345,Y,Y,SELECT S.BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM(CASE WHEN P.PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN P.PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) = 0
346,Y,Y,SELECT S.BUYER_ID FROM SALES AS S JOIN PRODUCT AS P ON S.PRODUCT_ID=P.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(P.PRODUCT_NAME='S8')>0 AND SUM(P.PRODUCT_NAME='iPhone')=0
347,Y,Y,SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM(CASE WHEN P.PRODUCT_NAME='S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN P.PRODUCT_NAME='iPhone' THEN 1 ELSE 0 END) = 0
348,Y,Y,SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID=S.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM(P.PRODUCT_NAME = 'S8') > 0 AND SUM(P.PRODUCT_NAME = 'iPhone') = 0
349,Y,Y,SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID GROUP BY 1 HAVING SUM(CASE WHEN P.PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN P.PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END)=0
350,Y,Y,SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE P.PRODUCT_NAME='S8' AND S.BUYER_ID NOT IN (SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE P.PRODUCT_NAME='iPhone') GROUP BY S.BUYER_ID
351,N,N,"SELECT T.BUYER_ID FROM( SELECT BUYER_ID,CASE WHEN PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END AS S8_LABEL, CASE WHEN PRODUCT_NAME ='iPhone' THEN 1 ELSE 0 END AS IPHONE_LABEL FROM SALES A LEFT JOIN PRODUCT B ON A.PRODUCT_ID = B.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(S8_LABEL) > 0 AND SUM(IPHONE_LABEL)=0) T"
352,Y,Y,SELECT T1.BUYER_ID FROM SALES T1 INNER JOIN PRODUCT T2 ON T1.PRODUCT_ID = T2.PRODUCT_ID GROUP BY T1.BUYER_ID HAVING( SUM(CASE WHEN T2.PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END )>0 AND SUM(CASE WHEN T2.PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END )=0 )
353,Y,Y,WITH A AS (SELECT DISTINCT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone') SELECT DISTINCT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT * FROM A)
354,Y,Y,"WITH CTE1 AS (SELECT BUYER_ID FROM SALES WHERE PRODUCT_ID = (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'S8')), CTE2 AS (SELECT BUYER_ID FROM SALES WHERE PRODUCT_ID = (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'iPhone')) SELECT DISTINCT BUYER_ID FROM CTE1 WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE2)"
355,Y,Y,"WITH S AS ( SELECT BUYER_ID FROM SALES WHERE PRODUCT_ID IN (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME='S8') ), I AS ( SELECT BUYER_ID FROM SALES WHERE PRODUCT_ID IN (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME='iPhone') ) SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID IN (SELECT BUYER_ID FROM S) AND BUYER_ID NOT IN (SELECT BUYER_ID FROM I)"
356,Y,Y,WITH S8 AS (SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE PRODUCT_NAME='S8') SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE PRODUCT_NAME='S8' AND BUYER_ID NOT IN (SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE PRODUCT_NAME='iPhone')
357,Y,Y,"WITH S8BUYERS AS ( SELECT DISTINCT BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' ), IPHONEBUYERS AS ( SELECT DISTINCT BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone' ) SELECT * FROM S8BUYERS WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM IPHONEBUYERS)"
358,Y,Y,"WITH S8_BUYERS AS ( SELECT BUYER_ID FROM SALES WHERE PRODUCT_ID = (SELECT PRODUCT_ID FROM PRODUCT P WHERE PRODUCT_NAME = 'S8') ), IPHONE_BUYERS AS ( SELECT BUYER_ID FROM SALES WHERE PRODUCT_ID = (SELECT PRODUCT_ID FROM PRODUCT P WHERE PRODUCT_NAME='iPhone') ) SELECT DISTINCT S.BUYER_ID FROM SALES S WHERE S.BUYER_ID IN (SELECT A.BUYER_ID FROM S8_BUYERS A) AND S.BUYER_ID NOT IN (SELECT B.BUYER_ID FROM IPHONE_BUYERS B)"
359,Y,Y,WITH A AS (SELECT * FROM SALES LEFT JOIN PRODUCT USING(PRODUCT_ID)) SELECT DISTINCT BUYER_ID FROM A WHERE PRODUCT_NAME='S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM A WHERE PRODUCT_NAME='iPhone')
360,Y,Y,"WITH BASE AS ( SELECT S.BUYER_ID , CASE WHEN PRODUCT_NAME ='S8' THEN 1 ELSE 0 END AS S8, CASE WHEN PRODUCT_NAME ='iPhone' THEN 1 ELSE 0 END AS IPHONE FROM SALES S INNER JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID ) SELECT BUYER_ID FROM BASE GROUP BY BUYER_ID HAVING SUM(S8) >0 AND SUM(IPHONE)=0"
361,Y,Y,"WITH BOUGHT_S8 AS (SELECT DISTINCT BUYER_ID, PRODUCT_ID FROM SALES WHERE PRODUCT_ID IN (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'S8')) SELECT BUYER_ID FROM BOUGHT_S8 WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES WHERE PRODUCT_ID IN (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME='iPhone'))"
362,Y,Y,"WITH BUYERS AS ( SELECT S.*, P.PRODUCT_NAME FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME IN ('S8','iPhone') ) SELECT DISTINCT BUYER_ID FROM BUYERS WHERE PRODUCT_NAME = 'S8' GROUP BY BUYER_ID HAVING BUYER_ID NOT IN (SELECT BUYER_ID FROM BUYERS GROUP BY BUYER_ID HAVING COUNT(DISTINCT PRODUCT_NAME) = 2)"
363,Y,Y,"WITH C AS( SELECT A.BUYER_ID,PRODUCT_NAME FROM SALES A LEFT JOIN PRODUCT B ON A.PRODUCT_ID=B.PRODUCT_ID ) SELECT DISTINCT BUYER_ID FROM C WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM C WHERE PRODUCT_NAME ='iPhone')"
364,Y,Y,"WITH C1 AS ( SELECT DISTINCT BUYER_ID FROM SALES WHERE PRODUCT_ID=(SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME ='S8') ), C2 AS ( SELECT DISTINCT BUYER_ID FROM SALES WHERE PRODUCT_ID=(SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME ='iPhone') ) SELECT BUYER_ID FROM C1 WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM C2)"
365,Y,Y,"WITH COMPROSAL AS (SELECT BUYER_ID, S.PRODUCT_ID, P.PRODUCT_NAME FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID) SELECT DISTINCT BUYER_ID FROM COMPROSAL WHERE PRODUCT_NAME='S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM COMPROSAL WHERE PRODUCT_NAME='iPhone') ORDER BY BUYER_ID"
366,Y,Y,WITH CTE AS ( SELECT * FROM SALES WHERE BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone' ) ) SELECT DISTINCT BUYER_ID FROM CTE JOIN PRODUCT ON CTE.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE PRODUCT_NAME = 'S8'
367,Y,Y,"WITH CTE AS ( SELECT A.SELLER_ID, A.PRODUCT_ID, B.PRODUCT_NAME, B.UNIT_PRICE, A.BUYER_ID, A.SALE_DATE, A.QUANTITY, A.PRICE FROM SALES A JOIN PRODUCT B ON A.PRODUCT_ID = B.PRODUCT_ID ) SELECT DISTINCT BUYER_ID FROM CTE WHERE BUYER_ID IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'iPhone')"
368,Y,Y,"WITH CTE AS ( SELECT BUYER_ID, PRODUCT_NAME FROM PRODUCT P JOIN SALES S USING(PRODUCT_ID) WHERE PRODUCT_NAME ='S8' OR PRODUCT_NAME='iPhone' ) SELECT DISTINCT BUYER_ID FROM CTE WHERE BUYER_ID NOT IN(SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME='iPhone') AND PRODUCT_NAME='S8'"
369,Y,Y,"WITH CTE AS ( SELECT BUYER_ID, PRODUCT_NAME FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID) SELECT DISTINCT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'iPhone')"
370,Y,Y,"WITH CTE AS ( SELECT DISTINCT BUYER_ID FROM SALES WHERE PRODUCT_ID=( SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME='S8' ) ), DEMO AS ( SELECT DISTINCT BUYER_ID FROM SALES WHERE PRODUCT_ID=( SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME='iPhone' ) ) SELECT CTE.BUYER_ID FROM CTE LEFT JOIN DEMO ON CTE.BUYER_ID=DEMO.BUYER_ID WHERE DEMO.BUYER_ID IS NULL"
371,Y,Y,WITH CTE AS ( SELECT DISTINCT(BUYER_ID) FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone' ) SELECT DISTINCT(BUYER_ID) AS BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE)
372,Y,Y,"WITH CTE AS ( SELECT DISTINCT(BUYER_ID), PRODUCT_NAME FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID ) SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'iPhone')"
373,Y,Y,"WITH CTE AS ( SELECT S.BUYER_ID, PRODUCT_NAME FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID ) SELECT DISTINCT BUYER_ID FROM CTE WHERE PRODUCT_NAME ='S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME='iPhone')"
374,Y,Y,"WITH CTE AS ( SELECT S.SELLER_ID, S.BUYER_ID, P.PRODUCT_NAME, P.PRODUCT_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME IN ('S8','iPhone') ) SELECT DISTINCT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'IPHONE ')"
375,Y,Y,WITH CTE AS (SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone') SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE)
376,Y,Y,"WITH CTE AS (SELECT S.*, P.PRODUCT_NAME FROM SALES AS S JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID) SELECT DISTINCT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'iPhone')"
377,Y,Y,"WITH CTE AS( SELECT BUYER_ID, PRODUCT_NAME FROM SALES S JOIN PRODUCT P USING(PRODUCT_ID) ), CTE2 AS( SELECT BUYER_ID, SUM(CASE WHEN PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) AS S8_FLAG , SUM(CASE WHEN PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) AS IP_FLAG FROM CTE GROUP BY BUYER_ID HAVING S8_FLAG>= 1 AND IP_FLAG = 0) SELECT BUYER_ID FROM CTE2"
378,Y,Y,"WITH CTE AS( SELECT BUYER_ID, SUM(CASE WHEN PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) AS S8 , SUM(CASE WHEN PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) AS IPHONE FROM PRODUCT INNER JOIN SALES ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID GROUP BY BUYER_ID ) SELECT BUYER_ID FROM CTE WHERE S8 > 0 AND IPHONE = 0"
379,Y,Y,"WITH CTE AS( SELECT S.*, CASE WHEN P.PRODUCT_NAME='S8' THEN 0 WHEN P.PRODUCT_NAME='iPhone' THEN 1 ELSE NULL END AS N_ID FROM SALES AS S JOIN PRODUCT AS P ON S.PRODUCT_ID=P.PRODUCT_ID) SELECT DISTINCT BUYER_ID FROM CTE WHERE N_ID IS NOT NULL GROUP BY BUYER_ID HAVING SUM(N_ID)=0"
380,Y,Y,"WITH CTE AS( SELECT S.BUYER_ID, S.PRODUCT_ID, P.PRODUCT_NAME FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID ) SELECT DISTINCT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'iPhone')"
381,Y,Y,"WITH CTE1 AS ( SELECT S.BUYER_ID,P.PRODUCT_NAME FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' ), CTE2 AS ( SELECT S.BUYER_ID AS OTHER ,P.PRODUCT_NAME FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone' ) SELECT BUYER_ID FROM CTE1 C1 LEFT JOIN CTE2 C2 ON C1.BUYER_ID = C2.OTHER WHERE OTHER IS NULL GROUP BY BUYER_ID"
382,Y,Y,"WITH CTE1 AS ( SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8'), CTE2 AS ( SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone' ) SELECT DISTINCT BUYER_ID FROM CTE1 WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE2) ORDER BY BUYER_ID"
383,Y,Y,"WITH CTE1 AS ( SELECT DISTINCT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' ) , CTE2 AS ( SELECT DISTINCT S1.BUYER_ID FROM SALES S1 LEFT JOIN PRODUCT P ON P.PRODUCT_ID = S1.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone' ) SELECT DISTINCT C1.BUYER_ID FROM CTE1 C1 WHERE C1.BUYER_ID NOT IN (SELECT C2.* FROM CTE2 C2)"
384,Y,Y,"WITH CTE1 AS ( SELECT S.BUYER_ID AS BOUGHTS8 FROM SALES S WHERE S.PRODUCT_ID = (SELECT P.PRODUCT_ID FROM PRODUCT P WHERE P.PRODUCT_NAME = 'S8') ), CTE2 AS ( SELECT S.BUYER_ID AS BOUGHTIPHONE FROM SALES S WHERE S.PRODUCT_ID = (SELECT P.PRODUCT_ID FROM PRODUCT P WHERE P.PRODUCT_NAME = 'iPhone') ) SELECT DISTINCT S.BUYER_ID FROM SALES S WHERE S.BUYER_ID IN (SELECT BOUGHTS8 FROM CTE1) AND S.BUYER_ID NOT IN (SELECT BOUGHTIPHONE FROM CTE2)"
385,Y,Y,"WITH DRAFT AS ( SELECT S.BUYER_ID, S.PRODUCT_ID, P.PRODUCT_NAME FROM SALES AS S INNER JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID) SELECT DISTINCT BUYER_ID FROM DRAFT WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM DRAFT WHERE PRODUCT_NAME = 'iPhone')"
386,Y,Y,"WITH IPHONE_BUYER AS ( SELECT DISTINCT A.BUYER_ID FROM SALES AS A LEFT JOIN PRODUCT AS B ON A.PRODUCT_ID=B.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone' ), S8_BUYER AS ( SELECT DISTINCT A.BUYER_ID FROM SALES AS A LEFT JOIN PRODUCT AS B ON A.PRODUCT_ID=B.PRODUCT_ID WHERE PRODUCT_NAME = 'S8') SELECT BUYER_ID FROM S8_BUYER WHERE BUYER_ID NOT IN (SELECT * FROM IPHONE_BUYER)"
387,Y,Y,WITH IPHONEBUYER AS (SELECT DISTINCT BUYER_ID FROM SALES WHERE PRODUCT_ID IN (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'iPhone') ) SELECT DISTINCT BUYER_ID FROM SALES WHERE PRODUCT_ID IN (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN (SELECT BUYER_ID FROM IPHONEBUYER) ORDER BY 1
388,Y,Y,"WITH IPHONEBUYERS AS ( SELECT BUYER_ID FROM SALES A, PRODUCT B WHERE A.PRODUCT_ID = B.PRODUCT_ID AND B.PRODUCT_NAME = 'iPhone' ), S8BUYERS AS ( SELECT BUYER_ID FROM SALES A, PRODUCT B WHERE A.PRODUCT_ID = B.PRODUCT_ID AND B.PRODUCT_NAME = 'S8' ) SELECT DISTINCT A.BUYER_ID FROM SALES A,S8BUYERS I WHERE A.BUYER_ID = I.BUYER_ID AND A.BUYER_ID NOT IN (SELECT BUYER_ID FROM IPHONEBUYERS)"
389,Y,Y,"WITH K AS( SELECT BUYER_ID, PRODUCT_NAME FROM SALES LEFT JOIN PRODUCT ON SALES.PRODUCT_ID=PRODUCT.PRODUCT_ID), A AS( SELECT DISTINCT BUYER_ID FROM K WHERE PRODUCT_NAME='iPhone'), B AS( SELECT DISTINCT BUYER_ID FROM K WHERE PRODUCT_NAME='S8') SELECT * FROM B WHERE BUYER_ID NOT IN (SELECT * FROM A)"
390,Y,Y,"WITH PROD_SALE (BUYER_ID,PRODUCT_NAME ) AS ( SELECT BUYER_ID,PRODUCT_NAME FROM SALES A LEFT JOIN PRODUCT B ON A.PRODUCT_ID=B.PRODUCT_ID ) SELECT BUYER_ID FROM PROD_SALE GROUP BY BUYER_ID HAVING SUM(PRODUCT_NAME='S8')>0 AND SUM(PRODUCT_NAME='iPhone')=0"
391,Y,Y,"WITH PRODSALES AS( SELECT PROD.PRODUCT_ID ,PROD.PRODUCT_NAME ,BUYER_ID FROM PRODUCT PROD JOIN SALES SALES ON PROD.PRODUCT_ID = SALES.PRODUCT_ID ) SELECT DISTINCT BUYER_ID FROM PRODSALES WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN ( SELECT BUYER_ID FROM PRODSALES WHERE PRODUCT_NAME = 'iPhone' )"
392,Y,Y,"WITH REFINED_PRODUCT AS ( SELECT PRODUCT_ID, PRODUCT_NAME, CASE WHEN PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END S8_SALE, CASE WHEN PRODUCT_NAME ='iPhone' THEN 1 ELSE 0 END IPHONE_SALE FROM PRODUCT WHERE PRODUCT_NAME IN ('S8', 'iPhone') ) SELECT BUYER_ID FROM SALES JOIN REFINED_PRODUCT USING (PRODUCT_ID) GROUP BY 1 HAVING SUM(IPHONE_SALE)=0 AND SUM(S8_SALE)>0"
393,Y,Y,"WITH S AS ( SELECT BUYER_ID, SUM(CASE WHEN PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) AS S8_CNT, SUM(CASE WHEN PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) AS IPHONE_CNT FROM SALES INNER JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID GROUP BY 1 ) SELECT BUYER_ID FROM S WHERE S8_CNT > 0 AND IPHONE_CNT = 0"
394,Y,Y,"WITH S8 AS ( SELECT BUYER_ID FROM SALES INNER JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' ), IPHONE AS ( SELECT BUYER_ID FROM SALES INNER JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone' ) SELECT DISTINCT S8.BUYER_ID FROM S8 LEFT JOIN IPHONE ON S8.BUYER_ID = IPHONE.BUYER_ID WHERE IPHONE.BUYER_ID IS NULL"
395,Y,Y,"WITH S8 AS ( SELECT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'S8'), IPHONE AS ( SELECT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone') SELECT DISTINCT BUYER_ID FROM S8 WHERE BUYER_ID NOT IN (SELECT * FROM IPHONE)"
396,Y,Y,"WITH S8 AS ( SELECT DISTINCT(SALES.BUYER_ID) BUYER FROM SALES JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' ), IPHONE AS( SELECT DISTINCT(SALES.BUYER_ID) BUYER FROM SALES JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone' ) SELECT DISTINCT(BUYER_ID) FROM SALES WHERE BUYER_ID IN (SELECT * FROM S8) AND BUYER_ID NOT IN (SELECT * FROM IPHONE)"
397,Y,Y,"WITH S8_ID AS (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'S8'), IPHONE_ID AS (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'iPhone') SELECT BUYER_ID FROM SALES AS S, S8_ID AS S8, IPHONE_ID AS IP GROUP BY BUYER_ID HAVING SUM(IF(S.PRODUCT_ID = S8.PRODUCT_ID, 1, 0)) > 0 AND SUM(IF(S.PRODUCT_ID = IP.PRODUCT_ID, 1, 0)) = 0"
398,Y,Y,"WITH SA AS (SELECT DISTINCT S.BUYER_ID, P.PRODUCT_NAME FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME IN ('S8', 'iPhone')) SELECT BUYER_ID FROM SA WHERE BUYER_ID NOT IN (SELECT DISTINCT BUYER_ID FROM SA WHERE PRODUCT_NAME = 'iPhone')"
399,Y,Y,"WITH SALES_LIST AS ( SELECT S.PRODUCT_ID,S.BUYER_ID,P.PRODUCT_NAME FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID) SELECT DISTINCT BUYER_ID FROM SALES_LIST WHERE BUYER_ID IN (SELECT BUYER_ID FROM SALES_LIST WHERE PRODUCT_NAME='S8' ) AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES_LIST WHERE PRODUCT_NAME='iPhone')"
400,Y,Y,"WITH SALES_WITH_PRODUCT AS (SELECT A.BUYER_ID, A.PRODUCT_ID, B.PRODUCT_NAME FROM SALES A JOIN PRODUCT B ON A.PRODUCT_ID = B.PRODUCT_ID) SELECT BUYER_ID FROM SALES WHERE BUYER_ID IN (SELECT BUYER_ID FROM SALES_WITH_PRODUCT WHERE PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES_WITH_PRODUCT WHERE PRODUCT_NAME = 'iPhone') GROUP BY BUYER_ID"
401,Y,Y,"WITH SALES_WITH_PRODUCT_NAME AS( SELECT S.BUYER_ID,S.PRODUCT_ID,P.PRODUCT_NAME FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID) SELECT DISTINCT(BUYER_ID) FROM SALES_WITH_PRODUCT_NAME WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES_WITH_PRODUCT_NAME WHERE PRODUCT_NAME='iPhone') AND BUYER_ID IN (SELECT BUYER_ID FROM SALES_WITH_PRODUCT_NAME WHERE PRODUCT_NAME='S8')"
402,Y,Y,"WITH T AS ( SELECT BUYER_ID, CASE WHEN PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END AS S8_FLAG, CASE WHEN PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END AS IPHONE_FLAG FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID ) SELECT BUYER_ID FROM T GROUP BY BUYER_ID HAVING SUM(S8_FLAG) > 0 AND SUM(IPHONE_FLAG) =0"
403,Y,Y,"WITH T AS ( SELECT S.BUYER_ID,P.PRODUCT_NAME FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID ) SELECT BUYER_ID FROM T GROUP BY BUYER_ID HAVING BUYER_ID IN (SELECT BUYER_ID FROM T WHERE PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN (SELECT BUYER_ID FROM T WHERE PRODUCT_NAME = 'iPhone')"
404,Y,Y,"WITH T AS (SELECT S.*, P.PRODUCT_NAME FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID) SELECT DISTINCT BUYER_ID FROM T WHERE PRODUCT_NAME ='S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM T WHERE PRODUCT_NAME='iPhone')"
405,Y,Y,"WITH T1 AS ( SELECT BUYER_ID FROM SALES AS S LEFT JOIN PRODUCT AS P USING(PRODUCT_ID) WHERE PRODUCT_NAME = 'S8' ), T2 AS ( SELECT BUYER_ID FROM SALES AS S LEFT JOIN PRODUCT AS P USING(PRODUCT_ID) WHERE PRODUCT_NAME = 'iPhone' ) SELECT DISTINCT BUYER_ID FROM T1 WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM T2)"
406,Y,Y,"WITH TB AS ( SELECT S.*, P.PRODUCT_NAME FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID) SELECT DISTINCT BUYER_ID FROM TB WHERE TB.PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN ( SELECT BUYER_ID FROM TB WHERE TB.PRODUCT_NAME = 'iPhone' )"
407,Y,Y,"WITH TCTE AS ( SELECT P.PRODUCT_NAME, S.BUYER_ID FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME IN ('S8','iPhone') ) SELECT DISTINCT BUYER_ID FROM TCTE WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM TCTE WHERE PRODUCT_NAME = 'iPhone')"
408,Y,Y,WITH TEMP AS ( SELECT * FROM PRODUCT NATURAL JOIN SALES) SELECT DISTINCT BUYER_ID FROM TEMP WHERE PRODUCT_NAME='S8' AND BUYER_ID NOT IN( SELECT DISTINCT BUYER_ID FROM TEMP WHERE PRODUCT_NAME='iPhone')
409,Y,Y,WITH TEMP AS ( SELECT * FROM PRODUCT JOIN SALES USING (PRODUCT_ID) ) SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID IN (SELECT BUYER_ID FROM TEMP WHERE PRODUCT_NAME='S8') AND BUYER_ID NOT IN (SELECT BUYER_ID FROM TEMP WHERE PRODUCT_NAME='iPhone')
410,Y,Y,"WITH TEMP AS ( SELECT DISTINCT S.BUYER_ID, S.PRODUCT_ID, P.PRODUCT_NAME FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID) SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID IN (SELECT DISTINCT BUYER_ID FROM TEMP WHERE PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN (SELECT DISTINCT BUYER_ID FROM TEMP WHERE PRODUCT_NAME = 'iPhone' )"
411,Y,Y,"WITH TEMP AS ( SELECT S.PRODUCT_ID, S.BUYER_ID, P.PRODUCT_NAME FROM SALES S, PRODUCT P WHERE S.PRODUCT_ID = P.PRODUCT_ID ) SELECT DISTINCT BUYER_ID FROM TEMP WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM TEMP WHERE PRODUCT_NAME = 'iPhone') ORDER BY BUYER_ID"
412,Y,Y,WITH TEMP AS (SELECT * FROM SALES LEFT JOIN PRODUCT USING (PRODUCT_ID)) SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM TEMP WHERE PRODUCT_NAME='iPhone') AND BUYER_ID IN (SELECT BUYER_ID FROM TEMP WHERE PRODUCT_NAME='S8')
413,Y,Y,WITH TEMP AS (SELECT * FROM SALES LEFT JOIN PRODUCT USING (PRODUCT_ID)) SELECT DISTINCT BUYER_ID FROM TEMP WHERE BUYER_ID NOT IN (SELECT A.BUYER_ID FROM TEMP AS A JOIN TEMP AS B ON A.BUYER_ID=B.BUYER_ID WHERE A.PRODUCT_NAME='S8' AND B.PRODUCT_NAME='iPhone') AND PRODUCT_NAME='S8'
414,Y,Y,"WITH TEMP AS (SELECT S.*, PRODUCT_NAME FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID) SELECT DISTINCT BUYER_ID FROM TEMP WHERE BUYER_ID IN (SELECT BUYER_ID FROM TEMP WHERE PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN (SELECT BUYER_ID FROM TEMP WHERE PRODUCT_NAME = 'iPhone')"
415,Y,Y,"WITH TEMP AS (SELECT DISTINCT BUYER_ID, PRODUCT_NAME FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID) SELECT BUYER_ID FROM TEMP WHERE PRODUCT_NAME LIKE S8 AND BUYER_ID NOT IN (SELECT BUYER_ID FROM TEMP WHERE PRODUCT_NAME LIKE IPHONE )"
416,Y,Y,"WITH TEMP AS( SELECT P.PRODUCT_ID, P.PRODUCT_NAME,S.BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID) SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID IN(SELECT BUYER_ID FROM TEMP WHERE PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN (SELECT BUYER_ID FROM TEMP WHERE PRODUCT_NAME = 'iPhone')"
417,Y,Y,"WITH XTABLE AS (SELECT BUYER_ID, SALES.PRODUCT_ID, PRODUCT_NAME FROM SALES LEFT JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID), YTABLE AS (SELECT DISTINCT BUYER_ID , PRODUCT_NAME FROM XTABLE) SELECT DISTINCT BUYER_ID FROM XTABLE WHERE PRODUCT_NAME ='S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM YTABLE WHERE PRODUCT_NAME IN ('iPhone'))"
418,Y,Y,SELECT BUYER_ID FROM SALES LEFT JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(PRODUCT_NAME = 'S8') > 0 AND SUM(PRODUCT_NAME = 'iPhone') = 0
419,Y,Y,WITH X AS (SELECT * FROM SALES LEFT JOIN PRODUCT USING(PRODUCT_ID)) SELECT DISTINCT BUYER_ID FROM X WHERE PRODUCT_NAME IN ('S8') AND BUYER_ID NOT IN( SELECT BUYER_ID FROM X WHERE PRODUCT_NAME IN ('iPhone'))
420,Y,Y,SELECT BUYER_ID FROM SALES JOIN PRODUCT P USING(PRODUCT_ID) GROUP BY BUYER_ID HAVING SUM(P.PRODUCT_NAME = 'S8') >=1 AND SUM(P.PRODUCT_NAME = 'iPhone') = 0
421,Y,Y,WITH CTE AS (SELECT * FROM SALES S JOIN PRODUCT P USING(PRODUCT_ID)) SELECT DISTINCT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'iPhone')
422,Y,Y,SELECT DISTINCT(S.BUYER_ID) FROM SALES S LEFT JOIN PRODUCT P USING (PRODUCT_ID) WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P USING (PRODUCT_ID) WHERE P.PRODUCT_NAME = 'iPhone')
423,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES LEFT JOIN PRODUCT USING(PRODUCT_ID) GROUP BY BUYER_ID HAVING SUM(CASE WHEN PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END ) >0 AND SUM(CASE WHEN PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) =0
424,Y,Y,"WITH IPHONE AS( SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone') , S8 AS( SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'S8') SELECT DISTINCT BUYER_ID FROM S8 WHERE BUYER_ID NOT IN(SELECT BUYER_ID FROM IPHONE)"
425,Y,Y,SELECT S.BUYER_ID FROM PRODUCT P JOIN SALES S USING(PRODUCT_ID) GROUP BY S.BUYER_ID HAVING SUM(PRODUCT_NAME='S8')>0 AND SUM(PRODUCT_NAME='iPhone')=0
426,Y,Y,"WITH T AS (SELECT S.PRODUCT_ID, S.BUYER_ID, P.PRODUCT_NAME FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID) SELECT DISTINCT BUYER_ID FROM T WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM T WHERE PRODUCT_NAME = 'iPhone') AND PRODUCT_NAME = 'S8'"
427,Y,Y,SELECT DISTINCT SALES.BUYER_ID FROM SALES JOIN PRODUCT WHERE SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID AND PRODUCT.PRODUCT_NAME = 'S8' AND SALES.BUYER_ID NOT IN ( SELECT SALES.BUYER_ID FROM SALES JOIN PRODUCT WHERE SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID AND PRODUCT.PRODUCT_NAME = 'iPhone' )
428,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P USING (PRODUCT_ID) WHERE PRODUCT_NAME ='S8' AND BUYER_ID NOT IN (SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P USING (PRODUCT_ID) WHERE PRODUCT_NAME ='iPhone')
429,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone' )
430,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN( SELECT DISTINCT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
431,Y,Y,SELECT DISTINCT SALES.BUYER_ID FROM SALES JOIN PRODUCT WHERE SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID AND PRODUCT.PRODUCT_NAME = 'S8' AND SALES.BUYER_ID NOT IN ( SELECT SALES.BUYER_ID FROM SALES JOIN PRODUCT ON PRODUCT.PRODUCT_ID = SALES.PRODUCT_ID WHERE PRODUCT.PRODUCT_NAME = 'iPhone' )
432,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P USING (PRODUCT_ID) WHERE PRODUCT_NAME = 'iPhone' ) AND BUYER_ID IN ( SELECT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P USING (PRODUCT_ID) WHERE PRODUCT_NAME = 'S8' )
433,Y,Y,"WITH A AS (SELECT BUYER_ID FROM PRODUCT JOIN SALES USING(PRODUCT_ID) WHERE PRODUCT_NAME = 'S8'), B AS ( SELECT BUYER_ID FROM PRODUCT JOIN SALES USING(PRODUCT_ID) WHERE PRODUCT_NAME = 'iPhone') SELECT DISTINCT BUYER_ID FROM A WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM B)"
434,Y,Y,WITH T1 AS( SELECT BUYER_ID FROM SALES LEFT JOIN PRODUCT ON SALES.PRODUCT_ID=PRODUCT.PRODUCT_ID WHERE PRODUCT.PRODUCT_NAME LIKE IPHONE ) SELECT DISTINCT A.BUYER_ID FROM SALES A LEFT JOIN PRODUCT B ON A.PRODUCT_ID=B.PRODUCT_ID WHERE B.PRODUCT_NAME LIKE S8 AND A.BUYER_ID NOT IN (SELECT * FROM T1)
435,N,N,"SELECT DISTINCT A.BUYER_ID FROM ( SELECT S.BUYER_ID, CASE WHEN P.PRODUCT_NAME='S8' THEN 1 ELSE 0 END AS S8FLG, CASE WHEN P.PRODUCT_NAME='iPhone' THEN 1 ELSE 0 END AS IPHONEFLG FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(S8FLG)>=1 AND SUM(IPHONEFLG)<=0 ) A"
436,Y,Y,WITH IP AS (SELECT BUYER_ID FROM PRODUCT P JOIN SALES S ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone' ) SELECT S.BUYER_ID FROM PRODUCT P JOIN SALES S ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT * FROM IP) GROUP BY 1
437,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P USING(PRODUCT_ID) WHERE PRODUCT_NAME='S8' AND BUYER_ID NOT IN (SELECT S1.BUYER_ID FROM SALES S1 LEFT JOIN PRODUCT P1 USING(PRODUCT_ID) WHERE PRODUCT_NAME='iPhone' )
438,Y,Y,"WITH CTE AS ( SELECT BUYER_ID FROM SALES A, PRODUCT B WHERE A.PRODUCT_ID=B.PRODUCT_ID AND PRODUCT_NAME='iPhone') SELECT DISTINCT BUYER_ID FROM SALES A, PRODUCT B WHERE A.PRODUCT_ID=B.PRODUCT_ID AND PRODUCT_NAME='S8' AND BUYER_ID NOT IN (SELECT * FROM CTE)"
439,Y,Y,"WITH TB1 AS ( SELECT S.BUYER_ID, P.PRODUCT_NAME FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID ) SELECT DISTINCT BUYER_ID FROM TB1 WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN ( SELECT BUYER_ID FROM TB1 WHERE PRODUCT_NAME = 'iPhone')"
440,Y,Y,"WITH S8_BUYERS AS ( SELECT DISTINCT BUYER_ID FROM SALES LEFT JOIN PRODUCT USING(PRODUCT_ID) WHERE PRODUCT_NAME = 'S8' ), IPHONE_BUYERS AS ( SELECT DISTINCT BUYER_ID FROM SALES LEFT JOIN PRODUCT USING(PRODUCT_ID) WHERE PRODUCT_NAME = 'iPhone' ) SELECT BUYER_ID FROM S8_BUYERS WHERE BUYER_ID NOT IN (SELECT * FROM IPHONE_BUYERS)"
441,N,N,"SELECT BUYER_ID FROM ( SELECT S.BUYER_ID, P.PRODUCT_NAME, SUM(CASE WHEN PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) CNT_S8, SUM(CASE WHEN PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) CNT_IPHONE FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' OR PRODUCT_NAME = 'iPhone' GROUP BY BUYER_ID ) T WHERE CNT_S8 > 0 AND CNT_IPHONE = 0"
442,Y,Y,SELECT DISTINCT(A.BUYER_ID) AS BUYER_ID FROM SALES A LEFT JOIN PRODUCT B ON A.PRODUCT_ID = B.PRODUCT_ID WHERE B.PRODUCT_NAME = 'S8' AND A.BUYER_ID NOT IN( SELECT DISTINCT(A.BUYER_ID) AS BUYER_ID FROM SALES A LEFT JOIN PRODUCT B ON A.PRODUCT_ID = B.PRODUCT_ID WHERE B.PRODUCT_NAME = 'iPhone')
443,Y,Y,SELECT DISTINCT A.BUYER_ID FROM SALES A LEFT JOIN PRODUCT B ON A.PRODUCT_ID = B.PRODUCT_ID WHERE B.PRODUCT_NAME = 'S8' AND A.BUYER_ID NOT IN (SELECT A.BUYER_ID FROM SALES A LEFT JOIN PRODUCT B ON A.PRODUCT_ID = B.PRODUCT_ID WHERE B.PRODUCT_NAME = 'iPhone')
444,Y,Y,"WITH TEMP AS ( SELECT S.BUYER_ID, SUM(CASE WHEN P.PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) AS S8_FLAG, SUM(CASE WHEN P.PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) AS IPHONE_FLAG FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID GROUP BY S.BUYER_ID ) SELECT DISTINCT BUYER_ID FROM TEMP WHERE S8_FLAG > 0 AND IPHONE_FLAG = 0"
445,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' GROUP BY S.BUYER_ID HAVING S.BUYER_ID NOT IN (SELECT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
446,Y,Y,SELECT SALES.BUYER_ID FROM SALES JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID GROUP BY SALES.BUYER_ID HAVING SUM(PRODUCT.PRODUCT_NAME = 'S8') > 0 AND SUM(PRODUCT.PRODUCT_NAME = 'iPhone') = 0
447,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID IN (SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE S.PRODUCT_ID = (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME LIKE S8 )) AND BUYER_ID NOT IN (SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE S.PRODUCT_ID = (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME LIKE IPHONE ))
448,Y,Y,WITH CTE AS ( SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone' GROUP BY BUYER_ID ) SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN ( SELECT * FROM CTE ) GROUP BY BUYER_ID
449,Y,Y,"SELECT BUYER_ID FROM ( SELECT BUYER_ID , GROUP_CONCAT(PRODUCT_NAME) AS PRODUCTS FROM SALES AS S JOIN PRODUCT AS P USING (PRODUCT_ID) GROUP BY 1) AS N WHERE LOWER(PRODUCTS) LIKE '%S8%' AND LOWER(PRODUCTS) NOT LIKE '%IPHONE%'"
450,Y,Y,SELECT DISTINCT C.BUYER_ID FROM SALES C JOIN PRODUCT D ON C.PRODUCT_ID = D.PRODUCT_ID WHERE BUYER_ID IN (SELECT B.BUYER_ID FROM SALES B JOIN PRODUCT A ON B.PRODUCT_ID = A.PRODUCT_ID WHERE A.PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN (SELECT F.BUYER_ID FROM SALES F JOIN PRODUCT E ON F.PRODUCT_ID = E.PRODUCT_ID WHERE E.PRODUCT_NAME = 'iPhone')
451,Y,Y,SELECT DISTINCT A.BUYER_ID FROM SALES A JOIN PRODUCT B ON A.PRODUCT_ID=B.PRODUCT_ID WHERE B.PRODUCT_NAME LIKE S8 AND A.BUYER_ID NOT IN (SELECT A.BUYER_ID FROM SALES A JOIN PRODUCT B ON A.PRODUCT_ID=B.PRODUCT_ID WHERE B.PRODUCT_NAME LIKE '%IPHONE%')
452,Y,Y,SELECT DISTINCT(BUYER_ID) FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE P.PRODUCT_NAME= 'S8' AND BUYER_ID NOT IN (SELECT DISTINCT(BUYER_ID) FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE P.PRODUCT_NAME= 'iPhone')
453,Y,Y,SELECT DISTINCT A.BUYER_ID FROM SALES A JOIN PRODUCT B ON A.PRODUCT_ID = B.PRODUCT_ID WHERE B.PRODUCT_NAME ='S8' AND A.BUYER_ID NOT IN ( SELECT DISTINCT A.BUYER_ID FROM SALES A JOIN PRODUCT B ON A.PRODUCT_ID = B.PRODUCT_ID WHERE B.PRODUCT_NAME ='iPhone')
454,Y,Y,"SELECT DISTINCT S.BUYER_ID FROM SALES S, PRODUCT P WHERE S.PRODUCT_ID = P.PRODUCT_ID AND P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES S1, PRODUCT P1 WHERE P1.PRODUCT_NAME = 'iPhone' AND S1.PRODUCT_ID = P1.PRODUCT_ID )"
455,Y,Y,SELECT DISTINCT BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT S1.BUYER_ID FROM PRODUCT P1 JOIN SALES S1 ON P1.PRODUCT_ID = S1.PRODUCT_ID WHERE P1.PRODUCT_NAME = 'iPhone' )
456,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN ( SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone' )
457,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES AS S INNER JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM(P.PRODUCT_NAME = 'S8') > 0 AND SUM(P.PRODUCT_NAME = 'iPhone') = 0
458,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES LEFT JOIN PRODUCT ON SALES.PRODUCT_ID=PRODUCT.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN ( SELECT DISTINCT BUYER_ID FROM SALES JOIN PRODUCT USING(PRODUCT_ID) WHERE PRODUCT_NAME = 'iPhone' )
459,Y,Y,"WITH COM_TABLE AS ( SELECT P.PRODUCT_NAME, S.BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID ) SELECT DISTINCT(BUYER_ID) FROM COM_TABLE WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN ( SELECT BUYER_ID FROM COM_TABLE WHERE PRODUCT_NAME = 'iPhone')"
460,Y,Y,"WITH X AS ( SELECT S.BUYER_ID, SUM(CASE WHEN P.PRODUCT_NAME='S8' THEN 1 ELSE 0 END) AS S8_FLG, SUM(CASE WHEN P.PRODUCT_NAME='iPhone' THEN 1 ELSE 0 END) AS IPHN_FLG FROM SALES AS S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID GROUP BY 1) SELECT BUYER_ID FROM X WHERE S8_FLG>=1 AND IPHN_FLG=0"
461,Y,Y,SELECT DISTINCT SALES.BUYER_ID FROM SALES JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE PRODUCT.PRODUCT_NAME = 'S8' AND SALES.BUYER_ID NOT IN ( SELECT DISTINCT SALES.BUYER_ID FROM SALES JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE PRODUCT.PRODUCT_NAME = 'iPhone' )
462,Y,N,"WITH CTE_B AS ( SELECT S.BUYER_ID,P.PRODUCT_ID,P.PRODUCT_NAME FROM PRODUCT P LEFT JOIN SALES S ON S.PRODUCT_ID=P.PRODUCT_ID ) SELECT DISTINCT BUYER_ID FROM CTE_B WHERE PRODUCT_NAME='S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE_B WHERE PRODUCT_NAME='iPhone')"
463,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone') AND P.PRODUCT_NAME = 'S8'
464,Y,Y,SELECT DISTINCT A.BUYER_ID FROM SALES AS A LEFT JOIN PRODUCT AS C ON A.PRODUCT_ID = C.PRODUCT_ID WHERE C.PRODUCT_NAME = 'S8' AND A.BUYER_ID NOT IN (SELECT B.BUYER_ID FROM SALES AS B LEFT JOIN PRODUCT AS D ON B.PRODUCT_ID = D.PRODUCT_ID WHERE D.PRODUCT_NAME = 'iPhone')
465,Y,Y,"WITH PREPROCESS AS ( SELECT S.BUYER_ID, MAX(CASE WHEN P.PRODUCT_NAME = 'S8 THEN YES ELSE NO' END) AS BOUGHT_S8, MAX(CASE WHEN P.PRODUCT_NAME = 'IPHONE THEN YES ELSE NO' END) AS BOUGHT_IPHONE FROM PRODUCT P INNER JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID GROUP BY S.BUYER_ID ) SELECT BUYER_ID FROM PREPROCESS WHERE BOUGHT_S8 = 'YES' AND BOUGHT_IPHONE != 'YES'"
466,Y,Y,SELECT DISTINCT SALES.BUYER_ID FROM SALES JOIN PRODUCT ON SALES.PRODUCT_ID=PRODUCT.PRODUCT_ID WHERE PRODUCT.PRODUCT_NAME='S8' AND BUYER_ID NOT IN ( SELECT SALES.BUYER_ID FROM SALES JOIN PRODUCT ON SALES.PRODUCT_ID=PRODUCT.PRODUCT_ID WHERE PRODUCT.PRODUCT_NAME='iPhone')
467,Y,Y,SELECT DISTINCT SALES.BUYER_ID FROM SALES JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID AND PRODUCT.PRODUCT_NAME = 'S8' AND SALES.BUYER_ID NOT IN ( SELECT SALES.BUYER_ID FROM SALES JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID AND PRODUCT.PRODUCT_NAME = 'iPhone' )
468,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(PRODUCT_NAME = 'S8') > 0 AND SUM(PRODUCT_NAME = 'iPhone') = 0
469,Y,Y,WITH COMBINE_T AS (SELECT * FROM SALES JOIN PRODUCT USING(PRODUCT_ID)) SELECT DISTINCT BUYER_ID FROM COMBINE_T WHERE PRODUCT_NAME='S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM COMBINE_T WHERE PRODUCT_NAME = 'iPhone')
470,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT S.BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME= 'iPhone')
471,Y,Y,"WITH T1 AS (SELECT BUYER_ID FROM SALES JOIN PRODUCT USING (PRODUCT_ID) WHERE PRODUCT_NAME='S8') ,T2 AS (SELECT BUYER_ID FROM SALES JOIN PRODUCT USING(PRODUCT_ID) WHERE PRODUCT_NAME='iPhone') SELECT DISTINCT(BUYER_ID) FROM T1 WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM T2)"
472,Y,Y,SELECT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM(CASE WHEN P.PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN P.PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) =0
473,Y,Y,SELECT DISTINCT BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone' ) AND PRODUCT_NAME LIKE S8
474,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES INNER JOIN PRODUCT WHERE SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID AND PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN ( SELECT DISTINCT(BUYER_ID) FROM SALES INNER JOIN PRODUCT WHERE SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID AND PRODUCT_NAME = 'iPhone' )
475,Y,Y,"SELECT RAW.BUYER_ID FROM (SELECT GROUP_CONCAT(DISTINCT P.PRODUCT_NAME) AS NAME, S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY S.BUYER_ID) RAW WHERE RAW.NAME NOT LIKE '%IPHONE%' AND RAW.NAME LIKE '%S8%'"
476,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE S.BUYER_ID NOT IN( SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE P.PRODUCT_NAME='iPhone') AND P.PRODUCT_NAME='S8'
477,Y,Y,SELECT BUYER_ID FROM SALES WHERE BUYER_ID IN ( SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' GROUP BY BUYER_ID) AND BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone' GROUP BY BUYER_ID) GROUP BY BUYER_ID
478,Y,Y,"WITH IPHONE AS ( SELECT DISTINCT S.BUYER_ID FROM SALES S JOIN PRODUCT P USING(PRODUCT_ID) WHERE PRODUCT_NAME = 'iPhone' ), S8 AS ( SELECT DISTINCT S.BUYER_ID FROM SALES S JOIN PRODUCT P USING(PRODUCT_ID) WHERE PRODUCT_NAME = 'S8' ) SELECT DISTINCT S.BUYER_ID FROM SALES S JOIN S8 SO USING(BUYER_ID) LEFT JOIN IPHONE I ON S.BUYER_ID = I.BUYER_ID WHERE I.BUYER_ID IS NULL"
479,Y,Y,SELECT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM(CASE WHEN P.PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) = 0 AND SUM(CASE WHEN P.PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) > 0
480,Y,Y,"SELECT S.BUYER_ID FROM SALES S, PRODUCT P WHERE S.PRODUCT_ID = P.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM(P.PRODUCT_NAME = 'S8') > 0 AND SUM(P.PRODUCT_NAME = 'iPhone') = 0"
481,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES LEFT JOIN PRODUCT ON PRODUCT.PRODUCT_ID = SALES.PRODUCT_ID WHERE BUYER_ID IN ( SELECT BUYER_ID FROM SALES LEFT JOIN PRODUCT ON PRODUCT.PRODUCT_ID = SALES.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' ) AND BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES LEFT JOIN PRODUCT ON PRODUCT.PRODUCT_ID = SALES.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone' )
482,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' HAVING BUYER_ID NOT IN ( SELECT DISTINCT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone')
483,Y,Y,"WITH IPHONE_BUYER AS( SELECT DISTINCT A.BUYER_ID FROM SALES A JOIN PRODUCT B ON A.PRODUCT_ID = B.PRODUCT_ID WHERE B.PRODUCT_NAME = 'iPhone'), S8_BUYER AS( SELECT DISTINCT A.BUYER_ID FROM SALES A JOIN PRODUCT B ON A.PRODUCT_ID = B.PRODUCT_ID WHERE B.PRODUCT_NAME = 'S8' ) SELECT BUYER_ID FROM S8_BUYER WHERE BUYER_ID NOT IN (SELECT * FROM IPHONE_BUYER)"
484,Y,Y,SELECT DISTINCT S.BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT BUYER_ID FROM PRODUCT P JOIN SALES S2 ON P.PRODUCT_ID = S2.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone' )
485,Y,Y,"WITH CTE AS (SELECT BUYER_ID, CASE WHEN PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END AS SS, CASE WHEN PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END AS IPHONE FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID ) SELECT BUYER_ID FROM CTE GROUP BY BUYER_ID HAVING SUM(SS)>=1 AND SUM(IPHONE) =0"
486,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES JOIN PRODUCT USING(PRODUCT_ID) WHERE BUYER_ID NOT IN( SELECT BUYER_ID FROM SALES JOIN PRODUCT USING(PRODUCT_ID) WHERE PRODUCT_NAME = 'iPhone') AND PRODUCT_NAME = 'S8' ORDER BY 1
487,Y,Y,WITH CTE_S8 AS( SELECT * FROM SALES WHERE PRODUCT_ID = (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME='S8') ) SELECT DISTINCT BUYER_ID FROM CTE_S8 WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES WHERE PRODUCT_ID = (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME='iPhone'))
488,Y,Y,SELECT BUYER_ID FROM SALES AS S JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(PRODUCT_NAME = 'S8') > 0 AND SUM(PRODUCT_NAME = 'iPhone') = 0
489,Y,Y,SELECT DISTINCT A.BUYER_ID FROM SALES A JOIN PRODUCT B USING (PRODUCT_ID) WHERE B.PRODUCT_NAME IN ('S8') AND BUYER_ID NOT IN (SELECT DISTINCT BUYER_ID FROM SALES A JOIN PRODUCT B USING (PRODUCT_ID) WHERE B.PRODUCT_NAME IN ('iPhone') )
490,Y,Y,"WITH T1 AS ( SELECT S.BUYER_ID, S.PRODUCT_ID, P.PRODUCT_NAME FROM SALES AS S JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID ) SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID IN (SELECT BUYER_ID FROM T1 WHERE PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN (SELECT BUYER_ID FROM T1 WHERE PRODUCT_NAME = 'iPhone')"
491,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
492,Y,Y,SELECT DISTINCT(BUYER_ID) FROM SALES LEFT JOIN PRODUCT ON PRODUCT.PRODUCT_ID = SALES.PRODUCT_ID WHERE PRODUCT_NAME='S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES LEFT JOIN PRODUCT ON PRODUCT.PRODUCT_ID = SALES.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone')
493,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE S.PRODUCT_ID NOT IN (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME != 'iPhone')) AND PRODUCT_ID IN (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'S8')
494,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone' ) AND PRODUCT_NAME = 'S8'
495,Y,Y,"WITH T AS ( SELECT S.BUYER_ID,P.PRODUCT_NAME FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' OR P.PRODUCT_NAME='iPhone' ) SELECT DISTINCT(BUYER_ID) FROM T WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM T WHERE PRODUCT_NAME='iPhone')"
496,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone') AND P.PRODUCT_NAME = 'S8'
497,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT DISTINCT BUYER_ID FROM SALES LEFT JOIN PRODUCT USING (PRODUCT_ID) WHERE PRODUCT_NAME='iPhone')
498,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES SLS JOIN PRODUCT PRD ON SLS.PRODUCT_ID = PRD.PRODUCT_ID GROUP BY 1 HAVING SUM(PRODUCT_NAME = 'S8') >= 1 AND SUM(PRODUCT_NAME = 'iPhone') = 0
499,Y,Y,SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM(CASE WHEN PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) = 0
500,Y,Y,SELECT BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(CASE WHEN PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) =0
501,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_ID IN (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'S8') AND S.BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES WHERE PRODUCT_ID IN (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'iPhone'))
502,Y,Y,"WITH FINAL AS ( SELECT P.PRODUCT_ID,P.PRODUCT_NAME,S.BUYER_ID FROM PRODUCT P INNER JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID ) SELECT DISTINCT BUYER_ID FROM FINAL WHERE PRODUCT_NAME ='S8' AND BUYER_ID NOT IN ( SELECT BUYER_ID FROM FINAL WHERE PRODUCT_NAME ='iPhone' )"
503,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES AS S INNER JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN( SELECT DISTINCT BUYER_ID FROM SALES AS S INNER JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone')
504,Y,Y,"WITH CTE AS ( SELECT A.*,B.PRODUCT_NAME FROM SALES A LEFT JOIN PRODUCT B ON A.PRODUCT_ID = B.PRODUCT_ID) SELECT DISTINCT BUYER_ID FROM CTE WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME ='iPhone') AND BUYER_ID IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME ='S8')"
505,Y,Y,SELECT DISTINCT S.BUYER_ID BUYER_ID FROM SALES S JOIN PRODUCT P WHERE S.PRODUCT_ID=P.PRODUCT_ID AND PRODUCT_NAME ='S8' AND BUYER_ID NOT IN (SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P WHERE S.PRODUCT_ID=P.PRODUCT_ID AND PRODUCT_NAME ='iPhone' )
506,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES LEFT JOIN PRODUCT ON PRODUCT.PRODUCT_ID=SALES.PRODUCT_ID WHERE PRODUCT_NAME='S8' AND BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES LEFT JOIN PRODUCT ON PRODUCT.PRODUCT_ID=SALES.PRODUCT_ID WHERE PRODUCT_NAME='iPhone' )
507,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN ( SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone' )
508,Y,Y,SELECT A.BUYER_ID FROM SALES A INNER JOIN PRODUCT B ON A.PRODUCT_ID = B.PRODUCT_ID GROUP BY A.BUYER_ID HAVING SUM(B.PRODUCT_NAME = 'S8') > 0 AND SUM(B.PRODUCT_NAME = 'iPhone') = 0
509,Y,Y,"WITH CTE AS ( SELECT BUYER_ID, PRODUCT_NAME FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID ) SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME='iPhone') AND BUYER_ID IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME='S8')"
510,Y,Y,SELECT DISTINCT(BUYER_ID) FROM SALES WHERE BUYER_ID IN ( SELECT BUYER_ID FROM SALES JOIN PRODUCT USING(PRODUCT_ID) WHERE PRODUCT_NAME = 'S8' ) AND BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES JOIN PRODUCT USING(PRODUCT_ID) WHERE PRODUCT_NAME = 'iPhone')
511,Y,Y,WITH S8 AS (SELECT BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE PRODUCT_NAME = 'S8') SELECT DISTINCT BUYER_ID FROM S8 WHERE S8.BUYER_ID NOT IN(SELECT BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone')
512,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID=S.PRODUCT_ID WHERE P.PRODUCT_NAME='S8' AND S.BUYER_ID NOT IN ( SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID=S.PRODUCT_ID WHERE P.PRODUCT_NAME='iPhone')
513,Y,Y,"WITH T AS (SELECT B.BUYER_ID,A.PRODUCT_NAME, DENSE_RANK() OVER(PARTITION BY B.BUYER_ID ORDER BY A.PRODUCT_NAME ) AS BUY_RANK FROM PRODUCT A LEFT JOIN SALES B ON A.PRODUCT_ID = B.PRODUCT_ID WHERE A.PRODUCT_NAME IN ('S8','iPhone')) SELECT DISTINCT BUYER_ID FROM T WHERE BUY_RANK = 1 AND PRODUCT_NAME = 'S8'"
514,Y,Y,"WITH TEMP AS ( SELECT BUYER_ID, PRODUCT_NAME FROM SALES S LEFT JOIN PRODUCT P USING(PRODUCT_ID ) ) SELECT DISTINCT BUYER_ID FROM TEMP WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM TEMP WHERE PRODUCT_NAME = 'iPhone')"
515,Y,Y,"WITH C AS ( SELECT S.*, P.PRODUCT_NAME FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID=P. PRODUCT_ID) SELECT DISTINCT BUYER_ID FROM C WHERE PRODUCT_NAME='S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM C WHERE PRODUCT_NAME='iPhone')"
516,Y,Y,"WITH CTE AS ( SELECT S.BUYER_ID , GROUP_CONCAT(P.PRODUCT_NAME) PRODUCT_NAME FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID GROUP BY S.BUYER_ID) SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME LIKE '%S8%' AND PRODUCT_NAME NOT LIKE '%IPHONE%'"
517,Y,Y,"SELECT BUYER_ID FROM SALES S, PRODUCT P WHERE S.PRODUCT_ID=P.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(CASE WHEN P.PRODUCT_NAME='S8' THEN 1 ELSE 0 END) >0 AND SUM(CASE WHEN P.PRODUCT_NAME='iPhone' THEN 1 ELSE 0 END)=0"
518,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES AS S JOIN PRODUCT AS P ON S.PRODUCT_ID =P.PRODUCT_ID WHERE PRODUCT_NAME='S8' AND BUYER_ID NOT IN(SELECT BUYER_ID FROM SALES AS S JOIN PRODUCT AS P ON S.PRODUCT_ID =P.PRODUCT_ID WHERE PRODUCT_NAME='iPhone')
519,Y,Y,SELECT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(CASE WHEN PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) = 0
520,Y,Y,"WITH BUY_S8 AS (SELECT BUYER_ID FROM SALES, PRODUCT WHERE SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID AND PRODUCT.PRODUCT_NAME = 'S8') SELECT DISTINCT BUYER_ID FROM BUY_S8 WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES, PRODUCT WHERE SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID AND PRODUCT.PRODUCT_NAME = 'iPhone')"
521,Y,Y,SELECT S.BUYER_ID FROM PRODUCT P LEFT JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM(P.PRODUCT_NAME = 'S8') > 0 AND SUM(P.PRODUCT_NAME = 'iPhone') = 0
522,Y,Y,"WITH BUYERS_WITH_PRODUCTS AS ( SELECT S.BUYER_ID , P.PRODUCT_NAME FROM SALES S LEFT JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID ) SELECT DISTINCT BUYER_ID FROM BUYERS_WITH_PRODUCTS WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT DISTINCT BUYER_ID FROM BUYERS_WITH_PRODUCTS WHERE PRODUCT_NAME = 'iPhone')"
523,Y,Y,"WITH CTE AS ( SELECT S.BUYER_ID, P.PRODUCT_NAME FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID ) SELECT DISTINCT BUYER_ID FROM CTE WHERE BUYER_ID IN ( SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'S8' ) AND BUYER_ID NOT IN ( SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'iPhone' )"
524,Y,Y,SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P USING(PRODUCT_ID) GROUP BY BUYER_ID HAVING SUM(P.PRODUCT_NAME = 'S8') > 0 AND SUM(P.PRODUCT_NAME = 'iPhone') = 0
525,Y,Y,SELECT BUYER_ID FROM SALES T1 INNER JOIN PRODUCT T2 USING(PRODUCT_ID) WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES T1 INNER JOIN PRODUCT T2 USING(PRODUCT_ID) WHERE PRODUCT_NAME = 'iPhone' GROUP BY BUYER_ID ) GROUP BY BUYER_ID
526,Y,Y,SELECT DISTINCT(BUYER_ID) FROM SALES WHERE BUYER_ID IN (SELECT BUYER_ID FROM SALES JOIN PRODUCT ON SALES.PRODUCT_ID=PRODUCT.PRODUCT_ID WHERE PRODUCT_NAME='S8') AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES JOIN PRODUCT ON SALES.PRODUCT_ID=PRODUCT.PRODUCT_ID WHERE PRODUCT_NAME='iPhone')
527,Y,Y,"WITH CTE AS(SELECT P.PRODUCT_ID, S.BUYER_ID, P.PRODUCT_NAME FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID) SELECT DISTINCT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN(SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'iPhone')"
528,Y,Y,"WITH TABLE1 AS (SELECT P.PRODUCT_NAME, S.BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone' OR P.PRODUCT_NAME = 'S8') SELECT DISTINCT BUYER_ID FROM TABLE1 WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM TABLE1 WHERE PRODUCT_NAME = 'iPhone' )"
529,Y,Y,SELECT S.BUYER_ID FROM SALES AS S JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM(CASE WHEN P.PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN P.PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) = 0
530,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
531,Y,Y,"SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID IN ( SELECT S.BUYER_ID FROM PRODUCT AS P, SALES AS S WHERE P.PRODUCT_ID = S.PRODUCT_ID AND P.PRODUCT_NAME = 'S8' ) AND BUYER_ID NOT IN ( SELECT S.BUYER_ID FROM PRODUCT AS P, SALES AS S WHERE P.PRODUCT_ID = S.PRODUCT_ID AND P.PRODUCT_NAME = 'iPhone' )"
532,Y,Y,SELECT A.BUYER_ID FROM SALES AS A LEFT JOIN PRODUCT AS B ON A.PRODUCT_ID=B.PRODUCT_ID GROUP BY A.BUYER_ID HAVING SUM(B.PRODUCT_NAME='S8')>=1 AND SUM(B.PRODUCT_NAME='iPhone')=0
533,Y,Y,SELECT X.BUYER_ID FROM (SELECT DISTINCT S.BUYER_ID FROM SALES AS S LEFT JOIN PRODUCT AS P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE P.PRODUCT_NAME='S8' ) AS X LEFT JOIN ( SELECT DISTINCT S.BUYER_ID FROM SALES AS S LEFT JOIN PRODUCT AS P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE P.PRODUCT_NAME='iPhone' ) AS Y ON X.BUYER_ID=Y.BUYER_ID WHERE Y.BUYER_ID IS NULL
534,Y,Y,SELECT S.BUYER_ID FROM SALES AS S LEFT JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM(CASE WHEN P.PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) >= 1 AND SUM(CASE WHEN P.PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) = 0
535,Y,Y,SELECT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON P.PRODUCT_ID=S.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM(P.PRODUCT_NAME = 'S8') > 0 AND SUM(P.PRODUCT_NAME = 'iPhone') = 0
536,Y,Y,"WITH S8_BUYERS AS (SELECT DISTINCT S.BUYER_ID, S.PRODUCT_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8') SELECT BUYER_ID FROM S8_BUYERS WHERE BUYER_ID NOT IN (SELECT S.BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')"
537,Y,Y,SELECT S.BUYER_ID FROM PRODUCT P INNER JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM(CASE WHEN P.PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) =0 AND SUM(CASE WHEN P.PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) >0
538,Y,Y,"WITH CTE1 AS (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME='S8'), CTE2 AS (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME='iPhone'), CTE3 AS (SELECT DISTINCT BUYER_ID FROM SALES S JOIN CTE1 ON CTE1.PRODUCT_ID=S.PRODUCT_ID), CTE4 AS (SELECT DISTINCT BUYER_ID FROM SALES S JOIN CTE2 ON CTE2.PRODUCT_ID=S.PRODUCT_ID) SELECT CTE3.BUYER_ID FROM CTE3 LEFT JOIN CTE4 ON CTE3.BUYER_ID=CTE4.BUYER_ID WHERE CTE4.BUYER_ID IS NULL"
539,Y,Y,SELECT DISTINCT(BUYER_ID) FROM (SELECT S.BUYER_ID FROM SALES AS S LEFT OUTER JOIN PRODUCT AS P USING (PRODUCT_ID) WHERE P.PRODUCT_NAME = 'S8' ) AS SAMSUNG LEFT OUTER JOIN (SELECT S.BUYER_ID FROM SALES AS S LEFT OUTER JOIN PRODUCT AS P USING (PRODUCT_ID) WHERE P.PRODUCT_NAME = 'iPhone') AS APPLE USING (BUYER_ID) WHERE APPLE.BUYER_ID IS NULL
540,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES A INNER JOIN PRODUCT B ON A.PRODUCT_ID=B.PRODUCT_ID WHERE B.PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN ( SELECT E.BUYER_ID FROM SALES E INNER JOIN PRODUCT F ON E.PRODUCT_ID=F.PRODUCT_ID WHERE F.PRODUCT_NAME = 'iPhone')
541,Y,Y,"WITH BUYS AS ( SELECT S.BUYER_ID, P.PRODUCT_NAME FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID ) SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID IN (SELECT BUYER_ID FROM BUYS WHERE PRODUCT_NAME = 'S8' ) AND BUYER_ID NOT IN (SELECT BUYER_ID FROM BUYS WHERE PRODUCT_NAME = 'iPhone' )"
542,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID=S.PRODUCT_ID WHERE P.PRODUCT_NAME='S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES WHERE PRODUCT_ID IN (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME='iPhone'))
543,Y,Y,"WITH T AS (SELECT S.PRODUCT_ID, S.BUYER_ID, P.PRODUCT_NAME FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID) SELECT DISTINCT BUYER_ID FROM T WHERE BUYER_ID NOT IN (SELECT T.BUYER_ID FROM T WHERE PRODUCT_NAME = 'iPhone') AND PRODUCT_NAME = 'S8'"
544,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID AND P.PRODUCT_NAME='iPhone') AND PRODUCT_ID IN (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME='S8')
545,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID=S.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone' )
546,Y,Y,SELECT DISTINCT(BUYER_ID) FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone') AND PRODUCT_NAME = 'S8'
547,Y,Y,SELECT DISTINCT(S.BUYER_ID) FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT DISTINCT(S2.BUYER_ID) FROM SALES S2 INNER JOIN PRODUCT P2 ON S2.PRODUCT_ID = P2.PRODUCT_ID AND P2.PRODUCT_NAME = 'iPhone')
548,Y,Y,"WITH CTE AS (SELECT S.BUYER_ID, S.PRODUCT_ID, P.PRODUCT_NAME FROM SALES S LEFT JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID) SELECT DISTINCT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'iPhone')"
549,Y,Y,SELECT DISTINCT(BUYER_ID) FROM SALES S1 JOIN PRODUCT P1 ON S1.PRODUCT_ID = P1.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN( SELECT DISTINCT(BUYER_ID) FROM SALES S2 JOIN PRODUCT P2 ON S2.PRODUCT_ID = P2.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone')
550,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE S.BUYER_ID NOT IN ( SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID AND P.PRODUCT_NAME='iPhone' ) AND P.PRODUCT_NAME='S8'
551,Y,Y,SELECT BUYER_ID FROM SALES JOIN PRODUCT USING(PRODUCT_ID) GROUP BY 1 HAVING SUM( PRODUCT_NAME = 'S8') > 0 AND SUM( PRODUCT_NAME = 'iPhone') = 0
552,Y,Y,WITH TMP AS( SELECT BUYER_ID FROM SALES WHERE PRODUCT_ID = ( SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'S8') ) SELECT DISTINCT BUYER_ID FROM TMP WHERE BUYER_ID NOT IN ( SELECT DISTINCT BUYER_ID FROM SALES WHERE PRODUCT_ID = ( SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'iPhone') )
553,Y,Y,"WITH T1 AS ( SELECT BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME IN('S8', 'iPhone') GROUP BY BUYER_ID HAVING COUNT(DISTINCT S.PRODUCT_ID) = 2 ), T2 AS ( SELECT DISTINCT BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' ) SELECT T2.BUYER_ID FROM T2 LEFT JOIN T1 ON T2.BUYER_ID = T1.BUYER_ID WHERE T1.BUYER_ID IS NULL"
554,Y,Y,SELECT DISTINCT BUYER_ID FROM PRODUCT JOIN SALES ON PRODUCT.PRODUCT_ID=SALES.PRODUCT_ID WHERE PRODUCT.PRODUCT_NAME='S8' AND BUYER_ID NOT IN ( SELECT BUYER_ID FROM PRODUCT JOIN SALES ON PRODUCT.PRODUCT_ID=SALES.PRODUCT_ID WHERE PRODUCT_NAME='iPhone' )
555,Y,Y,"WITH PRODUCTSALES AS ( SELECT S.SELLER_ID, S.PRODUCT_ID, S.BUYER_ID, S.SALE_DATE, S.QUANTITY, S.PRICE, P.PRODUCT_NAME, P.UNIT_PRICE FROM PRODUCT P JOIN SALES S ON S.PRODUCT_ID = P.PRODUCT_ID ), BUYS8 AS ( SELECT DISTINCT BUYER_ID FROM PRODUCTSALES WHERE PRODUCT_NAME = 'S8' ), NOTBUYIPHONE AS ( SELECT DISTINCT BUYER_ID FROM PRODUCTSALES WHERE BUYER_ID NOT IN ( SELECT DISTINCT BUYER_ID FROM PRODUCTSALES WHERE PRODUCT_NAME = 'iPhone' ) ) SELECT DISTINCT B.BUYER_ID FROM BUYS8 B JOIN NOTBUYIPHONE N ON B.BUYER_ID = N.BUYER_ID"
556,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT DISTINCT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
557,Y,Y,"SELECT BUYER_ID FROM SALES S, PRODUCT P WHERE S.PRODUCT_ID = P.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(PRODUCT_NAME='S8') > 0 AND SUM(PRODUCT_NAME='iPhone') < 1"
558,Y,Y,"WITH S8 AS (SELECT A.BUYER_ID, A.PRODUCT_ID, B.PRODUCT_NAME FROM SALES A JOIN PRODUCT B ON A.PRODUCT_ID=B.PRODUCT_ID AND B.PRODUCT_NAME='S8'), IP AS (SELECT A.BUYER_ID, A.PRODUCT_ID, B.PRODUCT_NAME FROM SALES A JOIN PRODUCT B ON A.PRODUCT_ID=B.PRODUCT_ID AND B.PRODUCT_NAME='iPhone'), S8_B AS (SELECT DISTINCT(BUYER_ID) AS BUYER_ID FROM S8), IP_B AS (SELECT DISTINCT(BUYER_ID) AS BUYER_ID FROM IP) SELECT A.BUYER_ID FROM S8_B A LEFT JOIN IP_B B ON A.BUYER_ID=B.BUYER_ID WHERE B.BUYER_ID IS NULL"
559,Y,Y,"SELECT BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY BUYER_ID HAVING MAX(IF(PRODUCT_NAME='S8', 1, 0)) = 1 AND MAX(IF(PRODUCT_NAME='iPhone', 1, 0)) = 0"
560,Y,Y,SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(P.PRODUCT_NAME = 'S8')>0 AND SUM(P.PRODUCT_NAME = 'iPhone')=0
561,Y,Y,"WITH CTE1 AS( SELECT S.BUYER_ID, SUM(CASE WHEN P.PRODUCT_NAME='S8' THEN 1 ELSE 0 END) AS S8_FLG, SUM(CASE WHEN P.PRODUCT_NAME='iPhone' THEN 1 ELSE 0 END) AS IPHONE_FLG FROM SALES AS S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY S.BUYER_ID ) SELECT BUYER_ID FROM CTE1 WHERE S8_FLG >= '1' AND IPHONE_FLG='0'"
562,Y,Y,"SELECT BUYER_ID FROM SALES S JOIN PRODUCT P USING (PRODUCT_ID) GROUP BY BUYER_ID HAVING SUM(IF(PRODUCT_NAME='S8',1,0))>0 AND SUM(IF(PRODUCT_NAME='iPhone',1,0))=0"
563,Y,Y,SELECT BUYER_ID FROM SALES LEFT JOIN PRODUCT USING (PRODUCT_ID) GROUP BY BUYER_ID HAVING SUM(PRODUCT_NAME='S8')>0 AND SUM(PRODUCT_NAME='iPhone')=0
564,Y,Y,WITH IPHONE AS (SELECT S.BUYER_ID AS IPHONE_BUYER FROM SALES AS S LEFT JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone') SELECT DISTINCT S.BUYER_ID FROM SALES AS S LEFT JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME ='S8' AND S.BUYER_ID NOT IN (SELECT IPHONE_BUYER FROM IPHONE)
565,Y,Y,"WITH CTE AS (SELECT A.BUYER_ID, B.PRODUCT_NAME FROM SALES AS A LEFT JOIN PRODUCT AS B ON A.PRODUCT_ID = B.PRODUCT_ID) SELECT DISTINCT BUYER_ID FROM CTE WHERE BUYER_ID IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'iPhone')"
566,Y,Y,SELECT S.BUYER_ID FROM PRODUCT P RIGHT JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM(P.PRODUCT_NAME = 'S8') > 0 AND SUM(P.PRODUCT_NAME = 'iPhone') = 0
567,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
568,Y,Y,"WITH CTE AS ( SELECT S.BUYER_ID, S.PRODUCT_ID, P.PRODUCT_NAME FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID ) SELECT DISTINCT C1.BUYER_ID FROM CTE C1 LEFT JOIN ( SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'iPhone' ) C2 ON C1.BUYER_ID = C2.BUYER_ID WHERE C1.PRODUCT_NAME = 'S8' AND C2.BUYER_ID IS NULL"
569,Y,Y,"WITH CTE AS ( SELECT BUYER_ID, P.PRODUCT_ID, PRODUCT_NAME FROM SALES AS S INNER JOIN PRODUCT AS P USING (PRODUCT_ID) ), CTE2 AS ( SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'iPhone' ) SELECT DISTINCT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT * FROM CTE2)"
570,Y,Y,SELECT DISTINCT(BUYER_ID) FROM (SELECT BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE PRODUCT_NAME = 'S8') AS T1 WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone')
571,Y,Y,"WITH TB AS ( SELECT SALES.BUYER_ID, GROUP_CONCAT(PRODUCT.PRODUCT_NAME) AS PRODUCT FROM SALES LEFT JOIN PRODUCT ON SALES.PRODUCT_ID=PRODUCT.PRODUCT_ID GROUP BY SALES.BUYER_ID) SELECT BUYER_ID FROM TB WHERE PRODUCT LIKE '%S8%' AND PRODUCT NOT LIKE '%IPHONE%'"
572,Y,Y,"WITH CTE AS ( SELECT BUYER_ID FROM PRODUCT P INNER JOIN SALES S ON S.PRODUCT_ID=P.PRODUCT_ID WHERE P.PRODUCT_NAME='S8'), CTE2 AS ( SELECT BUYER_ID FROM PRODUCT P INNER JOIN SALES S ON S.PRODUCT_ID=P.PRODUCT_ID WHERE P.PRODUCT_NAME='iPhone') SELECT DISTINCT A.BUYER_ID FROM CTE A LEFT JOIN CTE2 B ON A.BUYER_ID=B.BUYER_ID WHERE B.BUYER_ID IS NULL"
573,Y,Y,"WITH S8 AS( SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P USING(PRODUCT_ID) WHERE P.PRODUCT_NAME ='S8' ), IP AS( SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P USING(PRODUCT_ID) WHERE P.PRODUCT_NAME ='iPhone' ) SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID IN (SELECT BUYER_ID FROM S8) AND BUYER_ID NOT IN (SELECT BUYER_ID FROM IP)"
574,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID IN( SELECT BUYER_ID FROM SALES AS S JOIN PRODUCT AS P ON S.PRODUCT_ID =P.PRODUCT_ID WHERE PRODUCT_NAME ='S8') AND BUYER_ID NOT IN(SELECT BUYER_ID FROM SALES AS S JOIN PRODUCT AS P ON S.PRODUCT_ID =P.PRODUCT_ID WHERE PRODUCT_NAME ='iPhone' )
575,Y,Y,WITH T1 AS ( SELECT DISTINCT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone' ) SELECT DISTINCT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P USING(PRODUCT_ID) WHERE P.PRODUCT_NAME='S8' AND BUYER_ID NOT IN (SELECT * FROM T1)
576,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON P.PRODUCT_ID =S.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES WHERE PRODUCT_ID = (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'iPhone' ))
577,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES AS S INNER JOIN PRODUCT AS P USING(PRODUCT_ID) WHERE P.PRODUCT_NAME ='S8' AND S.BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES AS S INNER JOIN PRODUCT AS P USING(PRODUCT_ID) WHERE PRODUCT_NAME = 'iPhone')
578,Y,Y,SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(P.PRODUCT_NAME = 'S8') > 0 AND SUM(P.PRODUCT_NAME = 'iPhone') = 0
579,Y,Y,"WITH CTE AS (SELECT P.PRODUCT_NAME, S.BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID) SELECT DISTINCT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'iPhone')"
580,Y,Y,"WITH S8 AS ( SELECT BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' ) , IPHONE AS ( SELECT BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone' ) SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID IN (SELECT BUYER_ID FROM S8 ) AND BUYER_ID NOT IN (SELECT BUYER_ID FROM IPHONE )"
581,Y,Y,"SELECT DISTINCT SS8.BUYER_ID FROM SALES AS SS8 INNER JOIN PRODUCT AS PS8 ON PS8.PRODUCT_ID = SS8.PRODUCT_ID AND PRODUCT_NAME = 'S8' LEFT JOIN (SELECT BUYER_ID, S.PRODUCT_ID FROM SALES S INNER JOIN PRODUCT AS PIPHONE ON PIPHONE.PRODUCT_ID = S.PRODUCT_ID AND PIPHONE.PRODUCT_NAME = 'iPhone') AS SIPHONE ON SS8.BUYER_ID = SIPHONE.BUYER_ID WHERE PS8.PRODUCT_ID IS NOT NULL AND SIPHONE.PRODUCT_ID IS NULL"
582,Y,Y,"WITH CTE AS ( SELECT BUYER_ID, S.PRODUCT_ID, PRODUCT_NAME FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID ) SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'iPhone')"
583,Y,Y,"WITH JOINEDTABLE AS (SELECT BUYER_ID, PRODUCT_NAME FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID=S.PRODUCT_ID) SELECT DISTINCT T1.BUYER_ID FROM (SELECT BUYER_ID FROM JOINEDTABLE WHERE PRODUCT_NAME LIKE S8 ) T1 LEFT JOIN (SELECT BUYER_ID FROM JOINEDTABLE WHERE PRODUCT_NAME LIKE IPHONE ) T2 ON T1.BUYER_ID=T2.BUYER_ID WHERE T2.BUYER_ID IS NULL"
584,Y,Y,SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(PRODUCT_NAME = 'iPhone') = 0 AND SUM(PRODUCT_NAME = 'S8') > 0
585,Y,Y,SELECT DISTINCT BUYER_ID FROM (SELECT BUYER_ID FROM SALES WHERE PRODUCT_ID IN (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'S8')) AS T1 WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES WHERE PRODUCT_ID IN (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'iPhone'))
586,Y,Y,"WITH SALES_EXPANDED AS ( SELECT S.*, P.PRODUCT_NAME FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID ), SUMMARY AS( SELECT SE.BUYER_ID, MAX(CASE WHEN SE.PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) S8 , MAX(CASE WHEN SE.PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) IPHONE FROM SALES_EXPANDED SE GROUP BY SE.BUYER_ID ) SELECT BUYER_ID FROM SUMMARY WHERE IPHONE = 0 AND S8 = 1"
587,Y,Y,SELECT DISTINCT(S.BUYER_ID) FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT DISTINCT(S.BUYER_ID) FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
588,Y,Y,SELECT BUYER_ID FROM SALES LEFT JOIN PRODUCT USING(PRODUCT_ID) GROUP BY BUYER_ID HAVING (MAX( CASE WHEN PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) = 1) AND (MAX(CASE WHEN PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) = 0)
589,Y,Y,"WITH CTE AS ( SELECT S.BUYER_ID,P.PRODUCT_NAME FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID ) SELECT DISTINCT BUYER_ID FROM CTE WHERE BUYER_ID IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'iPhone')"
590,Y,Y,SELECT BUYER_ID FROM SALES A LEFT JOIN PRODUCT B ON A.PRODUCT_ID = B.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(PRODUCT_NAME = 'S8') > 0 AND SUM(PRODUCT_NAME = 'iPhone')=0
591,Y,Y,SELECT DISTINCT BUYER_ID FROM (SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'S8')A WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone')
592,Y,Y,SELECT BUYER_ID FROM SALES INNER JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(PRODUCT_NAME='S8') > 0 AND SUM(PRODUCT_NAME='iPhone') = 0
593,Y,Y,"SELECT DISTINCT S.BUYER_ID FROM SALES S, PRODUCT P WHERE S.PRODUCT_ID = P.PRODUCT_ID AND P.PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT DISTINCT BUYER_ID FROM PRODUCT P JOIN SALES S USING(PRODUCT_ID) WHERE PRODUCT_NAME = 'iPhone')"
594,Y,Y,SELECT DISTINCT S.BUYER_ID FROM PRODUCT AS P INNER JOIN SALES AS S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT S.BUYER_ID FROM PRODUCT AS P INNER JOIN SALES AS S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
595,Y,Y,WITH CTE AS ( SELECT BUYER_ID FROM SALES INNER JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE PRODUCT.PRODUCT_NAME LIKE IPHONE ) SELECT DISTINCT SALES.BUYER_ID FROM SALES INNER JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE PRODUCT.PRODUCT_NAME LIKE S8 AND SALES.BUYER_ID NOT IN ( SELECT BUYER_ID FROM CTE )
596,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME IN (SELECT PRODUCT_NAME FROM PRODUCT WHERE PRODUCT_NAME = 'S8') AND S.BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES WHERE PRODUCT_ID IN (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'iPhone'))
597,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE P.PRODUCT_NAME LIKE S8 AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE P.PRODUCT_NAME LIKE IPHONE )
598,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
599,Y,Y,SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(P.PRODUCT_NAME='S8')>0 AND SUM(P.PRODUCT_NAME='iPhone')=0
600,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES A JOIN PRODUCT B ON A.PRODUCT_ID =B.PRODUCT_ID AND PRODUCT_NAME LIKE S8 AND A.BUYER_ID NOT IN (SELECT DISTINCT BUYER_ID FROM SALES A JOIN PRODUCT B ON A.PRODUCT_ID =B.PRODUCT_ID AND PRODUCT_NAME LIKE IPHONE )
601,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone') AND PRODUCT_NAME = 'S8'
602,Y,Y,"WITH CNT AS( SELECT BUYER_ID, SUM(CASE WHEN PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) AS S8, SUM(CASE WHEN PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) AS IPHONE FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY BUYER_ID) SELECT BUYER_ID FROM CNT WHERE S8 > 0 AND IPHONE = 0"
603,Y,Y,"WITH CTE AS ( SELECT DISTINCT BUYER_ID, PRODUCT_NAME FROM SALES JOIN PRODUCT USING (PRODUCT_ID) ) SELECT DISTINCT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'iPhone')"
604,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES JOIN PRODUCT ON PRODUCT.PRODUCT_ID = SALES.PRODUCT_ID AND PRODUCT.PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT DISTINCT BUYER_ID FROM SALES JOIN PRODUCT ON PRODUCT.PRODUCT_ID = SALES.PRODUCT_ID AND PRODUCT.PRODUCT_NAME = 'iPhone')
605,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P USING (PRODUCT_ID) WHERE P.PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES S1 LEFT JOIN PRODUCT P1 USING (PRODUCT_ID) WHERE P1.PRODUCT_NAME = 'iPhone' )
606,Y,Y,"SELECT SUB.BUYER_ID FROM ( SELECT A.BUYER_ID, SUM(S8_IND) AS S8_IND, SUM(IPHONE_IND) AS IPHONE_IND FROM SALES A LEFT JOIN ( SELECT PRODUCT_ID, CASE WHEN PRODUCT_NAME IN ('S8') THEN 1 ELSE 0 END AS S8_IND, CASE WHEN PRODUCT_NAME IN('iPhone')THEN 1 ELSE 0 END AS IPHONE_IND FROM PRODUCT) B ON A.PRODUCT_ID=B.PRODUCT_ID GROUP BY A.BUYER_ID) SUB WHERE S8_IND >= 1 AND IPHONE_IND <= 0 GROUP BY SUB.BUYER_ID"
607,Y,Y,"WITH CTE AS ( SELECT S.PRODUCT_ID, P.PRODUCT_NAME, S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID ) SELECT DISTINCT BUYER_ID FROM CTE WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'iPhone') AND PRODUCT_NAME = 'S8'"
608,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN ( SELECT DISTINCT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone')
609,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID AND PRODUCT_NAME = 'S8' WHERE BUYER_ID NOT IN (SELECT DISTINCT BUYER_ID FROM SALES JOIN PRODUCT USING(PRODUCT_ID) WHERE PRODUCT_NAME = 'iPhone' )
610,Y,Y,"SELECT BUYER_ID FROM (SELECT A.BUYER_ID, SUM(CASE WHEN B.PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) AS S8, SUM(CASE WHEN B.PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) AS IOS FROM SALES AS A JOIN PRODUCT AS B ON A.PRODUCT_ID = B.PRODUCT_ID GROUP BY BUYER_ID) A WHERE S8 >= 1 AND IOS = 0"
611,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT DISTINCT SS.BUYER_ID FROM SALES SS LEFT JOIN PRODUCT PP ON SS.PRODUCT_ID = PP.PRODUCT_ID WHERE PP.PRODUCT_NAME = 'iPhone')
612,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone' )
613,Y,Y,"WITH TABLE1 AS (SELECT S.BUYER_ID, SUM(CASE WHEN P.PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) AS S8, SUM(CASE WHEN P.PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) AS IPHONE FROM PRODUCT P JOIN SALES S USING (PRODUCT_ID) GROUP BY S.BUYER_ID ) SELECT BUYER_ID FROM TABLE1 WHERE S8 >0 AND IPHONE = 0"
614,Y,Y,"SELECT DISTINCT BUYER_ID FROM (SELECT SALES.BUYER_ID, PRODUCT.PRODUCT_NAME FROM SALES JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID) A1 WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT SALES.BUYER_ID FROM SALES JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone')"
615,Y,Y,"WITH CTE AS( SELECT S.BUYER_ID,P.PRODUCT_NAME,S.PRODUCT_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID ) SELECT DISTINCT BUYER_ID FROM CTE WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'iPhone') AND PRODUCT_NAME='S8'"
616,Y,Y,SELECT BUYER_ID FROM( SELECT DISTINCT BUYER_ID FROM SALES WHERE PRODUCT_ID IN (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'S8') ) AS A WHERE A.BUYER_ID NOT IN ( SELECT DISTINCT BUYER_ID FROM SALES WHERE PRODUCT_ID IN (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'iPhone') )
617,Y,Y,SELECT BUYER_ID FROM SALES JOIN PRODUCT USING (PRODUCT_ID) GROUP BY BUYER_ID HAVING SUM(CASE WHEN PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) >= 1 AND SUM(CASE WHEN PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) = 0
618,Y,Y,WITH CTE AS (SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8') SELECT DISTINCT BUYER_ID FROM CTE WHERE CTE.BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
619,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID=S.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone')
620,Y,Y,SELECT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(PRODUCT_NAME='S8') > 0 AND SUM(PRODUCT_NAME='iPhone') < 1
621,Y,Y,SELECT DISTINCT BUYER_ID AS BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone' )
622,Y,Y,SELECT BUYER_ID FROM SALES LEFT JOIN PRODUCT USING (PRODUCT_ID) GROUP BY 1 HAVING SUM(CASE WHEN PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) = 0
623,Y,Y,"WITH WLS AS( SELECT S.BUYER_ID,SUM(P.PRODUCT_NAME = 'S8') AS S8,SUM(P.PRODUCT_NAME = 'iPhone') AS IPHONE FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY BUYER_ID ) SELECT BUYER_ID FROM WLS WHERE S8>=1 AND IPHONE = 0"
624,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P USING(PRODUCT_ID) WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN ( SELECT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P USING(PRODUCT_ID) WHERE P.PRODUCT_NAME = 'iPhone')
625,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone')
626,Y,Y,SELECT DISTINCT(S.BUYER_ID) FROM SALES S LEFT JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
627,Y,Y,"SELECT DISTINCT S.BUYER_ID FROM SALES S, PRODUCT P WHERE S.PRODUCT_ID = P.PRODUCT_ID AND P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN ( SELECT S.BUYER_ID FROM SALES S, PRODUCT P WHERE S.PRODUCT_ID = P.PRODUCT_ID AND P.PRODUCT_NAME = 'iPhone' )"
628,Y,Y,SELECT S.BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY 1 HAVING SUM(CASE WHEN P.PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN P.PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) = 0
629,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE P.PRODUCT_NAME IN ('S8') AND S.BUYER_ID NOT IN (SELECT DISTINCT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE P.PRODUCT_NAME IN ('iPhone') )
630,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID IN (SELECT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE PRODUCT_NAME='S8') AND BUYER_ID NOT IN (SELECT DISTINCT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE PRODUCT_NAME='iPhone')
631,Y,Y,"WITH S_BUYER AS ( SELECT S.BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' ), IPHONE_BUYER AS ( SELECT S.BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone' ) SELECT DISTINCT BUYER_ID FROM S_BUYER WHERE BUYER_ID NOT IN ( SELECT * FROM IPHONE_BUYER )"
632,Y,Y,SELECT BUYER_ID FROM SALES JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID GROUP BY BUYER_ID HAVING (SUM(PRODUCT_NAME = 'S8')>0 AND SUM(PRODUCT_NAME = 'iPhone') < 1)
633,Y,Y,"WITH CTE AS (SELECT S.BUYER_ID, P.PRODUCT_ID, P.PRODUCT_NAME FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID) SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'iPhone')"
634,Y,Y,WITH S8_BUYERS AS (SELECT DISTINCT A.BUYER_ID FROM SALES AS A INNER JOIN PRODUCT AS B ON A.PRODUCT_ID=B.PRODUCT_ID WHERE B.PRODUCT_NAME='S8') SELECT BUYER_ID FROM S8_BUYERS WHERE BUYER_ID NOT IN (SELECT DISTINCT A.BUYER_ID FROM SALES AS A INNER JOIN PRODUCT AS B ON A.PRODUCT_ID=B.PRODUCT_ID WHERE B.PRODUCT_NAME='iPhone')
635,Y,Y,WITH A AS (SELECT BUYER_ID FROM SALES JOIN PRODUCT USING (PRODUCT_ID) WHERE PRODUCT_NAME='S8') SELECT DISTINCT BUYER_ID FROM A WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES JOIN PRODUCT USING (PRODUCT_ID) WHERE PRODUCT_NAME='iPhone' ) ORDER BY BUYER_ID
636,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES LEFT JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(PRODUCT.PRODUCT_NAME = 'S8' ) > 0 AND SUM(PRODUCT.PRODUCT_NAME = 'iPhone' ) =0
637,Y,Y,"SELECT BUYER_ID FROM ( SELECT S.BUYER_ID, SUM(CASE WHEN PRODUCT_NAME='S8' THEN 1 ELSE 0 END) S8_FREQ, SUM(CASE WHEN PRODUCT_NAME='iPhone' THEN 1 ELSE 0 END) IPHONE_FREQ FROM SALES S LEFT JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID GROUP BY S.BUYER_ID HAVING S8_FREQ > 0 AND IPHONE_FREQ = 0 ) FINAL"
638,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S1 JOIN PRODUCT P1 ON P1.PRODUCT_ID = S1.PRODUCT_ID WHERE P1.PRODUCT_NAME = 'S8' AND S1.BUYER_ID NOT IN (SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
639,Y,Y,"SELECT BUYER_ID FROM PRODUCT A JOIN SALES B USING (PRODUCT_ID) GROUP BY BUYER_ID HAVING COUNT(IF(PRODUCT_NAME = 'S8',1,NULL))> 0 AND COUNT(IF( PRODUCT_NAME = 'iPhone',1,NULL))= 0"
640,Y,Y,"WITH CTE AS ( SELECT BUYER_ID, PRODUCT_NAME FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' OR PRODUCT_NAME = 'iPhone' ) SELECT DISTINCT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'iPhone')"
641,Y,Y,SELECT DISTINCT BUYER_ID FROM PRODUCT P JOIN SALES S ON S.PRODUCT_ID = P.PRODUCT_ID WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone') AND PRODUCT_NAME = 'S8'
642,Y,Y,"WITH A AS (SELECT S.BUYER_ID, P.PRODUCT_NAME FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID) SELECT DISTINCT (BUYER_ID)FROM A WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN(SELECT BUYER_ID FROM A WHERE PRODUCT_NAME ='iPhone')"
643,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID IN ( SELECT BUYER_ID FROM SALES S JOIN PRODUCT P WHERE S.PRODUCT_ID = P.PRODUCT_ID AND PRODUCT_NAME = 'S8' ) AND BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES S JOIN PRODUCT P WHERE S.PRODUCT_ID = P.PRODUCT_ID AND PRODUCT_NAME = 'iPhone' )
644,Y,Y,"SELECT K.BUYER_ID FROM (SELECT BUYER_ID, SUM(CASE WHEN PRODUCT_NAME='S8' THEN 1 ELSE 0 END ) AS COUNTS8, SUM(CASE WHEN PRODUCT_NAME='iPhone' THEN 1 ELSE 0 END ) AS COUNT_IPHONE FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID GROUP BY BUYER_ID HAVING COUNTS8>=1 AND COUNT_IPHONE=0) K"
645,Y,Y,"WITH CTE1 AS ( SELECT S.PRODUCT_ID, S.BUYER_ID,P.PRODUCT_NAME FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID ) ,CTE2 AS ( SELECT BUYER_ID, (CASE WHEN PRODUCT_NAME= 'S8' THEN 1 ELSE 0 END)AS S8_FLAG, (CASE WHEN PRODUCT_NAME= 'iPhone' THEN 1 ELSE 0 END)AS IPHONE_FLAG FROM CTE1 ) SELECT BUYER_ID FROM CTE2 GROUP BY BUYER_ID HAVING SUM(S8_FLAG)>0 AND SUM(IPHONE_FLAG)=0"
646,Y,Y,"WITH CTE AS (SELECT BUYER_ID, SALES.PRODUCT_ID, PRODUCT.PRODUCT_NAME FROM SALES LEFT JOIN PRODUCT ON PRODUCT.PRODUCT_ID = SALES.PRODUCT_ID) SELECT DISTINCT BUYER_ID FROM CTE WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME ='iPhone') AND PRODUCT_NAME = 'S8'"
647,Y,Y,SELECT S.BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM(P.PRODUCT_NAME = 'S8') > 0 AND SUM(P.PRODUCT_NAME = 'iPhone') = 0
648,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S1 JOIN PRODUCT P1 ON S1.PRODUCT_ID = P1.PRODUCT_ID WHERE P1.PRODUCT_NAME='S8' AND BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME='iPhone')
649,Y,Y,"SELECT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P USING(PRODUCT_ID) GROUP BY S.BUYER_ID HAVING SUM(IF(P.PRODUCT_NAME = 'S8',1,0))>=1 AND SUM(IF(P.PRODUCT_NAME='iPhone',1,0))=0"
650,Y,Y,WITH S8 AS (SELECT DISTINCT BUYER_ID FROM SALES WHERE PRODUCT_ID IN (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME='S8')) SELECT BUYER_ID FROM S8 WHERE BUYER_ID NOT IN (SELECT DISTINCT BUYER_ID FROM SALES WHERE PRODUCT_ID IN (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME='iPhone'))
651,Y,Y,SELECT BUYER_ID FROM SALES AS S LEFT JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY 1 HAVING SUM(PRODUCT_NAME = 'iPhone' ) = 0 AND SUM(PRODUCT_NAME = 'S8')>=1
652,Y,Y,"WITH BIG_TABLE AS ( SELECT P.PRODUCT_NAME, S.PRODUCT_ID, S.BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID ), S8 AS ( SELECT BUYER_ID FROM BIG_TABLE WHERE PRODUCT_NAME = 'S8' ), IPHONES AS ( SELECT BUYER_ID FROM BIG_TABLE WHERE PRODUCT_NAME = 'iPhone' ) SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID IN (SELECT * FROM S8) AND BUYER_ID NOT IN (SELECT * FROM IPHONES)"
653,Y,Y,SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM( PRODUCT_NAME = 'S8') >0 AND SUM(PRODUCT_NAME = 'iPhone') =0
654,Y,Y,SELECT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(PRODUCT_NAME='iPhone')=0 AND SUM(PRODUCT_NAME='S8')!=0
655,Y,Y,"SELECT DISTINCT A1.BUYER_ID FROM (SELECT SALES.BUYER_ID,PRODUCT.PRODUCT_NAME FROM SALES JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID) A1 WHERE A1.PRODUCT_NAME = 'S8' AND A1.BUYER_ID NOT IN (SELECT DISTINCT A1.BUYER_ID FROM (SELECT SALES.BUYER_ID,PRODUCT.PRODUCT_NAME FROM SALES JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID) A1 WHERE A1.PRODUCT_NAME = 'iPhone')"
656,Y,Y,SELECT DISTINCT S.BUYER_ID FROM PRODUCT P INNER JOIN SALES S ON P.PRODUCT_ID=S.PRODUCT_ID WHERE P.PRODUCT_NAME='S8' AND S.BUYER_ID NOT IN( SELECT S1.BUYER_ID FROM PRODUCT P1 INNER JOIN SALES S1 ON P1.PRODUCT_ID=S1.PRODUCT_ID WHERE P1.PRODUCT_NAME='iPhone')
657,Y,Y,"SELECT DISTINCT SS8.BUYER_ID FROM SALES AS SS8 INNER JOIN PRODUCT AS PS8 ON PS8.PRODUCT_ID = SS8.PRODUCT_ID AND PRODUCT_NAME = 'S8' LEFT JOIN (SELECT S.BUYER_ID, S.PRODUCT_ID FROM SALES S INNER JOIN PRODUCT AS PIPHONE ON PIPHONE.PRODUCT_ID = S.PRODUCT_ID AND PIPHONE.PRODUCT_NAME = 'iPhone') AS SIPHONE ON SS8.BUYER_ID = SIPHONE.BUYER_ID WHERE SIPHONE.PRODUCT_ID IS NULL"
658,Y,Y,WITH IP AS (SELECT BUYER_ID FROM PRODUCT P JOIN SALES S ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone' ) SELECT S.BUYER_ID FROM PRODUCT P JOIN SALES S ON S.PRODUCT_ID = P.PRODUCT_ID LEFT JOIN IP ON IP.BUYER_ID = S.BUYER_ID WHERE P.PRODUCT_NAME = 'S8' AND IP.BUYER_ID IS NULL GROUP BY 1
659,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
660,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES A LEFT JOIN PRODUCT B ON A.PRODUCT_ID = B.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES A LEFT JOIN PRODUCT B ON A.PRODUCT_ID = B.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone')
661,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES WHERE PRODUCT_ID IN (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES JOIN PRODUCT USING(PRODUCT_ID) WHERE PRODUCT_NAME = 'iPhone')
662,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID IN (SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE PRODUCT_NAME='S8') AND BUYER_ID NOT IN (SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE PRODUCT_NAME='iPhone')
663,Y,Y,"WITH T_BP AS (SELECT S.BUYER_ID , P.PRODUCT_NAME FROM SALES AS S LEFT JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID) SELECT DISTINCT T1.BUYER_ID FROM T_BP AS T1 WHERE EXISTS (SELECT * FROM T_BP AS T2 WHERE T1.BUYER_ID = T2.BUYER_ID AND T2.PRODUCT_NAME = 'S8') AND NOT EXISTS (SELECT * FROM T_BP AS T2 WHERE T1.BUYER_ID = T2.BUYER_ID AND T2.PRODUCT_NAME = 'iPhone')"
664,Y,Y,"WITH T AS ( SELECT BUYER_ID, PRODUCT_NAME FROM SALES T1 JOIN PRODUCT T2 ON T1.PRODUCT_ID = T2.PRODUCT_ID WHERE PRODUCT_NAME IN ('S8', 'iPhone') ) SELECT DISTINCT BUYER_ID FROM T WHERE BUYER_ID IN (SELECT BUYER_ID FROM T WHERE PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN (SELECT BUYER_ID FROM T WHERE PRODUCT_NAME = 'iPhone')"
665,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES JOIN PRODUCT USING (PRODUCT_ID) WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES JOIN PRODUCT USING (PRODUCT_ID) WHERE PRODUCT_NAME LIKE '%IPHONE%') AND PRODUCT_NAME LIKE '%S8'
666,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone')
667,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES WHERE PRODUCT_ID IN (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone')
668,Y,Y,"WITH T AS (SELECT BUYER_ID, PRODUCT_NAME FROM SALES LEFT JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID) SELECT DISTINCT BUYER_ID FROM T WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM T WHERE PRODUCT_NAME = 'iPhone')"
669,Y,Y,"WITH JOINED AS ( SELECT BUYER_ID, PRODUCT_NAME FROM SALES JOIN PRODUCT ON PRODUCT.PRODUCT_ID = SALES.PRODUCT_ID ) SELECT DISTINCT (BUYER_ID) FROM JOINED WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT DISTINCT (BUYER_ID) FROM JOINED WHERE PRODUCT_NAME = 'iPhone')"
670,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN ( SELECT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone' )
671,Y,Y,SELECT BUYER_ID FROM SALES S1 JOIN PRODUCT P1 ON S1.PRODUCT_ID = P1.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(P1.PRODUCT_NAME = 'S8') > 0 AND SUM(P1.PRODUCT_NAME = 'iPhone') = 0
672,Y,Y,"WITH T AS( SELECT BUYER_ID FROM SALES AS S JOIN PRODUCT AS P ON S.PRODUCT_ID =P.PRODUCT_ID WHERE PRODUCT_NAME='S8'), T1 AS( SELECT BUYER_ID FROM SALES AS S JOIN PRODUCT AS P ON S.PRODUCT_ID =P.PRODUCT_ID WHERE PRODUCT_NAME='iPhone') SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID IN (SELECT T.BUYER_ID FROM T) AND BUYER_ID NOT IN (SELECT T1.BUYER_ID FROM T1)"
673,Y,Y,SELECT BUYER_ID FROM SALES WHERE PRODUCT_ID IN (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES WHERE PRODUCT_ID IN (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'iPhone')) GROUP BY 1
674,Y,Y,"WITH PRODUCT_BUYER AS ( SELECT DISTINCT PRODUCT_NAME, BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID ) SELECT P1.BUYER_ID FROM PRODUCT_BUYER P1 LEFT JOIN PRODUCT_BUYER P2 ON P1.BUYER_ID = P2.BUYER_ID AND P2.PRODUCT_NAME = 'iPhone' WHERE P1.PRODUCT_NAME = 'S8' AND P2.BUYER_ID IS NULL"
675,Y,Y,"SELECT BUYER_ID FROM ( SELECT BUYER_ID, SUM(CASE WHEN P.PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) S8, SUM(CASE WHEN P.PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) IPHONE FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY BUYER_ID ) V WHERE V.S8 > 0 AND V.IPHONE = 0"
676,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID IN (SELECT DISTINCT A.BUYER_ID FROM SALES A LEFT JOIN PRODUCT B ON A.PRODUCT_ID = B.PRODUCT_ID WHERE B.PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN (SELECT DISTINCT A.BUYER_ID FROM SALES A LEFT JOIN PRODUCT B ON A.PRODUCT_ID = B.PRODUCT_ID WHERE B.PRODUCT_NAME = 'iPhone')
677,Y,Y,SELECT BUYER_ID FROM PRODUCT P1 JOIN SALES S1 ON P1.PRODUCT_ID = S1.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(PRODUCT_NAME = 'S8') > 0 AND SUM(PRODUCT_NAME = 'iPhone') = 0
678,Y,Y,SELECT DISTINCT S.BUYER_ID FROM PRODUCT P RIGHT JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM(CASE WHEN P.PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) =0 AND SUM(CASE WHEN P.PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) >0
679,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID AND P.PRODUCT_NAME = 'iPhone')
680,Y,Y,"SELECT BUYER_ID FROM ( SELECT BUYER_ID, SUM(CASE WHEN P1.PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) AS S8_CNT, SUM(CASE WHEN P1.PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) AS IPHONE_CNT FROM SALES AS S1 INNER JOIN PRODUCT P1 ON S1.PRODUCT_ID = P1.PRODUCT_ID GROUP BY BUYER_ID ) AS PC WHERE S8_CNT>0 AND IPHONE_CNT = 0"
681,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES S1 JOIN PRODUCT P1 ON S1.PRODUCT_ID = P1.PRODUCT_ID WHERE P1.PRODUCT_NAME = 'iPhone')
682,Y,Y,"WITH T AS( SELECT S.BUYER_ID, P.PRODUCT_ID, P.PRODUCT_NAME FROM PRODUCT P JOIN SALES S USING(PRODUCT_ID) ) SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID IN (SELECT BUYER_ID FROM T WHERE PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN (SELECT BUYER_ID FROM T WHERE PRODUCT_NAME = 'iPhone')"
683,Y,Y,"WITH TEMP AS ( SELECT BUYER_ID, S.PRODUCT_ID, P.PRODUCT_NAME FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID ) SELECT BUYER_ID FROM TEMP GROUP BY 1 HAVING SUM(PRODUCT_NAME = 'S8') > 0 AND SUM(PRODUCT_NAME='iPhone') = 0"
684,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN( SELECT DISTINCT BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone')
685,Y,Y,"WITH TEMP AS ( SELECT SELLER_ID, BUYER_ID, SALE_DATE, QUANTITY, PRICE, PRDT.PRODUCT_NAME AS PRODUCT_NAME FROM SALES SALES LEFT JOIN PRODUCT PRDT ON SALES.PRODUCT_ID = PRDT.PRODUCT_ID ) SELECT DISTINCT BUYER_ID FROM TEMP WHERE BUYER_ID IN (SELECT BUYER_ID FROM TEMP WHERE PRODUCT_NAME IN ('S8')) AND BUYER_ID NOT IN (SELECT BUYER_ID FROM TEMP WHERE PRODUCT_NAME IN ('iPhone'))"
686,Y,Y,"WITH T AS (SELECT BUYER_ID,PRODUCT.PRODUCT_ID,PRODUCT_NAME FROM PRODUCT JOIN SALES ON PRODUCT.PRODUCT_ID = SALES.PRODUCT_ID) SELECT DISTINCT BUYER_ID FROM T WHERE BUYER_ID <> ALL(SELECT BUYER_ID FROM T WHERE PRODUCT_NAME = 'iPhone') AND BUYER_ID = ANY(SELECT BUYER_ID FROM T WHERE PRODUCT_NAME = 'S8')"
687,Y,N,SELECT DISTINCT BUYER_ID FROM PRODUCT P LEFT JOIN SALES S USING(PRODUCT_ID) WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM PRODUCT P LEFT JOIN SALES S USING(PRODUCT_ID) WHERE PRODUCT_NAME = 'iPhone')
688,Y,Y,"WITH S8_TAB AS ( SELECT BUYER_ID FROM SALES SALES LEFT JOIN PRODUCT PROD ON SALES.PRODUCT_ID = PROD.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' ), IPHONE_TAB AS ( SELECT BUYER_ID FROM SALES SALES LEFT JOIN PRODUCT PROD ON SALES.PRODUCT_ID = PROD.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone' ) SELECT DISTINCT(BUYER_ID) FROM SALES WHERE BUYER_ID IN (SELECT * FROM S8_TAB) AND BUYER_ID NOT IN (SELECT * FROM IPHONE_TAB)"
689,Y,Y,SELECT S.BUYER_ID FROM SALES AS S JOIN PRODUCT AS P USING (PRODUCT_ID) GROUP BY S.BUYER_ID HAVING SUM(P.PRODUCT_NAME = 'S8') >0 AND SUM(P.PRODUCT_NAME = 'iPhone') = 0
690,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND NOT EXISTS ( SELECT 1 FROM SALES S2 JOIN PRODUCT P2 ON S2.PRODUCT_ID = P2.PRODUCT_ID AND S2.BUYER_ID = S.BUYER_ID AND P2.PRODUCT_NAME = 'iPhone' )
691,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES JOIN PRODUCT USING(PRODUCT_ID) WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN ( SELECT DISTINCT BUYER_ID FROM SALES INNER JOIN PRODUCT USING(PRODUCT_ID) WHERE PRODUCT_NAME = 'iPhone' )
692,Y,Y,SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(PRODUCT_NAME='S8') >=1 AND SUM(PRODUCT_NAME='iPhone') = 0
693,Y,Y,"WITH A AS ( SELECT BUYER_ID FROM SALES WHERE PRODUCT_ID IN ( SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'S8' ) ), C AS ( SELECT BUYER_ID FROM SALES WHERE PRODUCT_ID IN ( SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'iPhone' ) ) SELECT DISTINCT BUYER_ID FROM A WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM C)"
694,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES AS S LEFT JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE BUYER_ID IN ( SELECT S.BUYER_ID FROM SALES AS S LEFT JOIN PRODUCT AS P ON S.PRODUCT_ID = P. PRODUCT_ID WHERE PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN ( SELECT S.BUYER_ID FROM SALES AS S LEFT JOIN PRODUCT AS P ON S.PRODUCT_ID = P. PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone')
695,Y,Y,"SELECT DISTINCT SALES.BUYER_ID FROM SALES, PRODUCT WHERE SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID AND PRODUCT.PRODUCT_NAME = 'S8' AND SALES.BUYER_ID NOT IN ( SELECT SALES.BUYER_ID FROM SALES JOIN PRODUCT WHERE SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID AND PRODUCT.PRODUCT_NAME = 'iPhone' )"
696,Y,Y,SELECT DISTINCT SALES.BUYER_ID FROM SALES JOIN PRODUCT ON PRODUCT.PRODUCT_ID = SALES.PRODUCT_ID WHERE PRODUCT.PRODUCT_NAME = 'S8' AND SALES.BUYER_ID NOT IN (SELECT SALES.BUYER_ID FROM SALES JOIN PRODUCT ON PRODUCT.PRODUCT_ID = SALES.PRODUCT_ID WHERE PRODUCT.PRODUCT_NAME = 'iPhone')
697,Y,Y,"WITH SALES_BUYERS AS ( SELECT DISTINCT A.*, B.PRODUCT_NAME FROM SALES A INNER JOIN PRODUCT B ON A.PRODUCT_ID = B.PRODUCT_ID ) SELECT DISTINCT BUYER_ID FROM SALES_BUYERS WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT DISTINCT BUYER_ID FROM SALES_BUYERS WHERE PRODUCT_NAME = 'iPhone')"
698,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES JOIN PRODUCT ON PRODUCT.PRODUCT_ID=SALES.PRODUCT_ID WHERE PRODUCT.PRODUCT_NAME = 'S8' AND SALES.BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES JOIN PRODUCT ON PRODUCT.PRODUCT_ID=SALES.PRODUCT_ID WHERE PRODUCT.PRODUCT_NAME = 'iPhone')
699,Y,Y,SELECT DISTINCT(BUYER_ID) FROM SALES WHERE BUYER_ID NOT IN (SELECT S1.BUYER_ID FROM SALES AS S1 JOIN PRODUCT AS P1 ON S1.PRODUCT_ID = P1.PRODUCT_ID WHERE P1.PRODUCT_NAME ='iPhone') AND BUYER_ID IN (SELECT S1.BUYER_ID FROM SALES AS S1 JOIN PRODUCT AS P1 ON S1.PRODUCT_ID = P1.PRODUCT_ID WHERE P1.PRODUCT_NAME ='S8')
700,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE BUYER_ID NOT IN ( SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone' ) AND PRODUCT_NAME='S8'
701,Y,Y,"WITH CTE AS ( SELECT P.PRODUCT_NAME , S.* FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID =S.PRODUCT_ID ) SELECT DISTINCT BUYER_ID FROM CTE WHERE PRODUCT_NAME='S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME='iPhone' )"
702,Y,Y,SELECT DISTINCT(S.BUYER_ID) FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT S.BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
703,Y,Y,"WITH T1 AS ( SELECT S.BUYER_ID, S.PRODUCT_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID AND P.PRODUCT_NAME = 'S8' ), T2 AS ( SELECT S.BUYER_ID, S.PRODUCT_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID AND P.PRODUCT_NAME = 'iPhone' ) SELECT DISTINCT T1.BUYER_ID FROM T1 WHERE T1.BUYER_ID NOT IN (SELECT BUYER_ID FROM T2)"
704,Y,Y,"WITH RTE AS( SELECT S.BUYER_ID, P.PRODUCT_NAME FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' ) SELECT DISTINCT BUYER_ID FROM RTE WHERE BUYER_ID NOT IN ( SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')"
705,Y,Y,"SELECT BUYER_ID FROM (SELECT BUYER_ID, SUM(IF(PRODUCT_NAME = 'S8', 1, 0)) BOUGHT_S8, SUM(IF(PRODUCT_NAME = 'iPhone', 1, 0 )) BOUGHT_IPHONE FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY BUYER_ID) T WHERE BOUGHT_S8 > 0 AND BOUGHT_IPHONE = 0"
706,Y,Y,"WITH CTE AS ( SELECT S.BUYER_ID, P.PRODUCT_NAME FROM SALES AS S LEFT JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID ) SELECT DISTINCT BUYER_ID FROM CTE WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME ='iPhone') AND BUYER_ID IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME='S8')"
707,Y,Y,"WITH A AS( SELECT S.PRODUCT_ID, S.BUYER_ID, P.PRODUCT_NAME FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID) SELECT DISTINCT BUYER_ID FROM A WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM A WHERE PRODUCT_NAME = 'iPhone') AND BUYER_ID IN (SELECT BUYER_ID FROM A WHERE PRODUCT_NAME = 'S8')"
708,Y,Y,SELECT BUYER_ID FROM SALES LEFT JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(PRODUCT_NAME = 'S8') >= 1 AND SUM(PRODUCT_NAME = 'iPhone') = 0
709,Y,Y,SELECT BUYER_ID FROM PRODUCT RIGHT JOIN SALES USING(PRODUCT_ID) GROUP BY BUYER_ID HAVING SUM(CASE WHEN PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) = 0
710,Y,Y,"SELECT DISTINCT BUYER_ID FROM (SELECT A.BUYER_ID, B.PRODUCT_NAME FROM SALES AS A LEFT JOIN PRODUCT AS B ON A.PRODUCT_ID=B.PRODUCT_ID) AS T1 WHERE PRODUCT_NAME='S8' AND BUYER_ID NOT IN (SELECT A.BUYER_ID FROM SALES AS A LEFT JOIN PRODUCT AS B ON A.PRODUCT_ID=B.PRODUCT_ID WHERE B.PRODUCT_NAME IN ('G4','iPhone'))"
711,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT S1.BUYER_ID FROM SALES S1 INNER JOIN PRODUCT P1 ON S1.PRODUCT_ID = P1.PRODUCT_ID WHERE P1.PRODUCT_NAME = 'iPhone')
712,Y,Y,"WITH TEMP AS ( SELECT BUYER_ID,PRODUCT_NAME FROM SALES T1 JOIN PRODUCT T2 ON T1.PRODUCT_ID = T2.PRODUCT_ID), BOTH_DATA AS (SELECT DISTINCT BUYER_ID FROM TEMP WHERE PRODUCT_NAME IN ('S8','iPhone')), ONLY_IPHONE AS (SELECT DISTINCT BUYER_ID FROM TEMP WHERE PRODUCT_NAME IN ('iPhone')) SELECT BUYER_ID FROM BOTH_DATA WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM ONLY_IPHONE)"
713,Y,Y,SELECT DISTINCT C.BUYER_ID FROM SALES C JOIN PRODUCT D ON C.PRODUCT_ID = D.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT F.BUYER_ID FROM SALES F JOIN PRODUCT E ON F.PRODUCT_ID = E.PRODUCT_ID WHERE E.PRODUCT_NAME = 'iPhone')
714,Y,Y,SELECT BUYER_ID FROM SALES A LEFT OUTER JOIN PRODUCT B ON (A.PRODUCT_ID = B.PRODUCT_ID) WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES A LEFT OUTER JOIN PRODUCT B ON (A.PRODUCT_ID = B.PRODUCT_ID) WHERE PRODUCT_NAME = 'iPhone') GROUP BY 1
715,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES AS S JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN ( SELECT S.BUYER_ID FROM SALES AS S JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone')
716,Y,Y,SELECT BUYER_ID FROM PRODUCT P1 JOIN SALES S1 ON P1.PRODUCT_ID = S1.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(CASE WHEN PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) = 0
717,Y,Y,WITH T AS ( SELECT DISTINCT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID AND P.PRODUCT_NAME='S8' ) SELECT BUYER_ID FROM T WHERE BUYER_ID NOT IN (SELECT DISTINCT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID AND P.PRODUCT_NAME='iPhone')
718,Y,N,"WITH C1 AS ( SELECT P.PRODUCT_ID AS C1_P, PRODUCT_NAME,BUYER_ID FROM PRODUCT P LEFT JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' ), C2 AS ( SELECT P.PRODUCT_ID AS C3_P, PRODUCT_NAME,BUYER_ID FROM PRODUCT P LEFT JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone' ) SELECT DISTINCT C1.BUYER_ID FROM C1,C2 WHERE C1.BUYER_ID NOT IN (SELECT C2.BUYER_ID FROM C2)"
719,Y,Y,"WITH T1 AS ( SELECT SALES.PRODUCT_ID, SALES.BUYER_ID, PRODUCT.PRODUCT_NAME FROM SALES LEFT JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID ) SELECT DISTINCT BUYER_ID FROM T1 WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM T1 WHERE PRODUCT_NAME = 'iPhone') AND PRODUCT_NAME = 'S8'"
720,Y,Y,"SELECT DISTINCT BUYER_ID FROM SALES, PRODUCT WHERE BUYER_ID IN (SELECT BUYER_ID FROM SALES S, PRODUCT P WHERE S.PRODUCT_ID = P.PRODUCT_ID AND P.PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES S, PRODUCT P WHERE S.PRODUCT_ID = P.PRODUCT_ID AND P.PRODUCT_NAME = 'iPhone')"
721,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID IN ( SELECT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
722,Y,Y,"WITH S8_BUYERS AS ( SELECT DISTINCT(S.BUYER_ID) FROM SALES AS S JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' ), IPHONE_BUYERS AS ( SELECT DISTINCT(S.BUYER_ID) FROM SALES AS S JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone' ) SELECT X.BUYER_ID FROM S8_BUYERS AS X LEFT JOIN IPHONE_BUYERS AS Y ON X.BUYER_ID = Y.BUYER_ID WHERE Y.BUYER_ID IS NULL"
723,Y,Y,WITH IPHONE AS( SELECT BUYER_ID FROM SALES A LEFT JOIN PRODUCT B ON A.PRODUCT_ID = B.PRODUCT_ID WHERE B.PRODUCT_NAME = 'iPhone' ) SELECT DISTINCT BUYER_ID FROM SALES A LEFT JOIN PRODUCT B ON A.PRODUCT_ID = B.PRODUCT_ID WHERE B.PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM IPHONE)
724,Y,Y,SELECT BUYER_ID FROM PRODUCT A JOIN SALES B ON A.PRODUCT_ID = B.PRODUCT_ID WHERE PRODUCT_NAME LIKE S8 AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES A JOIN PRODUCT B USING (PRODUCT_ID) WHERE PRODUCT_NAME LIKE IPHONE ) GROUP BY 1
725,Y,Y,"SELECT BUYER_ID FROM PRODUCT P, SALES S WHERE P.PRODUCT_ID = S.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(PRODUCT_NAME = 'S8') > 0 AND SUM(PRODUCT_NAME = 'iPhone')=0"
726,Y,Y,"SELECT A.BUYER_ID FROM SALES AS A INNER JOIN PRODUCT AS B ON A.PRODUCT_ID = B.PRODUCT_ID GROUP BY A.BUYER_ID HAVING SUM(IF(B.PRODUCT_NAME='S8', 1, 0)) > 0 AND SUM(IF(B.PRODUCT_NAME='iPhone', 1, 0)) = 0"
727,Y,Y,SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON (S.PRODUCT_ID = P.PRODUCT_ID) WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES A JOIN PRODUCT B ON (A.PRODUCT_ID = B.PRODUCT_ID) AND B.PRODUCT_NAME = 'iPhone') AND P.PRODUCT_NAME ='S8' GROUP BY S.BUYER_ID
728,Y,Y,SELECT BUYER_ID FROM SALES JOIN PRODUCT USING(PRODUCT_ID) GROUP BY 1 HAVING SUM(PRODUCT_NAME = 'S8') >= 1 AND SUM(PRODUCT_NAME = 'iPhone') = 0
729,Y,Y,SELECT DISTINCT S.BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID=S.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(P.PRODUCT_NAME='S8') > 0 AND SUM(P.PRODUCT_NAME = 'iPhone') = 0
730,Y,Y,SELECT DISTINCT(BUYER_ID) FROM PRODUCT JOIN SALES USING(PRODUCT_ID) WHERE PRODUCT_NAME ='S8' AND BUYER_ID NOT IN (SELECT DISTINCT(BUYER_ID) FROM PRODUCT JOIN SALES USING(PRODUCT_ID) WHERE PRODUCT_NAME ='iPhone')
731,Y,Y,SELECT BUYER_ID FROM SALES S JOIN PRODUCT P USING(PRODUCT_ID) GROUP BY BUYER_ID HAVING SUM(PRODUCT_NAME = 'S8') > 0 AND SUM(PRODUCT_NAME = 'iPhone') =0
732,Y,Y,"WITH T AS (SELECT S.BUYER_ID, P.PRODUCT_NAME FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID) SELECT DISTINCT BUYER_ID FROM T WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM T WHERE PRODUCT_NAME = 'iPhone')"
733,Y,Y,SELECT DISTINCT BUYER_ID FROM PRODUCT P INNER JOIN SALES S ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM PRODUCT P INNER JOIN SALES S ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
734,Y,Y,SELECT DISTINCT S1.BUYER_ID FROM SALES S1 JOIN PRODUCT P1 ON S1.PRODUCT_ID = P1.PRODUCT_ID WHERE P1.PRODUCT_NAME = 'S8' AND S1.BUYER_ID NOT IN ( SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone' )
735,Y,Y,SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(CASE WHEN PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) >= 1 AND SUM(CASE WHEN PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) < 1
736,Y,Y,"WITH CTE1 AS( SELECT S.BUYER_ID, SUM(CASE WHEN P.PRODUCT_NAME='S8' THEN 1 ELSE 0 END) AS S8_FLG, SUM(CASE WHEN P.PRODUCT_NAME='iPhone' THEN 1 ELSE 0 END) AS IPHN_FLG FROM SALES AS S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID GROUP BY 1 ) SELECT BUYER_ID FROM CTE1 WHERE S8_FLG >= '1' AND IPHN_FLG='0'"
737,Y,Y,SELECT S.BUYER_ID FROM SALES AS S JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE PRODUCT.PRODUCT_NAME = 'iPhone') GROUP BY S.BUYER_ID
738,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES SS JOIN PRODUCT P ON SS.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES S WHERE S.PRODUCT_ID IN (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'iPhone'))
739,Y,Y,"WITH TEMP AS ( SELECT A.*, B.PRODUCT_NAME FROM SALES A LEFT JOIN PRODUCT B ON A.PRODUCT_ID = B.PRODUCT_ID ) SELECT DISTINCT BUYER_ID FROM TEMP WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN ( SELECT BUYER_ID FROM TEMP WHERE PRODUCT_NAME = 'iPhone' ) ORDER BY BUYER_ID"
740,Y,Y,SELECT DISTINCT SALES.BUYER_ID FROM SALES INNER JOIN PRODUCT ON SALES.PRODUCT_ID=PRODUCT.PRODUCT_ID WHERE SALES.BUYER_ID NOT IN (SELECT SALES.BUYER_ID FROM SALES INNER JOIN PRODUCT ON SALES.PRODUCT_ID=PRODUCT.PRODUCT_ID WHERE PRODUCT.PRODUCT_NAME ='iPhone') AND PRODUCT.PRODUCT_NAME ='S8'
741,Y,Y,"WITH CTE AS( SELECT S.BUYER_ID,P.PRODUCT_ID FROM SALES S, PRODUCT P WHERE P.PRODUCT_ID=S.PRODUCT_ID AND PRODUCT_NAME='iPhone' ) SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE) AND PRODUCT_ID = (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME='S8')"
742,Y,Y,SELECT DISTINCT S.BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT S.BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
743,Y,Y,"WITH TB1 AS ( SELECT A.BUYER_ID, MAX(CASE WHEN B.PRODUCT_NAME='S8' THEN 1 ELSE 0 END) AS IND_S8, MAX(CASE WHEN B.PRODUCT_NAME='iPhone' THEN 1 ELSE 0 END) AS IND_PHN FROM SALES A JOIN PRODUCT B ON A.PRODUCT_ID=B.PRODUCT_ID GROUP BY 1 ) SELECT BUYER_ID FROM TB1 WHERE IND_S8=1 AND IND_PHN=0"
744,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S1 JOIN PRODUCT P1 ON S1.PRODUCT_ID = P1.PRODUCT_ID AND P1.PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN ( SELECT DISTINCT BUYER_ID FROM SALES S1 JOIN PRODUCT P1 ON S1.PRODUCT_ID = P1.PRODUCT_ID AND P1.PRODUCT_NAME = 'iPhone')
745,Y,Y,SELECT BUYER_ID FROM PRODUCT AS A1 JOIN SALES AS A2 ON A1.PRODUCT_ID=A2.PRODUCT_ID GROUP BY 1 HAVING SUM(CASE WHEN PRODUCT_NAME='S8' THEN 1 ELSE 0 END)>0 AND SUM( CASE WHEN PRODUCT_NAME='iPhone' THEN 1 ELSE 0 END)=0
746,Y,Y,"WITH A AS (SELECT PRODUCT_NAME, BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID), B AS (SELECT DISTINCT BUYER_ID FROM A WHERE PRODUCT_NAME = 'iPhone') SELECT DISTINCT BUYER_ID FROM A WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT * FROM B)"
747,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM(CASE WHEN P.PRODUCT_NAME='iPhone' THEN 1 ELSE 0 END) = 0 AND SUM(CASE WHEN P.PRODUCT_NAME='S8' THEN 1 ELSE 0 END) >0
748,Y,Y,SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY 1 HAVING SUM(PRODUCT_NAME = 'S8')>0 AND SUM(PRODUCT_NAME ='iPhone') =0
749,Y,Y,SELECT BUYER_ID FROM SALES S JOIN PRODUCT P USING(PRODUCT_ID) GROUP BY BUYER_ID HAVING SUM(CASE WHEN PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) >= 1 AND SUM(CASE WHEN PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) = 0
750,Y,Y,SELECT BUYER_ID FROM PRODUCT JOIN SALES ON PRODUCT.PRODUCT_ID = SALES.PRODUCT_ID GROUP BY SALES.BUYER_ID HAVING SUM(PRODUCT.PRODUCT_NAME='S8')>0 AND SUM(PRODUCT.PRODUCT_NAME='iPhone')=0
751,Y,Y,SELECT DISTINCT BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID=S.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(P.PRODUCT_NAME='S8')>0 AND SUM(P.PRODUCT_NAME='iPhone')=0
752,Y,Y,"SELECT A.BUYER_ID FROM (SELECT S.BUYER_ID , P.PRODUCT_NAME FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID) A GROUP BY A.BUYER_ID HAVING SUM(CASE WHEN A.PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) >= 1 AND SUM(CASE WHEN A.PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) = 0"
753,Y,Y,SELECT DISTINCT(BUYER_ID) FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone')
754,Y,Y,SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(P.PRODUCT_NAME ='S8') >=1 AND SUM(P.PRODUCT_NAME = 'iPhone') =0
755,Y,Y,SELECT S.BUYER_ID AS BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM(P.PRODUCT_NAME='S8')>0 AND SUM(P.PRODUCT_NAME='iPhone')=0
756,Y,Y,SELECT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(CASE WHEN PRODUCT_NAME='S8' THEN 1 ELSE 0 END)>=1 AND SUM(CASE WHEN PRODUCT_NAME='iPhone' THEN 1 ELSE 0 END)=0
757,Y,Y,"WITH S8 AS (SELECT DISTINCT BUYER_ID FROM SALES LEFT JOIN PRODUCT ON SALES.PRODUCT_ID=PRODUCT.PRODUCT_ID WHERE PRODUCT_NAME='S8' ), IPHONE AS (SELECT DISTINCT BUYER_ID FROM SALES LEFT JOIN PRODUCT ON SALES.PRODUCT_ID=PRODUCT.PRODUCT_ID WHERE PRODUCT_NAME='iPhone' ) SELECT S8.BUYER_ID FROM S8 LEFT JOIN IPHONE ON S8.BUYER_ID=IPHONE.BUYER_ID WHERE IPHONE.BUYER_ID IS NULL"
758,Y,Y,SELECT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(PRODUCT_NAME='S8') > 0 AND SUM(PRODUCT_NAME='iPhone') = 0
759,Y,Y,"WITH TMP AS ( SELECT A.BUYER_ID, B.PRODUCT_NAME FROM SALES AS A JOIN PRODUCT AS B ON A.PRODUCT_ID = B.PRODUCT_ID ) SELECT DISTINCT BUYER_ID FROM TMP WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM TMP WHERE PRODUCT_NAME = 'iPhone') AND BUYER_ID IN (SELECT BUYER_ID FROM TMP WHERE PRODUCT_NAME = 'S8')"
760,Y,Y,SELECT DISTINCT(BUYER_ID) FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone')
761,Y,Y,"WITH CTE AS ( SELECT S.PRODUCT_ID, P.PRODUCT_NAME, S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID ) SELECT DISTINCT BUYER_ID FROM CTE WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'iPhone') AND CTE.PRODUCT_NAME = 'S8'"
762,Y,Y,"WITH CTE1 AS (SELECT DISTINCT A.BUYER_ID FROM SALES A INNER JOIN PRODUCT B USING (PRODUCT_ID) WHERE PRODUCT_NAME = 'S8'), CTE2 AS (SELECT DISTINCT A.BUYER_ID FROM SALES A INNER JOIN PRODUCT B USING (PRODUCT_ID) WHERE PRODUCT_NAME = 'iPhone') SELECT A.BUYER_ID FROM CTE1 A LEFT OUTER JOIN CTE2 B USING (BUYER_ID) WHERE B.BUYER_ID IS NULL"
763,Y,Y,"WITH CTE AS (SELECT P.PRODUCT_ID, P.PRODUCT_NAME, S.BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID) SELECT DISTINCT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'iPhone')"
764,Y,Y,SELECT DISTINCT A.BUYER_ID FROM SALES A LEFT JOIN PRODUCT B ON A.PRODUCT_ID =B.PRODUCT_ID WHERE B.PRODUCT_NAME ='S8' AND A.BUYER_ID NOT IN (SELECT DISTINCT C.BUYER_ID AS BUYER_ID FROM SALES C LEFT JOIN PRODUCT S ON C.PRODUCT_ID =S.PRODUCT_ID WHERE S.PRODUCT_NAME ='iPhone')
765,Y,Y,SELECT BUYER_ID FROM SALES S JOIN PRODUCT P USING(PRODUCT_ID) GROUP BY BUYER_ID HAVING SUM(CASE WHEN PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) = 0
766,Y,N,SELECT DISTINCT S.BUYER_ID FROM SALES S RIGHT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT DISTINCT S.BUYER_ID FROM SALES S RIGHT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
767,Y,Y,"WITH COMBINED AS (SELECT DISTINCT S.BUYER_ID, S.PRODUCT_ID, P.PRODUCT_NAME FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID) SELECT DISTINCT BUYER_ID FROM COMBINED WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT DISTINCT BUYER_ID FROM COMBINED WHERE PRODUCT_NAME = 'iPhone')"
768,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE S.BUYER_ID IN (SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8') AND S.BUYER_ID NOT IN(SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
769,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID IN ( SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE P.PRODUCT_NAME='S8' ) AND BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE P.PRODUCT_NAME='iPhone' )
770,Y,Y,SELECT DISTINCT BUYER_ID FROM PRODUCT P JOIN SALES S USING(PRODUCT_ID) WHERE PRODUCT_NAME='S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM PRODUCT P JOIN SALES S USING(PRODUCT_ID) WHERE PRODUCT_NAME='iPhone')
771,Y,Y,SELECT * FROM ( SELECT SALES.BUYER_ID FROM PRODUCT JOIN SALES ON PRODUCT.PRODUCT_ID=SALES.PRODUCT_ID WHERE PRODUCT.PRODUCT_NAME='S8' GROUP BY SALES.BUYER_ID ) AS T1 WHERE BUYER_ID NOT IN ( SELECT BUYER_ID FROM PRODUCT JOIN SALES ON PRODUCT.PRODUCT_ID=SALES.PRODUCT_ID WHERE PRODUCT_NAME='iPhone' GROUP BY SALES.BUYER_ID )
772,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES AS A LEFT JOIN PRODUCT AS B ON A.PRODUCT_ID=B.PRODUCT_ID WHERE B.PRODUCT_NAME='S8' AND A.BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES AS X LEFT JOIN PRODUCT AS Y ON X.PRODUCT_ID=Y.PRODUCT_ID WHERE Y.PRODUCT_NAME='iPhone')
773,Y,Y,SELECT BUYER_ID FROM SALES JOIN PRODUCT P USING(PRODUCT_ID) GROUP BY 1 HAVING SUM(PRODUCT_NAME = 'S8') > 0 AND SUM(PRODUCT_NAME = 'iPhone') = 0
774,Y,Y,WITH IPHONE AS ( SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone' ) SELECT DISTINCT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT BUYER_ID FROM IPHONE)
775,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone') AND PRODUCT_NAME = 'S8'
776,Y,Y,"WITH T1 AS (SELECT S.PRODUCT_ID, S.BUYER_ID, P.PRODUCT_NAME FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID) SELECT DISTINCT BUYER_ID FROM T1 WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM T1 WHERE PRODUCT_NAME = 'iPhone' OR PRODUCT_NAME = 'G4')"
777,Y,Y,"WITH CTE1 AS ( SELECT A.BUYER_ID FROM SALES A LEFT JOIN PRODUCT B ON A.PRODUCT_ID=B.PRODUCT_ID WHERE B.PRODUCT_NAME='S8'), CTE2 AS ( SELECT A.BUYER_ID FROM SALES A LEFT JOIN PRODUCT B ON A.PRODUCT_ID=B.PRODUCT_ID WHERE B.PRODUCT_NAME='iPhone' ) SELECT DISTINCT BUYER_ID FROM CTE1 WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE2)"
778,Y,Y,"SELECT A.BUYER_ID FROM ( SELECT A.BUYER_ID,GROUP_CONCAT(A.PRODUCT_NAME) AS GP FROM ( SELECT S.BUYER_ID,S.PRODUCT_ID,P.PRODUCT_NAME FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID ORDER BY 1) A GROUP BY 1 ORDER BY 1) A WHERE A.GP LIKE '%S8%' AND A.GP NOT LIKE '%IPHONE%'"
779,Y,Y,"WITH GET_ALL AS ( SELECT A.BUYER_ID, B.PRODUCT_NAME FROM SALES A JOIN PRODUCT B ON A.PRODUCT_ID = B.PRODUCT_ID ), GET_S8 AS ( SELECT BUYER_ID FROM GET_ALL WHERE PRODUCT_NAME = 'S8' GROUP BY BUYER_ID ), GET_IPHONE AS ( SELECT BUYER_ID FROM GET_ALL WHERE PRODUCT_NAME = 'iPhone' GROUP BY BUYER_ID ) SELECT * FROM GET_S8 WHERE BUYER_ID NOT IN (SELECT * FROM GET_IPHONE)"
780,Y,Y,"WITH CTE AS (SELECT S.BUYER_ID, P.PRODUCT_NAME FROM SALES AS S JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' OR PRODUCT_NAME = 'iPhone') SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'iPhone')"
781,Y,Y,"SELECT B.BUYER_ID FROM ( SELECT A.BUYER_ID , SUM(CASE WHEN A.PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) AS S8 , SUM(CASE WHEN A.PRODUCT_NAME = 'G4' THEN 1 ELSE 0 END) AS G4 , SUM(CASE WHEN A.PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) AS IPHONE FROM (SELECT S.BUYER_ID , P.PRODUCT_NAME FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID) A GROUP BY A.BUYER_ID) B WHERE B.S8 >= 1 AND B.IPHONE = 0"
782,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES AS S LEFT JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES AS S LEFT JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone')
783,Y,Y,SELECT A.BUYER_ID FROM (SELECT DISTINCT BUYER_ID FROM SALES WHERE PRODUCT_ID=(SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME='S8'))A LEFT JOIN (SELECT DISTINCT BUYER_ID FROM SALES WHERE PRODUCT_ID=(SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME='iPhone')) B ON A.BUYER_ID=B.BUYER_ID WHERE B.BUYER_ID IS NULL
784,Y,Y,"WITH CTE1 AS ( SELECT A.PRODUCT_NAME,B.* FROM PRODUCT A JOIN SALES B ON A.PRODUCT_ID =B.PRODUCT_ID ) SELECT DISTINCT BUYER_ID FROM CTE1 WHERE BUYER_ID NOT IN (SELECT DISTINCT BUYER_ID FROM CTE1 WHERE PRODUCT_NAME = 'iPhone') AND PRODUCT_NAME = 'S8'"
785,Y,Y,SELECT DISTINCT BUYER_ID FROM PRODUCT A INNER JOIN SALES B ON A.PRODUCT_ID=B.PRODUCT_ID WHERE PRODUCT_NAME='S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM PRODUCT A INNER JOIN SALES B ON A.PRODUCT_ID=B.PRODUCT_ID WHERE PRODUCT_NAME='iPhone')
786,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND NOT EXISTS(SELECT S2.BUYER_ID FROM SALES S2 INNER JOIN PRODUCT P2 ON S2.PRODUCT_ID = P2.PRODUCT_ID AND P2.PRODUCT_NAME = 'iPhone' AND S2.BUYER_ID=S.BUYER_ID)
787,Y,Y,"WITH CTE AS (SELECT S.PRODUCT_ID, P.PRODUCT_NAME, BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID) SELECT DISTINCT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'iPhone')"
788,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES AS S INNER JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN ( SELECT S1.BUYER_ID FROM SALES AS S1 INNER JOIN PRODUCT AS P1 ON S1.PRODUCT_ID = P1.PRODUCT_ID WHERE P1.PRODUCT_NAME = 'iPhone' )
789,Y,Y,"SELECT P.BUYER_ID FROM( SELECT SALES.BUYER_ID , GROUP_CONCAT(PRODUCT.PRODUCT_NAME) AS PRODUCTS FROM SALES LEFT JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID GROUP BY SALES.BUYER_ID HAVING PRODUCTS NOT LIKE '%IPHONE%' AND PRODUCTS LIKE '%S8%') AS P"
790,Y,Y,"WITH CTE AS (SELECT BUYER_ID,PRODUCT_NAME FROM SALES AS S INNER JOIN PRODUCT AS P ON S.PRODUCT_ID=P.PRODUCT_ID GROUP BY BUYER_ID,PRODUCT_NAME) SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'iPhone')"
791,Y,Y,"WITH TEMP_TABLE AS ( SELECT P.PRODUCT_NAME, S.BUYER_ID FROM PRODUCT AS P INNER JOIN SALES AS S ON P.PRODUCT_ID = S.PRODUCT_ID ) SELECT DISTINCT BUYER_ID FROM TEMP_TABLE WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN ( SELECT BUYER_ID FROM TEMP_TABLE WHERE PRODUCT_NAME = 'iPhone' )"
792,Y,Y,SELECT BUYER_ID FROM PRODUCT A JOIN SALES B ON A.PRODUCT_ID = B.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(A.PRODUCT_NAME = 'S8') > 0 AND SUM(A.PRODUCT_NAME = 'iPhone') = 0
793,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT DISTINCT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
794,Y,Y,WITH S8 AS (SELECT BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE PRODUCT_NAME = 'S8') SELECT DISTINCT BUYER_ID FROM S8 WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone')
795,Y,Y,SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone') GROUP BY BUYER_ID
796,Y,Y,"WITH CTE AS( SELECT BUYER_ID,PRODUCT_NAME FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID) SELECT DISTINCT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'iPhone')"
797,Y,Y,SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P USING(PRODUCT_ID) GROUP BY 1 HAVING SUM(CASE WHEN P.PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) >0 AND SUM(CASE WHEN P.PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) = 0
798,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID IN (SELECT S.BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' ) AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone' )
799,Y,Y,SELECT BUYER_ID FROM SALES SAL JOIN PRODUCT PRD ON SAL.PRODUCT_ID = PRD.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(PRD.PRODUCT_NAME ='S8') >= 1 AND SUM(PRD.PRODUCT_NAME = 'iPhone') = 0
800,Y,Y,"WITH T1 AS ( SELECT SALES.BUYER_ID, PRODUCT.PRODUCT_NAME FROM SALES LEFT OUTER JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE (PRODUCT_NAME = 'S8') OR (PRODUCT_NAME = 'iPhone') ), T2 AS ( SELECT BUYER_ID FROM T1 WHERE PRODUCT_NAME = 'S8' ), T3 AS ( SELECT BUYER_ID FROM T1 WHERE PRODUCT_NAME = 'iPhone' ) SELECT DISTINCT BUYER_ID FROM T2 WHERE BUYER_ID NOT IN (SELECT * FROM T3) ORDER BY BUYER_ID"
801,Y,Y,"WITH BUYER_PRODUCTS AS( SELECT S.BUYER_ID, GROUP_CONCAT(PRODUCT_NAME) PRODUCTS FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID GROUP BY BUYER_ID ) SELECT BP.BUYER_ID FROM BUYER_PRODUCTS BP WHERE BP.PRODUCTS LIKE '%S8%' AND BP.PRODUCTS NOT LIKE '%IPHONE%'"
802,Y,Y,"WITH A AS (SELECT S.PRODUCT_ID,S.BUYER_ID,P.PRODUCT_NAME FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID) SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID = ANY (SELECT BUYER_ID FROM A WHERE PRODUCT_NAME = 'S8') AND BUYER_ID <> ALL (SELECT BUYER_ID FROM A WHERE PRODUCT_NAME = 'iPhone')"
803,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES JOIN PRODUCT ON SALES.PRODUCT_ID= PRODUCT.PRODUCT_ID WHERE PRODUCT_NAME LIKE S8 AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES JOIN PRODUCT ON SALES.PRODUCT_ID=PRODUCT.PRODUCT_ID WHERE PRODUCT_NAME LIKE IPHONE )
804,Y,Y,"WITH A AS ( SELECT PRODUCT_NAME , BUYER_ID FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID=S.PRODUCT_ID) SELECT DISTINCT BUYER_ID FROM A WHERE PRODUCT_NAME='S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM A WHERE PRODUCT_NAME='iPhone')"
805,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE P.PRODUCT_NAME='S8' AND S.BUYER_ID NOT IN (SELECT DISTINCT A.BUYER_ID FROM SALES A JOIN PRODUCT B ON A.PRODUCT_ID=B.PRODUCT_ID WHERE B.PRODUCT_NAME='iPhone')
806,Y,Y,SELECT BUYER_ID FROM PRODUCT A JOIN SALES B USING(PRODUCT_ID) GROUP BY BUYER_ID HAVING SUM(PRODUCT_NAME = 'S8') > 0 AND SUM(PRODUCT_NAME = 'iPhone') = 0
807,Y,Y,"WITH CTEB AS( SELECT S.BUYER_ID, P.PRODUCT_NAME FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID ) SELECT DISTINCT BUYER_ID FROM CTEB WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM CTEB WHERE PRODUCT_NAME ='iPhone')"
808,Y,Y,WITH NOIPHONE AS(SELECT DISTINCT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone') SELECT DISTINCT BUYER_ID FROM SALES S1 LEFT JOIN PRODUCT P1 ON S1.PRODUCT_ID = P1.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM NOIPHONE)
809,Y,Y,"SELECT DISTINCT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT S.BUYER_ID FROM SALES S, PRODUCT P WHERE P.PRODUCT_ID = S.PRODUCT_ID AND P.PRODUCT_NAME = 'iPhone')"
810,Y,Y,"WITH TT AS (SELECT S.BUYER_ID, P.PRODUCT_NAME FROM SALES AS S INNER JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' OR P.PRODUCT_NAME = 'iPhone') SELECT DISTINCT BUYER_ID FROM TT WHERE TT.BUYER_ID NOT IN (SELECT DISTINCT BUYER_ID FROM TT WHERE PRODUCT_NAME = 'iPhone')"
811,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT DISTINCT BUYER_ID FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID=S.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone')
812,Y,N,"SELECT DISTINCT BUYER_ID FROM ( SELECT A.*,B.BUYER_ID FROM PRODUCT A LEFT JOIN SALES B ON A.PRODUCT_ID=B.PRODUCT_ID )C WHERE PRODUCT_NAME='S8' AND BUYER_ID NOT IN (SELECT DISTINCT BUYER_ID FROM ( SELECT A.*,B.BUYER_ID FROM PRODUCT A LEFT JOIN SALES B ON A.PRODUCT_ID=B.PRODUCT_ID )A WHERE PRODUCT_NAME='iPhone')"
813,Y,Y,"WITH PRODUCTS_BOUGHT AS ( SELECT BUYER_ID , CASE WHEN PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END AS S8 , CASE WHEN PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END AS IPHONE FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID ) , BUYER_SUMMARY AS ( SELECT BUYER_ID , SUM(S8) AS S8 , SUM(IPHONE) AS IPHONE FROM PRODUCTS_BOUGHT GROUP BY 1 ) SELECT BUYER_ID FROM BUYER_SUMMARY WHERE S8 >= 1 AND IPHONE = 0"
814,Y,Y,SELECT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone') GROUP BY BUYER_ID
815,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN ( SELECT S.BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME IN ('iPhone'))
816,Y,Y,"SELECT BUYER_ID FROM (SELECT BUYER_ID, SUM(PRODUCT_NAME = 'S8') AS TOTAL_S8, SUM(PRODUCT_NAME = 'iPhone') AS TOTAL_IPHONE FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY BUYER_ID)SUB WHERE TOTAL_S8 > 0 AND TOTAL_IPHONE = 0"
817,Y,Y,"WITH T AS (SELECT S.BUYER_ID, P.PRODUCT_NAME FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID) SELECT DISTINCT BUYER_ID FROM T WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT DISTINCT BUYER_ID FROM T WHERE PRODUCT_NAME = 'iPhone')"
818,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES AS S LEFT JOIN PRODUCT AS P ON S.PRODUCT_ID=P.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM(P.PRODUCT_NAME='S8')>=1 AND SUM(P.PRODUCT_NAME='iPhone')=0
819,Y,Y,"WITH A AS( SELECT S.BUYER_ID, P.PRODUCT_NAME FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID) SELECT BUYER_ID FROM A GROUP BY BUYER_ID HAVING SUM(CASE WHEN PRODUCT_NAME='S8' THEN 1 ELSE 0 END)>=1 AND SUM(CASE WHEN PRODUCT_NAME='iPhone' THEN 1 ELSE 0 END)=0"
820,Y,Y,SELECT S.BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN ( SELECT DISTINCT S1.BUYER_ID FROM SALES S1 INNER JOIN PRODUCT P1 ON P1.PRODUCT_ID = S1.PRODUCT_ID WHERE P1.PRODUCT_NAME = 'iPhone') GROUP BY S.BUYER_ID
821,Y,Y,"SELECT BUYER_ID FROM (SELECT BUYER_ID, SUM(CASE WHEN PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) AS IPHONE, SUM(CASE WHEN PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) AS S8 FROM SALES AS S LEFT JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY BUYER_ID HAVING S8 > 0 AND IPHONE = 0) T"
822,Y,Y,"WITH CTE1 AS (SELECT SALES.BUYER_ID,SALES.PRODUCT_ID FROM SALES LEFT JOIN (SELECT BUYER_ID,PRODUCT_NAME,PRODUCT.PRODUCT_ID FROM SALES INNER JOIN PRODUCT ON SALES.PRODUCT_ID =PRODUCT.PRODUCT_ID WHERE PRODUCT.PRODUCT_NAME ='iPhone') AS P ON SALES.BUYER_ID =P.BUYER_ID WHERE P.BUYER_ID IS NULL ) SELECT DISTINCT CTE1.BUYER_ID AS BUYER_ID FROM CTE1 LEFT JOIN PRODUCT ON CTE1.PRODUCT_ID =PRODUCT.PRODUCT_ID WHERE PRODUCT.PRODUCT_NAME='S8'"
823,Y,N,"WITH CTE AS ( SELECT BUYER_ID, PRODUCT_NAME FROM PRODUCT P LEFT JOIN SALES S ON S.PRODUCT_ID = P.PRODUCT_ID) SELECT DISTINCT(BUYER_ID) FROM CTE WHERE BUYER_ID IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'iPhone')"
824,Y,Y,"WITH SALES1 AS( SELECT A.PRODUCT_ID, A.BUYER_ID, PRODUCT_NAME FROM SALES A LEFT JOIN PRODUCT B ON A.PRODUCT_ID =B.PRODUCT_ID) SELECT DISTINCT BUYER_ID FROM SALES1 WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES1 WHERE PRODUCT_NAME='iPhone') AND PRODUCT_NAME='S8'"
825,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES LEFT JOIN PRODUCT USING(PRODUCT_ID) WHERE PRODUCT_NAME = 'S8' AND SALES.BUYER_ID NOT IN (SELECT SALES.BUYER_ID FROM SALES LEFT JOIN PRODUCT USING(PRODUCT_ID) WHERE PRODUCT_NAME = 'iPhone')
826,Y,Y,SELECT S.BUYER_ID AS BUYER_ID FROM SALES AS S JOIN PRODUCT AS P ON P.PRODUCT_ID = S.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM(P.PRODUCT_NAME = 'S8') > 0 AND SUM(P.PRODUCT_NAME = 'iPhone') = 0
827,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES A JOIN PRODUCT B ON A.PRODUCT_ID = B.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN( SELECT BUYER_ID FROM SALES C JOIN PRODUCT D ON C.PRODUCT_ID = D.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone' )
828,Y,Y,SELECT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE BUYER_ID NOT IN (SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone') AND P.PRODUCT_NAME = 'S8' GROUP BY S.BUYER_ID
829,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT DISTINCT BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone')
830,Y,Y,SELECT DISTINCT S.BUYER_ID FROM PRODUCT P JOIN SALES S ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN ( SELECT S.BUYER_ID FROM PRODUCT P JOIN SALES S ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone' )
831,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES WHERE PRODUCT_ID = (SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME = 'iPhone'))
832,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone' OR PRODUCT_NAME = 'S8' GROUP BY BUYER_ID HAVING COUNT(DISTINCT PRODUCT_NAME) = 1 AND MIN(PRODUCT_NAME) = 'S8'
833,Y,Y,"WITH CTE AS ( SELECT S.PRODUCT_ID, S.BUYER_ID, P.PRODUCT_NAME FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID) SELECT DISTINCT BUYER_ID FROM CTE WHERE BUYER_ID NOT IN ( SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'iPhone') AND PRODUCT_NAME = 'S8'"
834,Y,Y,SELECT DISTINCT SALES.BUYER_ID FROM SALES JOIN PRODUCT WHERE SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID AND PRODUCT.PRODUCT_NAME = 'S8' AND SALES.BUYER_ID NOT IN ( SELECT SALES.BUYER_ID FROM SALES JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE PRODUCT.PRODUCT_NAME = 'iPhone' )
835,Y,Y,"WITH JOINEDTABLE AS (SELECT BUYER_ID, PRODUCT_NAME FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID=S.PRODUCT_ID) SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID IN (SELECT DISTINCT BUYER_ID FROM JOINEDTABLE WHERE PRODUCT_NAME LIKE S8 ) AND BUYER_ID NOT IN (SELECT DISTINCT BUYER_ID FROM JOINEDTABLE WHERE PRODUCT_NAME LIKE IPHONE )"
836,Y,Y,WITH CTE AS (SELECT BUYER_ID FROM SALES AS S LEFT JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8') SELECT DISTINCT S.BUYER_ID FROM CTE AS S WHERE S.BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES AS S LEFT JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
837,Y,Y,"WITH T1 AS ( SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' ), T2 AS ( SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone' ) SELECT T1.BUYER_ID FROM T1 WHERE T1.BUYER_ID NOT IN (SELECT * FROM T2)"
838,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN( SELECT DISTINCT BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone')
839,Y,Y,"WITH CTE AS (SELECT DISTINCT SALES.BUYER_ID AS BUYER_IPHONE FROM SALES LEFT JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone') , CTE1 AS( SELECT DISTINCT SALES.BUYER_ID AS BUYER_S8 FROM SALES LEFT JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID WHERE PRODUCT_NAME = 'S8') SELECT CTE1.BUYER_S8 AS BUYER_ID FROM CTE1 LEFT JOIN CTE ON CTE.BUYER_IPHONE = CTE1.BUYER_S8 WHERE BUYER_IPHONE IS NULL"
840,Y,Y,SELECT DISTINCT S1.BUYER_ID FROM SALES S1 WHERE EXISTS ( SELECT P.PRODUCT_NAME FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE S1.BUYER_ID = S.BUYER_ID AND P.PRODUCT_NAME = 'S8' ) AND NOT EXISTS ( SELECT P.PRODUCT_NAME FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE S1.BUYER_ID = S.BUYER_ID AND P.PRODUCT_NAME = 'iPhone' )
841,Y,Y,"WITH CTE AS(SELECT BUYER_ID, A.PRODUCT_ID, PRODUCT_NAME FROM SALES A JOIN PRODUCT B ON A.PRODUCT_ID=B.PRODUCT_ID) SELECT DISTINCT BUYER_ID FROM CTE WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME='iPhone') AND PRODUCT_NAME='S8'"
842,Y,Y,"WITH CTE AS ( SELECT BUYER_ID, PRODUCT_NAME FROM SALES JOIN PRODUCT USING(PRODUCT_ID) ) SELECT BUYER_ID FROM CTE GROUP BY 1 HAVING SUM(PRODUCT_NAME='S8')>0 AND SUM(PRODUCT_NAME='iPhone')=0"
843,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND S.BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES INNER JOIN PRODUCT ON PRODUCT.PRODUCT_ID = SALES.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone')
844,Y,Y,"WITH T0 AS ( SELECT S.BUYER_ID,P.PRODUCT_NAME FROM SALES S, PRODUCT P WHERE S.PRODUCT_ID = P.PRODUCT_ID ) SELECT BUYER_ID FROM T0 GROUP BY BUYER_ID HAVING (BUYER_ID,'S8') IN (SELECT * FROM T0) AND (BUYER_ID,'iPhone') NOT IN (SELECT * FROM T0)"
845,Y,Y,SELECT DISTINCT S.BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' AND NOT EXISTS ( SELECT 1 FROM SALES S2 INNER JOIN PRODUCT P2 ON P2.PRODUCT_ID = S2.PRODUCT_ID WHERE P2.PRODUCT_NAME = 'iPhone' AND S2.BUYER_ID = S.BUYER_ID )
846,Y,Y,SELECT S.BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM(CASE WHEN P.PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN P.PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) = 0
847,Y,Y,"WITH S8 AS ( SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE LOWER(PRODUCT_NAME) LIKE S8 GROUP BY 1 ), IPHONE AS ( SELECT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE LOWER(PRODUCT_NAME) LIKE IPHONE GROUP BY 1 ) SELECT * FROM S8 WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM IPHONE)"
848,Y,Y,SELECT BUYER_ID FROM SALES AS S JOIN PRODUCT AS P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(P.PRODUCT_NAME = 'S8') > 0 AND SUM(P.PRODUCT_NAME = 'iPhone') = 0
849,Y,Y,"SELECT BUYER_ID FROM ( SELECT BUYER_ID, SUM(PRODUCT_NAME='S8') AS S_S8, SUM(PRODUCT_NAME = 'iPhone') AS S_IPHONE FROM ( SELECT S.BUYER_ID, P.PRODUCT_NAME FROM PRODUCT P JOIN SALES S ON P.PRODUCT_ID = S.PRODUCT_ID) X GROUP BY BUYER_ID ) Y WHERE S_S8 > 0 AND S_IPHONE = 0"
850,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM SALES S1 JOIN PRODUCT P1 ON P1.PRODUCT_ID = S1.PRODUCT_ID WHERE PRODUCT_NAME = 'iPhone')
851,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES SA LEFT JOIN PRODUCT P ON SA.PRODUCT_ID = P.PRODUCT_ID WHERE BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES SA LEFT JOIN PRODUCT P ON SA.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone' ) AND P.PRODUCT_NAME = 'S8'
852,Y,Y,"WITH C1 AS ( SELECT S.*, P.PRODUCT_NAME, P.UNIT_PRICE FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID) SELECT BUYER_ID FROM (SELECT BUYER_ID, SUM(CASE WHEN PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) AS S8, SUM(CASE WHEN PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) AS IPHONE FROM C1 GROUP BY BUYER_ID)Q WHERE S8 >= 1 AND IPHONE = 0"
853,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID IN (SELECT BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' ) AND BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES S INNER JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone' )
854,Y,Y,"WITH CTE AS ( SELECT S.* , P.PRODUCT_NAME FROM SALES AS S INNER JOIN PRODUCT AS P ON P.PRODUCT_ID = S.PRODUCT_ID) SELECT DISTINCT BUYER_ID FROM CTE WHERE BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'iPhone') AND BUYER_ID IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'S8')"
855,Y,Y,WITH A AS (SELECT * FROM PRODUCT AS P INNER JOIN SALES AS S USING(PRODUCT_ID)) SELECT DISTINCT BUYER_ID FROM A WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM A WHERE PRODUCT_NAME = 'iPhone')
856,Y,Y,SELECT S.BUYER_ID FROM PRODUCT P JOIN SALES S ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM(P.PRODUCT_NAME = 'S8') > 0 AND SUM(P.PRODUCT_NAME = 'iPhone') = 0
857,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE PRODUCT_NAME ='S8' AND BUYER_ID NOT IN (SELECT S.BUYER_ID FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
858,Y,Y,"WITH A AS ( SELECT BUYER_ID, SUM(CASE WHEN PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) AS S8FLAG, SUM(CASE WHEN PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) AS IPFLAG FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY BUYER_ID) SELECT BUYER_ID FROM A WHERE S8FLAG >= 1 AND IPFLAG = 0"
859,Y,Y,SELECT DISTINCT(BUYER_ID) FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT DISTINCT(BUYER_ID) FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
860,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID NOT IN ( SELECT BUYER_ID FROM SALES WHERE PRODUCT_ID IN ( SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME='iPhone' ) ) AND BUYER_ID IN ( SELECT BUYER_ID FROM SALES WHERE PRODUCT_ID IN ( SELECT PRODUCT_ID FROM PRODUCT WHERE PRODUCT_NAME='S8' ) )
861,Y,Y,SELECT A.BUYER_ID FROM SALES A LEFT JOIN PRODUCT B ON A.PRODUCT_ID = B.PRODUCT_ID GROUP BY 1 HAVING SUM(CASE WHEN B.PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN B.PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) = 0
862,Y,Y,"SELECT BUYER_ID FROM (SELECT BUYER_ID, SUM(CASE WHEN PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) AS BUYS8 , SUM(CASE WHEN PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) AS BUYIPHONE FROM (SELECT S.BUYER_ID, S.PRODUCT_ID, P.PRODUCT_NAME FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID) T1 GROUP BY BUYER_ID) T2 WHERE BUYS8 >0 AND BUYIPHONE = 0"
863,Y,Y,"SELECT BUYER_ID FROM ( SELECT BUYER_ID, SUM(CASE WHEN PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) AS TI, SUM(CASE WHEN PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) AS TS8 FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY BUYER_ID ) A WHERE TI=0 AND TS8>0"
864,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES AS S JOIN PRODUCT AS P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE P.PRODUCT_NAME LIKE S8 AND BUYER_ID NOT IN( SELECT BUYER_ID FROM SALES AS S JOIN PRODUCT AS P ON S.PRODUCT_ID=P.PRODUCT_ID WHERE P.PRODUCT_NAME LIKE IPHONE )
865,Y,Y,SELECT S.BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY S.BUYER_ID HAVING SUM(P.PRODUCT_NAME = 'S8') > 0 AND SUM(P.PRODUCT_NAME = 'iPhone') = 0 AND SUM(P.PRODUCT_NAME='G4') = 0
866,Y,Y,WITH CTE AS (SELECT S.BUYER_ID AS BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'S8') SELECT DISTINCT BUYER_ID FROM CTE WHERE BUYER_ID NOT IN (SELECT S.BUYER_ID AS BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID WHERE P.PRODUCT_NAME = 'iPhone')
867,Y,Y,"SELECT BUYER_ID FROM ( SELECT S.BUYER_ID, SUM(CASE WHEN P.PRODUCT_NAME = 'S8' THEN 0 WHEN P.PRODUCT_NAME = 'iPhone' THEN 1 ELSE NULL END) AS FLAG FROM SALES S INNER JOIN PRODUCT P ON P.PRODUCT_ID = S.PRODUCT_ID GROUP BY 1 )T WHERE FLAG = 0"
868,Y,Y,"WITH CTE AS ( SELECT SALES.BUYER_ID,PRODUCT.* FROM SALES JOIN PRODUCT ON SALES.PRODUCT_ID = PRODUCT.PRODUCT_ID) SELECT DISTINCT BUYER_ID FROM SALES WHERE BUYER_ID IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'iPhone')"
869,Y,Y,SELECT BUYER_ID FROM SALES AS S INNER JOIN PRODUCT AS P ON S.PRODUCT_ID=P.PRODUCT_ID GROUP BY BUYER_ID HAVING SUM(P.PRODUCT_NAME = 'S8') > 0 AND SUM(P.PRODUCT_NAME = 'iPhone') = 0
870,Y,Y,SELECT DISTINCT BUYER_ID FROM SALES S JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID GROUP BY 1 HAVING SUM(CASE WHEN PRODUCT_NAME = 'S8' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN PRODUCT_NAME = 'iPhone' THEN 1 ELSE 0 END) = 0
871,Y,Y,"WITH CTE AS( SELECT S.BUYER_ID, P.PRODUCT_NAME FROM PRODUCT AS P JOIN SALES AS S ON P.PRODUCT_ID = S.PRODUCT_ID) SELECT DISTINCT BUYER_ID FROM CTE WHERE BUYER_ID IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'iPhone')"
872,Y,Y,"WITH CTE AS ( SELECT S.BUYER_ID,P.PRODUCT_NAME FROM SALES S LEFT OUTER JOIN PRODUCT P ON (S.PRODUCT_ID=P.PRODUCT_ID) ) SELECT DISTINCT BUYER_ID FROM CTE WHERE BUYER_ID IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'S8') AND BUYER_ID NOT IN (SELECT BUYER_ID FROM CTE WHERE PRODUCT_NAME = 'iPhone')"
873,Y,Y,"WITH T AS( SELECT S.*, P.PRODUCT_NAME FROM SALES S LEFT JOIN PRODUCT P ON S.PRODUCT_ID = P.PRODUCT_ID) SELECT DISTINCT BUYER_ID FROM T WHERE PRODUCT_NAME = 'S8' AND BUYER_ID NOT IN (SELECT BUYER_ID FROM T WHERE PRODUCT_NAME = 'iPhone')"
