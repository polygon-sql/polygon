qid,mysql_can_execute?,mysql_correct?,mysql_query
0,Y,Y,"SELECT ROUND(SUM(TIV_2016), 2) AS TIV_2016 FROM ( SELECT PID, TIV_2016, COUNT(*) OVER(PARTITION BY TIV_2015) AS TIV2015_COUNT, COUNT(*) OVER(PARTITION BY LAT, LON) AS LOC_COUNT FROM INSURANCE ) AS TEMP WHERE TIV2015_COUNT > 1 AND LOC_COUNT = 1"
1,Y,Y,"SELECT ROUND(SUM(TIV_2016), 2) AS TIV_2016 FROM INSURANCE WHERE PID IN (SELECT PID FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*) = 1) AND PID NOT IN (SELECT PID FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) = 1)"
2,Y,Y,"SELECT ROUND(SUM(TIV_2016), 2) AS TIV_2016 FROM INSURANCE WHERE PID NOT IN (SELECT PID FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(TIV_2015) <= 1 UNION SELECT I1.PID FROM INSURANCE I1 JOIN INSURANCE I2 ON I1.LAT = I2.LAT AND I1.LON = I2.LON AND I1.PID <> I2.PID)"
3,Y,Y,"SELECT ROUND(SUM(TIV_2016), 2) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN ( SELECT TIV_2015 FROM INSURANCE GROUP BY 1 HAVING COUNT(*) > 1 ) AND CONCAT(LAT, '-', LON) IN ( SELECT CONCAT(LAT, '-', LON) FROM INSURANCE GROUP BY 1 HAVING COUNT(*) = 1 )"
4,Y,Y,"SELECT ROUND(SUM(TIV_2016), 2) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) > 1 ) AND (LAT, LON) IN ( SELECT LAT, LON FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*) = 1 )"
5,Y,Y,"SELECT ROUND(SUM(TIV_2016), 2) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*)>=2 ) AND (LAT, LON) IN ( SELECT LAT, LON FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*)=1 )"
6,Y,Y,"SELECT ROUND(SUM(TIV_2016), 2) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(TIV_2015) > 1 ) AND CONCAT(LAT, LON) IN ( SELECT CONCAT(LAT, LON) FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*) = 1 )"
7,Y,Y,"SELECT ROUND(SUM(TIV_2016), 2) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*)>1) AND CONCAT(LAT, LON) IN (SELECT CONCAT(LAT,LON) FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*)=1)"
8,Y,Y,"SELECT ROUND(SUM(TIV_2016), 2) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(TIV_2015) > 1) AND (LAT, LON) IN (SELECT LAT, LON FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*) = 1)"
9,Y,Y,"SELECT ROUND(SUM(TIV_2016), 2) AS TIV_2016 FROM INSURANCE AS I WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(TIV_2015)>=2) AND (LAT, LON) NOT IN (SELECT LAT, LON FROM INSURANCE GROUP BY CONCAT(LAT, LON) HAVING COUNT(CONCAT(LAT,LON))>=2)"
10,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM ( SELECT TIV_2016, COUNT(PID) OVER (PARTITION BY TIV_2015) AS 2015_COUNT, COUNT(PID) OVER (PARTITION BY LAT, LON) AS LOCATION_COUNT FROM INSURANCE ) AS TABLE1 WHERE 2015_COUNT >1 AND LOCATION_COUNT=1"
11,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM (SELECT *, COUNT(*) OVER(PARTITION BY TIV_2015) AS CNT1, COUNT(*) OVER(PARTITION BY LAT, LON) AS CNT2 FROM INSURANCE ) AS TBL WHERE TBL.CNT1 >=2 AND TBL.CNT2 =1"
12,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM (SELECT *, COUNT(PID) OVER (PARTITION BY TIV_2015) AS IV_OCCURENCE, COUNT(PID) OVER (PARTITION BY LAT,LON) AS LOCATION_OCCURENCE FROM INSURANCE) AS T WHERE IV_OCCURENCE > 1 AND LOCATION_OCCURENCE = 1"
13,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE A WHERE EXISTS (SELECT * FROM INSURANCE WHERE PID <> A.PID AND TIV_2015 = A.TIV_2015) AND NOT EXISTS (SELECT * FROM INSURANCE WHERE PID <> A.PID AND (LAT,LON) = (A.LAT,A.LON))"
14,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE A WHERE EXISTS (SELECT TIV_2016 FROM INSURANCE WHERE PID <> A.PID AND TIV_2015 = A.TIV_2015) AND NOT EXISTS (SELECT TIV_2016 FROM INSURANCE WHERE PID <> A.PID AND (LAT,LON) = (A.LAT,A.LON))"
15,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY 1 HAVING COUNT(*) > 1) AND (LAT,LON) IN (SELECT LAT ,LON FROM INSURANCE GROUP BY 1,2 HAVING COUNT(*) = 1 )"
16,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE A WHERE (SELECT COUNT(*) FROM INSURANCE B WHERE A.TIV_2015 = B.TIV_2015) >1 AND (SELECT COUNT(*) FROM INSURANCE C WHERE (A.LAT,A.LON) = (C.LAT,C.LON)) =1"
17,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE I1 WHERE EXISTS (SELECT * FROM INSURANCE I2 WHERE I1.PID <> I2.PID AND I1.TIV_2015 = I2.TIV_2015) AND NOT EXISTS (SELECT * FROM INSURANCE I3 WHERE I1.PID <> I3.PID AND I1.LAT = I3.LAT AND I1.LON = I3.LON)"
18,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY 1 HAVING COUNT(*)>1) AND CONCAT(LAT,LON) IN (SELECT CONCAT(LAT,LON) FROM INSURANCE GROUP BY 1 HAVING COUNT(*)=1)"
19,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE WHERE PID IN (SELECT DISTINCT(A.PID) FROM INSURANCE A JOIN INSURANCE B ON A.PID <> B.PID WHERE (A.TIV_2015) = (B.TIV_2015) AND A.PID NOT IN ( SELECT DISTINCT(A.PID) FROM INSURANCE A JOIN INSURANCE B ON A.PID <> B.PID WHERE (A.LAT, A.LON) = (B.LAT, B.LON) ) )"
20,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE WHERE (LAT, LON) NOT IN ( SELECT LAT, LON FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*) > 1 ) AND TIV_2015 IN ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) > 1 )"
21,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(1) > 1) AND (LAT, LON ) IN (SELECT LAT, LON FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(1)=1)"
22,Y,Y,"SELECT ROUND(SUM(INSURANCE.TIV_2016),2) AS TIV_2016 FROM INSURANCE WHERE INSURANCE.TIV_2015 IN ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) > 1 ) AND (LAT, LON) IN ( SELECT LAT, LON FROM INSURANCE GROUP BY LAT , LON HAVING COUNT(*) = 1 )"
23,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM ( SELECT I1.*, I2.C1, I3.C2 FROM INSURANCE I1 JOIN ( SELECT TIV_2015, COUNT(*) AS C1 FROM INSURANCE I2 GROUP BY TIV_2015 )AS I2 ON I2.TIV_2015 = I1.TIV_2015 JOIN ( SELECT LAT, LON, COUNT(*) AS C2 FROM INSURANCE I2 GROUP BY LAT, LON )AS I3 ON I3.LAT = I1.LAT AND I3.LON = I1.LON ) AS X WHERE X.C1 > 1 AND X.C2 = 1"
24,Y,Y,"SELECT SUM( I1.TIV_2016 ) AS TIV_2016 FROM INSURANCE AS I1 LEFT JOIN ( SELECT PID, COUNT( * ) OVER( PARTITION BY CONCAT( LAT, ' ', LON ) ) AS COUNT_LAT_LON, COUNT( * ) OVER( PARTITION BY TIV_2015 ) AS COUNT_2015 FROM INSURANCE ) AS I2 ON I1.PID = I2.PID WHERE I2.COUNT_LAT_LON = 1 AND I2.COUNT_2015 >1"
25,Y,Y,"SELECT SUM(BASE.TIV_2016) AS TIV_2016 FROM ( SELECT A.PID, A.TIV_2016 FROM (SELECT * FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM (SELECT TIV_2015, COUNT(*) AS N FROM INSURANCE GROUP BY TIV_2015)BASE15 WHERE N>1) ) A LEFT JOIN INSURANCE B ON A.PID !=B.PID AND A.LAT=B.LAT AND A.LON=B.LON WHERE B.PID IS NULL )BASE"
26,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM ( SELECT *, COUNT(*) OVER (PARTITION BY LAT, LON) AS LOC, COUNT(*) OVER (PARTITION BY TIV_2015) AS TIV FROM INSURANCE ) AS TEMP WHERE LOC=1 AND TIV>1"
27,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM (SELECT PID, TIV_2015, TIV_2016, COUNT(*) OVER(PARTITION BY TIV_2015) AS CNT, COUNT(*) OVER(PARTITION BY CONCAT(LAT, ',',LON)) AS LOC_CNT FROM INSURANCE) T WHERE CNT > 1 AND LOC_CNT = 1"
28,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM (SELECT TIV_2016, COUNT(TIV_2015) OVER (PARTITION BY TIV_2015) AS CNT2015, COUNT(*) OVER (PARTITION BY LAT, LON) AS CNTLOC FROM INSURANCE) T WHERE CNT2015 > 1 AND CNTLOC = 1"
29,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM (WITH TEMP AS (SELECT *, CONCAT(LAT,LON) AS LOC FROM INSURANCE) SELECT PID, TIV_2016 FROM TEMP WHERE LOC IN (SELECT LOC FROM TEMP GROUP BY LOC HAVING COUNT(LOC) = 1) AND TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(TIV_2015) >1)) T"
30,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE CONCAT(LAT, LON) IN ( SELECT CONCAT(LAT, LON) FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*) = 1) AND TIV_2015 IN ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) > 1 )"
31,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 NOT IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*)=1) AND (LAT,LON) NOT IN (SELECT LAT,LON FROM INSURANCE GROUP BY LAT,LON HAVING COUNT(*)>1)"
32,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE (LAT, LON) IN (SELECT LAT, LON FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*) = 1) AND TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(TIV_2015) > 1)"
33,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE CONCAT(LAT, ' ', LON) IN (SELECT CONCAT(LAT, ' ', LON) FROM INSURANCE GROUP BY CONCAT(LAT, ' ', LON) HAVING COUNT(*) = 1) AND TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) > 1)"
34,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE CONCAT(LAT, LON) IN (SELECT CONCAT(LAT, LON) AS CITY FROM INSURANCE GROUP BY CITY HAVING COUNT(*) = 1) AND TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) > 1)"
35,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE PID IN (SELECT PID FROM INSURANCE WHERE TIV_2015 IN ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(PID) > 1)) AND PID NOT IN ( WITH LOCATIONS AS (SELECT *, CONCAT_WS(' ', LAT, LON) AS LOCATION FROM INSURANCE) SELECT PID FROM LOCATIONS WHERE LOCATION IN (SELECT LOCATION FROM LOCATIONS GROUP BY LOCATION HAVING COUNT(PID) > 1))"
36,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN ( SELECT MAX(TIV_2015) AS TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) > 1 ) AND PID IN ( SELECT MAX(PID) FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*) = 1 )"
37,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*)>1 ) AND CONCAT(LAT, LON) IN ( SELECT CONCAT(LAT, LON) FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*)=1 )"
38,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) > 1) AND (LAT, LON) IN (SELECT LAT, LON FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*) = 1)"
39,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) > 1) AND CONCAT(LAT, CONCAT(',', LON)) IN (SELECT CONCAT(LAT, CONCAT(',', LON)) FROM INSURANCE GROUP BY CONCAT(LAT, CONCAT(',', LON)) HAVING COUNT(*) = 1)"
40,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(TIV_2015) > 1) AND (LAT, LON) IN (SELECT LAT, LON FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*) = 1)"
41,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(TIV_2015) > 1) AND (LAT, LON) IN( SELECT LAT, LON FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(LAT) = 1 AND COUNT(LON) = 1)"
42,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 NOT IN( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(TIV_2015)<=1) AND CONCAT(LAT,LON) IN( SELECT CONCAT(LAT,LON) FROM INSURANCE GROUP BY CONCAT(LAT,LON) HAVING COUNT(CONCAT(LAT,LON))=1 )"
43,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT(TIV_2015) FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*)>1) AND (LAT,LON) IN (SELECT LAT,LON FROM INSURANCE GROUP BY LAT,LON HAVING COUNT(*)=1)"
44,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE INSURANCE.TIV_2015 IN ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(PID) > 1 ) AND CONCAT(LAT, LON) IN ( SELECT CONCAT(LAT, LON) FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(PID) =1 )"
45,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE I WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE I GROUP BY TIV_2015 HAVING COUNT(*) > 1) AND CONCAT(LAT, LON) IN (SELECT CONCAT(LAT, LON) FROM INSURANCE I GROUP BY LAT, LON HAVING COUNT(*) < 2)"
46,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE I1 WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE I2 GROUP BY 1 HAVING COUNT(*) > 1) AND CONCAT(LAT, LON) NOT IN (SELECT CONCAT(LAT, LON) FROM INSURANCE I3 WHERE I1.PID <> I3.PID)"
47,Y,Y,SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE I WHERE (SELECT COUNT(DISTINCT PID) FROM INSURANCE WHERE TIV_2015 = I.TIV_2015) >= 2 AND (SELECT COUNT(DISTINCT PID) FROM INSURANCE WHERE LAT = I.LAT AND LON = I.LON) = 1
48,Y,Y,SELECT SUM(TIV_2016) TIV_2016 FROM INSURANCE I WHERE 1=(SELECT COUNT(*) FROM INSURANCE I1 WHERE I.LAT=I1.LAT AND I.LON=I1.LON) AND 1<(SELECT COUNT(*) FROM INSURANCE I2 WHERE I.TIV_2015 = I2.TIV_2015)
49,Y,Y,"SELECT SUM(TIV_2016) TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) > 1) AND (LAT, LON) NOT IN (SELECT LAT,LON FROM INSURANCE GROUP BY LAT,LON HAVING COUNT(*) > 1 )"
50,Y,Y,"SELECT SUM(TIV_2016) TIV_2016 FROM INSURANCE WHERE (LAT,LON) IN ( SELECT LAT,LON FROM INSURANCE GROUP BY LAT,LON HAVING COUNT(PID)=1) AND TIV_2015 NOT IN ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(PID)=1)"
51,Y,Y,"SELECT SUM(TIV_2016) TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(TIV_2015)>1) AND CONCAT(LAT,LON) IN (SELECT CONCAT(LAT,LON) FROM INSURANCE GROUP BY LAT,LON HAVING COUNT(*)=1 )"
52,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM ( SELECT PID, TIV_2015, COUNT(PID) OVER(PARTITION BY TIV_2015) AS CT_2015, TIV_2016, COUNT(PID) OVER(PARTITION BY CONCAT(LAT,LON)) AS CT_LOCATION FROM INSURANCE) AS SUB WHERE CT_2015 > 1 AND CT_LOCATION = 1"
53,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE AS I1 WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*)>1) AND CONCAT(LAT,LON) IN (SELECT CONCAT(LAT,LON) FROM INSURANCE GROUP BY LON,LAT HAVING COUNT(*)=1)"
54,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE CONCAT(LON, LAT) IN (SELECT CONCAT(LON, LAT) FROM INSURANCE GROUP BY LON, LAT HAVING COUNT(*) = 1) AND TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) > 1)"
55,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT DISTINCT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*)>1) AND (LAT,LON) NOT IN (SELECT LAT, LON FROM INSURANCE GROUP BY LAT,LON HAVING COUNT(*)>1)"
56,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE PID NOT IN (SELECT PID FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*)=1) AND PID IN (SELECT PID FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*) = 1)"
57,Y,Y,"SELECT SUM(INSURANCE.TIV_2016) AS TIV_2016 FROM INSURANCE WHERE INSURANCE.TIV_2015 IN ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) > 1 ) AND (LAT, LON) IN ( SELECT LAT, LON FROM INSURANCE GROUP BY LAT , LON HAVING COUNT(*) = 1 )"
58,Y,Y,"SELECT SUM(INSURANCE.TIV_2016) AS TIV_2016 FROM INSURANCE WHERE INSURANCE.TIV_2015 IN ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) > 1 ) AND CONCAT(LAT, LON) IN ( SELECT CONCAT(LAT, LON) FROM INSURANCE GROUP BY LAT , LON HAVING COUNT(*) = 1 )"
59,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE I WHERE I.TIV_2015 IN ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) > 1 ) AND CONCAT(I.LAT, '-', I.LON) IN ( SELECT CONCAT(LAT, '-', LON) FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*) = 1 )"
60,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*)>=2) AND (LAT, LON) NOT IN ( SELECT LAT, LON FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*) > 1 )"
61,Y,Y,"SELECT ROUND(SUM(TIV_2016), 2) AS TIV_2016 FROM INSURANCE WHERE PID NOT IN (SELECT PID FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) =1) AND PID IN (SELECT PID FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*) =1)"
62,Y,Y,"SELECT ROUND(SUM(I.TIV_2016), 2) AS TIV_2016 FROM INSURANCE I WHERE (SELECT COUNT(*) FROM INSURANCE I1 WHERE I.TIV_2015 = I1.TIV_2015) > 1 AND (SELECT COUNT(*) FROM INSURANCE I2 WHERE (I.LAT,I.LON)=(I2.LAT,I2.LON))=1"
63,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY 1 HAVING COUNT(*) > 1) AND CONCAT(LAT,LON) IN (SELECT CONCAT(LAT,LON) FROM INSURANCE GROUP BY 1 HAVING COUNT(*) = 1)"
64,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM ( SELECT *,CONCAT(LAT,',',LON) AS LOC FROM INSURANCE GROUP BY LOC HAVING COUNT(*) = 1 ) T WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) > 1 )"
65,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(TIV_2015)>1) AND (LAT, LON) IN ( SELECT LAT, LON FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(PID)=1)"
66,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(PID)> 1 AND CONCAT(LAT,LON) IN (SELECT CONCAT(LAT,LON) FROM INSURANCE GROUP BY LAT,LON HAVING COUNT(*) = 1) )"
67,Y,Y,"SELECT SUM(INSURANCE.TIV_2016) AS TIV_2016 FROM INSURANCE WHERE INSURANCE.TIV_2015 IN ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) > 1 ) AND CONCAT (LAT, LON) IN ( SELECT CONCAT (LAT, LON) AS UNIQUE_CITY FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*) = 1 )"
68,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) >= 2) AND (LAT, LON) NOT IN (SELECT LAT, LON FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*) >= 2)"
69,Y,Y,"SELECT SUM(TIV_2016) TIV_2016 FROM (SELECT *, COUNT(*) OVER (PARTITION BY TIV_2015) AS COMVAL , COUNT(*) OVER (PARTITION BY LAT, LON) AS PLACE FROM INSURANCE) T WHERE COMVAL > 1 AND PLACE = 1"
70,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) > 1) AND CONCAT(LAT, LON) IN (SELECT CONCAT(LAT,LON) AS CT FROM INSURANCE GROUP BY 1 HAVING COUNT(*) = 1)"
71,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM (SELECT TIV_2015, COUNT(*) AS CNT FROM INSURANCE GROUP BY TIV_2015) TBL1 WHERE CNT > 1) AND (LAT,LON) IN ( SELECT LAT, LON FROM (SELECT LAT, LON, COUNT(*) CNT FROM INSURANCE GROUP BY LAT,LON) TBL2 WHERE CNT = 1 )"
72,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM( SELECT TIV_2016, COUNT(TIV_2015) OVER(PARTITION BY TIV_2015) AS DR1, COUNT(TIV_2015) OVER(PARTITION BY LAT,LON) AS DR2 FROM INSURANCE ) T WHERE DR1 >= 2 AND DR2 = 1"
73,Y,Y,"SELECT SUM(T.TIV_2016) AS TIV_2016 FROM INSURANCE T WHERE T.TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY 1 HAVING COUNT(*) > 1) AND CONCAT(LAT,LON) IN (SELECT CONCAT(LAT,LON) FROM INSURANCE GROUP BY LAT,LON HAVING COUNT(*) = 1)"
74,Y,Y,"WITH 2015VAL AS ( SELECT TIV_2015 FROM INSURANCE GROUP BY 1 HAVING COUNT(TIV_2015) > 1 ), DIFFCITY AS ( SELECT LAT, LON FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(1) > 1 ) SELECT ROUND(SUM(TIV_2016), 2) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT * FROM 2015VAL) AND (LAT, LON) NOT IN (SELECT * FROM DIFFCITY)"
75,Y,Y,"WITH CTE AS ( SELECT *, CONCAT_WS(', ', LAT, LON) AS LOCATION FROM INSURANCE ), CTE2 AS ( SELECT * FROM ( SELECT *, COUNT(*) OVER ( PARTITION BY LOCATION ) AS CNT_LOCATION, COUNT(*) OVER ( PARTITION BY TIV_2015 ) AS CNT_TIV FROM CTE C ) SUB WHERE SUB.CNT_LOCATION = 1 AND SUB.CNT_TIV >= 2 ) SELECT ROUND( SUM(TIV_2016), 2) AS TIV_2016 FROM CTE2"
76,Y,Y,"WITH CTE1 AS (SELECT DISTINCT TIV_2015 AS INV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(TIV_2015)>1), CTE2 AS (SELECT DISTINCT LAT, LON FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*)=1) SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT INV_2015 FROM CTE1) AND CONCAT(LAT, CONCAT(',',LON)) IN (SELECT CONCAT(LAT, CONCAT(',',LON)) FROM CTE2)"
77,Y,Y,"WITH CTE_1 AS ( SELECT * FROM INSURANCE I WHERE EXISTS ( SELECT X FROM INSURANCE II WHERE I.TIV_2015 = II.TIV_2015 AND I.PID <> II.PID ) ) ,CTE_2 AS ( SELECT PID, LAT, LON, COUNT(*) OVER (PARTITION BY LAT, LON) LAT_LON_COUNT FROM INSURANCE I ) ,CTE_3 AS ( SELECT * FROM CTE_2 WHERE LAT_LON_COUNT = 1 ) SELECT SUM(TIV_2016) TIV_2016 FROM INSURANCE WHERE PID IN ( SELECT PID FROM CTE_3 ) AND PID IN ( SELECT PID FROM CTE_1 )"
78,Y,Y,"WITH CTE_LAT_LON_COMBINED AS ( SELECT PID ,TIV_2015 ,TIV_2016 ,CONCAT(CAST(LAT AS CHAR),CAST(LON AS CHAR)) AS CITY FROM INSURANCE ) , CTE_REMOVE_SAME_CITIES AS ( SELECT A.PID FROM CTE_LAT_LON_COMBINED A INNER JOIN CTE_LAT_LON_COMBINED B ON A.CITY = B.CITY AND A.PID <> B.PID GROUP BY 1 ) , CTE_FINAL_LIST AS ( SELECT A.PID FROM CTE_LAT_LON_COMBINED A INNER JOIN CTE_LAT_LON_COMBINED B ON A.TIV_2015 = B.TIV_2015 AND A.PID <> B.PID WHERE A.PID NOT IN (SELECT PID FROM CTE_REMOVE_SAME_CITIES) GROUP BY 1 ) SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE A INNER JOIN CTE_FINAL_LIST B ON A.PID = B.PID"
79,Y,Y,"WITH T1 AS( SELECT PID,TIV_2016,COUNT(*) OVER (PARTITION BY TIV_2015) AS C FROM INSURANCE) SELECT SUM(TIV_2016) AS TIV_2016 FROM T1 WHERE C > 1 AND PID NOT IN ( SELECT I2.PID FROM INSURANCE I1 INNER JOIN INSURANCE I2 WHERE (I1.LAT = I2.LAT) AND (I1.LON = I2.LON) AND (I1.PID != I2.PID))"
80,Y,Y,"WITH TEMP AS (SELECT PID, COUNT(PID) OVER (PARTITION BY TIV_2015) CT, TIV_2016, LAT, LON FROM INSURANCE), T2 AS(SELECT PID, COUNT(PID) OVER (PARTITION BY LAT, LON) LOCATION, TIV_2016 FROM INSURANCE) SELECT SUM(TIV_2016) AS TIV_2016 FROM (SELECT PID, TIV_2016 FROM T2 WHERE LOCATION=1) T4 WHERE PID IN (SELECT PID FROM (SELECT PID FROM TEMP WHERE CT >1) T3 )"
81,Y,Y,"WITH TIV2015 AS (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(PID)>1), LOCATION AS (SELECT LAT, LON FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(PID)=1) SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE I JOIN TIV2015 T ON I.TIV_2015=T.TIV_2015 JOIN LOCATION L ON I. LAT=L.LAT AND I.LON=L.LON"
82,Y,Y,"WITH COMPLETE AS ( SELECT *, COUNT(PID) OVER(PARTITION BY TIV_2015) AS CRITERIA1, COUNT(PID) OVER(PARTITION BY LAT,LON) AS CRITERIA2 FROM INSURANCE ) SELECT SUM(TIV_2016) AS TIV_2016 FROM COMPLETE WHERE CRITERIA1 > 1 AND CRITERIA2 = 1"
83,Y,Y,"WITH CONDITION_1 AS ( SELECT DISTINCT S1.PID FROM INSURANCE S1, INSURANCE S2 WHERE S1.LON = S2.LON AND S1.LAT = S2.LAT AND S1.PID != S2.PID ), CONDITION_2 AS ( SELECT DISTINCT S1.PID FROM INSURANCE S1, INSURANCE S2 WHERE S1.TIV_2015 = S2.TIV_2015 AND S1.PID != S2.PID AND S1.PID ), FINAL AS ( SELECT * FROM CONDITION_2 C1 WHERE C1.PID NOT IN (SELECT * FROM CONDITION_1) ) SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE S RIGHT JOIN FINAL F ON S.PID = F.PID"
84,Y,Y,"WITH CTE AS ( SELECT * ,RANK() OVER(ORDER BY TIV_2015) AS RNK ,RANK() OVER(ORDER BY LAT,LON) AS RNK_LAT FROM INSURANCE ) , CTEB AS (SELECT PID, COUNT(PID) OVER(PARTITION BY RNK) AS REPEATED_TIV, COUNT(PID) OVER(PARTITION BY RNK_LAT) AS REPEATED_LOC, TIV_2016 FROM CTE) SELECT SUM(TIV_2016) AS TIV_2016 FROM CTEB WHERE REPEATED_TIV > 1 AND REPEATED_LOC = 1"
85,Y,Y,"WITH CTE AS (SELECT A.PID FROM (SELECT PID FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) > 1)) A JOIN (SELECT PID FROM INSURANCE WHERE CONCAT(LAT, LON) IN (SELECT CONCAT(LAT, LON) FROM INSURANCE GROUP BY CONCAT(LAT, LON) HAVING COUNT(*) = 1)) B ON A.PID = B.PID) SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE PID IN (SELECT PID FROM CTE)"
86,Y,Y,"WITH DUPTIV15 AS ( SELECT TIV_2015, COUNT(1) AS N_PID FROM INSURANCE GROUP BY 1 HAVING COUNT(1) >= 2 ), UNIQCITY AS ( SELECT CONCAT(CAST(LAT AS CHAR),',',CAST(LON AS CHAR)) AS LOC, COUNT(1) AS NSTR FROM INSURANCE GROUP BY 1 HAVING COUNT(1) = 1 ) SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM DUPTIV15) AND CONCAT(CAST(LAT AS CHAR),',',CAST(LON AS CHAR)) IN (SELECT LOC FROM UNIQCITY)"
87,Y,Y,"WITH ELIGIBLE AS ( SELECT DISTINCT I1.PID FROM INSURANCE I1 JOIN INSURANCE I2 ON (I1.PID != I2.PID AND I1.TIV_2015 = I2.TIV_2015) ORDER BY 1 ASC ), NOT_ELIGIBLE AS ( SELECT DISTINCT E1.PID FROM INSURANCE E1 JOIN INSURANCE E2 ON (E1.PID != E2.PID AND (E1.LAT,E1.LON) = (E2.LAT,E2.LON)) ORDER BY 1 ) SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE PID IN (SELECT * FROM ELIGIBLE) AND PID NOT IN (SELECT * FROM NOT_ELIGIBLE )"
88,Y,Y,"WITH GET_UNIQUES_LL AS ( SELECT LAT, LON, MIN(PID) AS UID FROM INSURANCE GROUP BY 1,2 HAVING COUNT(*) <= 1 ), GET_SAME_TIV AS ( SELECT DISTINCT I1.PID, I1.TIV_2016 FROM INSURANCE I1 INNER JOIN INSURANCE I2 ON I1.PID <> I2.PID AND I1.TIV_2015 = I2.TIV_2015 ) SELECT ROUND(SUM(T1.TIV_2016),2) AS TIV_2016 FROM GET_SAME_TIV T1 INNER JOIN GET_UNIQUES_LL T2 ON T1.PID = T2.UID"
89,Y,Y,"WITH JOIN_LOC AS ( SELECT DISTINCT L.PID, L.TIV_2015, L.TIV_2016 FROM INSURANCE L LEFT JOIN INSURANCE R ON L.PID != R.PID AND L.LAT = R.LAT AND L.LON = R.LON WHERE R.PID IS NULL ), JOIN_2015 AS ( SELECT DISTINCT L.PID, L.TIV_2016 FROM JOIN_LOC L INNER JOIN INSURANCE R ON L.PID != R.PID AND L.TIV_2015 = R.TIV_2015 WHERE R.TIV_2015 IS NOT NULL ) SELECT SUM(TIV_2016) AS TIV_2016 FROM JOIN_2015"
90,Y,Y,"WITH NOT_SAME_LOC AS ( SELECT PID FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*)=1 ), INVESTMENT AS( SELECT PID FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*)=1 ) SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE PID IN (SELECT PID FROM NOT_SAME_LOC) AND PID NOT IN (SELECT PID FROM INVESTMENT)"
91,Y,Y,"WITH SUB AS( SELECT DISTINCT I1.PID, I1.TIV_2015, I1.TIV_2016, I1.LAT, I1.LON FROM INSURANCE I1, INSURANCE I2 WHERE I1.TIV_2015 = I2.TIV_2015 AND I1.PID != I2.PID ), COORDINATES AS( SELECT LAT, LON, COUNT(PID) AS COUNT FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(PID) = 1 ) SELECT SUM(TIV_2016) AS TIV_2016 FROM SUB JOIN COORDINATES ON (SUB.LAT = COORDINATES.LAT AND SUB.LON = COORDINATES.LON)"
92,Y,Y,"WITH T1 AS ( SELECT DISTINCT A.PID FROM INSURANCE A JOIN INSURANCE B ON A.TIV_2015 = B.TIV_2015 AND (A.LAT, A.LON) != (B.LAT, B.LON) ), T2 AS ( SELECT DISTINCT A.PID FROM INSURANCE A JOIN INSURANCE B ON A.PID != B.PID AND (A.LAT, A.LON) = (B.LAT, B.LON) ) SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE PID IN (SELECT PID FROM T1) AND PID NOT IN (SELECT PID FROM T2)"
93,Y,Y,"WITH T1 AS ( SELECT TIV_2015, 1 AS ISSATTIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(PID) >= 2 ), T2 AS ( SELECT LAT, LON, 1 AS ISUNIQUELOC FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(PID) = 1 ) SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE T3 LEFT JOIN T1 ON T3.TIV_2015 = T1.TIV_2015 LEFT JOIN T2 ON T3.LAT = T2.LAT AND T3.LON = T2.LON WHERE T1.ISSATTIV_2015 = 1 AND T2.ISUNIQUELOC = 1"
94,Y,Y,"WITH TABLE1 AS( SELECT *, COUNT(TIV_2015) OVER(PARTITION BY TIV_2015) AS CNT_VALUE, COUNT(LAT) OVER(PARTITION BY LAT,LON) AS CNT_LOCATION FROM INSURANCE ) SELECT SUM(TIV_2016) AS TIV_2016 FROM TABLE1 WHERE CNT_VALUE > 1 AND CNT_LOCATION = 1"
95,Y,Y,"WITH TEMP AS ( SELECT TIV_2016, CONCAT(LAT, LON) AS COORD FROM INSURANCE WHERE TIV_2015 IN ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) > 1 ) ) SELECT ROUND(SUM(TIV_2016), 2) AS TIV_2016 FROM TEMP WHERE COORD NOT IN (SELECT CONCAT(LAT, LON) AS COORD FROM INSURANCE GROUP BY COORD HAVING COUNT(*) > 1)"
96,Y,Y,"WITH TIV AS ( SELECT TIV_2015, COUNT(*) AS CNT FROM INSURANCE GROUP BY TIV_2015 HAVING CNT > 1), LOCATED AS (SELECT LAT, LON, COUNT(*) AS CNT FROM INSURANCE GROUP BY LAT, LON), HOLDERS AS ( SELECT PID, TIV_2016, TIV_2015 FROM INSURANCE AS I INNER JOIN LOCATED AS L ON I.LAT = L.LAT AND I.LON = L.LON WHERE CNT = 1) SELECT SUM(TIV_2016) AS TIV_2016 FROM TIV AS T INNER JOIN HOLDERS AS H ON T.TIV_2015 = H.TIV_2015"
97,Y,Y,"WITH TIV2015_COUNTS AS (SELECT TIV_2015, COUNT(*) AS COUNTS FROM INSURANCE I GROUP BY TIV_2015), UNIQUE_CITY AS ( SELECT LAT, LON, COUNT(*) AS COUNTS FROM INSURANCE I GROUP BY LAT, LON ) SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE I WHERE TIV_2015 IN (SELECT TIV_2015 FROM TIV2015_COUNTS WHERE COUNTS >= 2) AND (LAT, LON) IN (SELECT LAT, LON FROM UNIQUE_CITY WHERE COUNTS = 1)"
98,Y,Y,"WITH TIV_2015_VALUE AS ( SELECT DISTINCT(TIV_2015) FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) >= 2 ), LAT_LON AS ( SELECT DISTINCT(CONCAT(LAT, ', ', LON)) AS LATLON FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*) = 1 ) SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT * FROM TIV_2015_VALUE) AND CONCAT(LAT, ', ', LON) IN (SELECT * FROM LAT_LON)"
99,Y,Y,"WITH TIV_COUNTS AS (SELECT TIV_2015, COUNT(TIV_2015) AS 2015_COUNTS FROM INSURANCE GROUP BY TIV_2015 HAVING 2015_COUNTS > 1), MAP_FREQS AS (SELECT TIV_2015, TIV_2016, COUNT(LAT) AS LAT_FREQS, COUNT(LON) AS LON_FREQS FROM INSURANCE GROUP BY LAT, LON HAVING LAT_FREQS <= 1 AND LON_FREQS <= 1) SELECT SUM(MAP_FREQS.TIV_2016) AS TIV_2016 FROM TIV_COUNTS JOIN MAP_FREQS ON TIV_COUNTS.TIV_2015 = MAP_FREQS.TIV_2015"
100,Y,Y,"WITH UNIQUE_LOCATION AS (SELECT PID,LAT,LON FROM INSURANCE GROUP BY 2,3 HAVING COUNT(PID) = 1), SAME_2015 AS (SELECT PID,TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(PID) =1) SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE WHERE PID NOT IN (SELECT PID FROM SAME_2015) AND PID IN (SELECT PID FROM UNIQUE_LOCATION)"
101,Y,Y,"WITH VALID_LATLON AS (SELECT LAT, LON FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*) = 1) SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE AS I INNER JOIN VALID_LATLON AS V ON I.LAT = V.LAT AND I.LON=V.LON WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) != 1)"
102,Y,Y,"WITH VALID_TIV15 AS (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) != 1), VALID_LATLON AS (SELECT LAT, LON FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*) = 1) SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE AS I INNER JOIN VALID_LATLON AS V ON I.LAT = V.LAT AND I.LON=V.LON WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) != 1)"
103,Y,Y,"WITH TEMP AS ( SELECT PID, TIV_2015, TIV_2016, CONCAT(LAT,LON) AS LOCATION FROM INSURANCE WHERE TIV_2015 IN ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*)>1) ) SELECT SUM(TIV_2016) AS TIV_2016 FROM TEMP WHERE LOCATION IN (SELECT CONCAT(LAT,LON)AS LOCATION FROM INSURANCE GROUP BY LOCATION HAVING COUNT(*)=1)"
104,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE WHERE PID IN (SELECT PID FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY 1 HAVING COUNT(DISTINCT PID) >1) AND (LAT,LON) IN (SELECT LAT,LON FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*) = 1) )"
105,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(TIV_2015) > 1) AND CONCAT(LAT,LON) IN (SELECT CONCAT(LAT,LON) FROM INSURANCE GROUP BY CONCAT(LAT,LON) HAVING COUNT(CONCAT(LAT,LON)) = 1)"
106,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE PID IN ( SELECT DISTINCT I1.PID FROM INSURANCE I1 JOIN INSURANCE I2 ON I1.TIV_2015 = I2.TIV_2015 AND I1.PID <> I2.PID WHERE I1.PID IN ( SELECT PID FROM INSURANCE GROUP BY CONCAT(LAT,LON) HAVING COUNT(*) = 1 ) )"
107,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(TIV_2015) > 1) AND CONCAT(LAT,LON) IN (SELECT CONCAT(LAT,LON) FROM INSURANCE GROUP BY LAT,LON HAVING COUNT(*) = 1)"
108,Y,Y,"SELECT ROUND(SUM(A.TIV_2016),2) AS TIV_2016 FROM INSURANCE A WHERE (SELECT COUNT(*) FROM INSURANCE B WHERE A.LAT = B.LAT AND A.LON = B.LON) = 1 AND (SELECT COUNT(*) FROM INSURANCE C WHERE A.TIV_2015 = C.TIV_2015)>1"
109,Y,Y,"SELECT ROUND(SUM(I.TIV_2016),2) AS TIV_2016 FROM INSURANCE I LEFT JOIN ( SELECT TIV_2015, COUNT(PID) AS PID_CNT FROM INSURANCE GROUP BY 1 ) TBL ON I.TIV_2015 = TBL.TIV_2015 LEFT JOIN ( SELECT LAT, LON, COUNT(PID) AS PID_CNT2 FROM INSURANCE GROUP BY 1,2 ) TBL2 ON I.LAT = TBL2.LAT AND I.LON = TBL2.LON WHERE TBL.PID_CNT >=2 AND PID_CNT2 = 1"
110,Y,Y,"SELECT ROUND(SUM(TIV_2016), 2) AS TIV_2016 FROM (SELECT DISTINCT I1.PID, I1.TIV_2016 FROM INSURANCE I1 JOIN INSURANCE I2 WHERE I1.PID != I2.PID AND I1.TIV_2015 = I2.TIV_2015) T1 JOIN (SELECT PID, LAT, LON FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*)=1) T2 ON T1.PID=T2.PID"
111,Y,Y,"SELECT ROUND(SUM(TIV_2016), 2) AS TIV_2016 FROM INSURANCE WHERE (LAT, LON) IN( SELECT LAT, LON FROM INSURANCE GROUP BY LAT,LON HAVING COUNT(PID)=1 ) AND TIV_2015 IN( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(PID)>1 )"
112,Y,Y,"SELECT ROUND(SUM(TIV_2016), 2) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*)>1 ) AND (LAT, LON) NOT IN (SELECT LAT, LON FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*)>1)"
113,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) TIV_2016 FROM INSURANCE A WHERE (SELECT COUNT(*) FROM INSURANCE B WHERE A.TIV_2015 = B.TIV_2015)>1 AND (SELECT COUNT(*) FROM INSURANCE C WHERE (A.LAT, A.LON)=(C.LAT, C.LON))=1"
114,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(TIV_2015) > 1) AND CONCAT(LAT, LON) IN (SELECT CONCAT(LAT, LON) FROM INSURANCE GROUP BY CONCAT(LAT, LON) HAVING COUNT(*)=1)"
115,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM ( SELECT T.PID, T.TIV_2015, T.TIV_2016, T.LAT, T.LON, T1.TIV_2015_COUNT, T2.CITY_COUNT FROM INSURANCE T LEFT JOIN( SELECT TIV_2015, COUNT(*) AS TIV_2015_COUNT FROM INSURANCE GROUP BY TIV_2015 )T1 ON T.TIV_2015=T1.TIV_2015 LEFT JOIN ( SELECT LAT, LON, COUNT(*) AS CITY_COUNT FROM INSURANCE GROUP BY LAT, LON )T2 ON T.LAT = T2.LAT AND T.LON = T2.LON WHERE T1.TIV_2015_COUNT > 1 AND T2.CITY_COUNT = 1 )FT"
116,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM (SELECT DISTINCT I1.* FROM INSURANCE I1 JOIN INSURANCE I2 ON I1.TIV_2015 = I2.TIV_2015 AND I1.PID <> I2.PID AND (I1.LAT <> I2.LAT OR I1.LON <> I2.LON) AND (I1.LAT,I1.LON) IN (SELECT DISTINCT LAT,LON FROM INSURANCE GROUP BY LAT,LON HAVING COUNT(*) = 1))A"
117,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM (SELECT DISTINCT I1.* FROM INSURANCE I1 JOIN INSURANCE I2 ON I1.TIV_2015 = I2.TIV_2015 AND I1.PID <> I2.PID AND (I1.LAT <> I2.LAT OR I1.LON <> I2.LON) AND (I1.LAT,I1.LON) NOT IN (SELECT DISTINCT LAT,LON FROM INSURANCE GROUP BY LAT,LON HAVING COUNT(*) > 1))A"
118,N,N,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM (SELECT *, CONCAT(LAT,',',LON) AS LOC FROM INSURANCE GROUP BY LOC HAVING COUNT(*) = 1) TWHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*)>1)"
119,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE WHERE PID NOT IN (SELECT DISTINCT A.PID FROM INSURANCE A JOIN INSURANCE B ON A.PID != B.PID AND A.LAT = B.LAT AND A.LON = B.LON) AND PID IN (SELECT DISTINCT A.PID FROM INSURANCE A JOIN INSURANCE B ON A.PID != B.PID AND A.TIV_2015 = B.TIV_2015)"
120,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE I JOIN ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*)>1) C ON I.TIV_2015 = C.TIV_2015 JOIN( SELECT LAT,LON FROM INSURANCE GROUP BY LAT,LON HAVING COUNT(*)=1 ) P ON I.LAT = P.LAT AND I.LON = P.LON"
121,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE I JOIN (SELECT PID FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(TIV_2015)>1) AND CONCAT(LAT,LON) NOT IN (SELECT CONCAT(LAT,LON) FROM INSURANCE GROUP BY CONCAT(LAT,LON) HAVING COUNT(CONCAT(LAT,LON))>1))SQ ON I.PID = SQ.PID"
122,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE I WHERE (SELECT COUNT(*) FROM INSURANCE I1 WHERE I.TIV_2015 = I1.TIV_2015)>1 AND (SELECT COUNT(*) FROM INSURANCE I2 WHERE (I.LAT, I.LON) = (I2.LAT, I2.LON))=1"
123,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE I WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*)>1) AND (I.LAT,I.LON) NOT IN (SELECT I1.LAT,I1.LON FROM INSURANCE I1 GROUP BY 1,2 HAVING COUNT(*)>1)"
124,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE WHERE PID IN (SELECT PID FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(TIV_2015)>1) AND PID IN (SELECT PID FROM INSURANCE WHERE CONCAT(LAT,LON) IN (SELECT CONCAT(LAT,LON) FROM INSURANCE GROUP BY LAT,LON HAVING COUNT(CONCAT(LAT,LON))=1)))"
125,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE WHERE PID IN (SELECT A.PID FROM INSURANCE A JOIN INSURANCE B ON A.PID != B.PID AND A.TIV_2015 = B.TIV_2015) AND PID NOT IN (SELECT C.PID FROM INSURANCE C JOIN INSURANCE D ON C.PID != D.PID AND C.LAT = D.LAT AND C.LON = D.LON)"
126,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE WHERE PID IN (SELECT DISTINCT A.PID FROM INSURANCE A JOIN INSURANCE B ON A.PID != B.PID AND A.TIV_2015 = B.TIV_2015 WHERE A.PID NOT IN (SELECT C.PID FROM INSURANCE C JOIN INSURANCE D ON C.PID != D.PID AND C.LAT = D.LAT AND C.LON = D.LON))"
127,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(TIV_2015)>=2 ) AND (LAT,LON) IN ( SELECT LAT,LON FROM INSURANCE GROUP BY LAT,LON HAVING COUNT(*)=1 )"
128,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*)>1) AND CONCAT(LAT, LON) IN (SELECT CONCAT(LAT, LON) FROM INSURANCE GROUP BY CONCAT(LAT, LON) HAVING COUNT(*)=1)"
129,Y,Y,"SELECT ROUND(SUM(A.TIV_2016), 2) AS TIV_2016 FROM INSURANCE A WHERE 1 > ( SELECT COUNT(B.PID) FROM INSURANCE B WHERE (A.PID <> B.PID AND (B.LAT, B.LON) = (A.LAT, A.LON)) ) AND 1 <= ( SELECT COUNT(C.PID) FROM INSURANCE C WHERE (A.PID <> C.PID AND A.TIV_2015 = C.TIV_2015) )"
130,Y,Y,"SELECT ROUND(SUM(A.TIV_2016),2) AS TIV_2016 FROM INSURANCE A INNER JOIN ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) > 1 ) B ON A.TIV_2015 = B.TIV_2015 INNER JOIN ( SELECT LON, LAT FROM INSURANCE GROUP BY LON,LAT HAVING COUNT(*) = 1 ) C ON A.LAT = C.LAT AND A.LON = C.LON"
131,Y,N,"SELECT ROUND(SUM(DISTINCT A.TIV_2016),2) AS TIV_2016 FROM INSURANCE AS A JOIN INSURANCE AS B ON A.TIV_2015 = B.TIV_2015 WHERE A.PID != B.PID AND A.PID IN (SELECT DISTINCT I.PID FROM INSURANCE AS I JOIN INSURANCE AS J ON I.LAT = J.LAT AND I.LON = J.LON GROUP BY I.PID HAVING COUNT(DISTINCT J.PID) = 1)"
132,Y,Y,"SELECT ROUND(SUM(I.TIV_2016),2) AS TIV_2016 FROM INSURANCE I WHERE I.PID NOT IN (SELECT PID FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(TIV_2015) < 2) AND (I.LAT, I.LON) NOT IN (SELECT I2.LAT, I2.LON FROM INSURANCE I2 WHERE I.PID <>I2.PID)"
133,Y,Y,"SELECT ROUND(SUM(INS1.TIV_2016),2) AS TIV_2016 FROM INSURANCE INS1 JOIN( SELECT LAT ,LON FROM INSURANCE GROUP BY LAT,LON HAVING COUNT(PID) = 1 ) UNIQUELOC JOIN( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(PID) > 1 ) 2015VAL ON INS1.LAT = UNIQUELOC.LAT AND INS1.LON = UNIQUELOC.LON AND INS1.TIV_2015 = 2015VAL.TIV_2015"
134,Y,Y,"SELECT ROUND(SUM(INSURANCE1.TIV_2016),2) AS TIV_2016 FROM INSURANCE INSURANCE1 LEFT JOIN INSURANCE INSURANCE2 ON (INSURANCE1.LAT = INSURANCE2.LAT) AND (INSURANCE1.LON = INSURANCE2.LON) AND INSURANCE1.PID != INSURANCE2.PID WHERE INSURANCE2.PID IS NULL AND INSURANCE1.TIV_2015 IN ( SELECT TIV_2015 FROM INSURANCE WHERE PID != INSURANCE1.PID )"
135,Y,Y,"SELECT ROUND(SUM(P1.TIV_2016), 2) AS TIV_2016 FROM ( SELECT T1.* FROM INSURANCE AS T1 LEFT JOIN ( SELECT TIV_2015, COUNT(TIV_2015) AS COUNT_T15 FROM INSURANCE GROUP BY TIV_2015 ) AS T2 ON T1.TIV_2015 = T2.TIV_2015 WHERE T2.COUNT_T15 > 1 ) AS P1 INNER JOIN ( SELECT K1.* FROM INSURANCE AS K1 LEFT JOIN ( SELECT LAT, LON, COUNT(LAT) AS COUNT_CITY FROM INSURANCE GROUP BY LAT, LON ) AS K2 ON K1.LAT = K2.LAT AND K1.LON = K2.LON WHERE K2.COUNT_CITY = 1 ) AS P2 ON P1.PID = P2.PID"
136,Y,Y,"SELECT ROUND(SUM(SUB.TIV_2016),2) AS TIV_2016 FROM ( SELECT DISTINCT A.PID, A.TIV_2016 FROM INSURANCE A JOIN INSURANCE B ON A.TIV_2015 = B.TIV_2015 AND A.PID != B.PID WHERE A.PID IN ( SELECT PID FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(PID) = 1 ) )AS SUB"
137,Y,Y,"SELECT ROUND(SUM(TIV_2016), 2) AS TIV_2016 FROM INSURANCE WHERE (LAT, LON) IN (SELECT LAT, LON FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*)=1) AND TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*)>1)"
138,Y,Y,"SELECT ROUND(SUM(TIV_2016), 2) TIV_2016 FROM INSURANCE WHERE TIV_2015 IN ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(TIV_2015) > 1 ) AND (LAT, LON) NOT IN ( SELECT LAT, LON FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(PID) > 1 )"
139,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY 1 HAVING COUNT(*) >1) AND CONCAT(LAT,LON) IN (SELECT CONCAT(LAT,LON) FROM INSURANCE GROUP BY 1 HAVING COUNT(*) = 1)"
140,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) > 1) AND CONCAT(LAT,' ',LON) IN ( SELECT CONCAT(LAT,' ',LON) FROM INSURANCE GROUP BY CONCAT(LAT,' ',LON) HAVING COUNT(*) = 1)"
141,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE AS I1 WHERE I1.TIV_2015 IN (SELECT I2.TIV_2015 FROM INSURANCE I2 WHERE I1.PID != I2.PID) AND (I1.LAT, I1.LON) NOT IN (SELECT LAT, LON FROM INSURANCE I3 WHERE I1.PID != I3.PID)"
142,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE I1 WHERE I1.TIV_2015 IN (SELECT I2.TIV_2015 FROM INSURANCE I2 WHERE I1.PID != I2.PID) AND (I1.LAT, I1.LON) NOT IN (SELECT LAT, LON FROM INSURANCE I3 WHERE I1.PID != I3.PID)"
143,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM (SELECT *, COUNT(*) OVER(PARTITION BY LAT, LON) AS CNT1, COUNT(*) OVER(PARTITION BY TIV_2015) AS CNT2 FROM INSURANCE ) A WHERE CNT1 = 1 AND CNT2 >= 2"
144,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE WHERE (LAT,LON) IN (SELECT LAT,LON FROM INSURANCE GROUP BY 1,2 HAVING COUNT(*)=1) AND TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY 1 HAVING COUNT(*)>1)"
145,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) TIV_2016 FROM (SELECT DISTINCT A.PID PID, A.TIV_2016 TIV_2016 FROM INSURANCE A JOIN INSURANCE B WHERE A.PID != B.PID AND A.TIV_2015=B.TIV_2015 AND A.PID NOT IN ( SELECT C.PID FROM INSURANCE C JOIN INSURANCE D WHERE C.PID!=D.PID AND C.LAT=D.LAT AND C.LON=D.LON ) ) R1"
146,Y,Y,"SELECT SUM(A.TIV_2016) TIV_2016 FROM ( SELECT A.TIV_2016, A.LAT, A.LON, COUNT(*) OVER (PARTITION BY A.TIV_2015) ROW_NUMBER FROM INSURANCE A ) A INNER JOIN ( SELECT LAT,LON,COUNT(*) FROM INSURANCE GROUP BY LAT,LON HAVING COUNT(*) = 1 ) B ON A.LAT = B.LAT AND A.LON = B.LON WHERE A.ROW_NUMBER > 1"
147,Y,Y,SELECT SUM(TIV_2016 ) AS TIV_2016 FROM INSURANCE A WHERE (SELECT COUNT(*) FROM INSURANCE B WHERE A.LAT=B.LAT AND A.LON=B.LON)=1 AND (SELECT COUNT(*) FROM INSURANCE C WHERE A.TIV_2015=C.TIV_2015)>1
148,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM (SELECT * FROM INSURANCE GROUP BY CONCAT(LAT, LON) HAVING COUNT(PID)=1) B WHERE PID NOT IN (SELECT DISTINCT PID FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(PID)=1)"
149,Y,Y,"SELECT SUM(TIV_2016) TIV_2016 FROM ( SELECT *, COUNT(*) OVER (PARTITION BY TIV_2015) CNT1, COUNT(*) OVER (PARTITION BY LAT,LON) CNT2 FROM INSURANCE ) T WHERE CNT1 >1 AND CNT2=1"
150,Y,Y,SELECT SUM(TIV_2016) TIV_2016 FROM INSURANCE A WHERE (SELECT COUNT(*) FROM INSURANCE B WHERE A.LAT=B.LAT AND A.LON=B.LON)=1 AND (SELECT COUNT(*) FROM INSURANCE B WHERE B.TIV_2015=A.TIV_2015)>1
151,Y,Y,SELECT SUM(TIV_2016) TIV_2016 FROM INSURANCE A WHERE 1 = (SELECT COUNT(*) FROM INSURANCE B WHERE A.LAT=B.LAT AND A.LON=B.LON) AND 1 < (SELECT COUNT(*) FROM INSURANCE C WHERE A.TIV_2015=C.TIV_2015)
152,Y,Y,"SELECT SUM(TIV_2016) TIV_2016 FROM INSURANCE I JOIN (SELECT PID FROM INSURANCE WHERE CONCAT(LAT,LON) IN (SELECT CONCAT(LAT,LON) FROM INSURANCE GROUP BY CONCAT(LAT,LON) HAVING COUNT(*) = 1))P ON I.PID = P.PID JOIN ( SELECT PID FROM INSURANCE WHERE TIV_2015 IN ( (SELECT TIV_2015 FROM INSURANCE GROUP BY 1 HAVING COUNT(*)>1)))Q ON I.PID = Q.PID"
153,Y,Y,SELECT SUM(TIV_2016) TIV_2016 FROM INSURANCE I WHERE EXISTS (SELECT 1 FROM INSURANCE I2 WHERE I.PID != I2.PID AND I.TIV_2015 = I2.TIV_2015) AND NOT EXISTS (SELECT 1 FROM INSURANCE I2 WHERE I.PID != I2.PID AND I.LON = I2.LON AND I.LAT = I2.LAT)
154,Y,Y,"SELECT SUM(TIV_2016) TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY 1 HAVING COUNT(1)>1) AND CONCAT(LAT, LON) IN (SELECT CONCAT(LAT, LON) FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(1) = 1)"
155,Y,Y,"SELECT SUM(TIV_2016) TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(1)>1) AND (LAT, LON) IN (SELECT LAT, LON FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(1)=1)"
156,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE PID IN (SELECT PID FROM INSURANCE WHERE TIV_2015 IN(SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(TIV_2015) > 1) AND (LAT, LON) NOT IN(SELECT LAT,LON FROM INSURANCE GROUP BY LAT,LON HAVING COUNT(*) > 1))"
157,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE AS TBL_1 WHERE TIV_2015 IN ( SELECT TIV_2015 FROM INSURANCE AS TBL_2 GROUP BY TIV_2015 HAVING COUNT(*) > 1 ) AND (TBL_1.LAT, TBL_1.LON) IN ( SELECT LAT, LON FROM INSURANCE AS TBL_3 GROUP BY LAT, LON HAVING COUNT(*) = 1 )"
158,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN( SELECT TIV_2015 FROM INSURANCE GROUP BY 1 HAVING COUNT(TIV_2015)>1 ) AND CONCAT(LAT, LON) NOT IN ( SELECT CONCAT(LAT, LON) FROM INSURANCE GROUP BY 1 HAVING COUNT(*)>1)"
159,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM ( SELECT *, CONCAT(LAT,'',LON) AS LOCATION FROM INSURANCE GROUP BY LOCATION HAVING COUNT(*)=1 ) AS TEMP WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*)>1)"
160,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM ( SELECT PID, TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY 1 HAVING COUNT(DISTINCT PID)>=2) AND (LAT, LON) IN (SELECT LAT, LON FROM INSURANCE GROUP BY 1, 2 HAVING COUNT(DISTINCT PID)=1) )AA"
161,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM (SELECT *, COUNT(*) OVER (PARTITION BY TIV_2015) AS CNT1, COUNT(*) OVER (PARTITION BY LAT, LON) AS CNT2 FROM INSURANCE) TBL WHERE CNT1 > 1 AND CNT2 = 1"
162,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM (SELECT *, COUNT(*) OVER(PARTITION BY TIV_2015) AS NUM_2015, COUNT(*) OVER(PARTITION BY CONCAT(LAT, LON)) AS NUM_LOC FROM INSURANCE)X WHERE NUM_2015>1 AND NUM_LOC=1"
163,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM (SELECT *, COUNT(*) OVER(PARTITION BY LAT,LON) AS COUNT_LATLON, COUNT(TIV_2015) OVER(PARTITION BY TIV_2015) AS COUNT_TIV2015 FROM INSURANCE)T WHERE COUNT_LATLON=1 AND COUNT_TIV2015>1"
164,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM (SELECT TIV_2015,TIV_2016,CONCAT(LAT,',',LON) AS LOCATION FROM INSURANCE GROUP BY LOCATION HAVING COUNT(*) = 1) Q JOIN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) > 1) W USING(TIV_2015)"
165,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM (SELECT TIV_2016, COUNT(1) OVER(PARTITION BY TIV_2015) AS CNT_2015, COUNT(1) OVER(PARTITION BY LAT, LON) AS CNT_LOC FROM INSURANCE) T WHERE CNT_2015>1 AND CNT_LOC = 1"
166,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM (SELECT DISTINCT I3.PID, I3.TIV_2016 FROM INSURANCE I3 INNER JOIN INSURANCE I4 ON I3.TIV_2015=I4.TIV_2015 WHERE I3.PID<>I4.PID AND I3.PID NOT IN (SELECT I1.PID FROM INSURANCE I1, INSURANCE I2 WHERE I1.LAT = I2.LAT AND I1.LON=I2.LON AND I1.PID<>I2.PID)) AS T"
167,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE I WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(PID) > 1) AND CONCAT(LAT,LON) IN ( SELECT CONCAT(LAT,LON) FROM INSURANCE GROUP BY 1 HAVING COUNT(PID) = 1 )"
168,Y,Y,SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE A WHERE (SELECT COUNT(*) FROM INSURANCE B WHERE A.TIV_2015=B.TIV_2015) >1 AND (SELECT COUNT(*) FROM INSURANCE C WHERE A.LAT = C.LAT AND A.LON = C.LON ) =1
169,Y,Y,SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE A WHERE 1 = (SELECT COUNT(*) FROM INSURANCE B WHERE A.LAT=B.LAT AND A.LON=B.LON) AND 1 < (SELECT COUNT(*) FROM INSURANCE C WHERE A.TIV_2015=C.TIV_2015)
170,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE AS A WHERE 1 <= ( SELECT COUNT(*) FROM INSURANCE WHERE A.PID != PID AND TIV_2015 = A.TIV_2015 ) AND (A.LAT, A.LON) NOT IN ( SELECT LAT, LON FROM INSURANCE WHERE A.PID != PID )"
171,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE I INNER JOIN (SELECT DISTINCT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) >1) A ON I.TIV_2015 = A.TIV_2015 INNER JOIN (SELECT LAT, LON FROM INSURANCE GROUP BY LAT,LON HAVING COUNT(*) =1) B ON I.LAT = B.LAT AND I.LON = B.LON"
172,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE (LAT, LON) NOT IN (SELECT LAT, LON FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*)>1) AND TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*)>1)"
173,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE PID NOT IN ( SELECT PID FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(PID)=1) AND LAT NOT IN ( SELECT LAT FROM INSURANCE GROUP BY LAT,LON HAVING COUNT(*)>1)"
174,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) > 1) AND CONCAT(LAT,LON) IN (SELECT CONCAT(LAT,LON) FROM INSURANCE GROUP BY CONCAT(LAT,LON) HAVING COUNT(*) = 1)"
175,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*)>1) AND (LAT,LON) NOT IN (SELECT LAT,LON FROM INSURANCE GROUP BY LAT,LON HAVING COUNT(*)>1)"
176,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*)>=2) AND CONCAT(LAT,LON) IN (SELECT CONCAT(LAT,LON) FROM INSURANCE GROUP BY CONCAT(LAT,LON) HAVING COUNT(*)=1)"
177,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(PID) > 1) AND (LAT, LON) NOT IN (SELECT LAT, LON FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(PID) > 1)"
178,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(PID)>1) AND CONCAT(LAT,LON) NOT IN (SELECT CONCAT(LAT,LON) FROM INSURANCE GROUP BY LAT,LON HAVING COUNT(PID)>1)"
179,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(TIV_2015)>1) AND CONCAT(LAT, LON) IN (SELECT CONCAT(LAT, LON) FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(CONCAT(LAT, LON))=1)"
180,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(TIV_2015)>1) AND CONCAT(LAT,LON) NOT IN ( SELECT CONCAT(LAT,LON) FROM INSURANCE GROUP BY 1 HAVING COUNT(*)> 1)"
181,Y,Y,SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE PID IN (SELECT DISTINCT I1.PID FROM INSURANCE I1 INNER JOIN INSURANCE I2 ON I1.PID != I2.PID AND I1.TIV_2015 = I2.TIV_2015 WHERE I1.PID NOT IN (SELECT I1.PID FROM INSURANCE I1 INNER JOIN INSURANCE I2 ON I1.PID != I2.PID AND (I1.LAT = I2.LAT AND I1.LON = I2.LON)))
182,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE PID NOT IN (SELECT PID FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(TIV_2015) = 1) AND PID IN (SELECT PID FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*) = 1)"
183,Y,Y,"SELECT SUM(A.TIV_2016) AS TIV_2016 FROM INSURANCE A WHERE A.TIV_2015 IN ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) >1 ) AND CONCAT(LAT, LON) IN ( SELECT CONCAT(LAT,LON) FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*) = 1)"
184,Y,Y,"SELECT SUM(C.TIV_2016) AS TIV_2016 FROM ( SELECT A.PID, A.TIV_2015,A.TIV_2016,A.LAT,A.LON FROM INSURANCE A INNER JOIN INSURANCE B ON A.TIV_2015 = B.TIV_2015 AND A.PID != B.PID GROUP BY A.PID, A.TIV_2015,A.TIV_2016,A.LAT,A.LON )C LEFT JOIN INSURANCE D ON (C.LAT = D.LAT) AND (C.LON = D.LON) AND C.PID != D.PID WHERE D.PID IS NULL"
185,Y,N,"SELECT SUM(DISTINCT A.TIV_2016) AS TIV_2016 FROM (SELECT * FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*) = 1) AS A, INSURANCE AS B WHERE A.PID != B.PID AND A.TIV_2015 = B.TIV_2015"
186,Y,N,SELECT SUM(DISTINCT I.TIV_2016) AS TIV_2016 FROM INSURANCE I JOIN INSURANCE I1 WHERE I.PID <> I1.PID AND I.TIV_2015 = I1.TIV_2015 AND I.PID NOT IN (SELECT I.PID FROM INSURANCE I JOIN INSURANCE I1 WHERE I.PID <> I1.PID AND I.LAT = I1.LAT AND I.LON = I1.LON)
187,Y,Y,"SELECT SUM(I.TIV_2016) AS TIV_2016 FROM INSURANCE I WHERE I.TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) >1 ) AND CONCAT(I.LAT, I.LON) IN (SELECT CONCAT(LAT,LON) FROM INSURANCE GROUP BY CONCAT(LAT,LON) HAVING COUNT(*)=1)"
188,Y,Y,"SELECT SUM(I.TIV_2016) AS TIV_2016 FROM INSURANCE I WHERE I.TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) > 1 AND CONCAT(LAT, LON) IN ( SELECT CONCAT(LAT, LON) FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*) =1))"
189,Y,Y,"SELECT SUM(I.TIV_2016) AS TIV_2016 FROM INSURANCE I WHERE I.TIV_2015 IN ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*)>1 ) AND CONCAT(LAT,LON) IN ( SELECT CONCAT(LAT,LON) FROM INSURANCE GROUP BY CONCAT(LAT,LON) HAVING COUNT(*)=1 )"
190,Y,Y,"SELECT SUM(I.TIV_2016) AS TIV_2016 FROM INSURANCE I WHERE I.TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(TIV_2015)>1) AND CONCAT(I.LAT,',',I.LON) IN (SELECT CONCAT(LAT, ',', LON) FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*) = 1 )"
191,Y,Y,"SELECT SUM(I1.TIV_2016) AS TIV_2016 FROM INSURANCE I1 WHERE I1.TIV_2015 IN (SELECT I2.TIV_2015 FROM INSURANCE I2 GROUP BY I2.TIV_2015 HAVING COUNT(*)>1) AND CONCAT(I1.LAT, I1.LON) IN (SELECT CONCAT(I3.LAT, I3.LON) FROM INSURANCE I3 GROUP BY I3.LAT, I3.LON HAVING COUNT(*)=1)"
192,Y,Y,"SELECT SUM(I1.TIV_2016) AS TIV_2016 FROM INSURANCE AS I1 WHERE (I1.LAT,I1.LON) NOT IN (SELECT LAT,LON FROM INSURANCE GROUP BY LAT,LON HAVING COUNT(*) >1 ) AND I1.TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) > 1)"
193,Y,Y,"SELECT SUM(I1.TIV_2016) AS TIV_2016 FROM INSURANCE I1 WHERE I1.TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*)>1) AND CONCAT(LAT,LON) IN (SELECT CONCAT(LAT,LON) FROM INSURANCE GROUP BY LAT,LON HAVING COUNT(*)=1)"
194,Y,Y,"SELECT SUM(I1.TIV_2016) AS TIV_2016 FROM INSURANCE I1 WHERE I1.TIV_2015 IN (SELECT I2.TIV_2015 FROM INSURANCE I2 WHERE I1.PID<>I2.PID) AND (I1.LAT,I1.LON) NOT IN (SELECT I3.LAT,I3.LON FROM INSURANCE I3 WHERE I1.PID<>I3.PID)"
195,Y,Y,"SELECT SUM(I_4.TIV_2016) AS TIV_2016 FROM ( SELECT TIV_2016 FROM INSURANCE AS I_1, (SELECT TIV_2015, COUNT(*) FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(TIV_2015) > 1) AS I_2, (SELECT LAT, LON, COUNT(*) FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*) = 1) AS I_3 WHERE I_1.TIV_2015 = I_2.TIV_2015 AND I_1.LAT = I_3.LAT AND I_1.LON = I_3.LON ) I_4"
196,Y,Y,"SELECT SUM(INSURANCE.TIV_2016) AS TIV_2016 FROM INSURANCE WHERE INSURANCE.TIV_2015 IN ( SELECT TIV_2015 FROM INSURANCE GROUP BY 1 HAVING COUNT(*)>1 ) AND (LAT,LON) IN ( SELECT LAT, LON FROM INSURANCE GROUP BY 1,2 HAVING COUNT(*) = 1 )"
197,Y,Y,"SELECT SUM(INSURANCE.TIV_2016) AS TIV_2016 FROM INSURANCE WHERE INSURANCE.TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(TIV_2015) > 1) AND CONCAT(INSURANCE.LAT, INSURANCE.LON) IN(SELECT CONCAT(LAT,LON) FROM INSURANCE GROUP BY LAT,LON HAVING COUNT(*) = 1)"
198,Y,Y,"SELECT SUM(INSURANCE.TIV_2016) AS TIV_2016 FROM INSURANCE WHERE INSURANCE.TIV_2015 IN( SELECT TIV_2015 FROM INSURANCE GROUP BY 1 HAVING COUNT(*) >1 ) AND CONCAT(LAT, LON) IN (SELECT CONCAT(LAT, LON) FROM INSURANCE GROUP BY 1 HAVING COUNT(*) = 1)"
199,Y,Y,"SELECT SUM(INSURANCE.TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(TIV_2015)>1 ) AND CONCAT(LAT,',',LON) IN (SELECT CONCAT(LAT,',',LON) FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(CONCAT(LAT,',',LON)) <2)"
200,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM (SELECT DISTINCT A.PID, A.TIV_2016 FROM INSURANCE A INNER JOIN INSURANCE B ON A.TIV_2015 = B.TIV_2015 AND A.PID <> B.PID WHERE A.PID NOT IN (SELECT A.PID FROM INSURANCE A INNER JOIN INSURANCE B ON A.LAT = B.LAT AND A.LON = B.LON AND A.PID <> B.PID) ) A"
201,Y,Y,"SELECT SUM(TIV_2016) TIV_2016 FROM ( SELECT DISTINCT I1.PID, I1.TIV_2016 FROM INSURANCE I1 JOIN INSURANCE I2 ON I1.TIV_2015 = I2.TIV_2015 AND I1.PID <> I2.PID JOIN (SELECT LAT, LON FROM INSURANCE GROUP BY 1,2 HAVING COUNT(*) = 1 ) LOC ON I1.LAT = LOC.LAT AND I1.LON = LOC.LON ) A"
202,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) > 1) AND CONCAT(LAT,LON) NOT IN (SELECT CONCAT(LAT,LON) FROM INSURANCE GROUP BY CONCAT(LAT,LON) HAVING COUNT(*)>1)"
203,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*)>1) AND (LON, LAT) IN (SELECT LON, LAT FROM INSURANCE GROUP BY LON, LAT HAVING COUNT(LAT)=1)"
204,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*)>1) AND (LON, LAT) IN (SELECT LON, LAT LAT FROM INSURANCE GROUP BY LON, LAT HAVING COUNT(LAT)=1)"
205,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM ( SELECT TIV_2015, TIV_2016, LAT, LON, COUNT(TIV_2015)OVER(PARTITION BY TIV_2015) AS CNT_TIV_2015, COUNT(LAT)OVER(PARTITION BY LAT, LON) AS CNT_LAT, COUNT(LON)OVER(PARTITION BY LAT, LON) AS CNT_LON FROM INSURANCE)SUB WHERE CNT_TIV_2015 > 1 AND CNT_LAT = 1 AND CNT_LON = 1"
206,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE AS I WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE WHERE PID<> I.PID) AND (LAT,LON) IN (SELECT LAT,LON FROM INSURANCE GROUP BY LAT,LON HAVING COUNT(LAT)=1)"
207,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE PID IN (SELECT DISTINCT PID FROM (SELECT PID, COUNT(*) OVER(PARTITION BY TIV_2015) AS NUM15, COUNT(*) OVER(PARTITION BY CONCAT(LAT,LON)) AS NUM_LOC FROM INSURANCE) X WHERE NUM15>1 AND NUM_LOC=1 )"
208,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN ( SELECT TIV_2015 FROM INSURANCE GROUP BY 1 HAVING COUNT(*)>1) AND (LAT,LON) NOT IN (SELECT LAT,LON FROM INSURANCE GROUP BY 1,2 HAVING COUNT(*)>1)"
209,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN ( SELECT TIV_2015 FROM INSURANCE GROUP BY 1 HAVING COUNT(PID)>1) AND CONCAT(LAT,LON) IN ( SELECT CONCAT(LAT,LON) FROM INSURANCE GROUP BY 1 HAVING COUNT(PID)=1)"
210,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(TIV_2015) >= 2 ) AND CONCAT(LAT, LON) IN ( SELECT CONCAT(LAT, LON) FROM INSURANCE GROUP BY CONCAT(LAT, LON) HAVING COUNT(CONCAT(LAT, LON)) = 1 )"
211,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY 1 HAVING COUNT(*)>1) AND PID IN (SELECT PID FROM INSURANCE WHERE CONCAT(LAT, LON) IN (SELECT CONCAT(LAT, LON) AS LO FROM INSURANCE GROUP BY 1 HAVING COUNT(*)=1))"
212,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY 1 HAVING COUNT(DISTINCT PID) > 1) AND CONCAT(LAT,LON) NOT IN (SELECT CONCAT(LAT,LON) FROM INSURANCE GROUP BY 1 HAVING COUNT(DISTINCT PID) > 1)"
213,Y,Y,"SELECT SUM(TIV_2016) AS TIV_2016 FROM( SELECT * , COUNT(PID) OVER (PARTITION BY TIV_2015) AS NUM_2015 FROM INSURANCE) AS TEMP WHERE NUM_2015>=2 AND PID NOT IN ( SELECT I1.PID FROM INSURANCE AS I1 INNER JOIN (SELECT PID, LAT, LON FROM INSURANCE) AS I2 ON I1.PID != I2.PID WHERE I1.LAT=I2.LAT AND I1.LON=I2.LON )"
214,Y,N,"SELECT SUM(TIV_2016) TIV_2016 FROM ( SELECT DISTINCT TIV_2016, COUNT(*) OVER (PARTITION BY TIV_2015) CNT1, COUNT(*) OVER (PARTITION BY CONCAT(LAT,LON)) CNT2 FROM INSURANCE ) T WHERE CNT1 >1 AND CNT2=1"
215,Y,Y,"SELECT SUM(TIV_2016) TIV_2016 FROM (SELECT *, COUNT(*) OVER (PARTITION BY LAT,LON) CNT, COUNT(*) OVER (PARTITION BY TIV_2015) TIV FROM INSURANCE ) Z WHERE CNT=1 AND TIV>1"
216,Y,Y,"SELECT SUM(TIV_2016) TIV_2016 FROM INSURANCE WHERE PID NOT IN (SELECT PID FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(PID)=1) AND PID IN (SELECT PID FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(PID) = 1)"
217,Y,Y,"SELECT SUM_TIV_2016 AS TIV_2016 FROM ( SELECT SUM(TIV_2016) AS SUM_TIV_2016 FROM INSURANCE AS INS JOIN (SELECT TIV_2015, COUNT(*) AS COUNT_TIV FROM INSURANCE GROUP BY 1 HAVING COUNT_TIV > 1) AS TIV ON INS.TIV_2015 = TIV.TIV_2015 JOIN (SELECT LAT, LON, COUNT(*) AS COUNT_LOC FROM INSURANCE GROUP BY 1, 2 HAVING COUNT_LOC = 1) AS LOC ON INS.LAT = LOC.LAT AND INS.LON = LOC.LON ) A"
218,Y,Y,"WITH I1 AS ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*)>1 ), T2 AS ( SELECT LAT, LON FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*)=1 ) SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM I1) AND CONCAT(LAT,LON) IN (SELECT CONCAT(LAT,LON) FROM T2)"
219,Y,N,"WITH A AS (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(PID)>1) , B AS ( SELECT TIV_2016 FROM INSURANCE GROUP BY LAT,LON HAVING COUNT(PID)=1 ) , C AS ( SELECT TIV_2016 FROM INSURANCE WHERE TIV_2015 IN ( SELECT TIV_2015 FROM A) ) SELECT SUM(TIV_2016) AS TIV_2016 FROM C WHERE TIV_2016 IN ( SELECT TIV_2016 FROM B)"
220,Y,Y,"WITH A AS( SELECT TIV_2015, COUNT(TIV_2015) FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(TIV_2015) > 1), B AS (SELECT PID, LAT, LON FROM INSURANCE WHERE CONCAT(LAT,LON) NOT IN (SELECT CONCAT(LAT,LON) FROM INSURANCE GROUP BY 1 HAVING COUNT(*) > 1) ) SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE WHERE PID IN (SELECT PID FROM B) AND TIV_2015 IN (SELECT TIV_2015 FROM A)"
221,Y,Y,"WITH CONDITIONS AS ( SELECT * , COUNT(1) OVER(PARTITION BY LAT, LON) AS CITY_COUNT , COUNT(1) OVER(PARTITION BY TIV_2015) AS TIV_15_COUNT FROM INSURANCE ) SELECT SUM(TIV_2016) AS TIV_2016 FROM CONDITIONS WHERE CITY_COUNT = 1 AND TIV_15_COUNT > 1"
222,Y,Y,"WITH CRITERIA AS ( SELECT *,COUNT(*) OVER(PARTITION BY LAT,LON) AS CNT, COUNT(*) OVER(PARTITION BY TIV_2015) AS VAL FROM INSURANCE ) SELECT SUM(TIV_2016) AS TIV_2016 FROM CRITERIA WHERE CNT=1 AND VAL>1"
223,Y,Y,"WITH CTE AS ( SELECT * FROM INSURANCE GROUP BY LAT,LON HAVING COUNT(LAT+'-'+LON) = 1 ) , CTE2 AS ( SELECT * FROM INSURANCE WHERE TIV_2015 IN ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(1) > 1 ) ) SELECT SUM(TIV_2016) TIV_2016 FROM INSURANCE WHERE PID IN (SELECT PID FROM CTE) AND PID IN (SELECT PID FROM CTE2)"
224,Y,Y,"WITH CTE AS ( SELECT LAT, LON FROM INSURANCE GROUP BY LAT,LON HAVING COUNT(*) = 1 ), CTE2 AS ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) >1 ) SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE WHERE (LAT, LON) IN (SELECT * FROM CTE) AND (TIV_2015 IN ( SELECT * FROM CTE2))"
225,Y,Y,"WITH CTE AS ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(TIV_2015) > 1 ) , CTE2 AS ( SELECT LAT,LON FROM INSURANCE GROUP BY 1,2 HAVING COUNT(LAT) = 1 ) SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM CTE) AND (LAT,LON) IN (SELECT LAT,LON FROM CTE2)"
226,Y,Y,"WITH CTE AS ( SELECT I1.PID FROM INSURANCE AS I1 JOIN INSURANCE AS I2 ON I1.TIV_2015=I2.TIV_2015 AND I1.PID!=I2.PID ), CTE2 AS ( SELECT I1.PID FROM INSURANCE AS I1 JOIN INSURANCE AS I2 ON I1.LAT=I2.LAT AND I1.LON=I2.LON AND I1.PID<>I2.PID ), DEMO AS ( SELECT DISTINCT PID FROM CTE WHERE PID NOT IN (SELECT PID FROM CTE2) ) SELECT SUM(I.TIV_2016) AS TIV_2016 FROM DEMO AS D JOIN INSURANCE AS I ON D.PID=I.PID"
227,Y,Y,"WITH CTE AS ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(TIV_2015) > 1 ), CTE1 AS ( SELECT LAT, LON FROM INSURANCE GROUP BY 1, 2 HAVING COUNT(*) = 1 ), CTE2 AS ( SELECT TIV_2016 FROM INSURANCE I JOIN CTE ON I.TIV_2015 = CTE.TIV_2015 JOIN CTE1 ON I.LAT = CTE1.LAT AND I.LON = CTE1.LON ) SELECT SUM(TIV_2016) TIV_2016 FROM CTE2"
228,Y,Y,"WITH CTE AS (SELECT PID,TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY 1 HAVING COUNT(TIV_2015)>1) AND (LAT,LON) IN (SELECT LAT,LON FROM INSURANCE GROUP BY LAT,LON HAVING COUNT(PID)=1)) SELECT SUM(TIV_2016) AS TIV_2016 FROM CTE"
229,Y,Y,"WITH CTE AS (SELECT TIV_2015 FROM INSURANCE GROUP BY 1 HAVING COUNT(*) > 1), CTE2 AS (SELECT CONCAT(LAT, LON) AS CITY FROM INSURANCE GROUP BY 1 HAVING COUNT(*) = 1) SELECT SUM(IFNULL(TIV_2016,0)) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM CTE) AND CONCAT(LAT, LON) IN (SELECT CITY FROM CTE2)"
230,Y,Y,"WITH CTE AS( SELECT *, COUNT(PID) OVER (PARTITION BY TIV_2015) AS CNT1, COUNT(PID) OVER (PARTITION BY LAT, LON) AS CNT2 FROM INSURANCE ) SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM CTE WHERE CNT1>1 AND CNT2=1"
231,Y,Y,"WITH CTE AS( SELECT *, DENSE_RANK()OVER(ORDER BY TIV_2015 ASC)AS SAME_TIV, DENSE_RANK()OVER(ORDER BY LAT,LON ASC)AS SAME_LAT FROM INSURANCE), CTE2 AS( SELECT PID, COUNT(PID)OVER(PARTITION BY SAME_TIV) AS TIVCOUNT, COUNT(PID)OVER(PARTITION BY SAME_LAT)AS LATCOUNT, TIV_2016 FROM CTE) SELECT SUM(TIV_2016) AS TIV_2016 FROM CTE2 WHERE LATCOUNT = 1 AND TIVCOUNT >1"
232,Y,Y,"WITH CTE AS( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(PID)>1 ), CTE2 AS ( SELECT CONCAT(LAT,LON)AS LOC1 FROM INSURANCE GROUP BY CONCAT(LAT,LON) HAVING COUNT(PID)=1 ) SELECT SUM(TIV_2016)AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT DISTINCT TIV_2015 FROM CTE) AND CONCAT(LAT,LON) IN (SELECT LOC1 FROM CTE2)"
233,Y,Y,"WITH CTE AS( SELECT TIV_2016, COUNT(PID) OVER(PARTITION BY TIV_2015 ) AS CONDITION1, COUNT(PID) OVER(PARTITION BY LAT, LON) AS CONDITION2 FROM INSURANCE ) SELECT SUM(TIV_2016) AS TIV_2016 FROM CTE WHERE CONDITION1 >= 2 AND CONDITION2 = 1"
234,Y,Y,"WITH CTE AS(SELECT TIV_2015, COUNT(*) AS NUM FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) >=2), CTE2 AS(SELECT COUNT(PID) AS CNT, CONCAT_WS(',', LAT, LON) AS LOC FROM INSURANCE GROUP BY 2 HAVING COUNT(PID) = 1 ) SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM CTE) AND CONCAT_WS(',', LAT, LON) IN (SELECT LOC FROM CTE2)"
235,Y,Y,"WITH CTE AS(SELECT DISTINCT A.PID, A.LAT, A.LON FROM INSURANCE A JOIN INSURANCE B ON A.PID != B.PID AND A.TIV_2015 = B.TIV_2015), TMP AS( SELECT PID FROM CTE WHERE CONCAT(LAT, LON) NOT IN (SELECT CONCAT(LAT,LON) FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*)>1)) SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE PID IN (SELECT PID FROM TMP)"
236,Y,Y,"WITH CTE1 AS ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) > 1 ), CTE2 AS ( SELECT LAT,LON FROM INSURANCE GROUP BY LAT,LON HAVING COUNT(*) = 1 ) SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT * FROM CTE1) AND (LAT,LON) IN (SELECT * FROM CTE2)"
237,Y,Y,"WITH CTE1 AS( SELECT TIV_2015, COUNT(PID) AS COUNT15 FROM INSURANCE I GROUP BY TIV_2015), CTE2 AS( SELECT CONCAT(LAT,LON) AS LOC, COUNT(PID) AS COUNTLOC FROM INSURANCE I GROUP BY CONCAT(LAT,LON) ) SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE I WHERE TIV_2015 IN (SELECT TIV_2015 FROM CTE1 WHERE COUNT15 >1) AND CONCAT(LAT,LON) IN (SELECT LOC FROM CTE2 WHERE COUNTLOC =1)"
238,Y,Y,"WITH F1 AS( SELECT DISTINCT A.PID FROM INSURANCE A CROSS JOIN INSURANCE B WHERE A.TIV_2015 = B.TIV_2015 AND A.PID != B.PID ), F2 AS( SELECT PID FROM INSURANCE WHERE (LAT, LON) NOT IN (SELECT LAT, LON FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*) > 1)) SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE PID IN (SELECT F1.PID FROM F1 JOIN F2 USING(PID))"
239,Y,Y,"WITH INSUR_PLUS AS ( SELECT *, CONCAT(LAT, '-', LON) AS LAT_LON FROM INSURANCE ) SELECT SUM(I1.TIV_2016) AS TIV_2016 FROM INSUR_PLUS AS I1 WHERE I1.TIV_2015 IN ( SELECT I2.TIV_2015 FROM INSUR_PLUS I2 WHERE I1.PID != I2.PID) AND I1.LAT_LON NOT IN ( SELECT I3.LAT_LON FROM INSUR_PLUS I3 WHERE I1.PID != I3.PID)"
240,Y,Y,"WITH INSUR_PLUS AS ( SELECT *, CONCAT(LAT, '-', LON) AS LAT_LON FROM INSURANCE ) SELECT SUM(TIV_2016) AS TIV_2016 FROM INSUR_PLUS AS I1 WHERE TIV_2015 IN ( SELECT TIV_2015 FROM INSUR_PLUS GROUP BY TIV_2015 HAVING COUNT(*) > 1) AND LAT_LON NOT IN ( SELECT LAT_LON FROM INSUR_PLUS GROUP BY LAT_LON HAVING COUNT(*) > 1)"
241,Y,Y,"WITH INSURANCE_CTE AS ( SELECT * ,COUNT(PID) OVER(PARTITION BY TIV_2015) AS TIV_2015_CNT ,COUNT(PID) OVER(PARTITION BY LAT, LON) AS PK_CNT FROM INSURANCE ) SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE_CTE WHERE TIV_2015_CNT >= 2 AND PK_CNT = 1"
242,Y,Y,"WITH LAT_LON AS ( SELECT LAT, LON, COUNT(*) AS CNT FROM INSURANCE GROUP BY 1,2 ) SELECT SUM(TIV_2016) AS TIV_2016 FROM ( SELECT DISTINCT(A.PID), A.TIV_2016 FROM INSURANCE A LEFT JOIN INSURANCE B ON A.TIV_2015 = B.TIV_2015 AND A.PID != B.PID LEFT JOIN LAT_LON C ON A.LAT = C.LAT AND A.LON = C.LON WHERE B.PID IS NOT NULL AND CNT = 1) A"
243,Y,Y,"WITH LOCATION_COUNTS_1 AS ( SELECT LAT, LON, COUNT(DISTINCT PID) AS LATLON_COUNT FROM INSURANCE GROUP BY LAT,LON HAVING COUNT(*) = 1 ) , PIDS_WITH_UNIQUE_LOCATION AS ( SELECT DISTINCT I.PID, L.LATLON_COUNT FROM INSURANCE I INNER JOIN LOCATION_COUNTS_1 L ON I.LAT = L.LAT AND I.LON = L.LON ) , PIDS_WITH_NONUNIQUE_TIV2015S AS ( SELECT DISTINCT I.PID FROM INSURANCE I INNER JOIN INSURANCE I2 ON I.PID != I2.PID AND I.TIV_2015 = I2.TIV_2015 ) SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE I INNER JOIN PIDS_WITH_UNIQUE_LOCATION U ON U.PID = I.PID INNER JOIN PIDS_WITH_NONUNIQUE_TIV2015S N ON N.PID = I.PID"
244,Y,Y,"WITH SAME_TIV_2015 AS ( SELECT TIV_2015 FROM INSURANCE I GROUP BY 1 HAVING COUNT(DISTINCT PID) >= 2 ) , LAT_LON_UNIQUE AS ( SELECT LAT, LON FROM INSURANCE I GROUP BY 1, 2 HAVING COUNT(DISTINCT PID) = 1 ) SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE I INNER JOIN SAME_TIV_2015 TIV ON TIV.TIV_2015 = I.TIV_2015 INNER JOIN LAT_LON_UNIQUE LLU ON LLU.LAT = I.LAT AND LLU.LON = I.LON"
245,Y,Y,"WITH SAME_TIV_2015 AS ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(1) > 1 ), DIFF_LAT_LONG AS ( SELECT LAT, LON FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(1) = 1 ) SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE I1 WHERE ( TIV_2015 IN (SELECT * FROM SAME_TIV_2015) ) AND ( (LAT,LON) IN (SELECT * FROM DIFF_LAT_LONG) )"
246,Y,Y,"WITH SAME_TIV_2015 AS ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(1) > 1 ), DIFF_LAT_LONG AS ( SELECT LAT, LON, COUNT(1) FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(1) = 1 ) SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE I1 INNER JOIN SAME_TIV_2015 R1 ON I1.TIV_2015 = R1.TIV_2015 INNER JOIN DIFF_LAT_LONG R2 ON I1.LAT = R2.LAT AND I1.LON = R2.LON"
247,Y,Y,"WITH SAME_TIV_2015 AS (SELECT I.TIV_2015 FROM INSURANCE I GROUP BY I.TIV_2015 HAVING COUNT(I.TIV_2015)>1), DIFF_LAT AS (SELECT I2.LAT, I2.LON FROM INSURANCE I2 GROUP BY I2.LAT, I2.LON HAVING(COUNT(I2.LAT)=1)) SELECT SUM(I3.TIV_2016) AS TIV_2016 FROM INSURANCE I3 WHERE I3.TIV_2015 IN (SELECT TIV_2015 FROM SAME_TIV_2015) AND (I3.LAT,I3.LON) IN (SELECT LAT,LON FROM DIFF_LAT)"
248,Y,Y,"WITH SAME_TIV_2015 AS (SELECT TIV_2015, COUNT(*) FROM INSURANCE GROUP BY 1 HAVING COUNT(*) > 1), DIFF_LOC AS (SELECT LAT, LON, COUNT(*) FROM INSURANCE GROUP BY 1, 2 HAVING COUNT(*) = 1 ) SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM SAME_TIV_2015) AND CONCAT(LAT,',',LON) IN (SELECT CONCAT(LAT,',',LON) FROM DIFF_LOC)"
249,Y,Y,"WITH SAME_VALUE AS ( SELECT PID FROM INSURANCE WHERE TIV_2015 IN ( SELECT A.TIV_2015 FROM (SELECT TIV_2015,COUNT(PID) FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(PID)>1) A) ), NOTSAME_VALUE AS ( SELECT PID FROM INSURANCE WHERE CONCAT(LAT,LON) NOT IN ( SELECT A.LT FROM (SELECT CONCAT(LAT,LON) AS LT,COUNT(PID) FROM INSURANCE GROUP BY CONCAT(LAT,LON) HAVING COUNT(PID)>1) A) ) SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE WHERE PID IN (SELECT SAME_VALUE.PID FROM SAME_VALUE,NOTSAME_VALUE WHERE NOTSAME_VALUE.PID=SAME_VALUE.PID)"
250,Y,Y,"WITH SHORT_BY_TIV AS ( SELECT TIV_2015, COUNT(DISTINCT PID) AS C FROM INSURANCE GROUP BY TIV_2015 ) , PART1 AS( SELECT I.* FROM INSURANCE AS I INNER JOIN SHORT_BY_TIV AS T ON T.TIV_2015=I.TIV_2015 AND C>1 ), SHORT_BY_LATLON AS ( SELECT KE, COUNT(DISTINCT PID) AS PP FROM (SELECT CONCAT(LAT,LON) AS KE,PID FROM INSURANCE ) AS SAMPLE GROUP BY KE ) , PART2 AS( SELECT INS.* FROM (SELECT I.PID FROM (SELECT PID,CONCAT(LAT,LON) AS KE FROM INSURANCE ) AS I INNER JOIN SHORT_BY_LATLON AS T ON T.KE=I.KE AND PP=1 ) AS ABC INNER JOIN INSURANCE AS INS ON INS.PID=ABC.PID ) ,ANS AS ( SELECT P1.PID, P1.TIV_2015,P1.TIV_2016,P1.LAT,P1.LON FROM PART1 AS P1 INNER JOIN PART2 AS P2 ON P1.PID=P2.PID) SELECT SUM(TIV_2016) AS TIV_2016 FROM ANS"
251,Y,Y,"WITH T AS (SELECT DISTINCT B.PID FROM INSURANCE AS A INNER JOIN INSURANCE AS B ON A.PID <> B.PID AND CONCAT(A.LAT,',',A.LON) = CONCAT(B.LAT,',',B.LON) ) , T2 AS(SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*)>1) SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*)>1) AND PID NOT IN (SELECT DISTINCT B.PID FROM INSURANCE AS A INNER JOIN INSURANCE AS B ON A.PID <> B.PID AND CONCAT(A.LAT,',',A.LON) = CONCAT(B.LAT,',',B.LON))"
252,Y,Y,"WITH T AS( SELECT *, COUNT(TIV_2015) OVER(PARTITION BY TIV_2015) AS NUM_SAME_TIV_2015, COUNT(LAT) OVER(PARTITION BY LAT,LON) AS NUM_SAME_LAT_LON FROM INSURANCE ) SELECT SUM(TIV_2016) AS TIV_2016 FROM T WHERE NUM_SAME_TIV_2015 > 1 AND NUM_SAME_LAT_LON = 1"
253,Y,Y,"WITH T1 AS ( SELECT PID, TIV_2016 FROM ( SELECT PID, TIV_2016, COUNT(*) OVER(PARTITION BY TIV_2015) AS COUNT_2015 FROM INSURANCE) AS T3 WHERE COUNT_2015 >1 ), T2 AS ( SELECT PID, TIV_2016 FROM ( SELECT PID, TIV_2016, COUNT(*) OVER(PARTITION BY CONCAT(LAT, LON)) AS COUNT_LOC FROM INSURANCE) AS T4 WHERE COUNT_LOC =1 ) SELECT SUM(TIV_2016) AS TIV_2016 FROM T1 WHERE PID IN (SELECT PID FROM T2)"
254,Y,Y,"WITH T1 AS ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*)>1), T2 AS ( SELECT LAT,LON FROM INSURANCE GROUP BY LAT,LON HAVING COUNT(*)=1) SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM T1) AND (LAT,LON) IN (SELECT LAT,LON FROM T2)"
255,Y,Y,"WITH T1 AS ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(TIV_2015) > 1 ), T2 AS( SELECT CONCAT(LAT,LON) AS A FROM INSURANCE GROUP BY 1 HAVING COUNT(*) = 1 ) SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM T1) AND CONCAT(LAT,LON) IN (SELECT A FROM T2)"
256,Y,Y,"WITH T1 AS (SELECT PID FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) = 1), T2 AS (SELECT PID FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*) = 1) SELECT ROUND(SUM(TIV_2016), 2) AS TIV_2016 FROM INSURANCE WHERE PID NOT IN (SELECT * FROM T1) AND PID IN (SELECT * FROM T2)"
257,Y,Y,"WITH T2015 AS ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(1)>1) , LOCATION AS ( SELECT PID, COUNT(1) OVER( PARTITION BY LAT,LON) AS C FROM INSURANCE ) SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE I INNER JOIN T2015 T ON I.TIV_2015 = T.TIV_2015 INNER JOIN LOCATION L ON L.PID = I.PID WHERE L.C=1"
258,Y,Y,"WITH TEMP AS ( SELECT * , COUNT(*) OVER (PARTITION BY LAT,LON) CNT, COUNT(*) OVER (PARTITION BY TIV_2015) TIV FROM INSURANCE ) SELECT SUM(TIV_2016) AS TIV_2016 FROM TEMP WHERE TIV > 1 AND CNT = 1"
259,Y,Y,"WITH TIV AS (SELECT PID FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(TIV_2015) > 1)), LOC AS (SELECT PID FROM INSURANCE GROUP BY CONCAT(LAT,LON) HAVING COUNT(CONCAT(LAT,LON)) = 1) SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE PID IN (SELECT PID FROM TIV) AND PID IN (SELECT PID FROM LOC)"
260,Y,Y,"WITH TIV15 AS ( SELECT TIV_2015 FROM INSURANCE GROUP BY 1 HAVING COUNT(*) > 1 ), NOT_UNIQUE_CITY AS ( SELECT LAT, LON FROM INSURANCE GROUP BY 1, 2 HAVING COUNT(*) > 1 ) SELECT ROUND(SUM(TIV_2016), 2) TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT * FROM TIV15) AND (LAT, LON) NOT IN (SELECT * FROM NOT_UNIQUE_CITY)"
261,Y,Y,"WITH TIV15 AS ( SELECT TIV_2015 FROM INSURANCE GROUP BY 1 HAVING COUNT(*) > 1 ), UNIQUE_CITY AS ( SELECT LAT, LON FROM INSURANCE GROUP BY 1, 2 HAVING COUNT(*) = 1 ) SELECT ROUND(SUM(TIV_2016), 2) TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT * FROM TIV15) AND (LAT, LON) IN (SELECT * FROM UNIQUE_CITY)"
262,Y,Y,"WITH TIV_COUNT AS ( SELECT TIV_2015 FROM INSURANCE GROUP BY 1 HAVING COUNT(PID) >1 ), LAT_LON_COUNT AS ( SELECT LAT,LON FROM INSURANCE GROUP BY 1,2 HAVING COUNT(PID) =1 ) SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM TIV_COUNT) AND LAT IN (SELECT LAT FROM LAT_LON_COUNT) AND LON IN (SELECT LON FROM LAT_LON_COUNT)"
263,Y,Y,"WITH TMP1 AS (SELECT DISTINCT T1.PID FROM INSURANCE T1, INSURANCE T2 WHERE T1.PID <> T2.PID AND T1.TIV_2015 = T2.TIV_2015), TMP2 AS ( SELECT T1.PID FROM INSURANCE T1, INSURANCE T2 WHERE T1.PID <> T2.PID AND CONCAT(T1.LAT, T1.LON) = CONCAT(T2.LAT, T2.LON) GROUP BY 1 ) SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE PID IN (SELECT PID FROM TMP1) AND PID NOT IN (SELECT PID FROM TMP2)"
264,Y,Y,"WITH TMP1CTE AS ( SELECT *, RANK() OVER (ORDER BY TIV_2015 ASC) AS SAME_TIV, RANK() OVER (ORDER BY LAT, LON ASC) AS SAME_LOC FROM INSURANCE ), TMP2CTE AS ( SELECT PID,COUNT(PID) OVER (PARTITION BY SAME_TIV) AS REPEATED_TIV, COUNT(PID) OVER (PARTITION BY SAME_LOC) AS REPEATED_LOC, TIV_2016 FROM TMP1CTE ) SELECT SUM(TIV_2016) AS TIV_2016 FROM TMP2CTE WHERE REPEATED_TIV > 1 AND REPEATED_LOC = 1"
265,Y,Y,"WITH TP1 AS( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) > 1) , TP2 AS( SELECT LAT, LON FROM INSURANCE GROUP BY LAT,LON HAVING COUNT(*) = 1 ) SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM TP1) AND (LAT,LON) IN (SELECT LAT,LON FROM TP2)"
266,Y,Y,"WITH UNIQUE_LOCATIONS AS ( SELECT LAT, LON FROM INSURANCE GROUP BY 1,2 HAVING COUNT(1) = 1 ), PREVIOUS_YEAR_NON_UNIQUE AS ( SELECT TIV_2015 FROM INSURANCE GROUP BY 1 HAVING COUNT(1) > 1 ) SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM PREVIOUS_YEAR_NON_UNIQUE) AND (LAT,LON) IN (SELECT LAT, LON FROM UNIQUE_LOCATIONS)"
267,Y,Y,"WITH UNIQUE_LOCATIONS AS ( SELECT LAT, LON FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(PID) = 1 ), TIVS AS ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(PID) > 1 ) SELECT SUM(I.TIV_2016) AS TIV_2016 FROM INSURANCE I INNER JOIN UNIQUE_LOCATIONS U ON U.LAT = I.LAT AND U.LON = I.LON INNER JOIN TIVS T ON T.TIV_2015 = I.TIV_2015"
268,Y,Y,"WITH W AS ( SELECT *, COUNT(*) OVER (PARTITION BY TIV_2015) AS SAME_TIV_2015, COUNT(*) OVER (PARTITION BY LAT, LON) AS UNIQUE_GEO FROM INSURANCE ) SELECT SUM(TIV_2016) AS TIV_2016 FROM W WHERE SAME_TIV_2015 > 1 AND UNIQUE_GEO = 1"
269,Y,Y,"WITH XYZ AS ( SELECT TIV_2015, COUNT(TIV_2015) AS CNT FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(TIV_2015)<>1) , ABC AS( SELECT CONCAT(LAT,LON) LOCATION, COUNT(1) FROM INSURANCE GROUP BY CONCAT(LAT,LON) HAVING COUNT(1)=1 ) SELECT SUM(TIV_2016) AS TIV_2016 FROM INSURANCE I WHERE I.TIV_2015 IN (SELECT DISTINCT TIV_2015 FROM XYZ) AND CONCAT(I.LAT,I.LON) IN (SELECT DISTINCT LOCATION FROM ABC )"
270,Y,Y,"SELECT ROUND(SUM(INSURANCE.TIV_2016),2) AS TIV_2016 FROM INSURANCE WHERE INSURANCE.TIV_2015 IN ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) > 1 ) AND CONCAT(LAT, LON) IN ( SELECT CONCAT(LAT, LON) FROM INSURANCE GROUP BY LAT , LON HAVING COUNT(*) = 1 )"
271,Y,Y,"SELECT ROUND(SUM(I.TIV_2016),2) AS TIV_2016 FROM INSURANCE I WHERE I.TIV_2015 IN (SELECT BB.TIV_2015 FROM INSURANCE BB WHERE BB.PID != I.PID) AND CONCAT(I.LAT, I.LON) NOT IN (SELECT CONCAT(AA.LAT, AA.LON) FROM INSURANCE AA WHERE AA.PID != I.PID)"
272,Y,Y,"SELECT ROUND(SUM(A.TIV_2016),2) AS TIV_2016 FROM INSURANCE A WHERE A.TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE B WHERE A.PID!=B.PID ) AND CONCAT(A.LAT, A.LON) NOT IN (SELECT CONCAT(C.LAT, C.LON) FROM INSURANCE C WHERE A.PID!=C.PID)"
273,Y,Y,"WITH T1 AS( SELECT PID, DENSE_RANK() OVER(ORDER BY TIV_2015) DEN_TIV FROM INSURANCE), T2 AS( SELECT PID, DEN_TIV FROM T1 HAVING DEN_TIV IN ( SELECT DEN_TIV FROM T1 GROUP BY 1 HAVING COUNT(DEN_TIV) > 1)), T3 AS( SELECT * FROM INSURANCE HAVING PID IN (SELECT PID FROM T2)) SELECT ROUND(SUM(TIV_2016),2) TIV_2016 FROM( SELECT DISTINCT PID, TIV_2016 FROM T3 HAVING PID NOT IN ( SELECT T3.PID FROM T3 JOIN INSURANCE T4 ON T3.PID != T4.PID AND (T3.LAT = T4.LAT AND T3.LON = T4.LON))) T4"
274,Y,N,"SELECT ROUND(SUM(DISTINCT A.TIV_2016),2) AS TIV_2016 FROM INSURANCE A INNER JOIN INSURANCE B ON A.PID!=B.PID AND A.TIV_2015=B.TIV_2015 WHERE CONCAT(A.LAT,A.LON) NOT IN (SELECT CONCAT(LAT,LON) FROM INSURANCE C WHERE A.PID!=C.PID)"
275,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE I1 WHERE 1 = (SELECT COUNT(*) FROM INSURANCE B WHERE I1.LAT = B.LAT AND I1.LON = B.LON) AND 1 < (SELECT COUNT(*) FROM INSURANCE C WHERE I1.TIV_2015 = C.TIV_2015)"
276,Y,Y,"SELECT ROUND(SUM(A.TIV_2016),2) AS TIV_2016 FROM INSURANCE A WHERE 1=(SELECT COUNT(*) FROM INSURANCE B WHERE A.LAT=B.LAT AND A.LON=B.LON) AND 1<(SELECT COUNT(*) FROM INSURANCE C WHERE A.TIV_2015=C.TIV_2015 GROUP BY C.TIV_2015)"
277,Y,N,"SELECT ROUND(SUM(DISTINCT(I1.TIV_2016)), 2) AS TIV_2016 FROM INSURANCE I1 INNER JOIN INSURANCE I2 ON I1.PID != I2.PID AND I1.TIV_2015 = I2.TIV_2015 AND I1.LAT!=I2.LAT AND I1.LON!=I2.LON AND (I1.LAT, I1.LON) NOT IN (SELECT LAT, LON FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*) > 1)"
278,Y,Y,"SELECT ROUND(SUM(TIV_2016), 2) AS TIV_2016 FROM INSURANCE I1 WHERE 1 < (SELECT COUNT(*) FROM INSURANCE I2 WHERE I1.TIV_2015 = I2.TIV_2015) AND 1 = (SELECT COUNT(*) FROM INSURANCE I2 WHERE I1.LAT = I2.LAT AND I1.LON = I2.LON)"
279,Y,Y,"SELECT ROUND(SUM(TMP.TIV_2016),2) AS TIV_2016 FROM( SELECT PID, TIV_2016, COUNT(TIV_2015) OVER(PARTITION BY TIV_2015) AS COUNT_2015, COUNT(PID) OVER(PARTITION BY LAT, LON ) AS LOCATION FROM INSURANCE) AS TMP WHERE TMP.COUNT_2015 >1 AND TMP.LOCATION = 1"
280,Y,Y,"SELECT ROUND(SUM(TIV_2016), 2) TIV_2016 FROM INSURANCE A WHERE TIV_2015 IN (SELECT B.TIV_2015 FROM INSURANCE B WHERE A.PID!=B.PID) AND CONCAT(LAT,LON) NOT IN (SELECT CONCAT(C.LAT, C.LON) FROM INSURANCE C WHERE A.PID!=C.PID)"
281,Y,N,"SELECT ROUND(SUM(DISTINCT(I1.TIV_2016)),2) AS TIV_2016 FROM INSURANCE I1 INNER JOIN INSURANCE I2 ON (I1.TIV_2015 = I2.TIV_2015) AND I1.PID!=I2.PID WHERE (CONCAT(I1.LAT,I1.LON) NOT IN (SELECT CONCAT(I3.LAT,I3.LON) FROM INSURANCE I3 WHERE I1.PID!=I3.PID))"
282,Y,Y,"SELECT ROUND(SUM(I1.TIV_2016),2) AS TIV_2016 FROM INSURANCE AS I1 WHERE I1.TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) > 1) AND (I1.LAT, I1.LON) NOT IN (SELECT LAT, LON FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*) > 1)"
283,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE WHERE (LAT, LON) IN (SELECT LAT, LON FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*) = 1) AND TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) >= 2)"
284,Y,Y,"WITH T AS ( SELECT DISTINCT A.* FROM INSURANCE A LEFT JOIN INSURANCE B ON A.TIV_2015 = B.TIV_2015 AND A.PID != B.PID WHERE B.PID IS NOT NULL ) SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM T WHERE (LAT,LON) NOT IN (SELECT LAT, LON FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(DISTINCT PID) > 1)"
285,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE WHERE (TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(PID)>1)) AND ((LAT, LON) NOT IN (SELECT LAT, LON FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(PID)>1 ) )"
286,Y,Y,"SELECT ROUND(SUM(I1.TIV_2016),2) AS TIV_2016 FROM INSURANCE I1 WHERE I1.TIV_2015 IN ( SELECT I2.TIV_2015 FROM INSURANCE I2 WHERE I1.PID<>I2.PID ) AND CONCAT(I1.LAT,I1.LON) NOT IN ( SELECT CONCAT(I3.LAT,I3.LON) FROM INSURANCE I3 WHERE I1.PID<>I3.PID )"
287,Y,N,"WITH TABLE1 AS (SELECT LAT, LON FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*) > 1) SELECT ROUND(SUM(DISTINCT(I1.TIV_2016)), 2) AS TIV_2016 FROM INSURANCE I1 INNER JOIN INSURANCE I2 ON I1.PID != I2.PID AND I1.TIV_2015 = I2.TIV_2015 AND I1.LAT!=I2.LAT AND I1.LON!=I2.LON AND (I1.LAT, I1.LON) NOT IN (SELECT LAT, LON FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*) > 1)"
288,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(TIV_2015)>1) AND (LAT,LON) IN ( SELECT LAT,LON FROM ( SELECT *, COUNT(*) OVER (PARTITION BY LAT,LON ) AS CNT FROM INSURANCE ) A WHERE CNT=1 )"
289,Y,Y,"WITH CTE AS ( SELECT *, COUNT(*) OVER(PARTITION BY LAT, LON) AS LAT_LON_COUNT , COUNT(*) OVER(PARTITION BY TIV_2015) AS TIV_2015_COUNT FROM INSURANCE ) SELECT ROUND(SUM(TIV_2016), 2) AS TIV_2016 FROM CTE WHERE LAT_LON_COUNT = 1 AND TIV_2015_COUNT >= 2"
290,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) TIV_2016 FROM INSURANCE A WHERE 1 = (SELECT COUNT(*) FROM INSURANCE B WHERE A.LAT=B.LAT AND A.LON=B.LON) AND 1 < (SELECT COUNT(*) FROM INSURANCE C WHERE A.TIV_2015=C.TIV_2015)"
291,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM (SELECT *, COUNT(*) OVER(PARTITION BY TIV_2015) AS CNT1, COUNT(*) OVER(PARTITION BY LAT, LON) AS CNT2 FROM INSURANCE ) AS TBL WHERE CNT1 > 1 AND CNT2 =1"
292,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) TIV_2016 FROM INSURANCE A WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE B WHERE A.PID!=B.PID) AND CONCAT(LAT, LON) NOT IN (SELECT CONCAT(LAT, LON) FROM INSURANCE C WHERE A.PID!=C.PID)"
293,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 NOT IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*)=1) AND (LAT,LON) NOT IN (SELECT LAT,LON FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*)>1)"
294,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) TIV_2016 FROM INSURANCE A WHERE (SELECT COUNT(TIV_2015) FROM INSURANCE WHERE TIV_2015 = A.TIV_2015) > 1 AND (SELECT COUNT(PID) FROM INSURANCE WHERE (LAT,LON) = (A.LAT,A.LON)) = 1"
295,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) TIV_2016 FROM ( SELECT PID, TIV_2016, SUM(1) OVER(PARTITION BY LAT, LON) LOCATION_FILTER, SUM(1) OVER(PARTITION BY TIV_2015) AS TIV_FILTER FROM INSURANCE ) A WHERE TIV_FILTER > 1 AND LOCATION_FILTER = 1"
296,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE WHERE (LAT, LON) NOT IN(SELECT LAT, LON FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*) > 1) AND TIV_2015 IN(SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(TIV_2015) > 1)"
297,Y,Y,"SELECT ROUND(SUM(ABC.TIV_2016),2) AS TIV_2016 FROM ( SELECT A.PID ,A.TIV_2015 ,A.TIV_2016 ,CONCAT(A.LAT, A.LON) FROM INSURANCE A JOIN INSURANCE B ON A.TIV_2015 = B.TIV_2015 WHERE A.TIV_2015 IN (SELECT BB.TIV_2015 FROM INSURANCE BB WHERE BB.PID != A.PID) AND A.PID = B.PID AND CONCAT(A.LAT, A.LON) NOT IN (SELECT CONCAT(AA.LAT, AA.LON) FROM INSURANCE AA WHERE AA.PID != A.PID) ) ABC"
298,Y,Y,"WITH UNIQUE_LOC AS( SELECT * FROM INSURANCE WHERE (LAT, LON) NOT IN ( SELECT LAT, LON FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*) > 1) ), MULTIPLE_VALUE AS( SELECT * FROM INSURANCE WHERE TIV_2015 IN ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) > 1) ) SELECT ROUND(SUM(TIV_2016), 2) AS TIV_2016 FROM UNIQUE_LOC WHERE PID IN (SELECT PID FROM MULTIPLE_VALUE)"
299,Y,Y,"WITH CTE AS (SELECT *, COUNT(TIV_2015) OVER(PARTITION BY TIV_2015) AS CONDITION1, COUNT(CONCAT(LAT,LON)) OVER(PARTITION BY LAT, LON) AS CONDITION2 FROM INSURANCE) SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM CTE WHERE CONDITION1>1 AND CONDITION2=1"
300,Y,Y,"WITH TEMP1 AS( SELECT TIV_2016, COUNT(*) OVER (PARTITION BY TIV_2015) AS CT15 , COUNT(*) OVER (PARTITION BY LAT,LON) AS CTLOC FROM INSURANCE ) SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM TEMP1 WHERE CT15>1 AND CTLOC=1"
301,Y,Y,"SELECT ROUND(SUM(TIV_2016), 2) AS TIV_2016 FROM INSURANCE I WHERE I.TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) >= 2) AND I.PID IN (SELECT PID FROM INSURANCE GROUP BY CONCAT(LAT, LON) HAVING COUNT(*)<2)"
302,Y,Y,"WITH T AS (SELECT PID,TIV_2016,LAT,LON FROM INSURANCE GROUP BY 3,4 HAVING COUNT(*) = 1) SELECT ROUND(SUM(I.TIV_2016),2) AS TIV_2016 FROM INSURANCE I JOIN T ON I.PID=T.PID WHERE I.TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY 1 HAVING COUNT(TIV_2015)>1)"
303,Y,Y,"WITH CONDITION_CTE1 AS (SELECT I1.PID FROM INSURANCE AS I1 JOIN INSURANCE AS I2 ON I1.TIV_2015 = I2.TIV_2015 WHERE I1.PID != I2.PID), CONDITION_CTE2 AS (SELECT PID FROM INSURANCE GROUP BY CONCAT(LAT, LON) HAVING COUNT(CONCAT(LAT, LON)) = 1) SELECT ROUND(SUM(TIV_2016), 2) AS TIV_2016 FROM INSURANCE WHERE PID IN (SELECT * FROM CONDITION_CTE1) AND PID IN (SELECT * FROM CONDITION_CTE2)"
304,Y,Y,"WITH T1 AS( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(TIV_2015)>1 ), T2 AS ( SELECT * FROM INSURANCE GROUP BY LAT,LON HAVING COUNT(*)=1) SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT * FROM T1) AND PID IN (SELECT PID FROM T2)"
305,Y,Y,"SELECT ROUND(SUM(I1.TIV_2016),2) AS TIV_2016 FROM INSURANCE I1 JOIN INSURANCE I2 ON I1.PID = I2.PID WHERE I1.TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(TIV_2015) > 1) AND I2.PID IN (SELECT PID FROM INSURANCE GROUP BY LAT,LON HAVING COUNT(LAT) = 1 AND COUNT(LON) = 1)"
306,Y,Y,"SELECT ROUND(SUM(A.TIV_2016),2) AS TIV_2016 FROM INSURANCE A WHERE A.TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) > 1 ) AND CONCAT(LAT, LON) IN ( SELECT CONCAT(LAT, LON) FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*) = 1 )"
307,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) TIV_2016 FROM INSURANCE WHERE PID IN (SELECT DISTINCT(A.PID) FROM INSURANCE A JOIN INSURANCE B ON A.TIV_2015 = B.TIV_2015 AND A.PID != B.PID) AND PID NOT IN (SELECT DISTINCT(A.PID) FROM INSURANCE A JOIN INSURANCE B ON A.LAT = B.LAT AND A.LON = B.LON AND A.PID != B.PID)"
308,Y,Y,"WITH CTE AS (SELECT PID, TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(DISTINCT PID) > 1)), CTE2 AS (SELECT PID, TIV_2016 FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(DISTINCT PID) = 1) SELECT ROUND(SUM(P1),2) AS TIV_2016 FROM (SELECT CTE.PID, CTE.TIV_2016 AS P1 FROM CTE JOIN CTE2 ON CTE.PID = CTE2.PID)M"
309,Y,Y,"WITH INSURANCE_BASE AS ( SELECT *, CONCAT(LAT,'_',LON) AS LATLON FROM INSURANCE ), BASE AS ( SELECT I1.*, I2.PID AS PID_2, I2.TIV_2015 AS TIV_2015_2, I2.LATLON AS LATLON_2 FROM INSURANCE_BASE I1 CROSS JOIN INSURANCE_BASE I2 WHERE I1.PID != I2.PID ), FLAGS AS ( SELECT PID_2, SUM(CASE WHEN TIV_2015 = TIV_2015_2 THEN 1 ELSE 0 END) AS TIV_2015_FLAG, SUM(CASE WHEN LATLON = LATLON_2 THEN 1 ELSE 0 END) AS LATLON_FLAG FROM BASE GROUP BY 1 ) SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE WHERE PID IN ( SELECT PID_2 FROM FLAGS WHERE TIV_2015_FLAG >= 1 AND LATLON_FLAG = 0 )"
310,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE WHERE PID IN (SELECT DISTINCT I1.PID FROM INSURANCE I1 JOIN INSURANCE I2 ON I1.PID != I2.PID AND I1.TIV_2015 = I2.TIV_2015) AND (LAT,LON) IN (SELECT LAT,LON FROM INSURANCE GROUP BY 1,2 HAVING COUNT(*) = 1)"
311,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) TIV_2016 FROM (SELECT TIV_2016, LAT, LON, COUNT(PID)OVER(PARTITION BY LAT, LON) AS CNT_LOCATION, COUNT(PID)OVER(PARTITION BY TIV_2015) COUNT_VALUE FROM INSURANCE ) TEMP WHERE CNT_LOCATION=1 AND COUNT_VALUE>1"
312,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE I1 WHERE (LAT,LON) NOT IN (SELECT LAT,LON FROM INSURANCE GROUP BY LAT,LON HAVING COUNT(LAT)>1) AND TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE I2 WHERE I1.PID != I2.PID)"
313,Y,Y,"SELECT CAST(SUM(TIV_2016) AS DECIMAL(10,2)) TIV_2016 FROM INSURANCE I1 JOIN (SELECT TIV_2015, COUNT(*) FROM INSURANCE I2 GROUP BY TIV_2015 HAVING COUNT(*) > 1) I2 ON I1.TIV_2015 = I2.TIV_2015 JOIN (SELECT LAT,LON,COUNT(*) FROM INSURANCE I3 GROUP BY LAT,LON HAVING COUNT(*) = 1 ) I3 ON I1.LAT = I3.LAT AND I1.LON = I3.LON"
314,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*)>1 AND (LAT, LON) IN (SELECT LAT, LON FROM INSURANCE GROUP BY LAT,LON HAVING COUNT(*)=1) )"
315,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE WHERE CONCAT(LAT, LON) IN ( SELECT CONCAT(LAT, LON) FROM INSURANCE GROUP BY CONCAT(LAT, LON) HAVING COUNT(*) = 1 ) AND TIV_2015 IN ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) > 1 )"
316,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM( SELECT * FROM INSURANCE WHERE (LAT,LON) NOT IN (SELECT LAT , LON FROM INSURANCE GROUP BY LAT,LON HAVING COUNT(*)>1) AND TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) > 1)) TEMP"
317,Y,Y,"SELECT ROUND(SUM(TIV_2016), 2) TIV_2016 FROM INSURANCE WHERE ( (LAT, LON) NOT IN ( SELECT LAT, LON FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*) > 1 ) ) AND ( TIV_2015 IN ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) > 1 ) )"
318,Y,Y,"SELECT ROUND(SUM(TIV_2016), 2) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) > 1 ) AND CONCAT(LAT, LON) IN ( SELECT CONCAT(LAT, LON) FROM INSURANCE GROUP BY CONCAT(LAT, LON) HAVING COUNT(*) < 2 )"
319,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE I1 WHERE 2<=(SELECT COUNT(*) FROM INSURANCE I2 WHERE I2.TIV_2015=I1.TIV_2015) AND (1=(SELECT COUNT(*) FROM INSURANCE I3 WHERE I3.LAT=I1.LAT AND I3.LON=I1.LON))"
320,Y,Y,"SELECT ROUND(SUM(A.TIV_2016),2) AS TIV_2016 FROM (SELECT DISTINCT A.PID,A.TIV_2015, A.TIV_2016,A.LAT,A.LON FROM INSURANCE A JOIN INSURANCE B ON A.TIV_2015 = B.TIV_2015 AND A.LAT!=B.LAT AND A.LON!=B.LON )A WHERE (A.LAT,A.LON) NOT IN (SELECT C.LAT,C.LON FROM INSURANCE C WHERE C.PID!=A.PID)"
321,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE A WHERE (SELECT COUNT(*) FROM INSURANCE B WHERE A.LAT=B.LAT AND A.LON=B.LON) = 1 AND (SELECT COUNT(*) FROM INSURANCE C WHERE A.TIV_2015=C.TIV_2015) >1"
322,Y,Y,"SELECT ROUND(SUM(INSURANCE.TIV_2016),2) AS TIV_2016 FROM INSURANCE WHERE INSURANCE.TIV_2015 IN (SELECT INSURANCE.TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(PID) > 1) AND CONCAT(LAT,LON) IN (SELECT CONCAT(LAT,LON) FROM INSURANCE GROUP BY LAT,LON HAVING COUNT(PID) = 1)"
323,Y,Y,"SELECT ROUND(SUM(INSURANCE.TIV_2016),2) AS TIV_2016 FROM INSURANCE WHERE INSURANCE.TIV_2015 IN ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) > 1 AND (LAT, LON) IN ( SELECT LAT, LON FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*) = 1 ) )"
324,Y,Y,"WITH T1 AS ( SELECT DISTINCT I1.PID,I1.TIV_2015,I1.TIV_2016,I1.LAT,I1.LON FROM INSURANCE I1 JOIN INSURANCE I2 ON I1.PID!=I2.PID AND I1.TIV_2015=I2.TIV_2015 AND 0 = (SELECT COUNT(*) FROM INSURANCE I3 WHERE I1.PID!=I3.PID AND I3.LAT=I1.LAT AND I3.LON=I1.LON) ) SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM T1"
325,Y,Y,"WITH MULTIPLE_2015 AS ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(PID) > 1 ), SINGLE_CITY AS ( SELECT LAT, LON FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(PID) = 1 ) SELECT ROUND(SUM(I.TIV_2016), 2) AS TIV_2016 FROM INSURANCE I INNER JOIN MULTIPLE_2015 M ON I.TIV_2015 = M.TIV_2015 INNER JOIN SINGLE_CITY SC ON I.LAT = SC.LAT AND I.LON = SC.LON"
326,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE WHERE INSURANCE.TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*) > 1) AND CONCAT(LAT,LON) IN ( SELECT CONCAT(LAT,LON) FROM INSURANCE GROUP BY LAT, LON HAVING COUNT(*) =1 )"
327,Y,Y,"WITH SELECTED AS ( SELECT TIV_2016, COUNT(*) OVER(PARTITION BY TIV_2015) AS NUM_1, COUNT(*) OVER(PARTITION BY LAT, LON) AS NUM_2 FROM INSURANCE ) SELECT ROUND(SUM(TIV_2016), 2) AS TIV_2016 FROM SELECTED WHERE NUM_1 > 1 AND NUM_2 = 1"
328,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(PID) > 1) AND CONCAT(LAT,'-',LON) IN (SELECT CONCAT(LAT,'-',LON) FROM INSURANCE GROUP BY CONCAT(LAT,'-',LON) HAVING COUNT(PID) = 1)"
329,Y,Y,"WITH CTE AS(SELECT DISTINCT PID FROM INSURANCE WHERE CONCAT(LAT, LON) NOT IN (SELECT CONCAT(LAT, LON) FROM INSURANCE GROUP BY 1 HAVING COUNT(CONCAT(LAT, LON))>1) AND TIV_2015 IN (SELECT TIV_2015 FROM INSURANCE GROUP BY 1 HAVING COUNT(TIV_2015) > 1)) SELECT ROUND(SUM(TIV_2016),2) TIV_2016 FROM INSURANCE WHERE PID IN (SELECT PID FROM CTE)"
330,Y,Y,"WITH V2015 AS ( SELECT TIV_2015 FROM INSURANCE GROUP BY TIV_2015 HAVING COUNT(*)>=2), GEO AS ( SELECT LAT,LON FROM INSURANCE GROUP BY LAT,LON HAVING COUNT(*)>=2) SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE WHERE TIV_2015 IN (SELECT TIV_2015 FROM V2015) AND (LAT,LON) NOT IN (SELECT LAT,LON FROM GEO)"
331,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM (SELECT *, COUNT(*) OVER (PARTITION BY TIV_2015) AS GRPS, COUNT(*) OVER (PARTITION BY LAT, LON) AS CNT2 FROM INSURANCE) K WHERE GRPS>1 AND CNT2 =1"
332,Y,Y,"SELECT ROUND(SUM(TIV_2016),2) AS TIV_2016 FROM INSURANCE A WHERE A.TIV_2015 IN (SELECT B.TIV_2015 FROM INSURANCE B WHERE A.PID != B.PID) AND CONCAT(LAT, LON) NOT IN (SELECT CONCAT(LAT,LON) FROM INSURANCE B WHERE A.PID != B.PID)"
333,Y,Y,"SELECT ROUND(SUM(TIV_2016), 2) AS TIV_2016 FROM( SELECT DISTINCT A.PID, A.TIV_2016 FROM INSURANCE A, INSURANCE B WHERE A.PID != B.PID AND A.TIV_2015 = B.TIV_2015 AND A.PID IN( SELECT PID FROM INSURANCE I GROUP BY LAT, LON HAVING COUNT(*) = 1)) T"
334,Y,Y,"WITH CTE AS( SELECT *, COUNT(*) OVER (PARTITION BY LAT, LON) AS NUM_CITY, COUNT(*) OVER (PARTITION BY TIV_2015) AS NUM_SAME_2015 FROM INSURANCE) SELECT ROUND(SUM(TIV_2016), 2) AS TIV_2016 FROM CTE WHERE NUM_CITY = 1 AND NUM_SAME_2015 != 1"
