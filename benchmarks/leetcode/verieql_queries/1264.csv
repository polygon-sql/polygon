qid,mysql_can_execute?,mysql_correct?,mysql_query
0,Y,Y,"SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDSHIP F, LIKES L WHERE ((F.USER1_ID = 1 AND L.USER_ID = F.USER2_ID) OR (F.USER2_ID = 1 AND L.USER_ID = F.USER1_ID)) AND L.PAGE_ID NOT IN ( SELECT L2.PAGE_ID FROM LIKES L2 WHERE L2.USER_ID = 1 )"
1,Y,Y,SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDSHIP F JOIN LIKES L ON F.USER2_ID = L.USER_ID AND F.USER1_ID = 1 HAVING RECOMMENDED_PAGE NOT IN ( SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1 ) UNION SELECT DISTINCT L2.PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDSHIP F JOIN LIKES L2 ON F.USER1_ID = L2.USER_ID AND F.USER2_ID = 1 AND L2.USER_ID != 1 HAVING RECOMMENDED_PAGE NOT IN ( SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1 )
2,Y,Y,"SELECT DISTINCT B.PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT USER2_ID AS UID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS UID FROM FRIENDSHIP WHERE USER2_ID = 1) A, LIKES B WHERE A.UID = B.USER_ID AND B.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
3,Y,Y,SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM ( SELECT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID = 1 UNION SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1) F INNER JOIN LIKES L ON F.USER_ID = L.USER_ID WHERE L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
4,Y,Y,SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT (CASE WHEN F.USER1_ID=1 THEN F.USER2_ID WHEN F.USER2_ID=1 THEN F.USER1_ID ELSE NULL END ) AS USER_ID FROM FRIENDSHIP F) AS A JOIN LIKES L ON A.USER_ID=L.USER_ID AND L.PAGE_ID NOT IN (SELECT L1.PAGE_ID FROM LIKES L1 WHERE L1.USER_ID=1)
5,Y,Y,SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT DISTINCT F.USER1_ID FROM FRIENDSHIP F WHERE F.USER2_ID=1 UNION SELECT DISTINCT F1.USER2_ID FROM FRIENDSHIP F1 WHERE F1.USER1_ID=1) AS A JOIN LIKES L ON A.USER1_ID=L.USER_ID AND L.PAGE_ID NOT IN (SELECT L1.PAGE_ID FROM LIKES L1 WHERE L1.USER_ID=1)
6,Y,Y,SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT USER2_ID AS FRIEND FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS FRIEND FROM FRIENDSHIP WHERE USER2_ID = 1 ) AS F JOIN LIKES AS L ON F.FRIEND = L.USER_ID WHERE L.PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1) ORDER BY 1
7,Y,Y,SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L JOIN (SELECT (CASE WHEN F.USER1_ID = 1 THEN F.USER2_ID WHEN F.USER2_ID = 1 THEN F.USER1_ID ELSE NULL END) AS ONE_FRIEND_ID FROM FRIENDSHIP F) T ON T.ONE_FRIEND_ID = L.USER_ID WHERE ONE_FRIEND_ID IS NOT NULL AND L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1) ORDER BY PAGE_ID
8,Y,Y,SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L WHERE L.USER_ID IN (SELECT CASE WHEN USER1_ID=1 THEN USER2_ID WHEN USER2_ID=1 THEN USER1_ID ELSE NULL END USER_ID FROM FRIENDSHIP) AND L.PAGE_ID NOT IN(SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
9,Y,Y,"SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM( SELECT LEAST(USER1_ID, USER2_ID) AS MIN_USER_ID, GREATEST(USER1_ID, USER2_ID) AS MAX_USER_ID FROM FRIENDSHIP ) TMP JOIN LIKES L ON TMP.MAX_USER_ID = L.USER_ID WHERE MIN_USER_ID = 1 AND L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1) ORDER BY 1"
10,Y,Y,SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES AS L WHERE USER_ID IN ( SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1 UNION SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 ) AND L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
11,Y,Y,"SELECT DISTINCT L.PAGE_ID RECOMMENDED_PAGE FROM (SELECT (CASE WHEN USER1_ID < USER2_ID THEN USER1_ID ELSE USER2_ID END) USER1_ID, (CASE WHEN USER1_ID > USER2_ID THEN USER1_ID ELSE USER2_ID END) USER2_ID FROM FRIENDSHIP ) TEMP JOIN LIKES L ON TEMP.USER2_ID = L.USER_ID AND TEMP.USER1_ID = 1 WHERE L.USER_ID != 1 AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
12,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END AS USER_ID FROM FRIENDSHIP) F JOIN LIKES L ON F.USER_ID = L.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
13,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END AS USER_ID FROM FRIENDSHIP) A JOIN LIKES ON A.USER_ID = LIKES.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
14,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT CASE WHEN USER1_ID=1 THEN USER2_ID WHEN USER2_ID=1 THEN USER1_ID END AS USER_ID FROM FRIENDSHIP) AS A JOIN LIKES USING(USER_ID) WHERE PAGE_ID NOT IN ( SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1 )
15,Y,Y,"SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT USER1_ID AS USER_ID, USER2_ID AS FRIEND_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER2_ID AS USER_ID, USER1_ID AS FRIEND_ID FROM FRIENDSHIP WHERE USER2_ID = 1) A JOIN LIKES L ON A.FRIEND_ID = L.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
16,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES AS L JOIN ( SELECT USER2_ID AS UID FROM FRIENDSHIP WHERE USER1_ID=1 UNION SELECT USER1_ID AS UID FROM FRIENDSHIP WHERE USER2_ID=1) AS NEW ON L.USER_ID=NEW.UID WHERE PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID=1)
17,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( SELECT ( CASE WHEN USER1_ID = 1 AND USER2_ID != 1 THEN USER2_ID ELSE USER1_ID END ) AS USER_ID FROM FRIENDSHIP WHERE (USER1_ID = 1 AND USER2_ID != 1) OR (USER2_ID = 1 AND USER1_ID != 1) ) AND PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 )
18,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID ELSE NULL END AS USER_ID FROM FRIENDSHIP ) HAVING RECOMMENDED_PAGE NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 )
19,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END AS FRIEND_ID FROM FRIENDSHIP WHERE USER1_ID = 1 OR USER2_ID = 1 ) AND PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 )
20,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END AS ID FROM FRIENDSHIP WHERE USER1_ID = 1 OR USER2_ID = 1 ) AND PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 )
21,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( SELECT USER2_ID AS FRIEND_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS FRIEND_ID FROM FRIENDSHIP WHERE USER2_ID = 1) AND PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 )
22,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
23,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID=1 UNION SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID=1) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
24,Y,Y,"SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDSHIP F INNER JOIN LIKES L ON L.USER_ID IN (F.USER1_ID, F.USER2_ID) AND (F.USER1_ID = 1 OR F.USER2_ID = 1) WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
25,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L JOIN (SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END AS USER_ID FROM FRIENDSHIP) AS A ON L.USER_ID = A.USER_ID WHERE PAGE_ID NOT IN(SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
26,Y,N,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L WHERE USER_ID IN (SELECT USER_ID_1_FRIENDS FROM (SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END AS USER_ID_1_FRIENDS FROM FRIENDSHIP) A WHERE USER_ID_1_FRIENDS IS NOT NULL) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
27,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM ( SELECT USER2_ID AS ID FROM FRIENDSHIP WHERE USER1_ID=1 UNION ALL SELECT USER1_ID AS ID FROM FRIENDSHIP WHERE USER2_ID=1 ) AS A JOIN LIKES AS B ON A.ID = B.USER_ID WHERE B.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
28,Y,Y,"SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT B.USER_ID, B.PAGE_ID FROM FRIENDSHIP A LEFT OUTER JOIN LIKES B ON (A.USER2_ID=B.USER_ID OR A.USER1_ID=B.USER_ID) AND (A.USER1_ID=1 OR A.USER2_ID=1) WHERE B.PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID=1)) T"
29,Y,Y,"SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT USER1_ID, USER2_ID FROM FRIENDSHIP UNION SELECT USER2_ID AS USER1_ID, USER1_ID AS USER2_ID FROM FRIENDSHIP) AS F JOIN LIKES L ON F.USER2_ID = L.USER_ID WHERE F.USER1_ID = 1 AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
30,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE NOT PAGE_ID IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1) AND USER_ID IN (SELECT (CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID ELSE 0 END) AS USER FROM FRIENDSHIP HAVING USER != 0)
31,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT DISTINCT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1 UNION SELECT DISTINCT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 ) AND PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1)
32,Y,Y,SELECT DISTINCT PAGE_ID RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( SELECT USER2_ID ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION ALL SELECT USER1_ID ID FROM FRIENDSHIP WHERE USER2_ID = 1 ) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
33,Y,Y,SELECT DISTINCT PAGE_ID RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END AS USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1 OR USER2_ID = 1) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
34,Y,Y,"SELECT DISTINCT TB1.PAGE_ID AS RECOMMENDED_PAGE FROM ( SELECT USER1_ID AS ID,PAGE_ID FROM FRIENDSHIP INNER JOIN LIKES ON USER2_ID=USER_ID WHERE USER1_ID=1 UNION SELECT USER2_ID AS ID, PAGE_ID FROM FRIENDSHIP INNER JOIN LIKES ON USER1_ID=USER_ID WHERE USER2_ID=1 ) TB1 WHERE TB1.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID =1)"
35,N,N,"SELECT DISTINCT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 ), USER1 AS ( SELECT DISTINCT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1 ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( SELECT USER2_ID FROM USER2 UNION SELECT USER1_ID FROM USER1 ) AND PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 )"
36,Y,Y,SELECT DISTINCT(L.PAGE_ID) AS RECOMMENDED_PAGE FROM (SELECT CASE WHEN USER1_ID=1 THEN USER2_ID WHEN USER2_ID=1 THEN USER1_ID END AS USER_ID FROM FRIENDSHIP) T JOIN LIKES L USING(USER_ID) WHERE L.PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 )
37,Y,Y,SELECT DISTINCT(PAGE_ID) AS RECOMMENDED_PAGE FROM (SELECT CASE WHEN USER1_ID=1 THEN USER2_ID WHEN USER2_ID=1 THEN USER1_ID END AS USER_ID FROM FRIENDSHIP) A JOIN LIKES ON A.USER_ID=LIKES.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
38,Y,Y,"SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT USER_ID, PAGE_ID FROM LIKES WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)) AS A WHERE USER_ID IN ( SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END AS USER_ID FROM FRIENDSHIP WHERE (FRIENDSHIP.USER1_ID=1 OR FRIENDSHIP.USER2_ID=1) )"
39,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID =1 THEN USER1_ID END AS FRIENDS_ID FROM FRIENDSHIP WHERE USER1_ID =1 OR USER2_ID =1) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
40,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT DISTINCT CASE WHEN USER1_ID = 1 THEN USER2_ID ELSE USER1_ID END AS FRIEND FROM FRIENDSHIP WHERE USER1_ID = 1 OR USER2_ID = 1) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
41,Y,Y,SELECT PAGE_ID AS RECOMMENDED_PAGE FROM ( SELECT DISTINCT L.PAGE_ID FROM LIKES L INNER JOIN ( SELECT USER2_ID AS FRIEND_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS FRIEND_ID FROM FRIENDSHIP WHERE USER2_ID = 1 ) T ON T.FRIEND_ID = L.USER_ID ) M WHERE PAGE_ID NOT IN ( SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1)
42,Y,Y,SELECT PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID=1 UNION SELECT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID=1) A INNER JOIN LIKES B ON A.USER_ID=B.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1) GROUP BY PAGE_ID
43,Y,Y,SELECT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION ALL SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1) GROUP BY PAGE_ID
44,Y,Y,SELECT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1) GROUP BY 1
45,Y,Y,"SELECT PAGE_ID RECOMMENDED_PAGE FROM (SELECT F.USER1_ID USER_ID, L.PAGE_ID FROM LIKES L JOIN FRIENDSHIP F ON F.USER1_ID = L.USER_ID WHERE F.USER2_ID = 1 UNION ALL SELECT F.USER2_ID USER_ID, L.PAGE_ID FROM LIKES L JOIN FRIENDSHIP F ON F.USER2_ID = L.USER_ID WHERE F.USER1_ID = 1 ORDER BY USER_ID) A WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1) GROUP BY PAGE_ID"
46,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT CASE WHEN USER1_ID=1 THEN USER2_ID WHEN USER2_ID=1 THEN USER1_ID ELSE '' END FROM FRIENDSHIP WHERE USER1_ID=1 OR USER2_ID=1) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
47,Y,Y,"SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT CASE WHEN USER1_ID=1 THEN USER2_ID WHEN USER2_ID=1 THEN USER1_ID END AS ID FROM FRIENDSHIP ) A JOIN LIKES L ON A.ID = L.USER_ID WHERE (1, L.PAGE_ID) NOT IN (SELECT * FROM LIKES)"
48,Y,Y,"SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L INNER JOIN (SELECT USER1_ID AS USER1, USER2_ID AS FRIEND FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER2_ID AS USER1, USER1_ID AS FRIEND FROM FRIENDSHIP WHERE USER2_ID = 1) TEMP ON L.USER_ID = TEMP.FRIEND WHERE L.PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
49,Y,Y,SELECT LIKED_BY_FRIEND.PAGE_ID AS RECOMMENDED_PAGE FROM ( SELECT DISTINCT PAGE_ID FROM FRIENDSHIP AS FRIENDS INNER JOIN LIKES AS LIKES ON FRIENDS.USER2_ID = LIKES.USER_ID WHERE FRIENDS.USER1_ID = 1 UNION SELECT DISTINCT PAGE_ID FROM FRIENDSHIP AS FRIENDS INNER JOIN LIKES AS LIKES ON FRIENDS.USER1_ID = LIKES.USER_ID WHERE FRIENDS.USER2_ID = 1 ) AS LIKED_BY_FRIEND LEFT JOIN ( SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1 ) AS LIKED_BY_USR ON LIKED_BY_USR.PAGE_ID = LIKED_BY_FRIEND.PAGE_ID WHERE LIKED_BY_USR.PAGE_ID IS NULL
50,Y,Y,SELECT PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDSHIP F INNER JOIN LIKES L ON F.USER2_ID= L.USER_ID WHERE USER1_ID=1 AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID =1) UNION SELECT PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDSHIP F INNER JOIN LIKES L ON F.USER1_ID= L.USER_ID WHERE USER2_ID=1 AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID =1)
51,Y,Y,WITH ALL_FRIENDS_TABLE AS( SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1 ) SELECT DISTINCT(PAGE_ID) AS RECOMMENDED_PAGE FROM LIKES WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1) AND USER_ID IN (SELECT * FROM ALL_FRIENDS_TABLE)
52,Y,Y,WITH ALL_FRIENDS_TABLE AS( SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1 ) SELECT DISTINCT(PAGE_ID) AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT * FROM ALL_FRIENDS_TABLE) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
53,Y,Y,WITH A_FRIEND AS (SELECT USER2_ID FRIEND FROM FRIENDSHIP WHERE USER1_ID = 1 UNION ALL SELECT USER1_ID FRIEND FROM FRIENDSHIP WHERE USER2_ID = 1) SELECT DISTINCT PAGE_ID RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT * FROM A_FRIEND) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
54,Y,Y,"WITH ALLFRIENDS AS (SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION ALL SELECT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID = 1), FRIENDSLIKES AS (SELECT PAGE_ID FROM LIKES L INNER JOIN ALLFRIENDS AF ON AF.USER_ID = L.USER_ID) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDSLIKES WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
55,Y,Y,WITH CET AS (SELECT USER2_ID AS ID FROM FRIENDSHIP WHERE USER1_ID=1 UNION SELECT USER1_ID AS ID FROM FRIENDSHIP WHERE USER2_ID=1 ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L JOIN CET ON L.USER_ID=CET.ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1) ORDER BY PAGE_ID
56,Y,Y,WITH CTE AS (SELECT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID=1 UNION SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID=1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L JOIN CTE ON CTE.USER_ID=L.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
57,Y,Y,WITH CTE AS( SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END AS USER_ID FROM FRIENDSHIP ) SELECT DISTINCT(PAGE_ID) AS RECOMMENDED_PAGE FROM CTE C JOIN LIKES L ON C.USER_ID = L.USER_ID AND C.USER_ID IS NOT NULL WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID =1)
58,Y,Y,"WITH CTE1 AS (SELECT USER1_ID, USER2_ID FROM FRIENDSHIP WHERE USER1_ID=1 UNION SELECT USER2_ID, USER1_ID FROM FRIENDSHIP WHERE USER2_ID=1), CTE2 AS (SELECT USER2_ID FROM CTE1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES, CTE2 WHERE USER_ID IN (USER2_ID) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)"
59,Y,Y,WITH FRIENDS AS( SELECT USER1_ID AS ID FROM FRIENDSHIP WHERE USER2_ID=1 UNION DISTINCT SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID=1 ) SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L INNER JOIN FRIENDS F ON L.USER_ID=F.ID AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
60,Y,Y,"WITH FRIENDS AS(SELECT * FROM FRIENDSHIP UNION ALL SELECT USER2_ID USER1_ID, USER1_ID USER2_ID FROM FRIENDSHIP) SELECT DISTINCT L.PAGE_ID RECOMMENDED_PAGE FROM LIKES L JOIN FRIENDS F ON L.USER_ID=F.USER2_ID WHERE F.USER1_ID=1 AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)"
61,Y,Y,WITH FRIENDS AS ( SELECT DISTINCT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT DISTINCT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID = 1 ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT DISTINCT USER_ID FROM FRIENDS) AND PAGE_ID NOT IN ( SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1) ORDER BY PAGE_ID
62,Y,Y,WITH ONES_FRIENDS AS( SELECT USER2_ID AS ONES_FRIENDS FROM FRIENDSHIP WHERE USER1_ID = 1 UNION ALL SELECT USER1_ID AS ONES_FRIENDS FROM FRIENDSHIP WHERE USER2_ID = 1 ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM ONES_FRIENDS O INNER JOIN LIKES L ON O.ONES_FRIENDS = L.USER_ID WHERE PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 )
63,Y,N,"WITH TABLE1 AS (SELECT CASE WHEN USER2_ID > USER1_ID THEN USER1_ID ELSE USER2_ID END AS USER1_ID, CASE WHEN USER2_ID < USER1_ID THEN USER1_ID ELSE USER2_ID END AS USER2_ID FROM FRIENDSHIP ORDER BY 1) ,TABLE2 AS (SELECT USER_ID, PAGE_ID FROM LIKES WHERE USER_ID IN (SELECT USER2_ID FROM TABLE1 WHERE USER1_ID = 1)), TABLE3 AS (SELECT USER_ID, PAGE_ID FROM LIKES WHERE USER_ID = 1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM TABLE2 WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM TABLE3)"
64,Y,Y,"WITH COMBINED AS ( SELECT USER1_ID, USER2_ID FROM FRIENDSHIP UNION ALL SELECT USER2_ID, USER1_ID FROM FRIENDSHIP), FRIENDS AS ( SELECT USER2_ID FROM COMBINED WHERE USER1_ID = 1) SELECT DISTINCT(PAGE_ID) AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER2_ID FROM FRIENDS) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
65,Y,Y,WITH CTE AS ( SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1 ) SELECT DISTINCT PAGE_ID RECOMMENDED_PAGE FROM CTE C JOIN LIKES L ON C.USER2_ID = L.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
66,Y,Y,WITH CTE AS( SELECT DISTINCT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID = 1 UNION ALL SELECT DISTINCT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER_ID FROM CTE) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
67,Y,Y,"WITH CTE AS( SELECT USER1_ID, USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 OR USER2_ID = 1 ), CTE1 AS( SELECT USER1_ID FROM CTE UNION SELECT USER2_ID FROM CTE ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES I INNER JOIN CTE1 ON CTE1.USER1_ID = I.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
68,Y,Y,"WITH CTE AS(SELECT USER1_ID AS ID, USER2_ID AS USER FROM FRIENDSHIP WHERE USER1_ID = 1 UNION ALL SELECT USER2_ID AS ID , USER1_ID AS USER FROM FRIENDSHIP WHERE USER2_ID = 1) , CTE2 AS( SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER FROM CTE)) SELECT RECOMMENDED_PAGE FROM CTE2 WHERE RECOMMENDED_PAGE NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
69,Y,Y,"WITH CTE1 AS ( (SELECT USER2_ID AS FRIENDS FROM FRIENDSHIP WHERE USER1_ID = 1) UNION (SELECT USER1_ID AS FRIENDS FROM FRIENDSHIP WHERE USER2_ID = 1) ), CTE2 AS ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT FRIENDS FROM CTE1) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM CTE2)"
70,Y,Y,"WITH CTE_LIKES AS (SELECT USER_ID, PAGE_ID FROM LIKES WHERE 1=1 AND PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE 1=1 AND USER_ID=1)) SELECT DISTINCT PAGE_ID RECOMMENDED_PAGE FROM FRIENDSHIP F, CTE_LIKES CL WHERE 1=1 AND (F.USER2_ID=CL.USER_ID OR F.USER1_ID=CL.USER_ID ) AND (F.USER1_ID=1 OR F.USER2_ID=1)"
71,Y,Y,"WITH FILTERED_USERS AS ( SELECT USER1_ID AS USER_ID, USER2_ID AS FRIEND_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER2_ID AS USER_ID, USER1_ID AS FRIEND_ID FROM FRIENDSHIP WHERE USER2_ID = 1 ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM FILTERED_USERS F JOIN LIKES L ON F.FRIEND_ID = L.USER_ID WHERE PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 )"
72,Y,Y,"WITH FRIEND_LIKES AS ( SELECT L.USER_ID, L.PAGE_ID FROM LIKES L WHERE L.USER_ID != 1 AND L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1) ) SELECT DISTINCT FL.PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDSHIP F INNER JOIN FRIEND_LIKES FL ON FL.USER_ID = F.USER2_ID WHERE F.USER1_ID = 1 UNION SELECT FL.PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDSHIP F INNER JOIN FRIEND_LIKES FL ON FL.USER_ID = F.USER1_ID WHERE F.USER2_ID = 1 ORDER BY 1"
73,Y,Y,"WITH FRIENDS AS ( SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID ELSE USER1_ID END AS USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1 OR USER2_ID = 1), USER_LIKED AS ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1) SELECT L.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES AS L INNER JOIN FRIENDS AS F ON L.USER_ID = F.USER_ID LEFT JOIN USER_LIKED AS U ON U.PAGE_ID = L.PAGE_ID WHERE U.PAGE_ID IS NULL GROUP BY L.PAGE_ID"
74,Y,Y,WITH FRIENDS AS ( SELECT USER2_ID AS ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS ID FROM FRIENDSHIP WHERE USER2_ID =1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDS JOIN LIKES ON FRIENDS.ID = LIKES.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID =1)
75,Y,Y,WITH FRIENDS AS( SELECT USER2_ID AS ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS ID FROM FRIENDSHIP WHERE USER2_ID = 1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES JOIN FRIENDS ON FRIENDS.ID= LIKES.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID =1)
76,Y,Y,WITH FRIENDS_TABLE AS ( SELECT USER2_ID AS FRIENDS FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS FRIENDS FROM FRIENDSHIP WHERE USER2_ID = 1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDS_TABLE JOIN LIKES ON FRIENDS_TABLE.FRIENDS = LIKES.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
77,Y,Y,WITH FRND AS( SELECT USER2_ID AS USERS FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS USERS FROM FRIENDSHIP WHERE USER2_ID = 1 ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USERS FROM FRND) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
78,Y,Y,WITH T AS ( SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION DISTINCT SELECT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID = 1 ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1) AND USER_ID IN (SELECT USER_ID FROM T)
79,Y,Y,"WITH T1 AS ( (SELECT USER1_ID FREIND1, USER2_ID FREIND2 FROM FRIENDSHIP WHERE USER1_ID < USER2_ID) UNION (SELECT USER2_ID FREIND1, USER1_ID FREIND2 FROM FRIENDSHIP WHERE USER2_ID < USER1_ID) ) SELECT DISTINCT PAGE_ID RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( SELECT FREIND2 FROM T1 WHERE FREIND1 = 1 ) AND PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 )"
80,Y,Y,WITH T1 AS ( SELECT * FROM LIKES WHERE USER_ID IN (SELECT DISTINCT USER1_ID FROM FRIENDSHIP F1 WHERE USER2_ID = 1 UNION ALL SELECT DISTINCT USER2_ID FROM FRIENDSHIP F2 WHERE USER1_ID = 1) AND PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES L1 WHERE USER_ID = 1) ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM T1
81,Y,Y,"WITH T1 AS (SELECT DISTINCT USER_ID,PAGE_ID FROM LIKES WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM T1 WHERE USER_ID IN (SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1) OR USER_ID IN (SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1)"
82,Y,Y,"WITH TEMP AS ( SELECT DISTINCT USER_ID,PAGE_ID FROM LIKES WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1) ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM TEMP WHERE USER_ID IN (SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1) OR USER_ID IN (SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1 )"
83,Y,Y,WITH TEMP AS ( SELECT DISTINCT(A.FRIEND) AS FRIEND FROM (SELECT USER1_ID AS FRIEND FROM FRIENDSHIP WHERE USER2_ID = 1 UNION SELECT USER2_ID AS FRIEND FROM FRIENDSHIP WHERE USER1_ID = 1 ) AS A WHERE FRIEND != 1 ) SELECT DISTINCT(PAGE_ID) AS RECOMMENDED_PAGE FROM LIKES JOIN TEMP ON TEMP.FRIEND = LIKES.USER_ID WHERE PAGE_ID NOT IN (SELECT DISTINCT(PAGE_ID) AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID = 1)
84,Y,Y,"WITH TEMP AS ( SELECT DISTINCT(A.USER2_ID) AS FRIEND_ID FROM ( (SELECT USER1_ID, USER2_ID FROM FRIENDSHIP) UNION (SELECT USER2_ID AS USER1_ID, USER1_ID AS USER2_ID FROM FRIENDSHIP) ) AS A WHERE A.USER1_ID = 1 ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES JOIN TEMP ON TEMP.FRIEND_ID = LIKES.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
85,Y,Y,WITH USER1_FRIEND AS ( SELECT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID = 1 UNION ALL SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1 ) SELECT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES INNER JOIN USER1_FRIEND USING (USER_ID) WHERE PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID =1) GROUP BY 1
86,Y,Y,WITH USER1_FRIEND AS ( SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID = 1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM USER1_FRIEND U JOIN LIKES L ON L.USER_ID = U.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
87,Y,Y,WITH USER1_FRIENDS AS (SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END AS FRIENDS FROM FRIENDSHIP) SELECT L.PAGE_ID AS RECOMMENDED_PAGE FROM USER1_FRIENDS AS F JOIN LIKES AS L ON F.FRIENDS = L.USER_ID WHERE L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 ) GROUP BY RECOMMENDED_PAGE
88,Y,N,WITH USER1FRIENDS AS( SELECT (CASE WHEN USER1_ID=1 THEN USER2_ID WHEN USER2_ID=1 THEN USER1_ID END ) AS FRIENDS_ID FROM FRIENDSHIP) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT FRIENDS_ID FROM USER1FRIENDS) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID='1')
89,Y,Y,WITH USER_1_FRIENDS AS( SELECT USER2_ID AS FRIEND_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION ALL SELECT USER1_ID AS FRIEND_ID FROM FRIENDSHIP WHERE USER2_ID = 1 ) SELECT DISTINCT(L.PAGE_ID) AS RECOMMENDED_PAGE FROM USER_1_FRIENDS U JOIN LIKES L ON U.FRIEND_ID = L.USER_ID WHERE L.PAGE_ID NOT IN( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 ) GROUP BY L.PAGE_ID
90,Y,Y,WITH CTE AS (SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION ALL SELECT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID = 1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER_ID FROM CTE) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
91,Y,Y,WITH FRIEND AS ((SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1) UNION (SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1)) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT * FROM FRIEND) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
92,Y,Y,SELECT C.PG AS RECOMMENDED_PAGE FROM ((SELECT L.PAGE_ID AS PG FROM LIKES L JOIN (SELECT USER2_ID AS FRND FROM FRIENDSHIP WHERE USER1_ID=1)A ON L.USER_ID=A.FRND) UNION (SELECT L.PAGE_ID AS PG FROM LIKES L JOIN (SELECT USER1_ID AS FRND FROM FRIENDSHIP WHERE USER2_ID=1)B ON L.USER_ID=B.FRND)) C WHERE C.PG NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
93,Y,Y,SELECT A.RECOMMENDED_PAGE FROM (SELECT DISTINCT B.PAGE_ID RECOMMENDED_PAGE FROM ((SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID=1) UNION (SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID=1)) A LEFT JOIN LIKES B ON A.USER2_ID=B.USER_ID WHERE B.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1) ORDER BY RECOMMENDED_PAGE) A WHERE A.RECOMMENDED_PAGE IS NOT NULL
94,Y,Y,SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDSHIP F JOIN LIKES L ON F.USER2_ID = L.USER_ID WHERE F.USER1_ID =1 AND L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID =1) UNION SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDSHIP F JOIN LIKES L ON F.USER1_ID = L.USER_ID WHERE F.USER2_ID =1 AND L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID =1)
95,Y,Y,"SELECT DISTINCT A.PAGE_ID AS RECOMMENDED_PAGE FROM ( SELECT USER_ID, PAGE_ID FROM LIKES WHERE USER_ID IN ( SELECT DISTINCT USER2_ID FROM FRIENDSHIP WHERE USER1_ID=1 UNION SELECT DISTINCT USER1_ID FROM FRIENDSHIP WHERE USER2_ID=1) AND PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID=1) ) AS A"
96,Y,Y,SELECT DISTINCT A.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES A INNER JOIN ( SELECT CASE WHEN USER1_ID=1 THEN USER2_ID WHEN USER2_ID=1 THEN USER1_ID END AS USER1_FRIENDS FROM FRIENDSHIP ) T ON A.USER_ID=T.USER1_FRIENDS WHERE A.PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
97,Y,Y,SELECT DISTINCT A.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES A INNER JOIN ((SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID=1) UNION ALL (SELECT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID=1)) B ON A.USER_ID=B.USER_ID WHERE A.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
98,Y,Y,SELECT DISTINCT C.PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT DISTINCT UID FROM (SELECT DISTINCT USER1_ID AS UID FROM FRIENDSHIP WHERE USER2_ID = 1 AND USER1_ID!=1 UNION ALL SELECT DISTINCT USER2_ID AS UID FROM FRIENDSHIP WHERE USER1_ID = 1 AND USER2_ID!=1)AS A )AS D INNER JOIN ( SELECT DISTINCT * FROM LIKES )AS C ON D.UID = C.USER_ID WHERE C.PAGE_ID NOT IN(SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID =1 AND PAGE_ID IS NOT NULL)
99,Y,Y,SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM ( SELECT DISTINCT USER1_ID AS ID FROM FRIENDSHIP WHERE USER2_ID = 1 UNION SELECT DISTINCT USER2_ID AS ID FROM FRIENDSHIP WHERE USER1_ID = 1) A JOIN LIKES L ON L.USER_ID = A.ID WHERE L.PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
100,Y,Y,SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM ( SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID=1 UNION SELECT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID=1) F JOIN LIKES L ON F.USER_ID=L.USER_ID WHERE PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID=1)
101,Y,Y,SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDSHIP F JOIN LIKES L ON F.USER2_ID =L.USER_ID OR F.USER1_ID =L.USER_ID WHERE (F.USER1_ID = 1 OR F.USER2_ID = 1) AND L.PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1)
102,Y,Y,SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L LEFT JOIN FRIENDSHIP F1 ON F1.USER2_ID = L.USER_ID LEFT JOIN FRIENDSHIP F2 ON F2.USER1_ID = L.USER_ID WHERE (F1.USER1_ID = 1 OR F2.USER2_ID = 1) AND L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
103,Y,Y,SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L JOIN FRIENDSHIP F ON L.USER_ID = F.USER2_ID OR L.USER_ID = F.USER1_ID WHERE (F.USER1_ID = 1 OR F.USER2_ID = 1) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
104,Y,Y,SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L WHERE L.USER_ID IN ( SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID = 1 ) AND L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
105,Y,Y,SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L WHERE USER_ID IN (SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID ELSE '' END FROM FRIENDSHIP) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
106,Y,Y,"SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM(SELECT IF(USER1_ID='1', USER2_ID, USER1_ID) AS USER_ID FROM FRIENDSHIP WHERE USER1_ID='1' OR USER2_ID='1') A JOIN LIKES L ON A.USER_ID = L.USER_ID WHERE L.PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID=1)"
107,Y,Y,"SELECT DISTINCT LIKES AS RECOMMENDED_PAGE FROM ( SELECT F.USER1_ID,F.USER2_ID,L.PAGE_ID AS LIKES FROM FRIENDSHIP AS F INNER JOIN LIKES AS L ON F.USER2_ID = L.USER_ID WHERE F.USER1_ID = '1' OR F.USER2_ID = '1' UNION SELECT F.USER1_ID,F.USER2_ID,L.PAGE_ID AS LIKES FROM FRIENDSHIP AS F INNER JOIN LIKES AS L ON F.USER1_ID = L.USER_ID WHERE F.USER1_ID = '1' OR F.USER2_ID = '1' )A WHERE LIKES NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = '1')"
108,Y,Y,"SELECT DISTINCT LIKES.PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT USER1_ID, USER2_ID FROM FRIENDSHIP UNION SELECT USER2_ID AS USER1_ID, USER1_ID AS USER2_ID FROM FRIENDSHIP) T JOIN LIKES ON USER2_ID = USER_ID WHERE USER1_ID = 1 AND LIKES.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID =1)"
109,Y,Y,SELECT DISTINCT LIKES.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES LIKES JOIN ( SELECT USER1_ID USER_ID FROM FRIENDSHIP WHERE USER2_ID = 1 UNION SELECT USER2_ID USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1 ) USERS ON LIKES.USER_ID = USERS.USER_ID AND LIKES.PAGE_ID NOT IN( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 )
110,Y,Y,"SELECT DISTINCT P.PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT T.USER_ID, L.PAGE_ID FROM (SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID=1 UNION SELECT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID=1) T JOIN LIKES L ON T.USER_ID=L.USER_ID) P WHERE P.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)"
111,Y,Y,SELECT DISTINCT PAGE_ID RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( SELECT DISTINCT F1.USER2_ID USER_ID FROM FRIENDSHIP F1 WHERE F1.USER1_ID = 1 UNION SELECT DISTINCT F2.USER1_ID USER_ID FROM FRIENDSHIP F2 WHERE F2.USER2_ID = 1 ) AND PAGE_ID NOT IN ( SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1)
112,Y,Y,"SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM ( SELECT A.USER_ID,L.PAGE_ID FROM ( SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID = 1 ) A INNER JOIN LIKES L ON L.USER_ID = A.USER_ID AND L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1) ) B"
113,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM ( SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END AS USER1 FROM FRIENDSHIP ) TB JOIN LIKES L ON L.USER_ID = TB.USER1 WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
114,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM ( SELECT DISTINCT (CASE WHEN USER1_ID=1 THEN USER2_ID WHEN USER2_ID=1 THEN USER1_ID END) AS USER_ID FROM FRIENDSHIP) SUB JOIN LIKES L ON (SUB.USER_ID=L.USER_ID) WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
115,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM ( SELECT DISTINCT PAGE_ID FROM FRIENDSHIP F JOIN LIKES L ON L.USER_ID = F.USER1_ID WHERE F.USER2_ID = 1 UNION SELECT DISTINCT PAGE_ID FROM FRIENDSHIP F JOIN LIKES L ON L.USER_ID = F.USER2_ID WHERE F.USER1_ID = 1 )X WHERE PAGE_ID NOT IN ( SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1)
116,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM ( SELECT USER1_ID ID FROM FRIENDSHIP WHERE USER2_ID = 1 UNION SELECT USER2_ID ID FROM FRIENDSHIP WHERE USER1_ID = 1 ) A JOIN LIKES L ON A.ID = L.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
117,Y,Y,"SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM ( SELECT USER1_ID, USER2_ID, USER_ID AS MATCH_ID, PAGE_ID FROM ( SELECT USER1_ID, USER2_ID FROM FRIENDSHIP UNION SELECT USER2_ID, USER1_ID FROM FRIENDSHIP ) F CROSS JOIN LIKES L ON F.USER2_ID = L.USER_ID WHERE USER1_ID = 1 ) P WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
118,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT * FROM FRIENDSHIP) A JOIN LIKES ON ( A.USER1_ID=LIKES.USER_ID AND USER2_ID=1 OR A.USER2_ID=LIKES.USER_ID AND USER1_ID=1 ) WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
119,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT DISTINCT CASE WHEN USER1_ID=1 THEN USER2_ID WHEN USER2_ID=1 THEN USER1_ID END AS USER_ID FROM FRIENDSHIP) A JOIN LIKES ON A.USER_ID=LIKES.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
120,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT L.PAGE_ID FROM LIKES L JOIN FRIENDSHIP A ON L.USER_ID = A.USER1_ID WHERE A.USER2_ID = 1 UNION SELECT L.PAGE_ID FROM LIKES L JOIN FRIENDSHIP A ON L.USER_ID = A.USER2_ID WHERE A.USER1_ID = 1) AS A WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
121,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT PAGE_ID FROM LIKES L INNER JOIN FRIENDSHIP F1 ON F1.USER1_ID = L.USER_ID AND F1.USER2_ID = 1 UNION SELECT PAGE_ID FROM LIKES L INNER JOIN FRIENDSHIP F2 ON F2.USER2_ID = L.USER_ID AND F2.USER1_ID = 1) TMP WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
122,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT USER2_ID AS ID FROM FRIENDSHIP WHERE USER1_ID=1 UNION SELECT USER1_ID AS ID FROM FRIENDSHIP WHERE USER2_ID=1) A INNER JOIN LIKES B ON A.ID=B.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
123,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDSHIP F JOIN LIKES L ON ((F.USER1_ID = L.USER_ID AND F.USER2_ID = 1) OR (F.USER2_ID = L.USER_ID AND F.USER1_ID = 1)) WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
124,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDSHIP F JOIN LIKES L ON F.USER2_ID=L.USER_ID OR F.USER1_ID=L.USER_ID WHERE (USER1_ID = 1 OR USER2_ID=1) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
125,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L JOIN (SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END AS USER_ID FROM FRIENDSHIP) F ON L.USER_ID = F.USER_ID AND PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID =1)
126,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES AS L JOIN FRIENDSHIP AS F ON (L.USER_ID = F.USER1_ID AND F.USER2_ID = 1) OR (L.USER_ID = F.USER2_ID AND F.USER1_ID = 1) WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
127,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L JOIN (SELECT USER1_ID FRIENDS FROM FRIENDSHIP WHERE USER2_ID = 1 UNION ALL SELECT USER2_ID FRIENDS FROM FRIENDSHIP WHERE USER1_ID = 1) F ON L.USER_ID = F.FRIENDS WHERE PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1)
128,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES LEFT JOIN (SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID =1) AS TMP ON LIKES.USER_ID = TMP.USER2_ID WHERE LIKES.USER_ID = TMP.USER2_ID AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
129,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE (USER_ID IN (SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1) OR USER_ID IN (SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1)) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
130,Y,Y,"SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID=1) AND USER_ID IN (SELECT DISTINCT USER2_ID AS USER1_FRIENDS FROM (SELECT USER1_ID , USER2_ID FROM FRIENDSHIP UNION ALL SELECT USER2_ID AS USER1_ID, USER1_ID AS USER2_ID FROM FRIENDSHIP ) A WHERE USER1_ID =1 )"
131,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID =1) AND USER_ID IN (SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID=1 UNION SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID=1)
132,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = '1') AND ( USER_ID IN (SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = '1') OR USER_ID IN (SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = '1') )
133,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID ELSE USER1_ID END AS USER_ID FROM FRIENDSHIP F WHERE USER1_ID = 1 OR USER2_ID = 1 ) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
134,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( SELECT DISTINCT USER2_ID FROM FRIENDSHIP WHERE USER1_ID=1 UNION ALL SELECT DISTINCT USER1_ID FROM FRIENDSHIP WHERE USER2_ID=1 ) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1 )
135,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID=1 UNION ALL SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID=1 ) AND PAGE_ID NOT IN( SELECT PAGE_ID FROM LIKES WHERE USER_ID =1 )
136,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT (CASE WHEN USER1_ID=1 THEN USER2_ID WHEN USER2_ID=1 THEN USER1_ID ELSE 0 END) AS FRIEND FROM FRIENDSHIP) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
137,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER2_ID AS FRIEND FROM FRIENDSHIP WHERE USER1_ID = 1 UNION ALL SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
138,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER2_ID AS FRIEND FROM FRIENDSHIP WHERE USER1_ID=1 UNION SELECT USER1_ID AS FRIEND FROM FRIENDSHIP WHERE USER2_ID=1) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1 )
139,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER2_ID AS USER1_FRIEND FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
140,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION ALL SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
141,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES A JOIN ( SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END AS USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1 OR USER2_ID = 1 ) B ON A.USER_ID = B.USER_ID AND A.PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1)
142,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES AS A WHERE (USER_ID IN (SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID=1) OR USER_ID IN (SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID=1)) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID =1)
143,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES JOIN (SELECT USER2_ID AS ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS ID FROM FRIENDSHIP WHERE USER2_ID = 1) AS TEMP ON TEMP.ID=LIKES.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
144,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L JOIN ( SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END AS USER_ID FROM FRIENDSHIP) F USING(USER_ID) WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
145,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L JOIN FRIENDSHIP F ON (L.USER_ID = F.USER2_ID AND F.USER1_ID = 1) OR (L.USER_ID = F.USER1_ID AND F.USER2_ID = 1) WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
146,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1) AND USER_ID IN (SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1)
147,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1) AND USER_ID IN ( SELECT USER2_ID AS UID FROM FRIENDSHIP WHERE USER1_ID=1 UNION SELECT USER1_ID AS UID FROM FRIENDSHIP WHERE USER2_ID=1 ) ORDER BY 1 ASC
148,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE PAGE_ID NOT IN(SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID=1) AND PAGE_ID IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID IN (SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID=1) OR USER_ID IN (SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID=1))
149,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( (SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1) UNION (SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1) ) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
150,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( SELECT (CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END )AS USER_ID FROM FRIENDSHIP) AND PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID =1)
151,Y,N,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( SELECT USER_ID FROM ( SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END AS USER_ID FROM FRIENDSHIP) A ) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 )
152,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID ELSE USER1_ID END AS FRD FROM (SELECT * FROM FRIENDSHIP WHERE USER1_ID = 1 OR USER2_ID = 1) AS A) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
153,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END AS USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1 OR USER2_ID = 1) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
154,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END AS USERID FROM FRIENDSHIP) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
155,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT DISTINCT CASE WHEN USER1_ID =1 THEN USER2_ID WHEN USER2_ID =1 THEN USER1_ID END FROM FRIENDSHIP) AND PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID =1)
156,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT DISTINCT CASE WHEN USER1_ID=1 THEN USER2_ID WHEN USER2_ID=1 THEN USER1_ID END AS FRIENDS FROM FRIENDSHIP WHERE USER1_ID=1 OR USER2_ID=1) AND PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID=1)
157,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT DISTINCT USER2_ID AS ID FROM FRIENDSHIP WHERE USER1_ID = 1) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1) UNION SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT DISTINCT USER1_ID AS ID FROM FRIENDSHIP WHERE USER2_ID = 1) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
158,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER2_ID AS FRIEND FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS FRIEND FROM FRIENDSHIP WHERE USER2_ID =1 ) AND PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID =1)
159,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN( SELECT CASE WHEN USER2_ID = 1 THEN USER1_ID WHEN USER1_ID =1 THEN USER2_ID END AS FRIEND FROM FRIENDSHIP WHERE USER2_ID =1 OR USER1_ID =1) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
160,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM( SELECT PAGE_ID FROM LIKES WHERE USER_ID IN (SELECT USER2_ID AS FRIEND FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS FRIEND FROM FRIENDSHIP WHERE USER2_ID = 1)) T WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
161,Y,Y,"SELECT DISTINCT PAGE_ID RECOMMENDED_PAGE FROM ( SELECT * FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER2_ID, USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1 ) FRIENDS JOIN LIKES ON FRIENDS.USER2_ID = LIKES.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)"
162,Y,Y,"SELECT DISTINCT PAGE_ID RECOMMENDED_PAGE FROM LIKES WHERE PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID =1) AND USER_ID IN (SELECT IF(USER1_ID>USER2_ID,USER1_ID,USER2_ID)USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 OR USER2_ID = 1)"
163,Y,Y,SELECT DISTINCT PAGE_ID RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
164,Y,Y,SELECT DISTINCT(L.PAGE_ID) AS RECOMMENDED_PAGE FROM ( SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID ELSE USER1_ID END AS USER1 FROM FRIENDSHIP WHERE USER1_ID = 1 OR USER2_ID = 1) F INNER JOIN LIKES L ON F.USER1 = L.USER_ID WHERE L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
165,Y,Y,SELECT DISTINCT(PAGE_ID) AS RECOMMENDED_PAGE FROM FRIENDSHIP F JOIN LIKES L ON F.USER1_ID=L.USER_ID OR F.USER2_ID=L.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1) AND (USER1_ID=1 OR USER2_ID=1)
166,Y,Y,SELECT DISTINCT(PAGE_ID) AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END AS USERS FROM FRIENDSHIP WHERE USER1_ID = 1 OR USER2_ID = 1) AND PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
167,Y,Y,SELECT DISTINCT(PAGE_ID) AS RECOMMENDED_PAGE FROM( SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END AS USER1_FRIENDS FROM FRIENDSHIP ) T1 JOIN LIKES L ON T1.USER1_FRIENDS = L.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
168,Y,Y,SELECT L.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES AS L JOIN ( SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID=1 THEN USER1_ID END AS FRIENDID FROM FRIENDSHIP ) AS F ON F.FRIENDID = L.USER_ID GROUP BY 1 HAVING L.PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID =1 )
169,Y,Y,SELECT PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID IN (SELECT USER2_ID AS FREINDS FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS FRIENDS FROM FRIENDSHIP WHERE USER2_ID = 1) )K WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
170,Y,Y,SELECT PAGE_ID AS RECOMMENDED_PAGE FROM( SELECT DISTINCT PAGE_ID FROM LIKES JOIN FRIENDSHIP ON LIKES.USER_ID = FRIENDSHIP.USER2_ID WHERE USER1_ID = 1 AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 ) UNION ALL SELECT DISTINCT PAGE_ID FROM LIKES JOIN FRIENDSHIP ON LIKES.USER_ID = FRIENDSHIP.USER1_ID WHERE USER2_ID = 1 AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 ) )T1 ORDER BY PAGE_ID
171,Y,Y,SELECT RECOMMENDED_PAGE FROM ( SELECT RECOMMENDED_PAGE FROM (SELECT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID =1) AND USER_ID<>1)A UNION ALL (SELECT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID =1) AND USER_ID<>1) )X WHERE RECOMMENDED_PAGE NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID =1) GROUP BY RECOMMENDED_PAGE
172,Y,Y,SELECT RECOMMENDED_PAGE FROM (SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN( SELECT USER2_ID FROM FRIENDSHIP F1 WHERE USER1_ID=1 UNION SELECT USER1_ID FROM FRIENDSHIP F2 WHERE USER2_ID=1))T WHERE RECOMMENDED_PAGE NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
173,Y,Y,"WITH FRIENDSHIP_1 AS ( SELECT USER2_ID,USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1 ) SELECT RECOMMENDED_PAGE FROM ( SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDSHIP F JOIN LIKES L ON F.USER2_ID=L.USER_ID WHERE F.USER1_ID = 1 AND L.PAGE_ID NOT IN(SELECT PAGE_ID FROM LIKES WHERE USER_ID =1) )A UNION ( SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDSHIP_1 F JOIN LIKES L ON F.USER1_ID=L.USER_ID AND L.PAGE_ID NOT IN(SELECT PAGE_ID FROM LIKES WHERE USER_ID =1) )"
174,Y,Y,"WITH A AS ( SELECT USER_ID, PAGE_ID FROM LIKES WHERE PAGE_ID NOT IN(SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1) ) SELECT DISTINCT A.PAGE_ID AS RECOMMENDED_PAGE FROM( SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END AS FRE_USER FROM( SELECT * FROM FRIENDSHIP WHERE USER1_ID = 1 OR USER2_ID = 1 ) B )C , A WHERE A.USER_ID = C.FRE_USER"
175,Y,Y,"WITH A AS (SELECT USER1_ID,USER2_ID FROM FRIENDSHIP UNION SELECT USER2_ID AS USER1_ID, USER1_ID AS USER2_ID FROM FRIENDSHIP), B AS (SELECT DISTINCT USER2_ID FROM A WHERE USER1_ID = 1) SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM B JOIN LIKES AS L ON B.USER2_ID=L.USER_ID WHERE L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)"
176,Y,Y,"WITH ALL_FRIENDSHIP AS (SELECT USER1_ID, USER2_ID FROM FRIENDSHIP UNION SELECT USER2_ID, USER1_ID FROM FRIENDSHIP) SELECT DISTINCT A.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES A JOIN ALL_FRIENDSHIP B ON B.USER2_ID = A.USER_ID WHERE B.USER1_ID =1 AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)"
177,Y,Y,"WITH BASE AS ( SELECT USER1_ID AS ID, USER2_ID AS ID1 FROM FRIENDSHIP UNION ALL SELECT USER2_ID AS ID, USER1_ID AS ID1 FROM FRIENDSHIP ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM BASE, LIKES WHERE BASE.ID1 = LIKES.USER_ID AND ID = 1 AND ID1<> 1 AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
178,Y,N,WITH CTE AS ( SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END AS FR FROM FRIENDSHIP ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT FR FROM CTE WHERE FR IS NOT NULL) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
179,Y,Y,"WITH CTE AS ( SELECT DISTINCT (CASE WHEN A.USER1_ID <= A.USER2_ID THEN A.USER1_ID ELSE A.USER2_ID END) AS USER1, (CASE WHEN A.USER1_ID > A.USER2_ID THEN A.USER1_ID ELSE A.USER2_ID END) AS USER2 FROM FRIENDSHIP A ) SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT * FROM CTE WHERE USER1 = 1 AND USER1 != USER2) AS C INNER JOIN LIKES L ON C.USER2 = L.USER_ID WHERE L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
180,Y,Y,"WITH CTE AS ( SELECT DISTINCT USER2_ID AS FRIEND FROM ( SELECT USER1_ID, USER2_ID FROM FRIENDSHIP UNION ALL SELECT USER2_ID AS USER1_ID, USER1_ID AS USER2_ID FROM FRIENDSHIP )T WHERE USER1_ID = 1 ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( SELECT FRIEND FROM CTE ) AND PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 )"
181,Y,Y,WITH CTE AS ( SELECT L.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L JOIN FRIENDSHIP F ON L.USER_ID = F.USER2_ID WHERE F.USER1_ID = 1 UNION SELECT L.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L JOIN FRIENDSHIP F ON L.USER_ID = F.USER1_ID WHERE F.USER2_ID = 1 ) SELECT RECOMMENDED_PAGE FROM CTE WHERE RECOMMENDED_PAGE NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
182,Y,Y,WITH CTE AS ( SELECT L.PAGE_ID FROM LIKES L JOIN FRIENDSHIP F ON L.USER_ID = F.USER1_ID WHERE F.USER2_ID = 1 UNION SELECT L.PAGE_ID FROM LIKES L JOIN FRIENDSHIP F ON L.USER_ID = F.USER2_ID WHERE F.USER1_ID = 1 ) SELECT PAGE_ID AS RECOMMENDED_PAGE FROM CTE WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
183,Y,Y,WITH CTE AS ( SELECT USER1_FRIEND FROM (SELECT DISTINCT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END AS USER1_FRIEND FROM FRIENDSHIP ) A WHERE USER1_FRIEND IS NOT NULL ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT * FROM CTE) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
184,Y,Y,WITH CTE AS ( SELECT USER1_ID AS FRIEND FROM FRIENDSHIP WHERE USER2_ID=1 UNION SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID=1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L JOIN CTE C ON L.USER_ID=C.FRIEND WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
185,Y,Y,WITH CTE AS ( SELECT USER2_ID AS FRIEND_ID FROM FRIENDSHIP WHERE USER1_ID=1 UNION SELECT USER1_ID AS FRIEND_ID FROM FRIENDSHIP WHERE USER2_ID=1 ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT FRIEND_ID FROM CTE) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
186,Y,Y,WITH CTE AS ( SELECT USER2_ID AS ID FROM FRIENDSHIP WHERE USER1_ID=1 UNION SELECT USER1_ID AS ID FROM FRIENDSHIP WHERE USER2_ID=1 ) SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L JOIN CTE ON CTE.ID = L.USER_ID WHERE L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
187,Y,Y,WITH CTE AS ( SELECT USER_ID FROM ( SELECT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID=1 UNION SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID=1) SUB ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER_ID FROM CTE) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
188,Y,Y,WITH CTE AS (SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ((SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID=1) UNION (SELECT USER1_ID AS USER2_ID FROM FRIENDSHIP WHERE USER2_ID=1))) SELECT * FROM CTE WHERE RECOMMENDED_PAGE NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID=1)
189,Y,Y,"WITH CTE AS (SELECT F.USER1_ID AS USERS,L.PAGE_ID FROM FRIENDSHIP F JOIN LIKES L ON F.USER1_ID = L.USER_ID WHERE USER2_ID =1 UNION SELECT F.USER2_ID AS USERS,L.PAGE_ID FROM FRIENDSHIP F JOIN LIKES L ON F.USER2_ID = L.USER_ID WHERE USER1_ID =1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM CTE WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
190,Y,Y,"WITH CTE AS (SELECT USER1_ID AS A, USER2_ID AS B FROM FRIENDSHIP UNION ALL SELECT USER2_ID AS A, USER1_ID AS B FROM FRIENDSHIP) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT B AS USER_ID FROM CTE WHERE A=1) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)"
191,Y,Y,WITH CTE AS (SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID=1 AND USER1_ID!=1 UNION ALL SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID=1 ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L JOIN CTE C ON L.USER_ID=C.USER1_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
192,Y,Y,WITH CTE AS (SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID = 1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER_ID FROM CTE) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
193,Y,Y,WITH CTE AS (SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION ALL SELECT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID = 1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES A JOIN CTE B ON A.USER_ID = B.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
194,Y,Y,WITH CTE AS (SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT * FROM CTE) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
195,Y,Y,WITH CTE AS (SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION ALL SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM CTE JOIN LIKES L ON CTE.USER2_ID = L.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
196,Y,Y,WITH CTE AS (SELECT USER2_ID USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID USER_ID FROM FRIENDSHIP WHERE USER2_ID = 1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT PAGE_ID FROM LIKES WHERE USER_ID IN (SELECT USER_ID FROM CTE)) SUB WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
197,Y,Y,WITH CTE AS( SELECT USER2_ID AS FRIENDS FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS FRIENDS FROM FRIENDSHIP WHERE USER2_ID = 1 ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT FRIENDS FROM CTE) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
198,Y,Y,WITH CTE AS( SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID = 1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L JOIN CTE C ON L.USER_ID = C.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
199,Y,Y,WITH CTE AS( SELECT USER2_ID ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION ALL SELECT USER1_ID ID FROM FRIENDSHIP WHERE USER2_ID = 1 ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L INNER JOIN CTE ON CTE.ID = L.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
200,Y,Y,"WITH CTE1 AS ( SELECT USER1_ID , USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 OR USER2_ID = 1 ), CTE2 AS ( SELECT PAGE_ID FROM CTE1 LEFT JOIN LIKES ON USER1_ID = USER_ID WHERE USER_ID != 1 UNION ALL SELECT PAGE_ID FROM CTE1 LEFT JOIN LIKES ON USER2_ID = USER_ID WHERE USER_ID != 1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM CTE2 WHERE PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
201,Y,Y,"WITH CTE1 AS ( SELECT USER1_ID, USER2_ID FROM FRIENDSHIP UNION ALL SELECT USER2_ID, USER1_ID FROM FRIENDSHIP ) SELECT DISTINCT LIKES.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES INNER JOIN CTE1 ON CTE1.USER2_ID = LIKES.USER_ID WHERE CTE1.USER1_ID = 1 AND CTE1.USER2_ID !=1 AND LIKES.PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID =1 )"
202,Y,Y,WITH CTE1 AS (SELECT FR.USER2_ID AS FRIEND FROM FRIENDSHIP FR WHERE FR.USER1_ID = 1 UNION ALL SELECT FR.USER1_ID AS FRIEND FROM FRIENDSHIP FR WHERE FR.USER2_ID = 1) SELECT DISTINCT LK.PAGE_ID AS RECOMMENDED_PAGE FROM CTE1 CT1 JOIN LIKES LK ON CT1.FRIEND = LK.USER_ID WHERE LK.PAGE_ID NOT IN (SELECT LK1.PAGE_ID FROM LIKES LK1 WHERE LK1.USER_ID = 1) ORDER BY 1 ASC
203,Y,Y,"WITH CTE_FRIENDS AS ( SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END AS USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1 OR USER2_ID=1 ), ALREADY_LIKED AS ( SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1 ), PAGES_REC AS ( SELECT DISTINCT LIKES.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES INNER JOIN CTE_FRIENDS CF ON LIKES.USER_ID=CF.USER_ID LEFT JOIN ALREADY_LIKED AL ON LIKES.PAGE_ID=AL.PAGE_ID WHERE AL.PAGE_ID IS NULL ) SELECT * FROM PAGES_REC"
204,Y,Y,"WITH CTE_FRIENDS AS ( SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END AS USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1 OR USER2_ID=1 ), ALREADY_LIKED AS ( SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1 ), PAGES_REC AS ( SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES INNER JOIN CTE_FRIENDS CF ON LIKES.USER_ID=CF.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM ALREADY_LIKED) ) SELECT * FROM PAGES_REC"
205,Y,Y,"WITH CTE_FRIENDS AS ( SELECT DISTINCT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END AS USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1 OR USER2_ID = 1 ), CTE_FINAL AS ( SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( SELECT USER_ID FROM CTE_FRIENDS ) AND PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 ) ) SELECT * FROM CTE_FINAL"
206,Y,Y,"WITH F AS( SELECT IF(USER1_ID<USER2_ID, USER1_ID, USER2_ID) AS ID, IF(USER1_ID>USER2_ID, USER1_ID, USER2_ID) AS FRIEND_ID FROM FRIENDSHIP) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM F JOIN LIKES L ON F.FRIEND_ID=L.USER_ID WHERE F.ID=1 AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)"
207,Y,Y,"WITH F AS ( SELECT U1, U2 FROM (SELECT USER1_ID U1, USER2_ID U2 FROM FRIENDSHIP UNION SELECT USER2_ID U1, USER1_ID U2 FROM FRIENDSHIP) A WHERE U1=1 ) SELECT DISTINCT B.PAGE_ID RECOMMENDED_PAGE FROM F A JOIN LIKES B ON A.U2 = B.USER_ID WHERE B.PAGE_ID NOT IN ( SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID=1)"
208,Y,Y,"WITH F AS ( SELECT USER1_ID U1, USER2_ID U2 FROM FRIENDSHIP UNION SELECT USER2_ID U1, USER1_ID U2 FROM FRIENDSHIP ) SELECT DISTINCT B.PAGE_ID RECOMMENDED_PAGE FROM F A JOIN LIKES B ON A.U1 = 1 AND A.U2 = B.USER_ID WHERE B.PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID=1)"
209,Y,Y,WITH F AS ( SELECT USER2_ID ID FROM FRIENDSHIP WHERE USER1_ID=1 UNION SELECT USER1_ID ID FROM FRIENDSHIP WHERE USER2_ID=1 ) SELECT DISTINCT PAGE_ID RECOMMENDED_PAGE FROM LIKES JOIN F ON USER_ID=F.ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
210,Y,Y,"WITH F1 AS (SELECT USER2_ID AS ID FROM FRIENDSHIP WHERE USER1_ID=1), F2 AS (SELECT USER1_ID AS ID FROM FRIENDSHIP WHERE USER2_ID=1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ((SELECT ID FROM F1) UNION (SELECT ID FROM F2)) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)"
211,Y,Y,"WITH FRIEND AS ( SELECT USER1_ID AS ID, USER2_ID AS FRIEND FROM FRIENDSHIP UNION SELECT USER2_ID AS ID, USER1_ID AS FRIEND FROM FRIENDSHIP) SELECT * FROM ( SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM FRIEND F LEFT JOIN LIKES L ON F.FRIEND = L.USER_ID LEFT JOIN LIKES L2 ON F.ID = L2.USER_ID AND L.PAGE_ID = L2.PAGE_ID WHERE L2.USER_ID IS NULL AND F.ID = 1) A WHERE RECOMMENDED_PAGE IS NOT NULL"
212,Y,Y,"WITH FRIEND AS ( SELECT USER1_ID AS ID, USER2_ID AS FRIEND FROM FRIENDSHIP UNION SELECT USER2_ID AS ID, USER1_ID AS FRIEND FROM FRIENDSHIP) SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM FRIEND F LEFT JOIN LIKES L ON F.FRIEND = L.USER_ID LEFT JOIN LIKES L2 ON F.ID = L2.USER_ID AND L.PAGE_ID = L2.PAGE_ID WHERE L2.USER_ID IS NULL AND F.ID = 1 AND L.PAGE_ID IS NOT NULL"
213,Y,Y,WITH FRIEND AS( SELECT USER2_ID AS ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS ID FROM FRIENDSHIP WHERE USER2_ID = 1 ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT ID FROM FRIEND) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID =1 )
214,Y,Y,WITH FRIEND_1 AS ( SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID=1 UNION SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID=1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES A JOIN FRIEND_1 B ON A.USER_ID =B.USER1_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
215,Y,Y,"WITH FRIEND_LIST AS ( SELECT USER1_ID AS FRIENDS FROM FRIENDSHIP WHERE USER2_ID = 1 UNION SELECT USER2_ID AS FRIENDS FROM FRIENDSHIP WHERE USER1_ID = 1 ), USER1_PAGE_LIST AS ( SELECT PAGE_ID AS PAGES FROM LIKES WHERE USER_ID = 1 ), FRIENDS_PAGE_LIST AS ( SELECT PAGE_ID AS PAGES FROM LIKES WHERE USER_ID IN (SELECT FRIENDS FROM FRIEND_LIST) ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE PAGE_ID IN (SELECT PAGES FROM FRIENDS_PAGE_LIST) AND PAGE_ID NOT IN (SELECT PAGES FROM USER1_PAGE_LIST)"
216,Y,Y,"WITH FRIENDLIST AS ( SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION ALL SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1), ALREADYLIKED AS ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 ) SELECT DISTINCT(PAGE_ID) AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT * FROM FRIENDLIST) AND PAGE_ID NOT IN (SELECT * FROM ALREADYLIKED)"
217,Y,Y,WITH FRIENDS AS ( SELECT DISTINCT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT DISTINCT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID = 1 ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT * FROM FRIENDS) AND PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1)
218,Y,Y,"WITH FRIENDS AS ( SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1 ), ALREADY_LIKED AS ( SELECT PAGE_ID FROM LIKES WHERE USER_ID =1 ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT * FROM FRIENDS) AND PAGE_ID NOT IN (SELECT * FROM ALREADY_LIKED)"
219,Y,Y,"WITH FRIENDS AS ( SELECT USER1_ID,USER2_ID FROM FRIENDSHIP UNION SELECT USER2_ID,USER1_ID FROM FRIENDSHIP ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDS F INNER JOIN LIKES L ON F.USER2_ID=L.USER_ID WHERE NOT EXISTS ( SELECT 2 FROM LIKES L2 WHERE F.USER1_ID =L2.USER_ID AND L.PAGE_ID =L2.PAGE_ID) AND USER1_ID=1"
220,Y,Y,"WITH FRIENDS AS ( SELECT USER1_ID AS USER1, USER2_ID AS USER2 FROM FRIENDSHIP WHERE USER1_ID<USER2_ID UNION SELECT USER2_ID AS USER1, USER1_ID AS USER2 FROM FRIENDSHIP WHERE USER1_ID>USER2_ID ) SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDS F JOIN LIKES L ON F.USER2 = L.USER_ID WHERE F.USER1 = 1 AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
221,Y,Y,WITH FRIENDS AS ( SELECT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID = 1 UNION SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1 ) SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L INNER JOIN FRIENDS F ON L.USER_ID = F.USER_ID WHERE L.PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1)
222,Y,Y,WITH FRIENDS AS ( SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID=1 UNION SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID=1 ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES JOIN FRIENDS ON LIKES.USER_ID =FRIENDS.USER1_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
223,Y,Y,"WITH FRIENDS AS ( SELECT USER1_ID, USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER2_ID, USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1 ) SELECT DISTINCT B.PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDS A JOIN LIKES B ON A.USER2_ID = B.USER_ID WHERE B.PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 )"
224,Y,Y,WITH FRIENDS AS ( SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID = 1 ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDS JOIN LIKES USING (USER_ID) WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
225,Y,N,"WITH FRIENDS AS (SELECT (CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END) AS FRIEND FROM FRIENDSHIP), USER_LIKES AS (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT * FROM FRIENDS) AND PAGE_ID NOT IN (SELECT * FROM USER_LIKES)"
226,Y,Y,WITH FRIENDS AS (SELECT USER1_ID AS UID FROM FRIENDSHIP WHERE USER2_ID = 1 UNION SELECT USER2_ID AS UID FROM FRIENDSHIP WHERE USER1_ID = 1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT DISTINCT UID FROM FRIENDS) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
227,Y,Y,WITH FRIENDS AS (SELECT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID = 1 UNION SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1) SELECT DISTINCT A.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES A WHERE A.USER_ID IN (SELECT USER_ID FROM FRIENDS) AND A.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
228,Y,Y,"WITH FRIENDS AS( SELECT USER1_ID USER_ID, USER2_ID FRIEND_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER2_ID USER_ID, USER1_ID FRIEND_ID FROM FRIENDSHIP WHERE USER2_ID = 1) SELECT DISTINCT L.PAGE_ID RECOMMENDED_PAGE FROM FRIENDS F LEFT JOIN LIKES L ON F.FRIEND_ID = L.USER_ID WHERE L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1) AND L.PAGE_ID IS NOT NULL"
229,Y,Y,"WITH FRIENDS AS( SELECT USER2_ID AS FRIEND FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS FRIEND FROM FRIENDSHIP WHERE USER2_ID = 1 ), NOTLIKE AS ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT FRIEND FROM FRIENDS) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM NOTLIKE)"
230,Y,Y,"WITH FRIENDS AS( SELECT USER2_ID U FROM FRIENDSHIP WHERE USER1_ID=1 UNION SELECT USER1_ID U FROM FRIENDSHIP WHERE USER2_ID=1 ), PAGES AS( SELECT USER_ID,PAGE_ID FROM LIKES WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)) SELECT DISTINCT PAGE_ID RECOMMENDED_PAGE FROM PAGES P JOIN FRIENDS F ON P.USER_ID=F.U"
231,Y,Y,"WITH FRIENDS1 AS ( SELECT USER2_ID USER_ID FROM FRIENDSHIP WHERE USER1_ID=1 UNION ALL SELECT USER1_ID USER_ID FROM FRIENDSHIP WHERE USER2_ID=1 GROUP BY USER_ID), FRIEND_LIKE AS (SELECT L.PAGE_ID FROM FRIENDS1 F JOIN LIKES L ON F.USER_ID=L.USER_ID GROUP BY PAGE_ID) SELECT PAGE_ID RECOMMENDED_PAGE FROM FRIEND_LIKE WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID =1)"
232,Y,Y,WITH FRIENDS_OF_1 AS ( SELECT USER2_ID AS USER_1_FRIEND FROM FRIENDSHIP WHERE USER1_ID=1 UNION SELECT USER1_ID AS USER_1_FRIEND FROM FRIENDSHIP WHERE USER2_ID=1 ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER_1_FRIEND FROM FRIENDS_OF_1 ) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1) ORDER BY 1
233,Y,Y,"WITH FRIENDTABLE AS( SELECT USER1_ID AS ID, USER2_ID AS FRIEND FROM FRIENDSHIP UNION SELECT USER2_ID AS ID, USER1_ID AS FRIEND FROM FRIENDSHIP ) SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES AS L JOIN FRIENDTABLE AS F ON F.FRIEND=L.USER_ID WHERE F.ID=1 AND L.PAGE_ID NOT IN( SELECT PAGE_ID FROM LIKES WHERE USER_ID=1 )"
234,Y,Y,"WITH FRS AS(SELECT USER1_ID AS ME, USER2_ID AS FRIENDS FROM FRIENDSHIP UNION ALL SELECT USER2_ID AS ME, USER1_ID AS FRIENDS FROM FRIENDSHIP) SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM FRS F JOIN LIKES L ON F.FRIENDS=L.USER_ID WHERE F.ME =1 AND L.PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID=1)"
235,Y,Y,WITH INITITAL AS ( SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID = 1 ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER_ID FROM INITITAL) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
236,Y,Y,"WITH JOINED_FRIENDS AS ( SELECT USER1_ID AS USER1_ID, USER2_ID AS USER2_ID FROM FRIENDSHIP F UNION ALL SELECT USER2_ID AS USER1_ID, USER1_ID AS USER2_ID FROM FRIENDSHIP F ) , FRIEND_LIKES AS ( SELECT DISTINCT PAGE_ID FROM LIKES L WHERE USER_ID IN (SELECT DISTINCT USER2_ID FROM JOINED_FRIENDS WHERE USER1_ID = 1) ) , LIKED_BY_1 AS ( SELECT DISTINCT PAGE_ID FROM LIKES L WHERE USER_ID = 1 ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM FRIEND_LIKES F WHERE F.PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKED_BY_1)"
237,Y,Y,"WITH ME_F AS ( SELECT USER1_ID ID, USER2_ID FRIEND FROM FRIENDSHIP WHERE USER1_ID=1 UNION SELECT USER2_ID ID, USER1_ID FRIEND FROM FRIENDSHIP WHERE USER2_ID=1) SELECT DISTINCT PAGE_ID RECOMMENDED_PAGE FROM ME_F M JOIN LIKES L ON M.FRIEND = L.USER_ID WHERE PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)"
238,Y,Y,WITH MYF AS (SELECT USER1_ID AS ID FROM FRIENDSHIP WHERE USER2_ID = 1 UNION SELECT USER2_ID AS ID FROM FRIENDSHIP WHERE USER1_ID = 1 ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM MYF JOIN LIKES ON MYF.ID = LIKES.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
239,Y,Y,"WITH NEW AS ( SELECT CASE WHEN USER1_ID < USER2_ID THEN USER1_ID WHEN USER1_ID > USER2_ID THEN USER2_ID END AS USER1, CASE WHEN USER1_ID < USER2_ID THEN USER2_ID WHEN USER1_ID > USER2_ID THEN USER1_ID END AS USER2 FROM FRIENDSHIP ) SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM NEW N JOIN LIKES L ON N.USER2 = L.USER_ID WHERE L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1) AND N.USER1 = 1 ORDER BY L.PAGE_ID"
240,Y,Y,WITH ONE_FRND AS ( SELECT DISTINCT USER2_ID AS ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION ALL SELECT DISTINCT USER1_ID AS ID FROM FRIENDSHIP WHERE USER2_ID = 1 ) SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM ONE_FRND O INNER JOIN LIKES L ON O.ID = L.USER_ID AND L.PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID =1)
241,Y,Y,"WITH PAGES_FRIENDS AS (SELECT DISTINCT L.PAGE_ID FROM (SELECT USER1_ID, USER2_ID FROM FRIENDSHIP UNION SELECT USER2_ID, USER1_ID FROM FRIENDSHIP) A LEFT JOIN LIKES L ON L.USER_ID = A.USER2_ID WHERE USER1_ID = 1) SELECT PAGE_ID AS RECOMMENDED_PAGE FROM PAGES_FRIENDS WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1) AND PAGE_ID IS NOT NULL ORDER BY RECOMMENDED_PAGE"
242,Y,Y,"WITH T AS ( SELECT USER1_ID, USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER2_ID, USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE PAGE_ID NOT IN(SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1) AND USER_ID IN (SELECT USER2_ID FROM T)"
243,Y,Y,"WITH T1 AS ( SELECT USER1_ID, USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 OR USER2_ID = 1 ), T2 AS ( SELECT DISTINCT USER_ID FROM LIKES WHERE (USER_ID IN (SELECT USER1_ID FROM T1) OR USER_ID IN (SELECT USER2_ID FROM T1)) AND USER_ID != 1 ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM T2 LEFT JOIN LIKES USING(USER_ID) WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1) ORDER BY PAGE_ID"
244,Y,Y,WITH T1 AS ( SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID=1 UNION SELECT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID=1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER_ID FROM T1) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID =1)
245,Y,Y,"WITH T1 AS (SELECT USER1_ID AS U, USER2_ID AS T FROM FRIENDSHIP UNION ALL SELECT USER2_ID AS U, USER1_ID AS T FROM FRIENDSHIP) SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L WHERE L.USER_ID IN (SELECT T FROM T1 WHERE U = 1 ) AND L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
246,Y,Y,WITH T1 AS (SELECT USER2_ID AS ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION ALL SELECT USER1_ID AS ID FROM FRIENDSHIP WHERE USER2_ID = 1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM T1 A JOIN LIKES B ON A.ID = USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
247,Y,Y,WITH TABLE1 AS ( SELECT USER2_ID AS USERS FROM FRIENDSHIP WHERE USER1_ID=1 UNION SELECT USER1_ID AS USERS FROM FRIENDSHIP WHERE USER2_ID=1 ) SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM TABLE1 T JOIN LIKES L ON T.USERS=L.USER_ID WHERE L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
248,Y,Y,WITH TEMP AS ( SELECT (CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END) AS USER_ID FROM FRIENDSHIP ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES K JOIN TEMP T ON K.USER_ID = T.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
249,Y,Y,"WITH TEMP AS ( SELECT USER1_ID, USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION ALL SELECT USER2_ID AS USER1_ID, USER1_ID AS USER2_ID FROM FRIENDSHIP WHERE USER2_ID = 1 ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM TEMP T JOIN LIKES L ON T.USER2_ID = L.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
250,Y,Y,WITH TEMP AS ( SELECT USER2_ID AS ID FROM FRIENDSHIP WHERE USER1_ID =1 UNION SELECT USER1_ID AS ID FROM FRIENDSHIP WHERE USER2_ID=1 ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT ID FROM TEMP) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID =1)
251,Y,Y,WITH TEMP0 AS ( SELECT DISTINCT USER1_ID AS FRIEND FROM FRIENDSHIP WHERE USER2_ID = 1 UNION SELECT DISTINCT USER2_ID AS FRIEND FROM FRIENDSHIP WHERE USER1_ID = 1 ) SELECT DISTINCT A.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES A JOIN TEMP0 B ON B.FRIEND = A.USER_ID WHERE A.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
252,Y,Y,WITH TMP AS (SELECT USER2_ID AS FID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS FID FROM FRIENDSHIP WHERE USER2_ID = 1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES A JOIN TMP B ON A.USER_ID = B.FID WHERE PAGE_ID NOT IN (SELECT DISTINCT A.PAGE_ID FROM LIKES A WHERE A.USER_ID = 1)
253,Y,Y,"WITH U1_L AS ( SELECT * FROM LIKES WHERE USER_ID = 1 ), U1_F AS ( SELECT USER1_ID, USER2_ID FROM FRIENDSHIP UNION SELECT USER2_ID AS USER1_ID, USER1_ID AS USER2_ID FROM FRIENDSHIP ) SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L JOIN U1_F ON U1_F.USER1_ID = L.USER_ID WHERE (USER1_ID = 1 OR USER2_ID = 1) AND L.PAGE_ID NOT IN (SELECT PAGE_ID FROM U1_L)"
254,Y,Y,"WITH USER1_FRIEND AS ( SELECT DISTINCT USER1_ID AS SELF_ID, USER2_ID AS FRIEND_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION ALL SELECT DISTINCT USER2_ID AS SELF_ID, USER1_ID AS FRIEND_ID FROM FRIENDSHIP WHERE USER2_ID = 1 ) ,TMP1 AS (SELECT T1.SELF_ID, T2.PAGE_ID AS SELF_LIKE FROM USER1_FRIEND T1 LEFT JOIN LIKES T2 ON T1.SELF_ID = T2.USER_ID GROUP BY 1,2), TMP2 AS (SELECT T1.SELF_ID, T3.PAGE_ID AS FRIEND_LIKE FROM USER1_FRIEND T1 LEFT JOIN LIKES T3 ON T1.FRIEND_ID = T3.USER_ID GROUP BY 1,2), TMP3 AS (SELECT TMP1.SELF_ID, IFNULL(TMP1.SELF_LIKE,0) AS SELF_LIKE, IFNULL(TMP2.FRIEND_LIKE,0) AS FRIEND_LIKE FROM TMP1 LEFT JOIN TMP2 ON TMP1.SELF_ID = TMP2.SELF_ID) SELECT DISTINCT (FRIEND_LIKE) AS RECOMMENDED_PAGE FROM TMP3 WHERE FRIEND_LIKE NOT IN (SELECT DISTINCT SELF_LIKE FROM TMP3) AND FRIEND_LIKE <> 0 ORDER BY 1 DESC"
255,Y,Y,"WITH USER1_FRIENDS AS (SELECT USER2_ID AS FRIENDS FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS FRIENDS FROM FRIENDSHIP WHERE USER2_ID = 1), USER1_LIKES AS (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT * FROM USER1_FRIENDS) AND PAGE_ID NOT IN (SELECT* FROM USER1_LIKES)"
256,Y,Y,WITH USER_1_FRIENDS AS ( SELECT USER2_ID FRIEND_ID FROM FRIENDSHIP WHERE USER1_ID=1 UNION SELECT USER1_ID FRIEND_ID FROM FRIENDSHIP WHERE USER2_ID=1 ) SELECT DISTINCT PAGE_ID RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT FRIEND_ID FROM USER_1_FRIENDS) AND PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID=1)
257,Y,Y,"WITH USER_FRIEND AS( SELECT DISTINCT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID =1 UNION ALL SELECT DISTINCT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID=1 ), LIKED_PAGES AS ( SELECT PAGE_ID FROM LIKES WHERE USER_ID =1 ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER_ID FROM USER_FRIEND) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKED_PAGES)"
258,Y,Y,"WITH USER_LIKED AS ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 ), FRIENDS_LIKED AS ( SELECT DISTINCT(PAGE_ID) FROM LIKES L JOIN FRIENDSHIP F ON F.USER2_ID = L.USER_ID WHERE F.USER1_ID = 1 UNION SELECT DISTINCT(PAGE_ID) FROM LIKES L JOIN FRIENDSHIP F ON F.USER1_ID = L.USER_ID WHERE F.USER2_ID = 1 ) SELECT PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDS_LIKED WHERE PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
259,Y,Y,"WITH USERS AS ( SELECT USER1_ID AS USER1,USER2_ID AS USER2 FROM FRIENDSHIP F1 UNION SELECT USER2_ID AS USER1,USER1_ID AS USER2 FROM FRIENDSHIP F2 ) SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM USERS U JOIN LIKES L ON U.USER2 = L.USER_ID WHERE U.USER1 = 1 AND L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES L1 WHERE USER_ID = 1)"
260,Y,Y,WITH USERSFRIENDS AS (SELECT USER1_ID AS FRIENDS FROM FRIENDSHIP WHERE USER2_ID = 1 UNION SELECT USER2_ID AS FRIENDS FROM FRIENDSHIP WHERE USER1_ID = 1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT FRIENDS FROM USERSFRIENDS) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
261,Y,Y,WITH X AS ( SELECT USER2_ID AS USER FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS USER FROM FRIENDSHIP WHERE USER2_ID = 1 ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER FROM X) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
262,Y,Y,WITH TEMP AS ( (SELECT PAGE_ID FROM LIKES WHERE USER_ID IN (SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID=1 AND USER2_ID != 1)) UNION (SELECT PAGE_ID FROM LIKES WHERE USER_ID IN (SELECT USER1_ID FROM FRIENDSHIP WHERE USER1_ID!=1 AND USER2_ID = 1)) ) SELECT PAGE_ID AS RECOMMENDED_PAGE FROM TEMP WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID =1 )
263,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER2_ID AS ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS ID FROM FRIENDSHIP WHERE USER2_ID = 1) AND PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1)
264,Y,Y,WITH TB1 AS (SELECT USER2_ID AS ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION ALL SELECT USER1_ID AS ID FROM FRIENDSHIP WHERE USER2_ID = 1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM TB1 JOIN LIKES ON USER_ID = ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
265,Y,Y,WITH FRIENDS AS (SELECT DISTINCT F.FRIEND FROM (SELECT USER2_ID AS FRIEND FROM FRIENDSHIP F1 WHERE USER1_ID = '1' UNION SELECT USER1_ID AS FRIEND FROM FRIENDSHIP F2 WHERE USER2_ID = '1') F) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT FRIEND FROM FRIENDS) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = '1')
266,Y,Y,WITH CTE AS( SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END AS USER_ID FROM FRIENDSHIP) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM CTE JOIN LIKES USING(USER_ID) WHERE PAGE_ID NOT IN(SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
267,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1) AND USER_ID IN ( SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1 UNION SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 )
268,Y,Y,"WITH CTE AS (SELECT USER1_ID, USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER2_ID, USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER2_ID FROM CTE) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
269,Y,Y,WITH FRIENDS_GRAPH AS (SELECT USER2_ID AS FRIENDS FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS FRIENDS FROM FRIENDSHIP WHERE USER2_ID = 1 ) SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDS_GRAPH AS FG JOIN LIKES AS L ON FG.FRIENDS = L.USER_ID WHERE L.PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1)
270,Y,Y,WITH CTE1 AS ( SELECT USER2_ID AS FRIEND_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS FRIEND_ID FROM FRIENDSHIP WHERE USER2_ID = 1) SELECT DISTINCT PAGE_ID RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT FRIEND_ID FROM CTE1) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
271,Y,Y,SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDSHIP AS F INNER JOIN LIKES AS L ON F.USER1_ID = L.USER_ID OR F.USER2_ID = L.USER_ID WHERE (F.USER1_ID=1 OR F.USER2_ID=1) AND L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
272,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1) AND USER_ID IN (SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END AS FRIEND FROM FRIENDSHIP WHERE USER1_ID = 1 OR USER2_ID = 1)
273,Y,Y,SELECT DISTINCT B.PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDSHIP A INNER JOIN LIKES B ON A.USER1_ID = B.USER_ID OR A.USER2_ID = B.USER_ID WHERE (A.USER1_ID = 1 OR A.USER2_ID = 1) AND B.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
274,Y,Y,"WITH TEMP AS( SELECT DISTINCT T.USER1_ID,T.USER2_ID FROM (SELECT USER1_ID, USER2_ID FROM FRIENDSHIP UNION ALL SELECT USER2_ID, USER1_ID FROM FRIENDSHIP) T) SELECT DISTINCT B.PAGE_ID AS RECOMMENDED_PAGE FROM TEMP A JOIN LIKES B ON A.USER2_ID = B.USER_ID WHERE A.USER1_ID = 1 AND B.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = A.USER1_ID)"
275,Y,Y,SELECT DISTINCT PAGE_ID RECOMMENDED_PAGE FROM (SELECT CASE WHEN USER1_ID=1 THEN USER2_ID WHEN USER2_ID=1 THEN USER1_ID END AS USER_ID FROM FRIENDSHIP)F JOIN LIKES L ON (F.USER_ID=L.USER_ID) WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
276,Y,Y,SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID =1 THEN USER1_ID ELSE NULL END AS USER_ID FROM FRIENDSHIP) A JOIN LIKES L ON A.USER_ID = L.USER_ID WHERE L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
277,Y,Y,"WITH T AS (SELECT DISTINCT USER2 FROM (SELECT USER1_ID AS USER1, USER2_ID AS USER2 FROM FRIENDSHIP UNION ALL SELECT USER2_ID AS USER1, USER1_ID AS USER2 FROM FRIENDSHIP) TEMP WHERE USER1 = 1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER2 FROM T) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
278,Y,Y,"SELECT B.PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT CASE WHEN USER1_ID=1 THEN USER2_ID WHEN USER2_ID=1 THEN USER1_ID END USERX_ID FROM FRIENDSHIP) A JOIN (SELECT USER_ID,PAGE_ID FROM LIKES WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)) B ON A.USERX_ID=USER_ID GROUP BY 1"
279,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER2_ID AS FRIEND FROM FRIENDSHIP WHERE USER1_ID = 1 UNION ALL SELECT USER1_ID AS FRIEND FROM FRIENDSHIP WHERE USER2_ID = 1) AND PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1)
280,Y,Y,SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDSHIP F LEFT JOIN LIKES L ON (F.USER1_ID = 1 OR F.USER2_ID = 1) AND (F.USER2_ID = L.USER_ID OR F.USER1_ID = L.USER_ID) WHERE L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1) AND L.PAGE_ID IS NOT NULL
281,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE LIKES.USER_ID IN ((SELECT DISTINCT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID = '1') UNION ALL (SELECT DISTINCT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID = '1')) AND LIKES.PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID ='1')
282,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM ( SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END AS USER_ID FROM FRIENDSHIP ) AS FRIENDS JOIN LIKES ON FRIENDS.USER_ID = LIKES.USER_ID WHERE PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 )
283,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID=1 UNION SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID=1) AND USER_ID!=1 AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID =1)
284,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ((SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1) UNION (SELECT DISTINCT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1)) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
285,Y,Y,"WITH FRIENDSHIP_TABLE AS ( SELECT CASE WHEN USER1_ID < USER2_ID THEN USER1_ID ELSE USER2_ID END AS USER1_ID, CASE WHEN USER1_ID > USER2_ID THEN USER1_ID ELSE USER2_ID END AS USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 OR USER2_ID = 1 ) SELECT DISTINCT T2.PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDSHIP_TABLE T1 JOIN LIKES T2 ON T1.USER2_ID = T2.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
286,Y,Y,SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L JOIN FRIENDSHIP F ON L.USER_ID = F.USER1_ID OR L.USER_ID = F.USER2_ID WHERE F.USER1_ID = 1 OR F.USER2_ID = 1 GROUP BY L.PAGE_ID HAVING SUM(L.USER_ID=1) = 0
287,Y,Y,"SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES RIGHT JOIN ( SELECT USER2_ID ID FROM FRIENDSHIP WHERE USER1_ID=1 UNION SELECT USER1_ID ID FROM FRIENDSHIP WHERE USER2_ID=1 )MAIN ON USER_ID=ID WHERE (1,PAGE_ID) NOT IN (SELECT USER_ID,PAGE_ID FROM LIKES) AND PAGE_ID IS NOT NULL"
288,Y,Y,SELECT B.PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT CASE WHEN USER1_ID=1 THEN USER2_ID WHEN USER2_ID=1 THEN USER1_ID END USERX_ID FROM FRIENDSHIP) A JOIN LIKES B ON A.USERX_ID=B.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1) GROUP BY 1
289,Y,Y,WITH T1 AS (SELECT DISTINCT F.USER2_ID AS USER_ID FROM FRIENDSHIP F WHERE F.USER1_ID = 1 UNION SELECT DISTINCT F.USER1_ID AS USER_ID FROM FRIENDSHIP F WHERE F.USER2_ID = 1) SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L INNER JOIN T1 ON L.USER_ID = T1.USER_ID WHERE L.PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1)
290,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDSHIP F JOIN ( SELECT * FROM LIKES L WHERE PAGE_ID NOT IN(SELECT PAGE_ID FROM LIKES WHERE USER_ID=1) ) L ON ((F.USER2_ID = L.USER_ID AND F.USER1_ID =1) OR (F.USER1_ID = L.USER_ID AND F.USER2_ID =1))
291,Y,Y,"WITH FRIENDS_TABLE AS ( SELECT USERS, FRIENDS FROM ( SELECT USER1_ID AS USERS, USER2_ID AS FRIENDS FROM FRIENDSHIP UNION ALL SELECT USER2_ID AS USERS, USER1_ID AS FRIENDS FROM FRIENDSHIP ) X WHERE USERS = 1 ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT DISTINCT FRIENDS FROM FRIENDS_TABLE) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1) ORDER BY 1"
292,Y,Y,SELECT DISTINCT PAGE_ID RECOMMENDED_PAGE FROM LIKES WHERE PAGE_ID NOT IN ( SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1 ) AND PAGE_ID IN ( SELECT PAGE_ID FROM LIKES JOIN FRIENDSHIP ON (USER1_ID = 1 AND USER2_ID = USER_ID) OR (USER2_ID = 1 AND USER1_ID = USER_ID) )
293,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION ALL SELECT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID = 1) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
294,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L WHERE USER_ID IN ( SELECT USER2_ID FROM FRIENDSHIP F WHERE USER1_ID = 1) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES L WHERE USER_ID = 1) UNION ALL SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L WHERE USER_ID IN ( SELECT USER1_ID FROM FRIENDSHIP F WHERE USER2_ID = 1) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES L WHERE USER_ID = 1)
295,Y,Y,"WITH CTE AS (SELECT U1, U2 FROM (SELECT USER1_ID U1, USER2_ID U2 FROM FRIENDSHIP UNION SELECT USER2_ID U1, USER1_ID U2 FROM FRIENDSHIP) A WHERE U1 = 1) SELECT DISTINCT PAGE_ID RECOMMENDED_PAGE FROM CTE JOIN LIKES L ON CTE.U2 = L.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM CTE JOIN LIKES L ON CTE.U1 = L.USER_ID)"
296,Y,Y,"SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L JOIN (SELECT IF(USER2_ID = 1, 1, USER1_ID) U1_ID, IF(USER2_ID = 1, USER1_ID, USER2_ID) U2_ID FROM FRIENDSHIP) F ON USER_ID = U2_ID AND U1_ID = 1 WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
297,Y,Y,"WITH A AS (SELECT USER1_ID AS ID, USER2_ID AS FRIEND FROM FRIENDSHIP WHERE USER1_ID=1 UNION ALL SELECT USER2_ID AS ID,USER1_ID AS FRIEND FROM FRIENDSHIP WHERE USER2_ID=1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT DISTINCT PAGE_ID FROM A INNER JOIN LIKES L ON A.FRIEND=L.USER_ID) AS T WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)"
298,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID=1) AND (USER_ID IN (SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID=1) OR USER_ID IN (SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID=1))
299,Y,Y,WITH FRIENDLIST AS (SELECT USER2_ID AS FRIENDS FROM FRIENDSHIP WHERE USER1_ID=1 UNION ALL SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID=1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT * FROM FRIENDLIST) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
300,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( SELECT DISTINCT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT DISTINCT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID = 1 ) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
301,Y,N,WITH FRIENDS AS (SELECT (CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END) AS USERS FROM FRIENDSHIP) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USERS FROM FRIENDS WHERE USERS IS NOT NULL) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
302,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT CASE WHEN USER2_ID = 1 THEN USER1_ID ELSE USER2_ID END AS USER2_ID_U FROM FRIENDSHIP WHERE USER1_ID = 1 OR USER2_ID = 1) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
303,Y,Y,"SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT DISTINCT T.B FROM (SELECT USER1_ID AS A, USER2_ID AS B FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER2_ID AS A, USER1_ID AS B FROM FRIENDSHIP WHERE USER2_ID = 1) AS T) AS T1 JOIN LIKES AS L ON T1.B = L.USER_ID WHERE L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
304,Y,Y,SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM ( SELECT CASE WHEN USER1_ID=1 THEN USER2_ID WHEN USER2_ID=1 THEN USER1_ID END AS USER_ID FROM FRIENDSHIP ) A JOIN LIKES L ON A.USER_ID =L.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
305,Y,Y,"WITH A AS (SELECT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID=1 UNION SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID=1), B AS (SELECT PAGE_ID FROM LIKES WHERE USER_ID IN (SELECT USER_ID FROM A)), C AS (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1) SELECT DISTINCT B.PAGE_ID AS RECOMMENDED_PAGE FROM B LEFT JOIN C ON B.PAGE_ID=C.PAGE_ID WHERE C.PAGE_ID IS NULL"
306,Y,Y,WITH TMP AS ( SELECT DISTINCT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID = 1 UNION ALL SELECT DISTINCT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT * FROM TMP) AND PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1)
307,Y,Y,WITH FRIENDS AS ( SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID ELSE USER1_ID END USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1 OR USER2_ID = 1 ) SELECT DISTINCT PAGE_ID RECOMMENDED_PAGE FROM LIKES JOIN FRIENDS USING(USER_ID) WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
308,Y,Y,SELECT DISTINCT PAGE_ID RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( SELECT USER2_ID USER_ID FROM FRIENDSHIP WHERE USER1_ID=1 UNION SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID=1) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
309,Y,Y,"WITH CTE AS (SELECT USER1_ID AS U1, USER2_ID AS U2 FROM FRIENDSHIP WHERE USER1_ID = 1 OR USER2_ID=1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM CTE C JOIN LIKES L ON U1 = USER_ID OR U2 = USER_ID WHERE NOT EXISTS ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 AND PAGE_ID = L.PAGE_ID)"
310,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT CASE WHEN USER1_ID= 1 THEN USER2_ID WHEN USER2_ID=1 THEN USER1_ID END ID FROM FRIENDSHIP) A JOIN LIKES L ON A.ID=L.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
311,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER2_ID AS USER FROM FRIENDSHIP WHERE USER1_ID=1 UNION ALL SELECT USER1_ID AS USER FROM FRIENDSHIP WHERE USER2_ID=1) AND PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID=1)
312,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( SELECT CASE WHEN USER1_ID=1 THEN USER2_ID WHEN USER2_ID=1 THEN USER1_ID END AS FRIEND_ID FROM FRIENDSHIP ) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
313,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT CASE WHEN USER1_ID = '1' THEN USER2_ID WHEN USER2_ID = '1' THEN USER1_ID END AS FRIENDS FROM FRIENDSHIP F) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = '1' )
314,Y,Y,"SELECT DISTINCT RECOMMENDED_PAGE FROM (SELECT A.USER1_ID USER_ID, A.USER2_ID FRIEND_ID, B.PAGE_ID RECOMMENDED_PAGE FROM FRIENDSHIP A INNER JOIN LIKES B ON A.USER2_ID=B.USER_ID WHERE A.USER1_ID=1 AND B.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID =1) UNION SELECT A.USER2_ID USER_ID, A.USER1_ID FRIEND_ID, B.PAGE_ID RECOMMENDED_PAGE FROM FRIENDSHIP A INNER JOIN LIKES B ON A.USER1_ID=B.USER_ID WHERE A.USER2_ID=1 AND B.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID =1))X"
315,Y,Y,"SELECT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES JOIN ( SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID = 1 ) AS SPECIFICUSER USING (USER_ID) LEFT JOIN LIKES AS SUBLIKES USING (PAGE_ID) GROUP BY PAGE_ID HAVING SUM(IF(SUBLIKES.USER_ID = 1, TRUE, FALSE)) = FALSE"
316,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L LEFT JOIN FRIENDSHIP F ON (L.USER_ID = F.USER2_ID) OR (L.USER_ID = F.USER1_ID) WHERE (F.USER1_ID = 1 OR F.USER2_ID = 1) AND L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
317,Y,Y,SELECT DISTINCT T2.PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDSHIP T1 JOIN LIKES T2 ON (T1.USER2_ID = T2.USER_ID OR T1.USER1_ID = T2.USER_ID) WHERE T2.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1) AND (T1.USER1_ID = 1 OR T1.USER2_ID = 1)
318,Y,Y,SELECT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE (USER_ID IN (SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1) OR USER_ID IN (SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1)) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1) GROUP BY PAGE_ID
319,Y,N,"WITH USER1_FRIEND AS ( SELECT (CASE WHEN USER1_ID<USER2_ID THEN USER1_ID ELSE USER2_ID END) AS USER1, (CASE WHEN USER1_ID>USER2_ID THEN USER1_ID ELSE USER2_ID END) AS USER2 FROM FRIENDSHIP) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER2 FROM USER1_FRIEND WHERE USER1=1) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
320,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE PAGE_ID IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID IN ( SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1 ) ) AND PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 )
321,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID ELSE 0 END AS ID FROM FRIENDSHIP) AND PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1)
322,Y,Y,"SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT * FROM (SELECT * FROM FRIENDSHIP UNION SELECT USER2_ID, USER1_ID FROM FRIENDSHIP) INF WHERE USER1_ID = 1) F INNER JOIN LIKES L ON F.USER2_ID = L.USER_ID AND L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
323,Y,Y,"WITH 1S_FRNS AS (SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1), FRNS_1 AS (SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1), ALL_FRNS AS ( SELECT DISTINCT USER_ID FROM LIKES L INNER JOIN 1S_FRNS AS 1F ON L.USER_ID = 1F.USER2_ID UNION SELECT DISTINCT USER_ID FROM LIKES L1 INNER JOIN FRNS_1 AS F1 ON L1.USER_ID = F1.USER1_ID) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN(SELECT USER_ID FROM ALL_FRNS) AND PAGE_ID NOT IN(SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)"
324,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END AS CONNECT_ID FROM FRIENDSHIP WHERE USER1_ID = 1 OR USER2_ID = 1 ) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
325,Y,Y,SELECT DISTINCT(PAGE_ID) AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT ( CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END ) AS USER_ID FROM FRIENDSHIP) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
326,Y,Y,SELECT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L INNER JOIN FRIENDSHIP F ON L.USER_ID = F.USER1_ID OR L.USER_ID = F.USER2_ID WHERE F.USER1_ID = 1 OR F.USER2_ID = 1 GROUP BY PAGE_ID HAVING SUM(L.USER_ID = 1) = 0
327,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID=1 UNION ALL SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID=1) AND PAGE_ID NOT IN (SELECT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID=1)
328,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT * FROM LIKES WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)) A WHERE USER_ID IN (SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID=1 UNION ALL SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID=1)
329,Y,Y,WITH F AS ( SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID =1 UNION ALL SELECT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID = 1 ) SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L JOIN F ON F.USER_ID = L.USER_ID AND PAGE_ID NOT IN ( SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1 )
330,Y,Y,"SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM ( SELECT IF(F.USER1_ID=1, F.USER2_ID, F.USER1_ID) AS USER_ID FROM FRIENDSHIP F WHERE F.USER1_ID = 1 OR USER2_ID = 1) T JOIN LIKES L ON T.USER_ID = L.USER_ID WHERE L.PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
331,Y,Y,SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDSHIP F INNER JOIN LIKES L ON F.USER1_ID=1 AND F.USER2_ID=L.USER_ID OR F.USER2_ID=1 AND F.USER1_ID=L.USER_ID WHERE L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
332,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END AS USER_ID FROM FRIENDSHIP) F JOIN LIKES USING (USER_ID) WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
333,Y,Y,WITH FR AS (SELECT USER1_ID AS F FROM FRIENDSHIP WHERE USER2_ID=1 UNION SELECT USER2_ID AS F FROM FRIENDSHIP WHERE USER1_ID=1) SELECT DISTINCT LIKES.PAGE_ID AS RECOMMENDED_PAGE FROM FR JOIN LIKES ON FR.F = LIKES.USER_ID WHERE LIKES.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
334,Y,Y,"SELECT DISTINCT FLIKE.PAGE_ID AS RECOMMENDED_PAGE FROM ( LIKES FLIKE INNER JOIN (SELECT DISTINCT FRIEND FROM ( (SELECT USER1_ID AS USER, USER2_ID AS FRIEND FROM FRIENDSHIP) UNION (SELECT USER2_ID AS USER, USER1_ID AS FRIEND FROM FRIENDSHIP) ) T3 WHERE USER=1) AS FTABLE ON FLIKE.USER_ID=FTABLE.FRIEND LEFT JOIN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID=1) AS ULIKE ON FLIKE.PAGE_ID=ULIKE.PAGE_ID ) WHERE ULIKE.PAGE_ID IS NULL"
335,Y,Y,SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDSHIP AS F INNER JOIN LIKES AS L ON (F.USER1_ID=1 OR F.USER2_ID=1) AND (F.USER1_ID = L.USER_ID OR F.USER2_ID = L.USER_ID) WHERE L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
336,Y,Y,"WITH FRIENDS1 AS ( SELECT USER1_ID AS USER1, USER2_ID AS USER2 FROM FRIENDSHIP UNION SELECT USER2_ID AS USER1, USER1_ID AS USER2 FROM FRIENDSHIP ), FRIENDS2 AS ( SELECT DISTINCT USER1, USER2 FROM FRIENDS1 WHERE USER2 > USER1 ORDER BY USER1, USER2 ) SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES AS L JOIN FRIENDS2 AS F ON L.USER_ID = F.USER2 WHERE F.USER1 = 1 AND L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
337,Y,Y,WITH FRIENDS AS (SELECT CASE WHEN USER1_ID <> 1 THEN USER1_ID WHEN USER2_ID <> 1 THEN USER2_ID END AS FRIEND FROM FRIENDSHIP WHERE USER1_ID = 1 OR USER2_ID = 1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDS JOIN LIKES ON FRIEND = USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
338,Y,Y,"WITH F AS ( SELECT CASE WHEN USER1_ID<USER2_ID THEN USER1_ID ELSE USER2_ID END AS USER1_ID, CASE WHEN USER1_ID<USER2_ID THEN USER2_ID ELSE USER1_ID END AS USER2_ID FROM FRIENDSHIP) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM F JOIN LIKES L ON F.USER2_ID = L.USER_ID WHERE USER1_ID = 1 AND PAGE_ID NOT IN ( SELECT DISTINCT PAGE_ID FROM LIKES L WHERE USER_ID = 1)"
339,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( SELECT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID=1 UNION SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID=1 ) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
340,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END FROM FRIENDSHIP) AND (PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1))
341,Y,Y,"WITH CTE AS ((SELECT USER1_ID, USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1) UNION (SELECT F.USER2_ID, F.USER1_ID FROM FRIENDSHIP F WHERE F.USER2_ID = 1) ) SELECT DISTINCT LIKES.PAGE_ID AS RECOMMENDED_PAGE FROM CTE INNER JOIN LIKES ON CTE.USER2_ID = LIKES.USER_ID WHERE LIKES.PAGE_ID NOT IN (SELECT LIKES.PAGE_ID FROM CTE INNER JOIN LIKES ON CTE.USER1_ID = LIKES.USER_ID)"
342,Y,Y,"WITH USERS AS (SELECT * FROM FRIENDSHIP WHERE USER1_ID=1 UNION SELECT USER2_ID,USER1_ID FROM FRIENDSHIP WHERE USER2_ID=1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER2_ID FROM USERS) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
343,Y,Y,"SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES,FRIENDSHIP WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1) AND ( USER_ID IN (SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID=1) OR USER_ID IN (SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID=1))"
344,Y,Y,"WITH F1 AS( SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1 ), F2 AS( SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 ), UNI AS( SELECT USER1_ID FROM F1 UNION ALL SELECT USER2_ID FROM F2 ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER1_ID FROM UNI) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
345,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDSHIP F INNER JOIN LIKES L ON F.USER2_ID = L.USER_ID WHERE F.USER1_ID = 1 AND L.PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1) UNION SELECT DISTINCT PAGE_ID FROM FRIENDSHIP F INNER JOIN LIKES L ON F.USER1_ID = L.USER_ID WHERE F.USER2_ID = 1 AND L.PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1)
346,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L JOIN FRIENDSHIP F ON L.USER_ID = F.USER1_ID OR L.USER_ID = F.USER2_ID WHERE ( F.USER1_ID =1 OR F.USER2_ID=1) AND PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID=1)
347,Y,Y,SELECT DISTINCT PAGE_ID RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END AS FRIEND_ID FROM FRIENDSHIP ) AND PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 )
348,Y,Y,WITH USER1_FRIENDS AS ( SELECT DISTINCT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT DISTINCT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1) SELECT DISTINCT A.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES A JOIN USER1_FRIENDS B ON A.USER_ID = B.USER_ID WHERE A.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
349,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT CASE WHEN USER1_ID=1 THEN USER2_ID WHEN USER2_ID=1 THEN USER1_ID ELSE '' END FROM FRIENDSHIP WHERE USER1_ID=1 OR USER2_ID=1) AND PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID=1)
350,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END AS USER_ID FROM FRIENDSHIP) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
351,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT USER2_ID AS FRIEND FROM FRIENDSHIP WHERE USER1_ID =1 UNION SELECT USER1_ID AS FRIEND FROM FRIENDSHIP WHERE USER2_ID =1) F JOIN LIKES L ON F.FRIEND=L.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
352,Y,Y,SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES AS L LEFT JOIN FRIENDSHIP AS F ON L.USER_ID = F.USER2_ID OR L.USER_ID = F.USER1_ID WHERE F.USER1_ID = 1 OR F.USER2_ID = 1 HAVING L.PAGE_ID NOT IN (SELECT L2.PAGE_ID FROM LIKES AS L2 WHERE L2.USER_ID = 1)
353,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID =1 UNION SELECT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID =1) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID =1)
354,Y,Y,"SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L JOIN (SELECT USER2_ID, USER1_ID FROM FRIENDSHIP F WHERE (USER1_ID = 1 OR USER2_ID = 1 ) ) P ON L.USER_ID=P.USER2_ID OR L.USER_ID=P.USER1_ID WHERE L.USER_ID<>1 AND L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1) GROUP BY L.USER_ID , L.PAGE_ID ORDER BY L.USER_ID"
355,Y,Y,SELECT DISTINCT(PAGE_ID) AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( (SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1) UNION (SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1) ) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
356,Y,Y,WITH FRIENDS AS (SELECT DISTINCT(USER1_ID) FROM FRIENDSHIP WHERE USER2_ID=1 UNION SELECT DISTINCT(USER2_ID) FROM FRIENDSHIP WHERE USER1_ID=1) SELECT DISTINCT(PAGE_ID) AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT * FROM FRIENDS) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
357,Y,Y,WITH CTE AS ( SELECT USER1_ID USER1 FROM FRIENDSHIP WHERE USER2_ID = 1 UNION SELECT USER2_ID USER1 FROM FRIENDSHIP WHERE USER1_ID =1 ) SELECT DISTINCT PAGE_ID RECOMMENDED_PAGE FROM CTE C JOIN LIKES L ON C.USER1 = L.USER_ID AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID =1)
358,Y,Y,SELECT DISTINCT(PAGE_ID) AS RECOMMENDED_PAGE FROM (SELECT CASE WHEN USER1_ID=1 THEN USER2_ID WHEN USER2_ID=1 THEN USER1_ID END AS USER_ID FROM FRIENDSHIP) A JOIN LIKES USING (USER_ID) HAVING PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
359,Y,Y,"SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L JOIN (SELECT USER1_ID, USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 OR USER2_ID = 1) N ON USER1_ID = USER_ID OR USER2_ID = USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
360,Y,Y,WITH U AS (SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES JOIN U ON LIKES.USER_ID = U.USER_ID WHERE PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1)
361,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1) AND USER_ID IN ( SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID=1 UNION SELECT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID=1 )
362,Y,Y,"WITH CTE AS( SELECT USER1_ID, USER2_ID FROM FRIENDSHIP UNION ALL SELECT USER2_ID, USER1_ID FROM FRIENDSHIP), CTE2 AS( SELECT USER1_ID, USER2_ID FROM CTE WHERE USER1_ID = 1) SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM CTE2 C JOIN LIKES L ON L.USER_ID = C.USER2_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
363,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDSHIP F JOIN LIKES L ON (F.USER2_ID = L.USER_ID AND F.USER1_ID = 1) OR ( F.USER1_ID = L.USER_ID AND F.USER2_ID = 1) WHERE L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID =1)
364,Y,Y,"WITH TABLE1 AS (SELECT * FROM FRIENDSHIP WHERE USER1_ID = 1 OR USER2_ID=1), TABLE2 AS (SELECT USER1_ID FROM TABLE1 UNION SELECT USER2_ID FROM TABLE1), TABLE3 AS (SELECT PAGE_ID FROM LIKES WHERE USER_ID =1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM TABLE2 JOIN LIKES ON TABLE2.USER1_ID = LIKES.USER_ID WHERE USER1_ID !=1 AND PAGE_ID NOT IN (SELECT PAGE_ID FROM TABLE3)"
365,Y,Y,"SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM ( SELECT USER1_ID AS ID1, USER2_ID AS ID2 FROM FRIENDSHIP WHERE USER1_ID=1 UNION SELECT USER2_ID AS ID1, USER1_ID AS ID2 FROM FRIENDSHIP WHERE USER2_ID=1 ) AS T JOIN LIKES AS L ON ID2 = USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID =1)"
366,Y,Y,SELECT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID ELSE '' END FROM FRIENDSHIP WHERE USER1_ID = 1 OR USER2_ID = 1) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1) GROUP BY 1
367,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE (USER_ID IN (SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = '1') OR USER_ID IN (SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = '1')) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = '1')
368,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT USER2_ID AS OU FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS OU FROM FRIENDSHIP WHERE USER2_ID = 1) F JOIN LIKES ON USER_ID = F.OU WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
369,Y,Y,SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L JOIN FRIENDSHIP F ON F.USER1_ID=L.USER_ID OR F.USER2_ID=L.USER_ID WHERE F.USER1_ID=1 OR F.USER2_ID=1 GROUP BY L.PAGE_ID HAVING SUM(L.USER_ID=1)=0
370,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ((SELECT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID=1) UNION ALL (SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID=1)) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1);
371,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END AS FRIENDS FROM FRIENDSHIP WHERE USER1_ID = 1 OR USER2_ID = 1 ) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
372,Y,Y,"WITH A AS(SELECT USER1_ID AS USER_ID, USER2_ID AS FRIEND_ID FROM FRIENDSHIP WHERE USER1_ID=1 UNION ALL SELECT USER2_ID AS USER_ID, USER1_ID AS FRIEND_ID FROM FRIENDSHIP WHERE USER2_ID=1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM A JOIN LIKES AS L ON A.FRIEND_ID=L.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)"
373,Y,Y,"SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( SELECT IF(USER1_ID=1,USER2_ID,USER1_ID) FROM FRIENDSHIP WHERE USER1_ID=1 OR USER2_ID=1 ) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)"
374,Y,Y,"WITH CTE1 AS( SELECT USER1_ID, USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION ALL SELECT USER2_ID, USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L JOIN CTE1 C WHERE L.USER_ID = C.USER2_ID AND PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
375,Y,Y,SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT USER2_ID AS ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS ID FROM FRIENDSHIP WHERE USER2_ID = 1) AS FRIEND_ID INNER JOIN LIKES L ON FRIEND_ID.ID = L.USER_ID LEFT JOIN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1) AS T ON L.PAGE_ID = T.PAGE_ID WHERE T.PAGE_ID IS NULL
376,Y,Y,"SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L JOIN ( SELECT USER1_ID AS USERS , USER2_ID AS FRIEND FROM FRIENDSHIP WHERE USER1_ID =1 UNION SELECT USER2_ID AS USERS , USER1_ID AS FRIEND FROM FRIENDSHIP WHERE USER2_ID =1 ) F ON L.USER_ID =F.FRIEND WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)"
377,Y,Y,"WITH CTE AS ( SELECT IF(USER1_ID = 1, USER2_ID, USER1_ID) ID FROM FRIENDSHIP WHERE USER1_ID = 1 OR USER2_ID = 1 ) SELECT DISTINCT PAGE_ID RECOMMENDED_PAGE FROM LIKES A WHERE USER_ID IN ( SELECT IFNULL(ID, -1) FROM CTE ) AND NOT EXISTS (SELECT 1 FROM LIKES WHERE USER_ID = 1 AND PAGE_ID = A.PAGE_ID)"
378,Y,Y,"SELECT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES JOIN ( SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID = 1 ) AS SPECIFICUSER USING (USER_ID) JOIN LIKES AS SUBLIKES USING (PAGE_ID) GROUP BY PAGE_ID HAVING SUM(IF(SUBLIKES.USER_ID = 1, TRUE, FALSE)) = FALSE"
379,Y,N,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID =1) AND USER_ID IN ( SELECT FRIENDS FROM ( SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END AS FRIENDS FROM FRIENDSHIP ) A WHERE FRIENDS IS NOT NULL)
380,Y,Y,WITH CTE1 AS ( SELECT DISTINCT USER_FRIEND FROM ( SELECT USER2_ID AS USER_FRIEND FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS USER_FRIEND FROM FRIENDSHIP WHERE USER2_ID = 1) AS TIN) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT * FROM CTE1) HAVING PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
381,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( SELECT DISTINCT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END AS FRI FROM FRIENDSHIP) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
382,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( SELECT DISTINCT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT DISTINCT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1 ) AND PAGE_ID NOT IN ( SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1 )
383,Y,Y,WITH FRIENDS_OF_USER AS ( SELECT USER1_ID AS FRIEND FROM FRIENDSHIP WHERE USER2_ID = 1 UNION ALL SELECT USER2_ID AS FRIEND FROM FRIENDSHIP WHERE USER1_ID = 1 ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES A JOIN FRIENDS_OF_USER B ON A.USER_ID = B.FRIEND WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
384,Y,Y,SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES AS L WHERE ( USER_ID IN (SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1) OR USER_ID IN (SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1) ) AND L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
385,Y,Y,SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END AS FRIENDS_ID FROM FRIENDSHIP) F JOIN LIKES L ON F.FRIENDS_ID = L.USER_ID WHERE L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
386,Y,Y,WITH CTE_FRIENDS AS ( SELECT USER2_ID AS FRIEND_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS FRIEND_ID FROM FRIENDSHIP WHERE USER2_ID = 1 ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( SELECT FRIEND_ID FROM CTE_FRIENDS ) AND PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 )
387,Y,Y,"WITH CTE AS (SELECT USER1_ID AS USER_ID , USER2_ID AS FRIENDS FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER2_ID AS USER_ID , USER1_ID AS FRIENDS FROM FRIENDSHIP WHERE USER2_ID = 1) SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM CTE C INNER JOIN LIKES L ON C.FRIENDS = L.USER_ID WHERE L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
388,Y,Y,"WITH FRIENDS_OF AS (SELECT CASE WHEN USER1_ID = '1' THEN USER2_ID WHEN USER2_ID = '1' THEN USER1_ID END AS FRIENDS_OF FROM FRIENDSHIP WHERE '1' IN (USER1_ID, USER2_ID)) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L JOIN FRIENDS_OF AS F ON L.USER_ID = F.FRIENDS_OF WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = '1')"
389,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT (CASE WHEN USER1_ID=1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END) AS OU FROM FRIENDSHIP) F JOIN LIKES ON USER_ID = F.OU WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
390,Y,Y,SELECT L.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L LEFT JOIN FRIENDSHIP F1 ON L.USER_ID = F1.USER1_ID LEFT JOIN FRIENDSHIP F2 ON L.USER_ID = F2.USER2_ID WHERE (F1.USER1_ID = 1 OR F1.USER2_ID = 1) OR (F2.USER1_ID = 1 OR F2.USER2_ID = 1) GROUP BY L.PAGE_ID HAVING SUM(L.USER_ID = 1) = 0
391,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ((SELECT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID=1) UNION (SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID=1)) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1);
392,Y,Y,WITH CTE AS ( SELECT USER2_ID AS USER_NEW FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS USER_NEW FROM FRIENDSHIP WHERE USER2_ID = 1 ) SELECT DISTINCT(PAGE_ID) AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER_NEW FROM CTE) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
393,Y,Y,"SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER2_ID FROM (SELECT USER1_ID, USER2_ID FROM FRIENDSHIP UNION SELECT USER2_ID, USER1_ID FROM FRIENDSHIP ) AS T1 WHERE USER1_ID = 1) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
394,Y,Y,"SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( SELECT IF(USER2_ID=1, USER1_ID, USER2_ID) AS FRIENDS FROM FRIENDSHIP WHERE USER1_ID=1 OR USER2_ID=1) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)"
395,Y,Y,"WITH F AS ( SELECT DISTINCT USER1 USER_ID, USER2 FROM ( SELECT USER1_ID USER1, USER2_ID USER2 FROM FRIENDSHIP UNION SELECT USER2_ID USER1, USER1_ID USER2 FROM FRIENDSHIP ) TMP WHERE USER2 = 1 ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM F INNER JOIN LIKES L USING(USER_ID) WHERE NOT EXISTS ( SELECT * FROM LIKES WHERE USER_ID = 1 AND PAGE_ID = L.PAGE_ID )"
396,Y,Y,"SELECT DISTINCT(B.PAGE_ID) RECOMMENDED_PAGE FROM (SELECT IF(USER1_ID = 1, USER2_ID, USER1_ID) FRIEND_ID FROM FRIENDSHIP WHERE USER1_ID = 1 OR USER2_ID = 1) A INNER JOIN LIKES B ON A.FRIEND_ID = B.USER_ID WHERE B.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
397,Y,Y,WITH FRI AS ( SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID =1 UNION ALL SELECT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID =1 ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM FRI F JOIN LIKES L ON F.USER_ID=L.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
398,Y,Y,"SELECT PAGE_ID RECOMMENDED_PAGE FROM (SELECT * FROM FRIENDSHIP F1 UNION ALL SELECT USER2_ID, USER1_ID FROM FRIENDSHIP F2) F INNER JOIN LIKES L ON F.USER2_ID = L.USER_ID WHERE L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 GROUP BY 1) AND F.USER1_ID = 1 GROUP BY 1"
399,Y,Y,SELECT DISTINCT PAGE_ID RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER1_ID AS FRIEND_ID FROM FRIENDSHIP WHERE USER2_ID = 1 UNION SELECT USER2_ID AS FRIEND_ID FROM FRIENDSHIP WHERE USER1_ID = 1) AND PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 )
400,Y,Y,WITH CTE AS ( SELECT USER2_ID AS FRIENDS FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS FRIENDS FROM FRIENDSHIP WHERE USER2_ID = 1 ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L INNER JOIN CTE C ON C.FRIENDS = L.USER_ID WHERE PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 )
401,Y,Y,WITH T AS ( SELECT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID = 1 UNION SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1 ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( SELECT USER_ID FROM T) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 )
402,Y,Y,SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDSHIP FRIENDS JOIN LIKES L ON (FRIENDS.USER2_ID = L.USER_ID AND FRIENDS.USER1_ID = 1) OR (FRIENDS.USER1_ID = L.USER_ID AND FRIENDS.USER2_ID = 1) WHERE L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
403,Y,Y,WITH CTE1 AS ( SELECT USER2_ID AS FRIEND_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS FRIEND_ID FROM FRIENDSHIP WHERE USER2_ID = 1) SELECT DISTINCT PAGE_ID RECOMMENDED_PAGE FROM LIKES L WHERE USER_ID IN (SELECT FRIEND_ID FROM CTE1) AND NOT EXISTS (SELECT 1 FROM LIKES WHERE USER_ID = 1 AND PAGE_ID = L.PAGE_ID)
404,Y,Y,WITH FRIENDS AS ( SELECT USER1_ID AS FRIEND FROM FRIENDSHIP WHERE USER2_ID = 1 UNION ALL SELECT USER2_ID AS FRIEND FROM FRIENDSHIP WHERE USER1_ID = 1 ) SELECT DISTINCT PAGE_ID RECOMMENDED_PAGE FROM FRIENDS A INNER JOIN LIKES B ON A.FRIEND = B.USER_ID AND PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1)
405,Y,Y,WITH A AS ( SELECT PAGE_ID FROM LIKES WHERE USER_ID IN ( SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID=1) ) SELECT DISTINCT PAGE_ID RECOMMENDED_PAGE FROM A WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
406,Y,Y,SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDSHIP AS F INNER JOIN LIKES AS L ON F.USER1_ID=1 AND F.USER2_ID = L.USER_ID OR F.USER2_ID=1 AND F.USER1_ID = L.USER_ID WHERE L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
407,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT PAGE_ID FROM LIKES WHERE USER_ID IN (SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1) ) AS T1 WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 )
408,Y,Y,"SELECT PAGE_ID RECOMMENDED_PAGE FROM (SELECT * FROM FRIENDSHIP F1 UNION ALL SELECT USER2_ID, USER1_ID FROM FRIENDSHIP F2) F INNER JOIN LIKES L ON F.USER2_ID = L.USER_ID AND F.USER1_ID = 1 WHERE L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 GROUP BY 1) GROUP BY 1"
409,Y,Y,SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM ((SELECT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID=1) UNION (SELECT USER2_ID AS UER_ID FROM FRIENDSHIP WHERE USER1_ID=1)) T JOIN LIKES L ON T.USER_ID = L.USER_ID WHERE L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID =1)
410,Y,Y,"WITH TEMP AS( SELECT F.USER2_ID,L.PAGE_ID FROM LIKES L LEFT JOIN FRIENDSHIP F ON F.USER2_ID = L.USER_ID WHERE USER1_ID = 1 AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1) UNION ALL SELECT F.USER1_ID,L.PAGE_ID FROM LIKES L LEFT JOIN FRIENDSHIP F ON F.USER1_ID = L.USER_ID WHERE USER2_ID = 1 AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM TEMP"
411,Y,Y,"WITH FRIENDS_OF AS (SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END AS FRIENDS_OF FROM FRIENDSHIP WHERE 1 IN (USER1_ID, USER2_ID)) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L JOIN FRIENDS_OF AS F ON L.USER_ID = F.FRIENDS_OF WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
412,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDSHIP JOIN LIKES ON (LIKES.USER_ID = USER1_ID AND USER2_ID = 1) OR (LIKES.USER_ID = USER2_ID AND USER1_ID = 1) WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
413,Y,Y,"SELECT B.PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDSHIP A, LIKES B WHERE ((A.USER1_ID=1 AND B.USER_ID=A.USER2_ID) OR (A.USER2_ID=1 AND B.USER_ID=A.USER1_ID)) AND B.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1) GROUP BY B.PAGE_ID"
414,Y,Y,"WITH FRIEND_LIKES AS (SELECT DISTINCT USER1_ID, USER_ID, PAGE_ID FROM LIKES JOIN FRIENDSHIP ON FRIENDSHIP.USER1_ID = LIKES.USER_ID OR FRIENDSHIP.USER2_ID = LIKES.USER_ID WHERE FRIENDSHIP.USER1_ID = 1 OR FRIENDSHIP.USER2_ID = 1 ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM FRIEND_LIKES WHERE FRIEND_LIKES.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
415,Y,Y,"SELECT DISTINCT X.PAGE_ID AS RECOMMENDED_PAGE FROM ( SELECT F.USER1_ID ,F.USER2_ID, L.PAGE_ID FROM FRIENDSHIP F INNER JOIN LIKES L ON L.USER_ID = (CASE WHEN F.USER1_ID = 1 THEN F.USER2_ID WHEN F.USER2_ID = 1 THEN F.USER1_ID END) WHERE F.USER1_ID = 1 OR F.USER2_ID = 1 ORDER BY 2) X WHERE X.PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1) ORDER BY 1"
416,Y,Y,SELECT DISTINCT(L.PAGE_ID) AS RECOMMENDED_PAGE FROM FRIENDSHIP AS F JOIN LIKES AS L ON L.USER_ID = F.USER2_ID OR L.USER_ID = F.USER1_ID WHERE F.USER1_ID = 1 OR F.USER2_ID = 1 GROUP BY L.PAGE_ID HAVING SUM(L.USER_ID=1) = 0
417,Y,Y,SELECT DISTINCT PAGE_ID RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER1_ID USER_ID FROM FRIENDSHIP WHERE USER2_ID = 1 UNION SELECT USER2_ID USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1) AND PAGE_ID NOT IN( SELECT PAGE_ID RECOMMENDED_PAGE FROM LIKES WHERE USER_ID = 1)
418,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END AS USER_ID FROM FRIENDSHIP) T JOIN LIKES L ON L.USER_ID = T.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
419,Y,Y,SELECT DISTINCT PAGE_ID RECOMMENDED_PAGE FROM LIKES WHERE PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 ) AND USER_ID IN ( SELECT USER1_ID USER_ID FROM FRIENDSHIP WHERE USER2_ID = 1 UNION SELECT USER2_ID USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1 )
420,Y,Y,SELECT L1.PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDSHIP F JOIN LIKES L1 ON F.USER2_ID = L1.USER_ID OR F.USER1_ID = L1.USER_ID WHERE (F.USER1_ID = 1 OR F.USER2_ID =1) AND L1.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1) GROUP BY 1
421,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L JOIN FRIENDSHIP F ON ((L.USER_ID=F.USER2_ID AND F.USER1_ID=1) OR (L.USER_ID=F.USER1_ID AND F.USER2_ID=1)) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
422,Y,Y,SELECT DISTINCT (LIKES.PAGE_ID) AS RECOMMENDED_PAGE FROM FRIENDSHIP F JOIN LIKES ON F.USER2_ID=LIKES.USER_ID WHERE F.USER1_ID=1 AND LIKES.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1) UNION SELECT DISTINCT (LIKES.PAGE_ID) AS RECOMMENDED_PAGE FROM FRIENDSHIP F JOIN LIKES ON F.USER1_ID=LIKES.USER_ID WHERE F.USER2_ID=1 AND LIKES.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
423,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT CASE WHEN USER1_ID=1 THEN USER2_ID WHEN USER2_ID=1 THEN USER1_ID END AS USER_ID FROM FRIENDSHIP ) A JOIN LIKES B ON A.USER_ID = B.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
424,Y,Y,"SELECT DISTINCT(PAGE_ID) AS RECOMMENDED_PAGE FROM LIKES L JOIN ( SELECT GREATEST(USER1_ID,USER2_ID) AS USR FROM FRIENDSHIP WHERE LEAST(USER1_ID,USER2_ID) = 1 ) B ON L.USER_ID=B.USR AND PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
425,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L WHERE USER_ID IN (SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1 UNION SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1) AND NOT EXISTS (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1 AND PAGE_ID = L.PAGE_ID)
426,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L WHERE EXISTS( SELECT 1 FROM FRIENDSHIP WHERE L.USER_ID = USER1_ID AND USER2_ID = 1 OR L.USER_ID = USER2_ID AND USER1_ID = 1) AND NOT EXISTS( SELECT 1 FROM LIKES WHERE L.PAGE_ID = PAGE_ID AND USER_ID = 1)
427,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT PAGE_ID FROM LIKES WHERE USER_ID IN ( SELECT USER2_ID AS FRIEND_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS FRIEND_ID FROM FRIENDSHIP WHERE USER2_ID = 1)) A WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
428,Y,Y,"WITH CTE AS ( SELECT USER1_ID, USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER2_ID AS USER1_ID, USER1_ID AS USER2_ID FROM FRIENDSHIP WHERE USER2_ID = 1 ), CTE2 AS ( SELECT C.USER1_ID, C.USER2_ID, L.USER_ID, PAGE_ID FROM LIKES AS L INNER JOIN CTE AS C ON L.USER_ID = C.USER2_ID AND L.USER_ID != C.USER1_ID ORDER BY USER_ID ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM CTE2 WHERE PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 )"
429,Y,Y,"SELECT DISTINCT PAGE_ID RECOMMENDED_PAGE FROM LIKES L JOIN (SELECT USER1_ID AS USER, USER2_ID AS FRIEND FROM FRIENDSHIP UNION ALL SELECT USER2_ID AS USER, USER1_ID AS FRIEND FROM FRIENDSHIP) F ON F.FRIEND = L.USER_ID WHERE F.USER= 1 AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID =1)"
430,Y,Y,WITH T AS( SELECT DISTINCT USER2_ID AS F FROM FRIENDSHIP WHERE USER1_ID=1 UNION ALL SELECT DISTINCT USER1_ID AS F FROM FRIENDSHIP WHERE USER2_ID=1 ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES JOIN T ON T.F=LIKES.USER_ID WHERE PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID=1)
431,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES A WHERE USER_ID IN ( SELECT USER1_ID FROM FRIENDSHIP A WHERE USER2_ID = 1 UNION SELECT USER2_ID FROM FRIENDSHIP B WHERE USER1_ID = 1 ) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
432,Y,Y,WITH FRIENDS AS ( SELECT USER2_ID AS ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS ID FROM FRIENDSHIP WHERE USER2_ID = 1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDS F JOIN LIKES L ON F.ID = L.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
433,Y,Y,"SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDSHIP F, LIKES L WHERE USER2_ID = USER_ID AND USER1_ID = '1' AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = '1') UNION SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDSHIP F, LIKES L WHERE USER1_ID = USER_ID AND USER2_ID = '1' AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = '1')"
434,Y,Y,WITH USER_1_FRIENDS AS (SELECT USER1_ID AS USER_1_FR FROM FRIENDSHIP WHERE USER2_ID=1 UNION SELECT USER2_ID AS USER_1_FR FROM FRIENDSHIP WHERE USER1_ID=1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L JOIN USER_1_FRIENDS F ON L.USER_ID=F.USER_1_FR WHERE L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
435,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT (CASE WHEN USER1_ID=1 THEN USER2_ID WHEN USER2_ID=1 THEN USER1_ID ELSE 0 END) AS USER_ID FROM FRIENDSHIP) A JOIN LIKES L ON A.USER_ID=L.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
436,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDSHIP RIGHT JOIN LIKES ON USER_ID = USER1_ID OR USER_ID = USER2_ID WHERE (USER2_ID = 1 OR USER1_ID = 1) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
437,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( SELECT USER1_ID AS FRIEND_ID FROM FRIENDSHIP WHERE USER2_ID=1 UNION SELECT USER2_ID AS FRIEND_ID FROM FRIENDSHIP WHERE USER1_ID = 1 ) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
438,Y,Y,SELECT PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT PAGE_ID FROM FRIENDSHIP A JOIN LIKES B ON A.USER2_ID = B.USER_ID AND A.USER1_ID = 1 UNION SELECT PAGE_ID FROM FRIENDSHIP A JOIN LIKES B ON A.USER1_ID = B.USER_ID AND A.USER2_ID = 1 ) C WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
439,Y,Y,WITH USERS AS ( SELECT DISTINCT USERS FROM ((SELECT USER2_ID USERS FROM FRIENDSHIP WHERE USER1_ID='1') UNION (SELECT USER1_ID USERS FROM FRIENDSHIP WHERE USER2_ID='1') UNION SELECT 1 FROM FRIENDSHIP)T1) SELECT DISTINCT PAGE_ID RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USERS FROM USERS) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
440,Y,Y,SELECT DISTINCT(PAGE_ID) AS RECOMMENDED_PAGE FROM LIKES AS L JOIN ( (SELECT USER2_ID AS ID FROM FRIENDSHIP WHERE USER1_ID = 1) UNION ALL (SELECT USER1_ID AS ID FROM FRIENDSHIP WHERE USER2_ID = 1) ) AS F ON F.ID = L.USER_ID WHERE PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 )
441,Y,Y,"WITH FRIENDSHIP_TABLE AS ( SELECT CASE WHEN USER1_ID < USER2_ID THEN USER1_ID ELSE USER2_ID END AS USER1_ID, CASE WHEN USER1_ID > USER2_ID THEN USER1_ID ELSE USER2_ID END AS USER2_ID FROM FRIENDSHIP ) SELECT DISTINCT T2.PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDSHIP_TABLE T1 JOIN LIKES T2 ON T1.USER2_ID = T2.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1) AND T1.USER1_ID = 1"
442,Y,Y,WITH CTE1 AS (SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID=1 UNION SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID=1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE PAGE_ID IN (SELECT L.PAGE_ID FROM CTE1 LEFT JOIN LIKES L ON CTE1.USER_ID=L.USER_ID) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
443,Y,Y,"WITH CTE AS ( SELECT USER_ID, PAGE_ID FROM LIKES WHERE USER_ID IN (SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1) OR USER_ID IN (SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1) ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM CTE WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 )"
444,Y,Y,WITH A AS(SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID=1 UNION SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID=1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L JOIN A ON A.USER2_ID=L.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
445,Y,Y,"SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( SELECT ID2 FROM ( SELECT USER1_ID AS ID1,USER2_ID AS ID2 FROM FRIENDSHIP UNION ALL SELECT USER2_ID,USER1_ID FROM FRIENDSHIP) T WHERE ID1=1) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)"
446,Y,Y,SELECT DISTINCT T2.PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDSHIP T1 JOIN LIKES T2 ON T1.USER1_ID = T2.USER_ID OR T1.USER2_ID = T2.USER_ID WHERE T2.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1) AND (T1.USER1_ID = 1 OR T1.USER2_ID = 1)
447,Y,Y,SELECT DISTINCT PAGE_ID RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( SELECT USER1_ID USERS FROM FRIENDSHIP WHERE USER2_ID = 1 UNION SELECT USER2_ID USERS FROM FRIENDSHIP WHERE USER1_ID = 1 ) AND PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1)
448,Y,Y,"WITH A AS (SELECT USER1_ID AS USER, USER2_ID AS FRIEND FROM FRIENDSHIP UNION ALL SELECT USER2_ID, USER1_ID FROM FRIENDSHIP), B AS (SELECT DISTINCT FRIEND FROM A WHERE USER = 1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L JOIN B ON L.USER_ID = B.FRIEND WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
449,Y,Y,SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L INNER JOIN FRIENDSHIP F ON (L.USER_ID = F.USER1_ID AND F.USER2_ID =1) OR (L.USER_ID = F.USER2_ID AND F.USER1_ID =1) WHERE L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
450,Y,Y,"WITH ALL_FRIENDS AS (SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID=1 UNION SELECT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID=1), NOT_LIKED AS ( SELECT USER_ID, PAGE_ID FROM LIKES WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)) SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM ALL_FRIENDS F JOIN NOT_LIKED L ON F.USER_ID=L.USER_ID"
451,Y,Y,SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L JOIN FRIENDSHIP F ON (L.USER_ID = USER1_ID AND USER2_ID = 1) OR (L.USER_ID = USER2_ID AND USER1_ID = 1) LEFT JOIN LIKES L2 ON L2.USER_ID = 1 AND L2.PAGE_ID = L.PAGE_ID WHERE L2.PAGE_ID IS NULL
452,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L JOIN FRIENDSHIP F ON L.USER_ID = F.USER2_ID OR L.USER_ID = F.USER1_ID WHERE (F.USER1_ID = 1 OR F.USER2_ID = 1) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
453,Y,Y,WITH FRIENDS AS ( SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID = 1 ) SELECT DISTINCT(PAGE_ID) AS RECOMMENDED_PAGE FROM LIKES JOIN FRIENDS USING(USER_ID) WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
454,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID = 1) UIDS JOIN LIKES L ON UIDS.USER_ID = L.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1 GROUP BY 1)
455,Y,Y,"SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE PAGE_ID IN (SELECT PAGE_ID FROM LIKES L, FRIENDSHIP F WHERE USER_ID = USER1_ID AND USER2_ID = 1 UNION SELECT PAGE_ID FROM LIKES L, FRIENDSHIP F WHERE USER_ID = USER2_ID AND USER1_ID = 1) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
456,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( SELECT USER1_ID AS FRIEND_ID FROM FRIENDSHIP WHERE USER2_ID = 1 UNION SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 ) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
457,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT CASE WHEN USER1_ID =1 THEN USER2_ID WHEN USER2_ID =1 THEN USER1_ID END AS USER_ID FROM FRIENDSHIP ) AS TB1 JOIN LIKES L ON TB1.USER_ID = L.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID =1)
458,Y,Y,"SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT USER1_ID, USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION ALL SELECT USER2_ID AS USER1_ID, USER1_ID AS USER2_ID FROM FRIENDSHIP WHERE USER2_ID = 1)F JOIN LIKES L ON F.USER2_ID = L.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
459,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L WHERE USER_ID IN ((SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1) UNION (SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1)) AND NOT EXISTS (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 AND PAGE_ID = L.PAGE_ID)
460,Y,Y,"WITH FRIENDS AS ( SELECT USER1_ID, USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER2_ID, USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1 ) , SELF_LIKE AS ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 ) , FRIENDS_LIKE AS ( SELECT DISTINCT PAGE_ID FROM LIKES JOIN FRIENDS ON LIKES.USER_ID =FRIENDS.USER2_ID) SELECT F.PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDS_LIKE AS F LEFT JOIN SELF_LIKE AS S ON S.PAGE_ID = F.PAGE_ID WHERE S.PAGE_ID IS NULL"
461,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDSHIP AS F INNER JOIN LIKES AS L ON F.USER1_ID = L.USER_ID OR F.USER2_ID = L.USER_ID WHERE (USER1_ID = 1 OR USER2_ID = 1) AND L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
462,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER1_ID AS FRIEND FROM FRIENDSHIP WHERE USER2_ID=1 UNION ALL SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID=1) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
463,Y,Y,"WITH CTE AS (SELECT USER1_ID AS USER, USER2_ID AS FRIEND FROM FRIENDSHIP WHERE USER1_ID='1' UNION SELECT USER2_ID AS USER, USER1_ID AS FRIEND FROM FRIENDSHIP WHERE USER2_ID='1') SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L, CTE E WHERE L.USER_ID=E.FRIEND AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID='1')"
464,Y,Y,SELECT DISTINCT PAGE_ID RECOMMENDED_PAGE FROM LIKES WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1) AND USER_ID IN (SELECT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID =1 UNION SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID =1) ORDER BY 1
465,Y,Y,"WITH TABLE1 AS (SELECT DISTINCT USER2_ID AS FND FROM (SELECT USER1_ID, USER2_ID FROM FRIENDSHIP UNION SELECT USER2_ID, USER1_ID FROM FRIENDSHIP) U WHERE USER1_ID = 1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM TABLE1 T JOIN LIKES L ON T.FND = L.USER_ID WHERE PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
466,Y,Y,WITH FRIEND AS( SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID=1 UNION SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID=1 ) SELECT DISTINCT PAGE_ID RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT*FROM FRIEND) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
467,Y,Y,SELECT DISTINCT PAGE_ID RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID ELSE NULL END FRIEND_IDS FROM FRIENDSHIP) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
468,Y,Y,"WITH WLS AS( SELECT DISTINCT ID FROM (SELECT USER2_ID AS ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1) T ) , WLS2 AS( SELECT DISTINCT PAGE_ID FROM LIKES JOIN WLS ON WLS.ID = LIKES.USER_ID ) SELECT PAGE_ID AS RECOMMENDED_PAGE FROM WLS2 WHERE PAGE_ID NOT IN (SELECT DISTINCT LIKES.PAGE_ID FROM LIKES WHERE USER_ID = 1)"
469,Y,Y,SELECT DISTINCT B.PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1 ) A JOIN LIKES B ON A.USER2_ID = USER_ID WHERE B.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 )
470,Y,Y,SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID = 1) SUB JOIN LIKES L ON SUB.USER_ID = L.USER_ID WHERE L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
471,Y,Y,"WITH PAGES_I_LIKED AS ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 ), MY_FRIENDS AS ( SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID ELSE USER1_ID END AS USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1 OR USER2_ID = 1 ) SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES AS L JOIN MY_FRIENDS AS MF ON MF.USER_ID = L.USER_ID WHERE L.PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 )"
472,Y,Y,"SELECT DISTINCT B.PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1) A RIGHT JOIN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID IN (SELECT GREATEST(USER1_ID, USER2_ID) FROM FRIENDSHIP WHERE USER1_ID = 1 OR USER2_ID = 1)) B ON A.PAGE_ID = B.PAGE_ID WHERE A.PAGE_ID IS NULL"
473,Y,Y,"WITH TEMPA AS ( SELECT USER1_ID AS U1, USER2_ID AS U2 FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER2_ID AS U1, USER1_ID AS U2 FROM FRIENDSHIP WHERE USER2_ID = 1 ), U1LIKES AS ( SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1 ), OTHERLIKES AS ( SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID IN (SELECT U2 FROM TEMPA) ) SELECT PAGE_ID AS RECOMMENDED_PAGE FROM OTHERLIKES WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM U1LIKES)"
474,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID=1) AND ( USER_ID IN (SELECT DISTINCT USER1_ID FROM FRIENDSHIP WHERE USER1_ID=1 OR USER2_ID=1 ) OR USER_ID IN (SELECT DISTINCT USER2_ID FROM FRIENDSHIP WHERE USER1_ID=1 OR USER2_ID=1 ) )
475,Y,Y,WITH FRIEND AS ((SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID=1) UNION (SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID=1)) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT * FROM FRIEND) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
476,Y,Y,"SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( SELECT USER2_ID AS FRIEND_ID FROM ( SELECT USER1_ID, USER2_ID FROM FRIENDSHIP UNION ALL SELECT USER2_ID AS USER1_ID, USER1_ID AS USER2_ID FROM FRIENDSHIP) A WHERE USER1_ID = 1) AND PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 )"
477,Y,Y,WITH TEMP AS ( SELECT USER2_ID AS ID FROM FRIENDSHIP WHERE USER1_ID='1' UNION SELECT USER1_ID AS ID FROM FRIENDSHIP WHERE USER2_ID='1' ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT * FROM TEMP) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID='1')
478,Y,Y,"SELECT DISTINCT L.PAGE_ID RECOMMENDED_PAGE FROM( SELECT USER1_ID FIRSTFRIEND, USER2_ID SECONDFRIEND FROM FRIENDSHIP WHERE USER1_ID = '1' UNION SELECT USER2_ID FIRSTFRIEND, USER1_ID SECONDFRIEND FROM FRIENDSHIP WHERE USER2_ID = '1' ) FRIEND INNER JOIN LIKES L ON FRIEND.SECONDFRIEND = L.USER_ID WHERE L.PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = '1')"
479,Y,Y,WITH FRIENDS AS ( SELECT USER2_ID AS FRIEND FROM FRIENDSHIP WHERE USER1_ID = 1 UNION ALL SELECT USER1_ID AS FRIEND FROM FRIENDSHIP WHERE USER2_ID = 1 ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDS INNER JOIN LIKES ON FRIEND = USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
480,Y,Y,"WITH T AS ( SELECT PAGE_ID FROM LIKES WHERE USER_ID IN ( SELECT USER1_ID AS USER_ID FROM ( SELECT USER1_ID , USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER2_ID AS USER1_ID , USER1_ID AS USER2_ID FROM FRIENDSHIP WHERE USER2_ID = 1 ) A ) UNION SELECT PAGE_ID FROM LIKES WHERE USER_ID IN ( SELECT USER2_ID AS USER_ID FROM ( SELECT USER1_ID , USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER2_ID AS USER1_ID , USER1_ID AS USER2_ID FROM FRIENDSHIP WHERE USER2_ID = 1 ) A ) ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM T WHERE CASE WHEN PAGE_ID IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1) THEN 0 ELSE 1 END"
481,Y,Y,WITH CTE AS(SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID=1 UNION SELECT USER1_ID AS USER2_ID FROM FRIENDSHIP WHERE USER2_ID=1) SELECT DISTINCT LIKES.PAGE_ID AS RECOMMENDED_PAGE FROM CTE JOIN LIKES ON USER_ID=USER2_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
482,Y,Y,WITH F AS (SELECT (CASE WHEN USER1_ID=1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END) AS USER_ID FROM FRIENDSHIP) SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM F INNER JOIN LIKES AS L ON L.USER_ID = F.USER_ID WHERE L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID =1)
483,Y,Y,SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT CASE WHEN USER1_ID=1 THEN USER2_ID WHEN USER2_ID=1 THEN USER1_ID END AS FRIEND_ID FROM FRIENDSHIP) ALL_FRIENDS JOIN LIKES L ON ALL_FRIENDS.FRIEND_ID=L.USER_ID WHERE L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
484,Y,Y,"WITH T1 AS ( SELECT F.USER2_ID AS ID FROM FRIENDSHIP F WHERE F.USER1_ID = 1 UNION SELECT F.USER1_ID AS ID FROM FRIENDSHIP F WHERE F.USER2_ID = 1 ), T2 AS (SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L JOIN T1 ON L.USER_ID = T1.ID ) SELECT T2.RECOMMENDED_PAGE FROM T2 WHERE T2.RECOMMENDED_PAGE NOT IN (SELECT L.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L WHERE L.USER_ID = 1)"
485,Y,Y,"SELECT DISTINCT(PAGE_ID) AS RECOMMENDED_PAGE FROM (SELECT L.USER_ID, L.PAGE_ID, T1.FRIENDS FROM LIKES L LEFT JOIN (SELECT USER1_ID, USER2_ID, CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END AS FRIENDS FROM FRIENDSHIP) T1 ON L.USER_ID = T1.USER1_ID OR L.USER_ID = T1.USER2_ID WHERE T1.FRIENDS IS NOT NULL) N GROUP BY N.PAGE_ID HAVING SUM(N.USER_ID=1) = 0"
486,Y,Y,"WITH FRIENDS AS ( SELECT USER1_ID,USER2_ID FROM FRIENDSHIP UNION ALL SELECT USER2_ID, USER1_ID FROM FRIENDSHIP ) , CTE AS ( SELECT A.USER2_ID, B.PAGE_ID FROM FRIENDS A JOIN LIKES B ON A.USER2_ID=B.USER_ID AND A.USER1_ID=1 ) SELECT PAGE_ID AS RECOMMENDED_PAGE FROM CTE WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1) GROUP BY 1"
487,Y,Y,SELECT DISTINCT B.PAGE_ID AS RECOMMENDED_PAGE FROM ( SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END AS USER_ID FROM FRIENDSHIP ) AS A INNER JOIN LIKES AS B ON A.USER_ID = B.USER_ID WHERE PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 )
488,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( SELECT CASE WHEN USER1_ID=1 THEN USER2_ID ELSE USER1_ID END AS F1 FROM FRIENDSHIP WHERE USER1_ID = '1' OR USER2_ID='1' ) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID ='1')
489,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES AS L JOIN ( SELECT DISTINCT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT DISTINCT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID = 1 ) AS F ON L.USER_ID = F.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
490,Y,Y,SELECT DISTINCT PAGE_ID RECOMMENDED_PAGE FROM (SELECT USER2_ID USER_ID FROM FRIENDSHIP WHERE USER1_ID =1 UNION SELECT USER1_ID USER_ID FROM FRIENDSHIP WHERE USER2_ID = 1) M LEFT JOIN LIKES L ON M.USER_ID = L.USER_ID WHERE PAGE_ID IS NOT NULL AND PAGE_ID NOT IN(SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
491,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID=1 UNION ALL SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID=1) AND PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID=1)
492,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( SELECT USER2_ID AS FRIENDS FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS FRIENDS FROM FRIENDSHIP WHERE USER2_ID = 1) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
493,Y,Y,WITH CTE AS ( SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1 ) SELECT DISTINCT L.PAGE_ID RECOMMENDED_PAGE FROM LIKES L JOIN CTE F ON L.USER_ID = F.USER2_ID WHERE NOT EXISTS ( SELECT 1 FROM LIKES L2 WHERE L2.PAGE_ID = L.PAGE_ID AND L2.USER_ID = 1 )
494,Y,Y,"WITH FRIENDS AS ( SELECT USER1_ID AS ID FROM FRIENDSHIP WHERE USER2_ID = 1 UNION SELECT USER2_ID AS ID FROM FRIENDSHIP WHERE USER1_ID = 1 ), SUGGESTIONS AS ( SELECT DISTINCT PAGE_ID AS ID FROM LIKES WHERE USER_ID IN (SELECT ID FROM FRIENDS) ) SELECT ID AS RECOMMENDED_PAGE FROM SUGGESTIONS WHERE ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
495,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IS NOT NULL AND USER_ID IN ( SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END AS USER FROM FRIENDSHIP ) AND PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 )
496,Y,Y,WITH CTE1 AS (SELECT USER2_ID AS FID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS FID FROM FRIENDSHIP WHERE USER2_ID = 1) SELECT DISTINCT (A.PAGE_ID) AS RECOMMENDED_PAGE FROM LIKES A LEFT OUTER JOIN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1) B ON A.PAGE_ID = B.PAGE_ID INNER JOIN CTE1 ON A.USER_ID = CTE1.FID WHERE B.PAGE_ID IS NULL
497,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES AS L WHERE USER_ID IN (SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END FROM FRIENDSHIP WHERE USER1_ID = 1 OR USER2_ID = 1 ) AND PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1)
498,Y,Y,"SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE ( PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 ) AND USER_ID IN ( SELECT IF(USER1_ID = 1, USER2_ID, USER1_ID) AS USER_ID FROM FRIENDSHIP WHERE ( USER1_ID = 1 OR USER2_ID = 1 ) ) )"
499,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L INNER JOIN (SELECT F1.USER2_ID AS USER_ID FROM FRIENDSHIP F1 WHERE F1.USER1_ID = 1 UNION ALL SELECT F2.USER1_ID AS USER_ID FROM FRIENDSHIP F2 WHERE F2.USER2_ID = 1) REC ON L.USER_ID = REC.USER_ID WHERE PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES L WHERE USER_ID = 1)
500,Y,Y,"WITH CTE1 AS( SELECT USER1_ID, USER2_ID FROM FRIENDSHIP UNION SELECT USER2_ID, USER1_ID FROM FRIENDSHIP) SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM CTE1 F JOIN LIKES L ON F.USER2_ID=L.USER_ID WHERE F.USER1_ID=1 AND L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)"
501,Y,Y,WITH RE AS (SELECT * FROM LIKES WHERE USER_ID IN (SELECT * FROM( SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID =1 UNION SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID=1) A)) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM RE WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
502,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE PAGE_ID IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID IN ((SELECT USER1_ID AS FRIEND_ID FROM FRIENDSHIP WHERE USER2_ID = 1) UNION (SELECT USER2_ID AS FRIEND_ID FROM FRIENDSHIP WHERE USER1_ID = 1)) ) AND PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
503,Y,Y,"SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM ( SELECT DISTINCT LEAST(USER1_ID, USER2_ID) AS U1, GREATEST(USER1_ID, USER2_ID) AS U2 FROM FRIENDSHIP ) F, LIKES L WHERE U1 = 1 AND F.U2 = L.USER_ID AND NOT L.PAGE_ID IN ( SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1 )"
504,Y,Y,"SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM ( SELECT USER1_ID ID1, USER2_ID ID2 FROM FRIENDSHIP WHERE USER1_ID = '1' UNION SELECT USER2_ID ID1, USER1_ID ID2 FROM FRIENDSHIP WHERE USER2_ID = '1') A LEFT JOIN LIKES L ON L.USER_ID = A.ID2 WHERE L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = '1') AND L.PAGE_ID IS NOT NULL"
505,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( SELECT DISTINCT USER1_ID AS FRIEND FROM FRIENDSHIP WHERE USER2_ID=1 UNION SELECT DISTINCT USER2_ID AS FRIEND FROM FRIENDSHIP WHERE USER1_ID=1) AND PAGE_ID NOT IN ( SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID=1)
506,Y,Y,"SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM ( SELECT B.USER_ID, B.PAGE_ID FROM FRIENDSHIP A LEFT JOIN LIKES B ON (A.USER2_ID=B.USER_ID OR A.USER1_ID=B.USER_ID) AND (A.USER1_ID=1 OR A.USER2_ID=1) WHERE B.PAGE_ID NOT IN ( SELECT DISTINCT(PAGE_ID) FROM LIKES WHERE USER_ID=1) ) T"
507,Y,Y,WITH CTE1 AS (SELECT * FROM FRIENDSHIP WHERE USER1_ID = 1 OR USER2_ID = 1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L JOIN CTE1 ON CTE1.USER1_ID = L.USER_ID OR CTE1.USER2_ID = L.USER_ID WHERE PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1)
508,Y,Y,"SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM ( SELECT *,CASE WHEN USER1_ID=1 THEN USER2_ID ELSE USER1_ID END AS F1 FROM FRIENDSHIP WHERE USER1_ID = '1' OR USER2_ID='1' ) T JOIN LIKES L ON T.F1=L.USER_ID WHERE L.PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)"
509,Y,Y,"WITH CTE AS (SELECT USER1_ID, USER2_ID FROM FRIENDSHIP UNION ALL SELECT USER2_ID, USER1_ID FROM FRIENDSHIP ORDER BY USER1_ID, USER2_ID) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES JOIN CTE ON LIKES.USER_ID=CTE.USER2_ID AND USER1_ID=1 AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)"
510,Y,Y,"WITH CTE AS ( SELECT USER1_ID AS USER,USER2_ID AS FRIEND FROM FRIENDSHIP WHERE USER1_ID =1 UNION SELECT USER2_ID AS USER,USER1_ID AS FRIEND FROM FRIENDSHIP WHERE USER2_ID =1 ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM CTE T JOIN LIKES L ON T.FRIEND = L.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)"
511,Y,Y,SELECT L.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L LEFT JOIN FRIENDSHIP F1 ON L.USER_ID = F1.USER1_ID LEFT JOIN FRIENDSHIP F2 ON L.USER_ID = F2.USER2_ID WHERE (F1.USER1_ID = 1 OR F1.USER2_ID = 1) OR (F2.USER1_ID = 1 OR F2.USER2_ID = 1) GROUP BY L.PAGE_ID HAVING SUM(CASE WHEN L.USER_ID = 1 THEN 1 ELSE 0 END) = 0
512,Y,Y,WITH T AS( SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION ALL SELECT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID = 1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT * FROM T) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
513,Y,Y,"SELECT DISTINCT(L.PAGE_ID) AS RECOMMENDED_PAGE FROM FRIENDSHIP F JOIN LIKES L ON L.USER_ID IN (F.USER1_ID,F.USER2_ID) WHERE (USER1_ID=1 OR USER2_ID=1) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)"
514,Y,Y,"SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L JOIN (SELECT IF(USER1_ID=1, USER2_ID, USER1_ID) USER_ID FROM FRIENDSHIP WHERE USER1_ID=1 OR USER2_ID=1) F ON L.USER_ID = F.USER_ID WHERE L.PAGE_ID IS NOT NULL AND L.PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID=1 )"
515,Y,Y,WITH ALL_FRIENDS AS ( SELECT USER1_ID AS FRIEND_ID FROM FRIENDSHIP WHERE USER2_ID = 1 UNION ALL SELECT USER2_ID AS FRIEND_ID FROM FRIENDSHIP WHERE USER1_ID = 1 ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L JOIN ALL_FRIENDS F ON F.FRIEND_ID = L.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
516,Y,Y,"SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT * FROM FRIENDSHIP UNION SELECT USER2_ID, USER1_ID FROM FRIENDSHIP) F INNER JOIN LIKES L ON F.USER1_ID = 1 AND F.USER2_ID = L.USER_ID WHERE L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
517,Y,Y,"WITH FRIENDS AS ( SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS USER2_ID FROM FRIENDSHIP WHERE USER2_ID = 1), USER1_LIKES AS ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE PAGE_ID NOT IN (SELECT * FROM USER1_LIKES) AND USER_ID IN (SELECT USER2_ID AS USER_ID FROM FRIENDS)"
518,Y,Y,SELECT DISTINCT(PAGE_ID) AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ((SELECT USER2_ID AS FRIEND1 FROM FRIENDSHIP WHERE USER1_ID = 1) UNION ALL (SELECT USER1_ID AS FRIEND1 FROM FRIENDSHIP WHERE USER2_ID = 1)) AND PAGE_ID NOT IN (SELECT DISTINCT(PAGE_ID) FROM LIKES WHERE USER_ID = 1)
519,Y,Y,"SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM ( SELECT USER1_ID AS ID FROM FRIENDSHIP F1 WHERE USER2_ID=1 UNION SELECT USER2_ID AS ID FROM FRIENDSHIP F2 WHERE USER1_ID=1 ) U JOIN (SELECT USER_ID,PAGE_ID FROM LIKES WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)) L ON U.ID = L.USER_ID"
520,Y,Y,"SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L JOIN (SELECT IF(USER1_ID=1, USER2_ID, USER1_ID) USER_ID FROM FRIENDSHIP WHERE USER1_ID=1 OR USER2_ID=1) F ON L.USER_ID = F.USER_ID WHERE L.PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID=1 )"
521,Y,Y,SELECT DISTINCT PAGE_ID RECOMMENDED_PAGE FROM LIKES WHERE PAGE_ID IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID IN ( SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1 ) ) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
522,Y,Y,"WITH CTE AS(SELECT LEAST(USER1_ID, USER2_ID) AS U1, GREATEST(USER1_ID, USER2_ID) AS U2 FROM FRIENDSHIP) SELECT DISTINCT B.PAGE_ID AS RECOMMENDED_PAGE FROM CTE A JOIN LIKES B ON A.U2 = B.USER_ID WHERE U1=1 AND B.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID =1)"
523,Y,Y,SELECT PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDSHIP RIGHT JOIN LIKES ON (USER_ID = USER1_ID OR USER_ID = USER2_ID) WHERE (USER2_ID = 1 OR USER1_ID = 1) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1) GROUP BY PAGE_ID
524,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END USER_ID FROM FRIENDSHIP) F JOIN LIKES L USING (USER_ID) WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
525,Y,N,WITH T AS ( SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID ELSE NULL END AS USER1_FRIEND FROM FRIENDSHIP ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER1_FRIEND FROM T) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
526,Y,Y,WITH TEMP AS (SELECT DISTINCT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1 UNION ALL SELECT DISTINCT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES JOIN TEMP ON USER_ID = USER1_ID WHERE USER_ID IN (SELECT USER1_ID FROM TEMP ) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
527,Y,Y,"SELECT DISTINCT L2.PAGE_ID RECOMMENDED_PAGE FROM ( SELECT USER1_ID USER_ID, USER2_ID FRIEND_ID FROM FRIENDSHIP UNION SELECT USER2_ID USER_ID, USER1_ID FRIEND_ID FROM FRIENDSHIP ) FRIENDS LEFT JOIN LIKES L1 USING(USER_ID) LEFT JOIN LIKES L2 ON FRIENDS.FRIEND_ID = L2.USER_ID WHERE FRIENDS.USER_ID = 1 AND L2.PAGE_ID IS NOT NULL AND L2.PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 )"
528,Y,Y,"SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM ( SELECT IF(USER1_ID < USER2_ID, USER1_ID, USER2_ID) AS USER1_ID, IF(USER1_ID > USER2_ID, USER1_ID, USER2_ID) AS USER2_ID FROM FRIENDSHIP ) A JOIN LIKES B ON A.USER2_ID = B.USER_ID WHERE A.USER1_ID=1 AND B.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)"
529,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM ( SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END AS USER_ID FROM FRIENDSHIP) AS A JOIN LIKES USING(USER_ID) WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
530,Y,Y,"WITH FRIENDS AS ( SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1 ), LIKED AS ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 ) SELECT L.PAGE_ID RECOMMENDED_PAGE FROM LIKES L WHERE L.USER_ID IN (TABLE FRIENDS) AND L.PAGE_ID NOT IN (TABLE LIKED) GROUP BY L.PAGE_ID ORDER BY COUNT(USER_ID) DESC"
531,Y,Y,WITH FRIENDS AS (SELECT ( CASE WHEN USER1_ID = 1 THEN USER2_ID ELSE USER1_ID END ) AS FRIEND FROM FRIENDSHIP WHERE USER1_ID = 1 OR USER2_ID = 1) SELECT DISTINCT(PAGE_ID) AS RECOMMENDED_PAGE FROM FRIENDS JOIN LIKES ON FRIENDS.FRIEND = LIKES.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
532,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END AS USER_ID3 FROM FRIENDSHIP) A JOIN LIKES L ON A.USER_ID3 = L.USER_ID AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
533,Y,Y,"WITH F AS ( SELECT DISTINCT USER2_ID FROM ( SELECT USER1_ID, USER2_ID FROM FRIENDSHIP UNION SELECT USER2_ID, USER1_ID FROM FRIENDSHIP ) AS T1 WHERE USER1_ID = 1 ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER2_ID FROM F) AND PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
534,Y,Y,WITH FRIEND AS ( SELECT USER2_ID AS ID FROM FRIENDSHIP WHERE USER1_ID =1 UNION SELECT USER1_ID AS ID FROM FRIENDSHIP WHERE USER2_ID =1 ) SELECT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT ID FROM FRIEND) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1) GROUP BY PAGE_ID
535,Y,Y,WITH CTE AS (SELECT DISTINCT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION ALL SELECT DISTINCT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT * FROM CTE) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
536,Y,Y,SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDSHIP F INNER JOIN LIKES L ON (F.USER2_ID = L.USER_ID OR F.USER1_ID = L.USER_ID) WHERE (F.USER1_ID = 1 OR F.USER2_ID = 1) AND L.USER_ID != 1 AND L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
537,Y,Y,WITH T1 AS ( SELECT DISTINCT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT DISTINCT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID = 1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L JOIN T1 ON L.USER_ID = T1.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
538,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L JOIN FRIENDSHIP F ON (L.USER_ID = USER1_ID AND USER2_ID = 1) OR (L.USER_ID = USER2_ID AND USER1_ID = 1) WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
539,Y,Y,"WITH FRN AS (SELECT USER1_ID , USER2_ID FROM FRIENDSHIP UNION SELECT USER2_ID USER1_ID, USER1_ID USER2_ID FROM FRIENDSHIP ) SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM FRN F JOIN LIKES L ON F.USER2_ID = L.USER_ID WHERE F.USER1_ID = 1 AND L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID =1 )"
540,Y,Y,"WITH CTE AS ( SELECT USER1_ID AS USER_ID, USER2_ID AS FRIEND_ID FROM FRIENDSHIP WHERE USER1_ID < USER2_ID UNION ALL SELECT USER2_ID AS USER_ID, USER1_ID AS FRIEND_ID FROM FRIENDSHIP WHERE USER2_ID < USER1_ID ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM ( SELECT C.USER_ID, C.FRIEND_ID, L.PAGE_ID FROM CTE C JOIN LIKES L ON C.FRIEND_ID = L.USER_ID WHERE C.USER_ID = 1 AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1) ) TEMP"
541,Y,Y,"WITH FRIENDS AS ( SELECT USER1_ID,USER2_ID FROM FRIENDSHIP UNION SELECT USER2_ID,USER1_ID FROM FRIENDSHIP) SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDS F , LIKES L WHERE F.USER2_ID = L.USER_ID AND F.USER1_ID = 1 AND L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
542,Y,Y,WITH TOTAL_FRIEND AS ( SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID ELSE NULL END AS FRIENDS FROM FRIENDSHIP WHERE USER1_ID = 1 OR USER2_ID = 1 ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM TOTAL_FRIEND A JOIN LIKES B ON A.FRIENDS = B.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
543,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L JOIN FRIENDSHIP F ON ( (L.USER_ID = F.USER2_ID AND F.USER1_ID = 1) OR (L.USER_ID = F.USER1_ID AND F.USER2_ID = 1) ) WHERE L.PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1)
544,Y,N,WITH CET AS( SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END AS FRIENDS FROM FRIENDSHIP) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT FRIENDS FROM CET) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
545,Y,Y,"WITH UNI AS ( SELECT * FROM FRIENDSHIP UNION ALL SELECT USER2_ID, USER1_ID FROM FRIENDSHIP ) SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM UNI INNER JOIN LIKES AS L ON UNI.USER2_ID = L.USER_ID WHERE USER1_ID = 1 AND L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
546,Y,Y,SELECT DISTINCT PAGE_ID RECOMMENDED_PAGE FROM (SELECT USER2_ID FRIEND_ID FROM FRIENDSHIP WHERE USER1_ID=1 UNION SELECT USER1_ID FRIEND_ID FROM FRIENDSHIP WHERE USER2_ID=1) ALL_FRIENDS INNER JOIN LIKES ON ALL_FRIENDS.FRIEND_ID = LIKES.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
547,Y,Y,"SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER2_ID FROM (SELECT USER1_ID, USER2_ID FROM FRIENDSHIP UNION SELECT USER2_ID AS USER1_ID, USER1_ID AS USER2_ID FROM FRIENDSHIP) TEMP WHERE USER1_ID = 1) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
548,Y,Y,"WITH CTE AS( SELECT USER1_ID AS USER_ID, USER2_ID AS FRIEND_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION ALL (SELECT USER2_ID AS USER_ID, USER1_ID AS FRIEND_ID FROM FRIENDSHIP WHERE USER2_ID =1 ) ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( SELECT DISTINCT FRIEND_ID FROM CTE ) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID =1 )"
549,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM ( SELECT (CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END) AS USER_ID FROM FRIENDSHIP) AS A JOIN LIKES AS L ON A.USER_ID = L.USER_ID WHERE PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 )
550,Y,Y,"WITH T AS ( SELECT PAGE_ID FROM LIKES WHERE USER_ID IN ( SELECT USER1_ID AS USER_ID FROM ( SELECT USER1_ID , USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION ALL SELECT USER2_ID AS USER1_ID , USER1_ID AS USER2_ID FROM FRIENDSHIP WHERE USER2_ID = 1 ) A ) UNION ALL SELECT PAGE_ID FROM LIKES WHERE USER_ID IN ( SELECT USER2_ID AS USER_ID FROM ( SELECT USER1_ID , USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION ALL SELECT USER2_ID AS USER1_ID , USER1_ID AS USER2_ID FROM FRIENDSHIP WHERE USER2_ID = 1 ) A ) ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM T WHERE CASE WHEN PAGE_ID IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1) THEN 0 ELSE 1 END"
551,Y,Y,SELECT DISTINCT PAGE_ID RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( SELECT DISTINCT USER1_ID USER_ID FROM FRIENDSHIP WHERE USER2_ID = 1 UNION SELECT DISTINCT USER2_ID USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1 ) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
552,Y,Y,"WITH ALREADY AS ( SELECT PAGE_ID FROM LIKES WHERE USER_ID=1 ) , FRIENDS AS ( SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID=1 UNION ALL SELECT USER1_ID FROM FRIENDSHIP WHERE USER1_ID!=1 AND USER2_ID=1 ) , PAGESFRIENDSLIKE AS ( SELECT PAGE_ID FROM LIKES WHERE USER_ID IN (SELECT USER2_ID FROM FRIENDS) ) SELECT DISTINCT A.PAGE_ID AS RECOMMENDED_PAGE FROM PAGESFRIENDSLIKE A LEFT JOIN ALREADY B ON A.PAGE_ID=B.PAGE_ID WHERE B.PAGE_ID IS NULL"
553,Y,Y,"SELECT DISTINCT T2.PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDSHIP T1 JOIN LIKES T2 ON T1.USER1_ID = T2.USER_ID OR T1.USER2_ID = T2.USER_ID WHERE T2.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1) AND 1 IN (T1.USER1_ID, T1.USER2_ID)"
554,Y,Y,"WITH T AS (SELECT (CASE WHEN USER1_ID=1 THEN USER2_ID WHEN USER2_ID=1 THEN USER1_ID END) AS FRIEND FROM FRIENDSHIP) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM T, LIKES WHERE USER_ID = T.FRIEND AND PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID=1)"
555,Y,Y,SELECT DISTINCT LIKES.PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID = 1 UNION SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1 ) T JOIN LIKES WHERE T.USER_ID = LIKES.USER_ID AND LIKES.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 )
556,Y,Y,SELECT DISTINCT PAGE_ID RECOMMENDED_PAGE FROM LIKES WHERE PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID=1) AND USER_ID IN (SELECT CASE WHEN USER1_ID=1 THEN USER2_ID WHEN USER2_ID=1 THEN USER1_ID END AS USER FROM FRIENDSHIP)
557,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE (USER_ID IN (SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID=1) OR USER_ID IN (SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID=1)) AND PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID=1)
558,Y,Y,SELECT DISTINCT PAGE_ID RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT DISTINCT USER2_ID FROM FRIENDSHIP WHERE USER1_ID=1 UNION SELECT DISTINCT USER1_ID FROM FRIENDSHIP WHERE USER2_ID=1) AND PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 )
559,Y,Y,SELECT DISTINCT PAGE_ID RECOMMENDED_PAGE FROM LIKES WHERE (USER_ID IN (SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1) OR USER_ID IN (SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1)) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
560,Y,Y,WITH CTE AS ( SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1 ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L JOIN CTE C ON C.USER_ID = L.USER_ID WHERE PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID=1)
561,Y,Y,SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDSHIP AS F INNER JOIN LIKES AS L ON (L.USER_ID = F.USER2_ID AND F.USER1_ID = 1) OR (L.USER_ID = F.USER1_ID AND F.USER2_ID = 1) WHERE L.PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1)
562,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1 ) AND PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1)
563,Y,Y,"WITH CTE AS (SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1), CTE2 AS (SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1), CTE3 AS ( SELECT * FROM CTE UNION ALL (SELECT * FROM CTE2 ) ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM CTE3 C3 INNER JOIN LIKES L ON C3.USER2_ID = L.USER_ID HAVING PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
564,Y,Y,SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES AS L WHERE NOT EXISTS (SELECT * FROM LIKES AS L2 WHERE L2.USER_ID = 1 AND L.PAGE_ID = L2.PAGE_ID) AND EXISTS (SELECT * FROM FRIENDSHIP AS F WHERE (F.USER1_ID = 1 AND F.USER2_ID = L.USER_ID) OR (F.USER2_ID = 1 AND F.USER1_ID = L.USER_ID))
565,Y,Y,"SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER2_ID FROM (SELECT USER1_ID, USER2_ID FROM FRIENDSHIP UNION SELECT USER2_ID, USER1_ID FROM FRIENDSHIP) A WHERE USER1_ID=1) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)"
566,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES JOIN (SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END AS FRIEND FROM FRIENDSHIP F ) AS TEMP ON LIKES.USER_ID = TEMP.FRIEND WHERE PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1)
567,Y,Y,SELECT * FROM(SELECT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L JOIN FRIENDSHIP F1 ON L.USER_ID=F1.USER1_ID WHERE USER2_ID=1 AND USER_ID!=1 UNION SELECT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L JOIN FRIENDSHIP F2 ON L.USER_ID=F2.USER2_ID WHERE USER1_ID=1 AND USER_ID!=1) AS T WHERE RECOMMENDED_PAGE NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
568,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER1_ID AS ONE_FRIEND FROM FRIENDSHIP WHERE USER2_ID = 1 UNION SELECT USER2_ID AS ONE_FRIEND FROM FRIENDSHIP WHERE USER1_ID = 1) AND PAGE_ID NOT IN (SELECT L1.PAGE_ID FROM LIKES L1 WHERE L1.USER_ID = 1)
569,Y,Y,"WITH CTE AS( SELECT USER1_ID, USER2_ID FROM FRIENDSHIP UNION SELECT USER2_ID AS USER1_ID, USER1_ID AS USER2_ID FROM FRIENDSHIP) SELECT DISTINCT B.PAGE_ID RECOMMENDED_PAGE FROM CTE A JOIN LIKES B ON A.USER2_ID=B.USER_ID WHERE USER1_ID=1 AND B.PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID=1 )"
570,Y,Y,SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES L LEFT JOIN FRIENDSHIP F ON F.USER1_ID = L.USER_ID OR F.USER2_ID = L.USER_ID WHERE (F.USER1_ID = 1 OR F.USER2_ID = 1) AND (L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)) ORDER BY RECOMMENDED_PAGE
571,Y,Y,WITH FRIEND AS (SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END FRIEND_ID FROM FRIENDSHIP) SELECT DISTINCT PAGE_ID RECOMMENDED_PAGE FROM LIKES INNER JOIN FRIEND ON USER_ID = FRIEND_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
572,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID=1 UNION SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID=1) AND PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID=1)
573,Y,Y,SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDSHIP F JOIN LIKES L ON F.USER1_ID = L.USER_ID OR F.USER2_ID = L.USER_ID WHERE (F.USER1_ID = 1 OR F.USER2_ID = 1) AND L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
574,Y,Y,"WITH CTE AS ( SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID = 1 ), CTE2 AS ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1 ) SELECT DISTINCT(PAGE_ID) AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT USER_ID FROM CTE) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM CTE2)"
575,Y,Y,"SELECT A.PAGE_ID AS RECOMMENDED_PAGE FROM LIKES A, FRIENDSHIP B WHERE (1,A.USER_ID) IN (SELECT * FROM FRIENDSHIP UNION SELECT USER2_ID,USER1_ID FROM FRIENDSHIP) AND A.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1) GROUP BY A.PAGE_ID"
576,Y,Y,SELECT DISTINCT LIKES.PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT * FROM FRIENDSHIP WHERE USER1_ID = 1 OR USER2_ID = 1) T1 JOIN LIKES ON (T1.USER2_ID = LIKES.USER_ID OR USER1_ID = LIKES.USER_ID) WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
577,Y,Y,WITH CTE1 AS (SELECT USER2_ID AS USER_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID AS USER_ID FROM FRIENDSHIP WHERE USER2_ID = 1 ) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT DISTINCT USER_ID FROM CTE1) AND PAGE_ID NOT IN (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1)
578,Y,Y,WITH CTE AS ( SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID=1 UNION SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID=1 ) SELECT DISTINCT PAGE_ID RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN (SELECT * FROM CTE) AND PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID =1)
579,Y,Y,WITH CTE AS (SELECT USER2_ID AS ID FROM FRIENDSHIP WHERE USER1_ID=1 UNION SELECT USER1_ID AS ID FROM FRIENDSHIP WHERE USER2_ID =1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES JOIN CTE ON LIKES.USER_ID=CTE.ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE LIKES.USER_ID=1)
580,Y,Y,SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDSHIP F JOIN LIKES L ON (L.USER_ID=F.USER2_ID AND F.USER1_ID=1) OR (L.USER_ID=F.USER1_ID AND F.USER2_ID=1) WHERE L.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
581,Y,N,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID IN ( SELECT FRIEND_ID FROM( SELECT CASE WHEN USER1_ID = 1 THEN USER2_ID WHEN USER2_ID = 1 THEN USER1_ID END AS FRIEND_ID FROM FRIENDSHIP) A ) AND PAGE_ID NOT IN ( SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID = 1 )
582,Y,Y,SELECT DISTINCT B.PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDSHIP A JOIN LIKES B ON (A.USER2_ID=B.USER_ID AND A.USER1_ID=1) OR (A.USER1_ID=B.USER_ID AND A.USER2_ID=1) WHERE B.PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
583,Y,Y,"WITH DATA AS ( SELECT USER1_ID AS USER_ID, USER2_ID AS FRIENDSWITH FROM FRIENDSHIP WHERE USER1_ID =1 UNION ALL SELECT USER2_ID AS USER_ID, USER1_ID AS FRIENDSWITH FROM FRIENDSHIP WHERE USER2_ID = 1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM DATA D JOIN LIKES L ON D.FRIENDSWITH = L.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES L WHERE USER_ID = 1)"
584,Y,Y,WITH FRIENDS AS (SELECT L.PAGE_ID AS FRIEND_LIKED FROM FRIENDSHIP F JOIN LIKES L ON F.USER2_ID = L.USER_ID WHERE F.USER1_ID = 1 UNION SELECT L.PAGE_ID AS FRIEND_LIKED FROM FRIENDSHIP F JOIN LIKES L ON F.USER1_ID = L.USER_ID WHERE F.USER2_ID = 1) SELECT DISTINCT FRIEND_LIKED AS RECOMMENDED_PAGE FROM FRIENDS WHERE FRIEND_LIKED NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
585,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1) AND PAGE_ID IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID IN ( (SELECT USER1_ID AS ID FROM FRIENDSHIP WHERE USER2_ID = 1) UNION (SELECT USER2_ID AS ID FROM FRIENDSHIP WHERE USER1_ID = 1) ))
586,Y,Y,SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1) F JOIN LIKES L ON F.USER2_ID = L.USER_ID WHERE L.PAGE_ID NOT IN ( SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
587,Y,Y,"WITH LIST_OF_FRND AS (SELECT USER2_ID AS FRIEND_ID FROM FRIENDSHIP WHERE USER1_ID=1 UNION SELECT USER1_ID AS FRIEND_ID FROM FRIENDSHIP WHERE USER2_ID=1), TEMP_LIST AS (SELECT DISTINCT PAGE_ID FROM LIKES WHERE USER_ID IN (SELECT FRIEND_ID FROM LIST_OF_FRND)) SELECT PAGE_ID AS RECOMMENDED_PAGE FROM TEMP_LIST WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)"
588,Y,Y,SELECT * FROM ((SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDSHIP JOIN LIKES ON USER2_ID=USER_ID WHERE USER1_ID = 1) UNION (SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM FRIENDSHIP JOIN LIKES ON USER1_ID=USER_ID WHERE USER2_ID = 1)) AS A WHERE A.RECOMMENDED_PAGE NOT IN (SELECT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE USER_ID=1)
589,Y,Y,"WITH DATA AS ( SELECT USER1_ID AS USER_ID, USER2_ID AS FRIENDSWITH FROM FRIENDSHIP WHERE USER1_ID =1 UNION ALL SELECT USER2_ID AS USER_ID, USER1_ID AS FRIENDSWITH FROM FRIENDSHIP WHERE USER2_ID = 1), A AS ( SELECT D.USER_ID, FRIENDSWITH, PAGE_ID FROM DATA D JOIN LIKES L ON D.FRIENDSWITH = L.USER_ID ORDER BY FRIENDSWITH, PAGE_ID) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM A WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES L WHERE USER_ID = 1)"
590,Y,Y,"WITH USERS_FRIENDS AS ( SELECT COALESCE(IF(USER1_ID = 1, NULL, USER1_ID), IF(USER2_ID = 1, NULL, USER2_ID)) AS FRIEND_ID FROM FRIENDSHIP WHERE USER1_ID = 1 OR USER2_ID = 1 ) ,FRIEND_LIKES AS ( SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM USERS_FRIENDS INNER JOIN LIKES ON USERS_FRIENDS.FRIEND_ID = LIKES.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1) ) SELECT * FROM FRIEND_LIKES"
591,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1) AND (USER_ID IN (SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID=1) OR USER_ID IN (SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID=1))
592,Y,Y,"WITH T1 AS ( SELECT * FROM ( SELECT USER1_ID, USER2_ID FROM FRIENDSHIP F1 UNION SELECT USER2_ID, USER1_ID FROM FRIENDSHIP F2) SUB WHERE USER1_ID = 1) SELECT DISTINCT L.PAGE_ID AS RECOMMENDED_PAGE FROM T1 INNER JOIN LIKES L ON T1.USER2_ID = L.USER_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)"
593,Y,Y,SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM (SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION ALL SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1)SUB JOIN LIKES ON LIKES.USER_ID = SUB.USER2_ID WHERE PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID = 1)
594,Y,Y,WITH TMP AS ( SELECT USER2_ID FROM FRIENDSHIP WHERE USER1_ID = 1 UNION SELECT USER1_ID FROM FRIENDSHIP WHERE USER2_ID = 1) SELECT DISTINCT PAGE_ID AS RECOMMENDED_PAGE FROM LIKES A JOIN TMP B ON B.USER2_ID = A.USER_ID WHERE A.PAGE_ID NOT IN (SELECT PAGE_ID FROM LIKES WHERE USER_ID=1)
