qid,mysql_can_execute?,mysql_correct?,mysql_query
0,N,N,"(SELECT DISTINCT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y') UNION (SELECT DISTINCT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID) = 1) ORDER BY EMPLOYEE_ID"
1,Y,Y,"(SELECT DISTINCT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y') UNION ALL (SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'N' AND EMPLOYEE_ID IN(SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(*) = 1))"
2,N,N,"(SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DISTINCT DEPARTMENT_ID) = 1) UNION (SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y')"
3,N,N,"(SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' ) UNION ( SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID) = 1 )"
4,N,N,"(SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' GROUP BY EMPLOYEE_ID) UNION (SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID) = 1)"
5,N,N,"(SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y') UNION (SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(*) = 1 )"
6,Y,Y,"(SELECT A.EMPLOYEE_ID, B.DEPARTMENT_ID FROM (SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(*)=1) A LEFT JOIN EMPLOYEE B ON A.EMPLOYEE_ID=B.EMPLOYEE_ID) UNION (SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y')"
7,N,N,"(SELECT EMPLOYEE_ID ,DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT( DEPARTMENT_ID) =1 ) UNION (SELECT EMPLOYEE_ID ,DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG ='Y' GROUP BY EMPLOYEE_ID)"
8,N,N,"(SELECT EMPLOYEE_ID ,DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DISTINCT DEPARTMENT_ID) =1 ) UNION (SELECT EMPLOYEE_ID ,DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG ='Y' GROUP BY EMPLOYEE_ID)"
9,N,N,"(SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID) = 1) UNION (SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y')"
10,N,N,"(SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y') UNION (SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(DISTINCT DEPARTMENT_ID) = 1)"
11,Y,Y,"(SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y') UNION (SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID NOT IN (SELECT EMPLOYEE_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y'))"
12,N,N,"(SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(DEPARTMENT_ID) = 1) UNION (SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y')"
13,N,N,"(SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y') UNION (SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(*)=1)"
14,Y,Y,"SELECT DISTINCT A.EMPLOYEE_ID, A.DEPARTMENT_ID FROM (SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(EMPLOYEE_ID) = 1) UNION ALL SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y') A"
15,N,N,"SELECT DISTINCT EMPLOYEE_ID, DEPARTMENT_ID FROM ( SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' UNION ALL SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(*) = 1 ) AS A"
16,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE E1 WHERE PRIMARY_FLAG = 'Y' UNION ALL SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE E WHERE PRIMARY_FLAG = 'N' AND NOT EXISTS (SELECT 1 FROM EMPLOYEE E2 WHERE E.EMPLOYEE_ID = E2.EMPLOYEE_ID AND E2.PRIMARY_FLAG = 'Y' )"
17,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(*) = 1"
18,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y' OR EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(*)=1)"
19,Y,Y,"SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM ( SELECT *,COUNT(EMPLOYEE_ID) OVER(PARTITION BY EMPLOYEE_ID) C FROM EMPLOYEE )T WHERE C=1 OR PRIMARY_FLAG='Y'"
20,Y,Y,"SELECT DISTINCT EMPLOYEE_ID, DEPARTMENT_ID FROM( SELECT *, COUNT(DEPARTMENT_ID) OVER(PARTITION BY EMPLOYEE_ID) AS D_COUNT FROM EMPLOYEE)P1 WHERE (D_COUNT>1 AND PRIMARY_FLAG='Y') OR (D_COUNT=1)"
21,Y,Y,"SELECT EMPLOYEE_ID , DEPARTMENT_ID FROM ( SELECT EMPLOYEE_ID, DEPARTMENT_ID, DENSE_RANK() OVER(PARTITION BY EMPLOYEE_ID ORDER BY PRIMARY_FLAG) AS RNK FROM EMPLOYEE) R WHERE RNK = 1"
22,N,N,"SELECT EMPLOYEE_ID , DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' UNION SELECT EMPLOYEE_ID , DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(EMPLOYEE_ID) = 1"
23,N,N,"SELECT EMPLOYEE_ID , DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' UNION SELECT EMPLOYEE_ID , DEPARTMENT_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(DEPARTMENT_ID) = 1"
24,N,N,"SELECT EMPLOYEE_ID, COALESCE(MAX(CASE WHEN PRIMARY_FLAG = 'Y' THEN DEPARTMENT_ID ELSE NULL END),DEPARTMENT_ID) AS DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID"
25,N,N,"SELECT EMPLOYEE_ID, MAX(CASE WHEN PRIMARY_FLAG = 'Y' THEN DEPARTMENT_ID END) AS DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(*) > 1 UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(*) = 1"
26,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM ( SELECT EMPLOYEE_ID, DEPARTMENT_ID, PRIMARY_FLAG, COUNT(DEPARTMENT_ID) OVER (PARTITION BY EMPLOYEE_ID) AS COUNT_DEPT FROM EMPLOYEE ) AS T1 WHERE COUNT_DEPT = 1 OR PRIMARY_FLAG = 'Y'"
27,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM (SELECT EMPLOYEE_ID, DEPARTMENT_ID, CASE WHEN COUNT(DEPARTMENT_ID) OVER(PARTITION BY EMPLOYEE_ID) = 1 THEN Y ELSE PRIMARY_FLAG END AS PRIMARY_FLAG FROM EMPLOYEE )T WHERE PRIMARY_FLAG = 'Y'"
28,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM (SELECT EMPLOYEE_ID, DEPARTMENT_ID, DENSE_RANK() OVER(PARTITION BY EMPLOYEE_ID ORDER BY PRIMARY_FLAG ) AS RK FROM EMPLOYEE E )AS TEMP WHERE RK =1"
29,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM (SELECT EMPLOYEE_ID, DEPARTMENT_ID, PRIMARY_FLAG, COUNT(DEPARTMENT_ID) OVER(PARTITION BY EMPLOYEE_ID) CN FROM EMPLOYEE) TEMP WHERE (CASE WHEN CN = 1 THEN PRIMARY_FLAG = 'N' OR PRIMARY_FLAG = 'Y' WHEN CN > 1 THEN PRIMARY_FLAG = 'Y' END)"
30,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM (SELECT EMPLOYEE_ID, DEPARTMENT_ID, DENSE_RANK() OVER(PARTITION BY EMPLOYEE_ID ORDER BY PRIMARY_FLAG) AS MYRANK FROM EMPLOYEE )T WHERE MYRANK=1"
31,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID) < 2 UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y'"
32,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID) = 1 UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y'"
33,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING(COUNT(DEPARTMENT_ID) = 1) UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y' GROUP BY EMPLOYEE_ID"
34,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE (PRIMARY_FLAG='Y') UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID)=1 ORDER BY EMPLOYEE_ID"
35,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID IN ( SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT( EMPLOYEE_ID ) = 1 ) || PRIMARY_FLAG = 'Y'"
36,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID IN ( SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(EMPLOYEE_ID) = 1 ) OR PRIMARY_FLAG = 'Y' ORDER BY EMPLOYEE_ID"
37,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' OR EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID) = 1)"
38,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' OR EMPLOYEE_ID IN ( SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(EMPLOYEE_ID) = 1 )"
39,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' OR EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM (SELECT EMPLOYEE_ID, COUNT(*) AS CNT FROM EMPLOYEE GROUP BY EMPLOYEE_ID) AS T1 WHERE CNT = 1)"
40,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' OR EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM (SELECT EMPLOYEE_ID, COUNT(DEPARTMENT_ID) AS DPT_COUNT FROM EMPLOYEE GROUP BY EMPLOYEE_ID) AS DPTCOUNT WHERE DPT_COUNT = 1)"
41,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' OR EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(*) = 1 )"
42,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' OR EMPLOYEE_ID NOT IN (SELECT EMPLOYEE_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y')"
43,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' UNION SELECT DISTINCT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(EMPLOYEE_ID) = 1"
44,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(*) = 1"
45,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(*) = 1 ORDER BY EMPLOYEE_ID, DEPARTMENT_ID"
46,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DISTINCT DEPARTMENT_ID) = 1"
47,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID) = 1"
48,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID IN ( SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(*) = 1)"
49,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE E WHERE PRIMARY_FLAG = 'Y' OR EMPLOYEE_ID IN ( SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID) = 1 )"
50,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' GROUP BY 1 UNION SELECT A.EMPLOYEE_ID, A.DEPARTMENT_ID FROM (SELECT EMPLOYEE_ID, DEPARTMENT_ID, COUNT(DEPARTMENT_ID) FROM EMPLOYEE GROUP BY 1 HAVING COUNT(DEPARTMENT_ID) = 1) A"
51,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(*) = 1 UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' AND EMPLOYEE_ID NOT IN (SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(*) = 1)"
52,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(DEPARTMENT_ID) = 1 UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y'"
53,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM( SELECT EMPLOYEE_ID, DEPARTMENT_ID, PRIMARY_FLAG, COUNT(DEPARTMENT_ID) OVER(PARTITION BY EMPLOYEE_ID) AS NUM_DEPTS FROM EMPLOYEE )A WHERE PRIMARY_FLAG='Y' OR NUM_DEPTS=1"
54,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM( SELECT EMPLOYEE_ID, DEPARTMENT_ID,PRIMARY_FLAG, COUNT(DEPARTMENT_ID) OVER(PARTITION BY EMPLOYEE_ID) AS NUM_DEPT FROM EMPLOYEE )A WHERE PRIMARY_FLAG='Y' OR NUM_DEPT=1"
55,N,N,"SELECT EMPLOYEE_ID, IF(COUNT(DEPARTMENT_ID)=1, DEPARTMENT_ID, SUM(IF(PRIMARY_FLAG='Y',1,0)*DEPARTMENT_ID)) AS DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID"
56,N,N,"SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(DEPARTMENT_ID)=1 UNION SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' GROUP BY 1"
57,Y,Y,"SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y' OR EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(DISTINCT DEPARTMENT_ID)=1) ORDER BY 1"
58,Y,Y,"SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y' UNION SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID)=1)"
59,N,N,"SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(*) = 1 ORDER BY EMPLOYEE_ID"
60,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM (SELECT *, COUNT(DEPARTMENT_ID) OVER (PARTITION BY EMPLOYEE_ID) AS NUM FROM EMPLOYEE ORDER BY EMPLOYEE_ID) A WHERE NUM = 1 OR PRIMARY_FLAG = 'Y'"
61,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' UNION ALL SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'N' AND EMPLOYEE_ID NOT IN (SELECT EMPLOYEE_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y')"
62,N,N,"WITH CTE AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' UNION ALL SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(*) = 1 ) SELECT DISTINCT EMPLOYEE_ID, DEPARTMENT_ID FROM CTE"
63,N,N,"WITH CTE AS (SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(DEPARTMENT_ID) = 1 UNION ALL SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' ) SELECT DISTINCT EMPLOYEE_ID, DEPARTMENT_ID FROM CTE"
64,Y,Y,"WITH ETC AS( SELECT *, COUNT(DEPARTMENT_ID) OVER(PARTITION BY EMPLOYEE_ID) CNT FROM EMPLOYEE ) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM ETC WHERE CNT = 1 OR PRIMARY_FLAG = 'Y'"
65,Y,Y,"WITH EMPLOYEEWITHONEDEPARTMENT AS ( SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID) = 1 ), FIRSTTABLE AS ( SELECT E.EMPLOYEE_ID, E.DEPARTMENT_ID FROM EMPLOYEE E INNER JOIN EMPLOYEEWITHONEDEPARTMENT E1 ON E.EMPLOYEE_ID = E1.EMPLOYEE_ID ), SECONDTABLE AS ( SELECT E.EMPLOYEE_ID, E.DEPARTMENT_ID FROM EMPLOYEE E WHERE E.PRIMARY_FLAG = 'Y' ) SELECT * FROM FIRSTTABLE UNION SELECT * FROM SECONDTABLE"
66,N,N,"WITH TEMP1 AS (SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y' ), TEMP2 AS (SELECT EMPLOYEE_ID, DEPARTMENT_ID, COUNT(DEPARTMENT_ID) AS C FROM EMPLOYEE GROUP BY 1 HAVING C = 1) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM TEMP2 UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM TEMP1"
67,Y,Y,"WITH CTE AS ( SELECT EMPLOYEE_ID, (CASE WHEN COUNT(DEPARTMENT_ID) OVER (PARTITION BY EMPLOYEE_ID) = 1 THEN DEPARTMENT_ID WHEN COUNT(DEPARTMENT_ID) OVER (PARTITION BY EMPLOYEE_ID) > 1 AND PRIMARY_FLAG = 'Y' THEN DEPARTMENT_ID ELSE 0 END) AS DEPARTMENT_ID FROM EMPLOYEE ) SELECT EMPLOYEE_ID, MAX(DEPARTMENT_ID) AS DEPARTMENT_ID FROM CTE GROUP BY 1"
68,Y,Y,"WITH DEP_COUNT AS ( SELECT EMPLOYEE_ID, COUNT(DISTINCT DEPARTMENT_ID) FROM EMPLOYEE GROUP BY 1 HAVING COUNT(DISTINCT DEPARTMENT_ID) = 1 ) ,MULTIPLE_DEPARTMENT AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG ='Y' ), SINGLE_DEPARTMENT AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM DEP_COUNT) ) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM MULTIPLE_DEPARTMENT UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM SINGLE_DEPARTMENT"
69,Y,Y,"WITH DEPS AS ( SELECT EMPLOYEE_ID, COUNT(DISTINCT DEPARTMENT_ID) AS DEPS_NUM FROM EMPLOYEE E GROUP BY EMPLOYEE_ID ) SELECT E.EMPLOYEE_ID, SUM(IF(DEPS_NUM = 1, DEPARTMENT_ID, IF(PRIMARY_FLAG='Y', DEPARTMENT_ID, 0))) AS DEPARTMENT_ID FROM EMPLOYEE E LEFT JOIN DEPS D ON E.EMPLOYEE_ID = D.EMPLOYEE_ID GROUP BY E.EMPLOYEE_ID"
70,N,N,"WITH LOOKUP AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID, COUNT(DEPARTMENT_ID) AS FLAG FROM EMPLOYEE GROUP BY EMPLOYEE_ID ) SELECT EMPLOYEE.EMPLOYEE_ID, EMPLOYEE.DEPARTMENT_ID FROM EMPLOYEE LEFT JOIN LOOKUP ON EMPLOYEE.EMPLOYEE_ID = LOOKUP.EMPLOYEE_ID WHERE PRIMARY_FLAG = 'Y' OR FLAG = 1"
71,Y,Y,"WITH MAIN AS ( SELECT *, COUNT(*) OVER(PARTITION BY EMPLOYEE_ID) AS DEP_COUNT FROM EMPLOYEE ) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM MAIN WHERE PRIMARY_FLAG = 'Y' OR DEP_COUNT = 1"
72,Y,Y,"WITH NEW_EMPLOYEE AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID, RANK() OVER(PARTITION BY EMPLOYEE_ID ORDER BY PRIMARY_FLAG) AS ROW_RK FROM EMPLOYEE ) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM NEW_EMPLOYEE WHERE ROW_RK=1"
73,N,N,"WITH PRIMARIES AS ( SELECT * FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' ) SELECT EMPLOYEE.EMPLOYEE_ID, CASE WHEN PRIMARIES.DEPARTMENT_ID IS NULL THEN EMPLOYEE.DEPARTMENT_ID ELSE PRIMARIES.DEPARTMENT_ID END AS DEPARTMENT_ID FROM EMPLOYEE LEFT JOIN PRIMARIES ON EMPLOYEE.EMPLOYEE_ID = PRIMARIES.EMPLOYEE_ID GROUP BY EMPLOYEE.EMPLOYEE_ID ORDER BY EMPLOYEE.EMPLOYEE_ID ASC"
74,Y,Y,"WITH SINGLE AS ( SELECT EMPLOYEE_ID, COUNT(EMPLOYEE_ID) AS COUNT FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT = 1), MULTI AS ( SELECT EMPLOYEE_ID, COUNT(EMPLOYEE_ID) AS COUNT FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT > 1) SELECT E.EMPLOYEE_ID, E.DEPARTMENT_ID FROM SINGLE INNER JOIN EMPLOYEE E ON SINGLE.EMPLOYEE_ID = E.EMPLOYEE_ID UNION SELECT E.EMPLOYEE_ID, E.DEPARTMENT_ID FROM MULTI INNER JOIN EMPLOYEE E ON MULTI.EMPLOYEE_ID = E.EMPLOYEE_ID WHERE E.PRIMARY_FLAG = 'Y'"
75,N,N,"WITH SINGLE AS(SELECT EMPLOYEE_ID AS EMPLOYEE_ID, DEPARTMENT_ID AS DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(EMPLOYEE_ID)=1), MULTI AS( SELECT EMPLOYEE_ID AS EMPLOYEE_ID, DEPARTMENT_ID AS DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' ) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM SINGLE UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM MULTI"
76,N,N,"WITH SINGLE_DEPT AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(*) = 1 ) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' UNION SELECT * FROM SINGLE_DEPT"
77,Y,Y,"WITH T1 AS ( SELECT *, ( SELECT IF( COUNT(DISTINCT DEPARTMENT_ID) = 1 ,1,0) FROM EMPLOYEE E2 WHERE E2.EMPLOYEE_ID = E1.EMPLOYEE_ID ) AS ONLY_IN_ONE_DEPARTMENT FROM EMPLOYEE E1 ), T2 AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM T1 WHERE PRIMARY_FLAG = 'Y' OR ONLY_IN_ONE_DEPARTMENT ) SELECT * FROM T2"
78,Y,Y,"WITH TEMP AS ( SELECT *, COUNT(*) OVER(PARTITION BY EMPLOYEE_ID ORDER BY EMPLOYEE_ID) CNT FROM EMPLOYEE ) SELECT EMPLOYEE_ID, SUM(CASE WHEN CNT=1 OR PRIMARY_FLAG ='Y' THEN DEPARTMENT_ID ELSE 0 END) DEPARTMENT_ID FROM TEMP GROUP BY EMPLOYEE_ID"
79,Y,Y,"WITH TEMP AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID, ROW_NUMBER() OVER (PARTITION BY EMPLOYEE_ID ORDER BY PRIMARY_FLAG ASC) AS RK FROM EMPLOYEE ) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM TEMP WHERE RK = 1"
80,Y,Y,"WITH TEMP AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID, PRIMARY_FLAG, DENSE_RANK() OVER (PARTITION BY EMPLOYEE_ID ORDER BY PRIMARY_FLAG) AS MY_RANK FROM EMPLOYEE ) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM TEMP WHERE MY_RANK = 1"
81,Y,Y,"SELECT * FROM ( SELECT DISTINCT CT.EMPLOYEE_ID,CASE WHEN CT.CT_DEPT = 1 THEN DEPARTMENT_ID WHEN CT.CT_DEPT > 1 AND PRIMARY_FLAG = 'Y' THEN DEPARTMENT_ID ELSE NULL END AS DEPARTMENT_ID FROM EMPLOYEE LEFT JOIN (SELECT EMPLOYEE_ID,COUNT(DEPARTMENT_ID) AS CT_DEPT FROM EMPLOYEE GROUP BY EMPLOYEE_ID) AS CT ON EMPLOYEE.EMPLOYEE_ID = CT.EMPLOYEE_ID ) AS A WHERE DEPARTMENT_ID IS NOT NULL"
82,Y,Y,"SELECT DISTINCT E1.EMPLOYEE_ID , COALESCE(E2.DEPARTMENT_ID,E1.DEPARTMENT_ID) AS DEPARTMENT_ID FROM EMPLOYEE E1 LEFT JOIN EMPLOYEE E2 ON E1.EMPLOYEE_ID=E2.EMPLOYEE_ID AND E1.PRIMARY_FLAG='N' AND E2.PRIMARY_FLAG='Y'"
83,N,N,"SELECT E1.EMPLOYEE_ID , COALESCE(E2.DEPARTMENT_ID,E1.DEPARTMENT_ID) AS DEPARTMENT_ID FROM EMPLOYEE E1 LEFT JOIN EMPLOYEE E2 ON E1.EMPLOYEE_ID=E2.EMPLOYEE_ID AND E1.PRIMARY_FLAG='N' AND E2.PRIMARY_FLAG='Y' GROUP BY E1.EMPLOYEE_ID"
84,Y,Y,"SELECT T.EMPLOYEE_ID, T.DEPARTMENT_ID FROM ( SELECT *, COUNT(EMPLOYEE_ID) OVER (PARTITION BY EMPLOYEE_ID) C FROM EMPLOYEE ) T WHERE T.C=1 OR T.PRIMARY_FLAG='Y'"
85,Y,Y,"SELECT A.EMPLOYEE_ID, MAX(CASE WHEN CNT = 1 THEN A.DEPARTMENT_ID WHEN CNT > 1 AND A.PRIMARY_FLAG = 'Y' THEN A.DEPARTMENT_ID END) DEPARTMENT_ID FROM EMPLOYEE A INNER JOIN (SELECT EMPLOYEE_ID, COUNT(*) CNT FROM EMPLOYEE GROUP BY 1) B ON A.EMPLOYEE_ID = B.EMPLOYEE_ID GROUP BY 1"
86,Y,Y,"SELECT A.EMPLOYEE_ID, A.DEPARTMENT_ID FROM (SELECT E1.EMPLOYEE_ID, E1.DEPARTMENT_ID, CASE WHEN E2.PRIMARY_FLAG IS NULL THEN NULL ELSE E2.PRIMARY_FLAG END AS PRIMARY_FLAG_V1 FROM EMPLOYEE E1 LEFT JOIN EMPLOYEE E2 ON E1.EMPLOYEE_ID = E2.EMPLOYEE_ID AND E1.DEPARTMENT_ID != E2.DEPARTMENT_ID AND E1.PRIMARY_FLAG !='Y') A WHERE A.PRIMARY_FLAG_V1 = 'NULL'"
87,Y,Y,"SELECT A.EMPLOYEE_ID, A.DEPARTMENT_ID FROM (SELECT E1.EMPLOYEE_ID, E1.DEPARTMENT_ID, E2.PRIMARY_FLAG FROM EMPLOYEE E1 LEFT JOIN EMPLOYEE E2 ON E1.EMPLOYEE_ID = E2.EMPLOYEE_ID AND E1.DEPARTMENT_ID != E2.DEPARTMENT_ID AND E1.PRIMARY_FLAG !='Y') A WHERE A.PRIMARY_FLAG IS NULL"
88,Y,Y,"SELECT A.EMPLOYEE_ID, A.DEPARTMENT_ID FROM EMPLOYEE A INNER JOIN (SELECT EMPLOYEE_ID, COUNT(DISTINCT PRIMARY_FLAG) AS CN FROM EMPLOYEE GROUP BY EMPLOYEE_ID) AS B ON A.EMPLOYEE_ID = B.EMPLOYEE_ID WHERE (B.CN = 1) OR (B.CN > 1 AND PRIMARY_FLAG = 'Y')"
89,Y,Y,"SELECT B.EMPLOYEE_ID,B.DEPARTMENT_ID FROM (SELECT A.*, ROW_NUMBER() OVER (PARTITION BY EMPLOYEE_ID ORDER BY PRIMARY_FLAG ASC) AS ROW_NUM FROM EMPLOYEE AS A) AS B WHERE ROW_NUM=1"
90,N,N,"SELECT B.EMPLOYEE_ID,B.DEPARTMENT_ID FROM EMPLOYEE B WHERE B.PRIMARY_FLAG='Y' OR( B.PRIMARY_FLAG='N' AND B.EMPLOYEE_ID IN (SELECT A.EMPLOYEE_ID FROM EMPLOYEE A GROUP BY A.EMPLOYEE_ID HAVING COUNT(*)=1) ) GROUP BY B.EMPLOYEE_ID"
91,Y,Y,"SELECT DISTINCT A.EMPLOYEE_ID, A.DEPARTMENT_ID FROM ( SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(*) = 1) UNION ALL SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' ) A"
92,Y,Y,"SELECT DISTINCT E.EMPLOYEE_ID, COALESCE(E1.DEPARTMENT_ID,E.DEPARTMENT_ID) AS DEPARTMENT_ID FROM EMPLOYEE E LEFT JOIN EMPLOYEE E1 ON E.EMPLOYEE_ID = E1.EMPLOYEE_ID AND E.PRIMARY_FLAG = 'N' AND E1.PRIMARY_FLAG = 'Y'"
93,Y,Y,"SELECT DISTINCT EMPLOYEE_ID, DEPARTMENT_ID FROM ( SELECT EMPLOYEE_ID, DEPARTMENT_ID, PRIMARY_FLAG, COUNT(*) OVER (PARTITION BY EMPLOYEE_ID) AS TOTAL_COUNT FROM EMPLOYEE ) A WHERE A.PRIMARY_FLAG='Y' OR TOTAL_COUNT=1"
94,N,N,"SELECT DISTINCT EMPLOYEE_ID, DEPARTMENT_ID FROM (SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(*) = 1 UNION ALL SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y') B"
95,Y,Y,"SELECT DISTINCT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y' UNION ALL SELECT DISTINCT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='N' AND EMPLOYEE_ID NOT IN (SELECT DISTINCT EMPLOYEE_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y')"
96,Y,Y,"SELECT DISTINCT EMPLOYEE_ID,DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y' UNION SELECT DISTINCT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID NOT IN ( SELECT DISTINCT EMPLOYEE_ID FROM (SELECT DISTINCT EMPLOYEE_ID,DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y')A )"
97,N,N,"SELECT E.EMPLOYEE_ID, CASE WHEN F.C>1 AND E.PRIMARY_FLAG='Y' THEN E.DEPARTMENT_ID WHEN F.C=1 THEN E.DEPARTMENT_ID END AS DEPARTMENT_ID FROM EMPLOYEE E LEFT JOIN (SELECT EMPLOYEE_ID, DEPARTMENT_ID, COUNT(PRIMARY_FLAG) AS C FROM EMPLOYEE GROUP BY EMPLOYEE_ID) F ON E.EMPLOYEE_ID = F.EMPLOYEE_ID HAVING DEPARTMENT_ID IS NOT NULL"
98,Y,Y,"SELECT E.EMPLOYEE_ID, E.DEPARTMENT_ID FROM EMPLOYEE E WHERE PRIMARY_FLAG = 'Y' OR (SELECT COUNT(*) FROM EMPLOYEE WHERE EMPLOYEE_ID = E.EMPLOYEE_ID) = 1"
99,N,N,"SELECT E1.EMPLOYEE_ID, E1.DEPARTMENT_ID FROM EMPLOYEE E1 LEFT JOIN (SELECT EMPLOYEE_ID, DEPARTMENT_ID, PRIMARY_FLAG, COUNT(EMPLOYEE_ID) AS CNT FROM EMPLOYEE GROUP BY EMPLOYEE_ID) AS E2 ON E1.EMPLOYEE_ID = E2.EMPLOYEE_ID WHERE E1.PRIMARY_FLAG = 'Y' OR E2.CNT = 1"
100,Y,Y,"SELECT EMPLOYEE_ID , DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID IN ( SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(DISTINCT DEPARTMENT_ID) = 1 ) UNION SELECT EMPLOYEE_ID , DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y'"
101,Y,Y,"SELECT EMPLOYEE_ID , MAX(DEPARTMENT_ID ) AS DEPARTMENT_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(*) = 1 UNION SELECT EMPLOYEE_ID , MAX(CASE WHEN PRIMARY_FLAG = 'Y' THEN DEPARTMENT_ID END ) AS DEPARTMENT_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(*) > 1"
102,Y,Y,"SELECT EMPLOYEE_ID , MAX(DEPARTMENT_ID) AS DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(1) = 1 UNION SELECT EMPLOYEE_ID , DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y'"
103,Y,Y,"SELECT EMPLOYEE_ID ,DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' UNION SELECT A.EMPLOYEE_ID ,A.DEPARTMENT_ID FROM EMPLOYEE A INNER JOIN (SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING SUM(1) = 1) B ON A.EMPLOYEE_ID = B.EMPLOYEE_ID"
104,N,N,"SELECT EMPLOYEE_ID, CASE WHEN (COUNT(DEPARTMENT_ID)> 1 ) THEN SUM( IF( PRIMARY_FLAG = 'Y',DEPARTMENT_ID , NULL)) WHEN (COUNT(DEPARTMENT_ID))= 1 THEN DEPARTMENT_ID END DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID"
105,N,N,"SELECT EMPLOYEE_ID, CASE WHEN COUNT(*) = 1 THEN DEPARTMENT_ID ELSE SUM(IF(PRIMARY_FLAG='Y',DEPARTMENT_ID,0)) END AS DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID"
106,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM ( SELECT *, COUNT(*) OVER(PARTITION BY EMPLOYEE_ID) AS NUM_DEPARTMENT FROM EMPLOYEE ) AS E1 WHERE (NUM_DEPARTMENT>1 AND PRIMARY_FLAG='Y') OR (NUM_DEPARTMENT=1)"
107,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM ( SELECT EMPLOYEE_ID, COUNT(DEPARTMENT_ID) CT FROM EMPLOYEE GROUP BY EMPLOYEE_ID ) R1 NATURAL JOIN EMPLOYEE WHERE PRIMARY_FLAG='Y' OR (CT=1 AND PRIMARY_FLAG='N')"
108,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM ( SELECT EMPLOYEE_ID, DEPARTMENT_ID, MAX(PRIMARY_FLAG) OVER (PARTITION BY EMPLOYEE_ID ) AS LAST_FLAG, PRIMARY_FLAG FROM EMPLOYEE ORDER BY 1 ) TEMP WHERE (PRIMARY_FLAG = 'Y') OR (LAST_FLAG = 'N') ORDER BY 1"
109,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM ( SELECT EMPLOYEE_ID, DEPARTMENT_ID, PRIMARY_FLAG, RANK() OVER (PARTITION BY EMPLOYEE_ID ORDER BY PRIMARY_FLAG) AS IS_PRIMARY FROM EMPLOYEE ) AS A WHERE A.IS_PRIMARY = 1"
110,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM ( SELECT EMPLOYEE_ID, DEPARTMENT_ID, PRIMARY_FLAG, SUM(1) OVER(PARTITION BY EMPLOYEE_ID) AS DEPT_CNT FROM EMPLOYEE ) X WHERE PRIMARY_FLAG = 'Y' OR DEPT_CNT = 1 ORDER BY 1"
111,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM ( SELECT EMPLOYEE_ID, DEPARTMENT_ID, RANK() OVER(PARTITION BY EMPLOYEE_ID ORDER BY PRIMARY_FLAG ASC) _RANK FROM EMPLOYEE ) TBL WHERE TBL._RANK = 1"
112,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM ( SELECT EMPLOYEE_ID, DEPARTMENT_ID, ROW_NUMBER() OVER (PARTITION BY EMPLOYEE_ID ORDER BY CASE WHEN PRIMARY_FLAG = 'Y' THEN 1 ELSE 2 END ASC) AS RN FROM EMPLOYEE ) T WHERE RN = 1"
113,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM ( SELECT EMPLOYEE_ID,DEPARTMENT_ID,PRIMARY_FLAG,COUNT(EMPLOYEE_ID) OVER (PARTITION BY EMPLOYEE_ID) AS C FROM EMPLOYEE ) A WHERE C = 1 OR PRIMARY_FLAG ='Y'"
114,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM (SELECT * , COUNT(DEPARTMENT_ID) OVER(PARTITION BY EMPLOYEE_ID) AS NUM_DEP FROM EMPLOYEE) AS A WHERE PRIMARY_FLAG = 'Y' OR NUM_DEP = 1"
115,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM (SELECT *, COUNT(1) OVER (PARTITION BY EMPLOYEE_ID ORDER BY PRIMARY_FLAG) AS CNT FROM EMPLOYEE) TAB WHERE CNT = 1 OR (CNT > 1 AND PRIMARY_FLAG = 'Y')"
116,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM (SELECT *, COUNT(EMPLOYEE_ID)OVER(PARTITION BY EMPLOYEE_ID) AS CNT FROM EMPLOYEE) T WHERE CNT=1 OR PRIMARY_FLAG='Y'"
117,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM (SELECT EMPLOYEE_ID, DEPARTMENT_ID, PRIMARY_FLAG, COUNT(1) OVER(PARTITION BY EMPLOYEE_ID) AS CNT FROM EMPLOYEE) T WHERE CNT = 1 OR (CNT>1 AND PRIMARY_FLAG = 'Y')"
118,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM (SELECT EMPLOYEE_ID, DEPARTMENT_ID, PRIMARY_FLAG, COUNT(DEPARTMENT_ID) OVER(PARTITION BY EMPLOYEE_ID) AS CN FROM EMPLOYEE) TEMP WHERE (CASE WHEN CN=1 THEN PRIMARY_FLAG='Y' OR PRIMARY_FLAG='N' WHEN CN>1 THEN PRIMARY_FLAG='Y' END)"
119,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM (SELECT EMPLOYEE_ID, DEPARTMENT_ID, PRIMARY_FLAG, COUNT(DEPARTMENT_ID) OVER(PARTITION BY EMPLOYEE_ID) CN FROM EMPLOYEE) TEMP WHERE (CN = 1 AND (PRIMARY_FLAG = 'N' OR PRIMARY_FLAG = 'Y')) OR (CN > 1 AND PRIMARY_FLAG = 'Y')"
120,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM (SELECT EMPLOYEE_ID, DEPARTMENT_ID, RANK() OVER(PARTITION BY EMPLOYEE_ID ORDER BY PRIMARY_FLAG ASC) AS RANK_ FROM EMPLOYEE) TMP1 WHERE RANK_=1 ORDER BY EMPLOYEE_ID"
121,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM (SELECT EMPLOYEE_ID, DEPARTMENT_ID, RANK()OVER(PARTITION BY EMPLOYEE_ID ORDER BY PRIMARY_FLAG ) AS FLAG_RANK FROM EMPLOYEE)T WHERE FLAG_RANK = 1"
122,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE AS E1 WHERE PRIMARY_FLAG = 'Y' OR EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID) = 1)"
123,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE E WHERE PRIMARY_FLAG = 'Y' OR (PRIMARY_FLAG = 'N' AND EMPLOYEE_ID IN (SELECT DISTINCT EMPLOYEE_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID) =1))"
124,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(DISTINCT DEPARTMENT_ID) = 1 UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG ='Y'"
125,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DISTINCT DEPARTMENT_ID) = 1 UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y'"
126,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(EMPLOYEE_ID) = 1 UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y'"
127,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE JOIN (SELECT EMPLOYEE_ID, COUNT(*) AS CNT FROM EMPLOYEE GROUP BY EMPLOYEE_ID) T USING(EMPLOYEE_ID) WHERE CNT = 1 OR PRIMARY_FLAG = 'Y'"
128,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID IN ( SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID) < 2 ) UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y'"
129,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(*)=1 ) UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y'"
130,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(EMPLOYEE_ID)>1) AND PRIMARY_FLAG='Y' UNION ALL SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(EMPLOYEE_ID) = 1)"
131,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID NOT IN (SELECT EMPLOYEE_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y') UNION (SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y')"
132,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' OR EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID) = 1 ORDER BY EMPLOYEE_ID)"
133,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' OR EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(PRIMARY_FLAG)=1)"
134,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(PRIMARY_FLAG) = 1"
135,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' GROUP BY EMPLOYEE_ID UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID) = 1"
136,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' GROUP BY EMPLOYEE_ID UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(EMPLOYEE_ID) = 1"
137,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' OR EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT( DISTINCT PRIMARY_FLAG)=1 )"
138,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' OR EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(*) = 1) ORDER BY EMPLOYEE_ID"
139,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' OR EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DISTINCT DEPARTMENT_ID) = 1)"
140,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' UNION ALL SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'N' AND EMPLOYEE_ID IN ( SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(*) = 1 )"
141,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING (COUNT(DEPARTMENT_ID)=1)"
142,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(*) = 1)"
143,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y' UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='N' AND EMPLOYEE_ID NOT IN (SELECT EMPLOYEE_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y')"
144,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y' UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING SUM(PRIMARY_FLAG='Y') = 0"
145,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y' UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID NOT IN (SELECT EMPLOYEE_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y')"
146,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID IN ( SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(DEPARTMENT_ID) = 1 ) UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y'"
147,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' AND EMPLOYEE_ID IN ( SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(*) > 1) UNION (SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(*) = 1)"
148,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' OR (PRIMARY_FLAG = 'N' AND EMPLOYEE_ID NOT IN (SELECT EMPLOYEE_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' ) )"
149,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' OR EMPLOYEE_ID IN ( SELECT EMPLOYEE_ID FROM( SELECT EMPLOYEE_ID, COUNT(DEPARTMENT_ID) AS COUNT FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID) = 1 ) D)"
150,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' OR EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(DEPARTMENT_ID) = 1)"
151,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(1) = 1"
152,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'N' AND EMPLOYEE_ID NOT IN (SELECT EMPLOYEE_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y') GROUP BY 1 HAVING COUNT(*) = 1"
153,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG ='Y' UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE E WHERE PRIMARY_FLAG ='N' AND NOT EXISTS (SELECT 1 FROM EMPLOYEE E1 WHERE E.EMPLOYEE_ID = E1.EMPLOYEE_ID AND E1.PRIMARY_FLAG ='Y' )"
154,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM( SELECT EMPLOYEE_ID, DEPARTMENT_ID, PRIMARY_FLAG, COUNT(DEPARTMENT_ID) OVER (PARTITION BY EMPLOYEE_ID) AS C FROM EMPLOYEE) AS TMP WHERE PRIMARY_FLAG = 'Y' OR C = 1"
155,N,N,"SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(EMPLOYEE_ID)=1 UNION SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y' GROUP BY EMPLOYEE_ID"
156,N,N,"SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' GROUP BY EMPLOYEE_ID, PRIMARY_FLAG UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID) = 1"
157,Y,Y,"SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' OR (EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID)=1))"
158,Y,Y,"SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y' UNION ALL SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID NOT IN (SELECT EMPLOYEE_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y')"
159,N,N,"SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(*)=1 UNION SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y'"
160,Y,Y,"SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y' UNION SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID NOT IN (SELECT EMPLOYEE_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y') GROUP BY EMPLOYEE_ID,DEPARTMENT_ID HAVING COUNT(*)=1"
161,N,N,"SELECT T1.EMPLOYEE_ID, CASE WHEN T1.DEPARTMENT_ID IS NULL THEN T2.DEPARTMENT_ID ELSE T1.DEPARTMENT_ID END DEPARTMENT_ID FROM (SELECT E.EMPLOYEE_ID, CASE WHEN COUNT(*) = 1 THEN E.DEPARTMENT_ID ELSE NULL END DEPARTMENT_ID FROM EMPLOYEE E GROUP BY EMPLOYEE_ID) T1 LEFT JOIN (SELECT E.EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE E WHERE E.PRIMARY_FLAG = 'Y') T2 ON T1.EMPLOYEE_ID = T2.EMPLOYEE_ID"
162,Y,Y,"SELECT T2.EMPLOYEE_ID, T2.DEPARTMENT_ID FROM ( SELECT T1.*, (SELECT COUNT(DISTINCT T3.DEPARTMENT_ID) FROM EMPLOYEE T3 WHERE T1.EMPLOYEE_ID = T3.EMPLOYEE_ID) AS NUM_DEPT FROM EMPLOYEE T1 ) T2 WHERE NUM_DEPT = 1 OR (NUM_DEPT > 1 AND PRIMARY_FLAG = 'Y')"
163,Y,Y,"WITH E1 AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y' ), E2 AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID NOT IN (SELECT EMPLOYEE_ID FROM E1) ) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM E1 UNION ALL SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM E2"
164,N,N,"WITH A AS (SELECT EMPLOYEE_ID, DEPARTMENT_ID, PRIMARY_FLAG FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID) =1), B AS (SELECT EMPLOYEE_ID, DEPARTMENT_ID, PRIMARY_FLAG, COUNT(DEPARTMENT_ID) FROM EMPLOYEE WHERE PRIMARY_FLAG ='Y' GROUP BY EMPLOYEE_ID) SELECT A.EMPLOYEE_ID, A.DEPARTMENT_ID FROM A UNION SELECT B.EMPLOYEE_ID, B.DEPARTMENT_ID FROM B"
165,Y,Y,"WITH BASE AS (SELECT EMPLOYEE_ID, COUNT(DISTINCT DEPARTMENT_ID) AS ND FROM EMPLOYEE GROUP BY 1) SELECT E.EMPLOYEE_ID, E.DEPARTMENT_ID FROM EMPLOYEE E LEFT JOIN BASE B ON E.EMPLOYEE_ID = B.EMPLOYEE_ID WHERE B.ND = 1 UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y'"
166,N,N,"WITH CNT AS( SELECT DISTINCT EMPLOYEE_ID, DEPARTMENT_ID, COUNT(EMPLOYEE_ID) AS CNT FROM EMPLOYEE GROUP BY EMPLOYEE_ID) SELECT DISTINCT EMPLOYEE_ID, DEPARTMENT_ID FROM CNT WHERE CNT = 1 UNION SELECT DISTINCT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y'"
167,Y,Y,"WITH CTE AS ( SELECT *, ROW_NUMBER() OVER (PARTITION BY EMPLOYEE_ID ORDER BY PRIMARY_FLAG ASC) AS ROWNUM FROM EMPLOYEE ) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM CTE WHERE ROWNUM = 1"
168,Y,Y,"WITH CTE AS ( SELECT E.EMPLOYEE_ID, COUNT(*) AS EMPLOYCOUNT FROM EMPLOYEE E GROUP BY 1 ) SELECT E.EMPLOYEE_ID, E.DEPARTMENT_ID FROM EMPLOYEE E LEFT JOIN CTE ON E.EMPLOYEE_ID = CTE.EMPLOYEE_ID WHERE CTE.EMPLOYCOUNT = 1 OR (CTE.EMPLOYCOUNT > 1 AND E.PRIMARY_FLAG = 'Y')"
169,Y,Y,"WITH CTE AS ( SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY 1 HAVING(COUNT(DISTINCT DEPARTMENT_ID))=1 ) SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y' UNION SELECT E.EMPLOYEE_ID,E.DEPARTMENT_ID FROM CTE JOIN EMPLOYEE E ON CTE.EMPLOYEE_ID=E.EMPLOYEE_ID"
170,Y,Y,"WITH CTE AS ( SELECT EMPLOYEE_ID, COUNT(*) CT, MAX(PRIMARY_FLAG) PF FROM EMPLOYEE GROUP BY EMPLOYEE_ID) , CTE1 AS ( SELECT * FROM EMPLOYEE WHERE PRIMARY_FLAG='Y') SELECT DISTINCT C.EMPLOYEE_ID, CASE WHEN CT>1 AND PF='Y' THEN C1.DEPARTMENT_ID ELSE E.DEPARTMENT_ID END DEPARTMENT_ID FROM CTE C INNER JOIN EMPLOYEE E ON C.EMPLOYEE_ID=E.EMPLOYEE_ID LEFT JOIN CTE1 C1 ON C1.EMPLOYEE_ID=C.EMPLOYEE_ID"
171,N,N,"WITH CTE AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(EMPLOYEE_ID) = 1) SELECT DISTINCT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' UNION SELECT * FROM CTE"
172,N,N,"WITH CTE AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID, COUNT(DISTINCT DEPARTMENT_ID) AS COUNT FROM EMPLOYEE GROUP BY EMPLOYEE_ID ) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM( SELECT E.EMPLOYEE_ID, E.DEPARTMENT_ID, PRIMARY_FLAG, COUNT FROM EMPLOYEE E JOIN CTE C ON E.EMPLOYEE_ID = C.EMPLOYEE_ID ) SUB WHERE (COUNT > 1 AND PRIMARY_FLAG = 'Y') OR (COUNT = 1)"
173,Y,Y,"WITH CTE AS (SELECT *, COUNT(DEPARTMENT_ID) OVER(PARTITION BY EMPLOYEE_ID) AS CT FROM EMPLOYEE) SELECT DISTINCT EMPLOYEE_ID, IF(CT=1,DEPARTMENT_ID,IF(PRIMARY_FLAG='Y',DEPARTMENT_ID,NULL)) AS DEPARTMENT_ID FROM CTE WHERE (CT = 1) OR (CT>1 AND PRIMARY_FLAG='Y')"
174,Y,Y,"WITH CTE AS (SELECT *, ROW_NUMBER() OVER (PARTITION BY EMPLOYEE_ID ORDER BY PRIMARY_FLAG) AS R FROM EMPLOYEE) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM CTE WHERE R = 1"
175,N,N,"WITH CTE AS (SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID)=1) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM CTE UNION ALL SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID NOT IN (SELECT EMPLOYEE_ID FROM CTE) AND PRIMARY_FLAG = 'Y'"
176,Y,Y,"WITH CTE AS (SELECT EMPLOYEE_ID, DEPARTMENT_ID, PRIMARY_FLAG, COUNT(EMPLOYEE_ID) OVER (PARTITION BY EMPLOYEE_ID) AS COUNTER FROM EMPLOYEE) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM CTE WHERE COUNTER = 1 UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM CTE WHERE COUNTER > 1 AND PRIMARY_FLAG = 'Y'"
177,Y,Y,"WITH CTE AS( SELECT *, RANK() OVER(PARTITION BY EMPLOYEE_ID ORDER BY PRIMARY_FLAG ASC) RNK FROM EMPLOYEE) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM CTE WHERE RNK = 1"
178,Y,Y,"WITH CTE AS( SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y') SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID NOT IN (SELECT EMPLOYEE_ID FROM CTE) UNION SELECT * FROM CTE"
179,N,N,"WITH CTE AS( SELECT EMPLOYEE_ID, DEPARTMENT_ID, RANK() OVER (PARTITION BY EMPLOYEE_ID ORDER BY PRIMARY_FLAG ASC) AS RNK FROM EMPLOYEE ) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM CTE WHERE RNK = 1 GROUP BY EMPLOYEE_ID"
180,Y,Y,"WITH CTE_FINAL AS ( SELECT EMPLOYEE_ID, CASE WHEN COUNT(*) = 1 THEN ANY_VALUE(DEPARTMENT_ID) ELSE SUM( IF(PRIMARY_FLAG = 'Y', DEPARTMENT_ID, 0)) END AS DEPARTMENT_ID FROM EMPLOYEE GROUP BY 1 ) SELECT * FROM CTE_FINAL"
181,Y,Y,"WITH DEPT AS( SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(*)=1 ) SELECT DEPT.EMPLOYEE_ID, E1.DEPARTMENT_ID FROM EMPLOYEE E1 JOIN DEPT ON E1.EMPLOYEE_ID=DEPT.EMPLOYEE_ID UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y'"
182,Y,Y,"WITH EMP AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID, PRIMARY_FLAG, COUNT(*) OVER(PARTITION BY EMPLOYEE_ID) CNT FROM EMPLOYEE ) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMP WHERE (PRIMARY_FLAG='Y' AND CNT>1) OR CNT=1"
183,N,N,"WITH MULT AS ( SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(*) > 1 ) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(*) = 1 UNION ALL SELECT E.EMPLOYEE_ID, E.DEPARTMENT_ID FROM MULT AS M INNER JOIN EMPLOYEE AS E ON M.EMPLOYEE_ID = E.EMPLOYEE_ID WHERE PRIMARY_FLAG = 'Y'"
184,Y,Y,"WITH NEW AS (SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG ='Y') SELECT DISTINCT E.EMPLOYEE_ID, IFNULL(N.DEPARTMENT_ID,E.DEPARTMENT_ID) AS DEPARTMENT_ID FROM EMPLOYEE E LEFT JOIN NEW N ON E.EMPLOYEE_ID=N.EMPLOYEE_ID"
185,N,N,"WITH NO_PRIMARY AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID, PRIMARY_FLAG FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(EMPLOYEE_ID) = 1 AND PRIMARY_FLAG = 'N'), YES_PRIMARY AS ( SELECT DISTINCT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y') SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM YES_PRIMARY UNION ALL SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM NO_PRIMARY"
186,N,N,"WITH T AS ( SELECT EMPLOYEE_ID , SUM(CASE WHEN PRIMARY_FLAG = 'Y' THEN DEPARTMENT_ID ELSE 0 END ) DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(*) > 1 ) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(*) = 1 UNION SELECT * FROM T"
187,Y,Y,"WITH T AS ( SELECT EMPLOYEE_ID,DEPARTMENT_ID,PRIMARY_FLAG, COUNT(DEPARTMENT_ID) OVER(PARTITION BY EMPLOYEE_ID) AS NUM_DEP FROM EMPLOYEE ) SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM T WHERE PRIMARY_FLAG = 'Y' OR NUM_DEP = 1"
188,N,N,"WITH T AS (SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y' GROUP BY 1,2), T2 AS (SELECT EMPLOYEE_ID, DEPARTMENT_ID, COUNT(DEPARTMENT_ID) C FROM EMPLOYEE GROUP BY 1 HAVING C=1) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM T2 UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM T"
189,N,N,"WITH T AS( SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID)=1 ), TT AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y' ) SELECT * FROM T UNION SELECT * FROM TT"
190,Y,Y,"WITH T AS(SELECT EMPLOYEE_ID,DEPARTMENT_ID,ROW_NUMBER()OVER(PARTITION BY EMPLOYEE_ID ORDER BY PRIMARY_FLAG)RK FROM EMPLOYEE) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM T WHERE RK = 1"
191,Y,Y,"WITH T1 AS (SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' ) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'N' AND EMPLOYEE_ID NOT IN (SELECT EMPLOYEE_ID FROM T1) UNION ALL SELECT * FROM T1 ORDER BY EMPLOYEE_ID"
192,Y,Y,"WITH TEMP AS ( SELECT EMPLOYEE_ID, COUNT(DEPARTMENT_ID) FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID) =1 ) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' OR EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM TEMP)"
193,Y,Y,"WITH TEMP AS ( SELECT EMPLOYEE_ID, COUNT(EMPLOYEE_ID) AS DEP FROM EMPLOYEE GROUP BY EMPLOYEE_ID ) SELECT A.EMPLOYEE_ID, A.DEPARTMENT_ID FROM EMPLOYEE A LEFT JOIN TEMP B ON A.EMPLOYEE_ID = B.EMPLOYEE_ID WHERE A.PRIMARY_FLAG = 'Y' OR B.DEP = 1.00"
194,Y,Y,"WITH TEMP AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' ) SELECT * FROM TEMP UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID NOT IN (SELECT EMPLOYEE_ID FROM TEMP)"
195,N,N,"WITH TEMP AS( SELECT *, COUNT(DEPARTMENT_ID) AS CNT FROM EMPLOYEE GROUP BY EMPLOYEE_ID), TEMP1 AS(SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM TEMP WHERE CNT=1), TEMP2 AS(SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y') SELECT * FROM TEMP1 UNION SELECT * FROM TEMP2"
196,N,N,"WITH TEMP1 AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID, COUNT(EMPLOYEE_ID) CNT FROM EMPLOYEE GROUP BY 1 ), TEMP2 AS ( SELECT * FROM EMPLOYEE WHERE EMPLOYEE_ID NOT IN (SELECT EMPLOYEE_ID FROM TEMP1 WHERE CNT=1 ) AND PRIMARY_FLAG ='Y' ) (SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM TEMP1 WHERE CNT =1) UNION (SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM TEMP2)"
197,N,N,"WITH TMP AS (SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID) = 1) SELECT * FROM TMP UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y'"
198,Y,Y,"WITH Y AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' ), N AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID NOT IN (SELECT EMPLOYEE_ID FROM Y) ) SELECT DISTINCT EMPLOYEE_ID, DEPARTMENT_ID FROM Y UNION SELECT DISTINCT EMPLOYEE_ID, DEPARTMENT_ID FROM N"
199,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM (SELECT EMPLOYEE_ID, DEPARTMENT_ID, DENSE_RANK() OVER (PARTITION BY EMPLOYEE_ID ORDER BY PRIMARY_FLAG ASC) AS MY_RANK FROM EMPLOYEE) T WHERE MY_RANK = 1"
200,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID) <= 1 UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y'"
201,Y,Y,"WITH TEMP_TBL AS (SELECT EMPLOYEE_ID, DEPARTMENT_ID, PRIMARY_FLAG FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y') SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM (SELECT EMPLOYEE_ID, DEPARTMENT_ID, PRIMARY_FLAG, ROW_NUMBER() OVER(PARTITION BY EMPLOYEE_ID) AS RN FROM EMPLOYEE) AA WHERE AA.RN = 1 AND AA.PRIMARY_FLAG = 'N' AND EMPLOYEE_ID NOT IN (SELECT EMPLOYEE_ID FROM TEMP_TBL) UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM TEMP_TBL"
202,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' GROUP BY EMPLOYEE_ID HAVING COUNT(EMPLOYEE_ID) >= 1 UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(EMPLOYEE_ID) = 1"
203,Y,Y,"WITH CTE AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID, ROW_NUMBER() OVER(PARTITION BY EMPLOYEE_ID ORDER BY PRIMARY_FLAG) AS RNK FROM EMPLOYEE ) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM CTE WHERE RNK=1"
204,Y,Y,"WITH C AS (SELECT EMPLOYEE_ID, COUNT(EMPLOYEE_ID) AS DCOUNT FROM EMPLOYEE GROUP BY EMPLOYEE_ID), WC AS (SELECT EMPLOYEE.EMPLOYEE_ID, DEPARTMENT_ID,PRIMARY_FLAG, DCOUNT FROM EMPLOYEE JOIN C ON C.EMPLOYEE_ID = EMPLOYEE.EMPLOYEE_ID) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM WC WHERE DCOUNT = 1 UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM WC WHERE DCOUNT > 1 AND PRIMARY_FLAG = 'Y'"
205,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM ( SELECT EMPLOYEE_ID, DEPARTMENT_ID, COUNT(*) OVER (PARTITION BY EMPLOYEE_ID) DEPT_CNT FROM EMPLOYEE E ) E WHERE DEPT_CNT = 1 UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE E WHERE PRIMARY_FLAG = 'Y'"
206,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID NOT IN (SELECT DISTINCT(EMPLOYEE_ID) FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y')"
207,N,N,"SELECT EMPLOYEE_ID, IF(COUNT(DEPARTMENT_ID) = 1 AND PRIMARY_FLAG = 'N', DEPARTMENT_ID, MAX(IF(PRIMARY_FLAG = 'Y', DEPARTMENT_ID, -1))) AS DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID"
208,Y,Y,"WITH SINGLE_DEPT AS ( SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(EMPLOYEE_ID) = 1 ) SELECT EMPLOYEE_ID, CASE WHEN EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM SINGLE_DEPT) THEN DEPARTMENT_ID WHEN EMPLOYEE_ID NOT IN (SELECT EMPLOYEE_ID FROM SINGLE_DEPT) AND PRIMARY_FLAG = 'Y' THEN DEPARTMENT_ID END AS DEPARTMENT_ID FROM EMPLOYEE WHERE (CASE WHEN EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM SINGLE_DEPT) THEN DEPARTMENT_ID WHEN EMPLOYEE_ID NOT IN (SELECT EMPLOYEE_ID FROM SINGLE_DEPT) AND PRIMARY_FLAG = 'Y' THEN DEPARTMENT_ID END) IS NOT NULL"
209,N,N,"SELECT DISTINCT(EMPLOYEE_ID), DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(PRIMARY_FLAG)=1 UNION SELECT DISTINCT(EMPLOYEE_ID), DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG= 'Y'"
210,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' GROUP BY EMPLOYEE_ID UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(*) =1"
211,N,N,"SELECT DISTINCT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(EMPLOYEE_ID) =1 UNION SELECT DISTINCT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG=1"
212,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(*)=1 UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' GROUP BY EMPLOYEE_ID, DEPARTMENT_ID"
213,N,N,"SELECT EMPLOYEE_ID, CASE WHEN COUNT(DEPARTMENT_ID) = 1 THEN DEPARTMENT_ID WHEN COUNT(DEPARTMENT_ID) > 1 THEN SUM((PRIMARY_FLAG='Y') * DEPARTMENT_ID) END AS DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID"
214,Y,Y,"SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM ( SELECT EMPLOYEE_ID,DEPARTMENT_ID, PRIMARY_FLAG,RANK() OVER(PARTITION BY EMPLOYEE_ID ORDER BY PRIMARY_FLAG ) AS RNK FROM EMPLOYEE )A WHERE RNK = 1"
215,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE E WHERE PRIMARY_FLAG = 'Y' OR (PRIMARY_FLAG = 'N' AND EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(DEPARTMENT_ID) = 1) )"
216,Y,Y,"WITH CTE AS ( SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(DISTINCT DEPARTMENT_ID) = 1) SELECT DISTINCT C.EMPLOYEE_ID, E.DEPARTMENT_ID FROM CTE C INNER JOIN EMPLOYEE E ON C.EMPLOYEE_ID = E.EMPLOYEE_ID UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y'"
217,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(*)=1 UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' GROUP BY EMPLOYEE_ID"
218,Y,Y,"WITH TWOORMORE AS ( SELECT DISTINCT EMPLOYEE_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' ) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE (PRIMARY_FLAG = 'N' AND EMPLOYEE_ID NOT IN (TABLE TWOORMORE)) OR PRIMARY_FLAG = 'Y'"
219,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM ( SELECT EMPLOYEE_ID, DEPARTMENT_ID, ROW_NUMBER() OVER (PARTITION BY EMPLOYEE_ID ORDER BY PRIMARY_FLAG) AS ROW_NUM FROM EMPLOYEE ) T WHERE T.ROW_NUM = 1"
220,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID) = 1) UNION ALL SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID) > 1) AND PRIMARY_FLAG='Y'"
221,N,N,"WITH ONE_DEPT AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(DEPARTMENT_ID) = 1 ), MULTIPLE_DEPT AS ( SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(DEPARTMENT_ID) > 1 ), PRIMARY_MULTIPLE AS ( SELECT E.EMPLOYEE_ID, E.DEPARTMENT_ID FROM EMPLOYEE E JOIN MULTIPLE_DEPT ON E.EMPLOYEE_ID = MULTIPLE_DEPT.EMPLOYEE_ID WHERE E.PRIMARY_FLAG = 'Y' ) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM ONE_DEPT UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM PRIMARY_MULTIPLE"
222,Y,Y,"WITH CTE AS ( SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(*)>1 ) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM CTE) AND PRIMARY_FLAG='Y' UNION ALL SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID NOT IN (SELECT EMPLOYEE_ID FROM CTE) ORDER BY 1"
223,Y,Y,"SELECT DISTINCT EMPLOYEE_ID,DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' UNION SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID IN (SELECT P.EMPLOYEE_ID FROM (SELECT EMPLOYEE_ID, COUNT(EMPLOYEE_ID) FROM EMPLOYEE GROUP BY 1 HAVING COUNT(EMPLOYEE_ID)=1) P)"
224,Y,Y,"SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM ( SELECT *,COUNT(EMPLOYEE_ID) OVER(PARTITION BY EMPLOYEE_ID) AS C FROM EMPLOYEE ) T WHERE C=1 OR PRIMARY_FLAG='Y'"
225,Y,Y,"WITH CTE AS (SELECT EMPLOYEE_ID,COUNT(DEPARTMENT_ID) FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID)=1) SELECT EMPLOYEE_ID , DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y' OR EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM CTE)"
226,Y,Y,"WITH CTE AS (SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y') SELECT DISTINCT(E.EMPLOYEE_ID), CASE WHEN E.EMPLOYEE_ID IN (CTE.EMPLOYEE_ID) THEN CTE.DEPARTMENT_ID ELSE E.DEPARTMENT_ID END AS DEPARTMENT_ID FROM EMPLOYEE E LEFT JOIN CTE CTE ON CTE.EMPLOYEE_ID = E.EMPLOYEE_ID ORDER BY E.EMPLOYEE_ID"
227,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(EMPLOYEE_ID) = 1 ORDER BY 1"
228,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(*) = 1) OR PRIMARY_FLAG ='Y'"
229,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(EMPLOYEE_ID) = 1"
230,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'N' AND EMPLOYEE_ID IN ( SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(*) = 1 )"
231,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM ( SELECT *, COUNT(*) OVER(PARTITION BY EMPLOYEE_ID) AS DPT_NUM FROM EMPLOYEE ) E WHERE (PRIMARY_FLAG = 'Y') OR (PRIMARY_FLAG = 'N' AND DPT_NUM = 1)"
232,N,N,"SELECT EMPLOYEE_ID ,DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y' GROUP BY EMPLOYEE_ID UNION SELECT EMPLOYEE_ID ,DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DISTINCT DEPARTMENT_ID)= 1"
233,Y,Y,"WITH CTE AS (SELECT EMPLOYEE_ID, DEPARTMENT_ID, PRIMARY_FLAG, DENSE_RANK() OVER (PARTITION BY EMPLOYEE_ID ORDER BY PRIMARY_FLAG) AS RNK FROM EMPLOYEE) SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM CTE WHERE RNK = 1"
234,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' UNION SELECT EMPLOYEE_ID, AVG(DEPARTMENT_ID) FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(*) =1"
235,N,N,"(SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(EMPLOYEE_ID) =1) UNION (SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y') ORDER BY EMPLOYEE_ID"
236,Y,Y,"WITH T AS (SELECT EMPLOYEE_ID, DEPARTMENT_ID, PRIMARY_FLAG, RANK() OVER (PARTITION BY EMPLOYEE_ID ORDER BY PRIMARY_FLAG) AS RNK FROM EMPLOYEE) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM T WHERE RNK = 1"
237,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM( SELECT EMPLOYEE_ID, DEPARTMENT_ID, ROW_NUMBER() OVER(PARTITION BY EMPLOYEE_ID ORDER BY PRIMARY_FLAG) RO FROM EMPLOYEE)T WHERE RO=1"
238,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(*) = 1 UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID NOT IN (SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(*) = 1) AND PRIMARY_FLAG = 'Y'"
239,N,N,"(SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y') UNION ALL (SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING SUM(PRIMARY_FLAG = 'Y') = 0)"
240,N,N,"( SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y') UNION (SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID)<2)"
241,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM (SELECT EMPLOYEE_ID, CASE WHEN COUNT(EMPLOYEE_ID) OVER(PARTITION BY EMPLOYEE_ID)=1 THEN DEPARTMENT_ID WHEN PRIMARY_FLAG = 'Y' THEN DEPARTMENT_ID ELSE NULL END AS DEPARTMENT_ID FROM EMPLOYEE) C WHERE DEPARTMENT_ID IS NOT NULL"
242,N,N,"SELECT EMPLOYEE_ID,COALESCE(MAX(IF(PRIMARY_FLAG = 'Y', DEPARTMENT_ID, NULL)), DEPARTMENT_ID) DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID"
243,Y,Y,"SELECT DISTINCT EMPLOYEE_ID ,DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG ='Y' OR EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM (SELECT EMPLOYEE_ID,COUNT(*) AS N_DEP FROM EMPLOYEE GROUP BY EMPLOYEE_ID) AS A WHERE A.N_DEP=1)"
244,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' AND EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DISTINCT DEPARTMENT_ID) > 1) UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM (SELECT * FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DISTINCT DEPARTMENT_ID) = 1) AS TEMP"
245,Y,Y,"SELECT DISTINCT E1.EMPLOYEE_ID, E1.DEPARTMENT_ID FROM EMPLOYEE E1 LEFT JOIN EMPLOYEE E2 ON E1.EMPLOYEE_ID = E2.EMPLOYEE_ID AND E1.DEPARTMENT_ID != E2.DEPARTMENT_ID WHERE E1.PRIMARY_FLAG = 'Y' OR (E2.DEPARTMENT_ID IS NULL)"
246,N,N,"WITH A AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' ), B AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID, COUNT(DEPARTMENT_ID) AS C FROM EMPLOYEE GROUP BY 1 ) SELECT * FROM A UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM B WHERE C = 1"
247,Y,Y,"SELECT DISTINCT E.EMPLOYEE_ID,E.DEPARTMENT_ID FROM EMPLOYEE E LEFT JOIN EMPLOYEE E1 ON E.EMPLOYEE_ID=E1.EMPLOYEE_ID AND E.DEPARTMENT_ID<>E1.DEPARTMENT_ID WHERE E1.EMPLOYEE_ID IS NULL UNION SELECT DISTINCT E.EMPLOYEE_ID,E.DEPARTMENT_ID FROM EMPLOYEE E WHERE E.PRIMARY_FLAG='Y'"
248,Y,Y,"SELECT E.EMPLOYEE_ID, E.DEPARTMENT_ID FROM EMPLOYEE AS E LEFT JOIN (SELECT EMPLOYEE_ID, COUNT(DEPARTMENT_ID) AS NUM_DEP FROM EMPLOYEE GROUP BY EMPLOYEE_ID) AS E2 ON E.EMPLOYEE_ID = E2.EMPLOYEE_ID WHERE E.PRIMARY_FLAG = 'Y' OR E2.NUM_DEP = 1"
249,Y,Y,"(SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' ) UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'N' AND EMPLOYEE_ID NOT IN ((SELECT EMPLOYEE_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' ))"
250,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM (SELECT EMPLOYEE_ID, DEPARTMENT_ID, IF(COUNT(DEPARTMENT_ID) OVER(PARTITION BY EMPLOYEE_ID)=1, 'Y',PRIMARY_FLAG) AS PRIMARY_FLAG FROM EMPLOYEE) A WHERE PRIMARY_FLAG='Y'"
251,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' UNION SELECT EMPLOYEE_ID, MAX(DEPARTMENT_ID) FROM EMPLOYEE GROUP BY 1 HAVING COUNT(*) = 1"
252,Y,N,"SELECT Y.EMPLOYEE_ID AS EMPLOYEE_ID, Y.DEPARTMENT_ID AS DEPARTMENT_ID FROM (SELECT X.EMPLOYEE_ID AS EMPLOYEE_ID, (CASE WHEN X.NUM_DEP = 1 THEN X.DI WHEN X.NUM_DEP > 1 AND X.PRIMARY_FLAG = 'Y' THEN X.DI ELSE 0 END) AS DEPARTMENT_ID FROM (SELECT EMPLOYEE_ID, DEPARTMENT_ID AS DI, PRIMARY_FLAG , COUNT(EMPLOYEE_ID) OVER(PARTITION BY EMPLOYEE_ID) AS NUM_DEP FROM EMPLOYEE) X)Y WHERE Y.DEPARTMENT_ID != 0"
253,Y,Y,"SELECT EMPLOYEE_ID , DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' UNION SELECT EMPLOYEE_ID , DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(EMPLOYEE_ID) = 1)"
254,Y,Y,"SELECT EMPLOYEE_ID, COALESCE(MAX(CASE WHEN PRIMARY_FLAG='Y' THEN DEPARTMENT_ID END),MAX(DEPARTMENT_ID)) AS DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID"
255,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM ( SELECT EMPLOYEE_ID, DEPARTMENT_ID, PRIMARY_FLAG, ROW_NUMBER() OVER (PARTITION BY EMPLOYEE_ID ORDER BY PRIMARY_FLAG) AS RN FROM EMPLOYEE ) K WHERE RN = 1"
256,Y,Y,"SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM ( SELECT EMPLOYEE_ID,DEPARTMENT_ID, ROW_NUMBER() OVER (PARTITION BY EMPLOYEE_ID ORDER BY PRIMARY_FLAG ASC) AS RNK FROM EMPLOYEE) X WHERE X.RNK=1"
257,Y,Y,"WITH CTE AS ( SELECT EMPLOYEE_ID, COUNT(DEPARTMENT_ID) FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID) =1 ) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM CTE)"
258,N,N,"WITH ONEDEPT AS (SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID)=1) SELECT * FROM ONEDEPT UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID NOT IN (SELECT EMPLOYEE_ID FROM ONEDEPT) AND PRIMARY_FLAG = 'Y'"
259,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM( SELECT *, COUNT(PRIMARY_FLAG) OVER (PARTITION BY EMPLOYEE_ID) AS CNT FROM EMPLOYEE ) T WHERE PRIMARY_FLAG = 'Y' OR CNT=1"
260,Y,Y,"WITH CTE1 AS (SELECT *, COUNT(*) OVER(PARTITION BY EMPLOYEE_ID) AS CNT FROM EMPLOYEE), CTE2 AS ( SELECT EMPLOYEE_ID, CASE WHEN CNT=1 THEN DEPARTMENT_ID WHEN CNT>1 AND PRIMARY_FLAG='Y' THEN DEPARTMENT_ID ELSE -1 END AS DEPARTMENT_ID FROM CTE1) SELECT DISTINCT EMPLOYEE_ID, DEPARTMENT_ID FROM CTE2 WHERE DEPARTMENT_ID<> -1"
261,N,N,"WITH CTE1 AS( SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(*) =1), CTE2 AS (SELECT * FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y') SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM CTE1 UNION SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM CTE2"
262,N,N,"WITH MULTI AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' ), SINGLE AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'N' ) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM MULTI UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM SINGLE WHERE EMPLOYEE_ID NOT IN ( SELECT EMPLOYEE_ID FROM MULTI) GROUP BY 1"
263,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(*)=1 UNION SELECT DISTINCT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y'"
264,Y,Y,"WITH TEMP1 AS ( SELECT * FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' ), TEMP2 AS( SELECT * FROM EMPLOYEE WHERE PRIMARY_FLAG = 'N' AND EMPLOYEE_ID NOT IN (SELECT EMPLOYEE_ID FROM TEMP1) ) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM TEMP1 UNION ALL SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM TEMP2"
265,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID NOT IN (SELECT EMPLOYEE_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y') UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y'"
266,Y,Y,"SELECT T.EMPLOYEE_ID, T.DEPARTMENT_ID FROM (SELECT *, COUNT(EMPLOYEE_ID) OVER(PARTITION BY EMPLOYEE_ID) AS C FROM EMPLOYEE) T WHERE T.C = 1 OR T.PRIMARY_FLAG = 'Y'"
267,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG=1 UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(EMPLOYEE_ID)=1"
268,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM ( SELECT *, COUNT(EMPLOYEE_ID) OVER(PARTITION BY EMPLOYEE_ID) C FROM EMPLOYEE ) E WHERE C = 1 OR PRIMARY_FLAG = 'Y'"
269,N,N,"SELECT EMPLOYEE_ID, COALESCE(MAX(CASE WHEN PRIMARY_FLAG = 'Y' THEN DEPARTMENT_ID ELSE NULL END), DEPARTMENT_ID) DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID"
270,Y,Y,"WITH T0 AS( SELECT EMPLOYEE_ID, COUNT(*) AS CNT FROM EMPLOYEE GROUP BY EMPLOYEE_ID) SELECT E.EMPLOYEE_ID, E.DEPARTMENT_ID FROM T0, EMPLOYEE E WHERE T0.EMPLOYEE_ID = E.EMPLOYEE_ID AND CNT = 1 UNION ALL SELECT E.EMPLOYEE_ID, E.DEPARTMENT_ID FROM T0, EMPLOYEE E WHERE T0.EMPLOYEE_ID = E.EMPLOYEE_ID AND T0.CNT != 1 AND E.PRIMARY_FLAG = 'Y'"
271,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM (SELECT *, ROW_NUMBER() OVER(PARTITION BY EMPLOYEE_ID ORDER BY PRIMARY_FLAG) AS NUMCNT FROM EMPLOYEE) AS T1 WHERE NUMCNT=1"
272,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM (SELECT TBL1.EMPLOYEE_ID, COUNT(DEPARTMENT_ID) OVER (PARTITION BY EMPLOYEE_ID) AS DEPT_COUNT, DEPARTMENT_ID, PRIMARY_FLAG FROM EMPLOYEE TBL1 )TBL2 WHERE PRIMARY_FLAG = 'Y' OR DEPT_COUNT = 1"
273,N,N,"SELECT * FROM (SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(*) = 1 ) A ORDER BY 1"
274,Y,Y,"WITH COUNT_TABLE AS ( SELECT EMPLOYEE_ID, COUNT(EMPLOYEE_ID) AS NUM_OF_DEPARTMENT FROM EMPLOYEE GROUP BY EMPLOYEE_ID ), TEMP_TABLE AS ( SELECT EMPLOYEE.EMPLOYEE_ID, EMPLOYEE.DEPARTMENT_ID, EMPLOYEE.PRIMARY_FLAG, COUNT_TABLE.NUM_OF_DEPARTMENT FROM EMPLOYEE LEFT JOIN COUNT_TABLE ON EMPLOYEE.EMPLOYEE_ID = COUNT_TABLE.EMPLOYEE_ID ) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM TEMP_TABLE WHERE PRIMARY_FLAG = 'Y' OR NUM_OF_DEPARTMENT = 1"
275,N,N,"WITH A AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(EMPLOYEE_ID) = 1 ), B AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' ) SELECT * FROM A UNION SELECT * FROM B"
276,Y,Y,"WITH CTE AS (SELECT EMPLOYEE_ID, COUNT(DEPARTMENT_ID)AS NO_OF_DEPTS FROM EMPLOYEE GROUP BY EMPLOYEE_ID) SELECT A.EMPLOYEE_ID,A.DEPARTMENT_ID FROM EMPLOYEE A JOIN CTE B ON A.EMPLOYEE_ID=B.EMPLOYEE_ID WHERE NO_OF_DEPTS > 1 AND PRIMARY_FLAG='Y' UNION SELECT A.EMPLOYEE_ID,A.DEPARTMENT_ID FROM EMPLOYEE A JOIN CTE B ON A.EMPLOYEE_ID=B.EMPLOYEE_ID WHERE NO_OF_DEPTS=1"
277,N,N,"WITH MULTI AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' ), SING AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(EMPLOYEE_ID) = 1 ), AL AS ( SELECT * FROM MULTI UNION ALL SELECT * FROM SING ) SELECT DISTINCT EMPLOYEE_ID, DEPARTMENT_ID FROM AL"
278,Y,Y,"WITH T1 AS ( SELECT EMPLOYEE_ID , DEPARTMENT_ID , PRIMARY_FLAG , ROW_NUMBER() OVER (PARTITION BY EMPLOYEE_ID ORDER BY PRIMARY_FLAG ASC) AS RNK FROM EMPLOYEE ) SELECT EMPLOYEE_ID , DEPARTMENT_ID FROM T1 WHERE RNK = 1"
279,Y,Y,"SELECT EMPLOYEE_ID, COALESCE(MAX(CASE WHEN PRIMARY_FLAG='Y' THEN DEPARTMENT_ID ELSE NULL END),MAX(DEPARTMENT_ID)) DEPARTMENT_ID FROM EMPLOYEE T GROUP BY EMPLOYEE_ID"
280,Y,Y,"(SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID NOT IN (SELECT EMPLOYEE_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y')) UNION SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y'"
281,Y,Y,"SELECT DISTINCT E1.EMPLOYEE_ID AS EMPLOYEE_ID, E1.DEPARTMENT_ID AS DEPARTMENT_ID FROM EMPLOYEE E1 WHERE (E1.PRIMARY_FLAG = 'Y') OR ('Y' NOT IN (SELECT E.PRIMARY_FLAG FROM EMPLOYEE E WHERE E.EMPLOYEE_ID = E1.EMPLOYEE_ID))"
282,Y,Y,"WITH CTE AS (SELECT EMPLOYEE_ID, COUNT(DEPARTMENT_ID) AS CNT FROM EMPLOYEE GROUP BY 1) SELECT E.EMPLOYEE_ID,E.DEPARTMENT_ID FROM EMPLOYEE E JOIN CTE ON E.EMPLOYEE_ID=CTE.EMPLOYEE_ID WHERE CNT=1 UNION SELECT E.EMPLOYEE_ID,E.DEPARTMENT_ID FROM (SELECT * FROM EMPLOYEE WHERE PRIMARY_FLAG='Y') E JOIN CTE ON E.EMPLOYEE_ID=CTE.EMPLOYEE_ID WHERE CNT>1"
283,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(EMPLOYEE_ID) = 1 UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y'"
284,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID)=1 UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' ORDER BY EMPLOYEE_ID"
285,N,N,"SELECT DISTINCT EMPLOYEE_ID, DEPARTMENT_ID FROM( SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(*)=1 UNION ALL SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y') T"
286,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID) = 1) UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y'"
287,Y,Y,"WITH EMP_MULTIPLE_DEP AS ( SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID)>1 ) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM (SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM EMP_MULTIPLE_DEP) AND PRIMARY_FLAG = 'Y' UNION ALL SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID NOT IN (SELECT EMPLOYEE_ID FROM EMP_MULTIPLE_DEP)) TBL"
288,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM ( SELECT EMPLOYEE_ID, DEPARTMENT_ID, ROW_NUMBER () OVER (PARTITION BY EMPLOYEE_ID ORDER BY PRIMARY_FLAG ASC) AS RNK FROM EMPLOYEE ) A WHERE A.RNK = 1"
289,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM (SELECT *, RANK() OVER (PARTITION BY EMPLOYEE_ID ORDER BY PRIMARY_FLAG) AS PRIMARY_ORDER FROM EMPLOYEE) T1 WHERE PRIMARY_ORDER=1"
290,Y,Y,"WITH COUNT_TABLE AS ( SELECT EMPLOYEE_ID, COUNT(EMPLOYEE_ID) AS NUM_OF_DEPARTMENT FROM EMPLOYEE GROUP BY EMPLOYEE_ID ) SELECT EMPLOYEE.EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE LEFT JOIN COUNT_TABLE ON EMPLOYEE.EMPLOYEE_ID = COUNT_TABLE.EMPLOYEE_ID WHERE EMPLOYEE.PRIMARY_FLAG = 'Y' OR COUNT_TABLE.NUM_OF_DEPARTMENT = 1"
291,Y,Y,"WITH CTE1 AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID, PRIMARY_FLAG, COUNT(DEPARTMENT_ID) OVER (PARTITION BY EMPLOYEE_ID) AS NUM_DEPARTMENT FROM EMPLOYEE ) , CTE2 AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID, CASE WHEN NUM_DEPARTMENT = 1 THEN 1 WHEN NUM_DEPARTMENT > 1 AND PRIMARY_FLAG = 'Y' THEN 1 WHEN NUM_DEPARTMENT > 1 AND PRIMARY_FLAG = 'N' THEN 0 END AS FINAL_FLAG FROM CTE1 ) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM CTE2 WHERE FINAL_FLAG = 1"
292,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 1 UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID) = 1"
293,N,N,"(SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID)=1) UNION SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y'"
294,Y,Y,"WITH CTE AS (SELECT EMPLOYEE_ID, DEPARTMENT_ID, RANK() OVER(PARTITION BY EMPLOYEE_ID ORDER BY PRIMARY_FLAG) AS RNK FROM EMPLOYEE) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM CTE WHERE RNK = 1"
295,Y,Y,"WITH PRIMARY_RANK AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID, PRIMARY_FLAG, RANK() OVER ( PARTITION BY EMPLOYEE_ID ORDER BY PRIMARY_FLAG ASC ) PRIMARY_RANK FROM EMPLOYEE ) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM PRIMARY_RANK WHERE PRIMARY_RANK = 1"
296,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE (EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID) > 1) AND PRIMARY_FLAG = 'Y') OR EMPLOYEE_ID NOT IN (SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID) > 1)"
297,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.DEPARTMENT_ID FROM EMPLOYEE E1 WHERE PRIMARY_FLAG = 'Y' UNION SELECT E2.EMPLOYEE_ID, MIN(E2.DEPARTMENT_ID) FROM EMPLOYEE E2 GROUP BY E2.EMPLOYEE_ID HAVING COUNT(E2.DEPARTMENT_ID) =1"
298,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' OR EMPLOYEE_ID IN ( SELECT EMPLOYEE_ID FROM ( SELECT * FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(*) = 1 ) T1 )"
299,N,N,"SELECT A.EMPLOYEE_ID,B.DEPARTMENT_ID FROM EMPLOYEE A LEFT JOIN (SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG ='Y') AS B ON A.EMPLOYEE_ID = B.EMPLOYEE_ID GROUP BY 1 HAVING COUNT(PRIMARY_FLAG) > 1 UNION ALL SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(PRIMARY_FLAG) = 1"
300,Y,Y,"WITH T AS ( SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(*) = 1 ) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' OR EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM T)"
301,Y,Y,"WITH TMP AS (SELECT *, RANK() OVER (PARTITION BY EMPLOYEE_ID ORDER BY PRIMARY_FLAG ) RK FROM EMPLOYEE) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM TMP WHERE RK = 1"
302,Y,Y,"SELECT EMPLOYEE_ID ,DEPARTMENT_ID FROM (SELECT *, COUNT(PRIMARY_FLAG ) OVER(PARTITION BY EMPLOYEE_ID) AS C FROM EMPLOYEE) A WHERE C = 1 OR PRIMARY_FLAG ='Y'"
303,Y,Y,"WITH NUM_DEPARTMENT AS ( SELECT EMPLOYEE_ID, COUNT(*) AS N_DEPT FROM EMPLOYEE GROUP BY EMPLOYEE_ID) SELECT EMPLOYEE.EMPLOYEE_ID AS EMPLOYEE_ID , EMPLOYEE.DEPARTMENT_ID AS DEPARTMENT_ID FROM EMPLOYEE LEFT JOIN NUM_DEPARTMENT ON EMPLOYEE.EMPLOYEE_ID = NUM_DEPARTMENT.EMPLOYEE_ID WHERE NUM_DEPARTMENT.N_DEPT = 1 OR EMPLOYEE.PRIMARY_FLAG = 'Y'"
304,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM (SELECT EMPLOYEE_ID, DEPARTMENT_ID, ROW_NUMBER() OVER(PARTITION BY EMPLOYEE_ID ORDER BY PRIMARY_FLAG ASC) AS NUM FROM EMPLOYEE)SUB WHERE NUM =1"
305,Y,Y,"WITH CTE AS (SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y') SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'N' AND EMPLOYEE_ID NOT IN (SELECT EMPLOYEE_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y') UNION ALL SELECT * FROM CTE"
306,Y,Y,"WITH MULTIPLE_DEPT_PRIMARY AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' ) SELECT * FROM MULTIPLE_DEPT_PRIMARY UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'N' AND EMPLOYEE_ID NOT IN (SELECT EMPLOYEE_ID FROM MULTIPLE_DEPT_PRIMARY)"
307,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM (SELECT *, COUNT(EMPLOYEE_ID) OVER (PARTITION BY EMPLOYEE_ID) AS C FROM EMPLOYEE) AS T WHERE C = 1 OR PRIMARY_FLAG = 'Y'"
308,Y,Y,"SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM (SELECT * ,COUNT(EMPLOYEE_ID) OVER(PARTITION BY EMPLOYEE_ID) AS TOTAL FROM EMPLOYEE) AS T WHERE TOTAL = 1 OR PRIMARY_FLAG = 'Y'"
309,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' GROUP BY 1 UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(DEPARTMENT_ID) = 1"
310,Y,Y,"(SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y') UNION ALL (SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID NOT IN (SELECT EMPLOYEE_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y'))"
311,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING(COUNT(EMPLOYEE_ID) = 1)"
312,N,N,"WITH T1 AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID) = 1 ), T2 AS ( SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID) > 1 ), T3 AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID IN (SELECT * FROM T2) AND PRIMARY_FLAG = 'Y' ) SELECT * FROM T1 FULL UNION SELECT * FROM T3"
313,Y,Y,"SELECT EMPLOYEE_ID,MAX(DEPARTMENT_ID) AS DEPARTMENT_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(*) = 1 UNION SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y'"
314,N,N,"SELECT E1.EMPLOYEE_ID, IFNULL(TEMP.DEPARTMENT_ID, E1.DEPARTMENT_ID) AS DEPARTMENT_ID FROM EMPLOYEE E1 LEFT JOIN (SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y') TEMP ON E1.EMPLOYEE_ID = TEMP.EMPLOYEE_ID GROUP BY 1"
315,Y,Y,"WITH A AS (SELECT EMPLOYEE_ID, COUNT(DEPARTMENT_ID) AS CNT FROM EMPLOYEE GROUP BY 1 HAVING CNT=1) SELECT E.EMPLOYEE_ID,E.DEPARTMENT_ID FROM EMPLOYEE E JOIN A ON E.EMPLOYEE_ID=A.EMPLOYEE_ID UNION SELECT E.EMPLOYEE_ID,E.DEPARTMENT_ID FROM EMPLOYEE E WHERE E.PRIMARY_FLAG = 'Y'"
316,Y,Y,"WITH CTE AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID, PRIMARY_FLAG, COUNT(DEPARTMENT_ID) OVER(PARTITION BY EMPLOYEE_ID) AS C1 FROM EMPLOYEE ) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM CTE WHERE PRIMARY_FLAG = 'Y' OR C1 = 1"
317,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID)=1) OR PRIMARY_FLAG = 'Y' GROUP BY EMPLOYEE_ID"
318,Y,Y,"SELECT E.EMPLOYEE_ID, E.DEPARTMENT_ID FROM ( SELECT EMPLOYEE_ID, DEPARTMENT_ID, PRIMARY_FLAG, RANK() OVER (PARTITION BY EMPLOYEE_ID ORDER BY PRIMARY_FLAG ASC) AS RNK FROM EMPLOYEE ) E WHERE E.RNK = 1"
319,N,N,"WITH T1 AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID) = 1 ) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM T1 UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID NOT IN (SELECT EMPLOYEE_ID FROM T1) AND PRIMARY_FLAG = 'Y'"
320,Y,Y,"SELECT EMPLOYEE_ID, COALESCE(MAX(CASE WHEN PRIMARY_FLAG = 'Y' THEN DEPARTMENT_ID ELSE NULL END), MAX(DEPARTMENT_ID)) DEPARTMENT_ID FROM EMPLOYEE GROUP BY 1"
321,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' GROUP BY EMPLOYEE_ID UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(PRIMARY_FLAG) = 1"
322,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y' OR (EMPLOYEE_ID, DEPARTMENT_ID) IN ( SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID)=1 )"
323,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' OR EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM(SELECT EMPLOYEE_ID, COUNT(*) FROM EMPLOYEE GROUP BY 1 HAVING COUNT(*) = 1)A)"
324,Y,Y,"WITH TMP AS ( SELECT *, COUNT(DEPARTMENT_ID) OVER (PARTITION BY EMPLOYEE_ID) AS DEPARTMENT_COUNT FROM EMPLOYEE ) ,TMP2 AS ( SELECT EMPLOYEE_ID, CASE WHEN PRIMARY_FLAG = 'N' AND DEPARTMENT_COUNT = 1 THEN DEPARTMENT_ID WHEN PRIMARY_FLAG = 'Y' THEN DEPARTMENT_ID ELSE NULL END AS DEPARTMENT_ID FROM TMP ) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM TMP2 WHERE DEPARTMENT_ID IS NOT NULL"
325,N,N,"SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID IN( SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(PRIMARY_FLAG)>1) AND PRIMARY_FLAG = 'Y' UNION ALL SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(PRIMARY_FLAG) = 1"
326,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM (SELECT EMPLOYEE_ID, DEPARTMENT_ID, PRIMARY_FLAG, COUNT(1)OVER(PARTITION BY EMPLOYEE_ID) AS CNT FROM EMPLOYEE) AS TEMP WHERE PRIMARY_FLAG='Y' OR CNT = 1"
327,Y,Y,"WITH CTE AS (SELECT EMPLOYEE_ID, COUNT(DEPARTMENT_ID) AS COUNT_DEPT FROM EMPLOYEE GROUP BY EMPLOYEE_ID) SELECT E.EMPLOYEE_ID, E.DEPARTMENT_ID FROM EMPLOYEE E JOIN CTE ON E.EMPLOYEE_ID = CTE.EMPLOYEE_ID WHERE COUNT_DEPT = 1 UNION SELECT E.EMPLOYEE_ID, E.DEPARTMENT_ID FROM EMPLOYEE E JOIN CTE ON E.EMPLOYEE_ID = CTE.EMPLOYEE_ID WHERE COUNT_DEPT > 1 AND E.PRIMARY_FLAG = 'Y'"
328,N,N,"WITH MORE_THAN_ONE AS (SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG ='Y') , UNI AS(SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(DEPARTMENT_ID)=1 ) SELECT * FROM UNI UNION (SELECT * FROM MORE_THAN_ONE) ORDER BY EMPLOYEE_ID"
329,Y,Y,"WITH RNK_PRIMARY_DEPARTMENT AS ( SELECT *,ROW_NUMBER() OVER (PARTITION BY EMPLOYEE_ID ORDER BY PRIMARY_FLAG) AS PRIMARY_DEPT_RNK FROM EMPLOYEE ) SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM RNK_PRIMARY_DEPARTMENT WHERE PRIMARY_DEPT_RNK = 1"
330,Y,Y,"WITH CTE AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' ), CTE2 AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'N' AND EMPLOYEE_ID NOT IN (SELECT EMPLOYEE_ID FROM CTE) ) SELECT * FROM CTE UNION ALL SELECT * FROM CTE2"
331,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID) = 1 UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' GROUP BY EMPLOYEE_ID"
332,N,N,"SELECT DISTINCT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(EMPLOYEE_ID) = 1 UNION SELECT DISTINCT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y'"
333,Y,Y,"WITH T1 AS(SELECT EMPLOYEE_ID, COUNT(*) AS C FROM EMPLOYEE GROUP BY EMPLOYEE_ID), T2 AS(SELECT E.*, C FROM EMPLOYEE AS E LEFT JOIN T1 USING(EMPLOYEE_ID)) SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM T2 WHERE C=1 OR PRIMARY_FLAG='Y'"
334,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' GROUP BY EMPLOYEE_ID UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(*) = 1 ORDER BY EMPLOYEE_ID"
335,N,N,"WITH TMP AS( SELECT EMPLOYEE_ID, DEPARTMENT_ID, PRIMARY_FLAG, COUNT(*) CNT FROM EMPLOYEE GROUP BY EMPLOYEE_ID ) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y' OR EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM TMP WHERE CNT = 1)"
336,Y,Y,"WITH CTE AS (SELECT EMPLOYEE_ID, COUNT(DEPARTMENT_ID) AS CNT FROM EMPLOYEE GROUP BY 1) SELECT E.EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE E JOIN CTE C ON E.EMPLOYEE_ID=C.EMPLOYEE_ID WHERE E.PRIMARY_FLAG='Y' OR C.CNT=1"
337,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM (SELECT DISTINCT EMPLOYEE_ID, CASE WHEN DEPT_COUNT = 1 THEN DEPARTMENT_ID WHEN PRIMARY_FLAG = 'Y' THEN DEPARTMENT_ID END AS DEPARTMENT_ID FROM (SELECT TBL1.EMPLOYEE_ID, COUNT(DEPARTMENT_ID) OVER (PARTITION BY EMPLOYEE_ID) AS DEPT_COUNT, DEPARTMENT_ID, PRIMARY_FLAG FROM EMPLOYEE TBL1 )TBL2 ) TBL3 WHERE DEPARTMENT_ID IS NOT NULL"
338,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID IN ( SELECT DISTINCT(EMPLOYEE_ID) FROM EMPLOYEE WHERE EMPLOYEE_ID NOT IN (SELECT DISTINCT(EMPLOYEE_ID) FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y'))"
339,N,N,"SELECT EMPLOYEE_ID ,DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' UNION SELECT EMPLOYEE_ID ,DEPARTMENT_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(DISTINCT DEPARTMENT_ID) = 1"
340,Y,Y,"WITH CTE AS (SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y') SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM CTE UNION ALL SELECT DISTINCT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID NOT IN (SELECT EMPLOYEE_ID FROM CTE)"
341,Y,Y,"WITH CTE AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID, PRIMARY_FLAG, ROW_NUMBER() OVER(PARTITION BY EMPLOYEE_ID ORDER BY PRIMARY_FLAG) AS RNK FROM EMPLOYEE ) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM CTE WHERE RNK=1"
342,Y,N,"WITH CTE AS(SELECT DISTINCT(EMPLOYEE_ID), CASE WHEN COUNT(DEPARTMENT_ID)OVER(PARTITION BY EMPLOYEE_ID)>1 AND PRIMARY_FLAG = 'Y' THEN DEPARTMENT_ID WHEN COUNT(DEPARTMENT_ID)OVER(PARTITION BY EMPLOYEE_ID)= 1 THEN DEPARTMENT_ID ELSE 0 END AS DEPARTMENT_ID FROM EMPLOYEE) SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM CTE WHERE DEPARTMENT_ID != 0"
343,Y,Y,"SELECT * FROM (SELECT EMPLOYEE_ID, CASE WHEN CNTS=1 THEN DEPARTMENT_ID WHEN CNTS>1 AND PRIMARY_FLAG='Y' THEN DEPARTMENT_ID END AS DEPARTMENT_ID FROM (SELECT EMPLOYEE_ID, DEPARTMENT_ID, PRIMARY_FLAG, COUNT(DEPARTMENT_ID) OVER (PARTITION BY EMPLOYEE_ID) AS CNTS FROM EMPLOYEE)A)B WHERE DEPARTMENT_ID IS NOT NULL"
344,Y,Y,"WITH CTE AS ( SELECT EMPLOYEE_ID, MAX(PRIMARY_FLAG) AS PRIMARY_FLAG FROM EMPLOYEE GROUP BY EMPLOYEE_ID) SELECT EMP.EMPLOYEE_ID, EMP.DEPARTMENT_ID FROM CTE JOIN EMPLOYEE EMP ON CTE.PRIMARY_FLAG = EMP.PRIMARY_FLAG AND CTE.EMPLOYEE_ID = EMP.EMPLOYEE_ID"
345,Y,Y,"SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' OR EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(*)=1) ORDER BY 1"
346,Y,Y,"SELECT DISTINCT E1.EMPLOYEE_ID AS EMPLOYEE_ID, E2.DEPARTMENT_ID AS DEPARTMENT_ID FROM EMPLOYEE E1 INNER JOIN EMPLOYEE E2 ON E2.EMPLOYEE_ID = E1.EMPLOYEE_ID WHERE (E2.PRIMARY_FLAG = 'Y') OR ('Y' NOT IN (SELECT E.PRIMARY_FLAG FROM EMPLOYEE E WHERE E.EMPLOYEE_ID = E1.EMPLOYEE_ID))"
347,Y,Y,"SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM ( SELECT EMPLOYEE_ID,DEPARTMENT_ID, ROW_NUMBER() OVER (PARTITION BY EMPLOYEE_ID ORDER BY PRIMARY_FLAG ) AS RNK FROM EMPLOYEE) X WHERE X.RNK=1"
348,Y,Y,"WITH PRIMARY_FLAG AS ( SELECT EMPLOYEE_ID , DEPARTMENT_ID , PRIMARY_FLAG , RANK() OVER (PARTITION BY EMPLOYEE_ID ORDER BY PRIMARY_FLAG) AS RNK FROM EMPLOYEE) SELECT EMPLOYEE_ID , DEPARTMENT_ID FROM PRIMARY_FLAG P WHERE P.RNK=1"
349,N,N,"WITH CTE AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID) = 1 ), CTE2 AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' ) SELECT * FROM CTE UNION SELECT * FROM CTE2"
350,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM ( SELECT *, COUNT(DEPARTMENT_ID) OVER(PARTITION BY EMPLOYEE_ID) AS CNT FROM EMPLOYEE ) T WHERE (PRIMARY_FLAG = 'Y') OR (CNT = 1 AND PRIMARY_FLAG = 'N')"
351,Y,Y,"WITH CTE AS (SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y' ) SELECT * FROM CTE UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID NOT IN (SELECT EMPLOYEE_ID FROM CTE) AND PRIMARY_FLAG='N'"
352,Y,Y,"SELECT EMPLOYEE.EMPLOYEE_ID,EMPLOYEE.DEPARTMENT_ID FROM EMPLOYEE JOIN ( SELECT EMPLOYEE_ID,COUNT(DEPARTMENT_ID) AS COUNT_DEP FROM EMPLOYEE GROUP BY EMPLOYEE_ID ) A ON EMPLOYEE.EMPLOYEE_ID=A.EMPLOYEE_ID WHERE A.COUNT_DEP=1 OR (A.COUNT_DEP>1 AND EMPLOYEE.PRIMARY_FLAG='Y')"
353,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(EMPLOYEE_ID) = 1 UNION (SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y')"
354,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID IN ( SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(DEPARTMENT_ID)=1 )"
355,Y,Y,"SELECT EMPLOYEE_ID, IFNULL(MAX(CASE WHEN PRIMARY_FLAG = 'Y' THEN DEPARTMENT_ID ELSE NULL END), MIN(DEPARTMENT_ID)) AS DEPARTMENT_ID FROM EMPLOYEE GROUP BY 1"
356,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' OR EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(DEPARTMENT_ID) = 1) GROUP BY 1, 2"
357,Y,Y,"WITH ALT AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID, ROW_NUMBER() OVER (PARTITION BY EMPLOYEE_ID ORDER BY IF(PRIMARY_FLAG='Y',0,1)) AS ROW_NUM FROM EMPLOYEE ) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM ALT WHERE ROW_NUM = 1"
358,N,N,"SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y' UNION SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM (SELECT EMPLOYEE_ID,DEPARTMENT_ID,COUNT(DEPARTMENT_ID) AS CNT FROM EMPLOYEE GROUP BY EMPLOYEE_ID) A WHERE A.CNT=1"
359,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM ( SELECT *, COUNT(DEPARTMENT_ID) OVER(PARTITION BY EMPLOYEE_ID) CNT FROM EMPLOYEE ) T WHERE CNT=1 OR PRIMARY_FLAG='Y'"
360,Y,Y,"(SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID NOT IN (SELECT EMPLOYEE_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y') ) UNION ALL (SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y')"
361,N,N,"WITH T1 AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID, COUNT(DEPARTMENT_ID) AS CT FROM EMPLOYEE GROUP BY 1 HAVING CT=1 ) ( SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' ) UNION ( SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM T1 )"
362,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM (SELECT *, ROW_NUMBER() OVER (PARTITION BY EMPLOYEE_ID ORDER BY PRIMARY_FLAG) AS ROW_NUM FROM EMPLOYEE) AS SUB_TABLE WHERE ROW_NUM=1"
363,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE ( PRIMARY_FLAG = 'Y' OR EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DEPARTMENT_ID) = 1) )"
364,Y,Y,"SELECT DISTINCT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(EMPLOYEE_ID)=1) OR PRIMARY_FLAG='Y' ORDER BY EMPLOYEE_ID"
365,N,N,"SELECT * FROM (SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' GROUP BY EMPLOYEE_ID UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(*) = 1 ) C ORDER BY EMPLOYEE_ID"
366,N,N,"SELECT E.EMPLOYEE_ID, E.DEPARTMENT_ID FROM EMPLOYEE E WHERE E.PRIMARY_FLAG = 'Y' UNION SELECT E.EMPLOYEE_ID, E.DEPARTMENT_ID FROM EMPLOYEE E GROUP BY 1 HAVING COUNT(E.DEPARTMENT_ID) = 1"
367,Y,Y,"WITH C1 AS ( SELECT *, COUNT(DEPARTMENT_ID) OVER(PARTITION BY EMPLOYEE_ID) AS NUM_DEPARTMENTS FROM EMPLOYEE ) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM C1 WHERE NUM_DEPARTMENTS = 1 OR PRIMARY_FLAG = 'Y'"
368,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' OR EMPLOYEE_ID IN ( SELECT EMPLOYEE_ID AS CC FROM EMPLOYEE GROUP BY 1 HAVING COUNT(*) = 1 )"
369,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM ( SELECT *, COUNT(*) OVER (PARTITION BY EMPLOYEE_ID) AS DEP_COUNT_FOR_EMPL FROM EMPLOYEE ) AS INTERM WHERE NOT ((DEP_COUNT_FOR_EMPL>1 ) AND (PRIMARY_FLAG = 'N'))"
370,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG='Y' UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(*)=1) ORDER BY EMPLOYEE_ID"
371,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' OR (EMPLOYEE_ID NOT IN (SELECT EMPLOYEE_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y'))"
372,N,N,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM ( SELECT EMPLOYEE_ID, DEPARTMENT_ID, ROW_NUMBER() OVER(PARTITION BY EMPLOYEE_ID ORDER BY PRIMARY_FLAG) RNK FROM EMPLOYEE GROUP BY EMPLOYEE_ID, DEPARTMENT_ID) X WHERE X.RNK = 1"
373,N,N,"( SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' ) UNION ( SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(PRIMARY_FLAG) =1 )"
374,Y,Y,"WITH CTE AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID, COUNT(DEPARTMENT_ID)OVER(PARTITION BY EMPLOYEE_ID) AS D_COUNT FROM EMPLOYEE ) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM CTE WHERE D_COUNT = 1 UNION SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y'"
375,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID IN ( SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(*)>1 ) AND PRIMARY_FLAG = 'Y' UNION ALL SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID IN (SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(*)=1 ) ORDER BY 1"
376,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.DEPARTMENT_ID FROM EMPLOYEE E1 JOIN (SELECT EMPLOYEE_ID, COUNT(DISTINCT(DEPARTMENT_ID)) AS CNT FROM EMPLOYEE GROUP BY EMPLOYEE_ID) E2 ON E1.EMPLOYEE_ID=E2.EMPLOYEE_ID WHERE E1.PRIMARY_FLAG='Y' OR E2.CNT=1"
377,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM ( SELECT EMPLOYEE_ID, DEPARTMENT_ID, RANK() OVER (PARTITION BY EMPLOYEE_ID ORDER BY PRIMARY_FLAG ASC) AS PRIMARY_RANKING FROM EMPLOYEE) SQ WHERE PRIMARY_RANKING = 1"
378,N,N,"(SELECT E.EMPLOYEE_ID, E.DEPARTMENT_ID FROM EMPLOYEE E WHERE E.PRIMARY_FLAG = 'Y') UNION (SELECT E1.EMPLOYEE_ID, E1.DEPARTMENT_ID FROM EMPLOYEE E1 GROUP BY EMPLOYEE_ID HAVING COUNT(EMPLOYEE_ID) = 1)"
379,Y,Y,"WITH CTE AS ( SELECT EMPLOYEE_ID , DEPARTMENT_ID , ROW_NUMBER() OVER(PARTITION BY EMPLOYEE_ID ORDER BY PRIMARY_FLAG) AS R FROM EMPLOYEE ) SELECT EMPLOYEE_ID , DEPARTMENT_ID FROM CTE WHERE R = 1"
380,N,N,"WITH CTE1 AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' ), CTE2 AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(EMPLOYEE_ID) = 1 ) SELECT * FROM CTE1 UNION SELECT * FROM CTE2"
381,Y,Y,"WITH T1 AS ( SELECT * , COUNT(*) OVER (PARTITION BY EMPLOYEE_ID) AS DEPT_NUM FROM EMPLOYEE ) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM T1 WHERE DEPT_NUM = 1 OR PRIMARY_FLAG = 'Y'"
382,Y,Y,"WITH EMPLOYEEDEPARTMENTS AS ( SELECT EMPLOYEE_ID ,COUNT(DISTINCT DEPARTMENT_ID) AS TOTALDEPARTMENTS FROM EMPLOYEE A GROUP BY EMPLOYEE_ID ) SELECT A.EMPLOYEE_ID, A.DEPARTMENT_ID FROM EMPLOYEE A INNER JOIN EMPLOYEEDEPARTMENTS B ON A.EMPLOYEE_ID = B.EMPLOYEE_ID WHERE (B.TOTALDEPARTMENTS = 1) OR (B.TOTALDEPARTMENTS > 1 AND A.PRIMARY_FLAG = 'Y') GROUP BY A.EMPLOYEE_ID, A.DEPARTMENT_ID"
383,N,N,"SELECT EMPLOYEE_ID, IFNULL(MAX(CASE WHEN PRIMARY_FLAG = 'Y' THEN DEPARTMENT_ID ELSE NULL END), DEPARTMENT_ID) AS DEPARTMENT_ID FROM EMPLOYEE GROUP BY 1"
384,Y,Y,"SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' UNION SELECT EMPLOYEE_ID,DEPARTMENT_ID FROM EMPLOYEE WHERE EMPLOYEE_ID IN ( SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(1)=1)"
385,Y,Y,"SELECT DISTINCT EMPLOYEE_ID ,DEPARTMENT_ID FROM ( SELECT EMPLOYEE_ID , FIRST_VALUE( DEPARTMENT_ID) OVER ( PARTITION BY EMPLOYEE_ID ORDER BY PRIMARY_FLAG ) AS DEPARTMENT_ID FROM EMPLOYEE ) U"
386,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM( SELECT EMPLOYEE_ID, DEPARTMENT_ID, ROW_NUMBER() OVER(PARTITION BY EMPLOYEE_ID ORDER BY PRIMARY_FLAG ASC) RID FROM EMPLOYEE )X WHERE RID =1"
387,Y,Y,"WITH CTE AS ( SELECT EMPLOYEE_ID, DEPARTMENT_ID, PRIMARY_FLAG, ROW_NUMBER() OVER(PARTITION BY EMPLOYEE_ID ORDER BY PRIMARY_FLAG ASC) AS RN FROM EMPLOYEE) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM CTE WHERE RN = 1"
388,Y,Y,"WITH EMPLOYEE_WITH_ONE_DEPART AS ( SELECT EMPLOYEE_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(DISTINCT DEPARTMENT_ID) = 1 ) SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' OR EMPLOYEE_ID IN (SELECT*FROM EMPLOYEE_WITH_ONE_DEPART)"
389,Y,Y,"SELECT EMPLOYEE_ID , MAX(DEPARTMENT_ID) AS DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(PRIMARY_FLAG) = 1 UNION ALL SELECT EMPLOYEE_ID , MAX(CASE WHEN PRIMARY_FLAG = 'Y' THEN DEPARTMENT_ID END) AS DEPARTMENT_ID FROM EMPLOYEE GROUP BY EMPLOYEE_ID HAVING COUNT(PRIMARY_FLAG) >1"
390,Y,Y,"SELECT DISTINCT EMPLOYEE_ID ,DEPARTMENT_ID FROM ( SELECT DISTINCT EMPLOYEE_ID ,DEPARTMENT_ID ,PRIMARY_FLAG ,COUNT(DEPARTMENT_ID) OVER(PARTITION BY EMPLOYEE_ID) ,CASE WHEN COUNT(DEPARTMENT_ID) OVER(PARTITION BY EMPLOYEE_ID) > 1 AND PRIMARY_FLAG = 'Y' THEN DEPARTMENT_ID WHEN COUNT(DEPARTMENT_ID) OVER(PARTITION BY EMPLOYEE_ID) = 1 THEN DEPARTMENT_ID END AS CATEGORY FROM EMPLOYEE ) AS TEMP WHERE CATEGORY IS NOT NULL"
391,Y,Y,"SELECT A.EMPLOYEE_ID, A.DEPARTMENT_ID FROM ( SELECT*, COUNT(DEPARTMENT_ID) OVER (PARTITION BY EMPLOYEE_ID) AS COUNT_TOTAL FROM EMPLOYEE ) A WHERE A.COUNT_TOTAL= 1 OR A.PRIMARY_FLAG = 'Y'"
392,Y,Y,"SELECT E1.EMPLOYEE_ID, E1.DEPARTMENT_ID FROM EMPLOYEE E1 WHERE E1.PRIMARY_FLAG = 'Y' OR E1.EMPLOYEE_ID IN ( SELECT E2.EMPLOYEE_ID FROM EMPLOYEE E2 GROUP BY 1 HAVING COUNT(*) = 1)"
393,N,N,"( SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE WHERE PRIMARY_FLAG = 'Y' ) UNION ( SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM EMPLOYEE GROUP BY 1 HAVING COUNT(DEPARTMENT_ID) = 1 )"
394,Y,Y,"WITH EMP AS (SELECT EMPLOYEE_ID, COUNT(DEPARTMENT_ID) AS DEPT_COUNT FROM EMPLOYEE GROUP BY EMPLOYEE_ID) SELECT E.EMPLOYEE_ID,E.DEPARTMENT_ID FROM EMPLOYEE E JOIN EMP E1 ON E.EMPLOYEE_ID = E1.EMPLOYEE_ID WHERE (DEPT_COUNT = 1) OR (DEPT_COUNT >1 AND PRIMARY_FLAG = 1)"
395,Y,Y,"SELECT EMPLOYEE_ID, DEPARTMENT_ID FROM (SELECT EMPLOYEE_ID, DEPARTMENT_ID, PRIMARY_FLAG, COUNT(DEPARTMENT_ID) OVER (PARTITION BY EMPLOYEE_ID) AS NUM FROM EMPLOYEE ) AS EMP_NUM WHERE PRIMARY_FLAG='Y' OR (PRIMARY_FLAG='N' AND NUM = 1)"
