qid,mysql_can_execute?,mysql_correct?,mysql_query
0,Y,Y,SELECT * FROM CUSTOMERS WHERE CUSTOMER_ID IN ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A' ) AND CUSTOMER_ID IN ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B' ) AND CUSTOMER_ID NOT IN ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C' )
1,Y,Y,SELECT * FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')
2,Y,Y,SELECT * FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') ORDER BY CUSTOMER_ID
3,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS AS C LEFT JOIN ORDERS AS O ON C.CUSTOMER_ID = O.CUSTOMER_ID GROUP BY C.CUSTOMER_ID HAVING SUM( O.PRODUCT_NAME = 'A' ) > 0 AND SUM( O.PRODUCT_NAME = 'B' ) > 0 AND SUM( O.PRODUCT_NAME = 'C' ) = 0 ORDER BY C.CUSTOMER_ID"
4,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C, ORDERS O WHERE C.CUSTOMER_ID = O.CUSTOMER_ID GROUP BY 1 HAVING SUM(O.PRODUCT_NAME = 'A') > 0 AND SUM(O.PRODUCT_NAME = 'B') > 0 AND SUM(O.PRODUCT_NAME ='C') =0"
5,Y,Y,"SELECT DISTINCT C.CUSTOMER_ID AS CUSTOMER_ID ,C.CUSTOMER_NAME AS CUSTOMER_NAME FROM CUSTOMERS C INNER JOIN ORDERS O ON C.CUSTOMER_ID=O.CUSTOMER_ID WHERE C.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='C') AND C.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='A') AND C.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='B')"
6,Y,Y,"SELECT DISTINCT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID GROUP BY C.CUSTOMER_ID HAVING SUM(PRODUCT_NAME = 'A') > 0 AND SUM(PRODUCT_NAME = 'B') > 0 AND SUM(PRODUCT_NAME = 'C') = 0"
7,Y,Y,"SELECT DISTINCT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE C.CUSTOMER_ID IN (SELECT D.CUSTOMER_ID FROM CUSTOMERS D JOIN ORDERS E ON D.CUSTOMER_ID = E.CUSTOMER_ID WHERE E.PRODUCT_NAME= 'A') AND C.CUSTOMER_ID IN (SELECT D.CUSTOMER_ID FROM CUSTOMERS D JOIN ORDERS E ON D.CUSTOMER_ID = E.CUSTOMER_ID WHERE E.PRODUCT_NAME= 'B') AND C.CUSTOMER_ID NOT IN (SELECT D.CUSTOMER_ID FROM CUSTOMERS D JOIN ORDERS E ON D.CUSTOMER_ID = E.CUSTOMER_ID WHERE E.PRODUCT_NAME= 'C') ORDER BY C.CUSTOMER_ID"
8,Y,Y,"SELECT DISTINCT CUSTOMERS.CUSTOMER_ID, CUSTOMERS.CUSTOMER_NAME FROM ORDERS JOIN CUSTOMERS ON ORDERS.CUSTOMER_ID = CUSTOMERS.CUSTOMER_ID WHERE CUSTOMERS.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND CUSTOMERS.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND CUSTOMERS.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')"
9,Y,Y,"SELECT DISTINCT CUSTOMERS.CUSTOMER_ID, CUSTOMERS.CUSTOMER_NAME FROM ORDERS LEFT JOIN CUSTOMERS ON ORDERS.CUSTOMER_ID = CUSTOMERS.CUSTOMER_ID WHERE CUSTOMERS.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A' ) AND CUSTOMERS.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND CUSTOMERS.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')"
10,Y,Y,"SELECT DISTINCT A.CUSTOMER_ID, C.CUSTOMER_NAME FROM (SELECT O1.CUSTOMER_ID FROM ORDERS O1 WHERE O1.PRODUCT_NAME = 'A') A JOIN (SELECT O2.CUSTOMER_ID FROM ORDERS O2 WHERE O2.PRODUCT_NAME = 'B') B ON A.CUSTOMER_ID = B.CUSTOMER_ID JOIN CUSTOMERS C ON A.CUSTOMER_ID = C.CUSTOMER_ID WHERE A.CUSTOMER_ID NOT IN (SELECT O3.CUSTOMER_ID FROM ORDERS O3 WHERE O3.PRODUCT_NAME = 'C')"
11,Y,Y,"SELECT DISTINCT B.CUSTOMER_ID, B.CUSTOMER_NAME FROM ORDERS A JOIN CUSTOMERS B ON A.CUSTOMER_ID = B.CUSTOMER_ID WHERE A.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') AND A.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND A.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B')"
12,Y,Y,"SELECT DISTINCT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='A' ) AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='B' ) AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='C' )"
13,Y,Y,"SELECT DISTINCT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS AS C INNER JOIN ORDERS AS O ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE PRODUCT_NAME = 'A' AND C.CUSTOMER_ID IN (SELECT O.CUSTOMER_ID FROM ORDERS AS O WHERE PRODUCT_NAME = 'B') AND C.CUSTOMER_ID NOT IN (SELECT O.CUSTOMER_ID FROM ORDERS AS O WHERE PRODUCT_NAME = 'C')"
14,Y,Y,"SELECT DISTINCT C.CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS C WHERE C.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND C.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND C.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')"
15,Y,Y,"SELECT DISTINCT C.CUSTOMER_ID, CUSTOMER_NAME FROM ORDERS O LEFT JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID WHERE C.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') AND C.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND C.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B')"
16,Y,Y,"SELECT DISTINCT CUSTOMER_ID , CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')"
17,Y,Y,"SELECT DISTINCT CUSTOMER_ID , CUSTOMER_NAME FROM ORDERS LEFT JOIN CUSTOMERS USING(CUSTOMER_ID) WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')"
18,Y,Y,"SELECT DISTINCT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN ( SELECT CUSTOMER_ID FROM ORDERS GROUP BY CUSTOMER_ID HAVING SUM(PRODUCT_NAME = 'A') > 0 AND SUM(PRODUCT_NAME = 'B') > 0 AND SUM(PRODUCT_NAME = 'C') = 0 )"
19,Y,Y,"SELECT DISTINCT O.CUSTOMER_ID AS CUSTOMER_ID,C.CUSTOMER_NAME AS CUSTOMER_NAME FROM ORDERS O LEFT JOIN CUSTOMERS C ON O.CUSTOMER_ID=C.CUSTOMER_ID WHERE O.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='A' ) AND O.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='B' ) AND O.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='C' )"
20,Y,Y,"SELECT DISTINCT O.CUSTOMER_ID AS CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS O JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID WHERE O.CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND O.CUSTOMER_ID IN ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND O.CUSTOMER_ID NOT IN ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') ORDER BY CUSTOMER_ID"
21,Y,Y,"SELECT DISTINCT O.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS AS O LEFT JOIN CUSTOMERS AS C ON O.CUSTOMER_ID = C.CUSTOMER_ID WHERE (O.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND O.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A')) AND O.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') ORDER BY CUSTOMER_ID"
22,Y,N,"SELECT DISTINCT O.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS O JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID WHERE O.PRODUCT_NAME IN ('A', 'B') AND O.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') GROUP BY O.CUSTOMER_ID HAVING COUNT(O.CUSTOMER_ID) > 1"
23,Y,Y,"SELECT DISTINCT(CUSTOMER_ID), CUSTOMER_NAME FROM ORDERS JOIN CUSTOMERS USING (CUSTOMER_ID ) WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')"
24,Y,Y,"SELECT DISTINCT(O.CUSTOMER_ID),C.CUSTOMER_NAME FROM ORDERS O JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID WHERE O.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='A') AND O.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='B') AND O.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='C')"
25,Y,N,"SELECT ORDERS.CUSTOMER_ID, CUSTOMER_NAME FROM ORDERS LEFT JOIN CUSTOMERS ON CUSTOMERS.CUSTOMER_ID = ORDERS.CUSTOMER_ID WHERE PRODUCT_NAME = 'A' AND ORDERS.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND ORDERS.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')"
26,Y,Y,"SELECT P.CUSTOMER_ID, C.CUSTOMER_NAME FROM ( SELECT GROUP_CONCAT(DISTINCT PRODUCT_NAME) AS ALLPRODUCTS, CUSTOMER_ID FROM ORDERS GROUP BY CUSTOMER_ID ) P JOIN CUSTOMERS C ON P.CUSTOMER_ID = C.CUSTOMER_ID WHERE P.ALLPRODUCTS LIKE '%A%B%' AND P.ALLPRODUCTS NOT LIKE '%C%'"
27,Y,N,"SELECT T.CUSTOMER_ID, CUSTOMER_NAME FROM ( SELECT CUSTOMER_ID, SUM(CASE WHEN PRODUCT_NAME IN ('A', 'B') THEN 1 WHEN PRODUCT_NAME = 'C' THEN -1 ELSE 0 END) AS POINT FROM ORDERS GROUP BY CUSTOMER_ID) AS T JOIN CUSTOMERS AS C ON T.CUSTOMER_ID = C.CUSTOMER_ID WHERE POINT = 2 ORDER BY CUSTOMER_ID"
28,Y,N,"SELECT A.CUSTOMER_ID, B.CUSTOMER_NAME FROM (SELECT CUSTOMER_ID, SUM(CASE WHEN PRODUCT_NAME='A' THEN 1 WHEN PRODUCT_NAME='B' THEN 10 WHEN PRODUCT_NAME='C' THEN 100 ELSE 0 END) AS PRODUCT_SCORE FROM ORDERS GROUP BY CUSTOMER_ID ) A LEFT JOIN CUSTOMERS B ON A.CUSTOMER_ID=B.CUSTOMER_ID WHERE A.PRODUCT_SCORE=11"
29,Y,N,"SELECT A.CUSTOMER_ID, CUST.CUSTOMER_NAME FROM ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A' ) A INNER JOIN ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B' ) B ON A.CUSTOMER_ID = B.CUSTOMER_ID INNER JOIN CUSTOMERS CUST ON A.CUSTOMER_ID = CUST.CUSTOMER_ID WHERE A.CUSTOMER_ID NOT IN ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C' )"
30,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM (SELECT CUSTOMER_ID, GROUP_CONCAT(PRODUCT_NAME) AS PRODUCT_NAMES FROM ORDERS O GROUP BY 1 HAVING PRODUCT_NAMES LIKE '%A%' AND PRODUCT_NAMES LIKE '%B%' AND PRODUCT_NAMES NOT LIKE '%C%' ) O JOIN CUSTOMERS C ON C.CUSTOMER_ID = O.CUSTOMER_ID"
31,Y,N,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS A ON A.CUSTOMER_ID = C.CUSTOMER_ID AND A.PRODUCT_NAME = 'A' JOIN ORDERS B ON B.CUSTOMER_ID = C.CUSTOMER_ID AND B.PRODUCT_NAME = 'B' LEFT JOIN ORDERS O ON O.CUSTOMER_ID = C.CUSTOMER_ID AND O.PRODUCT_NAME = 'C' WHERE O.ORDER_ID IS NULL"
32,Y,N,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS A ON A.CUSTOMER_ID = C.CUSTOMER_ID AND A.PRODUCT_NAME = 'A' JOIN ORDERS B ON B.CUSTOMER_ID = C.CUSTOMER_ID AND B.PRODUCT_NAME = 'B' LEFT OUTER JOIN ORDERS O ON O.CUSTOMER_ID = C.CUSTOMER_ID AND O.PRODUCT_NAME = 'C' WHERE O.ORDER_ID IS NULL"
33,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O USING(CUSTOMER_ID) GROUP BY C.CUSTOMER_ID HAVING SUM(O.PRODUCT_NAME = 'A') > 0 AND SUM(O.PRODUCT_NAME = 'B') > 0 AND SUM(O.PRODUCT_NAME = 'C') = 0"
34,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C WHERE C.CUSTOMER_ID IN ( SELECT O.CUSTOMER_ID FROM ORDERS O WHERE O.PRODUCT_NAME = 'A') AND C.CUSTOMER_ID IN ( SELECT O.CUSTOMER_ID FROM ORDERS O WHERE O.PRODUCT_NAME = 'B') AND C.CUSTOMER_ID NOT IN ( SELECT O.CUSTOMER_ID FROM ORDERS O WHERE O.PRODUCT_NAME = 'C') ORDER BY C.CUSTOMER_ID ASC"
35,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='A' ) AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='B' ) AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='C' )"
36,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C, ORDERS O WHERE C.CUSTOMER_ID = O.CUSTOMER_ID GROUP BY C.CUSTOMER_ID HAVING SUM(O.PRODUCT_NAME = 'A') > 0 AND SUM(O.PRODUCT_NAME = 'B') > 0 AND SUM(O.PRODUCT_NAME = 'C') = 0"
37,Y,N,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS AS O INNER JOIN CUSTOMERS AS C ON O.CUSTOMER_ID = C.CUSTOMER_ID WHERE PRODUCT_NAME IN ('A','B') AND C.CUSTOMER_ID NOT IN ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C' ) GROUP BY C.CUSTOMER_ID , C.CUSTOMER_NAME HAVING COUNT(C.CUSTOMER_NAME)=2"
38,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS O LEFT JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID GROUP BY O.CUSTOMER_ID HAVING SUM(O.PRODUCT_NAME = 'A') > 0 AND SUM(O.PRODUCT_NAME = 'B') > 0 AND SUM(O.PRODUCT_NAME = 'C') = 0 ORDER BY O.CUSTOMER_ID"
39,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS AS C WHERE EXISTS(SELECT * FROM ORDERS WHERE CUSTOMER_ID = C.CUSTOMER_ID AND PRODUCT_NAME = 'A') AND EXISTS(SELECT * FROM ORDERS WHERE CUSTOMER_ID = C.CUSTOMER_ID AND PRODUCT_NAME = 'B') AND NOT EXISTS(SELECT * FROM ORDERS WHERE CUSTOMER_ID = C.CUSTOMER_ID AND PRODUCT_NAME = 'C') ORDER BY C.CUSTOMER_ID"
40,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C INNER JOIN (SELECT CUSTOMER_ID,SUM( CASE WHEN PRODUCT_NAME = 'A' THEN 1 ELSE 0 END ) AS A , SUM(CASE WHEN PRODUCT_NAME = 'B' THEN 1 ELSE 0 END) AS B , SUM(CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END) AS C FROM ORDERS GROUP BY CUSTOMER_ID) O ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE O.A >= 1 AND O.B >= 1 AND O.C = 0"
41,Y,Y,"SELECT C.CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS C LEFT JOIN ( SELECT CUSTOMER_ID, GROUP_CONCAT(PRODUCT_NAME) AS PRODUCTS FROM ORDERS GROUP BY CUSTOMER_ID) CC ON CC.CUSTOMER_ID = C.CUSTOMER_ID WHERE PRODUCTS LIKE '%A%' AND PRODUCTS LIKE '%B%' AND PRODUCTS NOT LIKE '%C%'"
42,Y,Y,"SELECT C.CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS C LEFT JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID GROUP BY 1 HAVING SUM(CASE WHEN O.PRODUCT_NAME = 'A' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN O.PRODUCT_NAME = 'B' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN O.PRODUCT_NAME = 'C' THEN 1 ELSE 0 END) = 0 ORDER BY 1"
43,Y,Y,"SELECT CUSTOMER_ID , CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID NOT IN (SELECT DISTINCT(CUSTOMER_ID) FROM ORDERS WHERE PRODUCT_NAME = 'C' ) AND CUSTOMER_ID IN (SELECT DISTINCT(CUSTOMER_ID) FROM ORDERS WHERE PRODUCT_NAME = 'A') AND CUSTOMER_ID IN (SELECT DISTINCT(CUSTOMER_ID) FROM ORDERS WHERE PRODUCT_NAME = 'B') ORDER BY CUSTOMER_ID"
44,Y,N,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM ( SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME, SUM(CASE WHEN PRODUCT_NAME IN ('A', 'B') THEN 1 WHEN PRODUCT_NAME IN ('C') THEN -1 END) AS SCORE FROM CUSTOMERS C LEFT JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID GROUP BY 1,2)A WHERE SCORE = 2"
45,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM (SELECT O.CUSTOMER_ID, C.CUSTOMER_NAME, GROUP_CONCAT(DISTINCT O.PRODUCT_NAME ORDER BY PRODUCT_NAME) AS PRODUCTS FROM ORDERS O LEFT JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID GROUP BY O.CUSTOMER_ID, C.CUSTOMER_NAME) AS CUST_ORDERS WHERE PRODUCTS NOT LIKE '%C%' AND PRODUCTS LIKE '%A,B%'"
46,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM (SELECT ORDERS.CUSTOMER_ID, CUSTOMERS.CUSTOMER_NAME, ORDERS.PRODUCT_NAME FROM ORDERS INNER JOIN CUSTOMERS ON ORDERS.CUSTOMER_ID = CUSTOMERS.CUSTOMER_ID) AS TB1 GROUP BY CUSTOMER_ID HAVING SUM(PRODUCT_NAME = 'A') >0 AND SUM(PRODUCT_NAME = 'B') >0 AND SUM(PRODUCT_NAME = 'C') =0"
47,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE ( CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') ) AND ( CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') ) AND ( CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') )"
48,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A' ) AND CUSTOMER_ID IN ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B' ) AND CUSTOMER_ID NOT IN ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C' ) ORDER BY CUSTOMER_ID"
49,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A' )AND CUSTOMER_ID IN ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B' )AND CUSTOMER_ID NOT IN ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C' )"
50,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN ( SELECT CUSTOMER_ID FROM ORDERS O WHERE PRODUCT_NAME = 'A' ) AND CUSTOMER_ID IN ( SELECT CUSTOMER_ID FROM ORDERS O WHERE PRODUCT_NAME = 'B' ) AND CUSTOMER_ID NOT IN ( SELECT CUSTOMER_ID FROM ORDERS O WHERE PRODUCT_NAME = 'C' )"
51,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='A' AND CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='B')) AND CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='C')"
52,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT DISTINCT(CUSTOMER_ID) FROM ORDERS WHERE PRODUCT_NAME = 'A' ) AND CUSTOMER_ID IN (SELECT DISTINCT(CUSTOMER_ID) FROM ORDERS WHERE PRODUCT_NAME = 'B' ) AND CUSTOMER_ID NOT IN (SELECT DISTINCT(CUSTOMER_ID) FROM ORDERS WHERE PRODUCT_NAME = 'C' )"
53,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A')"
54,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS C WHERE 'A' IN (SELECT PRODUCT_NAME FROM ORDERS WHERE CUSTOMER_ID = C.CUSTOMER_ID) AND B IN (SELECT PRODUCT_NAME FROM ORDERS WHERE CUSTOMER_ID = C.CUSTOMER_ID) AND C NOT IN (SELECT PRODUCT_NAME FROM ORDERS WHERE CUSTOMER_ID = C.CUSTOMER_ID)"
55,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS C WHERE CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') ORDER BY CUSTOMER_ID"
56,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM ORDERS JOIN CUSTOMERS USING(CUSTOMER_ID) GROUP BY 1 HAVING SUM(PRODUCT_NAME='A')>0 AND SUM(PRODUCT_NAME='B')>0 AND SUM(PRODUCT_NAME='C')=0 ORDER BY 1"
57,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM ORDERS JOIN CUSTOMERS USING (CUSTOMER_ID) GROUP BY CUSTOMER_ID HAVING GROUP_CONCAT(PRODUCT_NAME) LIKE '%A%' AND GROUP_CONCAT(PRODUCT_NAME) LIKE '%B%' AND GROUP_CONCAT(PRODUCT_NAME) NOT LIKE '%C%'"
58,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')"
59,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN ( SELECT CUSTOMER_ID FROM (SELECT CUSTOMER_ID, GROUP_CONCAT(PRODUCT_NAME) AS ALL_PRODUCTS FROM ORDERS GROUP BY CUSTOMER_ID ) A WHERE FIND_IN_SET('A', A.ALL_PRODUCTS) > 0 AND FIND_IN_SET('B', A.ALL_PRODUCTS) > 0 AND FIND_IN_SET('C', A.ALL_PRODUCTS) = 0 ) ORDER BY CUSTOMER_ID"
60,Y,Y,"SELECT DISTINCT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS O JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID WHERE O.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS C WHERE PRODUCT_NAME = 'A') AND O.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS C WHERE PRODUCT_NAME = 'B') AND O.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS C WHERE PRODUCT_NAME = 'C')"
61,Y,Y,"SELECT DISTINCT ORDERS.CUSTOMER_ID, CUSTOMER_NAME FROM ORDERS LEFT JOIN CUSTOMERS ON CUSTOMERS.CUSTOMER_ID = ORDERS.CUSTOMER_ID WHERE ORDERS.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='A') AND ORDERS.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='B') AND ORDERS.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='C')"
62,Y,Y,"SELECT DISTINCT A.CUSTOMER_ID, B.CUSTOMER_NAME FROM ORDERS A JOIN CUSTOMERS B ON A.CUSTOMER_ID=B.CUSTOMER_ID WHERE PRODUCT_NAME ='A' AND A.CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='B') AND A.CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='C')"
63,Y,Y,"SELECT DISTINCT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C LEFT JOIN ORDERS O ON O.CUSTOMER_ID = C.CUSTOMER_ID WHERE O.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND O.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND O.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')"
64,Y,Y,"SELECT O.CUSTOMER_ID, C.CUSTOMER_NAME FROM (SELECT CUSTOMER_ID, SUM(CASE WHEN PRODUCT_NAME IN ('A', 'B') THEN 1 WHEN PRODUCT_NAME = 'C' THEN -1 ELSE 0 END) AS PRODUCT_COUNT FROM (SELECT DISTINCT CUSTOMER_ID, PRODUCT_NAME FROM ORDERS) AS T1 GROUP BY CUSTOMER_ID) AS O INNER JOIN CUSTOMERS AS C ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE O.PRODUCT_COUNT = 2"
65,Y,Y,"SELECT O.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C, ORDERS O WHERE C.CUSTOMER_ID = O.CUSTOMER_ID GROUP BY O.CUSTOMER_ID HAVING SUM(O.PRODUCT_NAME = 'A') > 0 AND SUM(O.PRODUCT_NAME = 'B') > 0 AND SUM(O.PRODUCT_NAME = 'C') = 0"
66,Y,Y,"SELECT O.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS O LEFT JOIN CUSTOMERS C ON O.CUSTOMER_ID=C.CUSTOMER_ID GROUP BY O.CUSTOMER_ID HAVING SUM(O.PRODUCT_NAME = 'A') > 0 AND SUM(O.PRODUCT_NAME = 'B') > 0 AND SUM(O.PRODUCT_NAME = 'C') = 0 ORDER BY O.CUSTOMER_ID"
67,Y,Y,"SELECT O.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS O LEFT JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID GROUP BY O.CUSTOMER_ID HAVING SUM(O.PRODUCT_NAME = 'A') > 0 AND SUM(O.PRODUCT_NAME = 'B') > 0 AND SUM(O.PRODUCT_NAME = 'C') = 0"
68,Y,Y,"SELECT O.CUSTOMER_ID, CUSTOMER_NAME FROM ORDERS O LEFT JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID GROUP BY CUSTOMER_ID HAVING SUM(IF(PRODUCT_NAME = 'A',1,0)) > 0 AND SUM(IF(PRODUCT_NAME = 'B',1,0)) >0 AND SUM(IF(PRODUCT_NAME = 'C',1,0)) = 0"
69,Y,Y,"SELECT T.CUSTOMER_ID, T.CUSTOMER_NAME FROM ( SELECT O.CUSTOMER_ID, C.CUSTOMER_NAME, SUM(CASE WHEN O.PRODUCT_NAME = 'A' THEN 1 ELSE 0 END) AS PROD_A, SUM(CASE WHEN O.PRODUCT_NAME = 'B' THEN 1 ELSE 0 END) AS PROD_B, SUM(CASE WHEN O.PRODUCT_NAME = 'C' THEN 1 ELSE 0 END) AS PROD_C FROM ORDERS O LEFT JOIN CUSTOMERS C ON O.CUSTOMER_ID=C.CUSTOMER_ID GROUP BY CUSTOMER_ID ) T WHERE T.PROD_A > 0 AND T.PROD_B > 0 AND PROD_C = 0 ORDER BY T.CUSTOMER_ID"
70,Y,Y,"SELECT T1.CUSTOMER_ID, C.CUSTOMER_NAME FROM (SELECT T.CUSTOMER_ID, (CASE WHEN T.PRODUCT_NAME = 'A' THEN 1 WHEN T.PRODUCT_NAME = 'B' THEN 1 WHEN T.PRODUCT_NAME = 'C' THEN 0.5 ELSE 0 END) AS INDEX_P FROM (SELECT CUSTOMER_ID, PRODUCT_NAME FROM ORDERS WHERE PRODUCT_NAME IN ('A','B','C') GROUP BY CUSTOMER_ID, PRODUCT_NAME) AS T) AS T1 LEFT JOIN CUSTOMERS C ON T1.CUSTOMER_ID = C.CUSTOMER_ID GROUP BY T1.CUSTOMER_ID HAVING SUM(T1.INDEX_P) = 2"
71,Y,Y,"SELECT T2.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS AS C JOIN (SELECT CUSTOMER_ID, GROUP_CONCAT(PRODUCT_NAME) AS PRODUCTS FROM ORDERS GROUP BY CUSTOMER_ID) AS T2 ON C.CUSTOMER_ID=T2.CUSTOMER_ID WHERE T2.PRODUCTS NOT LIKE '%C%' AND T2.PRODUCTS LIKE '%A%' AND T2.PRODUCTS LIKE '%B%'"
72,Y,Y,"SELECT DISTINCT A.CUSTOMER_ID ,CUSTOMER_NAME FROM (SELECT * FROM ORDERS WHERE PRODUCT_NAME = 'A') A JOIN (SELECT * FROM ORDERS WHERE PRODUCT_NAME = 'B') B USING (CUSTOMER_ID ) JOIN CUSTOMERS USING (CUSTOMER_ID ) WHERE CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')"
73,Y,N,"SELECT X.CUSTOMER_ID,X.CUSTOMER_NAME FROM (SELECT ORDERS.CUSTOMER_ID,CUSTOMER_NAME FROM ORDERS LEFT JOIN CUSTOMERS ON ORDERS.CUSTOMER_ID = CUSTOMERS.CUSTOMER_ID WHERE PRODUCT_NAME = 'A' AND ORDERS.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B')) AS X LEFT JOIN (SELECT CUSTOMER_ID,PRODUCT_NAME FROM ORDERS WHERE PRODUCT_NAME = 'C') AS Y ON X.CUSTOMER_ID = Y.CUSTOMER_ID WHERE Y.PRODUCT_NAME IS NULL"
74,Y,Y,"SELECT C.CUSTOMER_ID,C.CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID=O.CUSTOMER_ID GROUP BY O.CUSTOMER_ID HAVING SUM(O.PRODUCT_NAME='A')>0 AND SUM(O.PRODUCT_NAME='B')>0 AND SUM(O.PRODUCT_NAME='C')=0"
75,Y,N,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM (SELECT A.CUSTOMER_ID, CUSTOMER_NAME, SUM(A.TYPE_COUNT) OVER(PARTITION BY A.CUSTOMER_ID) AS TYPE_VALUE FROM (SELECT O.CUSTOMER_ID, C.CUSTOMER_NAME, CASE WHEN O.PRODUCT_NAME = 'A' THEN 1 WHEN O.PRODUCT_NAME = 'B' THEN 1 WHEN O.PRODUCT_NAME = 'C' THEN -1 ELSE 0 END AS TYPE_COUNT FROM ORDERS O INNER JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID) A) BB WHERE TYPE_VALUE = 2 GROUP BY CUSTOMER_ID"
76,Y,N,"SELECT CUSTOMER_ID,CUSTOMER_NAME FROM ORDERS JOIN CUSTOMERS USING(CUSTOMER_ID) GROUP BY CUSTOMER_ID HAVING SUM(CASE WHEN PRODUCT_NAME = 'A' THEN 1 ELSE 0 END) =1 AND SUM(CASE WHEN PRODUCT_NAME = 'B' THEN 1 ELSE 0 END) =1 AND SUM(CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END) =0"
77,Y,N,"SELECT X.CUSTOMER_ID,C.CUSTOMER_NAME FROM CUSTOMERS AS C INNER JOIN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='C') AND PRODUCT_NAME IN ('A','B') GROUP BY 1 HAVING COUNT(*)>1) AS X ON X.CUSTOMER_ID=C.CUSTOMER_ID"
78,Y,Y,"WITH A AS ( SELECT DISTINCT(A1.CUSTOMER_ID) FROM ORDERS A1, ORDERS A2, ORDERS A3 WHERE A1.PRODUCT_NAME='A' AND A2.PRODUCT_NAME='B' AND A3.PRODUCT_NAME!='C' AND A1.CUSTOMER_ID = A2.CUSTOMER_ID AND A2.CUSTOMER_ID = A3.CUSTOMER_ID ) SELECT A.CUSTOMER_ID , C.CUSTOMER_NAME FROM A A LEFT JOIN CUSTOMERS C ON A.CUSTOMER_ID = C.CUSTOMER_ID WHERE A.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='C')"
79,Y,Y,"WITH A AS ( SELECT DISTINCT(CUSTOMER_ID) AS CUSTS_A FROM ORDERS WHERE PRODUCT_NAME = 'A' ), B AS ( SELECT DISTINCT(CUSTOMER_ID) AS CUSTS_B FROM ORDERS WHERE PRODUCT_NAME = 'B' ), C AS ( SELECT DISTINCT(CUSTOMER_ID) AS CUSTS_C FROM ORDERS WHERE PRODUCT_NAME = 'C' ) SELECT CUSTOMERS.CUSTOMER_ID, CUSTOMERS.CUSTOMER_NAME FROM ( SELECT A.CUSTS_A FROM A JOIN B ON A.CUSTS_A=B.CUSTS_B LEFT JOIN C ON A.CUSTS_A=C.CUSTS_C WHERE C.CUSTS_C IS NULL ) T JOIN CUSTOMERS ON CUSTOMERS.CUSTOMER_ID = T.CUSTS_A"
80,Y,Y,"WITH A AS ( SELECT CUSTOMER_ID, SUM(CASE WHEN PRODUCT_NAME = 'A' THEN 1 ELSE 0 END) AS BUYA, SUM(CASE WHEN PRODUCT_NAME = 'B' THEN 1 ELSE 0 END) AS BUYB, SUM(CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END) AS BUYC FROM ORDERS GROUP BY CUSTOMER_ID HAVING BUYA>0 AND BUYB>0 AND BUYC=0) SELECT * FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM A) ORDER BY CUSTOMER_ID"
81,Y,Y,"WITH A_BUYER AS (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A' GROUP BY CUSTOMER_ID), B_BUYER AS (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B' GROUP BY CUSTOMER_ID), C_BUYER AS (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C' GROUP BY CUSTOMER_ID), AB_BUYER AS (SELECT A.CUSTOMER_ID FROM A_BUYER AS A INNER JOIN B_BUYER AS B ON A.CUSTOMER_ID = B.CUSTOMER_ID), RES AS (SELECT AB.CUSTOMER_ID FROM AB_BUYER AS AB LEFT JOIN C_BUYER AS C ON AB.CUSTOMER_ID = C.CUSTOMER_ID WHERE C.CUSTOMER_ID IS NULL) SELECT R.CUSTOMER_ID, C2.CUSTOMER_NAME FROM RES AS R JOIN CUSTOMERS AS C2 ON R.CUSTOMER_ID = C2.CUSTOMER_ID"
82,Y,Y,"WITH CTE AS ( (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') UNION ALL (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') UNION ALL (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') ) ) SELECT C.CUSTOMER_ID,CUSTOMER_NAME FROM CTE LEFT JOIN CUSTOMERS C ON CTE.CUSTOMER_ID = C.CUSTOMER_ID GROUP BY C.CUSTOMER_ID HAVING COUNT(1) = 3"
83,Y,Y,"WITH CTE AS ( SELECT DISTINCT O1.CUSTOMER_ID FROM ORDERS O1 LEFT JOIN ORDERS O2 ON O1.CUSTOMER_ID=O2.CUSTOMER_ID WHERE O1.PRODUCT_NAME='A' AND O2.PRODUCT_NAME='B' ) SELECT C2.CUSTOMER_ID, C2.CUSTOMER_NAME FROM CTE C1 JOIN CUSTOMERS C2 ON C1.CUSTOMER_ID=C2.CUSTOMER_ID AND C1.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='C')"
84,Y,N,"WITH CTE AS ( SELECT DISTINCT CUSTOMER_ID, SUM(CASE WHEN PRODUCT_NAME IN ('A','B','C') THEN 1 ELSE 0 END) CNT, SUM(CASE WHEN PRODUCT_NAME IN ('A','B') THEN 1 ELSE 0 END) CNT1 FROM ORDERS GROUP BY CUSTOMER_ID HAVING SUM(CASE WHEN PRODUCT_NAME IN ('A','B','C') THEN 1 ELSE 0 END)!=3 AND SUM(CASE WHEN PRODUCT_NAME IN ('A','B') THEN 1 ELSE 0 END)=2 ) SELECT C.CUSTOMER_ID,C.CUSTOMER_NAME FROM CTE C1 INNER JOIN CUSTOMERS C ON C.CUSTOMER_ID=C1.CUSTOMER_ID"
85,Y,Y,"WITH CTE AS ( SELECT O.CUSTOMER_ID, C.CUSTOMER_NAME, SUM(PRODUCT_NAME = 'A') AS COUNTA , SUM(PRODUCT_NAME = 'B') AS COUNTB ,SUM(PRODUCT_NAME = 'C') AS COUNTC FROM ORDERS O LEFT JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID GROUP BY 1,2 ) SELECT CTE.CUSTOMER_ID, CTE.CUSTOMER_NAME FROM CTE WHERE COUNTA > 0 AND COUNTB > 0 AND COUNTC = 0"
86,Y,N,"WITH CTE AS (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A' AND CUSTOMER_ID IN ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B' ) ) SELECT CTE.CUSTOMER_ID, CUSTOMERS.CUSTOMER_NAME FROM CTE LEFT JOIN CUSTOMERS ON CTE.CUSTOMER_ID = CUSTOMERS.CUSTOMER_ID WHERE CTE.CUSTOMER_ID NOT IN ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C' )"
87,Y,Y,"WITH CTE AS (SELECT ORDER_ID, CUSTOMER_ID, PRODUCT_NAME, CASE WHEN PRODUCT_NAME='A' THEN 1 WHEN PRODUCT_NAME='B' THEN 2 WHEN PRODUCT_NAME='C' THEN 3 ELSE 4 END AS CUSTOM_RNK FROM ORDERS) SELECT DISTINCT B.CUSTOMER_ID, CUSTOMER_NAME FROM ORDERS A INNER JOIN CUSTOMERS B ON A.CUSTOMER_ID=B.CUSTOMER_ID WHERE A.CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM CTE WHERE CUSTOM_RNK=3) AND A.CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM CTE WHERE CUSTOM_RNK=1) AND A.CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM CTE WHERE CUSTOM_RNK=2)"
88,Y,Y,WITH CTE1 AS ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') AND CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') ) SELECT * FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT * FROM CTE1)
89,Y,Y,"WITH CUST_A_B AS ( SELECT DISTINCT A.CUSTOMER_ID FROM (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='A') A INNER JOIN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='B')B WHERE A.CUSTOMER_ID=B.CUSTOMER_ID ) SELECT C1.CUSTOMER_ID,C2.CUSTOMER_NAME FROM CUST_A_B C1 INNER JOIN CUSTOMERS C2 ON C1.CUSTOMER_ID=C2.CUSTOMER_ID WHERE C1.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='C')"
90,Y,Y,"WITH CUST_CTE AS( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') ) SELECT C1.CUSTOMER_ID, CUSTOMER_NAME FROM CUST_CTE C1 INNER JOIN CUSTOMERS C2 ON C1.CUSTOMER_ID = C2.CUSTOMER_ID"
91,Y,Y,WITH CANDIDATES AS ( SELECT CUSTOMER_ID FROM ORDERS GROUP BY CUSTOMER_ID HAVING SUM(CASE WHEN PRODUCT_NAME='A' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN PRODUCT_NAME='B' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN PRODUCT_NAME='C' THEN 1 ELSE 0 END)=0 ) SELECT * FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM CANDIDATES) ORDER BY CUSTOMER_ID
92,Y,N,"WITH CUSTOMERC AS ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C' GROUP BY CUSTOMER_ID ), CUSTOMERA AS ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A' GROUP BY CUSTOMER_ID ), CUSTOMERB AS ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B' GROUP BY CUSTOMER_ID ) SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS JOIN ORDERS USING (CUSTOMER_ID) JOIN CUSTOMERA USING (CUSTOMER_ID) JOIN CUSTOMERB USING (CUSTOMER_ID) WHERE CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM CUSTOMERC) AND CUSTOMER_ID GROUP BY CUSTOMER_ID, CUSTOMER_NAME ORDER BY CUSTOMER_ID"
93,Y,Y,"WITH STAGING AS (SELECT CUSTOMER_ID , COUNT(DISTINCT(CASE WHEN PRODUCT_NAME IN ('A', 'B') THEN PRODUCT_NAME ELSE NULL END)) AS AANDBCOUNT , COUNT(DISTINCT(CASE WHEN PRODUCT_NAME = 'C' THEN PRODUCT_NAME ELSE NULL END)) AS CCOUNT FROM ORDERS GROUP BY CUSTOMER_ID) SELECT CUSTOMERS.CUSTOMER_ID, CUSTOMERS.CUSTOMER_NAME FROM STAGING JOIN CUSTOMERS ON STAGING.CUSTOMER_ID = CUSTOMERS.CUSTOMER_ID WHERE AANDBCOUNT >= 2 AND CCOUNT = 0"
94,Y,N,"WITH TEMP AS ( SELECT A.CUSTOMER_ID, CUSTOMER_NAME, SUM(CASE WHEN PRODUCT_NAME = 'A' THEN 1 ELSE 0 END) AS A, SUM(CASE WHEN PRODUCT_NAME = 'B' THEN 1 ELSE 0 END) AS B, SUM(CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END) AS C FROM ORDERS A LEFT JOIN CUSTOMERS B ON A.CUSTOMER_ID = B.CUSTOMER_ID GROUP BY CUSTOMER_ID ) SELECT CUSTOMER_ID, CUSTOMER_NAME FROM TEMP WHERE A = 1 AND B = 1 AND C = 0 ORDER BY CUSTOMER_ID"
95,Y,Y,"WITH TEMP AS ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A' AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='B')) SELECT DISTINCT TEMP.CUSTOMER_ID, C.CUSTOMER_NAME FROM TEMP JOIN CUSTOMERS C ON TEMP.CUSTOMER_ID = C.CUSTOMER_ID WHERE TEMP.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='C')"
96,Y,N,"WITH A AS ( SELECT CUSTOMERS.CUSTOMER_ID, CUSTOMER_NAME, ORDER_ID FROM CUSTOMERS INNER JOIN ORDERS ON CUSTOMERS.CUSTOMER_ID = ORDERS.CUSTOMER_ID WHERE PRODUCT_NAME = 'A'), B AS ( SELECT A.CUSTOMER_ID, CUSTOMER_NAME, A.ORDER_ID FROM A INNER JOIN ORDERS ON A.CUSTOMER_ID = ORDERS.CUSTOMER_ID WHERE PRODUCT_NAME = 'B' ) SELECT B.CUSTOMER_ID, CUSTOMER_NAME FROM B WHERE B.CUSTOMER_ID NOT IN (SELECT CUSTOMERS.CUSTOMER_ID FROM CUSTOMERS INNER JOIN ORDERS ON CUSTOMERS.CUSTOMER_ID = ORDERS.CUSTOMER_ID WHERE PRODUCT_NAME = 'C')"
97,Y,Y,"WITH A AS( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A' ), B AS( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B' ), C AS( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C' ) SELECT DISTINCT CUSTOMER_ID, CUSTOMER_NAME FROM ORDERS JOIN CUSTOMERS USING(CUSTOMER_ID) WHERE CUSTOMER_ID IN (SELECT * FROM A) AND CUSTOMER_ID IN (SELECT * FROM B) AND CUSTOMER_ID NOT IN (SELECT * FROM C) ORDER BY CUSTOMER_ID"
98,Y,N,"WITH A AS (SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE O.PRODUCT_NAME = 'A') , B AS ( SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE O.PRODUCT_NAME = 'B'), C AS ( SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE O.PRODUCT_NAME = 'C') SELECT A.CUSTOMER_ID, A.CUSTOMER_NAME FROM A JOIN B ON A.CUSTOMER_ID = B.CUSTOMER_ID LEFT JOIN C ON A.CUSTOMER_ID = C.CUSTOMER_ID WHERE C.CUSTOMER_ID IS NULL"
99,Y,Y,"WITH BASE_TABLE AS ( SELECT CUSTOMER_ID, CUSTOMER_NAME, GROUP_CONCAT(DISTINCT PRODUCT_NAME) AS PRODUCT_LISTS FROM CUSTOMERS LEFT JOIN ORDERS USING(CUSTOMER_ID) GROUP BY 1, 2) SELECT CUSTOMER_ID, CUSTOMER_NAME FROM BASE_TABLE WHERE PRODUCT_LISTS LIKE '%A%B%' AND PRODUCT_LISTS NOT LIKE '%C%' GROUP BY 1"
100,Y,Y,"WITH BOUGHTS AS ( SELECT CUSTOMER_ID, COUNT(DISTINCT PRODUCT_NAME) AS CNT FROM ORDERS WHERE PRODUCT_NAME IN ('A', 'B') GROUP BY CUSTOMER_ID), NOTS AS ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C' GROUP BY CUSTOMER_ID) SELECT B.CUSTOMER_ID, C.CUSTOMER_NAME FROM BOUGHTS AS B INNER JOIN CUSTOMERS AS C ON B.CUSTOMER_ID = C.CUSTOMER_ID LEFT JOIN NOTS AS N ON B.CUSTOMER_ID = N.CUSTOMER_ID WHERE N.CUSTOMER_ID IS NULL AND B.CNT = 2"
101,Y,N,"WITH CTE AS (SELECT O.CUSTOMER_ID, C.CUSTOMER_NAME, O.PRODUCT_NAME, SUM(IF(PRODUCT_NAME='A','1','0')) AS A, SUM(IF(PRODUCT_NAME='B','1','0')) AS B, SUM(IF(PRODUCT_NAME='C','1','0')) AS C FROM CUSTOMERS C LEFT JOIN ORDERS O ON C.CUSTOMER_ID=O.CUSTOMER_ID GROUP BY 1) SELECT CTE.CUSTOMER_ID, CTE.CUSTOMER_NAME FROM CTE WHERE A=1 AND B=1 AND C=0"
102,Y,N,"WITH CTE AS( SELECT O.CUSTOMER_ID, C.CUSTOMER_NAME, SUM(CASE WHEN PRODUCT_NAME = 'A' THEN 1 ELSE 0 END) AS A, SUM(CASE WHEN PRODUCT_NAME = 'B' THEN 1 ELSE 0 END) AS B, SUM(CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END) AS C, SUM(CASE WHEN PRODUCT_NAME = 'D' THEN 1 ELSE 0 END) AS D FROM ORDERS O INNER JOIN CUSTOMERS C USING (CUSTOMER_ID) GROUP BY O.CUSTOMER_ID ) SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CTE WHERE A = 1 AND B = 1 AND C = 0"
103,Y,N,"WITH ORDER_CNT AS ( SELECT CUSTOMER_ID, SUM( CASE WHEN PRODUCT_NAME IN ('A', 'B') THEN 1 WHEN PRODUCT_NAME = 'C' THEN -1 ELSE 0 END ) AS CNT FROM ORDERS GROUP BY CUSTOMER_ID ) SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDER_CNT JOIN CUSTOMERS C ON C.CUSTOMER_ID = ORDER_CNT.CUSTOMER_ID WHERE ORDER_CNT.CNT = 2"
104,Y,Y,"WITH ORDER_TYPE AS( SELECT CUSTOMER_ID , CASE WHEN PRODUCT_NAME = 'A' THEN 1 ELSE 0 END AS IS_A_PURCHASE , CASE WHEN PRODUCT_NAME = 'B' THEN 1 ELSE 0 END AS IS_B_PURCHASE , CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END AS IS_C_PURCHASE FROM ORDERS ) SELECT CUSTOMER_ID , CUSTOMER_NAME FROM ORDER_TYPE INNER JOIN CUSTOMERS USING(CUSTOMER_ID) GROUP BY CUSTOMER_ID, CUSTOMER_NAME HAVING (MAX(IS_A_PURCHASE)>0 AND MAX(IS_B_PURCHASE)>0 AND MAX(IS_C_PURCHASE)=0) ORDER BY CUSTOMER_ID ASC"
105,Y,N,"WITH T1 AS ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A' AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')) SELECT T1.CUSTOMER_ID, C.CUSTOMER_NAME FROM T1 LEFT JOIN CUSTOMERS C ON T1.CUSTOMER_ID = C.CUSTOMER_ID"
106,Y,Y,"WITH TABLE1 AS (SELECT CUSTOMER_ID, GROUP_CONCAT(PRODUCT_NAME ORDER BY PRODUCT_NAME) AS TOTAL_PRODUCT FROM ORDERS GROUP BY 1 ) SELECT TABLE1.CUSTOMER_ID AS CUSTOMER_ID ,CUSTOMER_NAME AS CUSTOMER_NAME FROM TABLE1 LEFT JOIN CUSTOMERS ON CUSTOMERS.CUSTOMER_ID = TABLE1.CUSTOMER_ID WHERE TOTAL_PRODUCT LIKE '%A%' AND TOTAL_PRODUCT LIKE '%B%' AND TOTAL_PRODUCT NOT LIKE '%C%'"
107,Y,Y,"WITH TEMP AS ( SELECT CUSTOMER_ID, SUM(CASE WHEN PRODUCT_NAME = 'A' THEN 1 ELSE 0 END) AS A, SUM(CASE WHEN PRODUCT_NAME = 'B' THEN 1 ELSE 0 END) AS B, SUM(CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END) AS C FROM ORDERS GROUP BY CUSTOMER_ID ) SELECT T.CUSTOMER_ID, C.CUSTOMER_NAME FROM TEMP T JOIN CUSTOMERS C ON C.CUSTOMER_ID = T.CUSTOMER_ID WHERE T.A > 0 AND T.B > 0 AND T.C = 0"
108,Y,Y,SELECT * FROM CUSTOMERS WHERE CUSTOMER_ID IN ( SELECT CUSTOMER_ID FROM ORDERS O GROUP BY CUSTOMER_ID HAVING SUM(CASE WHEN O.PRODUCT_NAME ='A' THEN 1 ELSE 0 END) >0 AND SUM(CASE WHEN O.PRODUCT_NAME ='B' THEN 1 ELSE 0 END) >0 AND SUM(CASE WHEN O.PRODUCT_NAME ='C' THEN 1 ELSE 0 END) =0)
109,Y,Y,SELECT * FROM CUSTOMERS C WHERE EXISTS(SELECT DISTINCT 1 FROM ORDERS WHERE PRODUCT_NAME='A' AND CUSTOMER_ID=C.CUSTOMER_ID) AND EXISTS(SELECT DISTINCT 1 FROM ORDERS WHERE PRODUCT_NAME='B' AND CUSTOMER_ID=C.CUSTOMER_ID) AND NOT EXISTS(SELECT DISTINCT 1 FROM ORDERS WHERE PRODUCT_NAME='C' AND CUSTOMER_ID=C.CUSTOMER_ID) ORDER BY C.CUSTOMER_ID
110,Y,Y,SELECT * FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND NOT CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')
111,Y,Y,SELECT * FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME IN ('A')) AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME IN ('B')) AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME IN ('C'))
112,Y,Y,SELECT * FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='C') ORDER BY CUSTOMER_ID
113,Y,N,"SELECT A.CUSTOMER_ID AS CUSTOMER_ID ,CUSTOMER_NAME FROM( SELECT CUSTOMER_ID ,SUM(CASE WHEN PRODUCT_NAME = 'A' OR PRODUCT_NAME = 'B' THEN 1 ELSE 0 END) ABCNT ,COALESCE(SUM(CASE WHEN PRODUCT_NAME = 'C' THEN 1 END),0) AS CCNT FROM ORDERS ORDERS GROUP BY CUSTOMER_ID ) A JOIN CUSTOMERS CUSTOMERS ON A.CUSTOMER_ID = CUSTOMERS.CUSTOMER_ID WHERE ABCNT = 2 AND CCNT = 0"
114,Y,N,"SELECT A.CUSTOMER_ID AS CUSTOMER_ID ,CUSTOMER_NAME FROM( SELECT CUSTOMER_ID ,SUM(CASE WHEN PRODUCT_NAME = 'A' OR PRODUCT_NAME = 'B' THEN 1 ELSE 0 END) ABCNT ,COALESCE(SUM(CASE WHEN PRODUCT_NAME = 'C' THEN 1 END),0) AS CCNT FROM ORDERS ORDERS GROUP BY CUSTOMER_ID ) A JOIN CUSTOMERS CUSTOMERS ON A.CUSTOMER_ID = CUSTOMERS.CUSTOMER_ID WHERE ABCNT >= 2 AND CCNT = 0"
115,Y,Y,"SELECT A.CUSTOMER_ID, CUSTOMER_NAME FROM ( SELECT CUSTOMER_ID, SUM(CASE WHEN PRODUCT_NAME='A' THEN 1 ELSE 0 END) AS PRODA, SUM(CASE WHEN PRODUCT_NAME='B' THEN 1 ELSE 0 END) AS PRODB, SUM(CASE WHEN PRODUCT_NAME='C' THEN 1 ELSE 0 END) AS PRODC FROM ORDERS GROUP BY CUSTOMER_ID) A JOIN CUSTOMERS C ON A.CUSTOMER_ID = C.CUSTOMER_ID WHERE PRODA>=1 AND PRODB>=1 AND PRODC=0"
116,Y,N,"SELECT CUSTOMER_ID,CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN ( SELECT CUSTOMER_ID FROM (SELECT CUSTOMER_ID, COUNT(CASE WHEN PRODUCT_NAME='A' THEN 1 END) AS PROD_A, COUNT(CASE WHEN PRODUCT_NAME='B' THEN 1 END) AS PROD_B, COUNT(CASE WHEN PRODUCT_NAME='C' THEN 1 END) AS PROD_C FROM ORDERS GROUP BY 1)X WHERE PROD_A=1 AND PROD_B=1 AND PROD_C=0 )"
117,Y,Y,"SELECT CUSTOMERS.CUSTOMER_ID, CUSTOMERS.CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMERS.CUSTOMER_ID IN (SELECT DISTINCT CUSTOMERS.CUSTOMER_ID FROM CUSTOMERS LEFT JOIN ORDERS ON CUSTOMERS.CUSTOMER_ID = ORDERS.CUSTOMER_ID WHERE ORDERS.PRODUCT_NAME='A') AND CUSTOMERS.CUSTOMER_ID IN (SELECT DISTINCT CUSTOMERS.CUSTOMER_ID FROM CUSTOMERS LEFT JOIN ORDERS ON CUSTOMERS.CUSTOMER_ID = ORDERS.CUSTOMER_ID WHERE ORDERS.PRODUCT_NAME='B') AND CUSTOMERS.CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMERS.CUSTOMER_ID FROM CUSTOMERS LEFT JOIN ORDERS ON CUSTOMERS.CUSTOMER_ID = ORDERS.CUSTOMER_ID WHERE ORDERS.PRODUCT_NAME='C') ORDER BY CUSTOMER_ID"
118,Y,Y,"SELECT A.CUSTOMER_ID , A.CUSTOMER_NAME FROM CUSTOMERS A JOIN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME IN('A')) AB ON A.CUSTOMER_ID = AB.CUSTOMER_ID JOIN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME IN('B')) AB2 ON A.CUSTOMER_ID = AB2.CUSTOMER_ID LEFT JOIN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') C ON AB.CUSTOMER_ID = C.CUSTOMER_ID WHERE C.CUSTOMER_ID IS NULL"
119,Y,N,"SELECT A.CUSTOMER_ID, CUSTOMERS.CUSTOMER_NAME FROM (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A' )A JOIN ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B' )B ON A.CUSTOMER_ID = B.CUSTOMER_ID LEFT JOIN CUSTOMERS ON A.CUSTOMER_ID = CUSTOMERS.CUSTOMER_ID WHERE A.CUSTOMER_ID NOT IN ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C' )"
120,Y,Y,"SELECT A.CUSTOMER_ID, A.CUSTOMER_NAME FROM CUSTOMERS A , ORDERS B WHERE A.CUSTOMER_ID = B.CUSTOMER_ID GROUP BY A.CUSTOMER_ID HAVING SUM(B.PRODUCT_NAME='A') >0 AND SUM(B.PRODUCT_NAME='B') > 0 AND SUM(B.PRODUCT_NAME='C')=0"
121,Y,Y,"SELECT A.CUSTOMER_ID, A.CUSTOMER_NAME FROM CUSTOMERS A INNER JOIN ORDERS B WHERE A.CUSTOMER_ID = B.CUSTOMER_ID GROUP BY A.CUSTOMER_ID HAVING SUM(B.PRODUCT_NAME='A') >0 AND SUM(B.PRODUCT_NAME='B') > 0 AND SUM(B.PRODUCT_NAME='C')=0"
122,Y,Y,"SELECT A.CUSTOMER_ID, A.CUSTOMER_NAME FROM CUSTOMERS A JOIN ORDERS B ON A.CUSTOMER_ID = B.CUSTOMER_ID GROUP BY A.CUSTOMER_ID HAVING SUM(B.PRODUCT_NAME='A') >0 AND SUM(B.PRODUCT_NAME='B') > 0 AND SUM(B.PRODUCT_NAME='C')=0"
123,Y,Y,"SELECT A.CUSTOMER_ID, B.CUSTOMER_NAME FROM (SELECT CUSTOMER_ID FROM ORDERS GROUP BY CUSTOMER_ID HAVING CUSTOMER_ID IN (SELECT DISTINCT(CUSTOMER_ID) FROM ORDERS WHERE PRODUCT_NAME='A') AND CUSTOMER_ID IN (SELECT DISTINCT(CUSTOMER_ID) FROM ORDERS WHERE PRODUCT_NAME='B') AND CUSTOMER_ID NOT IN (SELECT DISTINCT(CUSTOMER_ID) FROM ORDERS WHERE PRODUCT_NAME='C'))A INNER JOIN CUSTOMERS B ON A.CUSTOMER_ID = B.CUSTOMER_ID"
124,Y,Y,"SELECT A.CUSTOMER_ID, B.CUSTOMER_NAME FROM (SELECT CUSTOMER_ID, GROUP_CONCAT(DISTINCT PRODUCT_NAME ORDER BY PRODUCT_NAME ASC)AS PRODUCT_LIST FROM ORDERS GROUP BY CUSTOMER_ID HAVING FIND_IN_SET('A',PRODUCT_LIST) >0 AND FIND_IN_SET('B',PRODUCT_LIST)>0 AND FIND_IN_SET('C',PRODUCT_LIST)=0)A INNER JOIN CUSTOMERS B ON A.CUSTOMER_ID = B.CUSTOMER_ID"
125,Y,Y,"SELECT A.CUSTOMER_ID, B.CUSTOMER_NAME FROM ORDERS AS A LEFT JOIN CUSTOMERS AS B ON A.CUSTOMER_ID=B.CUSTOMER_ID GROUP BY A.CUSTOMER_ID HAVING SUM(IF(A.PRODUCT_NAME='A',1,0))>0 AND SUM(IF(A.PRODUCT_NAME='B',1,0))>0 AND SUM(IF(A.PRODUCT_NAME='C',1,0))=0"
126,Y,Y,"SELECT A.CUSTOMER_ID, C.CUSTOMER_NAME FROM ( SELECT DISTINCT CUSTOMER_ID, PRODUCT_NAME FROM ORDERS WHERE PRODUCT_NAME IN ('A','B','C') )A LEFT JOIN CUSTOMERS C ON A.CUSTOMER_ID = C.CUSTOMER_ID GROUP BY A.CUSTOMER_ID HAVING(SUM(CASE WHEN PRODUCT_NAME = 'A' THEN 1 ELSE 0 END)) =1 AND (SUM(CASE WHEN PRODUCT_NAME = 'B' THEN 1 ELSE 0 END)) =1 AND (SUM(CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END)) =0"
127,Y,Y,"SELECT A.CUSTOMER_ID, C.CUSTOMER_NAME FROM (SELECT E.CUSTOMER_ID FROM ORDERS E JOIN ORDERS F ON E.CUSTOMER_ID=F.CUSTOMER_ID WHERE E.PRODUCT_NAME IN ('A') AND F.PRODUCT_NAME='B' ) A LEFT JOIN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME IN ('C') ) B ON A.CUSTOMER_ID=B.CUSTOMER_ID JOIN CUSTOMERS C ON A.CUSTOMER_ID=C.CUSTOMER_ID WHERE B.CUSTOMER_ID IS NULL GROUP BY A.CUSTOMER_ID ORDER BY A.CUSTOMER_ID"
128,Y,Y,"SELECT A.CUSTOMER_ID, CUSTOMER_NAME FROM (SELECT CUSTOMER_ID, GROUP_CONCAT(DISTINCT PRODUCT_NAME) AS P FROM ORDERS GROUP BY CUSTOMER_ID) A JOIN CUSTOMERS C ON A.CUSTOMER_ID = C.CUSTOMER_ID WHERE P LIKE '%A%B%' AND P NOT LIKE'%C%'"
129,Y,N,"SELECT A.CUSTOMER_ID, CUSTOMER_NAME FROM ORDERS A JOIN ORDERS B ON A.CUSTOMER_ID = B.CUSTOMER_ID JOIN CUSTOMERS C ON A.CUSTOMER_ID = C.CUSTOMER_ID WHERE A.PRODUCT_NAME = 'A' AND B.PRODUCT_NAME = 'B' AND A.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')"
130,Y,N,"SELECT A.CUSTOMER_ID, CUSTOMERS.CUSTOMER_NAME FROM ( SELECT CUSTOMER_ID, SUM(CASE WHEN PRODUCT_NAME ='A' THEN 1 ELSE 0 END) AS A, SUM(CASE WHEN PRODUCT_NAME ='B' THEN 1 ELSE 0 END) AS B, SUM(CASE WHEN PRODUCT_NAME ='C' THEN 1 ELSE 0 END) AS C FROM ORDERS GROUP BY CUSTOMER_ID HAVING A=1 AND B=1 AND C=0) A , CUSTOMERS WHERE A.CUSTOMER_ID=CUSTOMERS.CUSTOMER_ID"
131,Y,Y,"SELECT A.CUSTOMER_ID,B.CUSTOMER_NAME FROM ORDERS A LEFT JOIN CUSTOMERS B ON A.CUSTOMER_ID=B.CUSTOMER_ID GROUP BY 1 HAVING (SUM(PRODUCT_NAME='A')>0 AND SUM(PRODUCT_NAME='B')>0 AND SUM(PRODUCT_NAME='C')=0)"
132,Y,Y,"SELECT A.CUSTOMER_ID,C.CUSTOMER_NAME FROM (SELECT CUSTOMER_ID, SUM(CASE WHEN PRODUCT_NAME='A' THEN 1 ELSE 0 END) A_PUR, SUM(CASE WHEN PRODUCT_NAME='B' THEN 1 ELSE 0 END) AS B_PUR, SUM(CASE WHEN PRODUCT_NAME='C' THEN 1 ELSE 0 END) AS C_PUR FROM ORDERS GROUP BY 1) A INNER JOIN CUSTOMERS C ON A.CUSTOMER_ID=C.CUSTOMER_ID WHERE A_PUR >0 AND B_PUR>0 AND C_PUR=0"
133,Y,Y,"SELECT B.CUSTOMER_ID, B.CUSTOMER_NAME FROM ORDERS A JOIN CUSTOMERS B ON A.CUSTOMER_ID = B.CUSTOMER_ID GROUP BY B.CUSTOMER_ID HAVING SUM(IF(PRODUCT_NAME = 'A',1,0)) > 0 AND SUM(IF(PRODUCT_NAME = 'B',1,0)) > 0 AND SUM(IF(PRODUCT_NAME = 'C',1,0)) = 0 ORDER BY B.CUSTOMER_ID"
134,Y,Y,"SELECT B.CUSTOMER_ID, C.CUSTOMER_NAME FROM (SELECT CUSTOMER_ID, SUM(FLAG) AS FLAGS FROM (SELECT CUSTOMER_ID, CASE WHEN PRODUCT_NAME='C' THEN -1 WHEN PRODUCT_NAME='A' THEN 1 WHEN PRODUCT_NAME='B' THEN 1 ELSE 0 END AS FLAG FROM (SELECT DISTINCT CUSTOMER_ID, PRODUCT_NAME FROM ORDERS WHERE PRODUCT_NAME = 'A' OR PRODUCT_NAME = 'B' OR PRODUCT_NAME = 'C')D) A GROUP BY CUSTOMER_ID )B LEFT JOIN CUSTOMERS C ON B.CUSTOMER_ID = C.CUSTOMER_ID WHERE FLAGS=2"
135,Y,Y,"SELECT B.CUSTOMER_ID,B.CUSTOMER_NAME FROM ( SELECT A.CUSTOMER_ID,A.CUSTOMER_NAME, SUM(CASE WHEN A.PRODUCT_NAME = 'A' THEN 1 ELSE 0 END) AS PRODUCTA, SUM(CASE WHEN A.PRODUCT_NAME = 'B' THEN 1 ELSE 0 END) AS PRODUCTB, SUM(CASE WHEN A.PRODUCT_NAME = 'C' THEN 1 ELSE 0 END) AS PRODUCTC FROM (SELECT ORDERS.CUSTOMER_ID, ORDERS.PRODUCT_NAME, CUSTOMERS.CUSTOMER_NAME FROM ORDERS LEFT JOIN CUSTOMERS ON ORDERS.CUSTOMER_ID = CUSTOMERS.CUSTOMER_ID) A GROUP BY A.CUSTOMER_ID,A.CUSTOMER_NAME ) B WHERE B.PRODUCTA>0 AND B.PRODUCTB>0 AND B.PRODUCTC= 0"
136,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O ON O.CUSTOMER_ID = C.CUSTOMER_ID GROUP BY C.CUSTOMER_ID HAVING SUM(O.PRODUCT_NAME='A') > 0 AND SUM(O.PRODUCT_NAME='B')>0 AND SUM(O.PRODUCT_NAME='C') = 0 ORDER BY C.CUSTOMER_ID"
137,Y,Y,"SELECT C.CUSTOMER_ID , C.CUSTOMER_NAME FROM CUSTOMERS C LEFT JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID GROUP BY C.CUSTOMER_ID HAVING SUM(O.PRODUCT_NAME='A')>0 AND SUM(O.PRODUCT_NAME='B')>0 AND SUM(O.PRODUCT_NAME ='C')= 0"
138,Y,Y,"SELECT C.CUSTOMER_ID AS CUSTOMER_ID, C.CUSTOMER_NAME AS CUSTOMER_NAME FROM CUSTOMERS C INNER JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID GROUP BY C.CUSTOMER_ID HAVING SUM(O.PRODUCT_NAME='A') > 0 AND SUM(O.PRODUCT_NAME='B') > 0 AND SUM(O.PRODUCT_NAME='C') = 0"
139,Y,Y,"SELECT C.CUSTOMER_ID AS CUSTOMER_ID, CUSTOMER_NAME CUSTOMER_NAME FROM (SELECT A.CUSTOMER_ID FROM (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='A' GROUP BY CUSTOMER_ID ) A INNER JOIN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='B' GROUP BY CUSTOMER_ID ) B ON A.CUSTOMER_ID=B.CUSTOMER_ID INNER JOIN (SELECT CC.CUSTOMER_ID FROM (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='C' GROUP BY CUSTOMER_ID) C RIGHT JOIN CUSTOMERS CC ON C.CUSTOMER_ID= CC.CUSTOMER_ID WHERE C.CUSTOMER_ID IS NULL) X ON B.CUSTOMER_ID=X.CUSTOMER_ID) X INNER JOIN CUSTOMERS C ON X.CUSTOMER_ID=C.CUSTOMER_ID ORDER BY C.CUSTOMER_ID"
140,Y,N,"SELECT C.CUSTOMER_ID AS CUSTOMER_ID, C.CUSTOMER_NAME AS CUSTOMER_NAME FROM CUSTOMERS C INNER JOIN ORDERS A ON C.CUSTOMER_ID = A.CUSTOMER_ID AND A.PRODUCT_NAME = 'A' INNER JOIN ORDERS B ON C.CUSTOMER_ID = B.CUSTOMER_ID AND B.PRODUCT_NAME = 'B' LEFT OUTER JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID AND O.PRODUCT_NAME = 'C' WHERE O.ORDER_ID IS NULL"
141,Y,Y,"SELECT C.CUSTOMER_ID AS CUSTOMER_ID, C.CUSTOMER_NAME AS CUSTOMER_NAME FROM CUSTOMERS C LEFT JOIN ORDERS A ON C.CUSTOMER_ID = A.CUSTOMER_ID GROUP BY C.CUSTOMER_ID HAVING SUM(A.PRODUCT_NAME = 'A' ) > 0 AND SUM(A.PRODUCT_NAME = 'B') > 0 AND SUM(A.PRODUCT_NAME = 'C') = 0"
142,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM (SELECT CUSTOMER_ID, PRODUCT_NAME, CASE WHEN PRODUCT_NAME = 'A' THEN 1 WHEN PRODUCT_NAME = 'B' THEN 1 ELSE 0 END AS TAG FROM ORDERS WHERE CUSTOMER_ID NOT IN ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME IN ('C') )) T1 LEFT JOIN CUSTOMERS C ON (T1.CUSTOMER_ID = C.CUSTOMER_ID) WHERE T1.TAG = 1 GROUP BY T1.CUSTOMER_ID HAVING COUNT(DISTINCT PRODUCT_NAME) = 2"
143,Y,N,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS AS C INNER JOIN (SELECT CUSTOMER_ID, SUM(CASE WHEN PRODUCT_NAME = 'A' THEN 1 WHEN PRODUCT_NAME = 'B' THEN 1 WHEN PRODUCT_NAME = 'C' THEN -1 ELSE 0 END) AS TOT FROM ORDERS GROUP BY CUSTOMER_ID HAVING TOT > 1) AS O WHERE C.CUSTOMER_ID = O.CUSTOMER_ID"
144,Y,N,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS AS C JOIN ORDERS AS O ON C.CUSTOMER_ID = O.CUSTOMER_ID GROUP BY 1 HAVING SUM(O.PRODUCT_NAME = 'A') = 1 AND SUM(O.PRODUCT_NAME = 'B') = 1 AND SUM(O.PRODUCT_NAME = 'C') = 0 ORDER BY 1"
145,Y,N,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS AS C LEFT JOIN (SELECT CUSTOMER_ID, PRODUCT_NAME FROM ORDERS WHERE PRODUCT_NAME = 'A') AS T1 ON C.CUSTOMER_ID = T1.CUSTOMER_ID LEFT JOIN (SELECT CUSTOMER_ID, PRODUCT_NAME FROM ORDERS WHERE PRODUCT_NAME = 'B') AS T2 ON C.CUSTOMER_ID = T2.CUSTOMER_ID LEFT JOIN (SELECT CUSTOMER_ID, PRODUCT_NAME FROM ORDERS WHERE PRODUCT_NAME = 'C') AS T3 ON C.CUSTOMER_ID = T3.CUSTOMER_ID WHERE T1.CUSTOMER_ID AND T2.CUSTOMER_ID AND ISNULL(T3.CUSTOMER_ID)"
146,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C LEFT JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID GROUP BY C.CUSTOMER_ID HAVING SUM(PRODUCT_NAME='A')>0 AND SUM(PRODUCT_NAME='B')>0 AND SUM(PRODUCT_NAME='C')=0"
147,Y,N,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS O LEFT JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID WHERE PRODUCT_NAME = 'A' OR PRODUCT_NAME = 'B' GROUP BY CUSTOMER_ID HAVING COUNT(PRODUCT_NAME) = 2 AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')"
148,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS O JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID WHERE C.CUSTOMER_ID IN (SELECT O2.CUSTOMER_ID FROM ORDERS O2 WHERE O2.PRODUCT_NAME = 'A') AND C.CUSTOMER_ID IN (SELECT O2.CUSTOMER_ID FROM ORDERS O2 WHERE O2.PRODUCT_NAME = 'B') AND C.CUSTOMER_ID NOT IN (SELECT O2.CUSTOMER_ID FROM ORDERS O2 WHERE O2.PRODUCT_NAME = 'C') GROUP BY 1,2 ORDER BY 1"
149,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS O JOIN CUSTOMERS C USING(CUSTOMER_ID) GROUP BY O.CUSTOMER_ID HAVING SUM(PRODUCT_NAME='A') > 0 AND SUM(PRODUCT_NAME='B') > 0 AND SUM(PRODUCT_NAME='C') = 0"
150,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C INNER JOIN (SELECT CUSTOMER_ID, SUM(CASE WHEN PRODUCT_NAME = 'A' THEN 1 ELSE 0 END) AS A, SUM(CASE WHEN PRODUCT_NAME = 'B' THEN 1 ELSE 0 END) AS B, SUM(CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END) AS C FROM ORDERS GROUP BY CUSTOMER_ID ) M ON C.CUSTOMER_ID = M.CUSTOMER_ID WHERE M.A > 0 AND M.B > 0 AND M.C = 0"
151,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C INNER JOIN ORDERS O USING (CUSTOMER_ID) GROUP BY 1 HAVING SUM(O.PRODUCT_NAME='A') >=1 AND SUM(O.PRODUCT_NAME='B') >=1 AND SUM(O.PRODUCT_NAME='C')=0"
152,Y,N,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE O.PRODUCT_NAME = 'A' AND C.CUSTOMER_ID IN (SELECT B.CUSTOMER_ID FROM ORDERS B WHERE B.PRODUCT_NAME = 'B') AND C.CUSTOMER_ID NOT IN (SELECT C1.CUSTOMER_ID FROM ORDERS C1 WHERE C1.PRODUCT_NAME = 'C')"
153,Y,N,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O USING(CUSTOMER_ID) WHERE O.PRODUCT_NAME IN ('A', 'B') AND C.CUSTOMER_ID NOT IN ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C' ) GROUP BY O.CUSTOMER_ID HAVING COUNT(O.PRODUCT_NAME) = 2 ORDER BY C.CUSTOMER_ID"
154,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS O JOIN CUSTOMERS C ON C.CUSTOMER_ID = O.CUSTOMER_ID GROUP BY C.CUSTOMER_ID, C.CUSTOMER_NAME HAVING SUM(PRODUCT_NAME='A')>0 AND SUM(PRODUCT_NAME='B')>0 AND SUM(PRODUCT_NAME='C')=0 ORDER BY C.CUSTOMER_ID"
155,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS O LEFT JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID GROUP BY 1,2 HAVING SUM(CASE WHEN PRODUCT_NAME = 'A' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN PRODUCT_NAME = 'B' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END) = 0 ORDER BY 1"
156,Y,N,"SELECT C.CUSTOMER_ID, CU.CUSTOMER_NAME FROM (SELECT O1.CUSTOMER_ID, O3.PRODUCT_NAME FROM ORDERS O1 LEFT JOIN ORDERS O2 ON O1.CUSTOMER_ID = O2.CUSTOMER_ID LEFT JOIN (SELECT CUSTOMER_ID, PRODUCT_NAME FROM ORDERS WHERE PRODUCT_NAME = 'C') O3 ON O3.CUSTOMER_ID = O1.CUSTOMER_ID WHERE O1.PRODUCT_NAME = 'A' AND O2.PRODUCT_NAME = 'B' ) C LEFT JOIN CUSTOMERS CU ON CU.CUSTOMER_ID = C.CUSTOMER_ID WHERE C.PRODUCT_NAME IS NULL"
157,Y,Y,"SELECT C.CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS C INNER JOIN (SELECT CUSTOMER_ID, SUM(CASE WHEN PRODUCT_NAME = 'A' THEN 1 ELSE 0 END) AS COUNT_A, SUM(CASE WHEN PRODUCT_NAME = 'B' THEN 1 ELSE 0 END) AS COUNT_B, SUM(CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END) AS COUNT_C, SUM(CASE WHEN PRODUCT_NAME = 'D' THEN 1 ELSE 0 END) AS COUNT_D FROM ORDERS GROUP BY CUSTOMER_ID HAVING COUNT_A > 0 AND COUNT_B > 0 AND COUNT_C = 0)T ON C.CUSTOMER_ID = T.CUSTOMER_ID ORDER BY 1"
158,Y,Y,"SELECT C.CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS C WHERE C.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND C.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND C.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')"
159,Y,Y,"SELECT C.CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS C, ORDERS O WHERE C.CUSTOMER_ID = O.CUSTOMER_ID AND C.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='A') AND C.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='B') AND C.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='C') GROUP BY 1 ORDER BY 1"
160,Y,N,"SELECT C.CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE (PRODUCT_NAME = 'A' OR PRODUCT_NAME = 'B') AND C.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') GROUP BY C.CUSTOMER_ID, CUSTOMER_NAME HAVING COUNT(CUSTOMER_NAME) = 2 ORDER BY C.CUSTOMER_ID"
161,Y,N,"SELECT C.CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O USING(CUSTOMER_ID) GROUP BY C.CUSTOMER_ID HAVING SUM(CASE WHEN PRODUCT_NAME = 'A' THEN 1 WHEN PRODUCT_NAME = 'B' THEN 1 WHEN PRODUCT_NAME = 'C' THEN -1 ELSE 0 END ) = 2"
162,Y,N,"SELECT C.CUSTOMER_ID, CUSTOMER_NAME FROM ORDERS O LEFT JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID WHERE PRODUCT_NAME = 'A' AND C.CUSTOMER_ID IN ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B' ) AND C.CUSTOMER_ID NOT IN ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C' )"
163,Y,Y,"SELECT C.CUSTOMER_ID,C.CUSTOMER_NAME FROM ( SELECT CUSTOMER_ID , CASE WHEN PRODUCT_NAME = 'A' THEN 1 ELSE 0 END AS A , CASE WHEN PRODUCT_NAME = 'B' THEN 1 ELSE 0 END AS B, CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END AS C, CASE WHEN PRODUCT_NAME = 'D' THEN 1 ELSE 0 END AS D FROM ORDERS ) A INNER JOIN CUSTOMERS C ON C.CUSTOMER_ID = A.CUSTOMER_ID GROUP BY A.CUSTOMER_ID HAVING MAX(A) = 1 AND MAX(B) = 1 AND MAX(C) = 0"
164,Y,Y,"SELECT C.CUSTOMER_ID,C.CUSTOMER_NAME FROM CUSTOMERS C WHERE C.CUSTOMER_ID IN ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='A') AND C.CUSTOMER_ID IN ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='B') AND C.CUSTOMER_ID NOT IN ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='C')"
165,Y,Y,"SELECT C.CUSTOMER_ID,C.CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID=O.CUSTOMER_ID GROUP BY C.CUSTOMER_ID,C.CUSTOMER_NAME HAVING SUM(CASE WHEN O.PRODUCT_NAME ='A' THEN 1 ELSE 0 END) >0 AND SUM(CASE WHEN O.PRODUCT_NAME ='B' THEN 1 ELSE 0 END) >0 AND SUM(CASE WHEN O.PRODUCT_NAME ='C' THEN 1 ELSE 0 END) =0"
166,Y,Y,"SELECT CUST.CUSTOMER_ID ,CUST.CUSTOMER_NAME FROM CUSTOMERS CUST JOIN ORDERS ORD ON CUST.CUSTOMER_ID = ORD.CUSTOMER_ID GROUP BY CUSTOMER_ID HAVING SUM(CASE WHEN PRODUCT_NAME = 'A' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN PRODUCT_NAME = 'B' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END) = 0"
167,Y,Y,"SELECT CUSTOMER_ID AS CUSTOMER_ID, CUSTOMER_NAME AS CUSTOMER_NAME FROM CUSTOMERS WHERE EXISTS(SELECT * FROM ORDERS WHERE ORDERS.CUSTOMER_ID=CUSTOMERS.CUSTOMER_ID AND ORDERS.PRODUCT_NAME='A' ) AND EXISTS(SELECT * FROM ORDERS WHERE ORDERS.CUSTOMER_ID=CUSTOMERS.CUSTOMER_ID AND ORDERS.PRODUCT_NAME = 'B') AND NOT EXISTS(SELECT * FROM ORDERS WHERE ORDERS.CUSTOMER_ID=CUSTOMERS.CUSTOMER_ID AND ORDERS.PRODUCT_NAME= 'C')"
168,N,N,"SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C' ) , BOUGHT_A AS ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A' ) , BOUGHT_B AS ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B' ) SELECT DISTINCT CUSTOMER_ID, CUSTOMER_NAME FROM BOUGHT_A JOIN BOUGHT_B USING (CUSTOMER_ID) LEFT JOIN BOUGHT_C C USING(CUSTOMER_ID) JOIN CUSTOMERS USING (CUSTOMER_ID) WHERE C.CUSTOMER_ID IS NULL"
169,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM ( SELECT C.CUSTOMER_ID AS CUSTOMER_ID, C.CUSTOMER_NAME AS CUSTOMER_NAME, (SUM(PRODUCT_NAME = 'A') >= 1) AND (SUM(PRODUCT_NAME = 'B') >= 1) AND (SUM(PRODUCT_NAME = 'C') = 0) AS COND FROM CUSTOMERS C LEFT JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID GROUP BY C.CUSTOMER_ID ) D WHERE COND = TRUE"
170,Y,N,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM (SELECT O.CUSTOMER_ID, C.CUSTOMER_NAME, SUM(CASE WHEN PRODUCT_NAME = 'A' THEN 100 WHEN PRODUCT_NAME = 'B' THEN 10 WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END) AS PRODUCT_INDEX FROM ORDERS AS O JOIN CUSTOMERS AS C ON O.CUSTOMER_ID = C.CUSTOMER_ID GROUP BY O.CUSTOMER_ID, C.CUSTOMER_NAME) AS TMP WHERE PRODUCT_INDEX = 110"
171,Y,N,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS C WHERE (SELECT COUNT(PRODUCT_NAME) FROM ORDERS WHERE CUSTOMER_ID = C.CUSTOMER_ID AND PRODUCT_NAME IN('A', 'B')) = 2 AND (SELECT COUNT(PRODUCT_NAME) FROM ORDERS WHERE CUSTOMER_ID = C.CUSTOMER_ID AND PRODUCT_NAME = 'C') = 0"
172,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN( SELECT A.CUSTOMER_ID FROM (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='A' ) AS A INNER JOIN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='B' ) AS B ON A.CUSTOMER_ID = B.CUSTOMER_ID WHERE A.CUSTOMER_ID NOT IN( (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='C' )))"
173,Y,N,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN ( SELECT CUSTOMER_ID FROM ( SELECT CUSTOMER_ID, SUM( CASE WHEN PRODUCT_NAME='A' THEN 1 WHEN PRODUCT_NAME='B' THEN 1 WHEN PRODUCT_NAME='C' THEN 3 ELSE 0 END ) AS PRODUCT_SUM FROM ORDERS GROUP BY CUSTOMER_ID) TMP WHERE PRODUCT_SUM=2)"
174,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS GROUP BY CUSTOMER_ID HAVING SUM(PRODUCT_NAME = 'A') >0 AND SUM(PRODUCT_NAME = 'B') >0 AND SUM(PRODUCT_NAME = 'C') = 0)"
175,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A' OR PRODUCT_NAME = 'B' GROUP BY CUSTOMER_ID HAVING COUNT(DISTINCT PRODUCT_NAME) = 2) AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')"
176,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') ORDER BY 1"
177,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND NOT CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') ORDER BY CUSTOMER_ID"
178,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B')"
179,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS LEFT JOIN (SELECT CUSTOMER_ID C, SUM(CASE WHEN PRODUCT_NAME = 'A' THEN 1 ELSE 0 END) A, SUM(CASE WHEN PRODUCT_NAME = 'B' THEN 1 ELSE 0 END) B, SUM(CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END) CC FROM ORDERS GROUP BY CUSTOMER_ID) AS T ON CUSTOMERS.CUSTOMER_ID = T.C WHERE A > 0 AND B > 0 AND CC = 0"
180,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS A WHERE PRODUCT_NAME = 'A' AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C'))"
181,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID NOT IN ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') AND CUSTOMER_ID IN( SELECT CUSTOMER_ID FROM ORDERS GROUP BY CUSTOMER_ID HAVING SUM(PRODUCT_NAME = 'A') > 0 AND SUM(PRODUCT_NAME = 'B') > 0) ORDER BY CUSTOMER_ID"
182,Y,N,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM( SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME, (CASE WHEN PRODUCT_NAME = 'A' THEN 1 WHEN PRODUCT_NAME = 'B' THEN 1 WHEN PRODUCT_NAME = 'C' THEN 5 ELSE 0 END) AS VALUE FROM ORDERS O JOIN CUSTOMERS C ON C.CUSTOMER_ID = O.CUSTOMER_ID GROUP BY CUSTOMER_ID HAVING SUM(VALUE) = 2) A"
183,Y,Y,"SELECT CUSTOMER_ID,CUSTOMER_NAME FROM CUSTOMERS C WHERE CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A' AND CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B')) AND CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C' )"
184,Y,N,"SELECT CUSTOMERS.CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS INNER JOIN ORDERS ON CUSTOMERS.CUSTOMER_ID = ORDERS.CUSTOMER_ID WHERE PRODUCT_NAME = 'A' AND CUSTOMERS.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND CUSTOMERS.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')"
185,Y,Y,"SELECT DISTINCT A1.CUSTOMER_ID AS CUSTOMER_ID, CUSTOMER_NAME FROM ((SELECT CUSTOMER_ID FROM ORDERS WHERE CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')) A1 JOIN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A' ) A2 ON A1.CUSTOMER_ID = A2.CUSTOMER_ID JOIN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B' ) A3 ON A1.CUSTOMER_ID = A3.CUSTOMER_ID) JOIN CUSTOMERS C ON A1.CUSTOMER_ID = C.CUSTOMER_ID"
186,Y,N,"SELECT DISTINCT ORDERS.CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS JOIN ORDERS ON ORDERS.CUSTOMER_ID = CUSTOMERS.CUSTOMER_ID WHERE PRODUCT_NAME IN ('A','B') AND ORDERS.CUSTOMER_ID NOT IN ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME IN ('C') ) GROUP BY CUSTOMER_ID HAVING (COUNT(*)=2)"
187,Y,Y,"SELECT DISTINCT A.CUSTOMER_ID, B.CUSTOMER_NAME FROM ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='A' AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='B') AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='C'))A LEFT JOIN CUSTOMERS B ON A.CUSTOMER_ID=B.CUSTOMER_ID"
188,Y,Y,"SELECT DISTINCT A.CUSTOMER_ID, B.CUSTOMER_NAME FROM ORDERS A INNER JOIN CUSTOMERS B ON A.CUSTOMER_ID = B.CUSTOMER_ID GROUP BY 1,2 HAVING MAX(CASE WHEN PRODUCT_NAME='A' THEN 1 ELSE 0 END) =1 AND MAX(CASE WHEN PRODUCT_NAME='B' THEN 1 ELSE 0 END) =1 AND MAX(CASE WHEN PRODUCT_NAME='C' THEN 1 ELSE 0 END) =0"
189,Y,Y,"SELECT DISTINCT A.CUSTOMER_ID, CUSTOMER_NAME FROM ORDERS A INNER JOIN CUSTOMERS B ON A.CUSTOMER_ID = B.CUSTOMER_ID WHERE PRODUCT_NAME = 'A' AND A.CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND A.CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')"
190,Y,Y,"SELECT DISTINCT C.CUSTOMER_ID CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C INNER JOIN ORDERS O1 ON C.CUSTOMER_ID = O1.CUSTOMER_ID INNER JOIN ORDERS O2 ON C.CUSTOMER_ID = O2.CUSTOMER_ID WHERE O1.PRODUCT_NAME = 'A' AND O2.PRODUCT_NAME = 'B' AND NOT EXISTS (SELECT CUSTOMER_ID FROM ORDERS O3 WHERE C.CUSTOMER_ID = O3.CUSTOMER_ID AND O3.PRODUCT_NAME = 'C')"
191,Y,Y,"SELECT DISTINCT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C, ORDERS O WHERE C.CUSTOMER_ID = O.CUSTOMER_ID AND C.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND C.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND C.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')"
192,Y,N,"SELECT DISTINCT C.CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS C, ORDERS O WHERE C.CUSTOMER_ID = O.CUSTOMER_ID AND PRODUCT_NAME='A' AND CUSTOMER_NAME IN (SELECT DISTINCT CUSTOMER_NAME FROM CUSTOMERS C, ORDERS O WHERE C.CUSTOMER_ID = O.CUSTOMER_ID AND PRODUCT_NAME='B') AND CUSTOMER_NAME NOT IN (SELECT DISTINCT CUSTOMER_NAME FROM CUSTOMERS C, ORDERS O WHERE C.CUSTOMER_ID = O.CUSTOMER_ID AND PRODUCT_NAME='C')"
193,Y,Y,"SELECT DISTINCT CUSTOMER_ID , CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='A') AND CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='B') AND CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='C') ORDER BY CUSTOMER_ID"
194,Y,Y,"SELECT DISTINCT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='C' ) AND CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='A') AND CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='B')"
195,Y,Y,"SELECT DISTINCT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A' ) AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B' )"
196,Y,Y,"SELECT DISTINCT CUSTOMER_ID,CUSTOMER_NAME FROM ( SELECT C.CUSTOMER_ID,C.CUSTOMER_NAME,O.PRODUCT_NAME FROM ORDERS O JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID ) ITM WHERE (CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')) GROUP BY CUSTOMER_ID, CUSTOMER_NAME HAVING SUM(CASE WHEN PRODUCT_NAME = 'A' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN PRODUCT_NAME = 'B' THEN 1 ELSE 0 END) > 0 ORDER BY CUSTOMER_ID"
197,Y,Y,"SELECT DISTINCT O.CUSTOMER_ID AS CUSTOMER_ID, C.CUSTOMER_NAME AS CUSTOMER_NAME FROM ORDERS O JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID WHERE O.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='A') AND O.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='B') AND O.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='C') ORDER BY O.CUSTOMER_ID"
198,Y,Y,"SELECT DISTINCT O.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS O JOIN CUSTOMERS C ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE O.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND O.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND O.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')"
199,Y,Y,"SELECT DISTINCT O.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS O JOIN CUSTOMERS C ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE O.CUSTOMER_ID IN ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A' ) AND O.CUSTOMER_ID IN ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B' ) AND O.CUSTOMER_ID NOT IN ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C' )"
200,Y,N,"SELECT DISTINCT O.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS O JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID WHERE O.PRODUCT_NAME IN ('A','B') GROUP BY O.CUSTOMER_ID HAVING COUNT(O.PRODUCT_NAME) =2 AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')"
201,Y,Y,"SELECT DISTINCT O.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS O LEFT JOIN CUSTOMERS C ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE O.CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='A') AND O.CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='B') AND O.CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') ORDER BY CUSTOMER_ID"
202,Y,Y,"SELECT DISTINCT O.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS O LEFT JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID WHERE O.CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND O.CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND O.CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')"
203,Y,Y,"SELECT DISTINCT O.CUSTOMER_ID,C.CUSTOMER_NAME FROM ORDERS O LEFT JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID WHERE (O.CUSTOMER_ID,'A') IN (SELECT CUSTOMER_ID,PRODUCT_NAME FROM ORDERS) AND (O.CUSTOMER_ID,'B') IN (SELECT CUSTOMER_ID,PRODUCT_NAME FROM ORDERS) AND (O.CUSTOMER_ID,'C') NOT IN (SELECT CUSTOMER_ID,PRODUCT_NAME FROM ORDERS)"
204,Y,Y,"SELECT DISTINCT ORDERS.CUSTOMER_ID, CUSTOMERS.CUSTOMER_NAME FROM ORDERS INNER JOIN CUSTOMERS ON ORDERS.CUSTOMER_ID = CUSTOMERS.CUSTOMER_ID WHERE ORDERS.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND ORDERS.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND ORDERS.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')"
205,Y,Y,"SELECT DISTINCT SUB.A CUSTOMER_ID,SUB.B CUSTOMER_NAME FROM (SELECT O.CUSTOMER_ID A, C.CUSTOMER_NAME B,O.PRODUCT_NAME C FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID=O.CUSTOMER_ID WHERE C.CUSTOMER_ID IN (SELECT O1.CUSTOMER_ID FROM (SELECT CUSTOMER_ID FROM ORDERS O WHERE PRODUCT_NAME='A') AS O1 JOIN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='B')T1 ON O1.CUSTOMER_ID=T1.CUSTOMER_ID) AND C.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='C'))SUB"
206,Y,Y,"SELECT DISTINCT T.CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS T JOIN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='A' ) A USING (CUSTOMER_ID) WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='B') AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='C' )"
207,Y,Y,"SELECT DISTINCT TEMP.CUSTOMER_ID, C.CUSTOMER_NAME FROM ( SELECT O.CUSTOMER_ID FROM ORDERS O WHERE O.PRODUCT_NAME='A' AND O.CUSTOMER_ID IN (SELECT O.CUSTOMER_ID FROM ORDERS O WHERE O.PRODUCT_NAME='B') AND O.CUSTOMER_ID NOT IN (SELECT O.CUSTOMER_ID FROM ORDERS O WHERE O.PRODUCT_NAME='C') ) TEMP INNER JOIN CUSTOMERS C ON TEMP.CUSTOMER_ID=C.CUSTOMER_ID"
208,Y,Y,"SELECT O.CUSTOMER_ID AS CUSTOMER_ID, C.CUSTOMER_NAME AS CUSTOMER_NAME FROM ORDERS AS O JOIN CUSTOMERS AS C ON O.CUSTOMER_ID = C.CUSTOMER_ID GROUP BY O.CUSTOMER_ID HAVING SUM(CASE WHEN O.PRODUCT_NAME = 'C' THEN 1 ELSE 0 END ) = 0 AND SUM(CASE WHEN O.PRODUCT_NAME = 'A' THEN 1 ELSE 0 END ) >=1 AND SUM(CASE WHEN O.PRODUCT_NAME = 'B' THEN 1 ELSE 0 END ) >=1"
209,Y,Y,"SELECT O.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS AS O JOIN CUSTOMERS AS C ON O.CUSTOMER_ID = C.CUSTOMER_ID GROUP BY CUSTOMER_ID HAVING SUM(O.PRODUCT_NAME='A') >0 AND SUM(O.PRODUCT_NAME='B') >0 AND SUM(O.PRODUCT_NAME = 'C')=0"
210,Y,Y,"SELECT O.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS O JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID GROUP BY O.CUSTOMER_ID HAVING SUM(CASE WHEN PRODUCT_NAME = 'A' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN PRODUCT_NAME = 'B' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END) = 0"
211,Y,N,"SELECT O.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS O JOIN CUSTOMERS C ON C.CUSTOMER_ID=O.CUSTOMER_ID WHERE O.PRODUCT_NAME='A' AND O.CUSTOMER_ID IN (SELECT O.CUSTOMER_ID FROM ORDERS O WHERE O.PRODUCT_NAME='B') AND O.CUSTOMER_ID NOT IN (SELECT O.CUSTOMER_ID FROM ORDERS O WHERE O.PRODUCT_NAME='C')"
212,Y,N,"SELECT O.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C LEFT JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE O.PRODUCT_NAME = 'A' OR O.PRODUCT_NAME = 'B' GROUP BY O.CUSTOMER_ID HAVING COUNT(O.PRODUCT_NAME) = 2 AND O.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C' )"
213,Y,Y,"SELECT O.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS AS O JOIN CUSTOMERS AS C USING(CUSTOMER_ID) GROUP BY O.CUSTOMER_ID HAVING SUM(O.PRODUCT_NAME='A')>0 AND SUM(O.PRODUCT_NAME='B')>0 AND SUM(O.PRODUCT_NAME='C')=0 ORDER BY O.CUSTOMER_ID"
214,Y,Y,"SELECT O.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS O JOIN CUSTOMERS C ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE O.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A' ) AND O.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND O.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') GROUP BY O.CUSTOMER_ID"
215,Y,Y,"SELECT O.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS O JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID GROUP BY O.CUSTOMER_ID HAVING SUM(O.PRODUCT_NAME='A')>0 AND SUM(O.PRODUCT_NAME='B')>0 AND SUM(O.PRODUCT_NAME='C')=0"
216,Y,Y,"SELECT O.CUSTOMER_ID, CUSTOMER_NAME FROM ORDERS O INNER JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID WHERE PRODUCT_NAME = 'A' OR PRODUCT_NAME = 'B' AND O.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') GROUP BY 1 HAVING COUNT(DISTINCT PRODUCT_NAME) = 2 ORDER BY 1"
217,Y,N,"SELECT O.CUSTOMER_ID, CUSTOMER_NAME FROM ORDERS O JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID GROUP BY C.CUSTOMER_NAME, O.CUSTOMER_ID HAVING SUM(CASE WHEN O.PRODUCT_NAME IN ('A','B') THEN 1 WHEN O.PRODUCT_NAME IN ('C') THEN 0.5 ELSE 0 END)=2"
218,Y,N,"SELECT O.CUSTOMER_ID, CUSTOMER_NAME FROM ORDERS AS O JOIN CUSTOMERS AS C ON O.CUSTOMER_ID = C.CUSTOMER_ID WHERE PRODUCT_NAME IN ('A', 'B') GROUP BY CUSTOMER_ID HAVING COUNT(PRODUCT_NAME) = 2 AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')"
219,Y,N,"SELECT O.CUSTOMER_ID, CUSTOMER_NAME FROM ORDERS AS O LEFT JOIN CUSTOMERS AS C ON O.CUSTOMER_ID = C.CUSTOMER_ID WHERE PRODUCT_NAME = 'A' OR PRODUCT_NAME = 'B' GROUP BY CUSTOMER_ID HAVING COUNT(PRODUCT_NAME) = 2 AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')"
220,Y,Y,"SELECT O.CUSTOMER_ID, CUSTOMER_NAME FROM ORDERS O JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID GROUP BY O.CUSTOMER_ID HAVING SUM(PRODUCT_NAME='A')>0 AND SUM(PRODUCT_NAME='B')>0 AND SUM(PRODUCT_NAME='C')=0"
221,Y,Y,"SELECT O.CUSTOMER_ID, CUSTOMER_NAME FROM ORDERS O LEFT JOIN CUSTOMERS C ON C.CUSTOMER_ID=O.CUSTOMER_ID GROUP BY CUSTOMER_ID HAVING SUM(IF(PRODUCT_NAME = 'C',1,0 )) = 0 AND SUM(IF(PRODUCT_NAME = 'B',1,0 ))>0 AND SUM(IF(PRODUCT_NAME = 'A',1,0 )) >0"
222,Y,Y,"SELECT O.CUSTOMER_ID,C.CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE O.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND O.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND O.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') GROUP BY O.CUSTOMER_ID"
223,Y,Y,"SELECT O.CUSTOMER_ID,C.CUSTOMER_NAME FROM ORDERS O JOIN CUSTOMERS C ON C.CUSTOMER_ID = O.CUSTOMER_ID GROUP BY O.CUSTOMER_ID HAVING SUM(CASE WHEN O.PRODUCT_NAME = 'A' THEN 1 ELSE 0 END) >= 1 AND SUM(CASE WHEN O.PRODUCT_NAME = 'B' THEN 1 ELSE 0 END) >= 1 AND SUM(CASE WHEN O.PRODUCT_NAME = 'C' THEN 1 ELSE 0 END) = 0"
224,Y,N,"SELECT O1.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS AS O1, ORDERS AS O2, CUSTOMERS AS C WHERE O1.CUSTOMER_ID = C.CUSTOMER_ID AND O1.CUSTOMER_ID = O2.CUSTOMER_ID AND O1.PRODUCT_NAME = 'A' AND O2.PRODUCT_NAME = 'B' AND O1.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') ORDER BY O1.CUSTOMER_ID"
225,Y,N,"SELECT SUB1.CUSTOMER_ID , C.CUSTOMER_NAME FROM ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') SUB1 JOIN ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') SUB2 ON SUB1.CUSTOMER_ID = SUB2.CUSTOMER_ID LEFT JOIN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') SUB3 ON SUB1.CUSTOMER_ID = SUB3.CUSTOMER_ID JOIN CUSTOMERS C ON SUB1.CUSTOMER_ID = C.CUSTOMER_ID WHERE SUB3.CUSTOMER_ID IS NULL"
226,Y,Y,"SELECT T.CUSTOMER_ID, C.CUSTOMER_NAME FROM (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A' OR PRODUCT_NAME='B' GROUP BY CUSTOMER_ID HAVING COUNT(DISTINCT PRODUCT_NAME)=2 )T JOIN CUSTOMERS C ON T.CUSTOMER_ID =C.CUSTOMER_ID WHERE T.CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='C') ORDER BY T.CUSTOMER_ID"
227,Y,Y,"SELECT T.CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS T LEFT JOIN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') A ON T.CUSTOMER_ID = A.CUSTOMER_ID LEFT JOIN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') B ON T.CUSTOMER_ID = B.CUSTOMER_ID LEFT JOIN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') C ON T.CUSTOMER_ID = C.CUSTOMER_ID WHERE A.CUSTOMER_ID IS NOT NULL AND B.CUSTOMER_ID IS NOT NULL AND C.CUSTOMER_ID IS NULL"
228,Y,N,"SELECT T1.CUSTOMER_ID,CUSTOMER_NAME FROM ORDERS T1 JOIN ORDERS T2 JOIN CUSTOMERS ON T1.CUSTOMER_ID = T2.CUSTOMER_ID AND T1.PRODUCT_NAME = 'A' AND T2.PRODUCT_NAME = 'B' AND T1.CUSTOMER_ID = CUSTOMERS.CUSTOMER_ID WHERE T1.CUSTOMER_ID NOT IN ( SELECT T1.CUSTOMER_ID FROM ORDERS T1 JOIN ORDERS T2 JOIN ORDERS T3 ON T1.CUSTOMER_ID = T2.CUSTOMER_ID AND T3.CUSTOMER_ID = T2.CUSTOMER_ID AND T1.PRODUCT_NAME = 'A' AND T2.PRODUCT_NAME = 'B' AND T3.PRODUCT_NAME = 'C')"
229,Y,Y,"SELECT TMP.CUSTOMER_ID, C.CUSTOMER_NAME FROM( SELECT CUSTOMER_ID, CASE WHEN SUM(BOUGHT_A)>=1 AND SUM(BOUGHT_B)>=1 AND SUM(BOUGHT_C)=0 THEN 1 ELSE 0 END AS BOUGHT_AB_NOT_C FROM ( SELECT CUSTOMER_ID, CASE WHEN PRODUCT_NAME IN ('A') THEN 1 ELSE 0 END AS BOUGHT_A, CASE WHEN PRODUCT_NAME IN ('B') THEN 1 ELSE 0 END AS BOUGHT_B, CASE WHEN PRODUCT_NAME IN ('C') THEN 1 ELSE 0 END AS BOUGHT_C FROM ORDERS ) A GROUP BY 1 ) TMP LEFT JOIN CUSTOMERS C ON C.CUSTOMER_ID=TMP.CUSTOMER_ID WHERE BOUGHT_AB_NOT_C=1"
230,Y,Y,WITH AB AS ( SELECT O1.CUSTOMER_ID FROM ORDERS O1 INNER JOIN ORDERS O2 ON O1.CUSTOMER_ID = O2.CUSTOMER_ID WHERE O1.PRODUCT_NAME = 'A' AND O2.PRODUCT_NAME = 'B' ) SELECT * FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT * FROM AB) AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')
231,Y,N,"WITH AB AS (SELECT C.CUSTOMER_ID ID, C.CUSTOMER_NAME NAME FROM CUSTOMERS C JOIN ORDERS O ON O.CUSTOMER_ID = C.CUSTOMER_ID JOIN ORDERS O2 ON O2.CUSTOMER_ID = C.CUSTOMER_ID WHERE O.PRODUCT_NAME = 'A' AND O2.PRODUCT_NAME = 'B'), HAVEC AS (SELECT C2.CUSTOMER_ID ID2 , C2.CUSTOMER_NAME NAME2 FROM CUSTOMERS C2 JOIN ORDERS O4 ON O4.CUSTOMER_ID = C2.CUSTOMER_ID WHERE O4.PRODUCT_NAME = 'C'), JOINER AS (SELECT * FROM AB LEFT JOIN HAVEC ON AB.ID = HAVEC.ID2) SELECT ID CUSTOMER_ID , NAME CUSTOMER_NAME FROM JOINER WHERE ID2 IS NULL"
232,Y,N,"WITH CTE1 AS (SELECT CUSTOMER_ID FROM ORDERS WHERE CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND PRODUCT_NAME = 'A' AND CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')) SELECT CTE1.CUSTOMER_ID, CUSTOMER_NAME FROM CTE1 JOIN CUSTOMERS C ON C.CUSTOMER_ID = CTE1.CUSTOMER_ID ORDER BY CTE1.CUSTOMER_ID"
233,Y,N,"WITH A AS ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A'), B AS (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') SELECT A.CUSTOMER_ID, C.CUSTOMER_NAME FROM A JOIN B ON A.CUSTOMER_ID = B.CUSTOMER_ID JOIN CUSTOMERS C ON A.CUSTOMER_ID = C.CUSTOMER_ID AND A.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')"
234,Y,Y,"WITH AGG AS ( SELECT T1.CUSTOMER_ID, T2.CUSTOMER_NAME, SUM(CASE WHEN T1.PRODUCT_NAME = 'A' THEN 1 ELSE 0 END) AS NUM_A, SUM(CASE WHEN T1.PRODUCT_NAME = 'B' THEN 1 ELSE 0 END) AS NUM_B, SUM(CASE WHEN T1.PRODUCT_NAME = 'C' THEN 1 ELSE 0 END) AS NUM_C FROM ORDERS T1 INNER JOIN CUSTOMERS T2 ON T1.CUSTOMER_ID = T2.CUSTOMER_ID GROUP BY T1.CUSTOMER_ID ) SELECT CUSTOMER_ID, CUSTOMER_NAME FROM AGG WHERE NUM_A > 0 AND NUM_B > 0 AND NUM_C = 0"
235,Y,Y,"WITH BASE AS ( SELECT CC.CUSTOMER_ID , CC.CUSTOMER_NAME , SUM(CASE WHEN OO.PRODUCT_NAME = 'A' THEN 1 ELSE 0 END) AS A_COUNT , SUM(CASE WHEN OO.PRODUCT_NAME = 'B' THEN 1 ELSE 0 END) AS B_COUNT , SUM(CASE WHEN OO.PRODUCT_NAME = 'C' THEN 1 ELSE 0 END) AS C_COUNT FROM CUSTOMERS CC JOIN ORDERS OO ON CC.CUSTOMER_ID = OO.CUSTOMER_ID GROUP BY 1,2 ) SELECT CUSTOMER_ID , CUSTOMER_NAME FROM BASE WHERE A_COUNT >= 1 AND B_COUNT >= 1 AND C_COUNT = 0"
236,Y,Y,"WITH BOTH_AB_ID AS (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A' AND CUSTOMER_ID IN ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') ), TARGET_ID AS ( SELECT DISTINCT CUSTOMER_ID FROM BOTH_AB_ID WHERE CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C' ) ) SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN ( SELECT CUSTOMER_ID FROM TARGET_ID) ORDER BY CUSTOMER_ID"
237,Y,Y,"WITH BOUGHTAB AS ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME IN ('A','B') GROUP BY CUSTOMER_ID HAVING COUNT(DISTINCT PRODUCT_NAME) =2 ), BOUGHTC AS ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME IN ('C') ) SELECT * FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT * FROM BOUGHTAB) AND CUSTOMER_ID NOT IN (SELECT * FROM BOUGHTC)"
238,Y,Y,"WITH BOUGHT_A AS ( SELECT C.CUSTOMER_ID ,C.CUSTOMER_NAME, O.PRODUCT_NAME FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE O.PRODUCT_NAME = 'A' ), BOUGHT_B AS ( SELECT C.CUSTOMER_ID ,C.CUSTOMER_NAME, O.PRODUCT_NAME FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE O.PRODUCT_NAME = 'B') ,BOUGHT_C AS ( SELECT C.CUSTOMER_ID,C.CUSTOMER_NAME , O.PRODUCT_NAME FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE O.PRODUCT_NAME = 'C' ) SELECT DISTINCT A.CUSTOMER_ID, A.CUSTOMER_NAME FROM BOUGHT_A A JOIN BOUGHT_B B ON A.CUSTOMER_ID = B.CUSTOMER_ID WHERE A.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM BOUGHT_C WHERE PRODUCT_NAME = 'C')"
239,Y,Y,"WITH BOUGHT_A AS ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A' ), BOUGHT_B AS ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B' ), BOUGHT_C AS ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C' ) SELECT BOUGHT_A.CUSTOMER_ID, CUSTOMERS.CUSTOMER_NAME FROM BOUGHT_A INNER JOIN BOUGHT_B USING (CUSTOMER_ID) INNER JOIN CUSTOMERS USING (CUSTOMER_ID) WHERE BOUGHT_A.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM BOUGHT_C)"
240,Y,N,"WITH BOUGHT_AB AS (SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C LEFT JOIN ORDERS O USING(CUSTOMER_ID) WHERE PRODUCT_NAME = 'A' OR PRODUCT_NAME = 'B' GROUP BY 1,2 HAVING COUNT(PRODUCT_NAME)>=2) SELECT CUSTOMER_ID, CUSTOMER_NAME FROM BOUGHT_AB WHERE CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')"
241,Y,Y,"WITH CTE AS ( SELECT A.CID AS CUSTOMERID FROM (SELECT CUSTOMER_ID AS CID FROM ORDERS WHERE PRODUCT_NAME = 'A' ) A JOIN (SELECT CUSTOMER_ID AS CID FROM ORDERS WHERE PRODUCT_NAME = 'B') B ON A.CID = B.CID WHERE A.CID NOT IN (SELECT DISTINCT CUSTOMER_ID AS CID FROM ORDERS WHERE PRODUCT_NAME = 'C') ) SELECT DISTINCT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C JOIN CTE ON C.CUSTOMER_ID = CTE.CUSTOMERID"
242,Y,Y,"WITH CTE AS ( SELECT A.CID AS CUSTOMERID FROM (SELECT CUSTOMER_ID AS CID FROM ORDERS WHERE PRODUCT_NAME = 'A' ) A JOIN (SELECT CUSTOMER_ID AS CID FROM ORDERS WHERE PRODUCT_NAME = 'B') B ON A.CID = B.CID WHERE A.CID NOT IN (SELECT DISTINCT CUSTOMER_ID AS CID FROM ORDERS WHERE PRODUCT_NAME = 'C') ) SELECT DISTINCT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C JOIN CTE ON C.CUSTOMER_ID = CTE.CUSTOMERID ORDER BY C.CUSTOMER_ID"
243,Y,Y,"WITH CTE AS ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') SELECT DISTINCT O.CUSTOMER_ID, CUSTOMER_NAME FROM ORDERS O JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID WHERE O.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND O.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND O.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='C')"
244,Y,Y,"WITH CTE AS ( SELECT CUSTOMER_ID FROM(SELECT CUSTOMER_ID, CASE WHEN PRODUCT_NAME IN ('A') THEN 1 ELSE 0 END AS A FROM ORDERS) X WHERE A <> 0 ), CTE1 AS (SELECT CUSTOMER_ID FROM(SELECT CUSTOMER_ID, CASE WHEN PRODUCT_NAME IN ('B') THEN 1 ELSE 0 END AS B FROM ORDERS) X WHERE B <> 0 ), CTE2 AS ( SELECT CUSTOMER_ID FROM(SELECT CUSTOMER_ID, CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END AS C FROM ORDERS) Y WHERE C = 1) SELECT DISTINCT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT * FROM CTE) AND CUSTOMER_ID IN (SELECT * FROM CTE1) AND CUSTOMER_ID NOT IN (SELECT * FROM CTE2) ORDER BY 1"
245,Y,Y,"WITH CTE AS ( SELECT CUSTOMER_ID, SUM(CASE WHEN PRODUCT_NAME = 'A' THEN 1 ELSE 0 END ) AS A, SUM(CASE WHEN PRODUCT_NAME = 'B' THEN 1 ELSE 0 END ) AS B, SUM(CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END ) AS C FROM ORDERS GROUP BY 1 ) SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN ( SELECT CUSTOMER_ID FROM CTE WHERE A > 0 AND B > 0 AND C = 0 ) ORDER BY 1"
246,Y,Y,"WITH CTE AS ( SELECT CUSTOMER_ID, SUM(CASE WHEN PRODUCT_NAME='A' THEN 1 ELSE 0 END) PROD_A, SUM(CASE WHEN PRODUCT_NAME='B' THEN 1 ELSE 0 END) PROD_B, SUM(CASE WHEN PRODUCT_NAME='C' THEN 1 ELSE 0 END) PROD_C FROM ORDERS GROUP BY CUSTOMER_ID ) SELECT CTE.CUSTOMER_ID,CUSTOMER_NAME FROM CTE, CUSTOMERS C WHERE C.CUSTOMER_ID = CTE.CUSTOMER_ID AND PROD_A>0 AND PROD_B>0 AND PROD_C=0"
247,Y,N,"WITH CTE AS ( SELECT CUSTOMER_NAME, O.CUSTOMER_ID, SUM( CASE WHEN PRODUCT_NAME IN ('A','B') THEN 1 WHEN PRODUCT_NAME = 'C' THEN -1 END) SUMS FROM ORDERS O INNER JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID GROUP BY CUSTOMER_NAME, O.CUSTOMER_ID ) SELECT CUSTOMER_ID,CUSTOMER_NAME FROM CTE WHERE SUMS =2"
248,Y,Y,"WITH CTE AS ( SELECT DISTINCT A.CUSTOMER_ID FROM ORDERS A INNER JOIN ORDERS B ON A.CUSTOMER_ID = B.CUSTOMER_ID WHERE A.PRODUCT_NAME = 'A' AND B.PRODUCT_NAME = 'B' AND A.CUSTOMER_ID NOT IN ( SELECT DISTINCT C.CUSTOMER_ID FROM ORDERS C WHERE C.PRODUCT_NAME = 'C' ) ) SELECT CTE.CUSTOMER_ID , C.CUSTOMER_NAME FROM CTE INNER JOIN CUSTOMERS C ON CTE.CUSTOMER_ID = C.CUSTOMER_ID ORDER BY 1"
249,Y,N,"WITH CTE AS ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') AND PRODUCT_NAME ='A' ) SELECT CUSTOMER_ID,CUSTOMER_NAME FROM ORDERS JOIN CUSTOMERS USING (CUSTOMER_ID) WHERE CUSTOMER_ID IN (SELECT * FROM CTE ) AND PRODUCT_NAME ='B'"
250,Y,N,"WITH CTE AS (SELECT C.CUSTOMER_NAME, O.CUSTOMER_ID, O.PRODUCT_NAME, SUM(IF(PRODUCT_NAME='A', 1, 0)) AS A, SUM(IF(PRODUCT_NAME='B', 1, 0)) AS B, SUM(IF(PRODUCT_NAME='C', 1, 0)) AS C, SUM(IF(PRODUCT_NAME='D', 1, 0)) AS D FROM ORDERS O JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID GROUP BY O.CUSTOMER_ID) SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CTE WHERE A=1 AND B=1 AND C=0"
251,Y,Y,"WITH CTE AS (SELECT O.CUSTOMER_ID ,CUSTOMER_NAME , PRODUCT_NAME FROM CUSTOMERS C LEFT JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID) SELECT DISTINCT CUSTOMER_ID ,CUSTOMER_NAME FROM CTE WHERE PRODUCT_NAME IN ('A') AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM CTE WHERE PRODUCT_NAME ='C') AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM CTE WHERE PRODUCT_NAME ='B')"
252,Y,Y,"WITH CTE AS( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') , CTE2 AS(SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B' ) , CTE3 AS( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C' ) SELECT DISTINCT CUSTOMER_ID, CUSTOMER_NAME FROM ORDERS JOIN CUSTOMERS C USING (CUSTOMER_ID) WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM CTE) AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM CTE2) AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM CTE3)"
253,Y,Y,"WITH CTE AS( SELECT CUSTOMER_ID, SUM(CASE WHEN PRODUCT_NAME='A' THEN 1 ELSE 0 END) AS A, SUM(CASE WHEN PRODUCT_NAME='B' THEN 1 ELSE 0 END) AS B, SUM(CASE WHEN PRODUCT_NAME='C' THEN 1 ELSE 0 END) AS C FROM ORDERS GROUP BY CUSTOMER_ID) SELECT CTE.CUSTOMER_ID, C.CUSTOMER_NAME FROM CTE JOIN CUSTOMERS C ON CTE.CUSTOMER_ID = C.CUSTOMER_ID WHERE A >= 1 AND B>=1 AND C=0"
254,Y,N,"WITH CTE AS( SELECT ORDER_ID, CUSTOMER_ID, PRODUCT_NAME FROM ORDERS WHERE PRODUCT_NAME = 'A' OR PRODUCT_NAME = 'B'), CTE2 AS( SELECT CUSTOMER_ID, COUNT(PRODUCT_NAME) AS N FROM CTE GROUP BY 1), CTE3 AS( SELECT CUSTOMER_ID FROM CTE2 WHERE N = 2), CTE4 AS( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') SELECT DISTINCT O.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS O JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID WHERE O.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM CTE3) AND O.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM CTE4)"
255,Y,Y,"WITH CTE AS( SELECT ORDER_ID, ORDERS.CUSTOMER_ID, CUSTOMER_NAME, CASE WHEN PRODUCT_NAME = 'A' THEN 1 ELSE 0 END AS A, CASE WHEN PRODUCT_NAME = 'B' THEN 1 ELSE 0 END AS B, CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END AS C FROM ORDERS LEFT JOIN CUSTOMERS ON ORDERS.CUSTOMER_ID=CUSTOMERS.CUSTOMER_ID) SELECT CUSTOMER_ID,CUSTOMER_NAME FROM( SELECT CUSTOMER_ID,CUSTOMER_NAME,SUM(A) AS A,SUM(B) AS B,SUM(C) AS C FROM CTE GROUP BY CUSTOMER_ID ) AS T WHERE A>=1 AND B>=1 AND C=0"
256,Y,Y,"WITH CTE AS(SELECT CUSTOMER_ID, GROUP_CONCAT(PRODUCT_NAME) AS CONCAT FROM ORDERS GROUP BY CUSTOMER_ID) SELECT C.CUSTOMER_ID AS CUSTOMER_ID, C.CUSTOMER_NAME AS CUSTOMER_NAME FROM CTE JOIN CUSTOMERS AS C ON CTE.CUSTOMER_ID = C.CUSTOMER_ID WHERE (CTE.CONCAT LIKE '%A%B%' AND CTE.CONCAT NOT LIKE '%C%' OR CTE.CONCAT LIKE '%B%A%' AND CTE.CONCAT NOT LIKE '%C%' )"
257,Y,Y,"WITH CTE1 AS (SELECT CUSTOMER_ID FROM ORDERS WHERE CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')), CTE2 AS (SELECT CUSTOMER_ID FROM CTE1 WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A' )), CTE3 AS (SELECT CUSTOMER_ID FROM CTE2 WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B')) SELECT DISTINCT CTE3.CUSTOMER_ID, CUSTOMER_NAME FROM CTE3 INNER JOIN CUSTOMERS ON CTE3.CUSTOMER_ID = CUSTOMERS.CUSTOMER_ID ORDER BY 1"
258,Y,Y,"WITH CUS_A AS (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME LIKE A ), CUS_B AS (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME LIKE B ), CUS_C AS (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME LIKE C ) SELECT DISTINCT C.CUSTOMER_ID , C.CUSTOMER_NAME FROM CUSTOMERS C WHERE C.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM CUS_A) AND C.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM CUS_B) AND C.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM CUS_C)"
259,Y,N,"WITH CUST_A AS (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A'), CUST_B AS (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') SELECT CUST_A.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUST_A INNER JOIN CUST_B ON CUST_A.CUSTOMER_ID = CUST_B.CUSTOMER_ID INNER JOIN CUSTOMERS C ON CUST_A.CUSTOMER_ID = C.CUSTOMER_ID WHERE CUST_A.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')"
260,Y,Y,"WITH CUSTOMERS_WHO_ORDERED_A AS ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A' ), CUSTOMERS_WHO_ORDERED_B AS ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B' ), CUSTOMERS_WHO_ORDERED_C AS ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C' ), CUSTOMERS_ORDERED_AB_NOT_C AS ( SELECT A.CUSTOMER_ID FROM CUSTOMERS_WHO_ORDERED_A A, CUSTOMERS_WHO_ORDERED_B B WHERE A.CUSTOMER_ID = B.CUSTOMER_ID AND A.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM CUSTOMERS_WHO_ORDERED_C) ) SELECT CU.CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS_ORDERED_AB_NOT_C C JOIN CUSTOMERS CU ON CU.CUSTOMER_ID = C.CUSTOMER_ID"
261,Y,Y,"WITH FINAL1 AS ( WITH FINAL AS ( WITH CONSOLIDATED AS ( SELECT C.CUSTOMER_ID,C.CUSTOMER_NAME,O.PRODUCT_NAME FROM CUSTOMERS C INNER JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID ) SELECT * , CASE WHEN PRODUCT_NAME = 'A' THEN 1 ELSE 0 END AS PRODUCT_A_CHECK , CASE WHEN PRODUCT_NAME = 'B' THEN 1 ELSE 0 END AS PRODUCT_B_CHECK , CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END AS PRODUCT_C_CHECK FROM CONSOLIDATED ) SELECT CUSTOMER_ID,CUSTOMER_NAME, SUM(PRODUCT_A_CHECK) AS SUM_A, SUM(PRODUCT_B_CHECK) AS SUM_B, SUM(PRODUCT_C_CHECK) AS SUM_C FROM FINAL GROUP BY CUSTOMER_ID ) SELECT CUSTOMER_ID,CUSTOMER_NAME FROM FINAL1 WHERE SUM_A <> 0 AND SUM_B <> 0 AND SUM_C = 0"
262,Y,Y,"WITH LEFTY AS (SELECT DISTINCT C.CUSTOMER_ID, CUSTOMER_NAME, O.PRODUCT_NAME FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE O.PRODUCT_NAME = 'A' OR O.PRODUCT_NAME = 'B') SELECT CUSTOMER_ID, CUSTOMER_NAME FROM LEFTY WHERE CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS O WHERE PRODUCT_NAME = 'C') GROUP BY CUSTOMER_ID HAVING COUNT(*) = 2"
263,Y,Y,"WITH LEFTY AS (SELECT DISTINCT C.CUSTOMER_ID, CUSTOMER_NAME, O.PRODUCT_NAME FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE O.PRODUCT_NAME = 'A' OR O.PRODUCT_NAME = 'B'), RIGHTY AS ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS O WHERE PRODUCT_NAME = 'C' ) SELECT CUSTOMER_ID, CUSTOMER_NAME FROM LEFTY WHERE CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM RIGHTY) GROUP BY CUSTOMER_ID HAVING COUNT(*) = 2"
264,Y,N,"WITH ORDER_AB AS ( SELECT CUSTOMER_ID, SUM(CASE WHEN PRODUCT_NAME ='C' THEN -1 WHEN PRODUCT_NAME ='A' THEN 0.5 WHEN PRODUCT_NAME ='B' THEN 0.5 ELSE 0 END ) AS PRODUCT_COUNT FROM ORDERS GROUP BY CUSTOMER_ID HAVING PRODUCT_COUNT = 1) SELECT A.CUSTOMER_ID, B.CUSTOMER_NAME FROM ORDER_AB A LEFT JOIN CUSTOMERS B ON A.CUSTOMER_ID = B.CUSTOMER_ID"
265,Y,Y,"WITH ORDER_COUNT AS ( SELECT CUSTOMER_ID, SUM(CASE WHEN PRODUCT_NAME = 'A' THEN 1 ELSE 0 END) AS PRODUCT_A, SUM(CASE WHEN PRODUCT_NAME = 'B' THEN 1 ELSE 0 END) AS PRODUCT_B, SUM(CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END) AS PRODUCT_C FROM ORDERS GROUP BY CUSTOMER_ID) SELECT A.CUSTOMER_ID,A.CUSTOMER_NAME FROM CUSTOMERS A JOIN ORDER_COUNT OC ON A.CUSTOMER_ID=OC.CUSTOMER_ID AND OC.PRODUCT_A >0 AND OC.PRODUCT_B >0 AND OC.PRODUCT_C =0"
266,Y,N,"WITH PRODA AS ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A' ), PRODB AS ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B' ), PRODC AS ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C' ) SELECT U.* FROM CUSTOMERS U JOIN PRODA ON U.CUSTOMER_ID = PRODA.CUSTOMER_ID JOIN PRODB ON U.CUSTOMER_ID = PRODB.CUSTOMER_ID LEFT JOIN PRODC ON U.CUSTOMER_ID = PRODC.CUSTOMER_ID WHERE PRODC.CUSTOMER_ID IS NULL"
267,Y,Y,"WITH REFINED AS( SELECT CUSTOMER_ID, SUM(CASE WHEN PRODUCT_NAME = 'A' THEN 1 ELSE 0 END) AS A, SUM(CASE WHEN PRODUCT_NAME = 'B' THEN 1 ELSE 0 END) AS B, SUM(CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END) AS C FROM ORDERS GROUP BY 1) SELECT R.CUSTOMER_ID, C.CUSTOMER_NAME FROM REFINED R LEFT JOIN CUSTOMERS C ON R.CUSTOMER_ID = C.CUSTOMER_ID WHERE R.A > 0 AND R.B > 0 AND R.C = 0"
268,Y,Y,"WITH SUBTABLE AS (SELECT CUSTOMER_ID, PRODUCT_NAME FROM ORDERS GROUP BY CUSTOMER_ID, PRODUCT_NAME), TABLE2 AS (SELECT CUSTOMER_ID , SUM(CASE WHEN PRODUCT_NAME = 'A' THEN 1 WHEN PRODUCT_NAME = 'B' THEN 1 WHEN PRODUCT_NAME = 'C' THEN -1 ELSE 0 END) AS PERSON_VALUE FROM SUBTABLE GROUP BY CUSTOMER_ID) SELECT T.CUSTOMER_ID, C.CUSTOMER_NAME FROM TABLE2 AS T LEFT JOIN CUSTOMERS AS C ON C.CUSTOMER_ID = T.CUSTOMER_ID WHERE PERSON_VALUE = 2"
269,Y,Y,"WITH T AS ( SELECT CUSTOMER_ID, CASE WHEN PRODUCT_NAME = 'A' THEN 1 ELSE 0 END AS AFLAG, CASE WHEN PRODUCT_NAME = 'B' THEN 1 ELSE 0 END AS BFLAG, CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END AS CFLAG FROM ORDERS ) SELECT C.CUSTOMER_ID,C.CUSTOMER_NAME FROM T JOIN CUSTOMERS C ON C.CUSTOMER_ID = T.CUSTOMER_ID GROUP BY 1 HAVING SUM(AFLAG) > 0 AND SUM(BFLAG) >0 AND SUM(CFLAG) = 0"
270,Y,N,"WITH T AS ( SELECT CUSTOMER_ID, SUM(IF(PRODUCT_NAME='A' OR PRODUCT_NAME='B', 1, 0)) AB, SUM(IF(PRODUCT_NAME='C', 1, 0)) C FROM ORDERS GROUP BY CUSTOMER_ID ) SELECT T.CUSTOMER_ID, C.CUSTOMER_NAME FROM T JOIN CUSTOMERS C ON T.CUSTOMER_ID=C.CUSTOMER_ID WHERE T.AB=2 AND T.C=0"
271,Y,Y,"WITH T1 AS ( SELECT CUSTOMER_ID,PRODUCT_NAME,COUNT(1)CN FROM ORDERS GROUP BY CUSTOMER_ID,PRODUCT_NAME ), GET_TRANS AS ( SELECT CUSTOMER_ID, SUM( CASE WHEN PRODUCT_NAME = 'A' THEN CN END ) AS A, SUM( CASE WHEN PRODUCT_NAME = 'B' THEN CN END) AS B, SUM(CASE WHEN PRODUCT_NAME = 'C' THEN CN END )C FROM T1 GROUP BY 1) SELECT G.CUSTOMER_ID,C.CUSTOMER_NAME FROM GET_TRANS G JOIN CUSTOMERS C ON G.CUSTOMER_ID = C.CUSTOMER_ID WHERE A>0 AND B>0 AND C IS NULL ORDER BY 1"
272,Y,N,"WITH T1 AS (SELECT DISTINCT(C.CUSTOMER_ID) ID FROM CUSTOMERS C JOIN ORDERS O USING(CUSTOMER_ID) WHERE PRODUCT_NAME = 'C') SELECT O1.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS O1 JOIN ORDERS O2 USING (CUSTOMER_ID) JOIN CUSTOMERS C USING(CUSTOMER_ID) WHERE O1.PRODUCT_NAME = 'A' AND O2.PRODUCT_NAME = 'B' AND CUSTOMER_ID NOT IN(SELECT ID FROM T1)"
273,Y,Y,"WITH TEMP AS ( SELECT DISTINCT CUSTOMER_ID, PRODUCT_NAME FROM ORDERS ) SELECT T.CUSTOMER_ID, C.CUSTOMER_NAME FROM TEMP T LEFT JOIN CUSTOMERS C ON T.CUSTOMER_ID = C.CUSTOMER_ID GROUP BY CUSTOMER_ID HAVING SUM(CASE PRODUCT_NAME WHEN 'A' THEN 1 WHEN 'B' THEN 2 WHEN 'C' THEN 4 ELSE 0 END) = 3"
274,Y,Y,"WITH TEMP AS ( SELECT DISTINCT CUSTOMER_ID, PRODUCT_NAME FROM ORDERS ) SELECT T.CUSTOMER_ID, C.CUSTOMER_NAME FROM TEMP T LEFT JOIN CUSTOMERS C ON T.CUSTOMER_ID = C.CUSTOMER_ID GROUP BY CUSTOMER_ID HAVING SUM(PRODUCT_NAME = 'A') > 0 AND SUM(PRODUCT_NAME = 'B') > 0 AND SUM(PRODUCT_NAME = 'C') = 0"
275,Y,Y,"WITH TEMP1 AS ( SELECT DISTINCT O1.CUSTOMER_ID FROM ORDERS O1, ORDERS O2 WHERE O1.CUSTOMER_ID = O2.CUSTOMER_ID AND O1.PRODUCT_NAME = 'A' AND O2.PRODUCT_NAME = 'B' ), TEMP2 AS ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C' ) SELECT T1.CUSTOMER_ID, CUSTOMER_NAME FROM TEMP1 T1 LEFT JOIN TEMP2 T2 ON T1.CUSTOMER_ID = T2.CUSTOMER_ID JOIN CUSTOMERS C ON T1.CUSTOMER_ID = C.CUSTOMER_ID WHERE T2.CUSTOMER_ID IS NULL"
276,Y,Y,"WITH TMP AS ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C' ), TMP2 AS ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A' AND NOT CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM TMP) ), TMP3 AS ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B' AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM TMP2) AND NOT CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM TMP) ) SELECT C.CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS C JOIN TMP3 T ON C.CUSTOMER_ID = T.CUSTOMER_ID ORDER BY CUSTOMER_ID"
277,Y,N,"WITH CTE AS (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A' ) SELECT C.CUSTOMER_ID, CUSTOMER_NAME FROM (SELECT CUSTOMER_ID FROM ORDERS O WHERE PRODUCT_NAME = 'B' AND CUSTOMER_ID IN (SELECT * FROM CTE) AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C' ) ) AS K LEFT JOIN CUSTOMERS AS C ON C.CUSTOMER_ID = K.CUSTOMER_ID"
278,Y,Y,"SELECT CUSTOMER_ID,CUSTOMER_NAME FROM CUSTOMERS JOIN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS GROUP BY CUSTOMER_ID HAVING SUM(PRODUCT_NAME='A')>=1 AND SUM(PRODUCT_NAME='B')>=1 AND SUM(PRODUCT_NAME='C')<1)T USING(CUSTOMER_ID)"
279,Y,N,"WITH CTE AS ( SELECT CUSTOMER_ID, PRODUCT_NAME, ROW_NUMBER() OVER(PARTITION BY CUSTOMER_ID ORDER BY PRODUCT_NAME) AS P_NAME FROM ORDERS ), CTE2 AS ( SELECT CUSTOMER_ID,PRODUCT_NAME FROM CTE WHERE P_NAME IN (1,2) AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM CTE WHERE PRODUCT_NAME = 'C' AND P_NAME = 3) AND PRODUCT_NAME IN ('A','B') GROUP BY CUSTOMER_ID HAVING COUNT(PRODUCT_NAME) = 2 ) SELECT P.CUSTOMER_ID, C.CUSTOMER_NAME FROM CTE2 P INNER JOIN CUSTOMERS C ON P.CUSTOMER_ID = C.CUSTOMER_ID"
280,Y,N,"SELECT C.CUSTOMER_ID AS CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS C RIGHT JOIN (SELECT CUSTOMER_ID FROM (SELECT CUSTOMER_ID, SUM(CASE WHEN PRODUCT_NAME = 'A' THEN 1 WHEN PRODUCT_NAME = 'B' THEN 2 WHEN PRODUCT_NAME = 'C' THEN -3 ELSE 0 END) AS F FROM ORDERS GROUP BY CUSTOMER_ID) T WHERE F >= 3) P ON C.CUSTOMER_ID = P.CUSTOMER_ID"
281,Y,Y,"SELECT DISTINCT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C LEFT JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE O.PRODUCT_NAME = 'A' AND O.CUSTOMER_ID IN ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B' ) AND O.CUSTOMER_ID NOT IN ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C' )"
282,Y,Y,"SELECT DISTINCT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME IN ('C')) AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME IN ('B')) AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME IN ('A')) ORDER BY CUSTOMER_ID"
283,Y,Y,"WITH TOTAL_TAB AS ( SELECT CUSTOMER_NAME, A.CUSTOMER_ID,PRODUCT_NAME, COUNT(*) AS COUNT1 FROM CUSTOMERS A JOIN ORDERS B ON A.CUSTOMER_ID=B.CUSTOMER_ID GROUP BY CUSTOMER_NAME, CUSTOMER_ID,PRODUCT_NAME), PRODUCTA AS (SELECT DISTINCT(CUSTOMER_ID),CUSTOMER_NAME FROM TOTAL_TAB WHERE PRODUCT_NAME='A'), PRODUCTB AS (SELECT DISTINCT(CUSTOMER_ID),CUSTOMER_NAME FROM TOTAL_TAB WHERE PRODUCT_NAME='B'), PRODUCTC AS (SELECT DISTINCT(CUSTOMER_ID),CUSTOMER_NAME FROM TOTAL_TAB WHERE PRODUCT_NAME='C') SELECT PRODUCTA.* FROM PRODUCTA JOIN PRODUCTB ON PRODUCTA.CUSTOMER_ID=PRODUCTB.CUSTOMER_ID WHERE PRODUCTA.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM PRODUCTC) ORDER BY PRODUCTA.CUSTOMER_ID"
284,Y,Y,"WITH MAIN AS ( SELECT A.CUSTOMER_ID, CUSTOMER_NAME, COUNT(CASE WHEN PRODUCT_NAME = 'A' THEN 1 END) PRODUCTA, COUNT(CASE WHEN PRODUCT_NAME = 'B' THEN 1 END) PRODUCTB, COUNT(CASE WHEN PRODUCT_NAME = 'C' THEN 1 END) PRODUCTC FROM CUSTOMERS A JOIN ORDERS B ON A.CUSTOMER_ID = B.CUSTOMER_ID GROUP BY 1,2) SELECT CUSTOMER_ID, CUSTOMER_NAME FROM MAIN WHERE PRODUCTA > 0 AND PRODUCTB > 0 AND PRODUCTC = 0 ORDER BY CUSTOMER_ID"
285,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM ( SELECT A.CUSTOMER_ID, CUSTOMER_NAME, SUM(CASE WHEN PRODUCT_NAME IN ('A', 'B') THEN 1 WHEN PRODUCT_NAME='C' THEN 3 ELSE 0 END) AS CNT FROM CUSTOMERS A JOIN (SELECT DISTINCT CUSTOMER_ID, PRODUCT_NAME FROM ORDERS) B ON A.CUSTOMER_ID = B.CUSTOMER_ID GROUP BY 1, 2) A WHERE CNT = 2 ORDER BY 1"
286,Y,Y,"SELECT ORDERS.CUSTOMER_ID AS CUSTOMER_ID, CUSTOMERS.CUSTOMER_NAME AS CUSTOMER_NAME FROM ORDERS LEFT JOIN CUSTOMERS ON CUSTOMERS.CUSTOMER_ID = ORDERS.CUSTOMER_ID GROUP BY CUSTOMER_ID HAVING GROUP_CONCAT(ORDERS.PRODUCT_NAME) LIKE '%A%' AND GROUP_CONCAT(ORDERS.PRODUCT_NAME) LIKE '%B%' AND GROUP_CONCAT(ORDERS.PRODUCT_NAME) NOT LIKE '%C%' ORDER BY CUSTOMER_ID"
287,Y,Y,"SELECT V.CUSTOMER_ID, C.CUSTOMER_NAME FROM ( SELECT CUSTOMER_ID, SUM(CASE WHEN PRODUCT_NAME = 'A' THEN 1 ELSE 0 END) SA, SUM(CASE WHEN PRODUCT_NAME = 'B' THEN 1 ELSE 0 END) SB, SUM(CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END) SC FROM ORDERS O WHERE 1=1 GROUP BY CUSTOMER_ID ) V JOIN CUSTOMERS C ON V.CUSTOMER_ID = C.CUSTOMER_ID WHERE V.SA > 0 AND V.SB > 0 AND V.SC = 0 ORDER BY V.CUSTOMER_ID"
288,Y,Y,"SELECT A.CUSTOMER_ID, CUSTOMER_NAME FROM (SELECT CUSTOMER_ID, GROUP_CONCAT(PRODUCT_NAME ORDER BY PRODUCT_NAME) AS PRODUCTS FROM ORDERS GROUP BY CUSTOMER_ID) A JOIN CUSTOMERS C ON A.CUSTOMER_ID=C.CUSTOMER_ID WHERE PRODUCTS LIKE '%A,B%' AND PRODUCTS NOT LIKE '%C%'"
289,Y,Y,"SELECT A.CUSTOMER_ID, A.CUSTOMER_NAME FROM CUSTOMERS A INNER JOIN ORDERS B USING(CUSTOMER_ID) GROUP BY A.CUSTOMER_ID HAVING SUM(PRODUCT_NAME = 'A') > 0 AND SUM(PRODUCT_NAME = 'B') > 0 AND SUM(PRODUCT_NAME = 'C') = 0"
290,Y,Y,"SELECT A.CUSTOMER_ID,A.CUSTOMER_NAME FROM CUSTOMERS A WHERE A.CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A' AND CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C'))"
291,Y,Y,"SELECT COMPILED_RESULT.CUSTOMER_ID,C1.CUSTOMER_NAME FROM ( SELECT CUSTOMER_ID, SUM(CASE WHEN PRODUCT_NAME='A' THEN 1 ELSE 0 END) AS A, SUM(CASE WHEN PRODUCT_NAME ='B' THEN 1 ELSE 0 END) AS B, SUM(CASE WHEN PRODUCT_NAME ='C' THEN 1 ELSE 0 END) AS C FROM ORDERS GROUP BY CUSTOMER_ID) COMPILED_RESULT INNER JOIN CUSTOMERS C1 ON COMPILED_RESULT.CUSTOMER_ID =C1.CUSTOMER_ID AND A>=1 AND B>=1 AND C=0"
292,Y,Y,"SELECT CUSTOMER_ID , CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID NOT IN ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME IN ('C') ) AND CUSTOMER_ID IN ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME IN ('B') ) AND CUSTOMER_ID IN ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME IN ('A') )"
293,Y,Y,"SELECT O.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS O JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID GROUP BY 1 HAVING SUM(PRODUCT_NAME = 'A')>0 AND SUM(PRODUCT_NAME = 'B') AND SUM(PRODUCT_NAME = 'C') =0"
294,Y,Y,"WITH CTE AS ( SELECT CUSTOMER_ID FROM ORDERS GROUP BY CUSTOMER_ID HAVING SUM(CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END) = 0 AND SUM(CASE WHEN PRODUCT_NAME ='B' THEN 1 ELSE 0 END) >= 1 AND SUM(CASE WHEN PRODUCT_NAME ='A' THEN 1 ELSE 0 END) >= 1 ) SELECT CU.CUSTOMER_ID, CUSTOMER_NAME FROM CTE C JOIN CUSTOMERS CU ON C.CUSTOMER_ID = CU.CUSTOMER_ID"
295,Y,Y,SELECT C.* FROM CUSTOMERS C JOIN ORDERS O USING (CUSTOMER_ID) GROUP BY C.CUSTOMER_ID HAVING SUM(O.PRODUCT_NAME='A') > 0 AND SUM(O.PRODUCT_NAME='B') > 0 AND SUM(O.PRODUCT_NAME='C') = 0
296,Y,Y,"SELECT DISTINCT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O USING(CUSTOMER_ID) GROUP BY C.CUSTOMER_ID HAVING ( SUM(O.PRODUCT_NAME = 'A') > 0 AND SUM(O.PRODUCT_NAME = 'B') > 0 AND SUM(O.PRODUCT_NAME = 'C') = 0 ) ORDER BY C.CUSTOMER_ID ASC"
297,Y,Y,"SELECT CUSTOMERS.CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS LEFT JOIN ORDERS ON CUSTOMERS.CUSTOMER_ID = ORDERS.CUSTOMER_ID GROUP BY CUSTOMERS.CUSTOMER_ID HAVING SUM(PRODUCT_NAME = 'A') > 0 AND SUM(PRODUCT_NAME = 'B') > 0 AND SUM(PRODUCT_NAME = 'C') = 0 ORDER BY CUSTOMERS.CUSTOMER_ID"
298,Y,Y,"WITH ABC AS( SELECT DISTINCT C.CUSTOMER_ID, C.CUSTOMER_NAME, CASE WHEN O1.PRODUCT_NAME='A THEN YES ELSE NO' END AS NAME_A, CASE WHEN O2.PRODUCT_NAME='B THEN YES ELSE NO' END AS NAME_B, CASE WHEN O3.PRODUCT_NAME='C THEN YES ELSE NO' END AS NAME_C FROM CUSTOMERS C LEFT JOIN ORDERS O1 ON C.CUSTOMER_ID=O1.CUSTOMER_ID AND O1.PRODUCT_NAME='A' LEFT JOIN ORDERS O2 ON C.CUSTOMER_ID=O2.CUSTOMER_ID AND O2.PRODUCT_NAME='B' LEFT JOIN ORDERS O3 ON C.CUSTOMER_ID=O3.CUSTOMER_ID AND O3.PRODUCT_NAME='C' ) SELECT CUSTOMER_ID, CUSTOMER_NAME FROM ABC WHERE NAME_A='YES' AND NAME_B='YES' AND NAME_C='NO'"
299,Y,Y,"WITH REC_CUSTOMERS AS (SELECT CUSTOMER_ID, SUM(CASE WHEN PRODUCT_NAME = 'A' THEN 1 ELSE 0 END) AS CUSTOMER_PRODACOUNT, SUM(CASE WHEN PRODUCT_NAME = 'B' THEN 1 ELSE 0 END) AS CUSTOMER_PRODBCOUNT, SUM(CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END) AS CUSTOMER_PRODCCOUNT FROM ORDERS GROUP BY CUSTOMER_ID HAVING CUSTOMER_PRODACOUNT > 0 AND CUSTOMER_PRODBCOUNT > 0 AND CUSTOMER_PRODCCOUNT = 0) SELECT REC_CUSTOMERS.CUSTOMER_ID, CUSTOMER_NAME FROM REC_CUSTOMERS LEFT JOIN CUSTOMERS ON REC_CUSTOMERS.CUSTOMER_ID = CUSTOMERS.CUSTOMER_ID"
300,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='A') AND CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='B') AND CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='C')) O JOIN CUSTOMERS C ON O.CUSTOMER_ID=C.CUSTOMER_ID"
301,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE (PRODUCT_NAME = 'A')) AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE (PRODUCT_NAME = 'B')) AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE (PRODUCT_NAME = 'C')) ORDER BY CUSTOMER_ID"
302,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID GROUP BY C.CUSTOMER_ID HAVING SUM(O.PRODUCT_NAME = 'A') > 0 AND SUM(O.PRODUCT_NAME = 'B') > 0 AND SUM(O.PRODUCT_NAME = 'C') = 0 ORDER BY 1"
303,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C LEFT JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID GROUP BY C.CUSTOMER_ID HAVING SUM(O.PRODUCT_NAME='C')=0 AND SUM(O.PRODUCT_NAME='A')>0 AND SUM(O.PRODUCT_NAME='B')>0"
304,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT O.CUSTOMER_ID FROM ORDERS O WHERE PRODUCT_NAME = 'A') AND CUSTOMER_ID IN (SELECT O.CUSTOMER_ID FROM ORDERS O WHERE PRODUCT_NAME = 'B') AND CUSTOMER_ID NOT IN (SELECT O.CUSTOMER_ID FROM ORDERS O WHERE PRODUCT_NAME = 'C') ORDER BY CUSTOMER_ID"
305,Y,Y,"SELECT DISTINCT O.CUSTOMER_ID, CUSTOMER_NAME FROM ORDERS O JOIN CUSTOMERS C ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE PRODUCT_NAME = 'A' AND EXISTS ( SELECT CUSTOMER_ID FROM ORDERS WHERE CUSTOMER_ID = O.CUSTOMER_ID AND PRODUCT_NAME = 'B' ) AND NOT EXISTS ( SELECT CUSTOMER_ID FROM ORDERS WHERE CUSTOMER_ID = O.CUSTOMER_ID AND PRODUCT_NAME = 'C' )"
306,Y,Y,"SELECT DISTINCT O1.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS O1 JOIN ORDERS O2 ON O1.CUSTOMER_ID = O2.CUSTOMER_ID LEFT JOIN CUSTOMERS C ON O1.CUSTOMER_ID = C.CUSTOMER_ID WHERE O1.PRODUCT_NAME = 'A' AND O2.PRODUCT_NAME = 'B' AND O1.CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')"
307,Y,Y,"WITH AB AS ( SELECT A.CUSTOMER_ID FROM ORDERS A INNER JOIN ORDERS B ON A.CUSTOMER_ID=B.CUSTOMER_ID WHERE A.PRODUCT_NAME='A' AND B.PRODUCT_NAME='B' ) , C AS ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME IN ('C') ) SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN ( SELECT CUSTOMER_ID FROM AB WHERE CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM C) )"
308,Y,Y,"SELECT O.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS AS O LEFT JOIN CUSTOMERS AS C ON C.CUSTOMER_ID = O.CUSTOMER_ID GROUP BY O.CUSTOMER_ID, C.CUSTOMER_NAME HAVING SUM(CASE WHEN O.PRODUCT_NAME='A' THEN 1 ELSE 0 END) >=1 AND SUM(CASE WHEN O.PRODUCT_NAME='B' THEN 1 ELSE 0 END) >=1 AND SUM(CASE WHEN O.PRODUCT_NAME='C' THEN 1 ELSE 0 END) = 0 ORDER BY CUSTOMER_ID"
309,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM (SELECT CUSTOMER_ID AS ID, S.PRODUCTS FROM (SELECT CUSTOMER_ID, GROUP_CONCAT(PRODUCT_NAME) AS PRODUCTS FROM ORDERS GROUP BY CUSTOMER_ID) AS S WHERE S.PRODUCTS LIKE '%A%' AND S.PRODUCTS LIKE '%B%' AND S.PRODUCTS NOT LIKE '%C%' ) AS SS, CUSTOMERS AS C WHERE C.CUSTOMER_ID = SS.ID"
310,Y,Y,"SELECT A.CUSTOMER_ID, B.CUSTOMER_NAME FROM( SELECT CUSTOMER_ID, MAX(CASE WHEN PRODUCT_NAME='A' THEN 1 ELSE 0 END) AS A , MAX(CASE WHEN PRODUCT_NAME='B' THEN 1 ELSE 0 END) AS B , MAX(CASE WHEN PRODUCT_NAME='C' THEN 1 ELSE 0 END) AS C FROM ORDERS GROUP BY CUSTOMER_ID) A JOIN CUSTOMERS B USING(CUSTOMER_ID) WHERE A=1 AND B=1 AND C!=1 ORDER BY A.CUSTOMER_ID"
311,Y,Y,"WITH CUSTOMER_A AS ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A' ), CUSTOMER_B AS ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B' ), CUSTOMER_C AS ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') ), CUSTOMER AS ( SELECT A.CUSTOMER_ID FROM CUSTOMER_A A JOIN CUSTOMER_B B JOIN CUSTOMER_C C ON A.CUSTOMER_ID = B.CUSTOMER_ID AND B.CUSTOMER_ID = C.CUSTOMER_ID ) SELECT CUSTOMER.CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMER JOIN CUSTOMERS ON CUSTOMER.CUSTOMER_ID = CUSTOMERS.CUSTOMER_ID"
312,Y,Y,"SELECT CUSTOMERS.CUSTOMER_ID, CUSTOMERS.CUSTOMER_NAME FROM CUSTOMERS JOIN ( SELECT DISTINCT PRODUCT_NAME, CUSTOMER_ID FROM ORDERS ) AS UNIQUEPRODUCTORDERS USING (CUSTOMER_ID) GROUP BY CUSTOMERS.CUSTOMER_ID HAVING SUM(CASE WHEN PRODUCT_NAME = 'A' OR PRODUCT_NAME ='B' THEN 1 WHEN PRODUCT_NAME = 'C' THEN -1 END) = 2 ORDER BY CUSTOMER_ID"
313,Y,Y,"SELECT * FROM CUSTOMERS WHERE CUSTOMER_ID IN ( SELECT CUSTOMER_ID FROM( SELECT DISTINCT CUSTOMER_ID, PRODUCT_NAME FROM ORDERS) AS TMP GROUP BY CUSTOMER_ID HAVING SUM(CASE WHEN PRODUCT_NAME IN ('A','B') THEN 1 WHEN PRODUCT_NAME IN ('C') THEN -2 ELSE 0 END ) =2 )"
314,Y,Y,"SELECT A.CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS A JOIN ORDERS B ON A.CUSTOMER_ID = B.CUSTOMER_ID GROUP BY A.CUSTOMER_ID HAVING SUM(B.PRODUCT_NAME = 'A' ) >0 AND SUM(B. PRODUCT_NAME = 'B') >0 AND SUM(B. PRODUCT_NAME = 'C') = 0"
315,Y,Y,"WITH TEMP AS ( SELECT CUSTOMER_ID, SUM(CASE WHEN PRODUCT_NAME = 'A' THEN 1 ELSE 0 END) AS A_CNT, SUM(CASE WHEN PRODUCT_NAME = 'B' THEN 1 ELSE 0 END) AS B_CNT, SUM(CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END) AS C_CNT FROM ORDERS GROUP BY CUSTOMER_ID) SELECT C.* FROM CUSTOMERS C JOIN TEMP T ON C.CUSTOMER_ID = T.CUSTOMER_ID WHERE A_CNT>0 AND B_CNT>0 AND C_CNT = 0 ORDER BY C.CUSTOMER_ID"
316,Y,Y,"SELECT O.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS O LEFT JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID GROUP BY 1 HAVING SUM(PRODUCT_NAME='A')>0 AND SUM(PRODUCT_NAME='B')>0 AND SUM(PRODUCT_NAME='C')=0"
317,Y,Y,"SELECT SUB1.CUSTOMER_ID, C.CUSTOMER_NAME FROM (SELECT DISTINCT O.CUSTOMER_ID FROM ORDERS O WHERE PRODUCT_NAME IN ('A') AND O.CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND O.CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')) SUB1 JOIN CUSTOMERS C ON SUB1.CUSTOMER_ID = C.CUSTOMER_ID"
318,Y,Y,"WITH CUSTOMER_A AS ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A' ), CUSTOMER_B AS ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B' ), CUSTOMER_C AS ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C' ) SELECT A.CUSTOMER_ID, BASE.CUSTOMER_NAME FROM CUSTOMER_A A INNER JOIN CUSTOMER_B B INNER JOIN CUSTOMERS BASE ON A.CUSTOMER_ID = B.CUSTOMER_ID AND BASE.CUSTOMER_ID = A.CUSTOMER_ID WHERE A.CUSTOMER_ID NOT IN ( SELECT CUSTOMER_ID FROM CUSTOMER_C )"
319,Y,Y,"WITH TEMP AS (SELECT CUSTOMER_ID, SUM(CASE WHEN PRODUCT_NAME ='A' THEN 1 WHEN PRODUCT_NAME ='B' THEN 1 WHEN PRODUCT_NAME ='C' THEN -1 ELSE 0 END) AS ID FROM (SELECT DISTINCT CUSTOMER_ID, PRODUCT_NAME FROM ORDERS) A GROUP BY 1) SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM TEMP WHERE ID = 2)"
320,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') ORDER BY CUSTOMER_ID"
321,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN( SELECT DISTINCT(CUSTOMER_ID) FROM ORDERS WHERE CUSTOMER_ID IN(SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND CUSTOMER_ID IN(SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND CUSTOMER_ID NOT IN(SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C'))"
322,Y,Y,"SELECT A.CUSTOMER_ID, C.CUSTOMER_NAME FROM ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A' OR PRODUCT_NAME = 'B' GROUP BY CUSTOMER_ID HAVING COUNT(DISTINCT PRODUCT_NAME) = 2 ) A LEFT JOIN CUSTOMERS C ON A.CUSTOMER_ID = C.CUSTOMER_ID WHERE A.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')"
323,Y,Y,"WITH T1 AS (SELECT T_A.CUSTOMER_ID FROM (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') T_A JOIN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') T_B ON T_A.CUSTOMER_ID = T_B.CUSTOMER_ID) SELECT DISTINCT T1.CUSTOMER_ID, CUSTOMER_NAME FROM T1 JOIN CUSTOMERS C ON T1.CUSTOMER_ID=C.CUSTOMER_ID AND T1.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='C')"
324,Y,Y,"WITH CTE AS ( SELECT CUSTOMER_ID, SUM(CASE WHEN PRODUCT_NAME = 'A' THEN 1 ELSE 0 END) AS A_BUY, SUM(CASE WHEN PRODUCT_NAME = 'B' THEN 1 ELSE 0 END) AS B_BUY, SUM(CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END) AS C_BUY FROM ORDERS GROUP BY CUSTOMER_ID ) SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C LEFT JOIN CTE ON C.CUSTOMER_ID = CTE.CUSTOMER_ID WHERE CTE.A_BUY >= 1 AND CTE.B_BUY >= 1 AND CTE.C_BUY = 0"
325,Y,Y,"WITH C1 AS ( SELECT CUSTOMER_ID, SUM(CASE WHEN PRODUCT_NAME = 'A' THEN 1 ELSE 0 END) AS A_COUNT, SUM(CASE WHEN PRODUCT_NAME = 'B' THEN 1 ELSE 0 END) AS B_COUNT, SUM(CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END) AS C_COUNT FROM ORDERS GROUP BY 1 ) SELECT C1.CUSTOMER_ID, C.CUSTOMER_NAME FROM C1 JOIN CUSTOMERS C ON C1.CUSTOMER_ID = C.CUSTOMER_ID WHERE (A_COUNT > 0 AND B_COUNT > 0 AND C_COUNT = 0) ORDER BY 1"
326,Y,Y,"SELECT B.* FROM CUSTOMERS B INNER JOIN ( SELECT CUSTOMER_ID, COUNT(CASE WHEN PRODUCT_NAME='A' THEN 1 ELSE NULL END) AS A, COUNT(CASE WHEN PRODUCT_NAME='B' THEN 1 ELSE NULL END) AS B, COUNT(CASE WHEN PRODUCT_NAME='C' THEN 1 ELSE NULL END) AS C FROM ORDERS GROUP BY 1) AS A ON A.CUSTOMER_ID=B.CUSTOMER_ID WHERE A>0 AND B>0 AND C=0"
327,Y,Y,"WITH A AS ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A' ), B AS ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B' ), C AS ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C' ), TEMP AS ( SELECT CUSTOMER_ID FROM A WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM B) AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM C) ) SELECT DISTINCT T.CUSTOMER_ID, C.CUSTOMER_NAME FROM TEMP T JOIN CUSTOMERS C ON T.CUSTOMER_ID = C.CUSTOMER_ID"
328,Y,Y,"SELECT DISTINCT A.CUSTOMER_ID, A.CUSTOMER_NAME FROM CUSTOMERS A, ORDERS B WHERE A.CUSTOMER_ID = B.CUSTOMER_ID GROUP BY 1,2 HAVING SUM(B.PRODUCT_NAME = 'B') != 0 AND SUM(B.PRODUCT_NAME = 'A') != 0 AND SUM(B.PRODUCT_NAME = 'C') = 0"
329,Y,Y,"SELECT DISTINCT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS O LEFT OUTER JOIN CUSTOMERS C ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE C.CUSTOMER_ID IN (SELECT A.CUSTOMER_ID FROM ORDERS A WHERE A.PRODUCT_NAME = 'A') AND C.CUSTOMER_ID IN (SELECT B.CUSTOMER_ID FROM ORDERS B WHERE B.PRODUCT_NAME = 'B') AND C.CUSTOMER_ID NOT IN (SELECT C.CUSTOMER_ID FROM ORDERS C WHERE C.PRODUCT_NAME = 'C') ORDER BY 1"
330,Y,Y,"SELECT O.CUSTOMER_ID ,C.CUSTOMER_NAME FROM ORDERS O JOIN CUSTOMERS C ON O.CUSTOMER_ID=C.CUSTOMER_ID WHERE O.PRODUCT_NAME IN ('A','B') AND O.CUSTOMER_ID NOT IN ( SELECT OO.CUSTOMER_ID FROM ORDERS OO WHERE OO.PRODUCT_NAME = 'C') GROUP BY O.CUSTOMER_ID HAVING COUNT(DISTINCT(O.PRODUCT_NAME)) = 2"
331,Y,N,"WITH T AS (SELECT CUSTOMER_ID FROM ORDERS O WHERE PRODUCT_NAME = 'B' AND CUSTOMER_ID IN ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') ) SELECT T.CUSTOMER_ID, C.CUSTOMER_NAME FROM T JOIN CUSTOMERS C ON T.CUSTOMER_ID = C.CUSTOMER_ID"
332,Y,N,"WITH CTE AS (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME IN ('A','B') GROUP BY CUSTOMER_ID HAVING COUNT(PRODUCT_NAME) >=2) SELECT A.CUSTOMER_ID ,B.CUSTOMER_NAME FROM CTE A JOIN CUSTOMERS B ON A.CUSTOMER_ID = B.CUSTOMER_ID WHERE A.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='C')"
333,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C JOIN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')) A ON C.CUSTOMER_ID = A.CUSTOMER_ID ORDER BY CUSTOMER_ID"
334,Y,Y,"SELECT DISTINCT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O1 ON C.CUSTOMER_ID = O1.CUSTOMER_ID AND O1.PRODUCT_NAME = 'A' JOIN ORDERS O2 ON C.CUSTOMER_ID = O2.CUSTOMER_ID AND O2.PRODUCT_NAME = 'B' WHERE C.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')"
335,Y,Y,SELECT C.* FROM CUSTOMERS C INNER JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID GROUP BY C.CUSTOMER_ID HAVING SUM(O.PRODUCT_NAME='A') > 0 AND SUM(O.PRODUCT_NAME='B') >0 AND SUM(O.PRODUCT_NAME='C') = 0 ORDER BY C.CUSTOMER_ID
336,Y,Y,"SELECT DISTINCT CUSTOMERS.CUSTOMER_ID,CUSTOMER_NAME FROM ORDERS JOIN CUSTOMERS ON CUSTOMERS.CUSTOMER_ID = ORDERS.CUSTOMER_ID WHERE CUSTOMERS.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') AND CUSTOMERS.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND CUSTOMERS.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') ORDER BY CUSTOMER_ID"
337,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS A WHERE CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='A') AND CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='B') AND CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')"
338,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT DISTINCT(CUSTOMER_ID) FROM ORDERS WHERE PRODUCT_NAME = 'A') AND CUSTOMER_ID IN (SELECT DISTINCT(CUSTOMER_ID) FROM ORDERS WHERE PRODUCT_NAME = 'B') AND CUSTOMER_ID NOT IN (SELECT DISTINCT(CUSTOMER_ID) FROM ORDERS WHERE PRODUCT_NAME = 'C') ORDER BY CUSTOMER_ID"
339,Y,Y,"SELECT C.CUSTOMER_ID , C.CUSTOMER_NAME FROM CUSTOMERS C WHERE C.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME IN ('C')) AND C.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME IN ('A')) AND C.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME IN ('B'))"
340,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM ( SELECT CUSTOMER_ID FROM ( SELECT CUSTOMER_ID, SUM(IF(PRODUCT_NAME='A', 1 ,0)) AS ACOUNT, SUM(IF(PRODUCT_NAME='B', 1 ,0)) AS BCOUNT, SUM(IF(PRODUCT_NAME='C', 1 ,0)) AS CCOUNT FROM ORDERS GROUP BY CUSTOMER_ID) A WHERE ACOUNT>0 AND BCOUNT>0 AND CCOUNT=0 ) B JOIN CUSTOMERS C ON C.CUSTOMER_ID=B.CUSTOMER_ID"
341,Y,Y,"SELECT DISTINCT(O.CUSTOMER_ID),C.CUSTOMER_NAME FROM CUSTOMERS AS C INNER JOIN ORDERS AS O ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE O.CUSTOMER_ID IN (SELECT DISTINCT(O1.CUSTOMER_ID) FROM ORDERS AS O1 INNER JOIN ORDERS AS O2 ON O1.CUSTOMER_ID = O2.CUSTOMER_ID WHERE O1.PRODUCT_NAME = 'A' AND O2.PRODUCT_NAME = 'B') AND O.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')"
342,Y,Y,"SELECT CUSTOMERS.CUSTOMER_ID, CUSTOMERS.CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN ( SELECT A.CUSTOMER_ID FROM ORDERS A INNER JOIN (SELECT CUSTOMER_ID,PRODUCT_NAME FROM ORDERS WHERE PRODUCT_NAME = 'B')B ON A.CUSTOMER_ID = B.CUSTOMER_ID AND A.PRODUCT_NAME ='A' LEFT JOIN (SELECT CUSTOMER_ID,PRODUCT_NAME FROM ORDERS WHERE PRODUCT_NAME = 'C')C ON B.CUSTOMER_ID = C.CUSTOMER_ID AND A.CUSTOMER_ID = C.CUSTOMER_ID WHERE C.CUSTOMER_ID IS NULL)"
343,Y,Y,"SELECT Y.CUSTOMER_ID,CUSTOMER_NAME FROM CUSTOMERS C JOIN ( SELECT CUSTOMER_ID FROM (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A' AND CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B'))X WHERE CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C'))Y ON C.CUSTOMER_ID=Y.CUSTOMER_ID"
344,Y,N,"SELECT A.CUSTOMER_ID, A.CUSTOMER_NAME FROM CUSTOMERS A INNER JOIN ORDERS B ON A.CUSTOMER_ID = B.CUSTOMER_ID WHERE B.PRODUCT_NAME IN ('A','B') AND A.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='C') GROUP BY A.CUSTOMER_ID, A.CUSTOMER_NAME HAVING COUNT(B.PRODUCT_NAME) >= 2"
345,Y,Y,"SELECT C.CUSTOMER_ID,C.CUSTOMER_NAME FROM CUSTOMERS C LEFT JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID GROUP BY C.CUSTOMER_ID HAVING SUM(PRODUCT_NAME = 'A') > 0 AND SUM(PRODUCT_NAME = 'B') >0 AND SUM(PRODUCT_NAME = 'C') = 0 ORDER BY CUSTOMER_ID"
346,Y,Y,"WITH A AS (SELECT O.CUSTOMER_ID, C.CUSTOMER_NAME, O.PRODUCT_NAME FROM CUSTOMERS C RIGHT JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE PRODUCT_NAME = 'A'), B AS (SELECT O.CUSTOMER_ID, C.CUSTOMER_NAME, O.PRODUCT_NAME FROM CUSTOMERS C RIGHT JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE PRODUCT_NAME = 'B'), C AS (SELECT O.CUSTOMER_ID, C.CUSTOMER_NAME, O.PRODUCT_NAME FROM CUSTOMERS C RIGHT JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE C.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')) SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM A JOIN B ON A.CUSTOMER_ID = B.CUSTOMER_ID JOIN C ON B.CUSTOMER_ID = C.CUSTOMER_ID GROUP BY C.CUSTOMER_ID, C.CUSTOMER_NAME"
347,Y,Y,"SELECT TMP.CUSTOMER_ID, CUSTOMER_NAME FROM ( SELECT CUSTOMER_ID, SUM(CASE WHEN PRODUCT_NAME='A' THEN 1 ELSE 0 END) AS BOUGHT_A, SUM(CASE WHEN PRODUCT_NAME='B' THEN 1 ELSE 0 END) AS BOUGHT_B, SUM(CASE WHEN PRODUCT_NAME='C' THEN 1 ELSE 0 END) AS BOUGHT_C FROM ORDERS GROUP BY 1 HAVING BOUGHT_A>0 AND BOUGHT_B>0 AND BOUGHT_C=0 ) TMP JOIN CUSTOMERS C ON TMP.CUSTOMER_ID=C.CUSTOMER_ID"
348,N,N,"SELECT A.CUSTOMER_ID, A.CUSTOMER_NAME FROM CUSTOMERS A JOIN ORDERS B ON A.CUSTOMER_ID=B.CUSTOMER_ID GROUP BY B.CUSTOMER_ID HAVING SUM(IF(PRODUCT_NAME='A',1,0))>0 &AMP;&AMP; SUM(IF(PRODUCT_NAME='B',1,0))>0 &AMP;&AMP; SUM(IF(PRODUCT_NAME='C',1,0))=0"
349,Y,Y,"SELECT B.CUSTOMER_ID , A.CUSTOMER_NAME FROM CUSTOMERS A RIGHT JOIN (SELECT CUSTOMER_ID, SUM(CASE WHEN PRODUCT_NAME = 'A' THEN 1 ELSE 0 END) AS A, SUM(CASE WHEN PRODUCT_NAME = 'B' THEN 1 ELSE 0 END) AS B, SUM(CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END) AS C FROM ORDERS GROUP BY CUSTOMER_ID HAVING SUM(CASE WHEN PRODUCT_NAME = 'A' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN PRODUCT_NAME = 'B' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END) = 0) B ON A.CUSTOMER_ID =B.CUSTOMER_ID"
350,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS AS C JOIN ORDERS AS O ON C.CUSTOMER_ID = O.CUSTOMER_ID GROUP BY C.CUSTOMER_ID HAVING SUM(PRODUCT_NAME='A')>0 AND SUM(PRODUCT_NAME='B')>0 AND SUM(PRODUCT_NAME='C')=0"
351,Y,Y,"SELECT A.CUSTOMER_ID, B.CUSTOMER_NAME FROM ORDERS A INNER JOIN CUSTOMERS B ON A.CUSTOMER_ID = B.CUSTOMER_ID GROUP BY CUSTOMER_ID HAVING SUM(PRODUCT_NAME='A')>0 AND SUM(PRODUCT_NAME='B')>0 AND SUM(PRODUCT_NAME='C')=0 ORDER BY 1"
352,Y,Y,"SELECT CUSTOMER_ID , CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME IN ('B') ) AND CUSTOMER_ID IN ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME IN ('A') ) AND CUSTOMER_ID NOT IN ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME IN ('C') )"
353,Y,Y,"SELECT O.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS O LEFT JOIN CUSTOMERS C ON (O.CUSTOMER_ID = C.CUSTOMER_ID) GROUP BY O.CUSTOMER_ID HAVING SUM(O.PRODUCT_NAME='A') >0 AND SUM(O.PRODUCT_NAME='B') > 0 AND SUM(O.PRODUCT_NAME='C')=0"
354,Y,Y,"SELECT DISTINCT C1.CUSTOMER_ID, C1.CUSTOMER_NAME FROM CUSTOMERS C1 INNER JOIN ORDERS O1 ON (C1.CUSTOMER_ID = O1.CUSTOMER_ID AND O1.PRODUCT_NAME='A') INNER JOIN ORDERS O2 ON (C1.CUSTOMER_ID = O2.CUSTOMER_ID AND O2.PRODUCT_NAME='B') LEFT JOIN ORDERS O3 ON (O3.CUSTOMER_ID=C1.CUSTOMER_ID AND O3.PRODUCT_NAME='C') WHERE O3.ORDER_ID IS NULL"
355,Y,Y,"SELECT A.CUSTOMER_ID , C.CUSTOMER_NAME FROM (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME IN ('A', 'B') GROUP BY CUSTOMER_ID HAVING COUNT(DISTINCT PRODUCT_NAME)=2) AS A JOIN CUSTOMERS C ON C.CUSTOMER_ID=A.CUSTOMER_ID WHERE A.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME IN ('A', 'B', 'C') GROUP BY CUSTOMER_ID HAVING COUNT(DISTINCT PRODUCT_NAME)=3)"
356,Y,Y,"WITH A AS ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='A') ,B AS (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='B') ,C AS ( SELECT CU.CUSTOMER_ID FROM CUSTOMERS CU LEFT JOIN ORDERS O ON CU.CUSTOMER_ID = O.CUSTOMER_ID AND PRODUCT_NAME ='C' WHERE O.CUSTOMER_ID IS NULL) SELECT CUSTOMER_ID,CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT A.CUSTOMER_ID FROM A,B,C WHERE A.CUSTOMER_ID=C.CUSTOMER_ID AND B.CUSTOMER_ID=C.CUSTOMER_ID)"
357,Y,Y,"WITH CTE AS ( SELECT CUSTOMER_ID, SUM(IF(PRODUCT_NAME = 'A',1,0)) AS A, SUM(IF(PRODUCT_NAME = 'B',1,0)) AS B, SUM(IF(PRODUCT_NAME = 'C',1,0)) AS C FROM ORDERS GROUP BY CUSTOMER_ID ) SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN ( SELECT CUSTOMER_ID FROM CTE WHERE A > 0 AND B > 0 AND C = 0 ) ORDER BY CUSTOMER_ID"
358,Y,Y,"SELECT C.CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS C, ORDERS B WHERE C.CUSTOMER_ID = B.CUSTOMER_ID GROUP BY C.CUSTOMER_ID HAVING SUM(B.PRODUCT_NAME='A')>0 AND SUM(B.PRODUCT_NAME='B')>0 AND SUM(B.PRODUCT_NAME='C')=0"
359,Y,Y,SELECT * FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT O.CUSTOMER_ID FROM ORDERS O JOIN ORDERS R ON O.CUSTOMER_ID = R.CUSTOMER_ID WHERE O.PRODUCT_NAME = 'A' AND R.PRODUCT_NAME = 'B' AND O.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C'))
360,Y,Y,"WITH FILTERED_CUSTOMERS AS ( SELECT CUSTOMER_ID , COUNT(IF(PRODUCT_NAME = 'A', 1, NULL)) AS CNT_A , COUNT(IF(PRODUCT_NAME = 'B', 1, NULL)) AS CNT_B , COUNT(IF(PRODUCT_NAME = 'C', 1, NULL)) AS CNT_C FROM ORDERS O GROUP BY CUSTOMER_ID HAVING CNT_A > 0 AND CNT_B > 0 AND CNT_C = 0 ) SELECT FC.CUSTOMER_ID, C.CUSTOMER_NAME FROM FILTERED_CUSTOMERS FC, CUSTOMERS C WHERE FC.CUSTOMER_ID = C.CUSTOMER_ID ORDER BY CUSTOMER_ID"
361,Y,Y,"SELECT C.* FROM (SELECT O.CUSTOMER_ID, SUM(O.PRODUCT_NAME = 'A') A, SUM(O.PRODUCT_NAME = 'B') B,SUM(O.PRODUCT_NAME = 'C') C FROM ORDERS O GROUP BY O.CUSTOMER_ID) OO LEFT OUTER JOIN CUSTOMERS C ON C.CUSTOMER_ID = OO.CUSTOMER_ID WHERE OO.A>0 AND OO.B>0 AND OO.C=0"
362,Y,Y,"SELECT T1.CUSTOMER_ID, T1.CUSTOMER_NAME FROM CUSTOMERS T1 JOIN ORDERS T2 ON T1.CUSTOMER_ID = T2.CUSTOMER_ID GROUP BY 1 HAVING SUM(T2.PRODUCT_NAME = 'A') > 0 AND SUM(T2.PRODUCT_NAME = 'B') AND SUM(T2.PRODUCT_NAME = 'C') = 0"
363,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') GROUP BY CUSTOMER_ID ORDER BY CUSTOMER_ID"
364,Y,Y,"WITH CTE_IS_BOUGHT AS ( SELECT S.CUSTOMER_ID, S.CUSTOMER_NAME, MAX(CASE WHEN O.PRODUCT_NAME = 'A' THEN 1 ELSE 0 END) AS IS_BOUGHT_A, MAX(CASE WHEN O.PRODUCT_NAME = 'B' THEN 1 ELSE 0 END) AS IS_BOUGHT_B, MAX(CASE WHEN O.PRODUCT_NAME = 'C' THEN 1 ELSE 0 END) AS IS_BOUGHT_C FROM CUSTOMERS S INNER JOIN ORDERS O ON O.CUSTOMER_ID = S.CUSTOMER_ID GROUP BY S.CUSTOMER_ID, S.CUSTOMER_NAME ) SELECT DISTINCT CUSTOMER_ID, CUSTOMER_NAME FROM CTE_IS_BOUGHT WHERE IS_BOUGHT_A = 1 AND IS_BOUGHT_B = 1 AND IS_BOUGHT_C = 0 ORDER BY CUSTOMER_ID"
365,Y,Y,"WITH A AS( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='A' AND CUSTOMER_ID IN ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='B') AND CUSTOMER_ID NOT IN ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='C' ) ) SELECT DISTINCT A.CUSTOMER_ID, C.CUSTOMER_NAME FROM A LEFT JOIN CUSTOMERS C ON A.CUSTOMER_ID=C.CUSTOMER_ID"
366,Y,Y,"SELECT O.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS O JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID WHERE O.PRODUCT_NAME = 'A' OR O.PRODUCT_NAME='B' AND O.CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') GROUP BY O.CUSTOMER_ID HAVING COUNT(DISTINCT O.PRODUCT_NAME) = 2"
367,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C RIGHT JOIN (SELECT CUSTOMER_ID FROM ORDERS GROUP BY CUSTOMER_ID HAVING SUM(PRODUCT_NAME='C')=0 AND SUM(PRODUCT_NAME='B')!=0 AND SUM(PRODUCT_NAME='A')!=0) T ON T.CUSTOMER_ID = C.CUSTOMER_ID"
368,Y,Y,"SELECT T.CUSTOMER_ID, C.CUSTOMER_NAME FROM (SELECT CUSTOMER_ID, SUM(PRODUCT_NAME = 'A') * SUM( PRODUCT_NAME = 'B')* (1-SUM( PRODUCT_NAME = 'C')) AS ISAB_NOTC FROM ORDERS GROUP BY CUSTOMER_ID) AS T, CUSTOMERS C WHERE T.CUSTOMER_ID = C.CUSTOMER_ID AND ISAB_NOTC >= 1"
369,Y,Y,"SELECT DISTINCT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS AS O JOIN CUSTOMERS AS C ON O.CUSTOMER_ID = C.CUSTOMER_ID WHERE C.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') AND C.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND C.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') ORDER BY C.CUSTOMER_ID"
370,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='A' GROUP BY CUSTOMER_ID HAVING COUNT(*) > 0) AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='B' GROUP BY CUSTOMER_ID HAVING COUNT(*) > 0) AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='C' GROUP BY CUSTOMER_ID HAVING COUNT(*) > 0) ORDER BY CUSTOMER_ID"
371,Y,Y,"WITH TEMP AS (SELECT CUSTOMER_ID FROM ORDERS GROUP BY CUSTOMER_ID HAVING SUM(PRODUCT_NAME = 'A')>0 AND SUM(PRODUCT_NAME = 'B')>0 AND SUM(PRODUCT_NAME = 'C')=0) SELECT CUSTOMER_ID,CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM TEMP)"
372,Y,N,"WITH TEMP AS ( SELECT DISTINCT A.CUSTOMER_ID, B.CUSTOMER_NAME, SUM(CASE WHEN A.PRODUCT_NAME IN ('A', 'B') THEN 1 ELSE 0 END) AS CT_AB, SUM(CASE WHEN A.PRODUCT_NAME = 'C' THEN 1 ELSE 0 END) AS CT_C FROM ORDERS A JOIN CUSTOMERS B ON A.CUSTOMER_ID = B.CUSTOMER_ID GROUP BY A.CUSTOMER_ID ) SELECT CUSTOMER_ID, CUSTOMER_NAME FROM TEMP WHERE CT_AB >= 2 AND CT_C = 0"
373,Y,N,"SELECT T3.* FROM ( SELECT T1.CUSTOMER_ID, CNT1, CNT2 FROM ( SELECT CUSTOMER_ID, COUNT(DISTINCT ORDER_ID) AS CNT1 FROM ORDERS WHERE PRODUCT_NAME IN ('A','B') GROUP BY CUSTOMER_ID )T1 LEFT JOIN ( SELECT CUSTOMER_ID, COUNT(DISTINCT ORDER_ID) AS CNT2 FROM ORDERS WHERE PRODUCT_NAME IN ('C') GROUP BY CUSTOMER_ID )T2 ON T1.CUSTOMER_ID = T2.CUSTOMER_ID WHERE CNT1 >=2 )T INNER JOIN ( SELECT * FROM CUSTOMERS )T3 ON T.CUSTOMER_ID = T3.CUSTOMER_ID WHERE CNT2 IS NULL"
374,Y,Y,"SELECT DISTINCT A.CUSTOMER_ID,C.CUSTOMER_NAME FROM ORDERS A INNER JOIN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') B ON A.CUSTOMER_ID = B.CUSTOMER_ID LEFT JOIN CUSTOMERS C ON A.CUSTOMER_ID = C.CUSTOMER_ID WHERE PRODUCT_NAME = 'A' AND A.CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')"
375,Y,Y,"SELECT A.CUSTOMER_ID,A.CUSTOMER_NAME FROM CUSTOMERS A RIGHT JOIN ORDERS B ON A.CUSTOMER_ID = B.CUSTOMER_ID GROUP BY A.CUSTOMER_ID HAVING SUM(B.PRODUCT_NAME='A') >0 AND SUM(B.PRODUCT_NAME='B') > 0 AND SUM(B.PRODUCT_NAME='C')=0"
376,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C'))"
377,Y,Y,"SELECT DISTINCT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS O1 LEFT JOIN ORDERS O2 ON O1.CUSTOMER_ID = O2.CUSTOMER_ID AND O1.PRODUCT_NAME = 'A' AND O2.PRODUCT_NAME = 'B' LEFT JOIN ORDERS O3 ON O1.CUSTOMER_ID = O3.CUSTOMER_ID AND O1.PRODUCT_NAME = 'A' AND O3.PRODUCT_NAME = 'C' INNER JOIN CUSTOMERS C ON C.CUSTOMER_ID = O1.CUSTOMER_ID WHERE O1.PRODUCT_NAME = 'A' AND O2.PRODUCT_NAME = 'B' AND O3.PRODUCT_NAME IS NULL ORDER BY C.CUSTOMER_ID ASC"
378,Y,Y,"SELECT A.CUSTOMER_ID, A.CUSTOMER_NAME FROM CUSTOMERS A INNER JOIN ORDERS B ON A.CUSTOMER_ID = B.CUSTOMER_ID GROUP BY A.CUSTOMER_ID HAVING SUM(B.PRODUCT_NAME = 'A') > 0 AND SUM(B.PRODUCT_NAME = 'B') > 0 AND SUM(B.PRODUCT_NAME = 'C') = 0 ORDER BY A.CUSTOMER_ID"
379,Y,Y,"SELECT O.CUSTOMER_ID, CUSTOMER_NAME FROM ORDERS O JOIN CUSTOMERS C USING (CUSTOMER_ID) GROUP BY 1 HAVING MAX(CASE WHEN PRODUCT_NAME = 'A' THEN 1 ELSE 0 END) = 1 AND MAX(CASE WHEN PRODUCT_NAME = 'B' THEN 1 ELSE 0 END) = 1 AND MAX(CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END) = 0"
380,Y,Y,"WITH PRE_PIVOT AS ( SELECT CUSTOMER_ID, IF(PRODUCT_NAME = 'A', 1, 0) AS PROD_A, IF(PRODUCT_NAME = 'B', 1, 0) AS PROD_B, IF(PRODUCT_NAME = 'C', 1, 0) AS PROD_C FROM ORDERS ), PIVOT AS ( SELECT CUSTOMER_ID, MAX(PROD_A) AS PROD_A, MAX(PROD_B) AS PROD_B, MAX(PROD_C) AS PROD_C FROM PRE_PIVOT GROUP BY CUSTOMER_ID ) SELECT P.CUSTOMER_ID, C.CUSTOMER_NAME FROM PIVOT AS P INNER JOIN CUSTOMERS AS C ON P.CUSTOMER_ID = C.CUSTOMER_ID WHERE P.PROD_A = 1 AND P.PROD_B = 1 AND P.PROD_C = 0 ORDER BY P.CUSTOMER_ID"
381,Y,Y,"WITH NUM_PROD_ORDERS AS ( SELECT CUSTOMER_ID , SUM(IF(PRODUCT_NAME='A', 1, 0)) AS NUM_A , SUM(IF(PRODUCT_NAME='B', 1, 0)) AS NUM_B , SUM(IF(PRODUCT_NAME='C', 1, 0)) AS NUM_C FROM ORDERS GROUP BY CUSTOMER_ID ) SELECT * FROM CUSTOMERS WHERE CUSTOMER_ID IN ( SELECT CUSTOMER_ID FROM NUM_PROD_ORDERS WHERE NUM_A > 0 AND NUM_B > 0 AND NUM_C = 0 ) ORDER BY CUSTOMER_ID"
382,Y,Y,"WITH CTE1 AS ( SELECT * FROM CUSTOMERS WHERE CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='C') ) , CTE2 AS ( SELECT A.* , COUNT(B.PRODUCT_NAME) OVER(PARTITION BY A.CUSTOMER_ID) AS CNT FROM CTE1 AS A LEFT JOIN (SELECT DISTINCT CUSTOMER_ID, PRODUCT_NAME FROM ORDERS WHERE PRODUCT_NAME IN ('A','B')) AS B ON A.CUSTOMER_ID=B.CUSTOMER_ID ) SELECT DISTINCT CUSTOMER_ID , CUSTOMER_NAME FROM CTE2 WHERE CNT=2 ORDER BY CUSTOMER_ID"
383,Y,Y,"WITH A AS ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A' ), B AS ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B' ), T AS ( SELECT A.CUSTOMER_ID FROM A INNER JOIN B ON A.CUSTOMER_ID = B.CUSTOMER_ID WHERE A.CUSTOMER_ID NOT IN ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C' ) ) SELECT T.CUSTOMER_ID, CUSTOMER_NAME FROM T LEFT OUTER JOIN CUSTOMERS ON T.CUSTOMER_ID = CUSTOMERS.CUSTOMER_ID"
384,Y,Y,"WITH CUSTAB_C AS( SELECT CUSTOMER_ID ,SUM(CASE WHEN PRODUCT_NAME='A' THEN 1 ELSE 0 END) A ,SUM(CASE WHEN PRODUCT_NAME='B' THEN 1 ELSE 0 END) B ,SUM(CASE WHEN PRODUCT_NAME='C' THEN 1 ELSE 0 END) C FROM ORDERS GROUP BY CUSTOMER_ID HAVING A>0 AND B>0 AND C=0 ) SELECT CO.CUSTOMER_ID ,CO.CUSTOMER_NAME FROM CUSTOMERS CO JOIN (SELECT CUSTOMER_ID FROM CUSTAB_C )A ON CO.CUSTOMER_ID = A.CUSTOMER_ID"
385,Y,Y,"WITH A AS (SELECT O.CUSTOMER_ID, C.CUSTOMER_NAME, GROUP_CONCAT(DISTINCT PRODUCT_NAME ORDER BY PRODUCT_NAME SEPARATOR ',') ALL_P FROM ORDERS O JOIN CUSTOMERS C ON O.CUSTOMER_ID=C.CUSTOMER_ID GROUP BY 1) SELECT CUSTOMER_ID, CUSTOMER_NAME FROM A WHERE ALL_P LIKE ('A,B%') AND ALL_P NOT LIKE ('%C%')"
386,Y,Y,"SELECT C.CUSTOMER_ID AS CUSTOMER_ID,C.CUSTOMER_NAME AS CUSTOMER_NAME FROM CUSTOMERS C LEFT JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID GROUP BY CUSTOMER_ID HAVING SUM(IF(PRODUCT_NAME='C',1,0)) = 0 AND SUM(O.PRODUCT_NAME = 'A') > 0 AND SUM(O.PRODUCT_NAME = 'B') > 0 ORDER BY CUSTOMER_ID"
387,Y,Y,"SELECT ORDERS.CUSTOMER_ID, CUSTOMERS.CUSTOMER_NAME FROM CUSTOMERS JOIN ORDERS ON CUSTOMERS.CUSTOMER_ID = ORDERS.CUSTOMER_ID GROUP BY ORDERS.CUSTOMER_ID HAVING SUM(ORDERS.PRODUCT_NAME='A')>0 AND SUM(ORDERS.PRODUCT_NAME='B')>0 AND SUM(ORDERS.PRODUCT_NAME='C')=0 ORDER BY ORDERS.CUSTOMER_ID"
388,Y,Y,"SELECT CUSTOMERS.CUSTOMER_ID, CUSTOMERS.CUSTOMER_NAME FROM (SELECT T.CUSTOMER_ID FROM (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B')) T LEFT JOIN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') ) W ON T.CUSTOMER_ID = W.CUSTOMER_ID WHERE W.CUSTOMER_ID IS NULL) X INNER JOIN CUSTOMERS ON X.CUSTOMER_ID = CUSTOMERS.CUSTOMER_ID"
389,Y,Y,"WITH T1 AS ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A' ), T2 AS ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B' ), T3 AS ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C' ) SELECT T1.CUSTOMER_ID, C.CUSTOMER_NAME FROM T1 JOIN T2 ON T1.CUSTOMER_ID = T2.CUSTOMER_ID JOIN CUSTOMERS C ON T1.CUSTOMER_ID = C.CUSTOMER_ID WHERE T1.CUSTOMER_ID NOT IN (SELECT * FROM T3) ORDER BY 1"
390,Y,Y,"SELECT DISTINCT O.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS O JOIN CUSTOMERS C USING(CUSTOMER_ID) WHERE CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') ORDER BY O.CUSTOMER_ID"
391,Y,N,"WITH AB AS ( SELECT CUSTOMER_ID FROM ORDERS WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND PRODUCT_NAME = 'B' ) SELECT A.CUSTOMER_ID, CUSTOMER_NAME FROM AB A JOIN CUSTOMERS C USING(CUSTOMER_ID) WHERE A.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') ORDER BY CUSTOMER_ID"
392,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM (SELECT CUSTOMER_ID, CUSTOMER_NAME, BIT_OR(CASE PRODUCT_NAME WHEN 'A' THEN 1 WHEN 'B' THEN 2 WHEN 'C' THEN 4 ELSE 0 END) COD FROM CUSTOMERS NATURAL JOIN ORDERS GROUP BY CUSTOMER_ID) T WHERE COD = 3"
393,Y,Y,"WITH A AS ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A' ), B AS ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B' ), C AS ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C' ) SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM A) AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM B) AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM C)"
394,Y,Y,"SELECT A.CUSTOMER_ID, A.CUSTOMER_NAME FROM CUSTOMERS AS A JOIN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME IN ('A', 'B') AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') GROUP BY CUSTOMER_ID HAVING COUNT(DISTINCT PRODUCT_NAME) > 1) AS B ON A.CUSTOMER_ID = B.CUSTOMER_ID ORDER BY A.CUSTOMER_ID"
395,Y,Y,"SELECT DISTINCT O.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS O JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID WHERE O.CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND O.CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND O.CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') ORDER BY 1"
396,Y,Y,"SELECT T.CUSTOMER_ID, T.CUSTOMER_NAME FROM ( SELECT O.CUSTOMER_ID, C.CUSTOMER_NAME, SUM(IF(O.PRODUCT_NAME='A',1,0)) AS PROD_A, SUM(IF(O.PRODUCT_NAME='B',1,0)) AS PROD_B, SUM(IF(O.PRODUCT_NAME='C',1,0)) AS PROD_C, SUM(IF(O.PRODUCT_NAME='D',1,0)) AS PROD_D FROM ORDERS O LEFT JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID GROUP BY O.CUSTOMER_ID) T WHERE T.PROD_A>0 AND T.PROD_B>0 AND T.PROD_C=0"
397,Y,Y,"SELECT DISTINCT CUSTOMERS.CUSTOMER_ID, CUSTOMERS.CUSTOMER_NAME FROM (SELECT T.CUSTOMER_ID FROM (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B')) T LEFT JOIN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') ) W ON T.CUSTOMER_ID = W.CUSTOMER_ID WHERE W.CUSTOMER_ID IS NULL) X INNER JOIN CUSTOMERS ON X.CUSTOMER_ID = CUSTOMERS.CUSTOMER_ID"
398,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS AS C INNER JOIN ORDERS AS O ON C.CUSTOMER_ID = O.CUSTOMER_ID GROUP BY C.CUSTOMER_ID, C.CUSTOMER_NAME HAVING MAX(IF(O.PRODUCT_NAME='A', 1, 0)) = 1 AND MAX(IF(O.PRODUCT_NAME='B', 1, 0)) = 1 AND MAX(IF(O.PRODUCT_NAME='C', 1, 0)) = 0 ORDER BY C.CUSTOMER_ID ASC"
399,Y,Y,"SELECT A.CUSTOMER_ID,B.CUSTOMER_NAME FROM (SELECT CUSTOMER_ID, SUM(CASE WHEN PRODUCT_NAME = 'A' THEN 1 ELSE 0 END ) AS A_FLAG, SUM(CASE WHEN PRODUCT_NAME = 'B' THEN 1 ELSE 0 END ) AS B_FLAG, SUM(CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END ) AS C_FLAG FROM ORDERS GROUP BY CUSTOMER_ID)A JOIN CUSTOMERS AS B ON A.CUSTOMER_ID = B.CUSTOMER_ID WHERE A.A_FLAG >= 1 AND A.B_FLAG >= 1 AND A.C_FLAG = 0"
400,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM (SELECT ORDERS.CUSTOMER_ID AS CUSTOMER_ID, CUSTOMERS.CUSTOMER_NAME AS CUSTOMER_NAME, GROUP_CONCAT(ORDERS.PRODUCT_NAME) AS PRODUCT_NAME FROM ORDERS LEFT JOIN CUSTOMERS ON CUSTOMERS.CUSTOMER_ID = ORDERS.CUSTOMER_ID GROUP BY CUSTOMER_ID HAVING PRODUCT_NAME LIKE '%A%' AND PRODUCT_NAME LIKE '%B%' AND PRODUCT_NAME NOT LIKE '%C%') TEMP ORDER BY CUSTOMER_ID"
401,Y,Y,"WITH T1 AS( SELECT DISTINCT CUSTOMER_ID AS TESTA FROM ORDERS WHERE PRODUCT_NAME='A' ), T2 AS( SELECT DISTINCT CUSTOMER_ID AS TESTB FROM ORDERS WHERE PRODUCT_NAME='B' ), T3 AS( SELECT DISTINCT CUSTOMER_ID AS TESTC FROM ORDERS WHERE PRODUCT_NAME='C' ) SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT * FROM T1) AND CUSTOMER_ID IN (SELECT * FROM T2) AND CUSTOMER_ID NOT IN (SELECT * FROM T3)"
402,Y,Y,"WITH C1 AS(SELECT CUSTOMER_ID FROM ORDERS GROUP BY 1 HAVING SUM(PRODUCT_NAME = 'A') > 0 AND SUM(PRODUCT_NAME = 'B')>0 AND SUM(PRODUCT_NAME = 'C') = 0 ORDER BY 1) SELECT C1.CUSTOMER_ID, CUSTOMER_NAME FROM C1 LEFT JOIN CUSTOMERS USING(CUSTOMER_ID)"
403,Y,Y,"WITH TEMP AS ( SELECT CUSTOMER_ID , MAX(CASE WHEN PRODUCT_NAME = 'A' THEN 1 ELSE 0 END) AS COL_A, MAX(CASE WHEN PRODUCT_NAME = 'B' THEN 1 ELSE 0 END) AS COL_B, MAX(CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END) AS COL_C FROM ORDERS GROUP BY CUSTOMER_ID) SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C JOIN TEMP T ON C.CUSTOMER_ID = T.CUSTOMER_ID WHERE T.COL_A = 1 AND T.COL_B = 1 AND T.COL_C = 0"
404,Y,Y,"SELECT * FROM ( SELECT IF(SUM(O.PRODUCT_NAME='A')>0 AND SUM(O.PRODUCT_NAME='B')>0 AND SUM(O.PRODUCT_NAME='C')=0 ,C.CUSTOMER_ID, NULL) AS CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID GROUP BY C.CUSTOMER_ID ORDER BY C.CUSTOMER_ID) T WHERE CUSTOMER_ID IS NOT NULL"
405,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME IN ('C')) AND CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME IN ('A')) AND CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME IN ('B')))"
406,Y,Y,"WITH T1 AS ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE (CUSTOMER_ID, 'A') IN (SELECT CUSTOMER_ID, PRODUCT_NAME FROM ORDERS) AND (CUSTOMER_ID, 'B') IN (SELECT CUSTOMER_ID, PRODUCT_NAME FROM ORDERS) AND (CUSTOMER_ID, 'C') NOT IN (SELECT CUSTOMER_ID, PRODUCT_NAME FROM ORDERS) ) SELECT * FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT * FROM T1)"
407,Y,Y,"SELECT CUSTOMERS.CUSTOMER_ID, CUSTOMER_NAME FROM ORDERS JOIN CUSTOMERS ON ORDERS.CUSTOMER_ID = CUSTOMERS.CUSTOMER_ID GROUP BY ORDERS.CUSTOMER_ID HAVING( SUM(PRODUCT_NAME = 'A') > 0 AND SUM(PRODUCT_NAME = 'B') > 0 AND SUM(PRODUCT_NAME = 'C') = 0 )"
408,Y,Y,"SELECT DISTINCT A.CUSTOMER_ID,Z.CUSTOMER_NAME FROM (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME IN ('A','B') GROUP BY 1 HAVING COUNT(DISTINCT PRODUCT_NAME)>1)A LEFT JOIN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME IN ('C')) B ON A.CUSTOMER_ID=B.CUSTOMER_ID INNER JOIN CUSTOMERS Z ON A.CUSTOMER_ID=Z.CUSTOMER_ID WHERE B.CUSTOMER_ID IS NULL"
409,Y,Y,SELECT * FROM CUSTOMERS WHERE CUSTOMER_ID IN ( SELECT C.CUSTOMER_ID FROM CUSTOMERS C LEFT JOIN ORDERS O ON C.CUSTOMER_ID=O.CUSTOMER_ID WHERE PRODUCT_NAME ='A' OR PRODUCT_NAME='B' GROUP BY C.CUSTOMER_ID HAVING COUNT(DISTINCT PRODUCT_NAME)=2) AND CUSTOMER_ID NOT IN ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') ORDER BY CUSTOMER_ID
410,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS NATURAL JOIN ORDERS GROUP BY CUSTOMER_ID, CUSTOMER_NAME HAVING GROUP_CONCAT(DISTINCT PRODUCT_NAME ORDER BY PRODUCT_NAME ASC) LIKE 'A,B%' AND GROUP_CONCAT(DISTINCT PRODUCT_NAME ORDER BY PRODUCT_NAME ASC) NOT LIKE '%C%'"
411,Y,Y,"SELECT DISTINCT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID GROUP BY C.CUSTOMER_ID HAVING SUM(IF(O.PRODUCT_NAME = 'A',1,0))>0 AND SUM(IF(O.PRODUCT_NAME = 'B',1,0))>0 AND SUM(IF(O.PRODUCT_NAME = 'C',1,0))=0"
412,Y,Y,"SELECT C.CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS C JOIN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') OA ON C.CUSTOMER_ID = OA.CUSTOMER_ID JOIN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') OB ON C.CUSTOMER_ID = OB.CUSTOMER_ID WHERE C.CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') ORDER BY 1"
413,Y,Y,"WITH TB AS ( SELECT CUSTOMER_ID, IF(PRODUCT_NAME = 'A',1,0) AS A, IF(PRODUCT_NAME = 'B',1,0) AS B, IF(PRODUCT_NAME = 'C',1,0) AS C FROM ORDERS ), TB1 AS ( SELECT CUSTOMER_ID FROM TB GROUP BY CUSTOMER_ID HAVING SUM(A) > 0 AND SUM(B) >0 AND SUM(C) = 0 ) SELECT CUSTOMERS.* FROM CUSTOMERS JOIN TB1 USING(CUSTOMER_ID)"
414,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT ORDERS.CUSTOMER_ID FROM ORDERS WHERE ORDERS.CUSTOMER_ID = CUSTOMERS.CUSTOMER_ID AND PRODUCT_NAME = 'A') AND CUSTOMER_ID IN (SELECT ORDERS.CUSTOMER_ID FROM ORDERS WHERE ORDERS.CUSTOMER_ID = CUSTOMERS.CUSTOMER_ID AND PRODUCT_NAME = 'B') AND CUSTOMER_ID NOT IN (SELECT ORDERS.CUSTOMER_ID FROM ORDERS WHERE ORDERS.CUSTOMER_ID = CUSTOMERS.CUSTOMER_ID AND PRODUCT_NAME = 'C') ORDER BY CUSTOMER_ID"
415,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS AS C WHERE EXISTS (SELECT * FROM ORDERS AS O WHERE O.CUSTOMER_ID = C.CUSTOMER_ID AND O.PRODUCT_NAME = 'A' ) AND EXISTS (SELECT * FROM ORDERS AS O WHERE O.CUSTOMER_ID = C.CUSTOMER_ID AND O.PRODUCT_NAME = 'B') AND NOT EXISTS (SELECT * FROM ORDERS AS O WHERE O.CUSTOMER_ID = C.CUSTOMER_ID AND O.PRODUCT_NAME = 'C') ORDER BY C.CUSTOMER_ID"
416,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS JOIN ORDERS USING(CUSTOMER_ID) GROUP BY CUSTOMER_ID HAVING SUM(PRODUCT_NAME = 'A') > 0 AND SUM(PRODUCT_NAME = 'B') > 0 AND SUM(PRODUCT_NAME = 'C') = 0"
417,Y,Y,"SELECT DISTINCT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS O1 JOIN ORDERS O2 ON O1.CUSTOMER_ID = O2.CUSTOMER_ID AND O1.PRODUCT_NAME = 'A' AND O2.PRODUCT_NAME = 'B' LEFT JOIN CUSTOMERS C ON O1.CUSTOMER_ID = C.CUSTOMER_ID HAVING C.CUSTOMER_ID NOT IN (SELECT DISTINCT(CUSTOMER_ID) FROM ORDERS WHERE PRODUCT_NAME = 'C')"
418,Y,Y,"SELECT DISTINCT C.CUSTOMER_ID,C.CUSTOMER_NAME FROM CUSTOMERS AS C JOIN ORDERS AS O ON C.CUSTOMER_ID=O.CUSTOMER_ID WHERE C.CUSTOMER_ID IN( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='A' ) AND O.CUSTOMER_ID IN( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='B' ) AND O.CUSTOMER_ID NOT IN( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='C' )"
419,Y,Y,"SELECT DISTINCT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID AND O.PRODUCT_NAME = 'A' JOIN ORDERS O2 ON C.CUSTOMER_ID = O2.CUSTOMER_ID AND O2.PRODUCT_NAME = 'B' LEFT OUTER JOIN ORDERS O3 ON C.CUSTOMER_ID = O3.CUSTOMER_ID AND O3.PRODUCT_NAME = 'C' WHERE O3.ORDER_ID IS NULL ORDER BY C.CUSTOMER_ID"
420,Y,N,"SELECT A.CUSTOMER_ID, A.CUSTOMER_NAME FROM (SELECT CUSTOMER_NAME, C.CUSTOMER_ID, SUM(CASE WHEN PRODUCT_NAME IN ('A','B') THEN 1 ELSE 0 END) AS A_OR_B, SUM(CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END) AS C FROM CUSTOMERS AS C JOIN ORDERS AS O ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE PRODUCT_NAME IN ('A','B','C') GROUP BY CUSTOMER_NAME, CUSTOMER_ID HAVING A_OR_B >= 2 AND C = 0) AS A"
421,Y,Y,"SELECT DISTINCT A.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS A JOIN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') B ON A.CUSTOMER_ID = B.CUSTOMER_ID JOIN CUSTOMERS C ON C.CUSTOMER_ID = A.CUSTOMER_ID WHERE PRODUCT_NAME = 'A' AND A.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='C')"
422,Y,Y,"SELECT DISTINCT O.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS O LEFT JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID WHERE O.PRODUCT_NAME = 'A' AND O.CUSTOMER_ID IN ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B' ) AND O.CUSTOMER_ID NOT IN ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C' ) ORDER BY CUSTOMER_ID"
423,Y,Y,"SELECT DISTINCT C.CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE PRODUCT_NAME IN ('A') AND C.CUSTOMER_ID IN ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS O WHERE PRODUCT_NAME IN ('B') AND CUSTOMER_ID NOT IN ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS O WHERE PRODUCT_NAME IN ('C') ) )"
424,Y,N,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM ( SELECT C.CUSTOMER_ID, CUSTOMER_NAME, SUM(CNT) AS TC FROM ( SELECT CUSTOMER_ID, CASE WHEN PRODUCT_NAME='A' THEN 1 WHEN PRODUCT_NAME='B' THEN 1 WHEN PRODUCT_NAME='C' THEN -1 ELSE 0 END AS CNT FROM ORDERS) T JOIN CUSTOMERS C ON C.CUSTOMER_ID=T.CUSTOMER_ID GROUP BY C.CUSTOMER_ID ) T1 WHERE TC>=2"
425,Y,Y,"SELECT DISTINCT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS A ON A.CUSTOMER_ID = C.CUSTOMER_ID AND A.PRODUCT_NAME = 'A' JOIN ORDERS B ON B.CUSTOMER_ID = C.CUSTOMER_ID AND B.PRODUCT_NAME = 'B' LEFT OUTER JOIN ORDERS O ON O.CUSTOMER_ID = C.CUSTOMER_ID AND O.PRODUCT_NAME = 'C' WHERE O.ORDER_ID IS NULL"
426,Y,Y,"SELECT DISTINCT(CUSTOMER_ID), CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT DISTINCT(CUSTOMER_ID) FROM ORDERS WHERE PRODUCT_NAME = 'A' ) AND CUSTOMER_ID IN (SELECT DISTINCT(CUSTOMER_ID) FROM ORDERS WHERE PRODUCT_NAME = 'B' ) AND CUSTOMER_ID NOT IN (SELECT DISTINCT(CUSTOMER_ID) FROM ORDERS WHERE PRODUCT_NAME='C')"
427,Y,Y,"SELECT * FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM (SELECT CUSTOMER_ID, GROUP_CONCAT(PRODUCT_NAME SEPARATOR '') AS PRODUCTS FROM ORDERS GROUP BY CUSTOMER_ID) T1 WHERE PRODUCTS NOT LIKE '%C%' AND PRODUCTS LIKE '%A%' AND PRODUCTS LIKE '%B%' )"
428,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID GROUP BY 1 HAVING SUM(O.PRODUCT_NAME='A') >0 AND SUM(O.PRODUCT_NAME='B') >0 AND SUM(O.PRODUCT_NAME='C') =0"
429,Y,Y,"SELECT CUSTOMERS.CUSTOMER_ID,CUSTOMERS.CUSTOMER_NAME FROM CUSTOMERS LEFT JOIN (SELECT CUSTOMER_ID, GROUP_CONCAT(PRODUCT_NAME ORDER BY PRODUCT_NAME) AS SHOPLIST FROM ORDERS GROUP BY CUSTOMER_ID) T1 ON CUSTOMERS.CUSTOMER_ID = T1.CUSTOMER_ID WHERE SHOPLIST LIKE '%A%' AND SHOPLIST LIKE '%B%' AND SHOPLIST NOT LIKE '%C%'"
430,Y,Y,"WITH ORDER_TOTALS AS ( SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME, SUM(O.PRODUCT_NAME = 'A') AS A_TOTAL, SUM(O.PRODUCT_NAME = 'B') AS B_TOTAL, SUM(O.PRODUCT_NAME = 'C') AS C_TOTAL FROM CUSTOMERS AS C JOIN ORDERS AS O ON C.CUSTOMER_ID = O.CUSTOMER_ID GROUP BY C.CUSTOMER_ID) SELECT CUSTOMER_ID, CUSTOMER_NAME FROM ORDER_TOTALS WHERE A_TOTAL != 0 AND B_TOTAL != 0 AND C_TOTAL = 0 ORDER BY CUSTOMER_ID"
431,Y,Y,"SELECT DISTINCT O.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS AS O LEFT JOIN CUSTOMERS AS C ON O.CUSTOMER_ID = C.CUSTOMER_ID WHERE O.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND O.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND O.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')"
432,Y,Y,"WITH CUSTA AS ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME IN ('A') ), CUSTB AS ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME IN ('B') ), CUSTC AS ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME IN ('C') ) SELECT DISTINCT A.CUSTOMER_ID, B.CUSTOMER_NAME FROM ORDERS AS A JOIN CUSTOMERS AS B ON A.CUSTOMER_ID = B.CUSTOMER_ID WHERE A.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM CUSTA) AND A.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM CUSTB) AND NOT A.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM CUSTC) ORDER BY CUSTOMER_ID"
433,Y,Y,"SELECT DISTINCT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C LEFT JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE C.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND C.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='B') AND C.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') ORDER BY 1"
434,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS AS C JOIN (SELECT CUSTOMER_ID FROM ORDERS GROUP BY CUSTOMER_ID HAVING SUM(PRODUCT_NAME='A') > 0 AND SUM(PRODUCT_NAME='B') > 0 AND SUM(PRODUCT_NAME='C') = 0 ) AS T1 ON C.CUSTOMER_ID = T1.CUSTOMER_ID"
435,Y,Y,"SELECT C.CUSTOMER_ID,C.CUSTOMER_NAME FROM CUSTOMERS C WHERE C.CUSTOMER_ID IN (SELECT O.CUSTOMER_ID FROM ORDERS O WHERE O.PRODUCT_NAME='A') AND C.CUSTOMER_ID IN (SELECT O.CUSTOMER_ID FROM ORDERS O WHERE O.PRODUCT_NAME='B') AND C.CUSTOMER_ID NOT IN (SELECT O.CUSTOMER_ID FROM ORDERS O WHERE O.PRODUCT_NAME='C')"
436,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS C WHERE CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='A') AND CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='B') AND CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='C')"
437,Y,Y,SELECT * FROM CUSTOMERS WHERE CUSTOMERS.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND CUSTOMERS.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND CUSTOMERS.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') ORDER BY CUSTOMER_ID
438,Y,Y,"SELECT A.CUSTOMER_ID, A.CUSTOMER_NAME FROM CUSTOMERS A WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') ORDER BY CUSTOMER_ID"
439,Y,Y,"SELECT DISTINCT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE C.CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') AND C.CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND C.CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B')"
440,Y,Y,"SELECT T.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C INNER JOIN (SELECT DISTINCT A.CUSTOMER_ID FROM (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AS A LEFT JOIN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AS B ON A.CUSTOMER_ID = B.CUSTOMER_ID LEFT JOIN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') AS C ON A.CUSTOMER_ID = C.CUSTOMER_ID WHERE B.CUSTOMER_ID IS NOT NULL AND C.CUSTOMER_ID IS NULL) AS T ON C.CUSTOMER_ID = T.CUSTOMER_ID"
441,Y,Y,"SELECT C.CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS C LEFT JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID GROUP BY C.CUSTOMER_ID HAVING SUM(PRODUCT_NAME = 'A') > 0 AND SUM(PRODUCT_NAME = 'B') > 0 AND SUM(PRODUCT_NAME = 'C') = 0 ORDER BY C.CUSTOMER_ID"
442,Y,Y,"SELECT DISTINCT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE C.CUSTOMER_ID IN (SELECT O1.CUSTOMER_ID FROM ORDERS O1 WHERE O1.PRODUCT_NAME = 'A') AND C.CUSTOMER_ID IN (SELECT O2.CUSTOMER_ID FROM ORDERS O2 WHERE O2.PRODUCT_NAME = 'B') AND C.CUSTOMER_ID NOT IN (SELECT O3.CUSTOMER_ID FROM ORDERS O3 WHERE O3.PRODUCT_NAME = 'C') ORDER BY C.CUSTOMER_ID"
443,Y,N,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM (SELECT ORD.CUSTOMER_ID, CUS.CUSTOMER_NAME, SUM(CASE WHEN PRODUCT_NAME = 'A' THEN 1 WHEN PRODUCT_NAME = 'B' THEN 1 WHEN PRODUCT_NAME = 'C' THEN -1 ELSE 0 END) AS SCORE FROM ORDERS ORD JOIN CUSTOMERS CUS ON ORD.CUSTOMER_ID = CUS.CUSTOMER_ID GROUP BY 1) A WHERE SCORE>=2"
444,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS C WHERE NOT EXISTS( SELECT 1 FROM ORDERS WHERE CUSTOMER_ID = C.CUSTOMER_ID AND PRODUCT_NAME = 'C' ) AND EXISTS ( SELECT 1 FROM ORDERS WHERE CUSTOMER_ID = C.CUSTOMER_ID AND PRODUCT_NAME = 'A' ) AND EXISTS ( SELECT 1 FROM ORDERS WHERE CUSTOMER_ID = C.CUSTOMER_ID AND PRODUCT_NAME = 'B' )"
445,Y,Y,"WITH CTE AS(SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='A' AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='B') AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='C')) SELECT A.CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS A JOIN CTE B ON A.CUSTOMER_ID=B.CUSTOMER_ID"
446,Y,Y,"SELECT O.CUSTOMER_ID,C.CUSTOMER_NAME FROM ORDERS O LEFT JOIN CUSTOMERS C ON O.CUSTOMER_ID=C.CUSTOMER_ID GROUP BY O.CUSTOMER_ID HAVING SUM(PRODUCT_NAME='A')>0 AND SUM(PRODUCT_NAME='B')>0 AND SUM(PRODUCT_NAME='C')=0"
447,Y,Y,"SELECT O.CUSTOMER_ID,C.CUSTOMER_NAME FROM (SELECT CUSTOMER_ID, GROUP_CONCAT(DISTINCT PRODUCT_NAME ORDER BY PRODUCT_NAME) AS LIST FROM ORDERS GROUP BY 1)O JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID AND O.LIST LIKE 'A,B%' AND O.LIST NOT LIKE '%C%' ORDER BY 1"
448,Y,Y,"WITH TEMP AS (SELECT C.CUSTOMER_ID,C.CUSTOMER_NAME,GROUP_CONCAT(O.PRODUCT_NAME) AS PRD_GRPS FROM CUSTOMERS C LEFT JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID GROUP BY 1,2) SELECT CUSTOMER_ID,CUSTOMER_NAME FROM TEMP WHERE (PRD_GRPS LIKE '%A%' AND PRD_GRPS LIKE '%B%') AND (PRD_GRPS NOT LIKE '%C%')"
449,Y,Y,"SELECT DISTINCT C.CUSTOMER_ID,C.CUSTOMER_NAME FROM CUSTOMERS AS C JOIN ORDERS AS O ON C.CUSTOMER_ID=O.CUSTOMER_ID WHERE O.CUSTOMER_ID IN( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='A' ) AND O.CUSTOMER_ID IN( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='B' ) AND O.CUSTOMER_ID NOT IN( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='C' )"
450,Y,N,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID GROUP BY C.CUSTOMER_NAME HAVING SUM(PRODUCT_NAME = 'A') > 0 AND SUM(PRODUCT_NAME = 'B') > 0 AND SUM(PRODUCT_NAME = 'C') = 0"
451,Y,Y,"WITH PORD1 AS (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A'), PORD2 AS (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B'), PORD3 AS (SELECT CUSTOMER_ID FROM ORDERS WHERE CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')) SELECT DISTINCT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C INNER JOIN PORD1 P1 ON P1.CUSTOMER_ID = C.CUSTOMER_ID INNER JOIN PORD2 P2 ON P2.CUSTOMER_ID = P1.CUSTOMER_ID INNER JOIN PORD3 P3 ON P3.CUSTOMER_ID = P2.CUSTOMER_ID"
452,Y,Y,SELECT * FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT C.CUSTOMER_ID FROM CUSTOMERS C LEFT JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE O.PRODUCT_NAME = 'A' OR O.PRODUCT_NAME = 'B' GROUP BY 1 HAVING COUNT(DISTINCT O.PRODUCT_NAME) = 2 AND C.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')) ORDER BY 1
453,Y,Y,"WITH PRODUCT_COUNTS AS ( SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME, SUM(O.PRODUCT_NAME = 'A') AS A_COUNT, SUM(O.PRODUCT_NAME = 'B') AS B_COUNT, SUM(O.PRODUCT_NAME = 'C') AS C_COUNT FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID GROUP BY C.CUSTOMER_ID ) SELECT CUSTOMER_ID, CUSTOMER_NAME FROM PRODUCT_COUNTS WHERE A_COUNT > 0 AND B_COUNT > 0 AND C_COUNT = 0 ORDER BY CUSTOMER_ID"
454,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C LEFT JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID GROUP BY C.CUSTOMER_ID HAVING SUM(O.PRODUCT_NAME = 'A') > 0 AND SUM(O.PRODUCT_NAME = 'B') > 0 AND SUM(O.PRODUCT_NAME = 'C') = 0 ORDER BY C.CUSTOMER_ID"
455,Y,Y,"SELECT O.CUSTOMER_ID,C.CUSTOMER_NAME FROM ORDERS O INNER JOIN CUSTOMERS C ON O.CUSTOMER_ID=C.CUSTOMER_ID GROUP BY O.CUSTOMER_ID,C.CUSTOMER_NAME HAVING SUM(CASE WHEN O.PRODUCT_NAME='A' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN O.PRODUCT_NAME='B' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN O.PRODUCT_NAME='C' THEN 1 ELSE 0 END)=0"
456,Y,Y,"SELECT DISTINCT C1.CUSTOMER_ID, C1.CUSTOMER_NAME FROM CUSTOMERS C1 JOIN ORDERS O1 ON C1.CUSTOMER_ID = O1.CUSTOMER_ID JOIN ORDERS O2 ON O1.CUSTOMER_ID = O2.CUSTOMER_ID AND O1.PRODUCT_NAME = 'A' AND O2.PRODUCT_NAME = 'B' LEFT JOIN ORDERS O3 ON O3.CUSTOMER_ID = O2.CUSTOMER_ID AND O3.PRODUCT_NAME = 'C' WHERE O3.CUSTOMER_ID IS NULL ORDER BY 1"
457,Y,Y,"SELECT O.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C INNER JOIN ORDERS O ON C.CUSTOMER_ID= O.CUSTOMER_ID WHERE O.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A' AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B')) AND O.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') GROUP BY CUSTOMER_ID"
458,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A' AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B' AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')) ) ORDER BY CUSTOMER_ID"
459,Y,Y,"SELECT DISTINCT C.CUSTOMER_ID,C.CUSTOMER_NAME FROM ORDERS O, CUSTOMERS C WHERE PRODUCT_NAME ='A' AND O.CUSTOMER_ID=C.CUSTOMER_ID AND C.CUSTOMER_ID NOT IN ( SELECT CUSTOMER_ID FROM ORDERS INR WHERE INR.PRODUCT_NAME='C') AND C.CUSTOMER_ID IN ( SELECT CUSTOMER_ID FROM ORDERS INR WHERE INR.PRODUCT_NAME='B') ORDER BY C.CUSTOMER_ID"
460,Y,Y,"WITH CUSTOMER_TO_MATCH AS ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')) SELECT M.CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS C JOIN CUSTOMER_TO_MATCH M ON C.CUSTOMER_ID = M.CUSTOMER_ID"
461,Y,Y,"WITH A AS (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A'), B AS (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') SELECT CUSTOMERS.CUSTOMER_ID, CUSTOMERS.CUSTOMER_NAME FROM A, B, CUSTOMERS WHERE A.CUSTOMER_ID = B.CUSTOMER_ID AND A.CUSTOMER_ID = CUSTOMERS.CUSTOMER_ID AND CUSTOMERS.CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')"
462,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C LEFT JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID GROUP BY 1 HAVING SUM(O.PRODUCT_NAME = 'A') > 0 AND SUM(O.PRODUCT_NAME = 'B') > 0 AND SUM(O.PRODUCT_NAME = 'C') = 0 ORDER BY 1"
463,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM (SELECT O1.CUSTOMER_ID, C1.CUSTOMER_NAME, SUM(CASE WHEN PRODUCT_NAME='A' THEN 1 ELSE 0 END)CA, SUM(CASE WHEN PRODUCT_NAME='B' THEN 1 ELSE 0 END)CB, SUM(CASE WHEN PRODUCT_NAME='C' THEN 1 ELSE 0 END)CC FROM ORDERS O1 JOIN CUSTOMERS C1 ON C1.CUSTOMER_ID = O1.CUSTOMER_ID GROUP BY 1,2 ) CT WHERE CA>=1 AND CB>=1 AND CC=0 ORDER BY 1"
464,Y,Y,"SELECT A.CUSTOMER_ID, A.CUSTOMER_NAME FROM CUSTOMERS A JOIN (SELECT CUSTOMER_ID, SUM(CASE WHEN PRODUCT_NAME='A' THEN 1 ELSE 0 END) AS A, SUM(CASE WHEN PRODUCT_NAME='B' THEN 1 ELSE 0 END) AS B, SUM(CASE WHEN PRODUCT_NAME='C' THEN 1 ELSE 0 END) AS C FROM ORDERS GROUP BY 1) B ON A.CUSTOMER_ID=B.CUSTOMER_ID WHERE A>=1 AND B>=1 AND C=0 ORDER BY CUSTOMER_ID"
465,Y,Y,"SELECT T1.CUSTOMER_ID, T1.CUSTOMER_NAME FROM CUSTOMERS T1 JOIN ORDERS T2 ON T1.CUSTOMER_ID = T2.CUSTOMER_ID GROUP BY T1.CUSTOMER_ID HAVING SUM(T2.PRODUCT_NAME = 'A') >= 1 AND SUM(T2.PRODUCT_NAME = 'B') >= 1 AND SUM(T2.PRODUCT_NAME = 'C') = 0"
466,Y,Y,"SELECT DISTINCT O.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS O LEFT JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID GROUP BY 1 HAVING SUM(O.PRODUCT_NAME = 'A')>0 AND SUM(O.PRODUCT_NAME = 'B') >0 AND SUM(O.PRODUCT_NAME = 'C') = 0"
467,Y,Y,"WITH T AS (SELECT * FROM ORDERS WHERE PRODUCT_NAME = 'A' GROUP BY 1) , T2 AS ( SELECT * FROM T WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') ) SELECT DISTINCT T2.CUSTOMER_ID, C.CUSTOMER_NAME FROM T2 JOIN CUSTOMERS C ON T2.CUSTOMER_ID = C.CUSTOMER_ID"
468,Y,Y,"WITH CTE AS(SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME, SUM(IF(O.PRODUCT_NAME='A',1,0)) AS ACOUNT, SUM(IF(O.PRODUCT_NAME='B',1,0)) AS BCOUNT, SUM(IF(O.PRODUCT_NAME='C',1,0)) CCOUNT FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID=O.CUSTOMER_ID GROUP BY 1) SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CTE WHERE ACOUNT>0 AND BCOUNT>0 AND CCOUNT=0"
469,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O USING (CUSTOMER_ID) GROUP BY C.CUSTOMER_ID, C.CUSTOMER_NAME HAVING SUM(PRODUCT_NAME = 'A') > 0 AND SUM(PRODUCT_NAME = 'B') > 0 AND SUM(PRODUCT_NAME = 'C') = 0"
470,Y,Y,"SELECT DISTINCT ORDERS.CUSTOMER_ID, CUSTOMERS.CUSTOMER_NAME FROM ORDERS JOIN CUSTOMERS ON ORDERS.CUSTOMER_ID=CUSTOMERS.CUSTOMER_ID WHERE PRODUCT_NAME = 'A' AND ORDERS.CUSTOMER_ID IN ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME= 'B' ) AND ORDERS.CUSTOMER_ID NOT IN ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C' )"
471,Y,Y,"SELECT DISTINCT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS A ON A.CUSTOMER_ID = C.CUSTOMER_ID AND A.PRODUCT_NAME = 'A' JOIN ORDERS B ON B.CUSTOMER_ID = C.CUSTOMER_ID AND B.PRODUCT_NAME = 'B' LEFT OUTER JOIN ORDERS O ON O.CUSTOMER_ID = C.CUSTOMER_ID AND O.PRODUCT_NAME = 'C' WHERE O.ORDER_ID IS NULL ORDER BY C.CUSTOMER_ID"
472,Y,Y,"WITH TMPA AS ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A' ), TMPB AS ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B' ), TMPC AS ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C' ) SELECT * FROM CUSTOMERS WHERE CUSTOMER_ID IN ( SELECT * FROM TMPA ) AND CUSTOMER_ID IN ( SELECT * FROM TMPB ) AND CUSTOMER_ID NOT IN ( SELECT * FROM TMPC )"
473,Y,Y,"SELECT * FROM CUSTOMERS WHERE CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME IN ('A', 'B') GROUP BY CUSTOMER_ID HAVING COUNT(DISTINCT PRODUCT_NAME) = 2) ORDER BY CUSTOMER_ID ASC"
474,Y,Y,"WITH CTE AS ( SELECT Z.CUSTOMER_ID FROM ( SELECT O.CUSTOMER_ID,COUNT(*)CC FROM ORDERS O GROUP BY O.CUSTOMER_ID )Z WHERE Z.CC<2 ), CTE1 AS ( SELECT O.CUSTOMER_ID FROM ORDERS O WHERE O.PRODUCT_NAME='C' ) SELECT DISTINCT C.CUSTOMER_ID,C.CUSTOMER_NAME FROM CUSTOMERS C WHERE C.CUSTOMER_ID NOT IN (SELECT *FROM CTE) AND C.CUSTOMER_ID NOT IN (SELECT *FROM CTE1) AND C.CUSTOMER_ID IN ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='A' ) AND C.CUSTOMER_ID IN ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='B' )"
475,Y,Y,"SELECT DISTINCT C.CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS C INNER JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE C.CUSTOMER_ID NOT IN( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') AND C.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A' ) AND C.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B' )"
476,Y,Y,"SELECT C.CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS C INNER JOIN (SELECT CUSTOMER_ID , GROUP_CONCAT(DISTINCT PRODUCT_NAME ORDER BY PRODUCT_NAME ASC SEPARATOR ',') AS PRODUCTS FROM ORDERS GROUP BY CUSTOMER_ID HAVING PRODUCTS NOT LIKE '%C%' AND PRODUCTS LIKE '%A,B%' ) O ON C.CUSTOMER_ID = O.CUSTOMER_ID"
477,Y,Y,"SELECT CUSTOMER_ID,CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM (SELECT CUSTOMER_ID, GROUP_CONCAT(DISTINCT PRODUCT_NAME ORDER BY PRODUCT_NAME) AS NAME FROM ORDERS GROUP BY CUSTOMER_ID) AS A WHERE NAME LIKE '%A%' AND NAME LIKE '%B%' AND NAME NOT LIKE '%C%') ORDER BY CUSTOMER_ID"
478,Y,Y,"SELECT O.CUSTOMER_ID AS CUSTOMER_ID, C.CUSTOMER_NAME FROM ( SELECT CUSTOMER_ID, SUM(PRODUCT_NAME='A') AS CA, SUM(PRODUCT_NAME = 'B') AS CB, SUM(PRODUCT_NAME = 'C') AS CC FROM ORDERS GROUP BY CUSTOMER_ID ) O LEFT JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID WHERE CA>0 AND CB>0 AND CC = 0 ORDER BY CUSTOMER_ID"
479,Y,Y,"SELECT O.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS O JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID GROUP BY 1 HAVING SUM(O.PRODUCT_NAME = 'A') > 0 AND SUM(O.PRODUCT_NAME = 'B') > 0 AND SUM(O.PRODUCT_NAME = 'C') = 0"
480,Y,Y,"SELECT O.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS O LEFT JOIN CUSTOMERS C ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE C.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND C.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND C.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') GROUP BY 1,2 ORDER BY CUSTOMER_ID"
481,Y,Y,"SELECT T.CUSTOMER_ID, C.CUSTOMER_NAME FROM (SELECT CUSTOMER_ID, SUM(DISTINCT PRODUCT_NAME = 'A') * SUM(DISTINCT PRODUCT_NAME = 'B')* (1-SUM(DISTINCT PRODUCT_NAME = 'C')) AS ISAB_NOTC FROM ORDERS GROUP BY CUSTOMER_ID) AS T, CUSTOMERS C WHERE T.CUSTOMER_ID = C.CUSTOMER_ID AND ISAB_NOTC = 1"
482,N,N,"SELECT DISTINCT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE (CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B')) &AMP; (CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A')) &AMP; (CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C'))"
483,Y,Y,"SELECT DISTINCT B.CUSTOMER_ID, B.CUSTOMER_NAME FROM ORDERS A JOIN CUSTOMERS B ON A.CUSTOMER_ID = B.CUSTOMER_ID WHERE A.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') AND A.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND A.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') ORDER BY 1"
484,Y,Y,"WITH DATA AS ( SELECT CUSTOMER_ID, COUNT(DISTINCT PRODUCT_NAME) AS CNT FROM ORDERS WHERE PRODUCT_NAME IN ('A','B') GROUP BY CUSTOMER_ID HAVING COUNT(DISTINCT PRODUCT_NAME) =2 ) SELECT DISTINCT A.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS A JOIN DATA B ON A.CUSTOMER_ID=B.CUSTOMER_ID JOIN CUSTOMERS C ON B.CUSTOMER_ID=C.CUSTOMER_ID WHERE A.CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='C') ORDER BY 1"
485,Y,Y,"SELECT C.CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE PRODUCT_NAME = 'A' AND C.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND C.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') GROUP BY 1,2"
486,Y,Y,"WITH PROD_SALES AS ( SELECT CUSTOMER_ID, COUNT(DISTINCT PRODUCT_NAME) AS DISTINCT_COUNT FROM ORDERS WHERE PRODUCT_NAME IN ('A','B') GROUP BY CUSTOMER_ID ), PROD_C AS ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C' ) SELECT DISTINCT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM PROD_SALES WHERE DISTINCT_COUNT = 2 ) AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM PROD_C)"
487,Y,Y,"SELECT DISTINCT O.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE C.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND C.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND C.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')"
488,Y,Y,"SELECT DISTINCT A.CUSTOMER_ID, A.CUSTOMER_NAME FROM CUSTOMERS AS A LEFT JOIN ( SELECT ORDER_ID, CUSTOMER_ID, PRODUCT_NAME FROM ORDERS ) B ON A.CUSTOMER_ID = B.CUSTOMER_ID GROUP BY 1,2 HAVING SUM(B.PRODUCT_NAME='A') >0 AND SUM(B.PRODUCT_NAME='B') > 0 AND SUM(B.PRODUCT_NAME='C')=0"
489,Y,Y,"SELECT DISTINCT U.CUSTOMER_ID, U.CUSTOMER_NAME FROM (SELECT C.CUSTOMER_ID , CUSTOMER_NAME FROM ORDERS O JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID WHERE PRODUCT_NAME = 'A')U JOIN (SELECT C.CUSTOMER_ID , CUSTOMER_NAME FROM ORDERS O JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID WHERE PRODUCT_NAME = 'B')T ON T.CUSTOMER_ID = U.CUSTOMER_ID WHERE U.CUSTOMER_ID NOT IN ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')"
490,Y,Y,"SELECT C.CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID GROUP BY C.CUSTOMER_ID HAVING SUM(PRODUCT_NAME = 'A') > 0 AND SUM(PRODUCT_NAME = 'B') > 0 AND SUM(PRODUCT_NAME = 'C') = 0 ORDER BY C.CUSTOMER_ID"
491,Y,Y,"WITH TEMP1 AS ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A'), TEMP2 AS ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B'), TEMP3 AS ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM TEMP1) AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM TEMP2) AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM TEMP3) ORDER BY CUSTOMER_ID"
492,Y,N,"WITH T1 AS ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B' AND CUSTOMER_ID IN ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') ), T2 AS ( SELECT DISTINCT T1.CUSTOMER_ID, PRODUCT_NAME FROM T1 JOIN ORDERS ON ORDERS.CUSTOMER_ID = T1.CUSTOMER_ID AND PRODUCT_NAME = 'C' ) SELECT T1.CUSTOMER_ID , CUSTOMER_NAME FROM T1 JOIN CUSTOMERS ON T1.CUSTOMER_ID = CUSTOMERS.CUSTOMER_ID WHERE T1.CUSTOMER_ID NOT IN ( SELECT CUSTOMER_ID FROM T2) ORDER BY T1.CUSTOMER_ID"
493,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C WHERE C.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='C') AND C.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='A') AND C.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='B')"
494,Y,Y,"SELECT DISTINCT O.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS AS O JOIN CUSTOMERS AS C ON O.CUSTOMER_ID = C.CUSTOMER_ID WHERE (O.CUSTOMER_ID, 'A') IN (SELECT DISTINCT CUSTOMER_ID, PRODUCT_NAME FROM ORDERS) AND (O.CUSTOMER_ID, 'B') IN (SELECT DISTINCT CUSTOMER_ID, PRODUCT_NAME FROM ORDERS) AND (O.CUSTOMER_ID, 'C') NOT IN (SELECT DISTINCT CUSTOMER_ID, PRODUCT_NAME FROM ORDERS)"
495,Y,N,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM (SELECT TEMP_1.CUSTOMER_ID, SUM(TEMP_1.ISAB) TOTAL_AB, SUM(TEMP_1.ISC) TOTAL_C FROM (SELECT ORDER_ID, CUSTOMER_ID, (CASE WHEN PRODUCT_NAME LIKE A OR PRODUCT_NAME LIKE B THEN 1 ELSE 0 END) ISAB, (CASE WHEN PRODUCT_NAME LIKE C THEN 1 ELSE 0 END) ISC FROM ORDERS) TEMP_1 GROUP BY CUSTOMER_ID HAVING TOTAL_AB >= 2 AND TOTAL_C = 0) TEMP_2 LEFT JOIN CUSTOMERS C ON TEMP_2.CUSTOMER_ID = C.CUSTOMER_ID ORDER BY C.CUSTOMER_ID"
496,Y,Y,"SELECT TMP.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS AS C JOIN ( SELECT TMP1.CUSTOMER_ID FROM (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AS TMP1 JOIN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AS TMP2 ON TMP1.CUSTOMER_ID = TMP2.CUSTOMER_ID ) AS TMP ON TMP.CUSTOMER_ID = C.CUSTOMER_ID WHERE TMP.CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')"
497,Y,Y,"WITH CTE1 AS( SELECT CUSTOMER_ID, GROUP_CONCAT(DISTINCT PRODUCT_NAME) AS CT FROM ORDERS GROUP BY 1), CTE2 AS ( SELECT CUSTOMER_ID FROM CTE1 WHERE CT NOT LIKE '%C%' AND CT LIKE '%A%' AND CT LIKE '%B%') SELECT C.CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS C JOIN CTE2 ON C.CUSTOMER_ID = CTE2.CUSTOMER_ID"
498,Y,Y,"SELECT DISTINCT A.CUSTOMER_ID, A.CUSTOMER_NAME FROM CUSTOMERS A INNER JOIN ORDERS B ON A.CUSTOMER_ID = B.CUSTOMER_ID AND B.PRODUCT_NAME = 'A' INNER JOIN ORDERS D ON A.CUSTOMER_ID = D.CUSTOMER_ID AND D.PRODUCT_NAME = 'B' LEFT OUTER JOIN ORDERS C ON A.CUSTOMER_ID = C.CUSTOMER_ID AND C.PRODUCT_NAME = 'C' WHERE C.CUSTOMER_ID IS NULL"
499,Y,Y,"WITH CTE AS (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C'), CTE2 AS( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME IN ('A','B') AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM CTE) GROUP BY 1 HAVING COUNT(DISTINCT PRODUCT_NAME) = 2) SELECT CUSTOMER_ID,CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM CTE2) ORDER BY 1"
500,Y,Y,SELECT * FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS O WHERE O.PRODUCT_NAME = 'A') AND CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS O WHERE O.PRODUCT_NAME = 'B') AND CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS O WHERE O.PRODUCT_NAME = 'C')
501,Y,Y,"WITH BOUGHTA AS (SELECT DISTINCT C.CUSTOMER_ID AS ID, C.CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE O.PRODUCT_NAME = 'A'), BOUGHTB AS (SELECT DISTINCT C.CUSTOMER_ID AS ID, C.CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE O.PRODUCT_NAME = 'B'), BOUGHTC AS (SELECT DISTINCT C.CUSTOMER_ID AS ID, C.CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE O.PRODUCT_NAME = 'C') SELECT DISTINCT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS C WHERE C.CUSTOMER_ID IN (SELECT BOUGHTA.ID FROM BOUGHTA) AND C.CUSTOMER_ID IN (SELECT BOUGHTB.ID FROM BOUGHTB) AND C.CUSTOMER_ID NOT IN (SELECT BOUGHTC.ID FROM BOUGHTC)"
502,Y,Y,"WITH CTE AS (SELECT O.CUSTOMER_ID, O.PRODUCT_NAME FROM ORDERS O WHERE O.PRODUCT_NAME = 'C') SELECT TEMP.CUSTOMER_ID, TEMP.CUSTOMER_NAME FROM (SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME, GROUP_CONCAT(IFNULL(O.PRODUCT_NAME, ')) CON FROM CUSTOMERS C LEFT JOIN CTE CT ON C.CUSTOMER_ID = CT.CUSTOMER_ID JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE CT.CUSTOMER_ID IS NULL GROUP BY C.CUSTOMER_ID) TEMP WHERE TEMP.CON LIKE '%A%B%' OR TEMP.CON LIKE '%B%A%'"
503,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID GROUP BY C.CUSTOMER_ID HAVING SUM(O.PRODUCT_NAME = 'C') = 0 AND SUM(O.PRODUCT_NAME = 'A') > 0 AND SUM(O.PRODUCT_NAME = 'B') > 0"
504,Y,Y,"WITH TEMP AS (SELECT CUSTOMER_ID FROM ORDERS WHERE CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') ) SELECT DISTINCT CUSTOMERS.CUSTOMER_ID ,CUSTOMER_NAME FROM (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') A JOIN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') B ON A.CUSTOMER_ID = B.CUSTOMER_ID JOIN TEMP ON B.CUSTOMER_ID = TEMP.CUSTOMER_ID JOIN CUSTOMERS ON TEMP.CUSTOMER_ID =CUSTOMERS.CUSTOMER_ID ORDER BY 1"
505,Y,N,"SELECT C.CUSTOMER_ID, CUSTOMER_NAME FROM( SELECT CUSTOMER_ID, SUM(CASE WHEN PRODUCT_NAME = 'A' OR PRODUCT_NAME = 'B' THEN 1 WHEN PRODUCT_NAME = 'C' THEN -100 ELSE 0 END) AS SCORE FROM ORDERS GROUP BY 1 ) A LEFT JOIN CUSTOMERS C ON A.CUSTOMER_ID = C.CUSTOMER_ID WHERE SCORE >= 2"
506,Y,Y,"SELECT DISTINCT A.CUSTOMER_ID, A.CUSTOMER_NAME FROM CUSTOMERS A INNER JOIN ORDERS B ON A.CUSTOMER_ID=B.CUSTOMER_ID WHERE A.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='A') AND A.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='B') AND A.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='C' )"
507,Y,Y,"WITH CTE AS( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C' ), CTE1 AS( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A' AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B')) SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM CTE1) AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM CTE)"
508,Y,Y,"SELECT DISTINCT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C INNER JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE C.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND C.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND C.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')"
509,Y,Y,"SELECT DISTINCT O.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS AS O LEFT JOIN CUSTOMERS AS C ON O.CUSTOMER_ID = C.CUSTOMER_ID WHERE (O.CUSTOMER_ID, 'A') IN (SELECT CUSTOMER_ID, PRODUCT_NAME FROM ORDERS) AND (O.CUSTOMER_ID, 'B') IN (SELECT CUSTOMER_ID, PRODUCT_NAME FROM ORDERS) AND (O.CUSTOMER_ID, 'C') NOT IN (SELECT CUSTOMER_ID, PRODUCT_NAME FROM ORDERS)"
510,Y,Y,"WITH B AS (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='A' GROUP BY CUSTOMER_ID), D AS (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='B' GROUP BY CUSTOMER_ID) SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C JOIN (SELECT B.CUSTOMER_ID FROM B JOIN D ON B.CUSTOMER_ID=D.CUSTOMER_ID) E ON C.CUSTOMER_ID=E.CUSTOMER_ID WHERE C.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='C')"
511,Y,Y,"SELECT DISTINCT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID=O.CUSTOMER_ID WHERE O.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='C') AND O.CUSTOMER_ID IN(SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='A') AND O.CUSTOMER_ID IN(SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='B') ORDER BY C.CUSTOMER_ID"
512,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID GROUP BY C.CUSTOMER_ID HAVING SUM(O.PRODUCT_NAME='A')>0 AND SUM(O.PRODUCT_NAME='B')>0 AND SUM(O.PRODUCT_NAME='C')=0 ORDER BY C.CUSTOMER_ID"
513,Y,Y,"SELECT DISTINCT A.CUSTOMER_ID, D.CUSTOMER_NAME FROM (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') A JOIN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') B ON A.CUSTOMER_ID = B.CUSTOMER_ID LEFT JOIN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') C ON A.CUSTOMER_ID = C.CUSTOMER_ID JOIN CUSTOMERS D ON A.CUSTOMER_ID = D.CUSTOMER_ID WHERE C.CUSTOMER_ID IS NULL ORDER BY CUSTOMER_ID"
514,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS AS C JOIN ORDERS AS O ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE O.PRODUCT_NAME = 'A' OR O.PRODUCT_NAME = 'B' AND O.CUSTOMER_ID NOT IN (SELECT DISTINCT(CUSTOMER_ID) FROM ORDERS WHERE PRODUCT_NAME = 'C') GROUP BY CUSTOMER_ID HAVING COUNT(DISTINCT O.PRODUCT_NAME) = 2"
515,Y,Y,"SELECT O.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS O LEFT JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID GROUP BY O.CUSTOMER_ID HAVING SUM(PRODUCT_NAME = 'A') >= 1 AND SUM(PRODUCT_NAME = 'B') >= 1 AND SUM(PRODUCT_NAME = 'C') = 0"
516,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID= O.CUSTOMER_ID GROUP BY C.CUSTOMER_ID HAVING SUM(O.PRODUCT_NAME='A')>0 AND SUM(O.PRODUCT_NAME='B')>0 AND SUM(O.PRODUCT_NAME='C')=0"
517,Y,Y,"SELECT DISTINCT O1.CUSTOMER_ID ,CUSTOMER_NAME FROM ORDERS O1 JOIN CUSTOMERS C USING(CUSTOMER_ID) JOIN ORDERS O2 ON O1.CUSTOMER_ID = O2.CUSTOMER_ID AND O1.PRODUCT_NAME = 'A' AND O2.PRODUCT_NAME = 'B' WHERE O1.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')"
518,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID GROUP BY C.CUSTOMER_ID HAVING SUM(PRODUCT_NAME = 'A') > 0 AND SUM(PRODUCT_NAME = 'B') > 0 AND SUM(PRODUCT_NAME = 'C') = 0"
519,Y,Y,"WITH TABLE_A AS ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='A'), TABLE_B AS ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='B' ), TABLE_C AS ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='C' ) SELECT DISTINCT C.CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID=O.CUSTOMER_ID WHERE C.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM TABLE_A) AND C.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM TABLE_B) AND C.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM TABLE_C) ORDER BY C.CUSTOMER_ID"
520,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS LEFT JOIN ORDERS USING(CUSTOMER_ID) GROUP BY 1 HAVING SUM(PRODUCT_NAME='A')>0 AND SUM(PRODUCT_NAME='B')>0 AND SUM(PRODUCT_NAME='C')=0 ORDER BY 1"
521,Y,Y,"SELECT DISTINCT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS O1 JOIN ORDERS O2 ON O1.CUSTOMER_ID = O2.CUSTOMER_ID JOIN CUSTOMERS C ON O1.CUSTOMER_ID = C.CUSTOMER_ID WHERE O1.PRODUCT_NAME = 'A' AND O2.PRODUCT_NAME = 'B' AND O1.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')"
522,Y,Y,"SELECT DISTINCT O.CUSTOMER_ID,C.CUSTOMER_NAME FROM ORDERS O JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID WHERE PRODUCT_NAME = 'A' AND O.CUSTOMER_ID IN ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND O.CUSTOMER_ID NOT IN ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')"
523,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='A') AND CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='B') AND CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME IN ('C') ) ORDER BY CUSTOMER_ID"
524,Y,Y,"SELECT A.CUSTOMER_ID, A.CUSTOMER_NAME FROM CUSTOMERS A LEFT JOIN ORDERS B ON A.CUSTOMER_ID=B.CUSTOMER_ID GROUP BY A.CUSTOMER_ID HAVING SUM(B.PRODUCT_NAME ='A') > 0 AND SUM(B.PRODUCT_NAME ='B') > 0 AND SUM(B.PRODUCT_NAME ='C') = 0"
525,Y,Y,"SELECT DISTINCT A.CUSTOMER_ID, A.CUSTOMER_NAME FROM (SELECT O.CUSTOMER_ID CUSTOMER_ID, CUSTOMER_NAME FROM ORDERS O LEFT JOIN CUSTOMERS C ON O.CUSTOMER_ID=C.CUSTOMER_ID WHERE PRODUCT_NAME IN ('A'))A JOIN (SELECT O.CUSTOMER_ID CUSTOMER_ID, CUSTOMER_NAME FROM ORDERS O LEFT JOIN CUSTOMERS C ON O.CUSTOMER_ID=C.CUSTOMER_ID WHERE PRODUCT_NAME IN ('B'))B ON A.CUSTOMER_ID=B.CUSTOMER_ID WHERE A.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME IN ('C'))"
526,Y,Y,"SELECT SUMMARY.CUSTOMER_ID, CUSTOMERS.CUSTOMER_NAME FROM ( SELECT CUSTOMER_ID, SUM(CASE WHEN PRODUCT_NAME = 'A' THEN 1 ELSE 0 END) AS A, SUM(CASE WHEN PRODUCT_NAME = 'B' THEN 1 ELSE 0 END) AS B, SUM(CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END) AS C FROM ORDERS GROUP BY CUSTOMER_ID ) SUMMARY JOIN CUSTOMERS ON SUMMARY.CUSTOMER_ID = CUSTOMERS.CUSTOMER_ID WHERE A > 0 AND B > 0 AND C = 0"
527,Y,Y,"WITH T1 AS ( SELECT C.CUSTOMER_ID FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE PRODUCT_NAME = 'C' ), T2 AS ( SELECT C.CUSTOMER_ID FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE PRODUCT_NAME = 'A' ), T3 AS ( SELECT C.CUSTOMER_ID FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE PRODUCT_NAME = 'B' ) SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID NOT IN (SELECT T1.CUSTOMER_ID FROM T1) AND CUSTOMER_ID IN (SELECT DISTINCT T2.CUSTOMER_ID FROM T2) AND CUSTOMER_ID IN (SELECT DISTINCT T3.CUSTOMER_ID FROM T3)"
528,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A' AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B')) AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') ORDER BY CUSTOMER_ID"
529,Y,Y,"WITH ABNOTC AS (SELECT CUSTOMER_ID, SUM(CASE WHEN PRODUCT_NAME='A' THEN 1 ELSE 0 END) AS PA, SUM(CASE WHEN PRODUCT_NAME='B' THEN 1 ELSE 0 END) AS PB, SUM(CASE WHEN PRODUCT_NAME='C' THEN 1 ELSE 0 END) AS PC FROM ORDERS GROUP BY CUSTOMER_ID) SELECT DISTINCT C.* FROM CUSTOMERS AS C JOIN ABNOTC AS O ON C.CUSTOMER_ID=O.CUSTOMER_ID WHERE PA>0 AND PB>0 AND PC=0 ORDER BY C.CUSTOMER_ID"
530,Y,Y,SELECT DISTINCT A.* FROM CUSTOMERS A JOIN ORDERS B ON A.CUSTOMER_ID = B.CUSTOMER_ID WHERE A.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='A') AND A.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='B') AND A.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='C')
531,Y,Y,"SELECT DISTINCT CUSTOMER_ID,CUSTOMER_NAME FROM ( SELECT A.CUSTOMER_ID,CUSTOMER_NAME,COUNT(DISTINCT(PRODUCT_NAME)) CNT FROM ORDERS A INNER JOIN CUSTOMERS B ON A.CUSTOMER_ID = B.CUSTOMER_ID WHERE PRODUCT_NAME IN ('A','B') AND A.CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME IN ('C')) GROUP BY CUSTOMER_ID,CUSTOMER_NAME HAVING COUNT(DISTINCT(PRODUCT_NAME)) >= 2)T"
532,Y,Y,"SELECT DISTINCT O.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS O, CUSTOMERS C WHERE C.CUSTOMER_ID=O.CUSTOMER_ID AND O.CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND O.CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND O.CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') ORDER BY O.CUSTOMER_ID"
533,Y,Y,SELECT B.* FROM ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') ) A LEFT JOIN CUSTOMERS B ON A.CUSTOMER_ID = B.CUSTOMER_ID
534,Y,Y,"WITH T1 AS( SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME, GROUP_CONCAT(PRODUCT_NAME ORDER BY PRODUCT_NAME) PRODUCTS FROM CUSTOMERS C INNER JOIN ORDERS O ON O.CUSTOMER_ID = C.CUSTOMER_ID GROUP BY 1, 2) SELECT CUSTOMER_ID, CUSTOMER_NAME FROM T1 WHERE PRODUCTS LIKE '%A%' AND PRODUCTS LIKE '%B%' AND PRODUCTS NOT LIKE '%C%'"
535,Y,Y,"WITH TEMP AS (SELECT CUSTOMER_ID, SUM(IF(PRODUCT_NAME = 'A',1,0)) AS COUNT_A, SUM(IF(PRODUCT_NAME = 'B',1,0)) AS COUNT_B, SUM(IF(PRODUCT_NAME = 'C',1,0)) AS COUNT_C FROM ORDERS GROUP BY 1) SELECT C.CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS C JOIN TEMP T ON C.CUSTOMER_ID = T.CUSTOMER_ID WHERE COUNT_A > 0 AND COUNT_B > 0 AND COUNT_C = 0 ORDER BY 1"
536,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS C WHERE EXISTS (SELECT * FROM ORDERS S WHERE S.CUSTOMER_ID = C.CUSTOMER_ID AND PRODUCT_NAME = 'A') AND EXISTS (SELECT * FROM ORDERS S WHERE S.CUSTOMER_ID = C.CUSTOMER_ID AND PRODUCT_NAME = 'B') AND NOT EXISTS (SELECT * FROM ORDERS S WHERE S.CUSTOMER_ID = C.CUSTOMER_ID AND PRODUCT_NAME = 'C') ORDER BY C.CUSTOMER_ID"
537,Y,Y,"WITH BOUGHT_A AS ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A'), BOUGHT_B AS ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B'), DID_NOT_BUY_C AS ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE CUSTOMER_ID NOT IN ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')), CUSTOMER_FILTERED AS ( SELECT A.CUSTOMER_ID FROM (BOUGHT_A A INNER JOIN BOUGHT_B B ON A.CUSTOMER_ID = B.CUSTOMER_ID) INNER JOIN DID_NOT_BUY_C C ON B.CUSTOMER_ID = C.CUSTOMER_ID) SELECT CF.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMER_FILTERED CF INNER JOIN CUSTOMERS C ON CF.CUSTOMER_ID = C.CUSTOMER_ID"
538,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C LEFT JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE C.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND C.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND C.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') GROUP BY 1"
539,Y,Y,"WITH CTE AS (SELECT CUSTOMER_ID, SUM(CASE WHEN PRODUCT_NAME = 'A' THEN 1 ELSE 0 END) AS CNTA , SUM(CASE WHEN PRODUCT_NAME = 'B' THEN 1 ELSE 0 END) AS CNTB , SUM(CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END) AS CNTC FROM ORDERS GROUP BY CUSTOMER_ID ) SELECT C.CUSTOMER_ID,C.CUSTOMER_NAME FROM CUSTOMERS C INNER JOIN CTE ON C.CUSTOMER_ID = CTE.CUSTOMER_ID WHERE CTE.CNTA>0 AND CTE.CNTB > 0 AND CTE.CNTC=0"
540,Y,Y,SELECT C.* FROM CUSTOMERS C LEFT JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID GROUP BY O.CUSTOMER_ID HAVING SUM(O.PRODUCT_NAME='A')>0 AND SUM(O.PRODUCT_NAME='B')>0 AND SUM(O.PRODUCT_NAME='C')=0
541,Y,Y,"SELECT DISTINCT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID AND O.PRODUCT_NAME = 'A' JOIN ORDERS O2 ON C.CUSTOMER_ID = O2.CUSTOMER_ID AND O2.PRODUCT_NAME = 'B' LEFT JOIN ORDERS O3 ON C.CUSTOMER_ID = O3.CUSTOMER_ID AND O3.PRODUCT_NAME = 'C' WHERE O3.CUSTOMER_ID IS NULL"
542,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O ON (C.CUSTOMER_ID = O.CUSTOMER_ID) GROUP BY C.CUSTOMER_ID HAVING SUM(CASE WHEN PRODUCT_NAME = 'A' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN PRODUCT_NAME = 'B' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END) = 0"
543,Y,Y,"SELECT CUSTOMERS.CUSTOMER_ID AS CUSTOMER_ID, CUSTOMER_NAME FROM (SELECT CUSTOMER_ID, SUM(IF(PRODUCT_NAME='A',1,0)) AS A, SUM(IF(PRODUCT_NAME='B',1,0)) AS B, SUM(IF(PRODUCT_NAME='C',1,0)) AS C FROM ORDERS GROUP BY CUSTOMER_ID) INTER JOIN CUSTOMERS ON CUSTOMERS.CUSTOMER_ID=INTER.CUSTOMER_ID WHERE A>0 AND B>0 AND C=0"
544,Y,Y,"WITH PRODUCTS AS ( SELECT O.CUSTOMER_ID ,C.CUSTOMER_NAME ,GROUP_CONCAT(O.PRODUCT_NAME) AS PRODUCTS FROM ORDERS O JOIN CUSTOMERS C ON C.CUSTOMER_ID = O.CUSTOMER_ID GROUP BY 1,2 ) SELECT DISTINCT CUSTOMER_ID ,CUSTOMER_NAME FROM PRODUCTS WHERE PRODUCTS LIKE '%A%' AND PRODUCTS LIKE '%B%' AND PRODUCTS NOT LIKE '%C%' ORDER BY 1"
545,Y,Y,"WITH ORDERS_BY_CUSTOMER AS ( SELECT A.CUSTOMER_ID, A.CUSTOMER_NAME, SUM(CASE WHEN PRODUCT_NAME = 'A' THEN 1 ELSE 0 END) AS PURCHASES_A, SUM(CASE WHEN PRODUCT_NAME = 'B' THEN 1 ELSE 0 END) AS PURCHASES_B, SUM(CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END) AS PURCHASES_C FROM CUSTOMERS A LEFT JOIN ORDERS B ON A.CUSTOMER_ID = B.CUSTOMER_ID GROUP BY 1,2 ) SELECT CUSTOMER_ID, CUSTOMER_NAME FROM ORDERS_BY_CUSTOMER WHERE PURCHASES_A > 0 AND PURCHASES_B > 0 AND PURCHASES_C = 0 ORDER BY 1"
546,Y,Y,"SELECT DISTINCT T1.CUSTOMER_ID, T1.CUSTOMER_NAME FROM CUSTOMERS T1 JOIN ORDERS T2 ON T1.CUSTOMER_ID = T2.CUSTOMER_ID WHERE T2.PRODUCT_NAME = 'A' AND T1.CUSTOMER_ID IN (SELECT T1.CUSTOMER_ID FROM CUSTOMERS T1 JOIN ORDERS T2 ON T1.CUSTOMER_ID = T2.CUSTOMER_ID WHERE T2.PRODUCT_NAME = 'B') AND T1.CUSTOMER_ID NOT IN (SELECT T1.CUSTOMER_ID FROM CUSTOMERS T1 JOIN ORDERS T2 ON T1.CUSTOMER_ID = T2.CUSTOMER_ID WHERE T2.PRODUCT_NAME = 'C')"
547,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C WHERE EXISTS (SELECT * FROM ORDERS O WHERE C.CUSTOMER_ID = O.CUSTOMER_ID AND PRODUCT_NAME = 'A') AND EXISTS (SELECT * FROM ORDERS O WHERE C.CUSTOMER_ID = O.CUSTOMER_ID AND PRODUCT_NAME = 'B') AND NOT EXISTS (SELECT * FROM ORDERS O WHERE C.CUSTOMER_ID = O.CUSTOMER_ID AND PRODUCT_NAME = 'C')"
548,Y,Y,"SELECT ORDERS.CUSTOMER_ID, CUSTOMERS.CUSTOMER_NAME FROM ORDERS LEFT JOIN CUSTOMERS ON ORDERS.CUSTOMER_ID = CUSTOMERS.CUSTOMER_ID GROUP BY CUSTOMER_ID, CUSTOMER_NAME HAVING SUM(CASE WHEN PRODUCT_NAME = 'A' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN PRODUCT_NAME = 'B' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END) = 0"
549,Y,Y,"SELECT C.CUSTOMER_ID,C.CUSTOMER_NAME FROM CUSTOMERS C WHERE C.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME IN ('C')) AND C.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME IN ('B') AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME IN ('A')))"
550,Y,N,"SELECT DISTINCT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O ON O.CUSTOMER_ID = C.CUSTOMER_ID WHERE C.CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME IN ('A','B') GROUP BY CUSTOMER_ID HAVING COUNT(*)>1) AND C.CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')"
551,Y,Y,"SELECT DISTINCT(CUSTOMER_ID), CUSTOMER_NAME FROM CUSTOMERS LEFT JOIN ORDERS USING (CUSTOMER_ID) WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='A') AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='B') AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='C')"
552,Y,Y,"WITH T AS ( SELECT C.*,O.PRODUCT_NAME FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID=O.CUSTOMER_ID ), PA AS (SELECT DISTINCT C.CUSTOMER_ID FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID=O.CUSTOMER_ID AND O.PRODUCT_NAME ='A'), PB AS (SELECT DISTINCT C.CUSTOMER_ID FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID=O.CUSTOMER_ID AND O.PRODUCT_NAME ='B'), PC AS (SELECT DISTINCT C.CUSTOMER_ID FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID=O.CUSTOMER_ID AND O.PRODUCT_NAME ='C') SELECT DISTINCT T.CUSTOMER_ID,T.CUSTOMER_NAME FROM T JOIN PA ON T.CUSTOMER_ID = PA.CUSTOMER_ID JOIN PB ON T.CUSTOMER_ID = PB.CUSTOMER_ID WHERE T.CUSTOMER_ID NOT IN (SELECT PC.CUSTOMER_ID FROM PC)"
553,Y,Y,SELECT * FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT DISTINCT(CUSTOMER_ID) AS CID FROM ORDERS WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C'))
554,Y,Y,"WITH NOT_BOUGHT_C AS (SELECT CUSTOMER_ID, MAX(CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END) AS BOUGHT_C_IND, MAX(CASE WHEN PRODUCT_NAME = 'A' THEN 1 ELSE 0 END) AS BOUGHT_A_IND, MAX(CASE WHEN PRODUCT_NAME = 'B' THEN 1 ELSE 0 END) AS BOUGHT_B_IND FROM ORDERS GROUP BY 1 HAVING BOUGHT_C_IND = 0 AND BOUGHT_A_IND = 1 AND BOUGHT_B_IND = 1) SELECT CUSTOMER_ID,CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM NOT_BOUGHT_C) ORDER BY 1"
555,Y,Y,"SELECT CUSTOMER_ID,CUSTOMER_NAME FROM CUSTOMERS C WHERE C.CUSTOMER_ID IN (SELECT DISTINCT CUSTOMER_ID FROM (SELECT CUSTOMER_ID,PRODUCT_NAME FROM ORDERS GROUP BY CUSTOMER_ID HAVING SUM(PRODUCT_NAME='A') >0 AND SUM(PRODUCT_NAME='B') > 0 AND SUM(PRODUCT_NAME='C')=0)O)"
556,Y,Y,"SELECT DISTINCT C.CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS C WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')"
557,Y,Y,"WITH PRODUCT_A AS( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='A' ) ,PRODUCT_B AS( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='B' ) ,PRODUCT_C AS( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='C' ) SELECT * FROM CUSTOMERS C WHERE CUSTOMER_ID IN (SELECT * FROM PRODUCT_A) AND CUSTOMER_ID IN (SELECT * FROM PRODUCT_B) AND CUSTOMER_ID NOT IN (SELECT * FROM PRODUCT_C)"
558,Y,Y,"SELECT CUSTOMER_ID,CUSTOMER_NAME FROM CUSTOMERS CC WHERE CC.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='C') AND CC.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='A') AND CC.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='B')"
559,Y,N,"SELECT O.CUSTOMER_ID,CUSTOMER_NAME FROM ORDERS O JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID WHERE PRODUCT_NAME='B' AND O.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='A') AND O.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='C')"
560,Y,Y,"SELECT DISTINCT CUSTOMER_ID,CUSTOMER_NAME FROM CUSTOMERS NATURAL JOIN ORDERS WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='A') AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='B') AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='C')"
561,Y,Y,"SELECT DISTINCT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS AS C LEFT JOIN ORDERS AS O ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE (O.CUSTOMER_ID, 'A') IN (SELECT CUSTOMER_ID, PRODUCT_NAME FROM ORDERS) AND (O.CUSTOMER_ID, 'B') IN (SELECT CUSTOMER_ID, PRODUCT_NAME FROM ORDERS) AND (O.CUSTOMER_ID, 'C') NOT IN (SELECT CUSTOMER_ID, PRODUCT_NAME FROM ORDERS)"
562,Y,Y,SELECT * FROM CUSTOMERS WHERE CUSTOMER_ID IN( SELECT CUSTOMER_ID FROM ORDERS GROUP BY CUSTOMER_ID HAVING SUM(PRODUCT_NAME='A')>0 AND SUM(PRODUCT_NAME='B')>0 AND SUM(PRODUCT_NAME='C')=0)
563,Y,Y,SELECT * FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS GROUP BY CUSTOMER_ID HAVING SUM(PRODUCT_NAME = 'C') = 0 AND SUM(PRODUCT_NAME='A')>0 AND SUM(PRODUCT_NAME='B')>0)
564,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C RIGHT JOIN( SELECT CUSTOMER_ID, SUM(CASE WHEN PRODUCT_NAME = 'A' THEN 1 ELSE 0 END) AS A, SUM(CASE WHEN PRODUCT_NAME = 'B' THEN 1 ELSE 0 END) AS B, SUM(CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END) AS C FROM ORDERS GROUP BY CUSTOMER_ID) TEMP ON C.CUSTOMER_ID = TEMP.CUSTOMER_ID WHERE A >0 AND B > 0 AND C = 0"
565,Y,Y,"SELECT O.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS AS O LEFT JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID GROUP BY CUSTOMER_ID HAVING SUM(PRODUCT_NAME = 'A') > 0 AND SUM(PRODUCT_NAME = 'B') > 0 AND SUM(PRODUCT_NAME = 'C') = 0"
566,Y,Y,"WITH TEMP AS ( SELECT CUSTOMER_ID, COUNT(DISTINCT PRODUCT_NAME) AS NUM FROM ORDERS WHERE PRODUCT_NAME IN( 'A','B') GROUP BY CUSTOMER_ID HAVING NUM=2 ) SELECT DISTINCT A.CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS A INNER JOIN TEMP B ON A.CUSTOMER_ID=B.CUSTOMER_ID WHERE A.CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='C')"
567,Y,Y,"SELECT A.CUSTOMER_ID , A.CUSTOMER_NAME FROM CUSTOMERS A JOIN ORDERS B ON A.CUSTOMER_ID = B.CUSTOMER_ID GROUP BY 1,2 HAVING SUM(B.PRODUCT_NAME = 'A') > 0 AND SUM(B.PRODUCT_NAME = 'B') > 0 AND SUM(B.PRODUCT_NAME = 'C') = 0"
568,Y,Y,"WITH AB_C AS ( SELECT DISTINCT CUSTOMER_ID, PRODUCT_NAME FROM ORDERS WHERE PRODUCT_NAME IN ('A', 'B') AND CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='C') ) SELECT DISTINCT AB1.CUSTOMER_ID, C.CUSTOMER_NAME FROM AB_C AS AB1, AB_C AS AB2, CUSTOMERS AS C WHERE AB1.CUSTOMER_ID = AB2.CUSTOMER_ID AND AB1.CUSTOMER_ID = C.CUSTOMER_ID AND AB1.PRODUCT_NAME = 'A' AND AB2.PRODUCT_NAME = 'B'"
569,Y,Y,"SELECT O.CUSTOMER_ID ,CUSTOMER_NAME FROM ORDERS O LEFT JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID GROUP BY O.CUSTOMER_ID HAVING SUM(CASE WHEN PRODUCT_NAME = 'A' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN PRODUCT_NAME = 'B' THEN 1 ELSE 0 END)>0 AND SUM(CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END)=0 ORDER BY O.CUSTOMER_ID"
570,Y,Y,"WITH A AS( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A' ), B AS ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B' ), C AS ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C' ) SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM A) AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM B) AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM C)"
571,Y,N,"WITH GET_ORDERS AS ( SELECT CUSTOMER_ID, COUNT(DISTINCT CASE WHEN PRODUCT_NAME = 'A' THEN PRODUCT_NAME WHEN PRODUCT_NAME = 'B' THEN PRODUCT_NAME ELSE NULL END ) AS C1, SUM(CASE WHEN PRODUCT_NAME = 'A' THEN 1 WHEN PRODUCT_NAME = 'B' THEN 1 WHEN PRODUCT_NAME = 'C' THEN -2 ELSE 0 END) AS S1 FROM ORDERS GROUP BY CUSTOMER_ID ) SELECT A.CUSTOMER_ID, B.CUSTOMER_NAME FROM GET_ORDERS A LEFT JOIN CUSTOMERS B ON A.CUSTOMER_ID = B.CUSTOMER_ID WHERE S1 >=2 AND C1 >=2"
572,Y,Y,"SELECT DISTINCT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C LEFT JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE C.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') AND C.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND C.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B')"
573,Y,Y,"WITH B AS (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='A'), D AS (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='B') SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C JOIN (SELECT B.CUSTOMER_ID FROM B JOIN D ON B.CUSTOMER_ID=D.CUSTOMER_ID) E ON C.CUSTOMER_ID=E.CUSTOMER_ID WHERE C.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='C')"
574,Y,Y,"SELECT DISTINCT C.CUSTOMER_ID,C.CUSTOMER_NAME FROM ORDERS O, CUSTOMERS C,ORDERS B WHERE O.PRODUCT_NAME ='A' AND O.CUSTOMER_ID=C.CUSTOMER_ID AND C.CUSTOMER_ID=B.CUSTOMER_ID AND B.PRODUCT_NAME='B' AND NOT EXISTS ( SELECT 1 FROM ORDERS INR WHERE INR.PRODUCT_NAME='C' AND INR.CUSTOMER_ID=C.CUSTOMER_ID) ORDER BY C.CUSTOMER_ID"
575,Y,Y,"WITH TMP1 AS (SELECT CUSTOMER_ID, GROUP_CONCAT(DISTINCT PRODUCT_NAME) AS GRP FROM ORDERS GROUP BY CUSTOMER_ID), TMP2 AS (SELECT * FROM TMP1 WHERE GRP LIKE '%A%' AND GRP LIKE '%B%' AND GRP NOT LIKE '%C%') SELECT CUSTOMER_ID,CUSTOMER_NAME FROM TMP2 INNER JOIN CUSTOMERS USING (CUSTOMER_ID)"
576,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS GROUP BY CUSTOMER_ID HAVING SUM(PRODUCT_NAME='A')>0 AND SUM(PRODUCT_NAME='B')>0 AND SUM(PRODUCT_NAME='C')=0) ORDER BY CUSTOMER_ID"
577,Y,Y,"SELECT T.CUSTOMER_ID, C.CUSTOMER_NAME FROM ( SELECT CUSTOMER_ID, SUM( CASE WHEN PRODUCT_NAME = 'A' THEN 1 WHEN PRODUCT_NAME = 'B' THEN 2 WHEN PRODUCT_NAME = 'C' THEN 4 ELSE 0 END ) AS MASK FROM (SELECT DISTINCT CUSTOMER_ID, PRODUCT_NAME FROM ORDERS) AS A GROUP BY CUSTOMER_ID ) AS T JOIN CUSTOMERS C ON T.CUSTOMER_ID = C.CUSTOMER_ID AND T.MASK = 3"
578,Y,Y,"WITH PROD_BUY AS ( SELECT CUSTOMER_ID, SUM(CASE WHEN PRODUCT_NAME = 'A' THEN 1 ELSE 0 END) AS BOUGHT_A, SUM(CASE WHEN PRODUCT_NAME = 'B' THEN 1 ELSE 0 END) AS BOUGHT_B, SUM(CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END) AS BOUGHT_C FROM ORDERS GROUP BY 1 ) SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN ( SELECT CUSTOMER_ID FROM PROD_BUY WHERE BOUGHT_A > 0 AND BOUGHT_B > 0 AND BOUGHT_C = 0 )"
579,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C INNER JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID GROUP BY O.CUSTOMER_ID HAVING SUM(O.PRODUCT_NAME = 'A') > 0 AND SUM(O.PRODUCT_NAME = 'B') > 0 AND SUM(O.PRODUCT_NAME = 'C') = 0"
580,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN ( SELECT DISTINCT T1.CUSTOMER_ID FROM (SELECT CUSTOMER_ID FROM ORDERS O WHERE PRODUCT_NAME = 'A') T1, (SELECT CUSTOMER_ID FROM ORDERS O WHERE PRODUCT_NAME = 'B') T2 WHERE T1.CUSTOMER_ID = T2.CUSTOMER_ID AND T1.CUSTOMER_ID NOT IN ( SELECT CUSTOMER_ID FROM ORDERS O WHERE PRODUCT_NAME = 'C') )"
581,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM ( SELECT CUSTOMER_ID, CUSTOMER_NAME, COUNT(DISTINCT PRODUCT_NAME) AS CNT FROM ORDERS JOIN CUSTOMERS USING (CUSTOMER_ID) WHERE PRODUCT_NAME IN ('A', 'B') GROUP BY CUSTOMER_ID, CUSTOMER_NAME HAVING CNT > 1 ) T WHERE T.CUSTOMER_ID NOT IN (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')"
582,Y,Y,"SELECT A.CUSTOMER_ID, A.CUSTOMER_NAME FROM CUSTOMERS A JOIN ORDERS B ON A.CUSTOMER_ID = B.CUSTOMER_ID GROUP BY A.CUSTOMER_ID HAVING SUM(B.PRODUCT_NAME = 'A') > 0 AND SUM(B.PRODUCT_NAME = 'B') > 0 AND SUM(B.PRODUCT_NAME = 'C') = 0 ORDER BY A.CUSTOMER_ID ASC"
583,Y,Y,"SELECT CUSTOMERS.CUSTOMER_ID,CUSTOMERS.CUSTOMER_NAME FROM (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')) A INNER JOIN CUSTOMERS ON A.CUSTOMER_ID = CUSTOMERS.CUSTOMER_ID"
584,Y,Y,"WITH CUST AS ( SELECT CUSTOMER_ID, COUNT(DISTINCT(PRODUCT_NAME)) AS NUM_PROD FROM ORDERS WHERE PRODUCT_NAME = 'A' OR PRODUCT_NAME = 'B' GROUP BY 1 HAVING NUM_PROD = 2 ) SELECT A.CUSTOMER_ID, CUSTOMER_NAME FROM CUST AS A JOIN CUSTOMERS AS B ON A.CUSTOMER_ID = B.CUSTOMER_ID WHERE A.CUSTOMER_ID NOT IN (SELECT DISTINCT(CUSTOMER_ID) FROM ORDERS WHERE PRODUCT_NAME = 'C' )"
585,Y,Y,"WITH CTEC AS (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C'), CTEB AS (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') SELECT T.CUSTOMER_ID, C.CUSTOMER_NAME FROM (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE (PRODUCT_NAME = 'A') AND CUSTOMER_ID IN (SELECT * FROM CTEB) AND CUSTOMER_ID NOT IN (SELECT * FROM CTEC))T LEFT JOIN CUSTOMERS C ON T.CUSTOMER_ID = C.CUSTOMER_ID"
586,Y,Y,"SELECT A.CUSTOMER_ID, A.CUSTOMER_NAME FROM CUSTOMERS A, ORDERS B WHERE A.CUSTOMER_ID=B.CUSTOMER_ID AND A.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='A') AND A.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='B') AND A.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='C') GROUP BY A.CUSTOMER_ID"
587,Y,Y,"SELECT DISTINCT C.CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS C LEFT JOIN ORDERS O1 ON O1.CUSTOMER_ID = C.CUSTOMER_ID AND O1.PRODUCT_NAME = 'C' LEFT JOIN ORDERS O2 ON O2.CUSTOMER_ID = C.CUSTOMER_ID AND O2.PRODUCT_NAME = 'A' LEFT JOIN ORDERS O3 ON O3.CUSTOMER_ID = C.CUSTOMER_ID AND O3.PRODUCT_NAME = 'B' WHERE O1.CUSTOMER_ID IS NULL AND O2.CUSTOMER_ID IS NOT NULL AND O3.CUSTOMER_ID IS NOT NULL"
588,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT C.CUSTOMER_ID FROM CUSTOMERS C, ORDERS O WHERE C.CUSTOMER_ID = O.CUSTOMER_ID AND O.PRODUCT_NAME ='A' ) AND CUSTOMER_ID IN (SELECT C.CUSTOMER_ID FROM CUSTOMERS C, ORDERS O WHERE C.CUSTOMER_ID = O.CUSTOMER_ID AND O.PRODUCT_NAME ='B' ) AND CUSTOMER_ID NOT IN (SELECT C.CUSTOMER_ID FROM CUSTOMERS C, ORDERS O WHERE C.CUSTOMER_ID = O.CUSTOMER_ID AND O.PRODUCT_NAME ='C' )"
589,Y,N,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM ( SELECT CUSTOMER_NAME, B.CUSTOMER_ID, SUM(CASE WHEN PRODUCT_NAME = 'A' THEN 1 ELSE 0 END) AS A, SUM(CASE WHEN PRODUCT_NAME = 'B' THEN 1 ELSE 0 END) AS B, SUM(CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END) AS C FROM ORDERS A LEFT JOIN CUSTOMERS B ON A.CUSTOMER_ID = B.CUSTOMER_ID GROUP BY CUSTOMER_NAME) AS T WHERE A > 0 AND B > 0 AND C = 0 ORDER BY CUSTOMER_ID"
590,Y,Y,"WITH BOUGHT_A AS( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='A'), BOUGHT_B AS( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='B'), BOUGHT_C AS( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='C') SELECT DISTINCT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT * FROM BOUGHT_A) AND CUSTOMER_ID IN (SELECT * FROM BOUGHT_B) AND CUSTOMER_ID NOT IN (SELECT * FROM BOUGHT_C)"
591,Y,Y,"SELECT A.CUSTOMER_ID,CUSTOMER_NAME FROM CUSTOMERS A INNER JOIN ORDERS B ON A.CUSTOMER_ID = B.CUSTOMER_ID GROUP BY 1 HAVING SUM(B.PRODUCT_NAME='A')>0 AND SUM(B.PRODUCT_NAME='B')>0 AND SUM(B.PRODUCT_NAME='C')=0"
592,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C LEFT JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID GROUP BY C.CUSTOMER_ID, C.CUSTOMER_NAME HAVING SUM(O.PRODUCT_NAME='C')=0 AND SUM(O.PRODUCT_NAME='A')>0 AND SUM(O.PRODUCT_NAME='B')>0"
593,Y,Y,"SELECT O.CUSTOMER_ID, CUSTOMER_NAME FROM ORDERS AS O JOIN CUSTOMERS AS C ON O.CUSTOMER_ID = C.CUSTOMER_ID WHERE 1=1 AND O.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') AND O.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND O.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') GROUP BY 1,2"
594,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID GROUP BY CUSTOMER_ID HAVING SUM(PRODUCT_NAME = 'A') > 0 AND SUM(PRODUCT_NAME = 'B') > 0 AND SUM(PRODUCT_NAME = 'C') = 0"
595,Y,Y,SELECT C.* FROM (SELECT CUSTOMER_ID FROM ORDERS GROUP BY CUSTOMER_ID HAVING GROUP_CONCAT(PRODUCT_NAME) LIKE '%A%' AND GROUP_CONCAT(PRODUCT_NAME) LIKE '%B%' AND GROUP_CONCAT(PRODUCT_NAME) NOT LIKE '%C%') T JOIN CUSTOMERS C ON C.CUSTOMER_ID = T.CUSTOMER_ID ORDER BY C.CUSTOMER_ID
596,Y,Y,"SELECT O.CUSTOMER_ID, CUSTOMER_NAME FROM ORDERS O JOIN CUSTOMERS C ON O.CUSTOMER_ID = C.CUSTOMER_ID WHERE O.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='A' AND CUSTOMER_ID IN( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='B'AND CUSTOMER_ID NOT IN( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='C'))) GROUP BY O.CUSTOMER_ID"
597,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM ORDERS O JOIN CUSTOMERS C USING(CUSTOMER_ID) GROUP BY CUSTOMER_ID HAVING SUM(PRODUCT_NAME='A')>0 AND SUM(PRODUCT_NAME='B')>0 AND SUM(PRODUCT_NAME='C')=0"
598,Y,Y,"WITH CTE AS (SELECT CUSTOMER_ID, COUNT(CASE WHEN PRODUCT_NAME = 'A' THEN ORDER_ID END) AS CNTA , COUNT(CASE WHEN PRODUCT_NAME = 'B' THEN ORDER_ID END) AS CNTB , COUNT(CASE WHEN PRODUCT_NAME = 'C' THEN ORDER_ID END) AS CNTC FROM ORDERS GROUP BY CUSTOMER_ID ) SELECT C.CUSTOMER_ID,C.CUSTOMER_NAME FROM CUSTOMERS C INNER JOIN CTE ON C.CUSTOMER_ID = CTE.CUSTOMER_ID WHERE CTE.CNTA>0 AND CTE.CNTB > 0 AND CTE.CNTC=0"
599,Y,Y,"SELECT A.CUSTOMER_ID, A.CUSTOMER_NAME FROM CUSTOMERS A INNER JOIN ORDERS B ON B.CUSTOMER_ID = A.CUSTOMER_ID GROUP BY A.CUSTOMER_ID HAVING SUM(B.PRODUCT_NAME='A') >0 AND SUM(B.PRODUCT_NAME='B') > 0 AND SUM(B.PRODUCT_NAME='C')=0"
600,Y,Y,"WITH A_CUSTOMERS AS( SELECT * FROM ORDERS WHERE PRODUCT_NAME = 'A' ), B_CUSTOMERS AS( SELECT * FROM ORDERS WHERE PRODUCT_NAME = 'B' ), C_CUSTOMERS AS( SELECT * FROM ORDERS WHERE PRODUCT_NAME = 'C' ) SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C WHERE C.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM A_CUSTOMERS) AND C.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM B_CUSTOMERS) AND C.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM C_CUSTOMERS) ORDER BY C.CUSTOMER_ID"
601,Y,Y,"SELECT DISTINCT C1.CUSTOMER_ID , CUSTOMER_NAME FROM ORDERS C1 JOIN ORDERS C2 JOIN CUSTOMERS C ON C1.CUSTOMER_ID = C2.CUSTOMER_ID AND C.CUSTOMER_ID = C1.CUSTOMER_ID AND (C1.PRODUCT_NAME = 'A' AND C2.PRODUCT_NAME = 'B') WHERE C1.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS O WHERE PRODUCT_NAME ='C')"
602,Y,Y,"WITH CTE AS( SELECT CUSTOMER_ID FROM ORDERS WHERE CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='A') AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='B') AND CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='C') ) SELECT DISTINCT CTE.CUSTOMER_ID, CUSTOMER_NAME FROM CTE JOIN CUSTOMERS C ON C.CUSTOMER_ID=CTE.CUSTOMER_ID"
603,Y,N,"SELECT * FROM (SELECT A.CUSTOMER_ID, A.CUSTOMER_NAME FROM CUSTOMERS A INNER JOIN ORDERS B ON A.CUSTOMER_ID = B.CUSTOMER_ID WHERE B.PRODUCT_NAME = 'A' OR B.PRODUCT_NAME = 'B' GROUP BY A.CUSTOMER_ID HAVING COUNT(DISTINCT ORDER_ID)>1) T WHERE CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME ='C')"
604,Y,Y,"SELECT O.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS O JOIN CUSTOMERS C USING(CUSTOMER_ID) GROUP BY 1 HAVING SUM(O.PRODUCT_NAME = 'A') >0 AND SUM(O.PRODUCT_NAME = 'B') > 0 AND SUM(O.PRODUCT_NAME = 'C') = 0"
605,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS O JOIN CUSTOMERS C USING(CUSTOMER_ID) GROUP BY C.CUSTOMER_ID HAVING SUM(O.PRODUCT_NAME = 'A')>0 AND SUM(O.PRODUCT_NAME = 'B') >0 AND SUM(O.PRODUCT_NAME = 'C') =0"
606,Y,Y,"WITH ELIGIBLE_USERS AS( SELECT CUSTOMER_ID, MAX(IF(PRODUCT_NAME = 'A',1,0)) IS_A, MAX(IF(PRODUCT_NAME = 'B',1,0)) IS_B, MAX(IF(PRODUCT_NAME = 'C',1,0)) IS_C FROM ORDERS GROUP BY 1) SELECT E.CUSTOMER_ID, C.CUSTOMER_NAME FROM ELIGIBLE_USERS E JOIN CUSTOMERS C ON E.CUSTOMER_ID = C.CUSTOMER_ID WHERE E.IS_A = 1 AND E.IS_B = 1 AND E.IS_C = 0"
607,Y,Y,"WITH C AS (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='C'), A AS (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='A'), B AS (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='B') SELECT DISTINCT CUSTOMERS.CUSTOMER_ID, CUSTOMER_NAME FROM ORDERS JOIN CUSTOMERS ON CUSTOMERS.CUSTOMER_ID=ORDERS.CUSTOMER_ID WHERE CUSTOMERS.CUSTOMER_ID NOT IN (SELECT * FROM C) AND CUSTOMERS.CUSTOMER_ID IN (SELECT * FROM A) AND CUSTOMERS.CUSTOMER_ID IN (SELECT * FROM B) ORDER BY 1"
608,Y,Y,"WITH T AS ( SELECT CUSTOMER_ID FROM ORDERS GROUP BY 1 HAVING SUM(CASE WHEN PRODUCT_NAME = 'A' THEN 1 ELSE 0 END) > 0 AND SUM(CASE WHEN PRODUCT_NAME = 'B' THEN 1 ELSE 0 END) >0 AND SUM(CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END) = 0 ) SELECT T.CUSTOMER_ID, CUSTOMER_NAME FROM T JOIN CUSTOMERS AS C ON T.CUSTOMER_ID = C.CUSTOMER_ID"
609,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='A' ) AND CUSTOMER_ID IN ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='B' ) AND CUSTOMER_ID NOT IN ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='C' ) ORDER BY 1"
610,Y,Y,"SELECT DISTINCT C.CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE C.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND C.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND C.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')"
611,Y,Y,"WITH A_AND_B AS ( SELECT CUSTOMER_ID, MIN(PRODUCT_NAME) A, MAX(PRODUCT_NAME) B FROM ORDERS WHERE PRODUCT_NAME IN ('A', 'B') GROUP BY 1 ) SELECT DISTINCT CUSTOMER_ID, CUSTOMER_NAME FROM ORDERS JOIN CUSTOMERS USING(CUSTOMER_ID) WHERE CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') AND CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM A_AND_B WHERE A <> B) ORDER BY CUSTOMER_ID"
612,Y,Y,"SELECT O.CUSTOMER_ID, C.CUSTOMER_NAME FROM ORDERS O INNER JOIN CUSTOMERS C ON O.CUSTOMER_ID =C.CUSTOMER_ID GROUP BY 1,2 HAVING MAX(CASE WHEN PRODUCT_NAME ='A' THEN 1 ELSE 0 END) =1 AND MAX(CASE WHEN PRODUCT_NAME ='B' THEN 1 ELSE 0 END) =1 AND MAX(CASE WHEN PRODUCT_NAME ='C' THEN 1 ELSE 0 END)=0"
613,Y,Y,"WITH A AS( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A' ), B AS ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B'), C AS ( SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C' ) SELECT A.CUSTOMER_ID, T.CUSTOMER_NAME FROM A A JOIN B B USING (CUSTOMER_ID) JOIN CUSTOMERS T USING (CUSTOMER_ID) LEFT JOIN C C ON A.CUSTOMER_ID = C.CUSTOMER_ID WHERE C.CUSTOMER_ID IS NULL"
614,Y,Y,"WITH CTE AS ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A' ) SELECT DISTINCT A.CUSTOMER_ID, D.CUSTOMER_NAME FROM CTE A LEFT JOIN CUSTOMERS D ON A.CUSTOMER_ID=D.CUSTOMER_ID WHERE A.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND A.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') ORDER BY A.CUSTOMER_ID"
615,Y,Y,"SELECT DISTINCT ORDERS.CUSTOMER_ID, CUSTOMER_NAME FROM ORDERS JOIN CUSTOMERS C ON C.CUSTOMER_ID = ORDERS.CUSTOMER_ID WHERE PRODUCT_NAME LIKE A AND ORDERS.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME LIKE B ) AND ORDERS.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME LIKE C )"
616,Y,Y,"SELECT O.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C LEFT JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID GROUP BY 1 HAVING SUM(IF(O.PRODUCT_NAME = 'A',1,0)) >= 1 AND SUM(IF(O.PRODUCT_NAME = 'B',1,0)) >= 1 AND SUM(IF(O.PRODUCT_NAME = 'C',1,0)) =0"
617,Y,N,"WITH DATA1 AS (SELECT C.CUSTOMER_ID AS CUSTOMER_ID,CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O USING (CUSTOMER_ID) WHERE PRODUCT_NAME IN ('A') ), DATA2 AS (SELECT C.CUSTOMER_ID AS CUSTOMER_ID,CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O USING (CUSTOMER_ID) WHERE PRODUCT_NAME IN ('B') ) SELECT DISTINCT DATA1.CUSTOMER_ID,DATA1.CUSTOMER_NAME FROM DATA1 JOIN DATA2 USING (CUSTOMER_ID) WHERE DATA1.CUSTOMER_NAME NOT IN ( SELECT CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O USING (CUSTOMER_ID) WHERE PRODUCT_NAME IN ('C') ) ORDER BY DATA1.CUSTOMER_ID ASC"
618,Y,Y,"WITH A AS (SELECT CUSTOMER_ID, PRODUCT_NAME FROM ORDERS WHERE PRODUCT_NAME = 'A' GROUP BY CUSTOMER_ID), B AS (SELECT CUSTOMER_ID, PRODUCT_NAME FROM ORDERS WHERE PRODUCT_NAME = 'B' GROUP BY CUSTOMER_ID), T AS (SELECT A.CUSTOMER_ID, A.PRODUCT_NAME FROM A JOIN B ON A.CUSTOMER_ID = B.CUSTOMER_ID WHERE A.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C')) SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C JOIN T ON C.CUSTOMER_ID = T.CUSTOMER_ID"
619,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O USING(CUSTOMER_ID) GROUP BY 1 HAVING SUM(PRODUCT_NAME = 'A') > 0 AND SUM(PRODUCT_NAME = 'B') > 0 AND SUM(PRODUCT_NAME = 'C') = 0"
620,Y,Y,"SELECT DISTINCT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C INNER JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID WHERE O.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A') AND O.CUSTOMER_ID IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B') AND O.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C') ORDER BY C.CUSTOMER_ID"
621,Y,Y,"WITH CTE1 AS ( SELECT CUSTOMER_ID, SUM(CASE WHEN PRODUCT_NAME = 'A' THEN 1 ELSE 0 END ) AS A, SUM(CASE WHEN PRODUCT_NAME = 'B' THEN 1 ELSE 0 END ) AS B, SUM(CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END ) AS C FROM ORDERS GROUP BY 1 ) SELECT A.CUSTOMER_ID, B.CUSTOMER_NAME FROM CTE1 A INNER JOIN CUSTOMERS B WHERE A.CUSTOMER_ID = B.CUSTOMER_ID AND (A>=1 AND B>=1 AND C=0)"
622,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS AS C WHERE C.CUSTOMER_ID IN ( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'A' AND CUSTOMER_ID IN( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'B' AND CUSTOMER_ID NOT IN( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME = 'C' )))"
623,Y,Y,"WITH CTE1 AS (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME= 'A'), CTE2 AS (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME= 'B' ) SELECT DISTINCT CTE1.CUSTOMER_ID, C.CUSTOMER_NAME FROM CTE1 INNER JOIN CTE2 ON CTE1.CUSTOMER_ID=CTE2.CUSTOMER_ID INNER JOIN CUSTOMERS C ON C.CUSTOMER_ID=CTE1.CUSTOMER_ID WHERE CTE1.CUSTOMER_ID NOT IN (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME= 'C')"
624,Y,Y,"WITH A AS( SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='A' ), B AS (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='B'), C AS (SELECT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='C'), RES AS (SELECT A.CUSTOMER_ID FROM A INNER JOIN B ON A.CUSTOMER_ID=B.CUSTOMER_ID), ORD AS (SELECT RES.CUSTOMER_ID FROM RES LEFT JOIN C ON RES.CUSTOMER_ID=C.CUSTOMER_ID WHERE C.CUSTOMER_ID IS NULL) SELECT * FROM CUSTOMERS WHERE CUSTOMER_ID IN(SELECT DISTINCT CUSTOMER_ID FROM ORD)"
625,Y,Y,"SELECT CUSTOMER_ID, CUSTOMER_NAME FROM ( SELECT CUSTOMER_ID, CUSTOMER_NAME, ORDERED_PRODUCTS FROM ( SELECT CUSTOMERS.CUSTOMER_ID, CUSTOMER_NAME, GROUP_CONCAT( PRODUCT_NAME ORDER BY PRODUCT_NAME SEPARATOR ',' ) AS ORDERED_PRODUCTS FROM CUSTOMERS LEFT JOIN ORDERS ON CUSTOMERS.CUSTOMER_ID = ORDERS.CUSTOMER_ID GROUP BY CUSTOMER_ID ) T HAVING (ORDERED_PRODUCTS LIKE '%A%') AND (ORDERED_PRODUCTS LIKE '%B%') AND (ORDERED_PRODUCTS NOT LIKE '%C%') ORDER BY CUSTOMER_ID) T2"
626,Y,Y,"SELECT CUS.CUSTOMER_ID, CUSTOMER_NAME FROM (SELECT CUSTOMER_ID, SUM(PRODUCT_NAME = 'A') AS A, SUM(PRODUCT_NAME = 'B') AS B, SUM(PRODUCT_NAME = 'C') AS C FROM ORDERS GROUP BY CUSTOMER_ID HAVING A >= 1 AND B >= 1 AND C = 0) TEMP JOIN CUSTOMERS CUS ON TEMP.CUSTOMER_ID = CUS.CUSTOMER_ID ORDER BY CUSTOMER_ID"
627,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM (SELECT CUSTOMER_ID, S.PRODUCTS FROM (SELECT CUSTOMER_ID, GROUP_CONCAT(PRODUCT_NAME) AS PRODUCTS FROM ORDERS GROUP BY CUSTOMER_ID) AS S WHERE S.PRODUCTS LIKE '%A%' AND S.PRODUCTS LIKE '%B%' AND S.PRODUCTS NOT LIKE '%C%' ) AS SS, CUSTOMERS AS C WHERE C.CUSTOMER_ID = SS.CUSTOMER_ID"
628,Y,Y,"SELECT C.CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS C LEFT JOIN ORDERS O ON C.CUSTOMER_ID = O.CUSTOMER_ID GROUP BY C.CUSTOMER_ID HAVING SUM(O.PRODUCT_NAME='C')=0 AND SUM(O.PRODUCT_NAME='A')>0 AND SUM(O.PRODUCT_NAME='B')>0"
629,Y,Y,"WITH TEMP AS ( SELECT CUSTOMER_ID, CASE WHEN PRODUCT_NAME = 'A' THEN 1 ELSE 0 END AS PA, CASE WHEN PRODUCT_NAME = 'B' THEN 1 ELSE 0 END AS PB, CASE WHEN PRODUCT_NAME = 'C' THEN 1 ELSE 0 END AS PC FROM ORDERS ), TEMP2 AS ( SELECT CUSTOMER_ID FROM TEMP GROUP BY CUSTOMER_ID HAVING SUM(PA) > 0 AND SUM(PB) > 0 AND SUM(PC) = 0) SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CUSTOMERS WHERE CUSTOMER_ID IN (SELECT * FROM TEMP2) ORDER BY CUSTOMER_ID"
630,Y,Y,"WITH CTE AS ( SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME, GROUP_CONCAT(DISTINCT O.PRODUCT_NAME ORDER BY O.PRODUCT_NAME ASC SEPARATOR ') AS GCNT FROM CUSTOMERS AS C INNER JOIN ORDERS AS O ON C.CUSTOMER_ID = O.CUSTOMER_ID GROUP BY C.CUSTOMER_ID ) SELECT CUSTOMER_ID, CUSTOMER_NAME FROM CTE WHERE GCNT LIKE '%AB%' AND GCNT NOT LIKE '%C%' ORDER BY CUSTOMER_ID ASC"
631,Y,Y,"WITH CTE AS (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='A'), CTE1 AS (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='B'), CTE2 AS (SELECT DISTINCT CUSTOMER_ID FROM ORDERS WHERE PRODUCT_NAME='C') SELECT DISTINCT CUSTOMER_ID, CUSTOMER_NAME FROM ORDERS O JOIN CUSTOMERS C USING(CUSTOMER_ID) WHERE CUSTOMER_ID IN (SELECT * FROM CTE) AND CUSTOMER_ID IN (SELECT * FROM CTE1) AND CUSTOMER_ID NOT IN (SELECT * FROM CTE2)"
632,Y,Y,"SELECT DISTINCT CUSTOMER_ID, CUSTOMER_NAME FROM ORDERS JOIN CUSTOMERS USING(CUSTOMER_ID) GROUP BY CUSTOMER_ID HAVING SUM(PRODUCT_NAME='A') >0 AND SUM(PRODUCT_NAME='B') > 0 AND SUM(PRODUCT_NAME='C')=0"
633,Y,Y,"SELECT C.CUSTOMER_ID, C.CUSTOMER_NAME FROM CUSTOMERS C JOIN ORDERS O USING (CUSTOMER_ID) GROUP BY C.CUSTOMER_ID HAVING SUM(PRODUCT_NAME = 'A') > 0 AND SUM(PRODUCT_NAME = 'B') > 0 AND SUM(PRODUCT_NAME = 'C') = 0"
