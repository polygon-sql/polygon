qid,mysql_can_execute?,mysql_correct?,mysql_query
0,Y,Y,"(SELECT '[0-5>' BIN, COUNT(SESSION_ID) TOTAL FROM SESSIONS WHERE DURATION/60 >=0 AND DURATION/60 <5) UNION (SELECT '[5-10>' BIN, COUNT(SESSION_ID) TOTAL FROM SESSIONS WHERE DURATION/60 >=5 AND DURATION/60 <10) UNION (SELECT '[10-15>' BIN, COUNT(SESSION_ID) TOTAL FROM SESSIONS WHERE DURATION/60 >=10 AND DURATION/60 <15) UNION (SELECT '15 or more' BIN, COUNT(SESSION_ID) TOTAL FROM SESSIONS WHERE DURATION/60 >=15)"
1,Y,Y,"(SELECT '[0-5>' AS BIN, SUM(CASE WHEN DURATION/60 >= 0 AND DURATION/60 < 5 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS) UNION (SELECT '[5-10>' AS BIN, SUM(CASE WHEN DURATION/60 >= 5 AND DURATION/60 < 10 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS) UNION (SELECT '[10-15>' AS BIN, SUM(CASE WHEN DURATION/60 >= 10 AND DURATION/60 < 15 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS) UNION (SELECT '15 or more' AS BIN, SUM(CASE WHEN DURATION/60 >= 15 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS)"
2,Y,Y,"(SELECT '[0-5>' AS BIN, SUM(CASE WHEN DURATION >=0 AND DURATION < 300 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS) UNION (SELECT '[5-10>' AS BIN, SUM(CASE WHEN DURATION >=300 AND DURATION < 600 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS) UNION (SELECT '[10-15>' AS BIN, SUM(CASE WHEN DURATION >=600 AND DURATION < 900 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS) UNION (SELECT '15 or more' AS BIN, SUM(CASE WHEN DURATION >=900 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS)"
3,Y,Y,"(SELECT '[0-5>' AS BIN, SUM(CASE WHEN DURATION/60 < 5 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS) UNION (SELECT '[5-10>' AS BIN, SUM(CASE WHEN ((DURATION/60 >= 5) AND (DURATION/60 < 10)) THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS) UNION (SELECT '[10-15>' AS BIN, SUM(CASE WHEN ((DURATION/60 >= 10) AND (DURATION/60 < 15)) THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS) UNION (SELECT '15 or more' AS BIN, SUM(CASE WHEN DURATION/60 >= 15 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS)"
4,Y,Y,"SELECT '[0-5>' AS BIN, COUNT( CASE WHEN (DURATION / 60) BETWEEN 0 AND 4.99 THEN SESSION_ID END) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN, COUNT( CASE WHEN (DURATION / 60) BETWEEN 5.00 AND 9.99 THEN SESSION_ID END) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN, COUNT( CASE WHEN (DURATION / 60) BETWEEN 10.00 AND 14.99 THEN SESSION_ID END) AS TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN, COUNT( CASE WHEN (DURATION / 60) >= 15.00 THEN SESSION_ID END) AS TOTAL FROM SESSIONS"
5,Y,N,"SELECT '[0-5>' AS BIN, SUM(CASE WHEN 0<= (DURATION / 60) AND (DURATION / 60) < 5 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN, SUM(CASE WHEN 5<= (DURATION / 60) AND (DURATION / 60) < 10 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN, SUM(CASE WHEN 10<= (DURATION / 60) AND (DURATION / 60) < 15 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN, SUM(CASE WHEN (DURATION / 60) > 15 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS"
6,Y,Y,"SELECT '[0-5>' AS BIN, SUM(CASE WHEN DURATION < 300 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN, SUM(CASE WHEN DURATION >= 300 AND DURATION < 600 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN, SUM(CASE WHEN DURATION >= 600 AND DURATION < 900 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN, SUM(CASE WHEN DURATION >= 900 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS"
7,Y,N,"SELECT '[0-5>' AS BIN, SUM(CASE WHEN DURATION >= 0 AND DURATION < 300 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS GROUP BY 1 UNION SELECT '[5-10>' AS BIN, SUM(CASE WHEN DURATION >= 300 AND DURATION < 600 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS GROUP BY 1 UNION SELECT '[10-15>' AS BIN, SUM(CASE WHEN DURATION >= 600 AND DURATION < 900 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS GROUP BY 1 UNION SELECT '15 or more' AS BIN, SUM(CASE WHEN DURATION > 900 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS GROUP BY 1"
8,Y,N,"SELECT '[0-5>' AS BIN, SUM(CASE WHEN DURATION/60 < 5 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION ALL SELECT '[5-10>' AS BIN, SUM(CASE WHEN DURATION/60 >= 5 AND DURATION/60 < 10 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION ALL SELECT '[10-15>' AS BIN, SUM(CASE WHEN DURATION/60 >= 10 AND DURATION/60 < 15 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION ALL SELECT '15 or more' AS BIN, SUM(CASE WHEN DURATION/60 > 15 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS"
9,Y,Y,"SELECT '[0-5>' AS BIN, SUM(IF(DURATION/60<5, 1, 0)) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN, SUM(IF(DURATION/60>= 5 AND DURATION/60<10, 1, 0)) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN, SUM(IF(DURATION/60>= 10 AND DURATION/60<15, 1, 0)) AS TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN, SUM(IF(DURATION/60>= 15, 1, 0)) AS TOTAL FROM SESSIONS"
10,Y,Y,"SELECT '[0-5>' AS BIN , COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION BETWEEN 0 AND 299 UNION SELECT '[5-10>' AS BIN , COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION BETWEEN 300 AND 599 UNION SELECT '[10-15>' AS BIN , COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION BETWEEN 600 AND 899 UNION SELECT '15 or more AS BIN', COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION >= 900"
11,Y,Y,"SELECT '[0-5>' AS BIN , SUM(DURATION/60 < 5) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN , SUM(DURATION/60 >= 5 AND DURATION/60 < 10) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN , SUM(DURATION/60 >= 10 AND DURATION/60 < 15) AS TOTAL FROM SESSIONS UNION SELECT '15 or more AS BIN', SUM(DURATION/60 >= 15) AS TOTAL FROM SESSIONS"
12,Y,Y,"SELECT '[0-5>' AS BIN, SUM(CASE WHEN DURATION BETWEEN 0 AND 299 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN, SUM(CASE WHEN DURATION BETWEEN 300 AND 599 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN, SUM(CASE WHEN DURATION BETWEEN 600 AND 899 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN, SUM(CASE WHEN DURATION >= 900 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS"
13,Y,Y,"SELECT '[0-5>' AS BIN, SUM(CASE WHEN DURATION/60 < 5 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS GROUP BY BIN UNION ALL SELECT '[5-10>' AS BIN, SUM(CASE WHEN DURATION/60 >= 5 AND DURATION/60 < 10 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS GROUP BY BIN UNION ALL SELECT '[10-15>' AS BIN, SUM(CASE WHEN DURATION/60 >= 10 AND DURATION/60 < 15 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS GROUP BY BIN UNION ALL SELECT '15 or more' AS BIN, SUM(CASE WHEN DURATION/60 >= 15 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS GROUP BY BIN"
14,Y,Y,"SELECT '[0-5>' AS BIN, SUM(CASE WHEN DURATION / 60 >= 0 AND DURATION / 60 < 5 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN, SUM(CASE WHEN DURATION / 60 >= 5 AND DURATION / 60 < 10 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN, SUM(CASE WHEN DURATION / 60 >= 10 AND DURATION / 60 < 15 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN, SUM(CASE WHEN DURATION / 60 >= 15 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS"
15,Y,Y,"SELECT '[0-5>' AS BIN, SUM(DURATION/60<5) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN, SUM(DURATION/60>=5 AND DURATION/60<10) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN, SUM(DURATION/60>=10 AND DURATION/60<15) AS TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN, SUM(DURATION/60>=15) AS TOTAL FROM SESSIONS"
16,Y,Y,"SELECT '[0-5>' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION/60 <5 UNION SELECT '[5-10>' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION/60 <10 AND DURATION/60 >= 5 UNION SELECT '[10-15>' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION/60 <15 AND DURATION/60 >=10 UNION SELECT '15 or more' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION/60 >=15"
17,Y,N,"SELECT '[0-5>' AS BIN, COUNT(CASE WHEN DURATION/60 BETWEEN 0 AND 5 THEN SESSION_ID END) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN, COUNT(CASE WHEN DURATION/60 BETWEEN 5 AND 10 THEN SESSION_ID END) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN, COUNT(CASE WHEN DURATION/60 BETWEEN 10 AND 15 THEN SESSION_ID END) AS TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN, COUNT(CASE WHEN DURATION/60 > 15 THEN SESSION_ID END) AS TOTAL FROM SESSIONS"
18,Y,Y,"SELECT '[0-5>' AS BIN, COUNT(IF((DURATION / 60) < 5, 1, NULL)) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN, COUNT(IF((DURATION / 60) < 10 AND (DURATION / 60) >= 5, 1, NULL)) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN, COUNT(IF((DURATION / 60) < 15 AND (DURATION / 60) >= 10, 1, NULL)) AS TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN, COUNT(IF((DURATION / 60) >= 15, 1, NULL)) AS TOTAL FROM SESSIONS"
19,Y,Y,"SELECT '[0-5>' AS BIN, COUNT(IF(DURATION / 60 < 5 AND DURATION / 60 >= 0, 1, NULL)) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN, COUNT(IF(DURATION / 60 < 10 AND DURATION / 60 >= 5, 1, NULL)) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN, COUNT(IF(DURATION / 60 < 15 AND DURATION / 60 >= 10, 1, NULL)) AS TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN, COUNT(IF(DURATION / 60 >= 15, 1, NULL)) AS TOTAL FROM SESSIONS"
20,Y,Y,"SELECT '[0-5>' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION / 60 >= 0 AND DURATION / 60 < 5 UNION SELECT '[5-10>' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION / 60 >= 5 AND DURATION / 60 < 10 UNION SELECT '[10-15>' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION / 60 >= 10 AND DURATION / 60 < 15 UNION SELECT '15 or more' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION / 60 >= 15"
21,Y,Y,"SELECT '[0-5>' AS BIN, SUM(CASE WHEN (DURATION/60<5) THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN, SUM(CASE WHEN (DURATION/60>=5 AND DURATION/60<10 ) THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN, SUM(CASE WHEN (DURATION/60>=10 AND DURATION/60<15 ) THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN, SUM(CASE WHEN (DURATION/60>=15) THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS"
22,Y,Y,"SELECT '[0-5>' AS BIN, SUM(CASE WHEN DURATION < 5*60 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN, SUM(CASE WHEN DURATION < 10*60 AND DURATION >= 5*60 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN, SUM(CASE WHEN DURATION < 15*60 AND DURATION >= 10*60 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN, SUM(CASE WHEN DURATION >= 15*60 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS"
23,Y,Y,"SELECT '[0-5>' AS BIN, SUM(CASE WHEN DURATION >= 0 AND DURATION < 300 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN, SUM(CASE WHEN DURATION >= 300 AND DURATION < 600 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN, SUM(CASE WHEN DURATION >= 600 AND DURATION < 900 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN, SUM(CASE WHEN DURATION >= 900 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS"
24,Y,N,"SELECT '[0-5>' AS BIN, SUM(CASE WHEN DURATION/60 < 5 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION ALL SELECT '[5-10>' AS BIN, SUM(CASE WHEN DURATION/60 BETWEEN 5 AND 10 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION ALL SELECT '[10-15>' AS BIN, SUM(CASE WHEN DURATION/60 BETWEEN 10 AND 15 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION ALL SELECT '15 or more' AS BIN, SUM(CASE WHEN DURATION/60 > 15 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS"
25,Y,Y,"SELECT '[0-5>' AS BIN, SUM(CASE WHEN DURATION/60 < 5 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN, SUM(CASE WHEN DURATION/60 >= 5 AND DURATION/60 < 10 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN, SUM(CASE WHEN DURATION/60 >= 10 AND DURATION/60 < 15 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN, SUM(CASE WHEN DURATION/60 >= 15 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS"
26,Y,Y,"SELECT '[0-5>' AS BIN, SUM(CASE WHEN DURATION/60 >=0 AND DURATION/60 < 5 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN, SUM(CASE WHEN DURATION/60 >=5 AND DURATION/60 < 10 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>', SUM(CASE WHEN DURATION/60 >=10 AND DURATION/60 < 15 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '15 or more', SUM(CASE WHEN DURATION/60 >=15 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS"
27,Y,Y,"SELECT '[0-5>' AS BIN, SUM(CASE WHEN DURATION>=0 AND DURATION<5*60 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN, SUM(CASE WHEN DURATION>=5*60 AND DURATION<10*60 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN, SUM(CASE WHEN DURATION>=10*60 AND DURATION<15*60 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN, SUM(CASE WHEN DURATION>=15*60 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS"
28,Y,N,"SELECT '[0-5>' AS BIN, SUM(IF(DURATION/60 < 5, 1, 0)) AS TOTAL FROM SESSIONS UNION ALL SELECT '[5-10>' AS BIN, SUM(IF(DURATION/60 > 5 AND DURATION/60 < 10, 1, 0)) AS TOTAL FROM SESSIONS UNION ALL SELECT '[10-15>' AS BIN, SUM(IF(DURATION/60 > 10 AND DURATION/60 < 15, 1, 0)) AS TOTAL FROM SESSIONS UNION ALL SELECT '15 or more' AS BIN, SUM(IF(DURATION/60 > 15, 1, 0)) AS TOTAL FROM SESSIONS"
29,Y,N,"SELECT '[0-5>' AS BIN, SUM(CASE WHEN DURATION * 1.0 / 60 < 5 THEN 1 ELSE 0 END) TOTAL FROM SESSIONS UNION ALL SELECT '[5-10>' AS BIN, SUM(CASE WHEN DURATION * 1.0 / 60 BETWEEN 5 AND 10 THEN 1 ELSE 0 END) TOTAL FROM SESSIONS UNION ALL SELECT '[10-15>' AS BIN, SUM(CASE WHEN DURATION * 1.0 / 60 BETWEEN 10 AND 15 THEN 1 ELSE 0 END) TOTAL FROM SESSIONS UNION ALL SELECT '15 or more' AS BIN, SUM(CASE WHEN DURATION * 1.0 / 60 >= 15 THEN 1 ELSE 0 END) TOTAL FROM SESSIONS"
30,Y,N,"SELECT '[0-5>' BIN, COUNT(*) TOTAL FROM SESSIONS WHERE DURATION < 300 UNION ALL SELECT '[5-10>' BIN, COUNT(*) TOTAL FROM SESSIONS WHERE DURATION BETWEEN 300 AND 600 UNION ALL SELECT '[10-15>' BIN, COUNT(*) TOTAL FROM SESSIONS WHERE DURATION BETWEEN 600 AND 900 UNION ALL SELECT '15 or more' BIN, COUNT(*) TOTAL FROM SESSIONS WHERE DURATION > 900"
31,Y,N,"SELECT '[0-5>' BIN, COUNT(SESSION_ID) TOTAL FROM SESSIONS WHERE DURATION > 0 AND DURATION <300 UNION SELECT '[5-10>', COUNT(SESSION_ID) TOTAL FROM SESSIONS WHERE DURATION > 300 AND DURATION <600 UNION SELECT '[10-15>', COUNT(SESSION_ID) TOTAL FROM SESSIONS WHERE DURATION > 600 AND DURATION <900 UNION SELECT '15 or more', COUNT(SESSION_ID) TOTAL FROM SESSIONS WHERE DURATION > 900"
32,Y,Y,"SELECT '[0-5>' AS BIN, SUM(CASE WHEN DURATION < 300 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>', SUM(CASE WHEN DURATION >= 300 AND DURATION < 600 THEN 1 ELSE 0 END) FROM SESSIONS UNION SELECT '[10-15>', SUM(CASE WHEN DURATION >= 600 AND DURATION < 900 THEN 1 ELSE 0 END) FROM SESSIONS UNION SELECT '15 or more', SUM(CASE WHEN DURATION >= 900 THEN 1 ELSE 0 END) FROM SESSIONS"
33,Y,N,"SELECT '[0-5>' AS BIN, SUM(CASE WHEN DURATION/60 < 5 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN, SUM(CASE WHEN DURATION/60 BETWEEN 5 AND 10 THEN 1 ELSE 0 END) FROM SESSIONS UNION SELECT '[10-15>' AS BIN, SUM(CASE WHEN DURATION/60 BETWEEN 10 AND 15 THEN 1 ELSE 0 END) FROM SESSIONS UNION SELECT '15 or more', SUM(CASE WHEN DURATION/60 >= 15 THEN 1 ELSE 0 END) FROM SESSIONS"
34,Y,N,"SELECT '[0-5>' AS BIN ,SUM(CASE WHEN DURATION/60 BETWEEN 0 AND 5 THEN 1 ELSE 0 END) TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN ,SUM(CASE WHEN DURATION/60 BETWEEN 5 AND 10 THEN 1 ELSE 0 END) TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN ,SUM(CASE WHEN DURATION/60 BETWEEN 10 AND 15 THEN 1 ELSE 0 END) TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN ,SUM(CASE WHEN DURATION/60 >15 THEN 1 ELSE 0 END) TOTAL FROM SESSIONS"
35,Y,N,"SELECT '[0-5>' AS BIN, COUNT(IF(DURATION < 300, 1, NULL)) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN, COUNT(IF(DURATION >= 300 AND DURATION < 600, 1, NULL)) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN, COUNT(IF(DURATION >= 600 AND DURATION < 900, 1, NULL)) AS TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN, COUNT(IF(DURATION > 900, 1, NULL)) AS TOTAL FROM SESSIONS"
36,Y,Y,"SELECT B.BIN, IFNULL(COUNT(A.SESSION_ID), 0) AS TOTAL FROM (SELECT SESSION_ID, CASE WHEN DURATION / 60 < 5 THEN '[0-5>' WHEN DURATION / 60 >= 5 AND DURATION / 60 < 10 THEN '[5-10>' WHEN DURATION / 60 >= 10 AND DURATION / 60 < 15 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS) A RIGHT JOIN (SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN) B ON A.BIN = B.BIN GROUP BY BIN"
37,Y,Y,"SELECT BIN, SUM(TOTAL) AS TOTAL FROM( SELECT '[10-15>' AS BIN, 0 AS TOTAL UNION SELECT '15 or more' AS BIN, 0 AS TOTAL UNION SELECT '[5-10>' AS BIN, 0 AS TOTAL UNION SELECT '[0-5>' AS BIN, 0 AS TOTAL UNION SELECT BIN, COUNT(*) AS TOTAL FROM( SELECT *, (CASE WHEN DURATION/60 >= 15 THEN '15 or more' WHEN DURATION/60 < 15 AND DURATION/60 >= 10 THEN '[10-15>' WHEN DURATION/60 < 10 AND DURATION/60 >= 5 THEN '[5-10>' ELSE '[0-5>' END) AS BIN FROM SESSIONS ) TMP GROUP BY BIN ) TMP GROUP BY BIN"
38,Y,Y,"SELECT BIN, SUM(TOTAL) AS TOTAL FROM ( SELECT '[0-5>' AS BIN, CASE WHEN DURATION/60 < 5 THEN 1 ELSE 0 END AS TOTAL FROM SESSIONS UNION ALL SELECT '[5-10>' AS BIN, CASE WHEN DURATION/60 >= 5 AND DURATION/60 < 10 THEN 1 ELSE 0 END AS TOTAL FROM SESSIONS UNION ALL SELECT '[10-15>' AS BIN, CASE WHEN DURATION/60 >= 10 AND DURATION/60 < 15 THEN 1 ELSE 0 END AS TOTAL FROM SESSIONS UNION ALL SELECT '15 or more' AS BIN, CASE WHEN DURATION/60 >= 15 THEN 1 ELSE 0 END AS TOTAL FROM SESSIONS ) A GROUP BY BIN"
39,Y,Y,"SELECT OPTIONS.BIN, IFNULL(RESWITHOUTNULL.TOTAL, 0) TOTAL FROM ( SELECT '[0-5>' BIN UNION SELECT '[5-10>' BIN UNION SELECT '[10-15>' BIN UNION SELECT '15 or more' BIN ) OPTIONS LEFT JOIN ( SELECT BIN, COUNT(*) TOTAL FROM ( SELECT (CASE WHEN DURATION < 300 THEN '[0-5>' WHEN DURATION < 600 THEN '[5-10>' WHEN DURATION < 900 THEN '[10-15>' ELSE '15 or more' END) BIN FROM SESSIONS ) RESWITHOUTGROUP GROUP BY BIN ) RESWITHOUTNULL ON OPTIONS.BIN = RESWITHOUTNULL.BIN"
40,Y,Y,"SELECT S.BIN, IFNULL(COUNT(S.DURATION),0) AS TOTAL FROM (SELECT T2.BIN, T1.DURATION FROM (SELECT CASE WHEN DURATION>=0 AND DURATION<60*5 THEN '[0-5>' WHEN DURATION>=60*5 AND DURATION<60*10 THEN '[5-10>' WHEN DURATION>=60*10 AND DURATION<60*15 THEN '[10-15>' WHEN DURATION>=60*15 THEN '15 or more' END AS BIN, DURATION FROM SESSIONS) T1 RIGHT JOIN (SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN) T2 ON T1.BIN=T2.BIN) S GROUP BY S.BIN"
41,Y,Y,"SELECT T2.BIN AS BIN, IFNULL(COUNT(SESSION_ID),0) AS TOTAL FROM (SELECT CASE WHEN (DURATION/60) < 5 THEN '[0-5>' WHEN (DURATION/60) >= 5 AND (DURATION/60) <10 THEN '[5-10>' WHEN (DURATION/60) >= 10 AND (DURATION/60) <15 THEN '[10-15>' WHEN (DURATION/60) >=15 THEN '15 or more' END AS BIN, SESSION_ID FROM SESSIONS) T1 RIGHT JOIN( SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN ) T2 ON T1.BIN=T2.BIN GROUP BY T2.BIN"
42,Y,Y,"SELECT A.BIN, COALESCE(TOTAL, 0) AS TOTAL FROM ( SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN ) A LEFT JOIN (SELECT BIN, COUNT(*) AS TOTAL FROM ( SELECT *, CASE WHEN DURATION < 300 THEN '[0-5>' WHEN DURATION < 600 THEN '[5-10>' WHEN DURATION < 900 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS) A GROUP BY BIN) B ON A.BIN = B.BIN"
43,Y,Y,"SELECT B.BIN AS BIN, COALESCE((C.TOTAL),0) AS TOTAL FROM (SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more' AS BIN) B LEFT JOIN (SELECT D.BIN, COUNT(D.BIN) AS TOTAL FROM (SELECT CASE WHEN (DURATION/60) >= 0 AND (DURATION/60) < 5 THEN '[0-5>' WHEN (DURATION/60) >= 5 AND (DURATION/60) < 10 THEN '[5-10>' WHEN (DURATION/60) >= 10 AND (DURATION/60) < 15 THEN '[10-15>' ELSE '15 or more' END BIN FROM SESSIONS) D GROUP BY BIN) C ON B.BIN = C.BIN GROUP BY B.BIN"
44,Y,Y,"SELECT B.BIN AS BIN, COALESCE(SUM(C.TOTAL),0) AS TOTAL FROM (SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more' AS BIN) B LEFT JOIN (SELECT D.BIN, COUNT(D.BIN) AS TOTAL FROM (SELECT CASE WHEN (DURATION/60) >= 0 AND (DURATION/60) < 5 THEN '[0-5>' WHEN (DURATION/60) >= 5 AND (DURATION/60) < 10 THEN '[5-10>' WHEN (DURATION/60) >= 10 AND (DURATION/60) < 15 THEN '[10-15>' ELSE '15 or more' END BIN FROM SESSIONS) D GROUP BY BIN) C ON B.BIN = C.BIN GROUP BY B.BIN"
45,Y,Y,"SELECT B.BIN, IFNULL(COUNT(S.SESSION_ID),0) AS TOTAL FROM ( SELECT SESSION_ID, CASE WHEN DURATION/60<5 THEN '[0-5>' WHEN DURATION/60>=5 AND DURATION/60<10 THEN '[5-10>' WHEN DURATION/60>=10 AND DURATION/60<15 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS ) S RIGHT JOIN ( SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN ) B ON B.BIN=S.BIN GROUP BY BIN"
46,Y,Y,"SELECT B.BIN, IFNULL(COUNT(A.SESSION_ID), 0) AS TOTAL FROM( SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more' AS BIN )B LEFT JOIN( SELECT SESSION_ID, CASE WHEN DURATION/60<5 THEN '[0-5>' WHEN DURATION/60<10 THEN '[5-10>' WHEN DURATION/60<15 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS )A ON B.BIN=A.BIN GROUP BY B.BIN"
47,Y,Y,"SELECT BINS.BIN, COALESCE(T.TOTAL, 0) AS TOTAL FROM (SELECT CASE WHEN DURATION < 5*60 AND DURATION >= 0 THEN '[0-5>' WHEN DURATION < 10*60 AND DURATION >= 5*60 THEN '[5-10>' WHEN DURATION < 15*60 AND DURATION >= 10*60 THEN '[10-15>' ELSE '15 or more' END AS BIN, COUNT(*) AS TOTAL FROM SESSIONS GROUP BY 1) T RIGHT JOIN (SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN) BINS ON T.BIN = BINS.BIN"
48,Y,Y,"SELECT BINS.BIN,COALESCE(A.TOTAL, 0) AS TOTAL FROM (SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN)AS BINS LEFT JOIN (SELECT (CASE WHEN S.DURATION/60 <5 THEN '[0-5>' WHEN S.DURATION/60>=5 AND S.DURATION/60<10 THEN '[5-10>' WHEN S.DURATION/60>=10 AND S.DURATION/60 <15 THEN '[10-15>' ELSE '15 or more' END)AS BIN,COUNT(S.DURATION/60)AS TOTAL FROM SESSIONS AS S GROUP BY 1)AS A ON BINS.BIN=A.BIN GROUP BY 1"
49,Y,Y,"SELECT X.BINS AS BIN, COALESCE(SUM(TOTAL),0) AS TOTAL FROM (SELECT '[0-5>' AS BINS UNION ALL SELECT '[5-10>' AS BINS UNION ALL SELECT '[10-15>' AS BINS UNION ALL SELECT '15 or more' AS BINS ) X LEFT JOIN (SELECT BINS, COUNT(*) AS TOTAL FROM (SELECT CASE WHEN DURATION < 300 THEN '[0-5>' WHEN DURATION < 600 THEN '[5-10>' WHEN DURATION < 900 THEN '[10-15>' WHEN DURATION >= 900 THEN '15 or more' ELSE 0 END AS BINS FROM SESSIONS ) Y GROUP BY 1) Z ON X.BINS = Z.BINS GROUP BY 1"
50,Y,N,"SELECT '[0-5>' AS BIN, COUNT(IF(DURATION <=300,1,NULL)) AS TOTAL FROM SESSIONS UNION ALL SELECT '[5-10>' AS BIN,COUNT(IF (DURATION>300 AND DURATION <=600,1,NULL)) AS TOTAL FROM SESSIONS UNION ALL SELECT '[10-15>' AS BIN,COUNT(IF(DURATION>600 AND DURATION <=900,1,NULL)) AS TOTAL FROM SESSIONS UNION ALL SELECT '15 or more' AS BIN,COUNT(IF (DURATION>900,1,NULL)) AS TOTAL FROM SESSIONS"
51,Y,Y,"SELECT '[0-5>' BIN, COUNT(CASE WHEN DURATION/60 >= 0 AND DURATION/60 < 5 THEN SESSION_ID END) TOTAL FROM SESSIONS UNION SELECT '[5-10>' BIN, COUNT(CASE WHEN DURATION/60 >= 5 AND DURATION/60 < 10 THEN SESSION_ID END) TOTAL FROM SESSIONS UNION SELECT '[10-15>' BIN, COUNT(CASE WHEN DURATION/60 >= 10 AND DURATION/60 < 15 THEN SESSION_ID END) TOTAL FROM SESSIONS UNION SELECT '15 or more' BIN, COUNT(CASE WHEN DURATION/60 >= 15 THEN SESSION_ID END) TOTAL FROM SESSIONS"
52,Y,Y,"SELECT '[0-5>' AS BIN, SUM(DURATION < 300) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN, SUM(DURATION >= 300 AND DURATION < 600) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN, SUM(DURATION >= 600 AND DURATION < 900 ) AS TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN, SUM(DURATION >= 900) AS TOTAL FROM SESSIONS"
53,Y,Y,"WITH C AS (SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN), B AS( SELECT (CASE WHEN DURATION/60<5 THEN '[0-5>' WHEN DURATION/60<10 AND DURATION/60>=5 THEN '[5-10>' WHEN DURATION/60<15 AND DURATION/60>=10 THEN '[10-15>' WHEN DURATION/60<20 AND DURATION/60>=15 THEN '15 or more' END) AS BIN , COUNT(SESSION_ID) AS TOTAL FROM SESSIONS GROUP BY 1) SELECT C.BIN,IFNULL(B.TOTAL,0) AS TOTAL FROM C LEFT JOIN B USING (BIN)"
54,Y,Y,"WITH CTE AS ( SELECT (CASE WHEN (DURATION / 60) BETWEEN 0 AND 4.99 THEN '[0-5>' WHEN (DURATION / 60) BETWEEN 5.00 AND 9.99 THEN '[5-10>' WHEN (DURATION / 60) BETWEEN 10.00 AND 14.99 THEN '[10-15>' WHEN (DURATION / 60) >= 15.00 THEN '15 or more' ELSE NULL END) AS BIN, COALESCE(COUNT(*), 0) AS TOTAL FROM SESSIONS GROUP BY (CASE WHEN (DURATION / 60) BETWEEN 0 AND 4.99 THEN '[0-5>' WHEN (DURATION / 60) BETWEEN 5.00 AND 9.99 THEN '[5-10>' WHEN (DURATION / 60) BETWEEN 10.00 AND 14.99 THEN '[10-15>' WHEN (DURATION / 60) >= 15.00 THEN '15 or more' ELSE NULL END) ), CTE2 AS ( SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN ) SELECT C2.BIN AS BIN, COALESCE(C.TOTAL, 0) AS TOTAL FROM CTE2 C2 LEFT JOIN CTE C ON C2.BIN = C.BIN"
55,Y,Y,"WITH CTE1 AS ( SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more' AS BIN ) , CTE2 AS ( SELECT AGG.BIN , COUNT(*) AS TOTAL FROM ( SELECT SESSION_ID ,CASE WHEN ROUND(DURATION/60, 3) BETWEEN 0 AND 4.999 THEN '[0-5>' WHEN ROUND(DURATION/60, 3) BETWEEN 5 AND 9.999 THEN '[5-10>' WHEN ROUND(DURATION/60, 3) BETWEEN 10 AND 14.999 THEN '[10-15>' ELSE '15 or more' END AS BIN , ROUND(DURATION/60, 3) FROM SESSIONS ) AGG GROUP BY 1 ) SELECT CTE1.BIN , IFNULL(CTE2.TOTAL,0) AS TOTAL FROM CTE1 LEFT JOIN CTE2 ON CTE1.BIN = CTE2.BIN"
56,Y,Y,"WITH CTE1 AS ( SELECT SESSION_ID, (CASE WHEN DURATION<5*60 THEN 1 ELSE 0 END) AS BIN5, (CASE WHEN DURATION>=5*60 AND DURATION<10*60 THEN 1 ELSE 0 END) AS BIN10, (CASE WHEN DURATION>=10*60 AND DURATION<15*60 THEN 1 ELSE 0 END) AS BIN15, (CASE WHEN DURATION>=15*60 THEN 1 ELSE 0 END) AS BIN20 FROM SESSIONS) SELECT '[0-5>' AS BIN, SUM(BIN5) AS TOTAL FROM CTE1 UNION ALL SELECT '[5-10>' AS BIN, SUM(BIN10) AS TOTAL FROM CTE1 UNION ALL SELECT '[10-15>' AS BIN, SUM(BIN15) AS TOTAL FROM CTE1 UNION ALL SELECT '15 or more' AS BIN, SUM(BIN20) AS TOTAL FROM CTE1"
57,Y,Y,"WITH R AS ( SELECT '[0-5>' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION >= 0 AND DURATION < 300 UNION SELECT '[5-10>' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION >= 300 AND DURATION < 600 UNION SELECT '[10-15>' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION >= 600 AND DURATION < 900 UNION SELECT '15 or more' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION >= 900 ) SELECT * FROM R"
58,Y,Y,"WITH ALL_BIN AS (SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more' AS BIN) SELECT ALL_BIN.BIN, COALESCE(C.TOTAL, 0) AS TOTAL FROM ALL_BIN LEFT JOIN( SELECT BIN, COUNT(*) AS TOTAL FROM ( SELECT SESSION_ID, CASE WHEN DURATION/60 < 5 THEN '[0-5>' WHEN DURATION/60 < 10 THEN '[5-10>' WHEN DURATION/60 < 15 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS) A GROUP BY 1) C USING (BIN)"
59,Y,Y,"WITH BIN_DEF AS ( SELECT '[0-5>' AS BIN, 0 AS MIN_SEC, 5*60 AS MAX_SEC UNION SELECT '[5-10>' AS BIN, 5*60 AS MIN_SEC, 10*60 AS MAX_SEC UNION SELECT '[10-15>' AS BIN, 10*60 AS MIN_SEC, 15*60 AS MAX_SEC UNION SELECT '15 or more' AS BIN, 15*60 AS MIN_SEC, NULL AS MAX_SEC ) SELECT B.BIN , COUNT(S.SESSION_ID) AS TOTAL FROM BIN_DEF B LEFT JOIN SESSIONS S ON S.DURATION >= B.MIN_SEC AND S.DURATION < COALESCE(B.MAX_SEC,S.DURATION+1) GROUP BY B.BIN"
60,Y,Y,"WITH BINS AS ( SELECT '[0-5>' AS BIN FROM DUAL UNION SELECT '[5-10>' AS BIN FROM DUAL UNION SELECT '[10-15>' AS BIN FROM DUAL UNION SELECT '15 or more' AS BIN FROM DUAL ) SELECT B.BIN, COUNT(S.SESSION_ID) AS TOTAL FROM BINS B LEFT JOIN (SELECT ( CASE WHEN DURATION/60 >= 15 THEN '15 or more' WHEN DURATION/60 < 15 AND DURATION/60 >= 10 THEN '[10-15>' WHEN DURATION/60 < 10 AND DURATION/60 >= 5 THEN '[5-10>' WHEN DURATION/60 < 5 AND DURATION/60 >= 0 THEN '[0-5>' END ) AS BIN, SESSION_ID FROM SESSIONS) S ON B.BIN = S.BIN GROUP BY B.BIN"
61,Y,Y,"WITH CTE AS ( SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN ) SELECT CTE.BIN AS BIN,IFNULL(B.TOTAL,0) AS TOTAL FROM CTE LEFT JOIN (SELECT BIN, COUNT(*) AS TOTAL FROM (SELECT CASE WHEN DURATION BETWEEN 0 AND 299 THEN '[0-5>' WHEN DURATION BETWEEN 300 AND 599 THEN '[5-10>' WHEN DURATION BETWEEN 600 AND 899 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS) AS T GROUP BY BIN) AS B ON CTE.BIN = B.BIN"
62,Y,Y,"WITH CTE AS ( SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN ), SESSIONSWITHBINS AS ( SELECT (CASE WHEN DURATION < 5*60 THEN '[0-5>' WHEN DURATION < 10*60 THEN '[5-10>' WHEN DURATION < 15*60 THEN '[10-15>' ELSE '15 or more' END) AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS GROUP BY BIN ) SELECT C.BIN AS BIN, IFNULL(S.TOTAL,0) AS TOTAL FROM CTE C LEFT OUTER JOIN SESSIONSWITHBINS S ON C.BIN = S.BIN"
63,Y,Y,"WITH CTE AS ( SELECT '[0-5>' AS BIN, 0 AS MIN_DURATION, 5*60 AS MAX_DURATION UNION ALL SELECT '[5-10>' AS BIN, 5*60 AS MIN_DURATION, 10*60 AS MAX_DURATION UNION ALL SELECT '[10-15>' AS BIN, 10*60 AS MIN_DURATION, 15*60 AS MAX_DURATION UNION ALL SELECT '15 or more' AS BIN, 15*60 AS MIN_DURATION, 2147483647 AS MAX_DURATION ) SELECT CTE.BIN, COUNT(S.SESSION_ID) AS TOTAL FROM SESSIONS S RIGHT JOIN CTE ON S.DURATION >= MIN_DURATION AND S.DURATION < MAX_DURATION GROUP BY CTE.BIN"
64,Y,Y,"WITH CTE AS ( SELECT '[0-5>' AS BIN, 0 AS MIN_DURATION, 5*60 AS MAX_DURATION UNION ALL SELECT '[5-10>' AS BIN, 5*60 AS MIN_DURATION, 10*60 AS MAX_DURATION UNION ALL SELECT '[10-15>' AS BIN, 10*60 AS MIN_DURATION, 15*60 AS MAX_DURATION UNION ALL SELECT '15 or more' AS BIN, 15*60 AS MIN_DURATION, 10000000 AS MAX_DURATION ) SELECT A.BIN, IFNULL(COUNT(B.SESSION_ID),0) AS TOTAL FROM CTE A LEFT JOIN SESSIONS B ON B.DURATION >= A.MIN_DURATION AND B.DURATION < A.MAX_DURATION GROUP BY 1"
65,Y,Y,"WITH CTE AS ( SELECT '[0-5>' AS BIN, 0 AS LOW, 60*5 AS HIGH UNION ALL SELECT '[5-10>' AS BIN, 60*5 AS LOW, 60*10 AS HIGH UNION ALL SELECT '[10-15>' AS BIN, 60*10 AS LOW, 60*15 AS HIGH UNION ALL SELECT '15 or more' AS BIN, 60*15 AS LOW, (SELECT MAX(DURATION)+1 AS HIGH FROM SESSIONS) ), SESSIONSWITHBINS AS ( SELECT C.BIN, IFNULL(COUNT(S.SESSION_ID),0) AS TOTAL FROM CTE C LEFT OUTER JOIN SESSIONS S ON S.DURATION >= C.LOW AND S.DURATION < C.HIGH GROUP BY BIN ) SELECT * FROM SESSIONSWITHBINS"
66,Y,Y,"WITH CTE AS ( SELECT DURATION/60 AS MINS FROM SESSIONS ) SELECT '[0-5>' AS BIN, SUM(CASE WHEN MINS<5 THEN 1 ELSE 0 END) AS TOTAL FROM CTE UNION ALL SELECT '[5-10>' AS BIN, SUM(CASE WHEN MINS>=5 AND MINS<10 THEN 1 ELSE 0 END) AS TOTAL FROM CTE UNION ALL SELECT '[10-15>' AS BIN, SUM(CASE WHEN MINS>=10 AND MINS<15 THEN 1 ELSE 0 END) AS TOTAL FROM CTE UNION ALL SELECT '15 or more' AS BIN, SUM(CASE WHEN MINS>=15 THEN 1 ELSE 0 END) AS TOTAL FROM CTE"
67,Y,Y,"WITH CTE AS ( SELECT SESSION_ID, CASE WHEN DURATION/60 >= 0 AND DURATION/60 < 5 THEN '[0-5>' WHEN DURATION/60 >= 5 AND DURATION/60 < 10 THEN '[5-10>' WHEN DURATION/60 >= 10 AND DURATION/60 < 15 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS), CTE2 AS (SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN) SELECT CTE2.BIN AS BIN, COUNT(CTE.SESSION_ID) AS TOTAL FROM CTE2 LEFT JOIN CTE ON CTE2.BIN = CTE.BIN GROUP BY CTE2.BIN"
68,Y,Y,"WITH CTE AS(SELECT DURATION/60 AS MINS FROM SESSIONS) SELECT '[0-5>' AS BIN, SUM(CASE WHEN MINS >= 0 AND MINS < 5 THEN 1 ELSE 0 END) AS TOTAL FROM CTE UNION SELECT '[5-10>' AS BIN, SUM(CASE WHEN MINS >= 5 AND MINS < 10 THEN 1 ELSE 0 END) AS TOTAL FROM CTE UNION SELECT '[10-15>' AS BIN, SUM(CASE WHEN MINS >= 10 AND MINS < 15 THEN 1 ELSE 0 END) AS TOTAL FROM CTE UNION SELECT '15 or more' AS BIN, SUM(CASE WHEN MINS >= 15 THEN 1 ELSE 0 END) AS TOTAL FROM CTE"
69,Y,Y,"WITH CTE1 AS (SELECT '[0-5>' AS BIN, SUM(DURATION <5*60) AS TOTAL FROM SESSIONS UNION ALL SELECT '[5-10>' AS BIN, SUM(DURATION >= 5*60 AND DURATION <10*60) AS TOTAL FROM SESSIONS UNION ALL SELECT '[10-15>' AS BIN, SUM(DURATION >= 10*60 AND DURATION <15*60) AS TOTAL FROM SESSIONS UNION ALL SELECT '15 or more' AS BIN, SUM(DURATION >= 15*60) AS TOTAL FROM SESSIONS) SELECT * FROM CTE1"
70,Y,Y,"WITH CTE_SESSION(BIN, MINDURATION, MAXDURATION) AS( SELECT '[0-5>', 0, 5*60 UNION ALL SELECT '[5-10>', 5*60, 10*60 UNION ALL SELECT '[10-15>', 10*60, 15*60 UNION ALL SELECT '15 or more', 15*60, 214748 ) SELECT CTE_SESSION.BIN, COUNT(S.SESSION_ID) AS TOTAL FROM SESSIONS S RIGHT JOIN CTE_SESSION ON S.DURATION >= MINDURATION AND S.DURATION < MAXDURATION GROUP BY CTE_SESSION.BIN"
71,Y,Y,"WITH SESSIONTABLE AS( SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN ) SELECT S.BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONTABLE AS S LEFT JOIN( SELECT SESSION_ID, CASE WHEN DURATION/60<5 THEN '[0-5>' WHEN DURATION/60<10 THEN '[5-10>' WHEN DURATION/60<15 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS )A USING (BIN) GROUP BY S.BIN"
72,Y,Y,"WITH T1 AS ( SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN ), T2 AS( SELECT CASE WHEN (DURATION/60) >=0 AND (DURATION/60) <5 THEN '[0-5>' WHEN (DURATION/60) >=5 AND (DURATION/60) <10 THEN '[5-10>' WHEN (DURATION/60) >=10 AND (DURATION/60) <15 THEN '[10-15>' ELSE '15 or more' END AS BIN, IFNULL(COUNT(DISTINCT SESSION_ID),0) AS TOTAL FROM SESSIONS GROUP BY BIN ) SELECT T1.BIN, IFNULL(T2.TOTAL,0) AS TOTAL FROM T1 LEFT JOIN T2 ON T1.BIN = T2.BIN"
73,Y,Y,"WITH TEMP1 AS ( SELECT SESSION_ID, DURATION / 60 AS MINUTE FROM SESSIONS ), TEMP2 AS ( SELECT CASE WHEN MINUTE < 5 THEN '[0-5>' WHEN MINUTE < 10 THEN '[5-10>' WHEN MINUTE < 15 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM TEMP1 ), CTE AS ( SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN ) SELECT CTE.BIN, COUNT(TEMP2.BIN) AS TOTAL FROM CTE LEFT JOIN TEMP2 ON CTE.BIN = TEMP2.BIN GROUP BY BIN"
74,Y,Y,"WITH TEMP_DATA AS ( SELECT DISTINCT SESSION_ID, CASE WHEN (DURATION/60) >= 0 AND (DURATION/60) < 5 THEN '[0-5>' WHEN (DURATION/60) >= 5 AND (DURATION/60) < 10 THEN '[5-10>' WHEN (DURATION/60) >= 10 AND (DURATION/60) < 15 THEN '[10-15>' WHEN (DURATION/60) >=15 THEN '15 or more' END AS BIN FROM SESSIONS ) ,LOOKUP_TABLE AS ( SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN ) SELECT LT.BIN, IFNULL(TOTAL,0) AS TOTAL FROM ( SELECT BIN, COUNT(SESSION_ID) AS TOTAL FROM TEMP_DATA GROUP BY BIN ) A RIGHT JOIN LOOKUP_TABLE LT ON A.BIN = LT.BIN"
75,Y,Y,"WITH BINS AS (SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN ), AGGR_BINS AS ( SELECT B.BIN AS BIN, COUNT(S.SESSION_ID) AS TOTAL FROM BINS B LEFT JOIN SESSIONS S ON B.BIN = (CASE WHEN DURATION/60 >= 0 AND DURATION/60 < 5 THEN '[0-5>' WHEN DURATION/60 >= 5 AND DURATION/60 < 10 THEN '[5-10>' WHEN DURATION/60 >= 10 AND DURATION/60 < 15 THEN '[10-15>' ELSE '15 or more' END ) GROUP BY 1 ) SELECT * FROM AGGR_BINS"
76,Y,Y,"SELECT '[0-5>' AS BIN , COUNT(DURATION) TOTAL FROM SESSIONS WHERE DURATION < 300 UNION SELECT '[5-10>' AS BIN , COUNT(DURATION) TOTAL FROM SESSIONS WHERE DURATION BETWEEN 300 AND 599 UNION SELECT '[10-15>' AS BIN , COUNT(DURATION) TOTAL FROM SESSIONS WHERE DURATION BETWEEN 600 AND 899 UNION SELECT '15 or more AS BIN', COUNT(DURATION) TOTAL FROM SESSIONS WHERE DURATION > 899"
77,Y,N,"SELECT '[0-5>' AS BIN ,SUM( CASE WHEN DURATION /60 <5 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN ,SUM( CASE WHEN DURATION /60 >5 AND DURATION/60 < 10 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN ,SUM( CASE WHEN DURATION /60 >5 AND DURATION/60 < 10 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN ,SUM( CASE WHEN DURATION /60 >10 AND DURATION/60 < 15 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN ,SUM( CASE WHEN DURATION /60 >15 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS"
78,Y,Y,"SELECT '[0-5>' AS BIN, COUNT( CASE WHEN DURATION>=0 AND DURATION<300 THEN '[0-5>' END ) AS TOTAL FROM SESSIONS GROUP BY BIN UNION ALL SELECT '[5-10>' AS BIN, COUNT( CASE WHEN DURATION>=300 AND DURATION<600 THEN '[5-10>' END ) AS TOTAL FROM SESSIONS GROUP BY BIN UNION ALL SELECT '[10-15>' AS BIN, COUNT( CASE WHEN DURATION>=600 AND DURATION<900 THEN '[10-15>' END ) AS TOTAL FROM SESSIONS GROUP BY BIN UNION ALL SELECT '15 or more' AS BIN, COUNT( CASE WHEN DURATION>=900 THEN '15 or more' END ) AS TOTAL FROM SESSIONS GROUP BY BIN"
79,Y,Y,"SELECT '[0-5>' AS BIN, COUNT(CASE WHEN DURATION/60 < 5 AND DURATION/60 >=0 THEN SESSION_ID END) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN, COUNT(CASE WHEN DURATION/60 < 10 AND DURATION/60 >=5 THEN SESSION_ID END) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN, COUNT(CASE WHEN DURATION/60 < 15 AND DURATION/60 >=10 THEN SESSION_ID END) AS TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN, COUNT(CASE WHEN DURATION/60 >=15 THEN SESSION_ID END) AS TOTAL FROM SESSIONS"
80,Y,Y,"SELECT '[0-5>' AS BIN, COUNT(CASE WHEN DURATION/60 >=0 AND DURATION/60 < 5 THEN SESSION_ID END) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN, COUNT(CASE WHEN DURATION/60 >=5 AND DURATION/60 < 10 THEN SESSION_ID END) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN, COUNT(CASE WHEN DURATION/60 >= 10 AND DURATION/60 < 15 THEN SESSION_ID END) AS TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN, COUNT(CASE WHEN DURATION/60 >=15 THEN SESSION_ID END) AS TOTAL FROM SESSIONS"
81,Y,Y,"SELECT '[0-5>' AS BIN , COUNT(CASE WHEN DURATION < 300 THEN SESSION_ID END) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN , COUNT(CASE WHEN DURATION >= 300 AND DURATION < 600 THEN SESSION_ID END) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN , COUNT(CASE WHEN DURATION >= 600 AND DURATION < 900 THEN SESSION_ID END) AS TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN , COUNT(CASE WHEN DURATION >= 900 THEN SESSION_ID END) AS TOTAL FROM SESSIONS"
82,Y,Y,"SELECT '[0-5>' AS BIN, COUNT(CASE WHEN DURATION/60 >= 0 AND DURATION/60 < 5 THEN SESSION_ID END) AS TOTAL FROM SESSIONS UNION ALL SELECT '[5-10>' AS BIN, COUNT(CASE WHEN DURATION/60 >= 5 AND DURATION/60 < 10 THEN SESSION_ID END) AS TOTAL FROM SESSIONS UNION ALL SELECT '[10-15>' AS BIN, COUNT(CASE WHEN DURATION/60 >= 10 AND DURATION/60 < 15 THEN SESSION_ID END) AS TOTAL FROM SESSIONS UNION ALL SELECT '15 or more' AS BIN, COUNT(CASE WHEN DURATION/60 >= 15 THEN SESSION_ID END) AS TOTAL FROM SESSIONS"
83,Y,Y,"SELECT '[0-5>' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION / 60 < 5 AND DURATION / 60 >= 0 UNION SELECT '[5-10>' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION / 60 < 10 AND DURATION / 60 >= 5 UNION SELECT '[10-15>' AS BIN, COUNT(SESSION_ID) AS TOAL FROM SESSIONS WHERE DURATION / 60 < 15 AND DURATION / 60 >= 10 UNION SELECT '15 or more' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION / 60 >=15"
84,Y,Y,"SELECT '[0-5>' AS BIN, IFNULL(SUM(CASE WHEN DURATION/60 >=0 AND DURATION/60 < 5 THEN 1 END),0) AS TOTAL FROM SESSIONS UNION (SELECT '[5-10>' AS BIN, IFNULL(SUM(CASE WHEN DURATION/60 >=5 AND DURATION/60 < 10 THEN 1 END),0) AS TOTAL FROM SESSIONS) UNION (SELECT '[10-15>' AS BIN, IFNULL(SUM(CASE WHEN DURATION/60 >=10 AND DURATION/60 < 15 THEN 1 END),0) AS TOTAL FROM SESSIONS) UNION (SELECT '15 or more' AS BIN, IFNULL(SUM(CASE WHEN DURATION/60 >=15 THEN 1 END),0) AS TOTAL FROM SESSIONS)"
85,Y,N,"SELECT '[0-5>' AS BIN,COUNT(CASE WHEN DURATION/60 < 5 AND DURATION/60 >=0 THEN SESSION_ID END)AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN,COUNT(CASE WHEN DURATION/60 < 10 AND DURATION/60 >=5 THEN SESSION_ID END)AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN,COUNT(CASE WHEN DURATION/60 < 15 AND DURATION/60 >=10 THEN SESSION_ID END)AS TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN,COUNT(CASE WHEN DURATION/60 > 15 THEN SESSION_ID END)AS TOTAL FROM SESSIONS"
86,Y,N,"SELECT '[0-5>' AS BIN,SUM(CASE WHEN DURATION/60 BETWEEN 0 AND 5 THEN 1 ELSE 0 END) TOTAL FROM SESSIONS UNION SELECT '[5-10>' ,SUM(CASE WHEN DURATION/60 BETWEEN 5 AND 10 THEN 1 ELSE 0 END) FROM SESSIONS UNION SELECT '[10-15>',SUM(CASE WHEN DURATION/60 BETWEEN 10 AND 15 THEN 1 ELSE 0 END) FROM SESSIONS UNION SELECT '15 or more' ,SUM(CASE WHEN DURATION/60 >15 THEN 1 ELSE 0 END) FROM SESSIONS"
87,Y,N,"SELECT '[0-5>' AS BIN,SUM(DURATION/60<5) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN,SUM(DURATION/60>5 AND DURATION/60<10) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN,SUM(DURATION/60>10 AND DURATION/60<15) AS TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN,SUM(DURATION/60>15) AS TOTAL FROM SESSIONS"
88,Y,Y,"SELECT '[0-5>' AS BIN , COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION BETWEEN 0 AND (5*60-1) UNION SELECT '[5-10>' AS BIN , COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION BETWEEN 5*60 AND (10*60-1) UNION SELECT '[10-15>' AS BIN , COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION BETWEEN 10*60 AND (15*60-1) UNION SELECT '15 or more AS BIN', COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION >= 15*60"
89,Y,Y,"SELECT '[0-5>' AS BIN, COUNT((DURATION/60)) AS TOTAL FROM SESSIONS WHERE (DURATION/60)>=0 AND (DURATION/60) <5 UNION SELECT '[5-10>' AS BIN, COUNT((DURATION/60)) AS TOTAL FROM SESSIONS WHERE (DURATION/60)>=5 AND (DURATION/60) <10 UNION SELECT '[10-15>' AS BIN, COUNT((DURATION/60)) AS TOTAL FROM SESSIONS WHERE (DURATION/60)>=10 AND (DURATION/60) <15 UNION SELECT '15 or more' AS BIN, COUNT((DURATION/60)) AS TOTAL FROM SESSIONS WHERE (DURATION/60) >= 15"
90,Y,Y,"SELECT '[0-5>' AS BIN, COUNT(CASE WHEN DURATION/60 < 5 THEN SESSION_ID END ) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN, COUNT(CASE WHEN DURATION/60>=5 AND DURATION/60<10 THEN SESSION_ID END ) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN, COUNT(CASE WHEN DURATION/60>=10 AND DURATION/60<15 THEN SESSION_ID END ) AS TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN, COUNT(CASE WHEN DURATION/60>=15 THEN SESSION_ID END ) AS TOTAL FROM SESSIONS"
91,Y,N,"SELECT '[0-5>' AS BIN, COUNT(CASE WHEN DURATION/60 <=5 THEN SESSION_ID END) TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN, COUNT(CASE WHEN DURATION/60 <=10 AND DURATION/60 >5 THEN SESSION_ID END) TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN, COUNT(CASE WHEN DURATION/60 <=15 AND DURATION/60 >10 THEN SESSION_ID END) TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN, COUNT(CASE WHEN DURATION/60 > 15 THEN SESSION_ID END) TOTAL FROM SESSIONS"
92,Y,Y,"SELECT '[0-5>' AS BIN, COUNT(CASE WHEN((DURATION/60)<5 AND (DURATION/60)>=0) THEN SESSION_ID END)AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN, COUNT(CASE WHEN((DURATION/60)>=5 AND (DURATION/60)<10)THEN SESSION_ID END)AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN, COUNT(CASE WHEN((DURATION/60)>=10 AND (DURATION/60)<15)THEN SESSION_ID END)AS TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN, COUNT(CASE WHEN((DURATION/60)>=15)THEN SESSION_ID END)AS TOTAL FROM SESSIONS"
93,Y,Y,"SELECT '[0-5>' AS BIN, SUM(DURATION/60 <5 AND DURATION/60 >=0) AS TOTAL FROM SESSIONS UNION ALL SELECT '[5-10>' AS BIN, SUM(DURATION/60 <10 AND DURATION/60 >=5) AS TOTAL FROM SESSIONS UNION ALL SELECT '[10-15>' AS BIN, SUM(DURATION/60 >=10 AND DURATION/60 <15) AS TOTAL FROM SESSIONS UNION ALL SELECT '15 or more' AS BIN, SUM(DURATION/60 >= 15) AS TOTAL FROM SESSIONS"
94,Y,Y,"SELECT '[0-5>' AS BIN,COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION < 300 UNION SELECT '[5-10>' AS BIN,COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION BETWEEN 300 AND 599 UNION SELECT '[10-15>' AS BIN,COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION BETWEEN 600 AND 899 UNION SELECT '15 or more' AS BIN,COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION >= 900"
95,Y,Y,"SELECT '[0-5>' AS BIN ,COUNT(CASE WHEN (DURATION)/60 >= 0 AND (DURATION)/60 < 5 THEN SESSION_ID END) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN , COUNT(CASE WHEN (DURATION)/60 >= 5 AND (DURATION)/60 < 10 THEN SESSION_ID END) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN , COUNT(CASE WHEN (DURATION)/60 >= 10 AND (DURATION)/60 < 15 THEN SESSION_ID END) AS TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN ,COUNT(CASE WHEN (DURATION)/60 >= 15 THEN SESSION_ID END) AS TOTAL FROM SESSIONS"
96,Y,Y,"SELECT '[0-5>' AS BIN, (SELECT COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION <300) AS TOTAL UNION SELECT '[5-10>' AS BIN, (SELECT COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION >=300 AND DURATION < 600) AS TOTAL UNION SELECT '[10-15>' AS BIN, (SELECT COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION >=600 AND DURATION < 900) AS TOTAL UNION SELECT '15 or more' AS BIN, (SELECT COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION >=900) AS TOTAL"
97,Y,N,"SELECT '[0-5>' AS BIN, (SELECT COUNT(SESSION_ID) FROM SESSIONS WHERE (DURATION/60)<5) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN, (SELECT COUNT(SESSION_ID) FROM SESSIONS WHERE (DURATION/60)<10 AND (DURATION/60)>5) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN, (SELECT COUNT(SESSION_ID) FROM SESSIONS WHERE (DURATION/60)>10 AND (DURATION/60)<15) AS TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN, (SELECT COUNT(SESSION_ID) FROM SESSIONS WHERE (DURATION/60)>15) AS TOTAL FROM SESSIONS"
98,Y,Y,"SELECT '[0-5>' AS BIN, (SELECT COUNT(SESSION_ID) FROM SESSIONS WHERE DURATION < 300) AS TOTAL UNION SELECT '[5-10>' AS BIN, (SELECT COUNT(SESSION_ID) FROM SESSIONS WHERE DURATION >= 300 AND DURATION < 600 )AS TOTAL UNION SELECT '[10-15>' AS BIN, (SELECT COUNT(SESSION_ID) FROM SESSIONS WHERE DURATION >=600 AND DURATION < 900)AS TOTAL UNION SELECT '15 or more' AS BIN, (SELECT COUNT(SESSION_ID) FROM SESSIONS WHERE DURATION >=900)"
99,Y,N,"SELECT '[0-5>' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION < 300 UNION SELECT '[5-10>' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION > 300 AND DURATION < 600 UNION SELECT '[10-15>' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION > 600 AND DURATION <900 UNION SELECT '15 or more' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION > 900"
100,Y,Y,"SELECT '[0-5>' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION>=0 AND DURATION < 300 UNION SELECT '[5-10>' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION>=300 AND DURATION < 600 UNION SELECT '[10-15>' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION>=600 AND DURATION < 900 UNION SELECT '15 or more' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION >= 900"
101,Y,N,"SELECT '[0-5>' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION/60<5 UNION ALL SELECT '[5-10>' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION/60 BETWEEN 5 AND 10 UNION ALL SELECT '[10-15>' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION/60 BETWEEN 10 AND 15 UNION ALL SELECT '15 or more' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION/60>=15"
102,Y,Y,"SELECT '[0-5>' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION<300 UNION SELECT '[5-10>' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION >= 300 AND DURATION < 600 UNION SELECT '[10-15>' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION >= 600 AND DURATION < 900 UNION SELECT '15 or more' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION >= 900"
103,Y,Y,"SELECT '[0-5>' AS BIN, COUNT(CASE WHEN (DURATION/60) >= 0 AND (DURATION/60) < 5 THEN SESSION_ID END) AS TOTAL FROM SESSIONS S UNION ALL SELECT '[5-10>' AS BIN, COUNT(CASE WHEN (DURATION/60) >= 5 AND (DURATION/60) < 10 THEN SESSION_ID END) AS TOTAL FROM SESSIONS S UNION ALL SELECT '[10-15>' AS BIN, COUNT(CASE WHEN (DURATION/60) >= 10 AND (DURATION/60) < 15 THEN SESSION_ID END) AS TOTAL FROM SESSIONS S UNION ALL SELECT '15 or more' AS BIN, COUNT(CASE WHEN (DURATION/60) >= 15 THEN SESSION_ID END) AS TOTAL FROM SESSIONS S"
104,Y,Y,"SELECT '[0-5>' AS BIN, COUNT(CASE WHEN DURATION < 300 THEN 1 ELSE NULL END) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN, COUNT(CASE WHEN DURATION >= 300 AND DURATION < 600 THEN 1 ELSE NULL END) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN, COUNT(CASE WHEN DURATION >= 600 AND DURATION < 900 THEN 1 ELSE NULL END) AS TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN, COUNT(CASE WHEN DURATION >= 900 THEN 1 ELSE NULL END) AS TOTAL FROM SESSIONS"
105,Y,Y,"SELECT '[0-5>' AS BIN, COUNT(CASE WHEN DURATION <300 THEN SESSION_ID END) AS TOTAL FROM SESSIONS UNION ALL SELECT '[5-10>' AS BIN, COUNT(CASE WHEN DURATION >=300 AND DURATION<600 THEN SESSION_ID END) AS TOTAL FROM SESSIONS UNION ALL SELECT '[10-15>' AS BIN, COUNT(CASE WHEN DURATION >=600 AND DURATION<900 THEN SESSION_ID END) AS TOTAL FROM SESSIONS UNION ALL SELECT '15 or more' AS BIN, COUNT(CASE WHEN DURATION >=900 THEN SESSION_ID END) AS TOTAL FROM SESSIONS"
106,Y,Y,"SELECT '[0-5>' AS BIN, COUNT(CASE WHEN DURATION/60 >=0 AND DURATION/60<5 THEN SESSION_ID END) TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN, COUNT(CASE WHEN DURATION/60 >=5 AND DURATION/60<10 THEN SESSION_ID END) TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN , COUNT(CASE WHEN DURATION/60 >=10 AND DURATION/60<15 THEN SESSION_ID END) TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN , COUNT(CASE WHEN DURATION/60 >=15 THEN SESSION_ID END) TOTAL FROM SESSIONS"
107,Y,Y,"SELECT '[0-5>' AS BIN, COUNT(CASE WHEN DURATION/60<5 AND DURATION/60>=0 THEN SESSION_ID END) AS TOTAL FROM SESSIONS UNION ALL SELECT '[5-10>' AS BIN, COUNT(CASE WHEN DURATION/60>=5 AND DURATION/60<10 THEN SESSION_ID END) AS TOTAL FROM SESSIONS UNION ALL SELECT '[10-15>' AS BIN, COUNT(CASE WHEN DURATION/60>=10 AND DURATION/60<15 THEN SESSION_ID END)AS TOTAL FROM SESSIONS UNION ALL SELECT '15 or more' AS BIN, COUNT(CASE WHEN DURATION/60>=15 THEN SESSION_ID END)AS TOTAL FROM SESSIONS"
108,Y,N,"SELECT '[0-5>' AS BIN, COUNT(CASE WHEN DURATION>=0 AND DURATION <300 THEN 1 END) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN, COUNT(CASE WHEN DURATION>=301 AND DURATION <600 THEN 1 END) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN, COUNT(CASE WHEN DURATION>=601 AND DURATION <900 THEN 1 END) AS TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN, COUNT(CASE WHEN DURATION>=901 THEN 1 END) AS TOTAL FROM SESSIONS"
109,Y,Y,"SELECT '[0-5>' AS BIN, COUNT(IF(DURATION < 300,1,NULL)) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN, COUNT(IF(DURATION >= 300 AND DURATION < 600,1,NULL)) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN, COUNT(IF(DURATION >= 600 AND DURATION < 900,1,NULL)) AS TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN, COUNT(IF(DURATION >= 900,1,NULL)) AS TOTAL FROM SESSIONS"
110,Y,Y,"SELECT '[0-5>' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION < 300 UNION SELECT '[5-10>' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION >= 300 AND DURATION < 600 UNION SELECT '[10-15>' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION >= 600 AND DURATION < 900 UNION SELECT '15 or more' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION >= 900"
111,Y,Y,"SELECT '[0-5>' AS BIN, SUM(CASE WHEN DURATION < 300 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION ALL SELECT '[5-10>' AS BIN, SUM(CASE WHEN DURATION < 600 AND DURATION >= 300 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION ALL SELECT '[10-15>' AS BIN, SUM(CASE WHEN DURATION < 900 AND DURATION >= 600 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION ALL SELECT '15 or more' AS BIN, SUM(CASE WHEN DURATION >= 900 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS"
112,Y,N,"SELECT '[0-5>' AS BIN, SUM(CASE WHEN DURATION <= 300 AND DURATION > 0 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN, SUM(CASE WHEN DURATION <= 600 AND DURATION > 300 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN, SUM(CASE WHEN DURATION <= 900 AND DURATION > 600 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN, SUM(CASE WHEN DURATION > 900 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS"
113,Y,Y,"SELECT '[0-5>' AS BIN, SUM(IF(DURATION<300 AND DURATION>=0,1,0)) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN, SUM(IF(DURATION<600 AND DURATION>=300,1,0)) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN, SUM(IF(DURATION<900 AND DURATION>=600,1,0)) AS TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN, SUM(IF(DURATION>=900,1,0)) AS TOTAL FROM SESSIONS"
114,Y,Y,"SELECT '[0-5>' AS BIN,COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION / 60 >= 0 AND DURATION / 60 < 5 UNION SELECT '[5-10>' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION / 60 >= 5 AND DURATION / 60 < 10 UNION SELECT '[10-15>' AS BIN,COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION / 60 >= 10 AND DURATION / 60 < 15 UNION SELECT '15 or more' AS BIN,COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION / 60 >= 15"
115,Y,N,"SELECT '[0-5>' AS BIN,COUNT(*) TOTAL FROM SESSIONS WHERE DURATION <5*60 UNION SELECT '[5-10>' AS BIN,COUNT(*) TOTAL FROM SESSIONS WHERE DURATION >=5*60 AND DURATION <=10*60 UNION SELECT '[10-15>' AS BIN,COUNT(*) TOTAL FROM SESSIONS WHERE DURATION >=10*60 AND DURATION <=15*60 UNION SELECT '15 or more' AS BIN,COUNT(*) TOTAL FROM SESSIONS WHERE DURATION >=15*60"
116,Y,Y,"SELECT '[0-5>' AS BIN,COUNT(CASE WHEN DURATION/60 < 5 AND DURATION/60 >= 0 THEN 1 END) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN,COUNT(CASE WHEN DURATION/60 < 10 AND DURATION/60 >= 5 THEN 1 END) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN,COUNT(CASE WHEN DURATION/60 < 15 AND DURATION/60 >= 10 THEN 1 END) AS TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN,COUNT(CASE WHEN DURATION/60 >= 15 THEN 1 END) AS TOTAL FROM SESSIONS"
117,Y,N,"SELECT '[0-5>' BIN, COUNT(IF(DURATION < 300, 1, NULL)) TOTAL FROM SESSIONS UNION SELECT '[5-10>' BIN, COUNT(IF (DURATION >= 300 AND DURATION < 600, 1, NULL)) TOTAL FROM SESSIONS UNION SELECT '[10-15>' BIN, COUNT(IF (DURATION >= 600 AND DURATION < 900, 1, NULL)) TOTAL FROM SESSIONS UNION SELECT '15 or more' BIN, COUNT(IF (DURATION > 900, 1, NULL)) TOTAL FROM SESSIONS"
118,Y,N,"SELECT '[0-5>' BIN, SUM(CASE WHEN DURATION/60 BETWEEN 0 AND 5 THEN 1 ELSE 0 END) TOTAL FROM SESSIONS UNION SELECT '[5-10>' BIN, SUM(CASE WHEN DURATION/60 BETWEEN 5 AND 10 THEN 1 ELSE 0 END) TOTAL FROM SESSIONS UNION SELECT '[10-15>' BIN, SUM(CASE WHEN DURATION/60 BETWEEN 10 AND 15 THEN 1 ELSE 0 END) TOTAL FROM SESSIONS UNION SELECT '15 or more' BIN, SUM(CASE WHEN DURATION/60 >=15 THEN 1 ELSE 0 END) TOTAL FROM SESSIONS"
119,Y,Y,"SELECT A.BIN ,IFNULL(B.TOTAL,0) AS TOTAL FROM( SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more' AS BOIN ) A LEFT JOIN( SELECT CASE WHEN DURATION >=0 AND DURATION < 5*60 THEN '[0-5>' WHEN DURATION >=5*60 AND DURATION < 10*60 THEN '[5-10>' WHEN DURATION >=10*60 AND DURATION < 15*60 THEN '[10-15>' ELSE '15 or more' END AS BIN ,COUNT(SESSION_ID) AS TOTAL FROM SESSIONS GROUP BY BIN ) B ON A.BIN = B.BIN"
120,Y,Y,"SELECT T2.BIN, IFNULL(T1.TOTAL,0) AS TOTAL FROM (SELECT CASE WHEN DURATION/60 >= 15 THEN '15 or more' WHEN DURATION/60 >=10 AND DURATION/60 < 15 THEN '[10-15>' WHEN DURATION/60 >=5 AND DURATION/60 < 10 THEN '[5-10>' WHEN DURATION/60 >=0 AND DURATION/60 < 5 THEN '[0-5>' END AS BIN ,COUNT(SESSION_ID) AS TOTAL FROM SESSIONS GROUP BY BIN) T1 RIGHT JOIN ( SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more' AS BIN ) T2 ON T1.BIN=T2.BIN"
121,Y,Y,"SELECT T_TOP.BIN, IFNULL(T2.TOTAL,0) AS TOTAL FROM ( SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN ) AS T_TOP LEFT JOIN ( SELECT T.BIN, IFNULL(COUNT(*),0) AS TOTAL FROM ( SELECT SESSION_ID, CASE WHEN DURATION/60 >= 0 AND DURATION/60 < 5 THEN '[0-5>' WHEN DURATION/60 >= 5 AND DURATION/60 < 10 THEN '[5-10>' WHEN DURATION/60 >= 10 AND DURATION/60 < 15 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS ) AS T GROUP BY T.BIN ) AS T2 ON T_TOP.BIN = T2.BIN"
122,Y,Y,"SELECT X.BIN, COALESCE(TOT,0) AS TOTAL FROM (SELECT '[0-5>' AS BIN FROM SESSIONS UNION SELECT '[5-10>' AS BIN FROM SESSIONS UNION SELECT '[10-15>' AS BIN FROM SESSIONS UNION SELECT '15 or more' AS BIN FROM SESSIONS) AS X LEFT JOIN (SELECT CASE WHEN DURATION>0 AND DURATION<300 THEN '[0-5>' WHEN DURATION>=300 AND DURATION<600 THEN '[5-10>' WHEN DURATION>=600 AND DURATION<900 THEN '[10-15>' ELSE '15 or more' END AS BIN, COUNT(*) AS TOT FROM SESSIONS GROUP BY BIN) AS Y ON X.BIN = Y.BIN"
123,Y,N,"SELECT A.BIN AS BIN, IFNULL(COUNT(SESSION_ID),0) AS TOTAL FROM (SELECT SESSION_ID, CASE WHEN DURATION/60 >=0 AND DURATION/60 <5 THEN '[0-5>' WHEN DURATION/60 BETWEEN 5 AND 10 THEN '[5-10>' WHEN DURATION/60 BETWEEN 10 AND 15 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS) SQ RIGHT JOIN ( SELECT BIN FROM (SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN) D ) A ON A.BIN = SQ.BIN GROUP BY A.BIN"
124,Y,Y,"SELECT A.BIN, COALESCE(B.TOTAL,0) AS TOTAL FROM (SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' UNION SELECT '[10-15>' UNION SELECT '15 or more') A LEFT JOIN (SELECT CASE WHEN DURATION < 5*60 THEN '[0-5>' WHEN DURATION >=5*60 AND DURATION<10*60 THEN '[5-10>' WHEN DURATION >=10*60 AND DURATION<15*60 THEN '[10-15>' ELSE '15 or more' END BIN, COUNT(*) TOTAL FROM SESSIONS GROUP BY 1)B ON A.BIN = B.BIN"
125,Y,Y,"SELECT A.BIN, COALESCE(B.TOTAL,0) TOTAL FROM ( SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN ) A LEFT JOIN (SELECT A.BIN, COUNT(*) AS TOTAL FROM (SELECT (CASE WHEN DURATION/60<5 THEN '[0-5>' WHEN DURATION/60<10 THEN '[5-10>' WHEN DURATION/60<15 THEN '[10-15>' ELSE '15 or more' END) BIN, SESSION_ID FROM SESSIONS) A GROUP BY BIN) B ON A.BIN=B.BIN"
126,Y,Y,"SELECT A.BIN, IFNULL(TOTAL,0) AS TOTAL FROM (SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN) AS A LEFT JOIN (SELECT CASE WHEN (DURATION/60)<5 THEN '[0-5>' WHEN (DURATION/60)<10 THEN '[5-10>' WHEN (DURATION/60)<15 THEN '[10-15>' ELSE '15 or more' END AS BIN, COUNT(1) AS TOTAL FROM SESSIONS GROUP BY CASE WHEN (DURATION/60)<5 THEN '[0-5>' WHEN (DURATION/60)<10 THEN '[5-10>' WHEN (DURATION/60)<15 THEN '[10-15>' ELSE '15 or more' END) AS B ON A.BIN=B.BIN"
127,Y,Y,"SELECT B.BIN, COALESCE(T.TOTAL,0) AS TOTAL FROM (SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more') B LEFT JOIN (SELECT BIN, COUNT(BIN) AS TOTAL FROM (SELECT CASE WHEN DURATION/60 <5 THEN '[0-5>' WHEN DURATION/60 >= 5 AND DURATION/60 <10 THEN '[5-10>' WHEN DURATION/60 >= 10 AND DURATION/60 <15 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS ) BT GROUP BY BIN) T ON B.BIN = T.BIN"
128,Y,Y,"SELECT B.BIN, COUNT(A.SESSION_ID) AS TOTAL FROM (SELECT SESSION_ID, CASE WHEN DURATION/60 < 5 THEN '[0-5>' WHEN 5 <= DURATION/60 AND DURATION/60 < 10 THEN '[5-10>' WHEN 10 <= DURATION/60 AND DURATION/60 < 15 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS) AS A RIGHT JOIN (SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN) AS B ON A.BIN = B.BIN GROUP BY B.BIN"
129,Y,Y,"SELECT B.BIN, COUNT(DISTINCT SESSION_ID) AS TOTAL FROM SESSIONS S RIGHT JOIN (SELECT '[0-5>' AS BIN, '0' AS BEGIN, '300' AS FINISH UNION ALL SELECT '[5-10>' AS BIN, '300' AS BEGIN, '600' AS FINISH UNION ALL SELECT '[10-15>' AS BIN, '600' AS BEGIN, '900' AS FINISH UNION ALL SELECT '15 or more' AS BIN, '900' AS BEGIN, '10000000000' AS FINISH) AS B ON S.DURATION >= B.BEGIN AND S.DURATION < B.FINISH GROUP BY B.BIN"
130,Y,Y,"SELECT B.BIN, COUNT(S.BIN) TOTAL FROM (SELECT CASE WHEN DURATION/60 < 5 THEN '[0-5>' WHEN DURATION/60 < 10 THEN '[5-10>' WHEN DURATION/60 < 15 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS) S RIGHT JOIN ( SELECT '[0-5>' BIN UNION SELECT '[5-10>' BIN UNION SELECT '[10-15>' BIN UNION SELECT '15 or more' BIN ) B USING(BIN) GROUP BY B.BIN"
131,Y,Y,"SELECT B.BIN, IFNULL(TOTAL,0) TOTAL FROM (SELECT CASE WHEN DURATION/60 >= 0 AND DURATION/60 < 5 THEN '[0-5>' WHEN DURATION/60 >= 5 AND DURATION/60 < 10 THEN '[5-10>' WHEN DURATION/60 >= 10 AND DURATION/60 < 15 THEN '[10-15>' ELSE '15 or more' END BIN, COUNT(DISTINCT SESSION_ID) TOTAL FROM SESSIONS GROUP BY BIN) A RIGHT JOIN ( SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN) B ON A.BIN = B.BIN"
132,Y,Y,"SELECT BINS.BIN AS BIN, COALESCE(TOTAL, 0) AS TOTAL FROM( SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN ) AS BINS LEFT JOIN (SELECT BIN, COUNT(BIN) AS TOTAL FROM ( SELECT CASE WHEN DURATION<300 THEN '[0-5>' WHEN DURATION>=300 AND DURATION<600 THEN '[5-10>' WHEN DURATION>=600 AND DURATION<900 THEN '[10-15>' WHEN DURATION>=900 THEN '15 or more' END AS BIN FROM SESSIONS ) AS A GROUP BY BIN) AS TRANS ON BINS.BIN = TRANS.BIN"
133,Y,Y,"SELECT BINS.BIN AS BIN, COALESCE(TOTAL, 0) AS TOTAL FROM( SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN ) AS BINS LEFT JOIN (SELECT BIN, COUNT(BIN) AS TOTAL FROM ( SELECT CASE WHEN DURATION<5*60 THEN '[0-5>' WHEN DURATION>=5*60 AND DURATION<10*60 THEN '[5-10>' WHEN DURATION>=10*60 AND DURATION<15*60 THEN '[10-15>' WHEN DURATION>=15*60 THEN '15 or more' END AS BIN FROM SESSIONS ) AS A GROUP BY BIN) AS TRANS ON BINS.BIN = TRANS.BIN"
134,Y,N,"SELECT T2.BIN, COUNT(T1.BIN) AS TOTAL FROM (SELECT CASE WHEN DURATION/60 BETWEEN 0 AND 5 THEN '[0-5>' WHEN DURATION/60 BETWEEN 5 AND 10 THEN '[5-10>' WHEN DURATION/60 BETWEEN 10 AND 15 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS) T1 RIGHT JOIN (SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more' AS BIN ) T2 ON T1.BIN = T2.BIN GROUP BY T2.BIN"
135,Y,Y,"SELECT TAB2.BIN, IFNULL(COUNT(TAB1.SESSION_ID),0)AS TOTAL FROM (SELECT SESSION_ID, DURATION, CASE WHEN DURATION<300 THEN '[0-5>' WHEN DURATION<600 AND DURATION >=300 THEN '[5-10>' WHEN DURATION<900 AND DURATION >=600 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS) AS TAB1 RIGHT JOIN (SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN) AS TAB2 ON TAB2.BIN=TAB1.BIN GROUP BY 1"
136,Y,Y,"SELECT TEMP.BIN, COUNT(X.SESSION_ID) AS TOTAL FROM (SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN) AS TEMP LEFT JOIN (SELECT SESSION_ID, DURATION, CASE WHEN DURATION/60 < 5 THEN '[0-5>' WHEN (5 <= DURATION/60 AND DURATION/60 < 10) THEN '[5-10>' WHEN (10 <= DURATION/60 AND DURATION/60 < 15) THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS) AS X ON TEMP.BIN = X.BIN GROUP BY TEMP.BIN"
137,Y,Y,"SELECT X.BIN, IFNULL(Y.TOTAL,0) AS TOTAL FROM(SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more' AS BIN) X LEFT JOIN (SELECT BIN, IFNULL(COUNT(DISTINCT SESSION_ID),0) AS TOTAL FROM(SELECT SESSION_ID, CASE WHEN DURATION/60 >= 0 AND DURATION/60 < 5 THEN '[0-5>' WHEN DURATION/60 >= 5 AND DURATION/60 < 10 THEN '[5-10>' WHEN DURATION/60 >= 10 AND DURATION/60 < 15 THEN '[10-15>' WHEN DURATION/60 >= 15 THEN '15 or more' END AS BIN FROM SESSIONS)X GROUP BY 1) Y ON X.BIN = Y.BIN"
138,Y,Y,"WITH CTE AS ( SELECT SESSION_ID, ROUND(DURATION/60,2) AS MINUTES FROM SESSIONS) (SELECT '[0-5>' AS BIN, SUM(CASE WHEN MINUTES >=0 AND MINUTES<5 THEN 1 ELSE 0 END) AS TOTAL FROM CTE) UNION (SELECT '[5-10>' AS BIN, SUM(CASE WHEN MINUTES >= 5 AND MINUTES<10 THEN 1 ELSE 0 END) AS TOTAL FROM CTE) UNION (SELECT '[10-15>' AS BIN, SUM(CASE WHEN MINUTES >=10 AND MINUTES <15 THEN 1 ELSE 0 END) AS TOTAL FROM CTE) UNION (SELECT '15 or more' AS BIN, SUM(CASE WHEN MINUTES >=15 THEN 1 ELSE 0 END) AS TOTAL FROM CTE)"
139,Y,Y,"WITH CTE1 AS ( SELECT SESSION_ID, CASE WHEN DURATION/60>= 0 AND DURATION/60<5 THEN '[0-5>' WHEN DURATION/60>= 5 AND DURATION/60<10 THEN '[5-10>' WHEN DURATION/60>=10 AND DURATION/60<15 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS), CTE2 AS ( SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN ) SELECT B.BIN AS BIN, COALESCE(COUNT(SESSION_ID),0) AS TOTAL FROM CTE1 A RIGHT JOIN CTE2 B ON A.BIN=B.BIN GROUP BY B.BIN"
140,Y,Y,"WITH B AS(SELECT '[0-5>' AS BIN UNION SELECT'[5-10>' AS BIN UNION SELECT'[10-15>'AS BIN UNION SELECT'15 or more'AS BIN) SELECT B.BIN, COUNT(SESSION_ID) TOTAL FROM (SELECT SESSION_ID,(CASE WHEN DURATION/60<5 THEN '[0-5>' WHEN DURATION/60>=5 AND DURATION/60<10 THEN '[5-10>' WHEN DURATION/60>=10 AND DURATION/60<15 THEN '[10-15>' WHEN DURATION/60>=15 THEN '15 or more' END) BIN FROM SESSIONS) S RIGHT JOIN B USING(BIN) GROUP BY B.BIN"
141,Y,Y,"WITH BINNED_SESSIONS AS ( SELECT *, CASE WHEN DURATION < 300 THEN '[0-5>' WHEN DURATION < 600 THEN '[5-10>' WHEN DURATION < 900 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS ), ALL_BINS AS ( SELECT * FROM ( SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' UNION ALL SELECT '[10-15>' UNION ALL SELECT '15 or more' ) AS A ), BIN_COUNTS AS ( SELECT BIN, COUNT(*) AS TOTAL FROM BINNED_SESSIONS GROUP BY BIN ) SELECT A.BIN, COALESCE(B.TOTAL, 0) AS TOTAL FROM ALL_BINS AS A LEFT JOIN BIN_COUNTS AS B ON A.BIN = B.BIN"
142,Y,Y,"WITH BINS AS ( SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN ), GROUPED AS ( SELECT BIN,COUNT(SESSION_ID) AS TOTAL FROM( SELECT SESSION_ID, CASE WHEN (DURATION/60) <5 THEN '[0-5>' WHEN (DURATION/60)<10 THEN '[5-10>' WHEN (DURATION/60)<15 THEN '[10-15>' WHEN (DURATION/60)>=15 THEN '15 or more' END AS BIN FROM SESSIONS) T GROUP BY BIN ) SELECT BINS.BIN AS BIN,IFNULL(GROUPED.TOTAL,0) AS TOTAL FROM BINS LEFT JOIN GROUPED ON BINS.BIN=GROUPED.BIN"
143,Y,Y,"WITH BINS AS( SELECT '[0-5>' AS BIN, 0 AS MIN,5 AS MAX,1 AS OD UNION ALL SELECT '15 or more' AS BIN, 15 AS MIN,NULL AS MAX,4 AS OD UNION ALL SELECT '[5-10>' AS BIN, 5 AS MIN,10 AS MAX,2 AS OD UNION ALL SELECT '[10-15>' AS BIN, 10 AS MIN,15 AS MAX,3 AS OD ) SELECT BIN AS BIN,COUNT(SESSION_ID) AS TOTAL FROM BINS B LEFT JOIN SESSIONS S ON S.DURATION/60.0 >= B.MIN AND ( B.MAX IS NULL OR S.DURATION/60.0 < B.MAX ) GROUP BY 1 ORDER BY OD"
144,Y,Y,"WITH CTE AS ( SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' UNION ALL SELECT '[10-15>' UNION ALL SELECT '15 or more' ) SELECT CTE.BIN, IFNULL(A.TOTAL,0) AS TOTAL FROM(SELECT (CASE WHEN DURATION < 300 THEN '[0-5>' WHEN DURATION >=300 AND DURATION < 600 THEN '[5-10>' WHEN DURATION >=600 AND DURATION < 900 THEN '[10-15>' ELSE '15 or more' END) BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS GROUP BY 1) A RIGHT JOIN CTE USING (BIN)"
145,Y,Y,"WITH CTE AS ( SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more' AS BIN) SELECT A.BIN, IFNULL(TOTAL,0) AS TOTAL FROM CTE AS A LEFT JOIN ( SELECT CASE WHEN DURATION/60 < 5 THEN '[0-5>' WHEN DURATION/60 < 10 THEN '[5-10>' WHEN DURATION/60 < 15 THEN '[10-15>' ELSE '15 or more' END AS BIN, COUNT(DISTINCT SESSION_ID) AS TOTAL FROM SESSIONS GROUP BY 1 ) AS B ON A.BIN = B.BIN GROUP BY 1"
146,Y,Y,"WITH CTE AS ( SELECT SESSION_ID , CASE WHEN DURATION>=0*60 AND DURATION<5*60 THEN '[0-5>' WHEN DURATION>=5*60 AND DURATION<10*60 THEN '[5-10>' WHEN DURATION>=10*60 AND DURATION<15*60 THEN '[10-15>' WHEN DURATION>=15*60 THEN '15 or more' END AS BIN FROM SESSIONS), CTE2 AS ( SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more' AS BIN ) SELECT C2.BIN , COALESCE(COUNT(C.SESSION_ID),0) AS TOTAL FROM CTE2 C2 LEFT JOIN CTE C ON C2.BIN=C.BIN GROUP BY 1"
147,Y,N,"WITH CTE AS ( SELECT SESSION_ID, CASE WHEN DURATION BETWEEN 0 AND 5*60 THEN '[0-5>' WHEN DURATION BETWEEN 5*60+1 AND 10*60 THEN '[5-10>' WHEN DURATION BETWEEN 601 AND 15* 60 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS) , BINS AS ( SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more' AS BIN ) , SUMMARY AS ( SELECT BIN, COUNT( SESSION_ID) AS TOTAL FROM CTE GROUP BY 1) SELECT B. BIN AS BIN, IFNULL(TOTAL,0) AS TOTAL FROM BINS B LEFT JOIN SUMMARY S ON B.BIN = S.BIN"
148,Y,Y,"WITH CTE AS (SELECT SESSION_ID, ( CASE WHEN (DURATION/60) <5 THEN '[0-5>' WHEN (DURATION/60) <10 THEN '[5-10>' WHEN (DURATION/60) <15 THEN '[10-15>' WHEN (DURATION/60) >=15 THEN '15 or more' END ) AS BIN FROM SESSIONS), CTE2 AS( SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN ) SELECT CTE2.BIN, COUNT(SESSION_ID) AS TOTAL FROM CTE2 LEFT JOIN CTE USING(BIN) GROUP BY 1"
149,Y,Y,"WITH CTE AS( SELECT '[0-5>' AS BIN, 0 AS MIN_DURATION, 5*60 AS MAX_DURATION UNION ALL SELECT '[5-10>' AS BIN, 5*60 AS MIN_DURATION, 10*60 AS MAX_DURATION UNION ALL SELECT '[10-15>' AS BIN, 10*60 AS MIN_DURATION, 15*60 AS MAX_DURATION UNION ALL SELECT '15 or more' AS BIN, 15*60 AS MIN_DURATION, 2147483647 AS MAX_DURATION ) SELECT CTE.BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS RIGHT JOIN CTE ON SESSIONS.DURATION >= MIN_DURATION AND SESSIONS.DURATION < MAX_DURATION GROUP BY CTE.BIN"
150,Y,Y,"WITH CTE1 AS ( SELECT SESSION_ID, CASE WHEN DURATION/60 < 5 THEN '[0-5>' WHEN DURATION/60 <10 THEN '[5-10>' WHEN DURATION/60 <15 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS), CTE2 AS( SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' UNION SELECT '[10-15>' UNION SELECT '15 or more') SELECT CTE2.BIN, IFNULL (COUNT(CTE1.SESSION_ID),0) AS TOTAL FROM CTE2 LEFT JOIN CTE1 ON CTE2.BIN = CTE1.BIN GROUP BY 1"
151,Y,Y,"WITH CTE1 AS (SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN), CTE2 AS (SELECT SESSION_ID, CASE WHEN DURATION/60>=0 AND DURATION/60 <5 THEN '[0-5>' WHEN DURATION/60>= 5 AND DURATION/60<10 THEN '[5-10>' WHEN DURATION/60>=10 AND DURATION/60<15 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS) SELECT DISTINCT A.BIN, IFNULL(COUNT(SESSION_ID),0) AS TOTAL FROM CTE1 A LEFT JOIN CTE2 B ON A.BIN=B.BIN GROUP BY A.BIN"
152,Y,Y,"WITH CTE1 AS (SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN), CTE2 AS (SELECT SESSION_ID, CASE WHEN DURATION/60>=0 AND DURATION/60 <5 THEN '[0-5>' WHEN DURATION/60>= 5 AND DURATION/60<10 THEN '[5-10>' WHEN DURATION/60>=10 AND DURATION/60<15 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS) SELECT DISTINCT A.BIN, IFNULL(COUNT(SESSION_ID),0) AS TOTAL FROM CTE1 A LEFT JOIN CTE2 B ON A.BIN=B.BIN GROUP BY A.BIN"
153,Y,Y,"WITH CTE1 AS( SELECT SESSION_ID, CASE WHEN DURATION < 300 THEN '[0-5>' WHEN DURATION >=300 AND DURATION < 600 THEN '[5-10>' WHEN DURATION >= 600 AND DURATION < 900 THEN '[10-15>' WHEN DURATION >= 900 THEN '15 or more' END AS BIN FROM SESSIONS GROUP BY SESSION_ID ) ,CTE2 AS(SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more' AS BIN) SELECT CTE2.BIN AS BIN, IFNULL(COUNT(CTE1.SESSION_ID),0) AS TOTAL FROM CTE2 LEFT JOIN CTE1 ON CTE2.BIN = CTE1.BIN GROUP BY CTE2.BIN"
154,Y,Y,"WITH CTE_BINS AS ( SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN ), CTE_JOIN_AGG AS ( SELECT B.BIN, COUNT(SESSION_ID) AS TOTAL FROM CTE_BINS AS B LEFT JOIN SESSIONS AS S ON B.BIN = ( CASE WHEN DURATION/60 >= 0 AND DURATION/60 < 5 THEN '[0-5>' WHEN DURATION/60 >= 5 AND DURATION/60 < 10 THEN '[5-10>' WHEN DURATION/60 >= 10 AND DURATION/60 < 15 THEN '[10-15>' ELSE '15 or more' END ) GROUP BY 1 ) SELECT * FROM CTE_JOIN_AGG"
155,Y,N,"WITH CTE_BINS AS ( SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' UNION SELECT '[10-15>' UNION SELECT '15 or more'), CTE_JOIN AS (SELECT SESSION_ID, CASE WHEN DURATION BETWEEN 0 AND 300 THEN '[0-5>' WHEN DURATION BETWEEN 300 AND 600 THEN '[5-10>' WHEN DURATION BETWEEN 600 AND 900 THEN '[10-15>' WHEN DURATION BETWEEN 600 AND 900 THEN '[10-15>' WHEN DURATION > 900 THEN '15 or more' ELSE 0 END AS BIN FROM SESSIONS) SELECT CB.BIN, COALESCE(COUNT(SESSION_ID),0) AS TOTAL FROM CTE_BINS CB LEFT JOIN CTE_JOIN CJ ON CB.BIN = CJ.BIN GROUP BY CB.BIN"
156,Y,Y,"WITH IND AS (SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more' AS BIN), BASE AS (SELECT BIN, COUNT(DISTINCT SESSION_ID) AS TOTAL FROM (SELECT SESSION_ID, CASE WHEN DURATION>=0 AND DURATION <5*60 THEN '[0-5>' WHEN DURATION<10*60 THEN '[5-10>' WHEN DURATION<15*60 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS) A GROUP BY 1) SELECT I.BIN, IFNULL(B.TOTAL,0) AS TOTAL FROM IND I LEFT JOIN BASE B ON I.BIN = B.BIN"
157,Y,Y,"WITH SESSTABLE AS( SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more' AS BIN ) SELECT S.BIN,COUNT(D.SESSION_ID) AS TOTAL FROM SESSTABLE AS S LEFT JOIN ( SELECT SESSION_ID, CASE WHEN DURATION/60<5 THEN '[0-5>' WHEN DURATION/60<10 THEN '[5-10>' WHEN DURATION/60<15 THEN '[10-15>' ELSE '15 or more' END AS BINNAME FROM SESSIONS )D ON S.BIN=D.BINNAME GROUP BY S.BIN"
158,Y,Y,"WITH T AS ( SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more' AS BIN) SELECT T.*, COALESCE(K.TOTAL,0) AS TOTAL FROM T LEFT JOIN ( SELECT CASE WHEN (DURATION/60) <5 THEN '[0-5>' WHEN (DURATION/60 >=5 AND DURATION/60<10) THEN '[5-10>' WHEN (DURATION/60 >=10 AND DURATION/60<15) THEN '[10-15>' WHEN (DURATION/60 >=15) THEN '15 or more' END AS BIN, COALESCE (COUNT(SESSION_ID),0) AS TOTAL FROM SESSIONS GROUP BY BIN) K ON T.BIN=K.BIN"
159,Y,Y,"WITH T AS (SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' UNION ALL SELECT '[10-15>' UNION ALL SELECT '15 or more') SELECT T.BIN, COUNT(S.SESSION_ID) AS TOTAL FROM (SELECT SESSION_ID, CASE WHEN DURATION/60<5 AND DURATION/60>=0 THEN '[0-5>' WHEN DURATION/60<10 AND DURATION/60>=5 THEN '[5-10>' WHEN DURATION/60<15 AND DURATION/60>=10 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS) S RIGHT JOIN T ON S.BIN=T.BIN GROUP BY 1"
160,Y,N,"WITH T AS (SELECT *, CASE WHEN (DURATION)>= 0 AND (DURATION) < 300 THEN '[0-5>' WHEN (DURATION) >= 300 AND (DURATION) < 600 THEN '[5-10>' WHEN (DURATION)>= 600 AND (DURATION)<= 900 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS), T2 AS (SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more' AS BIN ) SELECT T2.BIN, COALESCE(Z.CNT,0) AS TOTAL FROM T2 LEFT JOIN (SELECT T.BIN, COUNT(T.SESSION_ID) AS CNT FROM T GROUP BY T.BIN) Z ON T2.BIN= Z.BIN"
161,Y,Y,"WITH TEMP AS ( SELECT (CASE WHEN DURATION < 300 THEN '[0-5>' WHEN DURATION BETWEEN 0 AND 599 THEN '[5-10>' WHEN DURATION BETWEEN 0 AND 899 THEN '[10-15>' ELSE '15 or more' END) BIN, COUNT(*) AS TOTAL FROM SESSIONS GROUP BY 1), TEMP2 AS ( SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more' AS BIN) SELECT T2.BIN, IFNULL(T.TOTAL,0) AS TOTAL FROM TEMP2 T2 LEFT JOIN TEMP T ON T2.BIN=T.BIN"
162,Y,Y,"WITH TEMP1 AS ( SELECT *, CASE WHEN DURATION/60<5 THEN '[0-5>' WHEN DURATION/60<10 THEN '[5-10>' WHEN DURATION/60<15 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS ), TEMP2 AS ( SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more' AS BIN ) SELECT BIN, IFNULL(COUNT(SESSION_ID),0) AS TOTAL FROM TEMP2 LEFT JOIN TEMP1 USING (BIN) GROUP BY TEMP2.BIN"
163,Y,Y,"WITH TMP AS (SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more' AS BIN) SELECT A.BIN, IFNULL(TOTAL,0) AS TOTAL FROM TMP A LEFT JOIN ( SELECT CASE WHEN DURATION/60>=0 AND DURATION/60<5 THEN '[0-5>' WHEN DURATION/60>=5 AND DURATION/60<10 THEN '[5-10>' WHEN DURATION/60>=10 AND DURATION/60<15 THEN '[10-15>' WHEN DURATION/60>=15 THEN '15 or more' END AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS GROUP BY 1) B ON A.BIN=B.BIN"
164,Y,Y,"WITH TMP AS (SELECT (CASE WHEN DURATION < 300 THEN '[0-5>' WHEN DURATION < 600 THEN '[5-10>' WHEN DURATION < 900 THEN '[10-15>' ELSE '15 or more' END) AS BIN FROM SESSIONS), TMP1 AS (SELECT BIN, COUNT(*) AS TOTAL FROM TMP GROUP BY BIN), TMP2 AS ((SELECT '[0-5>' AS BIN) UNION (SELECT '[5-10>' AS BIN) UNION (SELECT '[10-15>' AS BIN) UNION (SELECT '15 or more' AS BIN)) SELECT A.BIN, IFNULL(TOTAL, 0) AS TOTAL FROM TMP2 A LEFT JOIN TMP1 B ON A.BIN = B.BIN"
165,Y,Y,"WITH TMP AS (SELECT SESSION_ID, CASE WHEN DURATION BETWEEN 0 AND 299 THEN '[0-5>' WHEN DURATION BETWEEN 300 AND 599 THEN '[5-10>' WHEN DURATION BETWEEN 600 AND 899 THEN '[10-15>' ELSE '15 or more' END BIN FROM SESSIONS ), TMP1 AS (SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more' AS BIN ) SELECT TMP1.BIN BIN, COALESCE(COUNT(SESSION_ID),0) TOTAL FROM TMP RIGHT JOIN TMP1 ON TMP.BIN = TMP1.BIN GROUP BY TMP1.BIN"
166,Y,Y,"SELECT '[0-5>' AS BIN, COUNT(SESSION_ID) TOTAL FROM SESSIONS WHERE DURATION/60<5 UNION SELECT '[5-10>' AS BIN, COUNT(SESSION_ID) TOTAL FROM SESSIONS WHERE DURATION/60>=5 AND DURATION/60<10 UNION SELECT '[10-15>' AS BIN, COUNT(SESSION_ID) TOTAL FROM SESSIONS WHERE DURATION/60<15 AND DURATION/60>=10 UNION SELECT '15 or more' AS BIN, COUNT(SESSION_ID) TOTAL FROM SESSIONS WHERE DURATION/60>=15"
167,Y,Y,"SELECT '[0-5>' AS BIN, SUM(DURATION < 300) AS TOTAL FROM SESSIONS UNION ALL SELECT '[5-10>' AS BIN, SUM(DURATION >= 300 AND DURATION < 600) AS TOTAL FROM SESSIONS UNION ALL SELECT '[10-15>' AS BIN, SUM(DURATION >= 600 AND DURATION < 900) AS TOTAL FROM SESSIONS UNION ALL SELECT '15 or more' AS BIN, SUM(DURATION >= 900) AS TOTAL FROM SESSIONS"
168,Y,N,"SELECT '[0-5>' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE (DURATION/60) < 5 UNION SELECT '[5-10>' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE (DURATION/60) BETWEEN 5 AND 10 UNION SELECT '[10-15>' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE (DURATION/60) BETWEEN 10 AND 15 UNION SELECT '15 or more' AS BIN , COUNT(*) AS TOTAL FROM SESSIONS WHERE (DURATION/60)>=15"
169,Y,Y,"WITH TMP AS( SELECT SESSION_ID, DURATION, CASE WHEN DURATION<300 THEN '[0-5>' WHEN DURATION<600 THEN '[5-10>' WHEN DURATION<900 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS ), TMP1 AS( SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' BIN UNION SELECT '[10-15>' BIN UNION SELECT '15 or more' BIN ) SELECT TMP1.BIN, COUNT(TMP.SESSION_ID) TOTAL FROM TMP1 LEFT JOIN TMP ON TMP1.BIN=TMP.BIN GROUP BY TMP1.BIN ORDER BY TMP1.BIN"
170,Y,Y,"SELECT '[0-5>' AS BIN, SUM((DURATION/60) < 5) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN, SUM((DURATION/60) >= 5 AND (DURATION/60) < 10) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN, SUM((DURATION/60) >= 10 AND (DURATION/60) < 15) AS TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN, SUM((DURATION/60) >= 15) AS TOTAL FROM SESSIONS"
171,Y,Y,"SELECT '[0-5>' AS BIN, SUM(CASE WHEN (DURATION / 60) < 5 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN, SUM(CASE WHEN (DURATION / 60) >= 5 AND (DURATION / 60) < 10 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN, SUM(CASE WHEN (DURATION / 60) >= 10 AND (DURATION / 60) < 15 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN, SUM(CASE WHEN (DURATION / 60) >= 15 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS"
172,Y,Y,"WITH TEMP AS ( SELECT CASE WHEN MINUTES >= 0 AND MINUTES < 5 THEN '[0-5>' WHEN MINUTES >= 5 AND MINUTES < 10 THEN '[5-10>' WHEN MINUTES >= 10 AND MINUTES < 15 THEN '[10-15>' WHEN MINUTES >= 15 THEN '15 or more' END AS BIN, COUNT(DISTINCT SESSION_ID) AS TOTAL FROM ( SELECT A.*, DURATION/60 AS MINUTES FROM SESSIONS A ) A GROUP BY 1 ), TEMP1 AS ( SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more' AS BIN ) SELECT A.*, CASE WHEN B.TOTAL IS NULL THEN 0 ELSE B.TOTAL END AS TOTAL FROM TEMP1 A LEFT JOIN TEMP B ON A.BIN = B.BIN"
173,Y,N,"SELECT '[0-5>' AS BIN, COUNT(DISTINCT CASE WHEN DURATION <=300 THEN SESSION_ID END) AS TOTAL FROM SESSIONS GROUP BY 1 UNION SELECT '[5-10>' AS BIN, COUNT(DISTINCT CASE WHEN DURATION BETWEEN 301 AND 600 THEN SESSION_ID END) AS TOTAL FROM SESSIONS GROUP BY 1 UNION SELECT '[10-15>' AS BIN, COUNT(DISTINCT CASE WHEN DURATION BETWEEN 601 AND 900 THEN SESSION_ID END) AS TOTAL FROM SESSIONS GROUP BY 1 UNION SELECT '15 or more' AS BIN, COUNT(DISTINCT CASE WHEN DURATION >900 THEN SESSION_ID END) AS TOTAL FROM SESSIONS GROUP BY 1"
174,Y,Y,"SELECT '[0-5>' AS BIN, COUNT(K.DURATION) AS TOTAL FROM (SELECT SESSION_ID, DURATION/60 AS DURATION FROM SESSIONS) K WHERE K.DURATION<5 UNION SELECT '[5-10>' AS BIN, COUNT(L.DURATION) AS TOTAL FROM (SELECT SESSION_ID, DURATION/60 AS DURATION FROM SESSIONS) L WHERE L.DURATION<10 AND L.DURATION>=5 UNION SELECT '[10-15>' AS BIN, COUNT(M.DURATION) AS TOTAL FROM (SELECT SESSION_ID, DURATION/60 AS DURATION FROM SESSIONS) M WHERE M.DURATION<15 AND M.DURATION>=10 UNION SELECT '15 or more' AS BIN, COUNT(N.DURATION) AS TOTAL FROM (SELECT SESSION_ID, DURATION/60 AS DURATION FROM SESSIONS) N WHERE N.DURATION>=15"
175,Y,Y,"SELECT '[0-5>' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION/60 <5 UNION SELECT '[5-10>' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION/60 >=5 AND DURATION/60 <10 UNION SELECT '[10-15>' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION/60 >=10 AND DURATION/60 <15 UNION SELECT '15 or more' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION/60 >=15"
176,Y,Y,"WITH TEMPLATE AS ( SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more' AS BIN ) SELECT A.BIN, IFNULL(B.TOTAL, 0) AS TOTAL FROM TEMPLATE AS A LEFT JOIN ( SELECT CASE WHEN DURATION/60 >= 0 AND DURATION/60 < 5 THEN '[0-5>' WHEN DURATION/60 >= 5 AND DURATION/60 < 10 THEN '[5-10>' WHEN DURATION/60 >= 10 AND DURATION/60 < 15 THEN '[10-15>' ELSE '15 or more' END AS BIN , COUNT(SESSION_ID) AS TOTAL FROM SESSIONS GROUP BY CASE WHEN DURATION/60 >= 0 AND DURATION/60 < 5 THEN '[0-5>' WHEN DURATION/60 >= 5 AND DURATION/60 < 10 THEN '[5-10>' WHEN DURATION/60 >= 10 AND DURATION/60 < 15 THEN '[10-15>' ELSE '15 or more' END ) AS B ON A.BIN = B.BIN"
177,Y,N,"SELECT '[0-5>' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION/60<5 UNION SELECT '[5-10>' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION/60 BETWEEN 5 AND 10 UNION SELECT '[10-15>' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION/60 BETWEEN 10 AND 15 UNION SELECT '15 or more' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION/60>=15"
178,Y,N,"SELECT '[0-5>' AS BIN, COUNT(CASE WHEN DURATION < 300 THEN SESSION_ID ELSE NULL END) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN, COUNT(CASE WHEN DURATION >= 300 AND DURATION < 600 THEN SESSION_ID ELSE NULL END) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN, COUNT(CASE WHEN DURATION >= 600 AND DURATION < 900 THEN SESSION_ID ELSE NULL END) AS TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN, COUNT(CASE WHEN DURATION > 900 THEN SESSION_ID ELSE NULL END) AS TOTAL FROM SESSIONS"
179,Y,Y,"WITH CTE1 AS ( SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN ), CTE2 AS ( SELECT SESSION_ID, DURATION, (CASE WHEN DURATION / 60 < 5 THEN '[0-5>' WHEN DURATION / 60 >= 5 AND DURATION / 60 < 10 THEN '[5-10>' WHEN DURATION / 60 >= 10 AND DURATION / 60 < 15 THEN '[10-15>' ELSE '15 or more' END) AS BIN FROM SESSIONS) SELECT CTE1.BIN, COUNT(CTE2.BIN) AS TOTAL FROM CTE1 LEFT OUTER JOIN CTE2 ON CTE1.BIN = CTE2.BIN GROUP BY CTE1.BIN"
180,Y,N,"SELECT '[0-5>' AS BIN,SUM(IF (DURATION/60 BETWEEN 0 AND 5, 1, 0)) TOTAL FROM SESSIONS UNION SELECT '[5-10>' ,SUM(CASE WHEN DURATION/60 BETWEEN 5 AND 10 THEN 1 ELSE 0 END) FROM SESSIONS UNION SELECT '[10-15>',SUM(CASE WHEN DURATION/60 BETWEEN 10 AND 15 THEN 1 ELSE 0 END) FROM SESSIONS UNION SELECT '15 or more' ,SUM(CASE WHEN DURATION/60 >15 THEN 1 ELSE 0 END) FROM SESSIONS"
181,Y,Y,"WITH CTE AS ( SELECT * FROM ((SELECT '[0-5>' AS BIN) UNION (SELECT '[5-10>' AS BIN) UNION (SELECT '[10-15>' AS BIN) UNION (SELECT '15 or more' AS BIN)) M ), TEMP AS (SELECT *, CASE WHEN DURATION < 5 * 60 THEN '[0-5>' WHEN DURATION < 10 * 60 THEN '[5-10>' WHEN DURATION < 15 * 60 THEN '[10-15>' ELSE '15 or more' END BIN FROM SESSIONS) SELECT CTE.BIN, IF(ISNULL(TOTAL), 0, TOTAL) AS TOTAL FROM (SELECT BIN, COUNT(BIN) AS TOTAL FROM TEMP GROUP BY BIN) AS A RIGHT JOIN CTE USING(BIN)"
182,Y,Y,"SELECT '[0-5>' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE (DURATION/60) >= 0 AND (DURATION/60) < 5 UNION SELECT '[5-10>' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE (DURATION/60) >= 5 AND (DURATION/60) < 10 UNION SELECT '[10-15>' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE (DURATION/60) >= 10 AND (DURATION/60) < 15 UNION SELECT '15 or more' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE (DURATION/60) >= 15"
183,Y,N,"WITH CTE AS (SELECT SESSION_ID, DURATION, CASE WHEN DURATION/60 <5 THEN '[0-5>' WHEN DURATION/60 >=5 AND DURATION/60 < 10 THEN '[5-10>' WHEN DURATION/60 >10 AND DURATION/60 < 15 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS ), CTE2 AS (SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more' AS BIN ) SELECT A.BIN, IFNULL(COUNT(B.SESSION_ID),0) AS TOTAL FROM CTE2 A LEFT JOIN CTE B USING (BIN) GROUP BY BIN"
184,Y,Y,"WITH CTE AS (SELECT SESSION_ID, CASE WHEN DURATION/60>=0 AND DURATION/60<5 THEN '[0-5>' WHEN DURATION/60>=5 AND DURATION/60<10 THEN '[5-10>' WHEN DURATION/60>=10 AND DURATION/60<15 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS) SELECT B.BIN, IFNULL(COUNT(A.SESSION_ID),0) AS TOTAL FROM CTE A RIGHT JOIN (SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' UNION SELECT '[10-15>' UNION SELECT '15 or more') B ON A.BIN = B.BIN GROUP BY 1"
185,Y,Y,"WITH T1 AS( SELECT SESSION_ID, DURATION, CASE WHEN DURATION/60 <5 THEN '[0-5>' WHEN DURATION/60 <10 THEN '[5-10>' WHEN DURATION/60 <15 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS ) , T2 AS ( SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more' AS BIN ) SELECT BIN, COUNT(SESSION_ID) AS TOTAL FROM T1 RIGHT JOIN T2 USING(BIN) GROUP BY BIN"
186,Y,Y,"WITH T1 AS (SELECT *, CASE WHEN DURATION<300 AND DURATION>=0 THEN '[0-5>' WHEN DURATION >= 300 AND DURATION < 600 THEN '[5-10>' WHEN DURATION >= 600 AND DURATION < 900 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS), T2 AS (SELECT '[0-5>'AS BIN UNION SELECT '[5-10>'AS BIN UNION SELECT '[10-15>'AS BIN UNION SELECT '15 or more'AS BIN) SELECT T2.BIN,COUNT(T1.SESSION_ID) AS TOTAL FROM T2 LEFT JOIN T1 ON T2.BIN=T1.BIN GROUP BY T2.BIN"
187,Y,Y,"SELECT A.BIN,SUM(CASE WHEN B.BIN IS NOT NULL THEN 1 ELSE 0 END) AS TOTAL FROM ( SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more' AS BIN ) AS A LEFT JOIN ( SELECT CASE WHEN (DURATION/60) >=0 AND (DURATION/60) <5 THEN '[0-5>' WHEN (DURATION/60) AND (DURATION/60) <10 THEN '[5-10>' WHEN (DURATION/60) >=10 AND (DURATION/60) <15 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS ) AS B ON A.BIN=B.BIN GROUP BY A.BIN"
188,Y,Y,"WITH CTE AS ( SELECT '[0-5>' AS BIN, 0 AS START_TIME, 5*60 AS END_TIME UNION SELECT '[5-10>' AS BIN, 5*60 AS START_TIME, 10*60 AS END_TIME UNION SELECT '[10-15>' AS BIN, 10*60 AS START_TIME, 15*60 AS END_TIME UNION SELECT '15 or more' AS BIN, 15*60 AS START_TIME, 2147483647 AS END_TIME ) , BIN_ASSIGNMENT AS ( SELECT * FROM CTE C LEFT JOIN SESSIONS S ON S.DURATION >= C.START_TIME AND S.DURATION < C.END_TIME ORDER BY DURATION ) SELECT BIN , COUNT(SESSION_ID) AS TOTAL FROM BIN_ASSIGNMENT GROUP BY BIN"
189,Y,N,"SELECT '[0-5>' AS BIN, COUNT(SESSION_ID ) AS TOTAL FROM SESSIONS WHERE DURATION/60 <5 UNION SELECT '[5-10>' AS BIN, COUNT(SESSION_ID ) AS TOTAL FROM SESSIONS WHERE DURATION/60 BETWEEN 5 AND 10 UNION SELECT '[10-15>' AS BIN, COUNT(SESSION_ID ) AS TOTAL FROM SESSIONS WHERE DURATION/60 BETWEEN 10 AND 15 UNION SELECT '15 or more' AS BIN, COUNT(SESSION_ID ) AS TOTAL FROM SESSIONS WHERE DURATION/60 > 15"
190,Y,Y,"SELECT (CASE WHEN DURATION/60 <5 THEN '[0-5>' ELSE '[0-5>' END) BIN ,IFNULL(SUM(CASE WHEN DURATION/60 <5 THEN 1 END),0) TOTAL FROM SESSIONS UNION SELECT (CASE WHEN DURATION/60 >=5 AND DURATION/60 <10 THEN '[5-10>' ELSE '[5-10>' END) BIN ,IFNULL(SUM(CASE WHEN DURATION/60 >=5 AND DURATION/60 <10 THEN 1 END),0) TOTAL FROM SESSIONS UNION SELECT (CASE WHEN DURATION/60 >=10 AND DURATION/60 <15 THEN '[10-15>' ELSE '[10-15>' END) BIN , IFNULL(SUM(CASE WHEN DURATION/60 >=10 AND DURATION/60 <15 THEN 1 END),0) TOTAL FROM SESSIONS UNION SELECT (CASE WHEN DURATION/60 >=15 THEN '15 or more ELSE 15 or more' END) BIN ,IFNULL(SUM(CASE WHEN DURATION/60 >=15 THEN 1 END),0) TOTAL FROM SESSIONS"
191,Y,Y,"SELECT '[0-5>' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION < 300 UNION ALL SELECT '[5-10>' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION >= 300 AND DURATION < 600 UNION ALL SELECT '[10-15>' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION >= 600 AND DURATION < 900 UNION ALL SELECT '15 or more' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION >= 900"
192,Y,Y,"SELECT T2.BIN, COALESCE(TOTAL,0) TOTAL FROM (SELECT CASE WHEN (DURATION / 60) < 5 THEN '[0-5>' WHEN (DURATION / 60) >=5 AND DURATION/60 < 10 THEN '[5-10>' WHEN (DURATION / 60) >= 10 AND DURATION/60 < 15 THEN '[10-15>' ELSE '15 or more' END AS BIN, COUNT(*) AS TOTAL FROM SESSIONS GROUP BY BIN) T1 RIGHT JOIN (SELECT '[0-5>' BIN UNION SELECT '[5-10>' BIN UNION SELECT '[10-15>' BIN UNION SELECT '15 or more' BIN) AS T2 ON T1.BIN = T2.BIN"
193,Y,Y,"SELECT '[0-5>' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION / 60 < 5 UNION SELECT '[5-10>' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION / 60 >= 5 AND DURATION / 60 < 10 UNION SELECT '[10-15>' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION / 60 >= 10 AND DURATION / 60 < 15 UNION SELECT '15 or more' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION / 60 >= 15"
194,Y,Y,"SELECT '[0-5>' AS BIN, SUM(CASE WHEN DURATION/60<5 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION ALL SELECT '[5-10>' AS BIN, SUM(CASE WHEN DURATION/60>=5 AND DURATION/60<10 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION ALL SELECT '[10-15>' AS BIN, SUM(CASE WHEN DURATION/60>=10 AND DURATION/60<15 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION ALL SELECT '15 or more' AS BIN, SUM(CASE WHEN DURATION/60>=15 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS"
195,Y,Y,"WITH K AS ( SELECT SESSION_ID, DURATION/60 AS DURATION FROM SESSIONS ) SELECT '[0-5>' AS BIN, COUNT(K.DURATION) AS TOTAL FROM K WHERE K.DURATION<5 UNION SELECT '[5-10>' AS BIN, COUNT(K.DURATION) AS TOTAL FROM K WHERE K.DURATION<10 AND K.DURATION>=5 UNION SELECT '[10-15>' AS BIN, COUNT(K.DURATION) AS TOTAL FROM K WHERE K.DURATION<15 AND K.DURATION>=10 UNION SELECT '15 or more' AS BIN, COUNT(K.DURATION) AS TOTAL FROM K WHERE K.DURATION>=15"
196,Y,Y,"SELECT TEMP2.BIN, IFNULL(COUNT(TEMP.SESSION_ID), 0) AS TOTAL FROM ( SELECT SESSION_ID, ( CASE WHEN ((DURATION/60) < 5) THEN '[0-5>' WHEN (((DURATION/60) >= 5) AND ((DURATION/60) < 10)) THEN '[5-10>' WHEN (((DURATION/60) >= 10) AND ((DURATION/60) < 15)) THEN '[10-15>' ELSE '15 or more' END ) AS BIN FROM SESSIONS ) TEMP RIGHT JOIN ((SELECT '[0-5>' AS BIN) UNION (SELECT '[5-10>' AS BIN) UNION (SELECT '[10-15>' AS BIN) UNION (SELECT '15 or more' AS BIN)) TEMP2 ON TEMP.BIN = TEMP2.BIN GROUP BY TEMP2.BIN"
197,Y,Y,"SELECT '[0-5>' BIN ,IFNULL(SUM(CASE WHEN DURATION/60 <5 THEN 1 END),0) TOTAL FROM SESSIONS UNION SELECT '[5-10>'BIN ,IFNULL(SUM(CASE WHEN DURATION/60 >=5 AND DURATION/60 <10 THEN 1 END),0) TOTAL FROM SESSIONS UNION SELECT '[10-15>' BIN , IFNULL(SUM(CASE WHEN DURATION/60 >=10 AND DURATION/60 <15 THEN 1 END),0) TOTAL FROM SESSIONS UNION SELECT '15 or more' BIN ,IFNULL(SUM(CASE WHEN DURATION/60 >=15 THEN 1 END),0) TOTAL FROM SESSIONS"
198,Y,Y,"WITH C AS( SELECT CASE WHEN DURATION/60<5 THEN '[0-5>' WHEN DURATION/60>=5 AND DURATION/60<10 THEN '[5-10>' WHEN DURATION/60>=10 AND DURATION/60<15 THEN '[10-15>' ELSE '15 or more' END BIN FROM SESSIONS), A AS(SELECT '[0-5>' BIN UNION SELECT '[5-10>' BIN UNION SELECT '[10-15>' BIN UNION SELECT '15 or more' BIN) SELECT BIN, IFNULL(COUNT(C.BIN),0) TOTAL FROM A LEFT JOIN C USING(BIN) GROUP BY 1"
199,Y,N,"WITH LESS_THAN_5 AS ( SELECT '[0-5>' AS BIN, COUNT(DURATION) AS TOTAL FROM SESSIONS WHERE DURATION BETWEEN 0 AND 5 * 60 - 1 ), LESS_THAN_10 AS ( SELECT '[5-10>' AS BIN, COUNT(DURATION) AS TOTAL FROM SESSIONS WHERE DURATION BETWEEN 5 * 60 AND 10 * 60 - 1 ), LESS_THAN_15 AS ( SELECT '[10-15>' AS BIN, COUNT(DURATION) AS TOTAL FROM SESSIONS WHERE DURATION BETWEEN 10 * 60 AND 15 * 60 - 1 ), MORE_THAN_15 AS ( SELECT '15 or more' AS BIN, COUNT(DURATION) AS TOTAL FROM SESSIONS WHERE DURATION > 15 * 60 ) SELECT * FROM LESS_THAN_5 UNION SELECT * FROM LESS_THAN_10 UNION SELECT * FROM LESS_THAN_15 UNION SELECT * FROM MORE_THAN_15"
200,Y,N,"WITH BIN_TABLE AS (SELECT SESSION_ID, DURATION/60 AS DUR_MIN FROM SESSIONS) SELECT '[0-5>' AS BIN, SUM(CASE WHEN DUR_MIN BETWEEN 0 AND 5 THEN 1 ELSE 0 END) AS TOTAL FROM BIN_TABLE UNION SELECT '[5-10>' AS BIN, SUM(CASE WHEN DUR_MIN BETWEEN 5 AND 10 THEN 1 ELSE 0 END) AS TOTAL FROM BIN_TABLE UNION SELECT '[10-15>' AS BIN, SUM(CASE WHEN DUR_MIN BETWEEN 10 AND 15 THEN 1 ELSE 0 END ) AS TOTAL FROM BIN_TABLE UNION SELECT '15 or more' AS BIN, SUM(CASE WHEN DUR_MIN > 15 THEN 1 ELSE 0 END) AS TOTAL FROM BIN_TABLE"
201,Y,Y,"(SELECT '[0-5>' AS BIN , SUM(CASE WHEN DURATION/60<5 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS) UNION (SELECT '[5-10>' AS BIN , SUM(CASE WHEN DURATION/60>=5 AND DURATION/60<10 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS) UNION (SELECT '[10-15>' AS BIN , SUM(CASE WHEN DURATION/60>=10 AND DURATION/60<15 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS) UNION (SELECT '15 or more AS BIN', SUM(CASE WHEN DURATION/60>=15 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS)"
202,Y,N,"WITH CTE AS (SELECT SUM((DURATION/60) < 5)AS BIN1, SUM((DURATION/60) >= 5 AND (DURATION/60) <= 10) AS BIN2, SUM((DURATION/60) >= 10 AND (DURATION/60) <= 15) AS BIN3, SUM((DURATION/60) > 15) AS BIN4 FROM SESSIONS) SELECT '[0-5>' AS BIN, BIN1 AS TOTAL FROM CTE UNION SELECT '[5-10>' AS BIN, BIN2 AS TOTAL FROM CTE UNION SELECT '[10-15>' AS BIN, BIN3 AS TOTAL FROM CTE UNION SELECT '15 or more' AS BIN, BIN4 AS TOTAL FROM CTE"
203,Y,Y,"WITH X1 AS (SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more' AS BIN), X2 AS (SELECT S.*, CASE WHEN DURATION/60 >= 0 AND DURATION/60 < 5 THEN '[0-5>' WHEN DURATION/60 < 10 THEN '[5-10>' WHEN DURATION/60 < 15 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS S) SELECT X1.BIN, IFNULL(COUNT(X2.BIN), 0) AS TOTAL FROM X1 LEFT JOIN X2 USING(BIN) GROUP BY BIN"
204,Y,Y,"WITH CTE AS ( SELECT '[0-5>' AS BIN UNION SELECT '[5-10>'AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more' AS BIN ), CTE2 AS ( SELECT *, CASE WHEN DURATION / 60 < 5 THEN '[0-5>' WHEN DURATION / 60 < 10 THEN '[5-10>' WHEN DURATION / 60 < 15 THEN '[10-15>' WHEN DURATION / 60 >= 15 THEN '15 or more' END AS BIN FROM SESSIONS ) SELECT CTE.BIN, COUNT(SESSION_ID) AS TOTAL FROM CTE LEFT JOIN CTE2 ON CTE.BIN = CTE2.BIN GROUP BY BIN"
205,Y,N,"SELECT '[0-5>' AS BIN, COUNT(*) TOTAL FROM SESSIONS WHERE (DURATION/60) < 5 UNION SELECT '[5-10>' AS BIN, COUNT(*) TOTAL FROM SESSIONS WHERE (DURATION/60) BETWEEN 5 AND 10 UNION SELECT '[10-15>' AS BIN, COUNT(*) TOTAL FROM SESSIONS WHERE (DURATION/60) BETWEEN 10 AND 15 UNION SELECT '15 or more' AS BIN, COUNT(*) TOTAL FROM SESSIONS WHERE (DURATION/60) >= 15"
206,Y,Y,"WITH NEW AS ( SELECT *, CASE WHEN DURATION<5*60 THEN '[0-5>' WHEN DURATION<10*60 THEN '[5-10>' WHEN DURATION<15*60 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS ), T2 AS ( SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more' AS BIN ) SELECT T2.BIN, COUNT(NEW.SESSION_ID) AS TOTAL FROM NEW RIGHT JOIN T2 ON T2.BIN=NEW.BIN GROUP BY BIN"
207,Y,N,"WITH TEMP1 AS (SELECT SESSION_ID, CASE WHEN DURATION/60 BETWEEN 0 AND 5 THEN '[0-5>' WHEN DURATION/60 BETWEEN 5 AND 10 THEN '[5-10>' WHEN DURATION/60 BETWEEN 10 AND 15 THEN '[10-15>' WHEN DURATION/60 > 15 THEN '15 or more' ELSE 0 END AS BIN FROM SESSIONS), TEMP2 AS ( SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more AS BIN' ) SELECT T2.BIN, COUNT(T1.BIN) AS TOTAL FROM TEMP1 T1 RIGHT JOIN TEMP2 T2 ON T1.BIN=T2.BIN GROUP BY T2.BIN"
208,Y,N,"SELECT '[0-5>' AS BIN , COUNT(*) AS TOTAL FROM SESSIONS WHERE 0 <= DURATION AND DURATION < 300 UNION SELECT '[5-10>' AS BIN , COUNT(*) AS TOTAL FROM SESSIONS WHERE 300 <= DURATION AND DURATION <600 UNION SELECT '[10-15>' AS BIN , COUNT(*) AS TOTAL FROM SESSIONS WHERE 600 <= DURATION AND DURATION <900 UNION SELECT '15 or more' AS BIN , COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION > 900"
209,Y,N,"SELECT '[0-5>' AS BIN , SUM(CASE WHEN DURATION/60 <= 5 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION ALL SELECT '[5-10>' AS BIN , SUM(CASE WHEN DURATION/60 > 5 AND DURATION/60 <= 10 THEN 1 ELSE 0 END )AS TOTAL FROM SESSIONS UNION ALL SELECT '[10-15>' AS BIN , SUM(CASE WHEN DURATION/60 > 10 AND DURATION/60 <= 15 THEN 1 ELSE 0 END )AS TOTAL FROM SESSIONS UNION ALL SELECT '15 or more' AS BIN , SUM(CASE WHEN DURATION/60 > 15 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS"
210,Y,Y,"SELECT '[0-5>' AS BIN , COUNT(DURATION/60) AS TOTAL FROM SESSIONS WHERE DURATION/60<5 UNION SELECT '[5-10>' AS BIN , COUNT(DURATION/60) AS TOTAL FROM SESSIONS WHERE DURATION/60>= 5 AND DURATION/60 < 10 UNION SELECT '[10-15>' AS BIN , COUNT(DURATION/60) AS TOTAL FROM SESSIONS WHERE DURATION/60>= 10 AND DURATION/60 < 15 UNION SELECT '15 or more' AS BIN , COUNT(DURATION/60) AS TOTAL FROM SESSIONS WHERE DURATION/60>= 15"
211,Y,N,"WITH T AS ( SELECT CASE WHEN DURATION/60 BETWEEN 0 AND 5 THEN '[0-5>' WHEN DURATION/60 BETWEEN 5 AND 10 THEN '[5-10>' WHEN DURATION/60 BETWEEN 10 AND 15 THEN '[10-15>' ELSE '15 or more' END BIN FROM SESSIONS ), BINS AS ( SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN ) SELECT B.BIN, IFNULL(COUNT(T.BIN), 0) TOTAL FROM BINS B LEFT JOIN T ON T.BIN = B.BIN GROUP BY B.BIN"
212,Y,N,"WITH BINS AS (SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' UNION SELECT '[10-15>' UNION SELECT '15 or more') ,SESSION_BINS AS (SELECT SESSION_ID, CASE WHEN DURATION < 5*60 THEN '[0-5>' WHEN DURATION >= 5*60 AND DURATION < 10*60 THEN '[5-10>' WHEN DURATION >= 10*60 AND DURATION < 15*60 THEN '[10-15>' WHEN DURATION > 15*60 THEN '15 or more' END AS BIN FROM SESSIONS) SELECT B.BIN, COUNT(SESSION_ID) AS TOTAL FROM BINS B LEFT JOIN SESSION_BINS S ON B.BIN = S.BIN GROUP BY B.BIN"
213,Y,Y,"SELECT '[0-5>' AS BIN, COUNT(0) AS TOTAL FROM SESSIONS WHERE DURATION < 300 UNION SELECT '[5-10>', COUNT(0) FROM SESSIONS WHERE DURATION >= 300 AND DURATION < 600 UNION SELECT '[10-15>', COUNT(0) FROM SESSIONS WHERE DURATION >= 600 AND DURATION < 900 UNION SELECT '15 or more', COUNT(0) FROM SESSIONS WHERE DURATION >= 900"
214,Y,N,"SELECT '[0-5>' AS BIN, SUM(CASE WHEN DURATION/60<5 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION ALL SELECT '[5-10>' AS BIN, SUM(CASE WHEN DURATION/60>5 AND DURATION/60<10 THEN 1 ELSE 0 END) FROM SESSIONS UNION ALL SELECT '[10-15>' AS BIN, SUM(CASE WHEN DURATION/60>10 AND DURATION/60<15 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION ALL SELECT '15 or more' AS BIN, SUM(CASE WHEN DURATION/60>15 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS"
215,Y,Y,"WITH TMP1 AS (SELECT *, CASE WHEN DURATION < 300 THEN '[0-5>' WHEN DURATION >= 300 AND DURATION < 600 THEN '[5-10>' WHEN DURATION >= 600 AND DURATION < 900 THEN '[10-15>' ELSE '15 or more' END BIN FROM SESSIONS), TMP2 AS (SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN) SELECT TMP2.BIN, SUM(IF(SESSION_ID IS NULL, 0, 1)) TOTAL FROM TMP2 LEFT JOIN TMP1 ON TMP2.BIN = TMP1.BIN GROUP BY TMP2.BIN"
216,Y,Y,"SELECT '[0-5>' BIN, COUNT(*) TOTAL FROM SESSIONS WHERE DURATION/60 >=0 AND DURATION/60<5 UNION SELECT '[5-10>',COUNT(*) TOTAL FROM SESSIONS WHERE DURATION/60 >=5 AND DURATION/60<10 UNION SELECT '[10-15>',COUNT(*) TOTAL FROM SESSIONS WHERE DURATION/60 >=10 AND DURATION/60<15 UNION SELECT '15 or more',COUNT(*) TOTAL FROM SESSIONS WHERE DURATION/60 >=15"
217,Y,Y,"SELECT * FROM ( WITH A AS ( SELECT SESSION_ID , DURATION /60 AS DURATION FROM SESSIONS ) SELECT '[0-5>' AS BIN , SUM(CASE WHEN DURATION >= 0 AND DURATION <5 THEN 1 ELSE 0 END ) AS TOTAL FROM A ) K1 UNION SELECT * FROM ( WITH A AS ( SELECT SESSION_ID ,DURATION /60 AS DURATION FROM SESSIONS ) SELECT '[5-10>' AS BIN , SUM(CASE WHEN DURATION >= 5 AND DURATION <10 THEN 1 ELSE 0 END ) AS TOTAL FROM A ) K2 UNION SELECT * FROM ( WITH A AS ( SELECT SESSION_ID , DURATION /60 AS DURATION FROM SESSIONS ) SELECT '[10-15>' AS BIN , SUM(CASE WHEN DURATION >= 10 AND DURATION <15 THEN 1 ELSE 0 END ) AS TOTAL FROM A ) K3 UNION SELECT * FROM ( WITH A AS ( SELECT SESSION_ID , DURATION /60 AS DURATION FROM SESSIONS ) SELECT '15 or more' AS BIN , SUM(CASE WHEN DURATION >= 15 THEN 1 ELSE 0 END ) AS TOTAL FROM A ) K3"
218,Y,Y,"WITH T1 AS (SELECT '[0-5>' AS BIN , 1 AS NUM UNION SELECT '[5-10>' AS BIN , 2 AS NUM UNION SELECT '[10-15>' AS BIN , 3 AS NUM UNION SELECT '15 or more AS BIN', 4 AS NUM ), T2 AS (SELECT SESSION_ID, CASE WHEN DURATION/60 < 5 THEN 1 WHEN DURATION/60 < 10 THEN 2 WHEN DURATION/60 < 15 THEN 3 ELSE 4 END AS NUM FROM SESSIONS) SELECT T1.BIN, COUNT(T2.NUM) AS TOTAL FROM T1 LEFT JOIN T2 ON T1.NUM = T2.NUM GROUP BY T1.BIN"
219,Y,Y,"SELECT '[0-5>' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION <300 UNION ALL SELECT '[5-10>' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION >=300 AND DURATION <600 UNION ALL SELECT '[10-15>' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION >=600 AND DURATION <900 UNION ALL SELECT '15 or more' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION >=900"
220,Y,Y,"WITH T1 AS (SELECT SUM(DURATION/60 < 5) AS BIN1, SUM((DURATION/60) >= 5 AND (DURATION/60) < 10) AS BIN2, SUM((DURATION/60) >= 10 AND (DURATION/60) < 15) AS BIN3, SUM((DURATION/60) >= 15) AS BIN4 FROM SESSIONS ) SELECT '[0-5>' AS BIN, BIN1 AS TOTAL FROM T1 UNION SELECT '[5-10>' AS BIN, BIN2 AS TOTAL FROM T1 UNION SELECT '[10-15>' AS BIN, BIN3 AS TOTAL FROM T1 UNION SELECT '15 or more' AS BIN, BIN4 AS TOTAL FROM T1"
221,Y,Y,"WITH RESULT AS ( SELECT SESSION_ID , CASE WHEN DURATION < 300 THEN '[0-5>' WHEN DURATION < 600 THEN '[5-10>' WHEN DURATION < 900 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS ), T AS ( SELECT '[0-5>' AS BIN FROM SESSIONS UNION SELECT'[5-10>' AS BIN FROM SESSIONS UNION SELECT '[10-15>' AS BIN FROM SESSIONS UNION SELECT '15 or more' AS BIN FROM SESSIONS ) SELECT T.BIN, IFNULL(COUNT(SESSION_ID),0) AS TOTAL FROM RESULT R RIGHT JOIN T ON R.BIN = T.BIN GROUP BY T.BIN"
222,Y,N,"SELECT '[0-5>' AS BIN,COUNT(DURATION) AS TOTAL FROM SESSIONS WHERE (DURATION/60) <5 UNION SELECT '[5-10>' AS BIN,COUNT(DURATION) AS TOTAL FROM SESSIONS WHERE (DURATION/60) BETWEEN 5 AND 10 UNION SELECT '[10-15>' AS BIN,COUNT(DURATION) AS TOTAL FROM SESSIONS WHERE (DURATION/60) BETWEEN 10 AND 15 UNION SELECT '15 or more' AS BIN,COUNT(DURATION) AS TOTAL FROM SESSIONS WHERE (DURATION/60) >15"
223,Y,Y,"SELECT '[0-5>' AS BIN, COUNT(*) TOTAL FROM SESSIONS WHERE DURATION <300 UNION SELECT '[5-10>' AS BIN, COUNT(*) TOTAL FROM SESSIONS WHERE DURATION >=300 AND DURATION <600 UNION SELECT '[10-15>' AS BIN, COUNT(*) TOTAL FROM SESSIONS WHERE DURATION >=600 AND DURATION <900 UNION SELECT '15 or more' AS BIN, COUNT(*) TOTAL FROM SESSIONS WHERE DURATION >= 900"
224,Y,Y,"SELECT B.BIN, IFNULL(COUNT(S.SESSION_ID),0) AS TOTAL FROM (SELECT SESSION_ID, CASE WHEN DURATION/60 < 5 THEN '[0-5>' WHEN DURATION/60 < 10 AND DURATION/60 >= 5 THEN '[5-10>' WHEN DURATION/60 <15 AND DURATION/60 >= 10 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS) S RIGHT JOIN (SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN) B ON S.BIN = B.BIN GROUP BY BIN"
225,Y,N,"SELECT '[0-5>' AS BIN , SUM(CASE WHEN DURATION < 300 THEN 1 ELSE 0 END) TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN , SUM(CASE WHEN DURATION >= 300 AND DURATION < 600 THEN 1 ELSE 0 END) TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN , SUM(CASE WHEN DURATION >= 600 AND DURATION < 900 THEN 1 ELSE 0 END) TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN , SUM(CASE WHEN DURATION > 900 THEN 1 ELSE 0 END) TOTAL FROM SESSIONS"
226,Y,N,"SELECT '[0-5>' AS BIN, (SELECT COUNT(*) FROM SESSIONS WHERE DURATION < 300) AS TOTAL UNION SELECT '[5-10>' AS BIN, (SELECT COUNT(*) FROM SESSIONS WHERE DURATION > 300 AND DURATION < 600) AS TOTAL UNION SELECT '[10-15>' AS BIN, (SELECT COUNT(*) FROM SESSIONS WHERE DURATION > 600 AND DURATION < 900) AS TOTAL UNION SELECT '15 or more' AS BIN, (SELECT COUNT(*) FROM SESSIONS WHERE DURATION > 900) AS TOTAL"
227,Y,Y,"WITH CAT AS (SELECT CASE WHEN DURATION < 300 THEN '[0-5>' WHEN DURATION < 600 THEN '[5-10>' WHEN DURATION < 900 THEN '[10-15>' ELSE '15 or more' END AS BIN, COUNT(*) TOTAL FROM SESSIONS T GROUP BY 1) SELECT A.BIN, IFNULL(TOTAL,0) TOTAL FROM (SELECT '[0-5>' BIN UNION SELECT '[5-10>' BIN UNION SELECT '[10-15>' BIN UNION SELECT '15 or more' BIN) A LEFT JOIN CAT B ON A.BIN=B.BIN"
228,Y,Y,"SELECT '[0-5>' AS BIN,SUM(DURATION<300) TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN,SUM(DURATION>=300 AND DURATION<600) TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN,SUM(DURATION>=600 AND DURATION<900) TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN,SUM(DURATION>=900) TOTAL FROM SESSIONS"
229,Y,Y,"WITH A AS(SELECT SESSION_ID, DURATION/60 AS DURATION FROM SESSIONS) SELECT BIN,IFNULL(COUNT(SESSION_ID),0) AS TOTAL FROM(SELECT *, CASE WHEN DURATION<5 THEN '[0-5>' WHEN DURATION >=5 AND DURATION <10 THEN '[5-10>' WHEN DURATION >=10 AND DURATION <15 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM A) C RIGHT JOIN (SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN) B USING (BIN) GROUP BY BIN"
230,Y,Y,"SELECT '[0-5>' AS BIN, SUM(CASE WHEN DURATION>=0 AND (DURATION<300 ) THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION ALL SELECT '[5-10>' AS BIN, SUM(CASE WHEN DURATION>=300 AND (DURATION<600) THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION ALL SELECT '[10-15>' AS BIN, SUM(CASE WHEN DURATION>=600 AND (DURATION<900) THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION ALL SELECT '15 or more' AS BIN, SUM(CASE WHEN DURATION>=900 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS"
231,Y,Y,"SELECT '[0-5>' AS BIN, SUM(CASE WHEN DURATION/60 >= 0 AND DURATION/60 <5 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION ALL SELECT '[5-10>' AS BIN, SUM(CASE WHEN DURATION/60 >=5 AND DURATION/60 <10 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION ALL SELECT '[10-15>' AS BIN, SUM(CASE WHEN DURATION/60 >=10 AND DURATION/60 <15 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION ALL SELECT '15 or more' AS BIN, SUM(CASE WHEN DURATION/60 >=15 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS"
232,Y,N,"WITH CTE AS (SELECT SESSION_ID, DURATION, (CASE WHEN DURATION/60 < 5 THEN '[0-5>' WHEN DURATION/60 BETWEEN 5 AND 10 THEN '[5-10>' WHEN DURATION/60 BETWEEN 10 AND 15 THEN '[10-15>' ELSE '15 or more' END) AS BIN FROM SESSIONS), BINS AS (SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN) SELECT B.BIN, IFNULL(COUNT(SESSION_ID),0) AS TOTAL FROM BINS B LEFT JOIN CTE C ON B.BIN = C.BIN GROUP BY B.BIN"
233,Y,N,"SELECT '[0-5>' AS BIN , COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE (DURATION/60) BETWEEN 0 AND 5 UNION SELECT '[5-10>' AS BIN , COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE (DURATION/60) BETWEEN 5 AND 10 UNION SELECT '[10-15>' AS BIN , COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE (DURATION/60) BETWEEN 10 AND 15 UNION SELECT '15 or more AS BIN', COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE (DURATION/60) >=15"
234,Y,N,"WITH CTE AS (SELECT SESSION_ID, DURATION / 60 AS MINUTE , CASE WHEN (DURATION / 60) > 15 THEN '15 or more' WHEN (DURATION / 60) >= 10 THEN '[10-15>' WHEN (DURATION / 60) >=5 THEN '[5-10>' ELSE '[0-5>' END AS BIN FROM SESSIONS GROUP BY DURATION) SELECT B.BIN,COUNT(CTE.SESSION_ID) AS TOTAL FROM CTE RIGHT JOIN (SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN) B ON B.BIN=CTE.BIN GROUP BY BIN"
235,Y,N,"WITH BINS AS (SELECT CASE WHEN DURATION/60 BETWEEN 0 AND 5 THEN '[0-5>' WHEN DURATION/60 BETWEEN 5 AND 10 THEN '[5-10>' WHEN DURATION/60 BETWEEN 10 AND 15 THEN '[10-15>' WHEN DURATION/60 >= 15 THEN '15 or more' ELSE 0 END AS BIN FROM SESSIONS), BINS_AS_ROWS AS ( SELECT '[0-5>' AS BIN FROM BINS UNION SELECT '[5-10>' AS BIN FROM BINS UNION SELECT '[10-15>' AS BIN FROM BINS UNION SELECT '15 or more' AS BIN FROM BINS) SELECT B1.BIN, IFNULL(COUNT(B2.BIN),0) AS TOTAL FROM BINS B2 RIGHT JOIN BINS_AS_ROWS B1 ON B1.BIN = B2.BIN GROUP BY B1.BIN"
236,Y,Y,"WITH CTE AS ( SELECT DURATION/60 AS MINS FROM SESSIONS ) SELECT '[0-5>' AS BIN, SUM(CASE WHEN MINS >= 0 AND MINS<5 THEN 1 ELSE 0 END) AS TOTAL FROM CTE UNION ALL SELECT '[5-10>' AS BIN, SUM(CASE WHEN MINS>=5 AND MINS<10 THEN 1 ELSE 0 END) AS TOTAL FROM CTE UNION ALL SELECT '[10-15>' AS BIN, SUM(CASE WHEN MINS>=10 AND MINS<15 THEN 1 ELSE 0 END) AS TOTAL FROM CTE UNION ALL SELECT '15 or more' AS BIN, SUM(CASE WHEN MINS>=15 THEN 1 ELSE 0 END) AS TOTAL FROM CTE"
237,Y,Y,"WITH CTE AS( SELECT SESSION_ID, CASE WHEN DURATION < 300 THEN '[0-5>' WHEN DURATION >= 300 AND DURATION <600 THEN '[5-10>' WHEN DURATION >= 600 AND DURATION <900 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS), CTE2 AS( SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more' AS BIN) SELECT C2.BIN, COALESCE(COUNT(C.SESSION_ID),0) AS TOTAL FROM CTE2 C2 LEFT JOIN CTE C USING(BIN) GROUP BY 1"
238,Y,N,"SELECT '[0-5>' AS BIN,COUNT(DURATION) AS TOTAL FROM SESSIONS WHERE DURATION < 300 UNION SELECT '[5-10>' AS BIN,COUNT(DURATION) AS TOTAL FROM SESSIONS WHERE DURATION >= 300 AND DURATION < 600 UNION SELECT '[10-15>' AS BIN,COUNT(DURATION) AS TOTAL FROM SESSIONS WHERE DURATION >= 600 AND DURATION < 900 UNION SELECT '15 or more' AS BIN,COUNT(DURATION) AS TOTAL FROM SESSIONS WHERE DURATION > 900"
239,Y,Y,"WITH SUMMARY AS ( SELECT CASE WHEN DURATION/60 < 5 THEN '[0-5>' WHEN DURATION/60 <10 THEN '[5-10>' WHEN DURATION/60 <15 THEN '[10-15>' ELSE '15 or more' END AS BIN, COALESCE(COUNT(DISTINCT SESSION_ID), 0) AS TOTAL FROM SESSIONS GROUP BY CASE WHEN DURATION/60 < 5 THEN '[0-5>' WHEN DURATION/60 <10 THEN '[5-10>' WHEN DURATION/60 <15 THEN '[10-15>' ELSE '15 or more' END ), BINS AS ( SELECT '[0-5>' AS BINS UNION SELECT '[5-10>' AS BINS UNION SELECT '[10-15>' AS BINS UNION SELECT '15 or more' AS BINS ) SELECT BINS.BINS AS BIN, COALESCE(SUMMARY.TOTAL , 0) AS TOTAL FROM BINS LEFT JOIN SUMMARY ON BINS.BINS = SUMMARY.BIN"
240,Y,Y,"SELECT A.BIN, COUNT(SESSION_ID) AS TOTAL FROM (SELECT '[0-5>' BIN UNION SELECT '[5-10>' BIN UNION SELECT '[10-15>' BIN UNION SELECT '15 or more' BIN) AS A LEFT JOIN (SELECT SESSION_ID, CASE WHEN DURATION/60 >= 0 AND DURATION/60 < 5 THEN '[0-5>' WHEN DURATION/60 >= 5 AND DURATION/60 < 10 THEN '[5-10>' WHEN DURATION/60 >= 10 AND DURATION/60 < 15 THEN '[10-15>' WHEN DURATION/60 >= 15 THEN '15 or more' END AS BIN FROM SESSIONS) AS B ON A.BIN = B.BIN GROUP BY A.BIN"
241,Y,Y,"(SELECT '[0-5>' AS BIN, SUM(IF(DURATION/60>=0 AND DURATION/60<5,1,0)) AS TOTAL FROM SESSIONS) UNION (SELECT '[5-10>' AS BIN, SUM(IF(DURATION/60>=5 AND DURATION/60<10,1,0)) AS TOTAL FROM SESSIONS) UNION (SELECT '[10-15>' AS BIN, SUM(IF(DURATION/60>=10 AND DURATION/60<15,1,0)) AS TOTAL FROM SESSIONS) UNION (SELECT '15 or more' AS BIN, SUM(IF(DURATION/60>=15,1,0)) AS TOTAL FROM SESSIONS)"
242,Y,Y,"WITH B AS(SELECT SESSION_ID, CASE WHEN SECONDS >=0 AND SECONDS <5 THEN '[0-5>' WHEN SECONDS >=5 AND SECONDS <10 THEN '[5-10>' WHEN SECONDS >=10 AND SECONDS <15 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM (SELECT SESSION_ID, DURATION/60 AS SECONDS FROM SESSIONS)A), C AS(SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' UNION SELECT '[10-15>' UNION SELECT '15 or more') SELECT C.BIN, IFNULL(COUNT(SESSION_ID),0) AS TOTAL FROM B RIGHT JOIN C ON C.BIN = B.BIN GROUP BY BIN"
243,Y,N,"SELECT '[0-5>' AS BIN,SUM((DURATION/60)<5) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN,SUM((DURATION/60)>=5 AND(DURATION/60) <10) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN,SUM((DURATION/60)>=10 AND (DURATION/60)<15) AS TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN,SUM(DURATION/60>15) AS TOTAL FROM SESSIONS"
244,Y,N,"SELECT '[0-5>' AS BIN, SUM((DURATION/60)<5) AS TOTAL FROM SESSIONS UNION ALL SELECT '[5-10>' AS BIN, SUM((DURATION/60)>=5 AND (DURATION/60)<10) AS TOTAL FROM SESSIONS UNION ALL SELECT '[10-15>' AS BIN, SUM((DURATION/60)>=10 AND (DURATION/60)<15) AS TOTAL FROM SESSIONS UNION ALL SELECT '15 or more' AS BIN, SUM((DURATION/60)>15) AS TOTAL FROM SESSIONS"
245,Y,Y,"SELECT '[0-5>' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION>=0 AND DURATION/60<5 UNION SELECT '[5-10>' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION/60>=5 AND DURATION/60<10 UNION SELECT '[10-15>' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION/60>=10 AND DURATION/60<15 UNION SELECT '15 or more' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION/60>=15"
246,Y,Y,"WITH SESSION_GROUP AS ( SELECT SESSION_ID ,(CASE WHEN DURATION >= 0*60 AND DURATION < 5*60 THEN '[0-5>' WHEN DURATION >= 5*60 AND DURATION < 10*60 THEN '[5-10>' WHEN DURATION >= 10*60 AND DURATION < 15*60 THEN '[10-15>' WHEN DURATION >= 15*60 THEN '15 or more' END ) AS BIN FROM SESSIONS ), NAME AS ( SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN ) SELECT N.BIN ,IFNULL(COUNT(SP.SESSION_ID), 0) AS TOTAL FROM NAME N LEFT JOIN SESSION_GROUP SP ON N.BIN = SP.BIN GROUP BY N.BIN"
247,Y,N,"SELECT '[0-5>' AS BIN , SUM(CASE WHEN DURATION<=300 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN , SUM(CASE WHEN DURATION>300 AND DURATION<=600 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN , SUM(CASE WHEN DURATION>600 AND DURATION<900 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '15 or more AS BIN', SUM(CASE WHEN DURATION>=900 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS"
248,Y,Y,"SELECT '[0-5>' AS BIN, IFNULL(SUM(CASE WHEN DURATION < 300 THEN 1 END), 0) AS TOTAL FROM SESSIONS UNION ALL SELECT '[5-10>' AS BIN, IFNULL(SUM(CASE WHEN DURATION >= 300 AND DURATION < 600 THEN 1 END), 0) AS TOTAL FROM SESSIONS UNION ALL SELECT '[10-15>' AS BIN, IFNULL(SUM(CASE WHEN DURATION >= 600 AND DURATION < 900 THEN 1 END), 0) AS TOTAL FROM SESSIONS UNION ALL SELECT '15 or more' AS BIN, IFNULL(SUM(CASE WHEN DURATION >= 900 THEN 1 END), 0) AS TOTAL FROM SESSIONS"
249,Y,Y,"WITH TEMP AS (SELECT SESSION_ID, DURATION/60, (CASE WHEN DURATION/60 >=0 AND DURATION/60 < 5 THEN '[0-5>' WHEN DURATION/60 >=5 AND DURATION/60 < 10 THEN '[5-10>' WHEN DURATION/60 >=10 AND DURATION/60 < 15 THEN '[10-15>' ELSE '15 or more' END) AS BIN FROM SESSIONS), TEMP2 AS (SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more' AS BIN) SELECT TEMP2.BIN, COUNT(TEMP.BIN) AS TOTAL FROM TEMP2 LEFT JOIN TEMP ON TEMP2.BIN = TEMP.BIN GROUP BY 1"
250,Y,N,"WITH X AS (SELECT CASE WHEN DURATION/60 <5 THEN '[0-5>' WHEN DURATION/60 BETWEEN 5 AND 10 THEN '[5-10>' WHEN DURATION/60 BETWEEN 10 AND 15 THEN '[10-15>' WHEN DURATION/60 >=15 THEN '15 or more' END AS BIN, COUNT(*) AS TOTAL FROM SESSIONS GROUP BY CASE WHEN DURATION/60 <5 THEN '[0-5>' WHEN DURATION/60 BETWEEN 5 AND 10 THEN '[5-10>' WHEN DURATION/60 BETWEEN 10 AND 15 THEN '[10-15>' WHEN DURATION/60 >=15 THEN '15 or more' END), Y AS (SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' UNION ALL SELECT '[10-15>' UNION ALL SELECT '15 or more') SELECT Y.BIN,COALESCE(X.TOTAL,0) AS TOTAL FROM X RIGHT JOIN Y ON X.BIN = Y.BIN"
251,Y,N,"SELECT '[0-5>' BIN, SUM(CASE WHEN DURATION < 300 THEN 1 ELSE 0 END) TOTAL FROM SESSIONS UNION SELECT '[5-10>' BIN, SUM(CASE WHEN DURATION > 300 AND DURATION < 600 THEN 1 ELSE 0 END) TOTAL FROM SESSIONS UNION SELECT '[10-15>' BIN, SUM(CASE WHEN DURATION > 600 AND DURATION < 900 THEN 1 ELSE 0 END) TOTAL FROM SESSIONS UNION SELECT '15 or more' BIN, SUM(CASE WHEN DURATION > 900 THEN 1 ELSE 0 END) TOTAL FROM SESSIONS"
252,Y,N,"(SELECT '[0-5>' AS BIN,COUNT(DURATION) AS TOTAL FROM SESSIONS WHERE DURATION < 300) UNION (SELECT '[5-10>' AS BIN,COUNT(DURATION) AS TOTAL FROM SESSIONS WHERE DURATION >= 300 AND DURATION < 600) UNION (SELECT '[10-15>' AS BIN,COUNT(DURATION) AS TOTAL FROM SESSIONS WHERE DURATION >= 600 AND DURATION < 900) UNION (SELECT '15 or more' AS BIN,COUNT(DURATION) AS TOTAL FROM SESSIONS WHERE DURATION > 900)"
253,Y,Y,"SELECT '[0-5>' AS BIN, SUM(CASE WHEN DURATION < 300 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION ALL SELECT '[5-10>' AS BIN, SUM(CASE WHEN DURATION >=300 AND DURATION < 600 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION ALL SELECT '[10-15>' AS BIN, SUM(CASE WHEN DURATION >=600 AND DURATION < 900 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION ALL SELECT '15 or more' AS BIN, SUM(CASE WHEN DURATION >=900 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS"
254,Y,Y,"WITH CTE AS (SELECT *, CASE WHEN DURATION BETWEEN 0 AND 299 THEN '[0-5>' WHEN DURATION BETWEEN 300 AND 599 THEN '[5-10>' WHEN DURATION BETWEEN 600 AND 899 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS), CTE2 AS (SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' UNION SELECT '[10-15>' UNION SELECT '15 or more') SELECT CTE2.BIN, IFNULL(C, 0) AS TOTAL FROM CTE2 LEFT JOIN (SELECT BIN, COUNT(SESSION_ID) AS C FROM CTE GROUP BY BIN) W ON CTE2.BIN=W.BIN"
255,Y,Y,"SELECT '[0-5>' BIN, SUM(DURATION / 60 < 5) TOTAL FROM SESSIONS UNION SELECT '[5-10>' BIN, SUM(DURATION / 60 >= 5 AND DURATION/60 <10) TOTAL FROM SESSIONS UNION SELECT '[10-15>' BIN, SUM(DURATION / 60 >= 10 AND DURATION/60 <15) TOTAL FROM SESSIONS UNION SELECT '15 or more' BIN, SUM(DURATION / 60 >= 15) TOTAL FROM SESSIONS"
256,Y,Y,"SELECT '[0-5>' AS BIN, COUNT(0) AS TOTAL FROM SESSIONS WHERE DURATION < 300 UNION ALL SELECT '[5-10>', COUNT(0) FROM SESSIONS WHERE DURATION >= 300 AND DURATION < 600 UNION ALL SELECT '[10-15>', COUNT(0) FROM SESSIONS WHERE DURATION >= 600 AND DURATION < 900 UNION ALL SELECT '15 or more', COUNT(0) FROM SESSIONS WHERE DURATION >= 900"
257,Y,N,"SELECT '[0-5>' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION BETWEEN 0 AND 300 UNION ALL SELECT '[5-10>' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION BETWEEN 301 AND 600 UNION ALL SELECT '[10-15>' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION BETWEEN 601 AND 900 UNION ALL SELECT '15 or more' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION >= 900"
258,Y,Y,"WITH T AS (SELECT '[0-5>' AS BIN, 0 AS MIN_DURATION, 5*60 AS MAX_DURATION UNION ALL SELECT '[5-10>' AS BIN, 5*60 AS MIN_DURATION, 10*60 AS MAX_DURATION UNION ALL SELECT '[10-15>' AS BIN, 10*60 AS MIN_DURATION, 15*60 AS MAX_DURATION UNION ALL SELECT '15 or more' AS BIN, 15*60 AS MIN_DURATION, 1223333333 AS MAX_DURATION) SELECT T.BIN, COUNT(S.SESSION_ID) AS TOTAL FROM SESSIONS S RIGHT JOIN T ON S.DURATION < T.MAX_DURATION AND S.DURATION >= T.MIN_DURATION GROUP BY T.BIN"
259,Y,N,"WITH T AS (SELECT SESSION_ID, DURATION/60 AS DURATION FROM SESSIONS) SELECT '[0-5>' AS BIN, SUM(CASE WHEN DURATION BETWEEN 0 AND 5 THEN 1 ELSE 0 END) AS TOTAL FROM T UNION ALL SELECT '[5-10>' AS BIN, SUM(CASE WHEN DURATION BETWEEN 5 AND 10 THEN 1 ELSE 0 END) AS TOTAL FROM T UNION ALL SELECT '[10-15>' AS BIN, SUM(CASE WHEN DURATION BETWEEN 10 AND 15 THEN 1 ELSE 0 END) AS TOTAL FROM T UNION ALL SELECT '15 or more' AS BIN, SUM(CASE WHEN DURATION >= 15 THEN 1 ELSE 0 END) AS TOTAL FROM T"
260,Y,Y,"SELECT '[0-5>' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE ROUND(DURATION / 60, 2) >= 0 AND ROUND(DURATION / 60, 2) < 5 UNION SELECT '[5-10>' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE ROUND(DURATION / 60, 2) >= 5 AND ROUND(DURATION / 60, 2) < 10 UNION SELECT '[10-15>' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE ROUND(DURATION / 60, 2) >= 10 AND ROUND(DURATION / 60, 2) < 15 UNION SELECT '15 or more' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE ROUND(DURATION / 60, 2) >= 15"
261,Y,Y,"(SELECT '[0-5>' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION < 300) UNION ALL (SELECT '[5-10>' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION >= 300 AND DURATION < 600) UNION ALL (SELECT '[10-15>' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION >= 600 AND DURATION < 900) UNION ALL (SELECT '15 or more' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION >= 900)"
262,Y,Y,"SELECT B.BIN, IFNULL(A.TOTAL,0) AS TOTAL FROM (SELECT CASE WHEN DURATION/60 < 5 THEN '[0-5>' WHEN DURATION/60 >=5 AND DURATION/60 < 10 THEN '[5-10>' WHEN DURATION/60 >=10 AND DURATION/60 < 15 THEN '[10-15>' WHEN DURATION/60 >=15 THEN '15 or more' END AS BIN , COUNT(*) AS TOTAL FROM SESSIONS GROUP BY 1) A RIGHT JOIN (SELECT '[0-5>' AS BIN FROM SESSIONS UNION SELECT '[5-10>' AS BIN FROM SESSIONS UNION SELECT '[10-15>' AS BIN FROM SESSIONS UNION SELECT '15 or more' AS BIN FROM SESSIONS ) B ON A.BIN = B.BIN GROUP BY 1"
263,Y,Y,"SELECT '[0-5>' AS BIN, COUNT(DURATION) AS TOTAL FROM SESSIONS WHERE DURATION/60 < 5 UNION SELECT '[5-10>' AS BIN, COUNT(DURATION) AS TOTAL FROM SESSIONS WHERE DURATION/60 >= 5 AND DURATION/60 <10 UNION SELECT '[10-15>' AS BIN, COUNT(DURATION) AS TOTAL FROM SESSIONS WHERE DURATION/60 >= 10 AND DURATION/60 <15 UNION SELECT '15 or more' AS BIN, COUNT(DURATION) AS TOTAL FROM SESSIONS WHERE DURATION/60 >= 15"
264,Y,Y,"WITH ETC AS (SELECT *, CASE WHEN DURATION <300 THEN '[0-5>' WHEN DURATION <600 THEN '[5-10>' WHEN DURATION <900 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS), CTE AS ( SELECT ETC.BIN, COUNT(ETC.SESSION_ID) AS TOTAL FROM ETC GROUP BY ETC.BIN UNION ALL SELECT '[0-5>',0 UNION ALL SELECT '[5-10>',0 UNION ALL SELECT '[10-15>',0 UNION ALL SELECT '15 or more',0 ORDER BY TOTAL DESC) SELECT DISTINCT BIN, TOTAL FROM CTE GROUP BY BIN"
265,Y,Y,"SELECT '[0-5>' AS BIN, SUM(IF(DURATION/60 >= 0 AND DURATION/60 <5,1,0)) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN, SUM(IF(DURATION/60 >=5 AND DURATION/60 < 10,1,0)) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN, SUM(IF(DURATION/60 >=10 AND DURATION/60 < 15,1,0)) AS TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN, SUM(IF(DURATION/60 >=15,1,0)) AS TOTAL FROM SESSIONS"
266,Y,Y,"WITH CTE AS( SELECT '[0-5>' AS BIN, 0 AS MIN, 5*60 AS MAX UNION ALL SELECT '[5-10>' AS BIN, 5*60 AS MIN, 10*60 AS MAX UNION ALL SELECT '[10-15>' AS BIN, 10*60 AS MIN, 15*60 AS MAX UNION ALL SELECT '15 or more' AS BIN, 15*60 AS MIN, 2147483647 AS MAX ) SELECT CTE.BIN, IFNULL(COUNT(S.SESSION_ID),0) AS TOTAL FROM SESSIONS AS S RIGHT JOIN CTE AS CTE ON S.DURATION < MAX AND S.DURATION >=MIN GROUP BY CTE.BIN"
267,Y,Y,"WITH CTE_SESSION AS (SELECT SESSION_ID ,CASE WHEN DURATION/60 >=0 AND DURATION/60 <5 THEN '[0-5>' WHEN DURATION/60 >=5 AND DURATION/60 < 10 THEN '[5-10>' WHEN DURATION/60 >=10 AND DURATION/60 < 15 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS ), T AS (SELECT '[0-5>' AS BIN FROM SESSIONS UNION SELECT '[5-10>' AS BIN FROM SESSIONS UNION SELECT '[10-15>' AS BIN FROM SESSIONS UNION SELECT '15 or more' AS BIN FROM SESSIONS) SELECT T.BIN, IFNULL(COUNT(SESSION_ID),0) AS TOTAL FROM CTE_SESSION CT RIGHT JOIN T ON CT.BIN = T.BIN GROUP BY T.BIN"
268,Y,Y,"WITH CTE AS ( SELECT SUM((DURATION/60) < 5) AS BIN1, SUM((DURATION/60) >= 5 AND (DURATION/60) < 10) AS BIN2, SUM((DURATION/60) >= 10 AND (DURATION/60) < 15) AS BIN3, SUM((DURATION/60) >= 15) AS BIN4 FROM SESSIONS ) SELECT '[0-5>' AS BIN, BIN1 AS TOTAL FROM CTE UNION SELECT '[5-10>' AS BIN, BIN2 AS TOTAL FROM CTE UNION SELECT '[10-15>' AS BIN, BIN3 AS TOTAL FROM CTE UNION SELECT '15 or more' AS BIN, BIN4 AS TOTAL FROM CTE"
269,Y,Y,"SELECT '[0-5>' AS BIN, SUM(CASE WHEN DURATION >=0 AND DURATION < 5*60 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS S UNION SELECT '[5-10>' AS BIN, SUM(CASE WHEN DURATION >=5*60 AND DURATION < 10*60 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS S UNION SELECT '[10-15>' AS BIN, SUM(CASE WHEN DURATION >=10*60 AND DURATION < 15*60 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS S UNION SELECT '15 or more' AS BIN, SUM(CASE WHEN DURATION >=15*60 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS S"
270,Y,Y,"WITH C AS( SELECT CASE WHEN DURATION/60<5 THEN '[0-5>' WHEN DURATION/60>=5 AND DURATION/60<10 THEN '[5-10>' WHEN DURATION/60>=10 AND DURATION/60<15 THEN '[10-15>' ELSE '15 or more' END BIN FROM SESSIONS), A AS(SELECT '[0-5>' BIN UNION SELECT '[5-10>' BIN UNION SELECT '[10-15>' BIN UNION SELECT '15 or more' BIN) SELECT BIN, COUNT(C.BIN) TOTAL FROM A LEFT JOIN C USING(BIN) GROUP BY 1"
271,Y,Y,"SELECT '[0-5>' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION < 300 UNION SELECT '[5-10>' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION < 600 AND DURATION >= 300 UNION SELECT '[10-15>' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION < 900 AND DURATION >= 600 UNION SELECT '15 or more' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION >= 900"
272,Y,Y,"WITH CTE AS ( SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more' AS BIN ) SELECT BIN, IFNULL(TOTAL,0) AS TOTAL FROM CTE LEFT JOIN ( SELECT CASE WHEN DURATION < 300 THEN '[0-5>' WHEN DURATION >= 300 AND DURATION < 600 THEN '[5-10>' WHEN DURATION >= 600 AND DURATION < 900 THEN '[10-15>' ELSE '15 or more' END AS BIN, COUNT(*) AS TOTAL FROM SESSIONS GROUP BY BIN )T USING (BIN)"
273,Y,N,"WITH TIME_MIN AS ( SELECT SESSION_ID, DURATION/60 AS DURATION_MIN FROM SESSIONS ) SELECT '[0-5>' AS BIN, COUNT(CASE WHEN DURATION_MIN < 5 THEN 1 END) AS TOTAL FROM TIME_MIN UNION SELECT '[5-10>' AS BIN, COUNT(CASE WHEN DURATION_MIN BETWEEN 5 AND 10 THEN 1 END) AS TOTAL FROM TIME_MIN UNION SELECT '[10-15>' AS BIN, COUNT(CASE WHEN DURATION_MIN BETWEEN 10 AND 15 THEN 1 END) AS TOTAL FROM TIME_MIN UNION SELECT '15 or more' AS BIN, COUNT(CASE WHEN DURATION_MIN > 15 THEN 1 END) AS TOTAL FROM TIME_MIN"
274,Y,N,"WITH TEMP AS ( SELECT SESSION_ID, CASE WHEN DURATION < 300 THEN '[0-5>' WHEN DURATION < 600 THEN '[5-10>' WHEN DURATION < 900 THEN '[10-15> ' ELSE '15 or more' END AS BIN FROM SESSIONS ), TA AS ( SELECT '[0-5>' AS BIN FROM SESSIONS UNION SELECT '[5-10>' AS BIN FROM SESSIONS UNION SELECT '[10-15>' AS BIN FROM SESSIONS UNION SELECT '15 or more' AS BIN FROM SESSIONS ) SELECT TA.BIN AS BIN, COUNT(SESSION_ID) AS TOTAL FROM TA LEFT JOIN TEMP ON TA.BIN = TEMP.BIN GROUP BY TA.BIN"
275,Y,N,"SELECT '[0-5>' AS BIN, SUM(DURATION < 5*60) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN, SUM(DURATION < 10*60 AND DURATION >= 5*60) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN, SUM(DURATION < 15*60 AND DURATION >= 10*60) AS TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN, SUM(DURATION > 15*60) AS TOTAL FROM SESSIONS"
276,Y,Y,"SELECT '[0-5>' AS BIN, SUM( CASE WHEN DURATION < 300 THEN 1 ELSE 0 END ) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN, SUM( CASE WHEN 300 <= DURATION AND DURATION < 600 THEN 1 ELSE 0 END ) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN, SUM( CASE WHEN 600 <= DURATION AND DURATION < 900 THEN 1 ELSE 0 END ) AS TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN, SUM( CASE WHEN DURATION >= 900 THEN 1 ELSE 0 END ) AS TOTAL FROM SESSIONS"
277,Y,N,"SELECT '[0-5>' AS BIN, COUNT(*) TOTAL FROM SESSIONS WHERE (DURATION/60) < 5 UNION ALL SELECT '[5-10>' AS BIN, COUNT(*) TOTAL FROM SESSIONS WHERE (DURATION/60) BETWEEN 5 AND 10 UNION ALL SELECT '[10-15>' AS BIN, COUNT(*) TOTAL FROM SESSIONS WHERE (DURATION/60) BETWEEN 10 AND 15 UNION ALL SELECT '15 or more' AS BIN, COUNT(*) TOTAL FROM SESSIONS WHERE (DURATION/60) >= 15"
278,Y,N,"WITH CTE AS( SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' BIN UNION SELECT '[10-15>' BIN UNION SELECT '15 or more' BIN), CTE2 AS( SELECT CASE WHEN DURATION/60 BETWEEN 0 AND 5 THEN '[0-5>' WHEN DURATION/60 BETWEEN 5 AND 10 THEN '[5-10>' WHEN DURATION/60 BETWEEN 10 AND 15 THEN '[10-15>' WHEN DURATION/60 > 15 THEN '15 or more' END AS BIN ,COUNT(CASE WHEN DURATION/60 BETWEEN 0 AND 5 THEN 1 WHEN DURATION/60 BETWEEN 5 AND 10 THEN 1 WHEN DURATION/60 BETWEEN 10 AND 15 THEN 1 WHEN DURATION/60 > 15 THEN 1 END) AS CNT FROM SESSIONS GROUP BY BIN) SELECT C.BIN, COALESCE(S.CNT,0) TOTAL FROM CTE C LEFT JOIN CTE2 S ON C.BIN = S.BIN"
279,Y,Y,"SELECT '[0-5>' BIN, SUM(CASE WHEN DURATION/60<5 THEN 1 ELSE 0 END) TOTAL FROM SESSIONS UNION ALL SELECT '[5-10>' BIN, SUM(CASE WHEN DURATION/60>=5 AND DURATION/60<10 THEN 1 ELSE 0 END) TOTAL FROM SESSIONS UNION ALL SELECT '[10-15>' BIN, SUM(CASE WHEN DURATION/60>=10 AND DURATION/60<15 THEN 1 ELSE 0 END) TOTAL FROM SESSIONS UNION ALL SELECT '15 or more' BIN, SUM(CASE WHEN DURATION/60>=15 THEN 1 ELSE 0 END) TOTAL FROM SESSIONS"
280,Y,Y,"WITH BIN_CNT AS ( SELECT *, DURATION/60, CASE WHEN (DURATION < 300) THEN '[0-5>' WHEN (300 <= DURATION) AND (DURATION < 600) THEN '[5-10>' WHEN (600 <= DURATION) AND (DURATION < 900) THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS), BIN_TABLE AS ( SELECT '[0-5>' AS BIN FROM DUAL UNION SELECT '[5-10>' FROM DUAL UNION SELECT '[10-15>' FROM DUAL UNION SELECT '15 or more' FROM DUAL ) SELECT T.BIN, COUNT(C.SESSION_ID) AS TOTAL FROM BIN_TABLE T LEFT JOIN BIN_CNT C ON T.BIN = C.BIN GROUP BY T.BIN"
281,Y,Y,"SELECT T1.BIN,IFNULL(T2.TOTAL,0) AS TOTAL FROM (SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more' AS BIN) T1 LEFT JOIN (SELECT CASE WHEN DURATION<300 THEN '[0-5>' WHEN DURATION<600 THEN '[5-10>' WHEN DURATION<900 THEN '[10-15>' ELSE '15 or more' END AS BIN ,COUNT(*) AS TOTAL FROM SESSIONS GROUP BY 1) AS T2 ON T1.BIN=T2.BIN"
282,Y,Y,"WITH CTE AS ( SELECT SESSION_ID, DURATION, CASE WHEN DURATION/60 < 5 THEN '[0-5>' WHEN DURATION/60 < 10 THEN '[5-10>' WHEN DURATION/60 < 15 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS) SELECT SUB.BIN, COUNT(SESSION_ID) TOTAL FROM CTE RIGHT JOIN (SELECT '[0-5>' BIN UNION ALL SELECT '[5-10>' BIN UNION ALL SELECT '[10-15>' BIN UNION ALL SELECT '15 or more' BIN) SUB ON SUB.BIN = CTE.BIN GROUP BY SUB.BIN"
283,Y,Y,"SELECT S.BIN, IFNULL(T.TOTAL, 0) AS TOTAL FROM ( SELECT (CASE WHEN DURATION/60 < 5 THEN '[0-5>' WHEN DURATION/60 < 10 AND DURATION/60 >= 5 THEN '[5-10>' WHEN DURATION/60 < 15 AND DURATION/60 >= 10 THEN '[10-15>' ELSE '15 or more' END) AS BIN, COUNT(*) AS TOTAL FROM SESSIONS GROUP BY BIN) T RIGHT JOIN (SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN) S ON T.BIN = S.BIN"
284,Y,Y,"WITH SESSION_TIME AS ( SELECT SESSION_ID, CASE WHEN DURATION / 60.0 < 5 THEN '[0-5>' WHEN DURATION / 60.0 >= 5 AND DURATION / 60.0 < 10 THEN '[5-10>' WHEN DURATION / 60.0 >= 10 AND DURATION / 60.0 < 15 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS ), BINS AS ( SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more AS BIN' ) SELECT B.BIN, COUNT(S.SESSION_ID) AS TOTAL FROM BINS B LEFT JOIN SESSION_TIME S ON B.BIN = S.BIN GROUP BY B.BIN"
285,Y,Y,"WITH CTE AS (SELECT * FROM (SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN) A) SELECT CTE.BIN, IFNULL(B.TOTAL,0) AS TOTAL FROM CTE LEFT JOIN (SELECT CASE WHEN DURATION BETWEEN 0 AND 4.999999 THEN '[0-5>' WHEN DURATION BETWEEN 5 AND 9.99999 THEN '[5-10>' WHEN DURATION BETWEEN 10 AND 14.99999 THEN '[10-15>' ELSE '15 or more' END AS BIN , IFNULL(COUNT(DURATION),0) AS TOTAL FROM (SELECT SESSION_ID, DURATION/60 AS DURATION FROM SESSIONS) A GROUP BY BIN) B ON CTE.BIN = B.BIN"
286,Y,Y,"WITH TMP AS ( SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more AS BIN' ), GROUPED AS ( SELECT CASE WHEN DURATION / 60.0 < 5 THEN '[0-5>' WHEN DURATION / 60.0 < 10 THEN '[5-10>' WHEN DURATION / 60.0 < 15 THEN '[10-15>' ELSE '15 or more' END AS BIN, COUNT(*) AS TOTAL FROM SESSIONS GROUP BY BIN ) SELECT T.BIN, IFNULL(G.TOTAL, 0) AS TOTAL FROM TMP T LEFT JOIN GROUPED G ON T.BIN = G.BIN"
287,Y,N,"SELECT '[0-5>' AS BIN, COUNT(SESSION_ID) TOTAL FROM SESSIONS WHERE (DURATION/60) BETWEEN 0 AND 5 UNION SELECT '[5-10>' AS BIN, COUNT(SESSION_ID) TOTAL FROM SESSIONS WHERE (DURATION/60) BETWEEN 5 AND 10 UNION SELECT '[10-15>' AS BIN, COUNT(SESSION_ID) TOTAL FROM SESSIONS WHERE (DURATION/60) BETWEEN 10 AND 15 UNION SELECT '15 or more' AS BIN, COUNT(SESSION_ID) TOTAL FROM SESSIONS WHERE (DURATION/60)>= 15"
288,Y,N,"WITH BT AS(SELECT SESSION_ID , CASE WHEN DURATION/60 BETWEEN 0 AND 5 THEN '[0-5>' WHEN DURATION/60 BETWEEN 5 AND 10 THEN '[5-10>' WHEN DURATION/60 BETWEEN 10 AND 15 THEN '[10-15>' WHEN DURATION/60>15 THEN '15 or more' ELSE 0 END AS BIN FROM SESSIONS), BT1 AS ( SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more AS BIN' ) SELECT BT1.BIN,COUNT(BT.BIN) AS TOTAL FROM BT1 LEFT JOIN BT ON BT1.BIN=BT.BIN GROUP BY BT1.BIN"
289,Y,N,"SELECT '[0-5>' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE (DURATION/60) < 5 UNION SELECT '[5-10>' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE (DURATION/60) BETWEEN 5 AND 10 UNION SELECT '[10-15>' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE (DURATION/60) BETWEEN 10 AND 15 UNION SELECT '15 or more' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE (DURATION/60) > 15"
290,Y,Y,"SELECT '[0-5>' AS BIN,SUM(CASE WHEN (DURATION/60)<5 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN,SUM(CASE WHEN (DURATION/60)<10 AND (DURATION/60)>=5 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN,SUM(CASE WHEN (DURATION/60)<15 AND (DURATION/60)>=10 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN,SUM(CASE WHEN (DURATION/60)>=15 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS"
291,Y,Y,"WITH BIN_COL AS ( SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN ), BIN_CALCULATED AS (SELECT CASE WHEN DURATION/60 >= 0 AND DURATION/60 <5 THEN '[0-5>' WHEN DURATION/60 >= 5 AND DURATION/60 <10 THEN '[5-10>' WHEN DURATION/60 >= 10 AND DURATION/60 <15 THEN '[10-15>' WHEN DURATION/60 >= 15 THEN '15 or more' END AS BIN, COUNT(*) AS TOTAL FROM SESSIONS GROUP BY 1) SELECT T1.BIN, IFNULL(T2.TOTAL,0) AS TOTAL FROM BIN_COL T1 LEFT JOIN BIN_CALCULATED T2 ON T1.BIN = T2.BIN"
292,Y,Y,"WITH A AS(SELECT CASE WHEN DURATION>=0 AND DURATION <300 THEN '[0-5>' WHEN DURATION>=300 AND DURATION <600 THEN '[5-10>' WHEN DURATION>=600 AND DURATION <900 THEN '[10-15>' ELSE '15 or more' END AS BIN, SESSION_ID FROM SESSIONS), B AS( SELECT '[0-5>' AS BIN FROM SESSIONS UNION SELECT '[5-10>' AS BIN FROM SESSIONS UNION SELECT '[10-15>' AS BIN FROM SESSIONS UNION SELECT '15 or more' AS BIN FROM SESSIONS) SELECT B.BIN, IFNULL(COUNT(SESSION_ID),0) AS TOTAL FROM B LEFT JOIN A USING (BIN) GROUP BY 1"
293,Y,Y,"WITH BINS AS (SELECT 0*60 AS LB, 5*60 AS UB, '[0-5>' AS BIN UNION SELECT 5*60 AS LB, 10*60 AS UB, '[5-10>' AS BIN UNION SELECT 10*60 AS LB, 15*60 AS UB, '[10-15>' AS BIN UNION SELECT 15*60 AS LB, 2147483647 AS UB, '15 or more' AS BIN) SELECT B.BIN, IFNULL(COUNT(S.SESSION_ID), 0) AS TOTAL FROM BINS B LEFT JOIN SESSIONS S ON S.DURATION >= B.LB AND S.DURATION < B.UB GROUP BY B.BIN"
294,Y,Y,"SELECT SUM(CASE WHEN DURATION < 300 THEN 1 ELSE 0 END) AS TOTAL, '[0-5>' BIN FROM SESSIONS UNION SELECT SUM(CASE WHEN DURATION >= 300 AND DURATION < 600 THEN 1 ELSE 0 END) AS TOTAL, '[5-10>' BIN FROM SESSIONS UNION SELECT SUM(CASE WHEN DURATION >= 600 AND DURATION < 900 THEN 1 ELSE 0 END) AS TOTAL, '[10-15>' BIN FROM SESSIONS UNION SELECT SUM(CASE WHEN DURATION >= 900 THEN 1 ELSE 0 END) AS TOTAL, '15 or more' BIN FROM SESSIONS"
295,Y,Y,"WITH CTE AS ( SELECT SESSION_ID, IF(DURATION/60 < 5, 1, 0) AS BIN_1, IF(DURATION/60 >= 5 AND DURATION/60 < 10, 1, 0) AS BIN_2, IF(DURATION/60 >= 10 AND DURATION/60 < 15, 1, 0) AS BIN_3, IF(DURATION/60 >= 15, 1, 0) AS BIN_4 FROM SESSIONS ) SELECT '[0-5>' AS BIN, SUM(BIN_1) AS TOTAL FROM CTE UNION SELECT '[5-10>' AS BIN, SUM(BIN_2) AS TOTAL FROM CTE UNION SELECT '[10-15>' AS BIN, SUM(BIN_3) AS TOTAL FROM CTE UNION SELECT '15 or more' AS BIN, SUM(BIN_4) AS TOTAL FROM CTE"
296,Y,Y,"SELECT '[0-5>' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION < 300 UNION SELECT '[5-10>' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION >= 300 AND DURATION < 600 UNION SELECT '[10-15>' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION < 900 AND DURATION >= 600 UNION SELECT '15 or more' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION >= 900"
297,Y,Y,"SELECT '[0-5>' AS BIN, COUNT(CASE WHEN DURATION/60 <5 THEN 1 END) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN, COUNT(CASE WHEN DURATION/60>=5 AND DURATION/60<10 THEN 1 END) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN, COUNT(CASE WHEN DURATION/60>=10 AND DURATION/60<15 THEN 1 END) AS TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN, COUNT(CASE WHEN DURATION/60>=15 THEN 1 END) AS TOTAL FROM SESSIONS"
298,Y,N,"WITH BINS AS ( SELECT '[0-5>' AS BIN, 0 AS MIN, 300 AS MAX UNION SELECT '[5-10>' AS BIN, 300 AS MIN, 600 AS MAX UNION SELECT '[10-15>' AS BIN, 600 AS MIN, 900 AS MAX UNION SELECT '15 or more' AS BIN, 900 AS MIN, NULL AS MAX ) SELECT B.BIN, COUNT(S.SESSION_ID) AS TOTAL FROM BINS B LEFT JOIN SESSIONS S ON S.DURATION >= B.MIN AND (B.MAX IS NULL OR S.DURATION <= B.MAX) GROUP BY 1"
299,Y,Y,"WITH T2 AS ( SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more' AS BIN), T AS (SELECT SESSION_ID, CASE WHEN DURATION/60>=0 AND DURATION/60<5 THEN '[0-5>' WHEN DURATION/60>=5 AND DURATION/60<10 THEN '[5-10>' WHEN DURATION/60>=10 AND DURATION/60<15 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS) SELECT T2.BIN, COUNT(SESSION_ID) AS TOTAL FROM T2 LEFT JOIN T ON T2.BIN=T.BIN GROUP BY T2.BIN"
300,Y,Y,"(SELECT '[0-5>' AS BIN, SUM(CASE WHEN DURATION/60 < 5 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS) UNION ALL (SELECT '[5-10>' AS BIN, SUM(CASE WHEN (DURATION/60 >= 5 AND DURATION/60 < 10) THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS) UNION ALL (SELECT '[10-15>' AS BIN, SUM(CASE WHEN (DURATION/60 >= 10 AND DURATION/60 < 15) THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS) UNION ALL (SELECT '15 or more' AS BIN, SUM(CASE WHEN DURATION/60 >= 15 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS)"
301,Y,Y,"WITH A AS ( SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN ) SELECT A.BIN, IFNULL(TOTAL,0) AS TOTAL FROM A LEFT JOIN ( SELECT CASE WHEN DURATION/60>=15 THEN '15 or more' WHEN DURATION/60>=10 THEN '[10-15>' WHEN DURATION/60>=5 THEN '[5-10>' ELSE '[0-5>' END AS BIN, COUNT(*) AS TOTAL FROM SESSIONS GROUP BY 1 ) AS B ON A.BIN=B.BIN"
302,Y,N,"SELECT COUNT(CASE WHEN DURATION<5*60 THEN 1 END) AS TOTAL, '[0-5>' AS BIN FROM SESSIONS UNION SELECT COUNT(CASE WHEN (DURATION<10*60 AND DURATION>=5*60) THEN 1 END) AS TOTAL, '[5-10>' AS BIN FROM SESSIONS UNION SELECT COUNT(CASE WHEN (DURATION<15*60 AND DURATION>=10*60) THEN 1 END) AS TOTAL, '[10-15>' AS BIN FROM SESSIONS UNION SELECT COUNT(CASE WHEN DURATION>15*60 THEN 1 END) AS TOTAL, '15 or more' AS BIN FROM SESSIONS"
303,Y,Y,"WITH T1 AS (SELECT *, CASE WHEN DURATION/60 < 5 THEN '[0-5>' WHEN DURATION/60 < 10 AND DURATION/60 >=5 THEN '[5-10>' WHEN DURATION/60 < 15 AND DURATION/60 >=10 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS), T2 AS( SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more' AS BIN) SELECT T2.BIN, COUNT(T1.BIN) AS TOTAL FROM T2 LEFT JOIN T1 ON T2.BIN = T1.BIN GROUP BY 1"
304,Y,Y,"WITH NEW AS( SELECT '[0-5>' BIN UNION ALL SELECT '[5-10>' UNION ALL SELECT '[10-15>' UNION ALL SELECT '15 or more') SELECT N.BIN, IFNULL(TOTAL,0) TOTAL FROM NEW N LEFT JOIN (SELECT BIN, COUNT(SESSION_ID) TOTAL FROM (SELECT SESSION_ID , CASE WHEN DURATION >= 0 AND DURATION < 300 THEN '[0-5>' WHEN DURATION >= 300 AND DURATION < 600 THEN '[5-10>' WHEN DURATION >= 600 AND DURATION < 900 THEN '[10-15>' ELSE '15 or more' END BIN FROM SESSIONS) T GROUP BY 1) T2 ON N.BIN = T2.BIN"
305,Y,Y,"WITH CTE AS ( SELECT '[0-5>' AS BIN, 0 AS MIN_DURATION, 5*60 AS MAX_DURATION UNION ALL SELECT '[5-10>' AS BIN, 5*60 AS MIN_DURATION, 10*60 AS MAX_DURATION UNION ALL SELECT '[10-15>' AS BIN, 10*60 AS MIN_DURATION, 15*60 AS MAX_DURATION UNION ALL SELECT '15 or more' AS BIN, 15*60 AS MIN_DURATION, 2147483647 AS MAX_DURATION ) SELECT CTE.BIN, COUNT(S.SESSION_ID) AS TOTAL FROM SESSIONS S RIGHT JOIN CTE ON S.DURATION < CTE.MAX_DURATION AND S.DURATION >= CTE.MIN_DURATION GROUP BY CTE.BIN"
306,Y,N,"SELECT '[0-5>' AS BIN, COALESCE(COUNT(DISTINCT SESSION_ID), 0) AS TOTAL FROM SESSIONS WHERE DURATION/60 < 5 UNION SELECT '[5-10>' AS BIN, COALESCE(COUNT(DISTINCT SESSION_ID), 0) AS TOTAL FROM SESSIONS WHERE DURATION/60 BETWEEN 5 AND 10 UNION SELECT '[10-15>' AS BIN, COALESCE(COUNT(DISTINCT SESSION_ID), 0) AS TOTAL FROM SESSIONS WHERE DURATION/60 BETWEEN 10 AND 15 UNION SELECT '15 or more' AS BIN, COALESCE(COUNT(DISTINCT SESSION_ID), 0) AS TOTAL FROM SESSIONS WHERE DURATION/60 >= 15"
307,Y,N,"SELECT '[0-5>' BIN, COUNT(*) TOTAL FROM SESSIONS WHERE DURATION/60 <=5 UNION SELECT '[5-10>', COUNT(*) FROM SESSIONS WHERE DURATION/60 >5 AND DURATION/60 <=10 UNION SELECT '[10-15>', COUNT(*) FROM SESSIONS WHERE DURATION/60 >10 AND DURATION/60 <=15 UNION SELECT '15 or more', COUNT(*) FROM SESSIONS WHERE DURATION/60 >15"
308,Y,N,"SELECT '[0-5>' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION/60 BETWEEN 0 AND 5 UNION SELECT '[5-10>' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION/60 BETWEEN 5.01 AND 10 UNION SELECT '[10-15>' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION/60 BETWEEN 10.01 AND 15 UNION SELECT '15 or more' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION/60 > 15"
309,Y,Y,"WITH CTE AS ( SELECT '[0-5>' AS BIN , 0 AS MIN_DURATION , 300 AS MAX_DURATION UNION ALL SELECT '[5-10>' AS BIN , 300 AS MIN_DURATION , 600 AS MAX_DURATION UNION ALL SELECT '[10-15>' AS BIN , 600 AS MIN_DURATION , 900 AS MAX_DURATION UNION ALL SELECT '15 or more' AS BIN , 900 AS MIN_DURATION , 2147483647 AS MAX_DURATION ) SELECT B.BIN , COUNT(SESSION_ID) AS TOTAL FROM SESSIONS A RIGHT JOIN CTE B ON A.DURATION >= B.MIN_DURATION AND A.DURATION < B.MAX_DURATION GROUP BY 1"
310,Y,Y,"SELECT '[0-5>' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS S WHERE DURATION/60 >=0 AND DURATION/60 < 5 UNION SELECT '[5-10>' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS S WHERE DURATION/60 >=5 AND DURATION/60 < 10 UNION SELECT '[10-15>' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS S WHERE DURATION/60 >=10 AND DURATION/60 < 15 UNION SELECT '15 or more' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS S WHERE DURATION/60 >=15"
311,Y,Y,"SELECT '[0-5>' AS BIN, SUM(IF(DURATION/60<5,1,0)) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN, SUM(IF(DURATION/60>=5 AND DURATION/60 < 10,1,0)) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN, SUM(IF(DURATION/60>=10 AND DURATION/60 < 15,1,0)) AS TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN, SUM(IF(15<=DURATION/60,1,0)) AS TOTAL FROM SESSIONS"
312,Y,Y,"WITH CTE AS ( SELECT SESSION_ID, DURATION, SUM(ROUND(DURATION/60, 2)<5) AS BIN1, SUM((ROUND(DURATION/60, 2)>=5) AND ROUND(DURATION/60, 2)<10) AS BIN2, SUM((ROUND(DURATION/60, 2)>=10) AND (ROUND(DURATION/60, 2)<15)) AS BIN3, SUM(ROUND(DURATION/60, 2)>=15) AS BIN4 FROM SESSIONS) SELECT '[0-5>' AS BIN, BIN1 AS TOTAL FROM CTE UNION SELECT '[5-10>' AS BIN, BIN2 AS TOTAL FROM CTE UNION SELECT '[10-15>' AS BIN, BIN3 AS TOTAL FROM CTE UNION SELECT '15 or more' AS BIN, BIN4 AS TOTAL FROM CTE"
313,Y,Y,"WITH BINS AS (SELECT SESSION_ID, CASE WHEN DURATION/60<5 THEN '[0-5>' WHEN DURATION/60<10 THEN '[5-10>' WHEN DURATION/60<15 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS) SELECT A.BIN, IFNULL(TOTAL,0) AS TOTAL FROM( SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more AS BIN') A LEFT JOIN ( SELECT BIN, COUNT(SESSION_ID) AS TOTAL FROM BINS GROUP BY BIN) B ON A.BIN=B.BIN"
314,Y,Y,"WITH LKP AS ( SELECT '[0-5>' AS BIN FROM SESSIONS UNION SELECT '[5-10>' AS BIN FROM SESSIONS UNION SELECT '[10-15>' AS BIN FROM SESSIONS UNION SELECT '15 or more' AS BIN FROM SESSIONS ) ,LKP2 AS (SELECT CASE WHEN DURATION/60<5 THEN '[0-5>' WHEN DURATION/60 >= 5 AND DURATION/60 < 10 THEN '[5-10>' WHEN DURATION/60 >=10 AND DURATION/60 <15 THEN '[10-15>' ELSE '15 or more' END AS BIN ,COUNT(*) AS TOTAL FROM SESSIONS GROUP BY BIN ) SELECT A.BIN,COALESCE(B.TOTAL,0) TOTAL FROM LKP A LEFT JOIN LKP2 B ON A.BIN=B.BIN"
315,Y,Y,"SELECT '[0-5>' AS BIN, SUM(DURATION >=0 AND DURATION < 5*60) AS TOTAL FROM SESSIONS S UNION SELECT '[5-10>' AS BIN, SUM(DURATION >=5*60 AND DURATION < 10*60) AS TOTAL FROM SESSIONS S UNION SELECT '[10-15>' AS BIN, SUM(DURATION >=10*60 AND DURATION < 15*60) AS TOTAL FROM SESSIONS S UNION SELECT '15 or more' AS BIN, SUM(DURATION >=15*60) AS TOTAL FROM SESSIONS S"
316,Y,Y,"SELECT '[0-5>' AS BIN, COUNT(DURATION) AS TOTAL FROM SESSIONS WHERE DURATION < 5*60 UNION SELECT '[5-10>' AS BIN, COUNT(DURATION) AS TOTAL FROM SESSIONS WHERE DURATION >= 5*60 AND DURATION < 10*60 UNION SELECT '[10-15>' AS BIN, COUNT(DURATION) AS TOTAL FROM SESSIONS WHERE DURATION >= 10*60 AND DURATION < 15*60 UNION SELECT '15 or more' AS BIN, COUNT(DURATION) AS TOTAL FROM SESSIONS WHERE DURATION >= 15*60"
317,Y,N,"SELECT T.BIN, IFNULL(T1.TOTAL,0) AS TOTAL FROM ( SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more' AS BIN ) AS T LEFT JOIN LATERAL (SELECT CASE WHEN DURATION/60 >= 0 AND DURATION/60< 5 THEN '[0-5>' WHEN ROUND(DURATION/60,2)>= 5 AND DURATION/60 <10 THEN '[5-10>' WHEN ROUND(DURATION/60,2)>= 10 AND DURATION/60 < 15 THEN '[10-15>' WHEN ROUND(DURATION/60,2) > 15 THEN '15 or more' END AS BIN, COUNT(DURATION) AS TOTAL FROM SESSIONS GROUP BY CASE WHEN DURATION/60 >= 0 AND DURATION/60< 5 THEN '[0-5>' WHEN ROUND(DURATION/60,2)>= 5 AND DURATION/60 <10 THEN '[5-10>' WHEN ROUND(DURATION/60,2)>= 10 AND DURATION/60 < 15 THEN '[10-15>' WHEN ROUND(DURATION/60,2) > 15 THEN '15 or more' END ) AS T1 ON T1.BIN = T.BIN"
318,Y,Y,"(SELECT '[0-5>' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION<300) UNION (SELECT '[5-10>' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION>=300 AND DURATION<600) UNION (SELECT '[10-15>' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION>=600 AND DURATION<900) UNION (SELECT '15 or more' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION>=900)"
319,Y,N,"SELECT '[0-5>' BIN , COUNT(*) TOTAL FROM SESSIONS WHERE (DURATION/60) <5 UNION SELECT '[5-10>' BIN , COUNT(*) TOTAL FROM SESSIONS WHERE (DURATION/60) BETWEEN 5 AND 10 UNION SELECT '[10-15>' BIN , COUNT(*) TOTAL FROM SESSIONS WHERE (DURATION/60) BETWEEN 10 AND 15 UNION SELECT '15 or more' BIN , COUNT(*) TOTAL FROM SESSIONS WHERE (DURATION/60)>=15"
320,Y,N,"SELECT L.BIN, COUNT(L.SESSION_ID) AS TOTAL FROM ( SELECT S.SESSION_ID, C.BIN FROM ( SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' UNION ALL SELECT '[10-15>' UNION ALL SELECT '15 or more' )AS C LEFT JOIN ( SELECT S1.SESSION_ID, CASE WHEN S1.DURATION/60 <= 5 AND S1.DURATION/60 > 0 THEN '[0-5>' WHEN S1.DURATION/60 <= 10 AND S1.DURATION/60 > 5 THEN '[5-10>' WHEN S1.DURATION/60 <= 15 AND S1.DURATION/60 > 10 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS AS S1 )AS S ON S.BIN = C.BIN ) AS L GROUP BY L.BIN"
321,Y,Y,"WITH CTE AS ( SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' UNION SELECT '[10-15>' UNION SELECT '15 or more') SELECT CTE.BIN,IFNULL(CNT,0) AS TOTAL FROM CTE LEFT JOIN ( SELECT BIN,COUNT(DISTINCT SESSION_ID) AS CNT FROM ( SELECT SESSION_ID,CASE WHEN DURATION/60>=0 AND DURATION/60<5 THEN '[0-5>' WHEN DURATION/60>=5 AND DURATION/60<10 THEN '[5-10>' WHEN DURATION/60>=10 AND DURATION/60<15 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS) T1 GROUP BY 1) T2 USING (BIN)"
322,Y,Y,"SELECT '[0-5>' AS BIN, SUM(CASE WHEN DURATION < 300 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION ALL SELECT '[5-10>' AS BIN, SUM(CASE WHEN DURATION >= 5*60 AND DURATION < 10*60 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION ALL SELECT '[10-15>' AS BIN, SUM(CASE WHEN DURATION >= 10*60 AND DURATION < 15*60 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION ALL SELECT '15 or more' AS BIN, SUM(CASE WHEN DURATION >= 15*60 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS"
323,Y,Y,"WITH BINS AS ( SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' UNION SELECT '[10-15>' UNION SELECT '15 or more' ), BINNING AS ( SELECT SESSION_ID, (CASE WHEN DURATION / 60 < 5 THEN '[0-5>' WHEN DURATION / 60 >= 5 AND DURATION / 60 < 10 THEN '[5-10>' WHEN DURATION / 60 >=10 AND DURATION / 60 < 15 THEN '[10-15>' ELSE '15 or more' END) BIN FROM SESSIONS ) SELECT B.BIN, IFNULL(COUNT(SESSION_ID),0) TOTAL FROM BINS B LEFT JOIN BINNING BN USING(BIN) GROUP BY BIN"
324,Y,Y,"SELECT '[0-5>' AS BIN, COUNT(DURATION) AS TOTAL FROM SESSIONS WHERE DURATION < 300 UNION SELECT '[5-10>', COUNT(DURATION) FROM SESSIONS WHERE DURATION BETWEEN 300 AND 599 UNION SELECT '[10-15>', COUNT(DURATION) FROM SESSIONS WHERE DURATION BETWEEN 600 AND 899 UNION SELECT '15 or more', COUNT(DURATION) FROM SESSIONS WHERE DURATION >= 900"
325,Y,N,"WITH CTE AS (SELECT SESSION_ID, DURATION/60 AS DUR_MIN FROM SESSIONS ) SELECT '[0-5>' AS BIN, SUM(CASE WHEN DUR_MIN BETWEEN 0 AND 5 THEN 1 ELSE 0 END) AS TOTAL FROM CTE UNION SELECT '[5-10>' AS BIN, SUM(CASE WHEN DUR_MIN BETWEEN 5 AND 10 THEN 1 ELSE 0 END) AS TOTAL FROM CTE UNION SELECT '[10-15>' AS BIN, SUM(CASE WHEN DUR_MIN BETWEEN 10 AND 15 THEN 1 ELSE 0 END) AS TOTAL FROM CTE UNION SELECT '15 or more' AS BIN, SUM(CASE WHEN DUR_MIN > 15 THEN 1 ELSE 0 END) AS TOTAL FROM CTE"
326,Y,Y,"WITH CTE AS ( SELECT CASE WHEN DURATION / 60.0 < 5 THEN '[0-5>' WHEN DURATION / 60.0 >= 5 AND DURATION / 60.0 < 10 THEN '[5-10>' WHEN DURATION / 60.0 >= 10 AND DURATION / 60.0 < 15 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS ), BINS AS ( SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more' AS BIN ) SELECT A.BIN, IFNULL(COUNT(B.BIN), 0) AS TOTAL FROM BINS A LEFT JOIN CTE B ON A.BIN = B.BIN GROUP BY A.BIN"
327,Y,N,"WITH DURATIONS AS( SELECT CASE WHEN DURATION/60 BETWEEN 0 AND 5 THEN '[0-5>' WHEN DURATION/60 BETWEEN 5 AND 10 THEN '[5-10>' WHEN DURATION/60 BETWEEN 10 AND 15 THEN '[10-15>' WHEN DURATION/60 >=15 THEN '15 or more' END BIN, COUNT(DURATION) TOTAL FROM SESSIONS GROUP BY BIN), BINS AS (SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' UNION SELECT '[10-15>' UNION SELECT '15 or more') SELECT B.BIN, COALESCE(D.TOTAL,0) TOTAL FROM DURATIONS D RIGHT JOIN BINS B ON D.BIN=B.BIN"
328,Y,Y,"SELECT '[0-5>' AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS WHERE DURATION/60 >= 0 AND DURATION / 60 < 5 UNION ALL SELECT '[5-10>' AS BIN, COUNT(SESSION_ID) FROM SESSIONS WHERE DURATION/60 >= 5 AND DURATION / 60 < 10 UNION ALL SELECT '[10-15>' AS BIN, COUNT(SESSION_ID) FROM SESSIONS WHERE DURATION/60 >= 10 AND DURATION / 60 < 15 UNION ALL SELECT '15 or more' AS BIN, COUNT(SESSION_ID) FROM SESSIONS WHERE DURATION/60 >= 15"
329,Y,Y,"WITH BIN AS( SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more' AS BIN ), TMP AS( SELECT *, CASE WHEN (DURATION/60)<5 THEN '[0-5>' WHEN (DURATION/60)>= 5 AND (DURATION/60)<10 THEN '[5-10>' WHEN (DURATION/60)>= 10 AND (DURATION/60)<15 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS ) SELECT BIN.BIN, IFNULL(COUNT(TMP.SESSION_ID),0) AS TOTAL FROM BIN LEFT JOIN TMP USING(BIN) GROUP BY 1"
330,Y,N,"(SELECT '[0-5>' AS BIN, SUM(CASE WHEN DURATION/60 < 5 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS) UNION (SELECT '[5-10>' AS BIN, SUM(CASE WHEN DURATION/60 BETWEEN 5 AND 10 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS) UNION (SELECT '[10-15>' AS BIN, SUM(CASE WHEN DURATION/60 BETWEEN 10 AND 15 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS) UNION (SELECT '15 or more' AS BIN, SUM(CASE WHEN DURATION/60 > 15 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS)"
331,Y,Y,"SELECT '[0-5>' AS BIN,COUNT(*)AS TOTAL FROM SESSIONS WHERE DURATION/60<5 UNION SELECT'[5-10>' AS BIN,COUNT(*)AS TOTAL FROM SESSIONS WHERE DURATION/60<10 AND DURATION/60>=5 UNION SELECT'[10-15>' AS BIN,COUNT(*)AS TOTAL FROM SESSIONS WHERE DURATION/60>=10 AND DURATION/60<15 UNION SELECT'15 or more'AS BIN,COUNT(*)AS TOTAL FROM SESSIONS WHERE DURATION/60>=15"
332,Y,Y,"SELECT '[0-5>' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION < 5 * 60 UNION SELECT '[5-10>' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION >= 5 * 60 AND DURATION < 10 * 60 UNION SELECT '[10-15>' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION >= 10 * 60 AND DURATION < 15 * 60 UNION SELECT '15 or more' AS BIN, COUNT(*) AS TOTAL FROM SESSIONS WHERE DURATION >= 15 * 60"
333,Y,N,"SELECT '[0-5>' AS BIN, COUNT(SESSION_ID ) AS TOTAL FROM SESSIONS WHERE DURATION<300 UNION SELECT '[5-10>' AS BIN, COUNT(SESSION_ID ) AS TOTAL FROM SESSIONS WHERE DURATION BETWEEN 300 AND 600 UNION SELECT '[10-15>' AS BIN, COUNT(SESSION_ID ) AS TOTAL FROM SESSIONS WHERE DURATION BETWEEN 600 AND 900 UNION SELECT '15 or more' AS BIN, COUNT(SESSION_ID ) AS TOTAL FROM SESSIONS WHERE DURATION > 900"
334,Y,Y,"WITH CTE AS ( SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' UNION SELECT '[10-15>' UNION SELECT '15 or more' ) SELECT CTE.BIN, COUNT(T.SESSION_ID) AS TOTAL FROM CTE LEFT JOIN ( SELECT *, CASE WHEN DURATION < 5 * 60 THEN '[0-5>' WHEN DURATION >= 5 * 60 AND DURATION < 10 * 60 THEN '[5-10>' WHEN DURATION >= 10 * 60 AND DURATION < 15 * 60 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS ) T ON T.BIN = CTE.BIN GROUP BY 1"
335,Y,Y,"WITH A AS ( SELECT CASE WHEN DURATION < 5*60 THEN '[0-5>' WHEN DURATION < 10*60 THEN '[5-10>' WHEN DURATION < 15*60 THEN '[10-15>' ELSE '15 or more' END AS BIN , COUNT(*) AS TOTAL FROM SESSIONS GROUP BY BIN ) SELECT B.BIN, IFNULL(A.TOTAL, 0) AS TOTAL FROM A RIGHT JOIN (SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN) B ON B.BIN=A.BIN"
336,Y,Y,"SELECT '[0-5>' AS BIN , SUM(IF(DURATION/60<5,1,0)) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN , SUM(IF(DURATION/60>=5 AND DURATION/60<10,1,0)) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN , SUM(IF(DURATION/60>=10 AND DURATION/60<15,1,0)) AS TOTAL FROM SESSIONS UNION SELECT '15 or more AS BIN', SUM(IF(DURATION/60>=15,1,0)) AS TOTAL FROM SESSIONS"
337,Y,N,"SELECT '[0-5>' AS BIN, COUNT(DURATION) AS TOTAL FROM SESSIONS WHERE DURATION < 300 UNION SELECT '[5-10>' AS BIN, COUNT(DURATION) AS TOTAL FROM SESSIONS WHERE DURATION BETWEEN 300 AND 600 UNION SELECT '[10-15>' AS BIN, COUNT(DURATION) AS TOTAL FROM SESSIONS WHERE DURATION BETWEEN 600 AND 900 UNION SELECT '15 or more' AS BIN, COUNT(DURATION) AS TOTAL FROM SESSIONS WHERE DURATION >= 900"
338,Y,N,"WITH TRAN AS (SELECT SESSION_ID, CASE WHEN (DURATION/60)<5 THEN '[0-5>' WHEN (DURATION/60)>5 AND (DURATION/60)<10 THEN '[5-10>' WHEN(DURATION/60)>10 AND (DURATION/60)<15 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS), MAPP AS (SELECT SESSION_ID, ROW_NUMBER()OVER(ORDER BY SESSION_ID) AS ROW1 FROM SESSIONS), MAPP_I AS (SELECT ROW1, CASE WHEN ROW1=1 THEN '[0-5>' WHEN ROW1=2 THEN '[5-10>' WHEN ROW1=3 THEN '[10-15>' ELSE '15 or more' END AS BIN1 FROM MAPP), FP AS (SELECT DISTINCT BIN1 FROM MAPP_I), SP AS (SELECT DISTINCT(BIN) AS BIN, COUNT(SESSION_ID) AS TOTAL FROM TRAN GROUP BY BIN) SELECT B.BIN1 AS BIN, IFNULL(A.TOTAL,0) AS TOTAL FROM SP A RIGHT JOIN FP B ON A.BIN=B.BIN1"
339,Y,Y,"SELECT T2.BIN, IFNULL(TOTAL, 0) AS TOTAL FROM (SELECT '[0-5>' BIN UNION SELECT '[5-10>' BIN UNION SELECT '[10-15>' BIN UNION SELECT '15 or more' BIN) AS T2 LEFT JOIN (SELECT CASE WHEN DURATION/60 >=0 AND DURATION/60 < 5 THEN '[0-5>' WHEN DURATION/60 >=5 AND DURATION/60 < 10 THEN '[5-10>' WHEN DURATION/60 >=10 AND DURATION/60 < 15 THEN '[10-15>' ELSE '15 or more' END AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS GROUP BY BIN) AS T1 ON T1.BIN = T2.BIN"
340,Y,Y,"SELECT '[0-5>' AS BIN, SUM(CASE WHEN DURATION>=0*60 AND DURATION<5*60 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN, SUM(CASE WHEN DURATION>=5*60 AND DURATION<10*60 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN, SUM(CASE WHEN DURATION>=10*60 AND DURATION<15*60 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN, SUM(CASE WHEN DURATION>=15*60 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS"
341,Y,Y,"WITH COUNTERMINS AS ( SELECT SUM((DURATION/60) < 5) AS BIN1, SUM((DURATION/60) >= 5 AND (DURATION/60) < 10) AS BIN2, SUM((DURATION/60) >= 10 AND (DURATION/60) < 15) AS BIN3, SUM((DURATION/60) >= 15) AS BIN4 FROM SESSIONS ) SELECT '[0-5>' AS BIN, BIN1 AS TOTAL FROM COUNTERMINS UNION SELECT '[5-10>' AS BIN, BIN2 AS TOTAL FROM COUNTERMINS UNION SELECT '[10-15>' AS BIN, BIN3 AS TOTAL FROM COUNTERMINS UNION SELECT '15 or more' AS BIN, BIN4 AS TOTAL FROM COUNTERMINS"
342,Y,Y,"WITH CTE AS ( SELECT '[0-5>' AS BIN, 0 AS MIN_DURATION, 5*60 AS MAX_DURATION UNION ALL SELECT '[5-10>' AS BIN, 5*60 AS MIN_DURATION, 10*60 AS MAX_DURATION UNION ALL SELECT '[10-15>' AS BIN, 10*60 AS MIN_DURATION, 15*60 AS MAX_DURATION UNION ALL SELECT '15 or more' AS BIN, 15*60 AS MIN_DURATION, POWER(2, 31) AS MAX_DURATION ) SELECT BIN, COUNT(SESSION_ID) AS TOTAL FROM CTE LEFT JOIN SESSIONS ON DURATION BETWEEN MIN_DURATION AND (MAX_DURATION - 1) GROUP BY BIN"
343,Y,Y,"WITH CTE AS ( SELECT SESSION_ID, CASE WHEN DURATION < 5*60 THEN '[0-5>' WHEN DURATION < 10*60 THEN '[5-10>' WHEN DURATION < 15*60 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS ), TPL AS ( SELECT '[0-5>' AS BIN UNION ALL SELECT '[5-10>' AS BIN UNION ALL SELECT '[10-15>' AS BIN UNION ALL SELECT '15 or more' AS BIN ) SELECT T.BIN, COALESCE(COUNT(C.BIN),NULL) AS TOTAL FROM TPL T LEFT JOIN CTE C ON T.BIN = C.BIN GROUP BY T.BIN"
344,Y,Y,"SELECT '[0-5>' AS BIN, COUNT(DURATION) TOTAL FROM SESSIONS WHERE DURATION/60<5 UNION SELECT '[5-10>' AS BIN, COUNT(DURATION) TOTAL FROM SESSIONS WHERE DURATION/60>=5 AND DURATION/60<10 UNION SELECT '[10-15>' AS BIN, COUNT(DURATION) TOTAL FROM SESSIONS WHERE DURATION/60<15 AND DURATION/60>=10 UNION SELECT '15 or more' AS BIN, COUNT(DURATION) TOTAL FROM SESSIONS WHERE DURATION/60>=15"
345,Y,Y,"SELECT '[0-5>' AS BIN, IFNULL(COUNT(*),0) AS TOTAL FROM SESSIONS WHERE DURATION/60 < 5 UNION SELECT '[5-10>' AS BIN, IFNULL(COUNT(*),0) AS TOTAL FROM SESSIONS WHERE DURATION/60 >= 5 AND DURATION/60 < 10 UNION SELECT '[10-15>' AS BIN, IFNULL(COUNT(*),0) AS TOTAL FROM SESSIONS WHERE DURATION/60 >= 10 AND DURATION/60 < 15 UNION SELECT '15 or more' AS BIN, IFNULL(COUNT(*),0) AS TOTAL FROM SESSIONS WHERE DURATION/60 >= 15"
346,Y,Y,"WITH DURATION_IN_MINUTE AS (SELECT *,ROUND(DURATION/60,4) AS TIME_IN_MINUTES FROM SESSIONS) SELECT '[0-5>' AS BIN, SUM(CASE WHEN TIME_IN_MINUTES BETWEEN 0 AND 4.9999 THEN 1 ELSE 0 END) AS TOTAL FROM DURATION_IN_MINUTE UNION SELECT '[5-10>' AS BIN, SUM(CASE WHEN TIME_IN_MINUTES BETWEEN 5 AND 9.9999 THEN 1 ELSE 0 END) AS TOTAL FROM DURATION_IN_MINUTE UNION SELECT '[10-15>' AS BIN, SUM(CASE WHEN TIME_IN_MINUTES BETWEEN 10 AND 14.9999 THEN 1 ELSE 0 END) AS TOTAL FROM DURATION_IN_MINUTE UNION SELECT '15 or more' AS BIN, SUM(CASE WHEN TIME_IN_MINUTES >= 15 THEN 1 ELSE 0 END) AS TOTAL FROM DURATION_IN_MINUTE"
347,Y,Y,"WITH COMBINED AS ( SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more AS BIN' ) SELECT COMBINED.BIN, IFNULL(COUNT(SESSION_ID),0) AS TOTAL FROM ( SELECT *, CASE WHEN (DURATION/60) <5 THEN '[0-5>' WHEN (DURATION/60) <10 THEN '[5-10>' WHEN (DURATION/60) <15 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS ) T RIGHT JOIN COMBINED USING (BIN) GROUP BY COMBINED.BIN"
348,Y,Y,"WITH T1 AS( SELECT '[0-5>' AS BIN, SUM(CASE WHEN DURATION/60>=0 AND DURATION/60 <5 THEN 1 ELSE 0 END) TOTAL FROM SESSIONS ), T2 AS( SELECT '[5-10>' AS BIN, SUM(CASE WHEN DURATION/60>=5 AND DURATION/60 <10 THEN 1 ELSE 0 END) TOTAL FROM SESSIONS ), T3 AS( SELECT '[10-15>' AS BIN, SUM(CASE WHEN DURATION/60>=10 AND DURATION/60 <15 THEN 1 ELSE 0 END) TOTAL FROM SESSIONS ), T4 AS( SELECT '15 or more' AS BIN, SUM(CASE WHEN DURATION/60>=15 THEN 1 ELSE 0 END) TOTAL FROM SESSIONS ) SELECT * FROM (SELECT * FROM T1)A UNION (SELECT * FROM T2) UNION (SELECT * FROM T3) UNION (SELECT * FROM T4)"
349,Y,Y,"WITH CTE AS( SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more' AS BIN ) SELECT A.BIN, COALESCE(COUNT(B.SESSION_ID),0) AS TOTAL FROM CTE A LEFT OUTER JOIN (SELECT *, CASE WHEN DURATION>=0 AND DURATION<300 THEN '[0-5>' WHEN DURATION>=300 AND DURATION<600 THEN '[5-10>' WHEN DURATION>=600 AND DURATION<900 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS )B ON A.BIN=B.BIN GROUP BY A.BIN"
350,Y,Y,"WITH CTE AS (SELECT SESSION_ID,DURATION ,CASE WHEN (DURATION/60)<5 THEN '[0-5>' WHEN (DURATION/60)<10 THEN '[5-10>' WHEN (DURATION/60)<15 THEN '[10-15>' ELSE '15 or more' END AS BIN FROM SESSIONS), CTE1 AS (SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more' AS BIN) SELECT B.BIN,COUNT(A.SESSION_ID) AS TOTAL FROM CTE A RIGHT JOIN CTE1 B ON A.BIN=B.BIN GROUP BY BIN"
351,Y,Y,"SELECT '[0-5>' AS BIN, (SELECT COUNT(*) FROM SESSIONS WHERE DURATION<300) AS TOTAL UNION SELECT '[5-10>', (SELECT COUNT(*) FROM SESSIONS WHERE 300<=DURATION AND DURATION<600) UNION SELECT '[10-15>', (SELECT COUNT(*) FROM SESSIONS WHERE 600<=DURATION AND DURATION<900) UNION SELECT '15 or more', (SELECT COUNT(*) FROM SESSIONS WHERE 900<=DURATION)"
352,Y,Y,"WITH T1 AS( SELECT '[0-5>' AS BIN UNION SELECT '[5-10>' AS BIN UNION SELECT '[10-15>' AS BIN UNION SELECT '15 or more' AS BIN) ,T2 AS ( SELECT CASE WHEN (DURATION/60) < 5 THEN '[0-5>' WHEN (DURATION/60) < 10 AND (DURATION/60) >= 5 THEN '[5-10>' WHEN (DURATION/60) < 15 AND (DURATION/60) >= 10 THEN '[10-15>' WHEN (DURATION/60) >= 15 THEN '15 or more' END AS BIN, COUNT(SESSION_ID) AS TOTAL FROM SESSIONS GROUP BY 1) SELECT A.BIN, IFNULL(B.TOTAL, 0) AS TOTAL FROM T1 A LEFT JOIN T2 B ON A.BIN = B.BIN"
353,Y,Y,"SELECT '[0-5>' AS BIN, SUM(CASE WHEN DURATION/60 >= 0 AND DURATION/60 < 5 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN, SUM(CASE WHEN DURATION/60 >= 5 AND DURATION/60 < 10 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN, SUM(CASE WHEN DURATION/60 >= 10 AND DURATION/60 < 15 THEN 1 ELSE 0 END) AS TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN, SUM(CASE WHEN DURATION/60 >= 15 THEN 1 ELSE 0 END) TOTAL FROM SESSIONS"
354,Y,Y,"SELECT '[0-5>' AS BIN, SUM(CASE WHEN DURATION/60 <5 THEN 1 ELSE 0 END) TOTAL FROM SESSIONS UNION SELECT '[5-10>' AS BIN, SUM(CASE WHEN DURATION/60>=5 AND DURATION/60<10 THEN 1 ELSE 0 END) TOTAL FROM SESSIONS UNION SELECT '[10-15>' AS BIN, SUM(CASE WHEN DURATION/60 >=10 AND DURATION/60 <15 THEN 1 ELSE 0 END) TOTAL FROM SESSIONS UNION SELECT '15 or more' AS BIN, SUM(CASE WHEN DURATION/60 >=15 THEN 1 ELSE 0 END) TOTAL FROM SESSIONS"
