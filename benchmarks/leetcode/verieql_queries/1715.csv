qid,mysql_can_execute?,mysql_correct?,mysql_query
0,N,N,"FROM ( SELECT SUM(B.APPLE_COUNT) AS BA, SUM(B.ORANGE_COUNT) AS BO, SUM(IFNULL(C.APPLE_COUNT,0)) AS CA, SUM(IFNULL(C.ORANGE_COUNT,0)) AS CO FROM BOXES B LEFT OUTER JOIN CHESTS C ON (B.CHEST_ID = C.CHEST_ID) ) AS T1"
1,Y,Y,"SELECT (SUM(B.APPLE_COUNT) + IFNULL(SUM(C.APPLE_COUNT),0)) AS APPLE_COUNT, (SUM(B.ORANGE_COUNT) + IFNULL(SUM(C.ORANGE_COUNT),0)) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON C.CHEST_ID = B.CHEST_ID"
2,Y,Y,"SELECT COALESCE(SUM(B.APPLE_COUNT),0)+COALESCE(SUM(C.APPLE_COUNT),0) APPLE_COUNT,COALESCE(SUM(B.ORANGE_COUNT),0)+COALESCE(SUM(C.ORANGE_COUNT),0) ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C USING(CHEST_ID)"
3,Y,Y,"SELECT D.APPLE_COUNT, D.ORANGE_COUNT FROM (SELECT SUM(A.A_COUNT) OVER (ORDER BY A_COUNT) APPLE_COUNT, SUM(A.O_COUNT) OVER (ORDER BY A_COUNT) ORANGE_COUNT FROM (SELECT COALESCE(B.APPLE_COUNT + C.APPLE_COUNT, B.APPLE_COUNT) A_COUNT, COALESCE(B.ORANGE_COUNT + C.ORANGE_COUNT, B.ORANGE_COUNT) O_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID) A) D ORDER BY D.APPLE_COUNT DESC LIMIT 1"
4,Y,Y,"SELECT IFNULL(SUM(B.APPLE_COUNT), 0) + IFNULL(SUM(C.APPLE_COUNT), 0) AS APPLE_COUNT, IFNULL(SUM(B.ORANGE_COUNT), 0) + IFNULL(SUM(C.ORANGE_COUNT), 0) AS ORANGE_COUNT FROM BOXES AS B LEFT JOIN CHESTS AS C ON B.CHEST_ID = C.CHEST_ID"
5,Y,Y,"SELECT IFNULL(SUM(B.APPLE_COUNT), 0) + IFNULL(SUM(C.APPLE_COUNT), 0) AS APPLE_COUNT, IFNULL(SUM(B.ORANGE_COUNT), 0) + IFNULL(SUM(C.ORANGE_COUNT), 0) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C USING (CHEST_ID)"
6,Y,Y,"SELECT SUM( B.APPLE_COUNT + COALESCE( C.APPLE_COUNT, 0) ) APPLE_COUNT ,SUM( B.ORANGE_COUNT + COALESCE( C.ORANGE_COUNT, 0) ) ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C USING(CHEST_ID)"
7,Y,Y,"SELECT SUM( B.APPLE_COUNT + IF(C.CHEST_ID, C.APPLE_COUNT, 0) ) AS APPLE_COUNT, SUM( B.ORANGE_COUNT + IF(C.CHEST_ID, C.ORANGE_COUNT, 0) ) AS ORANGE_COUNT FROM BOXES AS B LEFT JOIN CHESTS AS C ON B.CHEST_ID=C.CHEST_ID"
8,Y,Y,"SELECT SUM( B.APPLE_COUNT + IFNULL(C.APPLE_COUNT, 0) ) APPLE_COUNT, SUM( B.ORANGE_COUNT + IFNULL(C.ORANGE_COUNT, 0) ) ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
9,Y,Y,"SELECT SUM((COALESCE(B.APPLE_COUNT, 0) + COALESCE(C.APPLE_COUNT, 0))) AS APPLE_COUNT, SUM((COALESCE(B.ORANGE_COUNT, 0) + COALESCE(C.ORANGE_COUNT, 0))) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
10,Y,Y,"SELECT SUM((IFNULL(B.APPLE_COUNT, 0) + IFNULL(C.APPLE_COUNT, 0))) AS APPLE_COUNT, SUM((IFNULL(B.ORANGE_COUNT, 0) + IFNULL(C.ORANGE_COUNT, 0))) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
11,Y,Y,"SELECT SUM((B.APPLE_COUNT + IFNULL(C.APPLE_COUNT,0))) AS APPLE_COUNT,SUM((B.ORANGE_COUNT +IFNULL(C.ORANGE_COUNT,0))) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID=C.CHEST_ID"
12,Y,Y,"SELECT SUM((B.APPLE_COUNT) + IFNULL(C.APPLE_COUNT,0)) AS APPLE_COUNT, SUM((B.ORANGE_COUNT) + IFNULL(C.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
13,Y,Y,"SELECT SUM(B.APPLE_COUNT + COALESCE(C.APPLE_COUNT,0)) AS APPLE_COUNT, SUM(B.ORANGE_COUNT + COALESCE(C.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON (B.CHEST_ID = C.CHEST_ID)"
14,Y,Y,"SELECT SUM(B.APPLE_COUNT + IFNULL(C.APPLE_COUNT,0)) APPLE_COUNT, SUM(B.ORANGE_COUNT + IFNULL(C.ORANGE_COUNT,0)) ORANGE_COUNT FROM BOXES AS B LEFT JOIN CHESTS AS C ON B.CHEST_ID = C.CHEST_ID"
15,Y,Y,"SELECT SUM(B.APPLE_COUNT) + COALESCE(SUM(C.APPLE_COUNT),0) AS APPLE_COUNT, SUM(B.ORANGE_COUNT)+ COALESCE(SUM(C.ORANGE_COUNT),0) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
16,Y,Y,"SELECT SUM(BOXES.APPLE_COUNT + IFNULL(CHESTS.APPLE_COUNT, 0)) AS APPLE_COUNT, SUM(BOXES.ORANGE_COUNT + IFNULL(CHESTS.ORANGE_COUNT, 0)) AS ORANGE_COUNT FROM BOXES LEFT JOIN CHESTS ON BOXES.CHEST_ID = CHESTS.CHEST_ID"
17,Y,Y,"SELECT SUM(BOXES.APPLE_COUNT)+SUM(IFNULL(CHESTS.APPLE_COUNT,0)) AS APPLE_COUNT, SUM(BOXES.ORANGE_COUNT)+SUM(IFNULL(CHESTS.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES LEFT JOIN CHESTS ON BOXES.CHEST_ID=CHESTS.CHEST_ID"
18,Y,Y,"SELECT SUM(CASE WHEN B.CHEST_ID IS NULL THEN B.APPLE_COUNT ELSE B.APPLE_COUNT + C.APPLE_COUNT END) AS APPLE_COUNT, SUM(CASE WHEN B.CHEST_ID IS NULL THEN B.ORANGE_COUNT ELSE B.ORANGE_COUNT + C.ORANGE_COUNT END) AS ORANGE_COUNT FROM BOXES AS B LEFT JOIN CHESTS AS C ON B.CHEST_ID = C.CHEST_ID"
19,Y,Y,"SELECT SUM(CASE WHEN B.CHEST_ID IS NULL THEN B.APPLE_COUNT ELSE B.APPLE_COUNT+C.APPLE_COUNT END) AS APPLE_COUNT, SUM(CASE WHEN B.CHEST_ID IS NULL THEN B.ORANGE_COUNT ELSE B.ORANGE_COUNT+C.ORANGE_COUNT END) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID=C.CHEST_ID"
20,Y,Y,"SELECT SUM(CASE WHEN B_AC+C_AC IS NULL THEN B_AC ELSE B_AC+C_AC END) AS APPLE_COUNT, SUM(CASE WHEN B_OC+C_OC IS NULL THEN B_OC ELSE B_OC+C_OC END) AS ORANGE_COUNT FROM( SELECT BOX_ID, B.APPLE_COUNT AS B_AC, B.ORANGE_COUNT AS B_OC, C.APPLE_COUNT AS C_AC, C.ORANGE_COUNT AS C_OC FROM BOXES AS B LEFT JOIN CHESTS AS C ON B.CHEST_ID = C.CHEST_ID ) AS T"
21,Y,Y,"SELECT SUM(CASE WHEN C.APPLE_COUNT IS NULL THEN B.APPLE_COUNT ELSE B.APPLE_COUNT+C.APPLE_COUNT END) AS APPLE_COUNT, SUM(CASE WHEN C.ORANGE_COUNT IS NULL THEN B.ORANGE_COUNT ELSE B.ORANGE_COUNT+C.ORANGE_COUNT END) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
22,Y,Y,"SELECT SUM(CASE WHEN C.CHEST_ID IS NULL THEN B.APPLE_COUNT ELSE C.APPLE_COUNT+B.APPLE_COUNT END) AS APPLE_COUNT, SUM(CASE WHEN C.CHEST_ID IS NULL THEN B.ORANGE_COUNT ELSE C.ORANGE_COUNT+B.ORANGE_COUNT END) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON C.CHEST_ID = B.CHEST_ID"
23,Y,Y,"SELECT SUM(COALESCE(C.APPLE_COUNT, 0) + B.APPLE_COUNT) AS APPLE_COUNT , SUM(COALESCE(C.ORANGE_COUNT, 0) + B.ORANGE_COUNT) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C USING(CHEST_ID)"
24,Y,Y,"SELECT SUM(COALESCE(C.APPLE_COUNT, 0)) + SUM(B.APPLE_COUNT) AS APPLE_COUNT, SUM(COALESCE(C.ORANGE_COUNT, 0)) + SUM(B.ORANGE_COUNT) AS ORANGE_COUNT FROM BOXES AS B LEFT JOIN CHESTS AS C ON C.CHEST_ID = B.CHEST_ID"
25,Y,Y,"SELECT SUM(IFNULL(B1.APPLE_COUNT,0)) + SUM(IFNULL(C1.APPLE_COUNT,0)) APPLE_COUNT, SUM(IFNULL(B1.ORANGE_COUNT,0)) + SUM(IFNULL(C1.ORANGE_COUNT,0)) ORANGE_COUNT FROM BOXES B1 LEFT JOIN CHESTS C1 ON B1.CHEST_ID = C1.CHEST_ID"
26,Y,Y,"SELECT SUM(IFNULL(B.APPLE_COUNT, 0) + IFNULL(C.APPLE_COUNT, 0)) AS APPLE_COUNT, SUM(IFNULL(B.ORANGE_COUNT, 0) + IFNULL(C.ORANGE_COUNT, 0)) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
27,Y,Y,"SELECT SUM(IFNULL(B.APPLE_COUNT, 0)) + SUM(IFNULL(C.APPLE_COUNT, 0)) AS APPLE_COUNT, SUM(IFNULL(B.ORANGE_COUNT, 0)) + SUM(IFNULL(C.ORANGE_COUNT, 0)) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID=C.CHEST_ID"
28,Y,Y,"SELECT SUM(IFNULL(B.APPLE_COUNT,0) + IFNULL(C.APPLE_COUNT,0)) AS APPLE_COUNT ,SUM(IFNULL(B.ORANGE_COUNT,0) + IFNULL(C.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C USING (CHEST_ID)"
29,Y,Y,"SELECT SUM(IFNULL(C.APPLE_COUNT,0) + B.APPLE_COUNT) APPLE_COUNT, SUM(IFNULL(C.ORANGE_COUNT,0)+B.ORANGE_COUNT) ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
30,Y,Y,"SELECT SUM(A.APPLE_COUNT + IFNULL(B.APPLE_COUNT,0)) AS APPLE_COUNT, SUM(A.ORANGE_COUNT + IFNULL(B.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID = B.CHEST_ID"
31,Y,N,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT , SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM (SELECT APPLE_COUNT, ORANGE_COUNT FROM BOXES UNION ALL SELECT C.APPLE_COUNT AS APPLE_COUNT, C.ORANGE_COUNT AS ORANGE_COUNT FROM CHESTS C JOIN BOXES B ON C.CHEST_ID=B.CHEST_ID) TEMP"
32,Y,Y,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM ( SELECT (BOXES.APPLE_COUNT + COALESCE(CHESTS.APPLE_COUNT,0)) AS APPLE_COUNT, (BOXES.ORANGE_COUNT + COALESCE(CHESTS.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES LEFT OUTER JOIN CHESTS ON BOXES.CHEST_ID = CHESTS.CHEST_ID ORDER BY 1,2 )TBL"
33,Y,N,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM ( SELECT B.BOX_ID, SUM(C.APPLE_COUNT) AS APPLE_COUNT, SUM(C.ORANGE_COUNT) AS ORANGE_COUNT FROM BOXES B INNER JOIN CHESTS C ON C.CHEST_ID = B.CHEST_ID UNION ALL SELECT BOX_ID, SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM BOXES B ) XX"
34,Y,Y,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM ( SELECT B.BOX_ID, B.CHEST_ID, (IFNULL(B.APPLE_COUNT, 0) + IFNULL(C.APPLE_COUNT, 0)) AS APPLE_COUNT, (IFNULL(B.ORANGE_COUNT, 0) + IFNULL(C.ORANGE_COUNT, 0)) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID) SUB"
35,Y,N,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM ( SELECT BOX_ID, B.CHEST_ID, SUM(C.APPLE_COUNT) AS APPLE_COUNT, SUM(C.ORANGE_COUNT) AS ORANGE_COUNT FROM BOXES B JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID GROUP BY BOX_ID, B.CHEST_ID UNION ALL SELECT BOX_ID, B.CHEST_ID, SUM(APPLE_COUNT), SUM(ORANGE_COUNT) FROM BOXES B GROUP BY BOX_ID, B.CHEST_ID ) TMP"
36,Y,N,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM (SELECT SUM(BOXES.APPLE_COUNT) AS APPLE_COUNT, SUM(BOXES.ORANGE_COUNT) AS ORANGE_COUNT FROM BOXES UNION ALL SELECT SUM(CHESTS.APPLE_COUNT) AS APPLE_COUNT, SUM(CHESTS.ORANGE_COUNT) AS ORANGE_COUNT FROM BOXES LEFT JOIN CHESTS ON BOXES.CHEST_ID = CHESTS.CHEST_ID) TEMP1"
37,Y,N,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM (SELECT APPLE_COUNT, ORANGE_COUNT FROM BOXES UNION ALL SELECT B.APPLE_COUNT, B.ORANGE_COUNT FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID = B.CHEST_ID WHERE A.CHEST_ID IS NOT NULL) A"
38,Y,Y,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM (SELECT B.APPLE_COUNT + IFNULL(C.APPLE_COUNT, 0) AS APPLE_COUNT, B.ORANGE_COUNT + IFNULL(C.ORANGE_COUNT, 0) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID) T"
39,Y,N,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM (SELECT BOX_ID, (B.APPLE_COUNT + IFNULL(C.APPLE_COUNT, 0)) AS APPLE_COUNT, (B.ORANGE_COUNT + IFNULL(C.ORANGE_COUNT, 0)) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON C.CHEST_ID = B.CHEST_ID GROUP BY BOX_ID) A"
40,Y,N,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM( SELECT * FROM BOXES UNION ALL SELECT B.BOX_ID, C.CHEST_ID, C.APPLE_COUNT, C.ORANGE_COUNT FROM BOXES B JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID) AC"
41,Y,N,"SELECT SUM(APPLE_COUNT) APPLE_COUNT, SUM(ORANGE_COUNT) ORANGE_COUNT FROM (SELECT SUM(APPLE_COUNT) APPLE_COUNT, SUM(ORANGE_COUNT) ORANGE_COUNT FROM BOXES UNION SELECT SUM(C.APPLE_COUNT) APPLE_COUNT, SUM(C.ORANGE_COUNT) ORANGE_COUNT FROM BOXES X LEFT JOIN CHESTS C ON X.CHEST_ID = C.CHEST_ID WHERE X.CHEST_ID IS NOT NULL) X1"
42,Y,Y,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM (SELECT B.CHEST_ID, SUM(B.APPLE_COUNT + IFNULL(C.APPLE_COUNT,0)) AS APPLE_COUNT, SUM(B.ORANGE_COUNT + IFNULL(C.ORANGE_COUNT, 0)) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID GROUP BY CHEST_ID)T"
43,Y,Y,"SELECT SUM(B.APPLE_COUNT + + COALESCE(C.APPLE_COUNT,0)) AS APPLE_COUNT , SUM(B.ORANGE_COUNT + COALESCE(C.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
44,Y,Y,"SELECT SUM(B.APPLE_COUNT + COALESCE(C.APPLE_COUNT, 0)) AS APPLE_COUNT, SUM(B.ORANGE_COUNT + COALESCE(C.ORANGE_COUNT, 0)) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
45,Y,Y,"SELECT SUM(B.APPLE_COUNT + IFNULL(C.APPLE_COUNT,0)) AS APPLE_COUNT, SUM(B.ORANGE_COUNT + IFNULL(C.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES AS B LEFT JOIN CHESTS AS C USING(CHEST_ID)"
46,Y,Y,"SELECT SUM(B.APPLE_COUNT + IFNULL(C.APPLE_COUNT,0)) AS APPLE_COUNT, SUM(B.ORANGE_COUNT + IFNULL(C.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C USING (CHEST_ID)"
47,Y,Y,"SELECT SUM(B.APPLE_COUNT + IFNULL(C.APPLE_COUNT,0)) AS APPLE_COUNT,SUM(B.ORANGE_COUNT + IFNULL(C.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES AS B LEFT JOIN CHESTS AS C ON B.CHEST_ID=C.CHEST_ID"
48,Y,Y,"SELECT SUM(B.APPLE_COUNT + IFNULL(C.APPLE_COUNT,0)) AS APPLE_COUNT,SUM(B.ORANGE_COUNT + IFNULL(C.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES AS B LEFT JOIN CHESTS AS C ON C.CHEST_ID = B.CHEST_ID"
49,Y,Y,"SELECT SUM(B.APPLE_COUNT) + COALESCE(SUM(C.APPLE_COUNT),0) APPLE_COUNT, SUM(B.ORANGE_COUNT) + COALESCE(SUM(C.ORANGE_COUNT),0) ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON C.CHEST_ID = B.CHEST_ID"
50,Y,Y,"SELECT SUM(B.APPLE_COUNT) + IFNULL(SUM(C.APPLE_COUNT), 0) AS APPLE_COUNT, SUM(B.ORANGE_COUNT) + IFNULL(SUM(C.ORANGE_COUNT), 0) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C USING (CHEST_ID)"
51,Y,Y,"SELECT SUM(B.APPLE_COUNT) + IFNULL(SUM(C.APPLE_COUNT),0) AS APPLE_COUNT, SUM(B.ORANGE_COUNT) + IFNULL(SUM(C.ORANGE_COUNT),0) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
52,Y,Y,"SELECT SUM(B.APPLE_COUNT)+COALESCE(SUM(C.APPLE_COUNT),0) APPLE_COUNT,SUM(B.ORANGE_COUNT)+COALESCE(SUM(C.ORANGE_COUNT),0) ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C USING(CHEST_ID)"
53,Y,Y,"SELECT SUM(BOX_APPLE_COUNT + CHEST_APPLE_COUNT) AS APPLE_COUNT, SUM(BOX_ORANGE_COUNT + CHEST_ORANGE_COUNT) AS ORANGE_COUNT FROM ( SELECT BOX_ID, B.APPLE_COUNT AS BOX_APPLE_COUNT, B.ORANGE_COUNT AS BOX_ORANGE_COUNT, COALESCE(C.APPLE_COUNT, 0) AS CHEST_APPLE_COUNT, COALESCE(C.ORANGE_COUNT, 0) AS CHEST_ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID ) A"
54,Y,N,"SELECT SUM(C.APPLE_COUNT) AS APPLE_COUNT, SUM(C.ORANGE_COUNT) AS ORANGE_COUNT FROM ( SELECT BOX_ID, SUM(C.APPLE_COUNT) AS APPLE_COUNT, SUM(C.ORANGE_COUNT) AS ORANGE_COUNT FROM BOXES B INNER JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID GROUP BY BOX_ID UNION ALL SELECT BOX_ID, APPLE_COUNT, ORANGE_COUNT FROM BOXES B ) C"
55,Y,Y,"SELECT SUM(TOTAL_APPLES) AS APPLE_COUNT ,SUM(TOTAL_ORANGES) AS ORANGE_COUNT FROM ( SELECT A.BOX_ID ,A.APPLE_COUNT + IFNULL(B.APPLE_COUNT,0) AS TOTAL_APPLES ,A.ORANGE_COUNT + IFNULL(B.ORANGE_COUNT,0) AS TOTAL_ORANGES FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID=B.CHEST_ID ) A"
56,Y,Y,"SELECT SUM(TOTAL_APPLES) AS APPLE_COUNT, SUM(TOTAL_ORANGES) AS ORANGE_COUNT FROM (SELECT B.APPLE_COUNT + COALESCE(C.C_APPLE_COUNT, 0) AS TOTAL_APPLES, B.ORANGE_COUNT + COALESCE(C.C_ORANGE_COUNT, 0) AS TOTAL_ORANGES FROM BOXES B LEFT JOIN (SELECT CHEST_ID, APPLE_COUNT AS C_APPLE_COUNT, ORANGE_COUNT AS C_ORANGE_COUNT FROM CHESTS) C ON B.CHEST_ID = C.CHEST_ID) T"
57,Y,Y,"SELECT BA + CA AS APPLE_COUNT, BO + CO AS ORANGE_COUNT FROM ( SELECT SUM(B.APPLE_COUNT) AS BA, SUM(B.ORANGE_COUNT) AS BO, SUM(IFNULL(C.APPLE_COUNT,0)) AS CA, SUM(IFNULL(C.ORANGE_COUNT,0)) AS CO FROM BOXES B LEFT OUTER JOIN CHESTS C ON (B.CHEST_ID = C.CHEST_ID) ) AS T1"
58,Y,Y,"SELECT SUM(A.TOTAL_APPLE_COUNT) AS APPLE_COUNT,SUM(A.TOTAL_ORANGE_COUNT) AS ORANGE_COUNT FROM ( SELECT COALESCE(B.APPLE_COUNT,0)+COALESCE(C.APPLE_COUNT,0) AS TOTAL_APPLE_COUNT,COALESCE(B.ORANGE_COUNT,0)+COALESCE(C.ORANGE_COUNT,0) AS TOTAL_ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID ) AS A"
59,Y,Y,"SELECT SUM(B.APPLE_COUNT + COALESCE(C.APPLE_COUNT,0)) AS APPLE_COUNT, SUM(B.ORANGE_COUNT + COALESCE(C.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES AS B LEFT JOIN CHESTS AS C ON B.CHEST_ID = C.CHEST_ID"
60,Y,Y,"SELECT SUM(IFNULL(B.APPLE_COUNT,0) + IFNULL(C.APPLE_COUNT,0)) AS APPLE_COUNT, SUM(IFNULL(B.ORANGE_COUNT,0) + IFNULL(C.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES AS B LEFT JOIN CHESTS AS C ON B.CHEST_ID = C.CHEST_ID"
61,Y,Y,"SELECT SUM(BOXES.APPLE_COUNT) + SUM(COALESCE(CHESTS.APPLE_COUNT, 0)) AS APPLE_COUNT, SUM(BOXES.ORANGE_COUNT) + SUM(COALESCE(CHESTS.ORANGE_COUNT, 0)) AS ORANGE_COUNT FROM BOXES LEFT JOIN CHESTS ON BOXES.CHEST_ID = CHESTS.CHEST_ID"
62,Y,Y,"SELECT IFNULL(SUM(B.APPLE_COUNT),0) + IFNULL(SUM(C.APPLE_COUNT),0) AS APPLE_COUNT, IFNULL(SUM(B.ORANGE_COUNT),0) + IFNULL(SUM(C.ORANGE_COUNT),0) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
63,Y,Y,"SELECT SUM(A.APPLE_COUNT+IFNULL(B.APPLE_COUNT,0)) AS APPLE_COUNT, SUM(A.ORANGE_COUNT+IFNULL(B.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES AS A LEFT JOIN CHESTS AS B ON A.CHEST_ID = B.CHEST_ID"
64,Y,N,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM (SELECT CASE WHEN B.CHEST_ID IS NOT NULL THEN SUM(B.APPLE_COUNT+ C.APPLE_COUNT) OVER (PARTITION BY BOX_ID) ELSE B.APPLE_COUNT END AS APPLE_COUNT, CASE WHEN B.CHEST_ID IS NOT NULL THEN SUM(B.ORANGE_COUNT+ C.ORANGE_COUNT) OVER (PARTITION BY BOX_ID) ELSE B.ORANGE_COUNT END AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID) D"
65,Y,Y,"SELECT SUM(B.APPLE_COUNT + COALESCE(C.APPLE_COUNT,0)) AS APPLE_COUNT, SUM(B.ORANGE_COUNT + COALESCE(C.ORANGE_COUNT,0))AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON C.CHEST_ID = B.CHEST_ID"
66,Y,Y,"SELECT SUM(S.A_COUNT) AS APPLE_COUNT ,SUM(S.O_COUNT) AS ORANGE_COUNT FROM( SELECT B.BOX_ID, B.CHEST_ID, B.APPLE_COUNT+IFNULL(C.APPLE_COUNT,0) AS A_COUNT , B.ORANGE_COUNT +IFNULL(C.ORANGE_COUNT ,0) AS O_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID=C.CHEST_ID ) S"
67,Y,Y,"WITH ALLFRUITS AS (SELECT B.BOX_ID ,IFNULL(C.APPLE_COUNT,0)+B.APPLE_COUNT AS APPLE_COUNT ,IFNULL(C.ORANGE_COUNT,0)+B.ORANGE_COUNT AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON C.CHEST_ID = B.CHEST_ID) SELECT SUM(APPLE_COUNT) AS APPLE_COUNT ,SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM ALLFRUITS"
68,Y,Y,"WITH BOXTOTAL AS (SELECT B.BOX_ID ,IFNULL(C.APPLE_COUNT,0)+B.APPLE_COUNT AS APPLE_COUNT ,IFNULL(C.ORANGE_COUNT,0)+B.ORANGE_COUNT AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON C.CHEST_ID = B.CHEST_ID) SELECT SUM(APPLE_COUNT) AS APPLE_COUNT ,SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM BOXTOTAL"
69,Y,Y,"WITH BOXEDFRUITS AS (SELECT B.BOX_ID ,IFNULL(C.APPLE_COUNT,0)+B.APPLE_COUNT AS APPLE_COUNT ,IFNULL(C.ORANGE_COUNT,0)+B.ORANGE_COUNT AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON C.CHEST_ID = B.CHEST_ID) SELECT SUM(APPLE_COUNT) AS APPLE_COUNT ,SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM BOXEDFRUITS"
70,Y,N,"WITH BOXESANDCHESTS AS ( SELECT BOX_ID, B.APPLE_COUNT + IFNULL(SUM(C.APPLE_COUNT),0) AS APPLE_COUNT, B.ORANGE_COUNT + IFNULL(SUM(C.ORANGE_COUNT),0) AS ORANGE_COUNT FROM BOXES B LEFT OUTER JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID GROUP BY BOX_ID ) SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM BOXESANDCHESTS"
71,Y,Y,"WITH CTE AS ( SELECT A.BOX_ID, B.CHEST_ID, (A.APPLE_COUNT+IFNULL(B.APPLE_COUNT,0)) APPLE_COUNT, (A.ORANGE_COUNT+IFNULL(B.ORANGE_COUNT,0)) ORANGE_COUNT FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID=B.CHEST_ID ) SELECT SUM(APPLE_COUNT) APPLE_COUNT,SUM(ORANGE_COUNT) ORANGE_COUNT FROM CTE"
72,Y,Y,"WITH CTE AS ( SELECT BOX_ID, A.CHEST_ID, A.APPLE_COUNT, A.ORANGE_COUNT, COALESCE(B.APPLE_COUNT,0) AS CHEST_APPLE, COALESCE(B.ORANGE_COUNT,0) AS CHEST_ORANGE FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID = B.CHEST_ID ) SELECT SUM(APPLE_COUNT+CHEST_APPLE) AS APPLE_COUNT, SUM(ORANGE_COUNT+CHEST_ORANGE) AS ORANGE_COUNT FROM CTE"
73,Y,N,"WITH CTE AS ( SELECT B.BOX_ID, B.CHEST_ID, B.APPLE_COUNT + IFNULL(C.APPLE_COUNT,0) AS APPLE_COUNT , B.ORANGE_COUNT + IFNULL(C.ORANGE_COUNT,0) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID GROUP BY B.BOX_ID, B.CHEST_ID ) SELECT SUM(CTE.APPLE_COUNT) AS APPLE_COUNT , SUM(CTE.ORANGE_COUNT) AS ORANGE_COUNT FROM CTE"
74,Y,Y,"WITH CTE AS (SELECT BOX_ID, IFNULL(B.APPLE_COUNT, 0) AS B_APPLE, IFNULL(B.ORANGE_COUNT, 0) AS B_ORANGE, IFNULL(C.APPLE_COUNT, 0) AS C_APPLE, IFNULL(C.ORANGE_COUNT, 0) AS C_ORANGE FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID) SELECT SUM(B_APPLE) + SUM(C_APPLE) AS APPLE_COUNT, SUM(B_ORANGE) + SUM(C_ORANGE) AS ORANGE_COUNT FROM CTE"
75,Y,Y,"WITH CTE1 AS ( SELECT B.BOX_ID, B.APPLE_COUNT+IFNULL(C.APPLE_COUNT, 0) AS APPLE_COUNT, B.ORANGE_COUNT+IFNULL(C.ORANGE_COUNT, 0) AS ORANGE_COUNT FROM BOXES AS B LEFT JOIN CHESTS AS C ON B.CHEST_ID = C.CHEST_ID) SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM CTE1"
76,Y,Y,"WITH D AS( SELECT B.APPLE_COUNT, B.ORANGE_COUNT, C.APPLE_COUNT AS A, C.ORANGE_COUNT AS O FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID ) SELECT IFNULL(SUM(APPLE_COUNT),0)+IFNULL(SUM(A),0) AS APPLE_COUNT, IFNULL(SUM(ORANGE_COUNT),0)+IFNULL(SUM(O),0) AS ORANGE_COUNT FROM D"
77,Y,Y,"WITH D AS( SELECT IFNULL(B.APPLE_COUNT,0) AS APPLE_COUNT, IFNULL(B.ORANGE_COUNT,0) AS ORANGE_COUNT, IFNULL(C.APPLE_COUNT,0) AS A, IFNULL(C.ORANGE_COUNT,0) AS O FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID ) SELECT SUM(APPLE_COUNT)+SUM(A) AS APPLE_COUNT, SUM(ORANGE_COUNT)+SUM(O) AS ORANGE_COUNT FROM D"
78,Y,Y,"WITH S0 AS (SELECT BOX_ID, BOXES.CHEST_ID, IFNULL(BOXES.APPLE_COUNT,0) + IFNULL(CHESTS.APPLE_COUNT,0) AS APPLES, IFNULL(BOXES.ORANGE_COUNT,0) + IFNULL(CHESTS.ORANGE_COUNT,0) AS ORANGES FROM BOXES LEFT JOIN CHESTS ON BOXES.CHEST_ID = CHESTS.CHEST_ID) SELECT SUM(APPLES) AS APPLE_COUNT, SUM(ORANGES) AS ORANGE_COUNT FROM S0"
79,Y,Y,"WITH T1 AS (SELECT A.*, B.APPLE_COUNT AS APPLE2, B.ORANGE_COUNT AS ORANGE2 FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID = B.CHEST_ID), T2 AS (SELECT BOX_ID, CHEST_ID, COALESCE(APPLE_COUNT, 0) + COALESCE(APPLE2, 0) AS APPLE, COALESCE(ORANGE_COUNT, 0) + COALESCE(ORANGE2, 0) AS ORANGE FROM T1) SELECT SUM(APPLE) AS APPLE_COUNT, SUM(ORANGE) AS ORANGE_COUNT FROM T2"
80,Y,Y,"WITH TEMP AS (SELECT B.BOX_ID AS BOX_ID, B.APPLE_COUNT AS BOX_APPLE_COUNT, B.ORANGE_COUNT AS BOX_ORANGE_COUNT, C.APPLE_COUNT AS CHEST_APPLE_COUNT, C.ORANGE_COUNT AS CHEST_ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID=C.CHEST_ID) SELECT SUM(COALESCE(BOX_ORANGE_COUNT, 0) + COALESCE(CHEST_ORANGE_COUNT, 0)) AS ORANGE_COUNT, SUM(COALESCE(BOX_APPLE_COUNT,0) + COALESCE(CHEST_APPLE_COUNT,0)) AS APPLE_COUNT FROM TEMP"
81,Y,Y,"WITH BOX_CONTAIN AS ( SELECT B.BOX_ID, B.CHEST_ID, (B.APPLE_COUNT + IFNULL(C.APPLE_COUNT,0)) AS APPLE_COUNT, (B.ORANGE_COUNT + IFNULL(C.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES AS B LEFT JOIN CHESTS AS C ON B.CHEST_ID = C.CHEST_ID ) SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM BOX_CONTAIN"
82,Y,Y,"WITH C1 AS (SELECT B.APPLE_COUNT AS APPLE_COUNT_B, B.ORANGE_COUNT AS ORANGE_COUNT_B , C.APPLE_COUNT AS APPLE_COUNT_C, C.ORANGE_COUNT AS ORANGE_COUNT_C FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID) SELECT SUM(APPLE_COUNT_B + COALESCE(APPLE_COUNT_C, 0) ) AS APPLE_COUNT , SUM(ORANGE_COUNT_B + COALESCE(ORANGE_COUNT_C, 0) ) AS ORANGE_COUNT FROM C1"
83,Y,N,"WITH CHEST_CTE AS ( SELECT B.BOX_ID, C.CHEST_ID, COALESCE(C.APPLE_COUNT, 0) AS CHEST_APPLE_COUNT, COALESCE(C.ORANGE_COUNT, 0) AS CHEST_ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID ) SELECT SUM(SUB.APPLE_COUNT) + SUM(SUB.CHEST_APPLE_COUNT) AS APPLE_COUNT, SUM(SUB.ORANGE_COUNT) + SUM(SUB.CHEST_ORANGE_COUNT) AS ORANGE_COUNT FROM ( SELECT B.APPLE_COUNT, B.ORANGE_COUNT, CC.CHEST_APPLE_COUNT, CC.CHEST_ORANGE_COUNT FROM BOXES B LEFT JOIN CHEST_CTE CC ON B.BOX_ID = CC.BOX_ID ) SUB"
84,Y,N,"WITH COUNT_IN_BOXES AS ( SELECT BOX_ID, CHEST_ID, SUM(APPLE_COUNT) AS APPLES, SUM(ORANGE_COUNT) AS ORANGES FROM BOXES GROUP BY BOX_ID, CHEST_ID), COUNT_IN_CHESTS AS ( SELECT CHEST_ID, SUM(APPLE_COUNT) AS APPLES, SUM(ORANGE_COUNT) AS ORANGES FROM CHESTS GROUP BY CHEST_ID ) SELECT SUM(IFNULL(B.APPLES,0)) + SUM(IFNULL(C.APPLES,0)) AS APPLE_COUNT, SUM(IFNULL(B.ORANGES,0)) + SUM(IFNULL(C.ORANGES,0)) AS ORANGE_COUNT FROM COUNT_IN_BOXES B LEFT JOIN COUNT_IN_CHESTS C ON B.CHEST_ID = C.CHEST_ID"
85,Y,N,"WITH CTE AS ( SELECT B.BOX_ID, C.CHEST_ID, C.APPLE_COUNT, C.ORANGE_COUNT FROM CHESTS C INNER JOIN BOXES B USING (CHEST_ID) ), CTE1 AS( SELECT * FROM CTE UNION ALL SELECT * FROM BOXES B ) SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM CTE1"
86,Y,Y,"WITH CTE AS ( SELECT BOX_ID, SUM(BOXES.APPLE_COUNT)+SUM(IFNULL(CHESTS.APPLE_COUNT,0)) AS APPLES, SUM(BOXES.ORANGE_COUNT)+SUM(IFNULL(CHESTS.ORANGE_COUNT,0)) AS ORANGES FROM BOXES LEFT JOIN CHESTS ON BOXES.CHEST_ID = CHESTS.CHEST_ID GROUP BY BOX_ID ) SELECT SUM(APPLES) AS APPLE_COUNT, SUM(ORANGES) AS ORANGE_COUNT FROM CTE"
87,Y,Y,"WITH CTE AS (SELECT BOX_ID, CASE WHEN B.CHEST_ID = C.CHEST_ID THEN B.APPLE_COUNT+C.APPLE_COUNT ELSE B.APPLE_COUNT END AS APPLE, CASE WHEN B.CHEST_ID = C.CHEST_ID THEN B.ORANGE_COUNT + C.ORANGE_COUNT ELSE B.ORANGE_COUNT END AS ORANGE FROM BOXES B LEFT JOIN CHESTS C USING (CHEST_ID)) SELECT SUM(APPLE) AS APPLE_COUNT, SUM(ORANGE) AS ORANGE_COUNT FROM CTE"
88,Y,Y,"WITH CTE1 AS( SELECT BOX_ID, B.CHEST_ID, B.APPLE_COUNT AS APP1, B.ORANGE_COUNT AS ORA1, COALESCE(C.APPLE_COUNT,0) AS APP2, COALESCE(C.ORANGE_COUNT,0) AS ORA2 FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID=C.CHEST_ID ), CTE2 AS ( SELECT APP1+APP2 AS TOTAL_APP, ORA1+ORA2 AS TOTAL_ORA FROM CTE1 ) SELECT SUM(TOTAL_APP) AS APPLE_COUNT, SUM(TOTAL_ORA) AS ORANGE_COUNT FROM CTE2"
89,Y,N,"WITH MAIN (APPLE_COUNT, ORANGE_COUNT) AS ( SELECT SUM(APPLE_COUNT), SUM(ORANGE_COUNT) FROM BOXES UNION ALL SELECT SUM(C.APPLE_COUNT), SUM(C.ORANGE_COUNT) FROM BOXES B INNER JOIN CHESTS C USING(CHEST_ID) ) SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM MAIN"
90,Y,Y,"WITH T AS( SELECT BOXES.APPLE_COUNT,BOXES.ORANGE_COUNT, CHESTS.APPLE_COUNT CHEST_A, CHESTS.ORANGE_COUNT CHEST_O FROM BOXES LEFT JOIN CHESTS ON BOXES.CHEST_ID = CHESTS.CHEST_ID ) SELECT SUM(APPLE_COUNT)+ IFNULL(SUM(CHEST_A),0) APPLE_COUNT, SUM(ORANGE_COUNT)+ IFNULL(SUM(CHEST_O),0) ORANGE_COUNT FROM T"
91,Y,Y,"WITH T_BOX AS (SELECT BOX_ID, CHEST_ID, APPLE_COUNT AS APPLES_BOX, ORANGE_COUNT AS ORANGE_BOX FROM BOXES), T_CHESTS AS (SELECT CHEST_ID, APPLE_COUNT AS APPLES_CH, ORANGE_COUNT AS ORANGE_CH FROM CHESTS), T_ALL AS (SELECT APPLES_BOX, ORANGE_BOX, APPLES_CH, ORANGE_CH FROM T_BOX T1 LEFT JOIN T_CHESTS T2 ON T1.CHEST_ID = T2.CHEST_ID) SELECT SUM(APPLES_BOX) + COALESCE(SUM(APPLES_CH),0) AS APPLE_COUNT, SUM(ORANGE_BOX) + COALESCE(SUM(ORANGE_CH), 0) AS ORANGE_COUNT FROM T_ALL"
92,Y,N,"WITH TABLE1 AS (SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM BOXES), TABLE2 AS (SELECT SUM(IFNULL(C.APPLE_COUNT,0)) AS APPLE_COUNT, SUM(IFNULL(C.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES AS B LEFT JOIN CHESTS AS C ON B.CHEST_ID = C.CHEST_ID) SELECT SUM(A.APPLE_COUNT) AS APPLE_COUNT, SUM(A.ORANGE_COUNT) AS ORANGE_COUNT FROM (SELECT * FROM TABLE1 UNION ALL SELECT * FROM TABLE2) AS A"
93,Y,N,"WITH TABLE1 AS( SELECT APPLE_COUNT, ORANGE_COUNT FROM BOXES UNION ALL SELECT C.APPLE_COUNT, C.ORANGE_COUNT FROM CHESTS C INNER JOIN BOXES B USING(CHEST_ID) ) SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM TABLE1"
94,Y,N,"WITH TMP AS (SELECT COALESCE(APPLE_COUNT, 0) AS APPLE_COUNT, COALESCE(ORANGE_COUNT, 0) AS ORANGE_COUNT FROM BOXES UNION ALL SELECT COALESCE(C.APPLE_COUNT, 0) AS APPLE_COUNT, COALESCE(C.ORANGE_COUNT, 0) AS ORANGE_COUNT FROM CHESTS AS C JOIN BOXES USING(CHEST_ID)) SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM TMP"
95,Y,N,"SELECT (COALESCE(BSUM.APPLE_COUNT,0) + COALESCE(CSUM.APPLE_COUNT,0)) AS APPLE_COUNT, (COALESCE(BSUM.ORANGE_COUNT,0) + COALESCE(CSUM.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM (SELECT SUM(CHESTS.APPLE_COUNT) AS APPLE_COUNT, SUM(CHESTS.ORANGE_COUNT) AS ORANGE_COUNT FROM BOXES LEFT JOIN CHESTS ON BOXES.CHEST_ID = CHESTS.CHEST_ID) AS CSUM, (SELECT SUM(APPLE_COUNT) AS APPLE_COUNT , SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM BOXES) AS BSUM"
96,Y,Y,"SELECT (SUM(A.APPLE_COUNT) + IFNULL(SUM(B.APPLE_COUNT),0)) AS APPLE_COUNT, (SUM(A.ORANGE_COUNT) + IFNULL(SUM(B.ORANGE_COUNT),0)) AS ORANGE_COUNT FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID = B.CHEST_ID"
97,Y,Y,"SELECT (SUM(B.APPLE_COUNT) + SUM(CASE WHEN C.APPLE_COUNT IS NULL THEN 0 ELSE C.APPLE_COUNT END)) AS APPLE_COUNT, (SUM(B.ORANGE_COUNT) + SUM(CASE WHEN C.ORANGE_COUNT IS NULL THEN 0 ELSE C.ORANGE_COUNT END)) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
98,Y,Y,"SELECT (SUM(B.APPLE_COUNT) + SUM(IFNULL(C.APPLE_COUNT,0))) APPLE_COUNT, (SUM(B.ORANGE_COUNT) + SUM(IFNULL(C.ORANGE_COUNT, 0))) ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
99,Y,Y,"SELECT (SUM(B.APPLE_COUNT)+SUM(COALESCE(C.APPLE_COUNT,0))) AS APPLE_COUNT, (SUM(B.ORANGE_COUNT)+SUM(COALESCE(C.ORANGE_COUNT,0))) AS ORANGE_COUNT FROM BOXES B LEFT OUTER JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
100,Y,Y,"SELECT (SUM(COALESCE(B.APPLE_COUNT,0))+SUM(COALESCE(C.APPLE_COUNT,0))) AS APPLE_COUNT, (SUM(COALESCE(B.ORANGE_COUNT,0))+SUM(COALESCE(C.ORANGE_COUNT,0))) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
101,Y,Y,"SELECT (SUM(IFNULL(B.APPLE_COUNT, 0)) + SUM(IFNULL(C.APPLE_COUNT, 0)))AS APPLE_COUNT, (SUM(IFNULL(B.ORANGE_COUNT, 0)) + SUM(IFNULL(C.ORANGE_COUNT, 0))) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
102,Y,Y,"SELECT * FROM (SELECT SUM(B.APPLE_COUNT + COALESCE(C.APPLE_COUNT, 0)) AS APPLE_COUNT, SUM(B.ORANGE_COUNT + COALESCE(C.ORANGE_COUNT, 0)) AS ORANGE_COUNT FROM BOXES AS B LEFT JOIN CHESTS AS C ON B.CHEST_ID = C.CHEST_ID ) AS A"
103,Y,Y,"SELECT SUM(B.APPLE_COUNT + (CASE WHEN B.CHEST_ID IS NULL THEN 0 ELSE C.APPLE_COUNT END )) AS APPLE_COUNT, SUM(B.ORANGE_COUNT + (CASE WHEN B.CHEST_ID IS NULL THEN 0 ELSE C.ORANGE_COUNT END )) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
104,Y,Y,"SELECT SUM(CASE WHEN BOXES.CHEST_ID IS NULL THEN BOXES.APPLE_COUNT ELSE BOXES.APPLE_COUNT + CHESTS.APPLE_COUNT END) APPLE_COUNT, SUM(CASE WHEN BOXES.CHEST_ID IS NULL THEN BOXES.ORANGE_COUNT ELSE BOXES.ORANGE_COUNT + CHESTS.ORANGE_COUNT END) ORANGE_COUNT FROM BOXES LEFT JOIN CHESTS ON BOXES.CHEST_ID = CHESTS.CHEST_ID"
105,Y,Y,"SELECT SUM(CASE WHEN B.CHEST_ID IS NULL THEN B.APPLE_COUNT ELSE (B.APPLE_COUNT + C.APPLE_COUNT) END) AS APPLE_COUNT, SUM(CASE WHEN B.CHEST_ID IS NULL THEN B.ORANGE_COUNT ELSE (B.ORANGE_COUNT + C.ORANGE_COUNT) END) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
106,Y,Y,"SELECT SUM(CASE WHEN B.CHEST_ID IS NULL THEN B.APPLE_COUNT ELSE B.APPLE_COUNT + C.APPLE_COUNT END) APPLE_COUNT, SUM(CASE WHEN B.CHEST_ID IS NULL THEN B.ORANGE_COUNT ELSE B.ORANGE_COUNT + C.ORANGE_COUNT END) ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
107,Y,Y,"SELECT SUM(COALESCE(B.APPLE_COUNT,0) + COALESCE(C.APPLE_COUNT,0)) APPLE_COUNT , SUM(COALESCE(B.ORANGE_COUNT,0) + COALESCE(C.ORANGE_COUNT,0)) ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
108,Y,Y,"SELECT SUM(B.APPLE_COUNT + COALESCE(C.APPLE_COUNT, 0)) APPLE_COUNT, SUM(B.ORANGE_COUNT + COALESCE(C.ORANGE_COUNT, 0)) ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
109,Y,Y,"SELECT COALESCE(SUM(B.APPLE_COUNT), 0) + COALESCE(SUM(C.APPLE_COUNT), 0) AS APPLE_COUNT, COALESCE(SUM(B.ORANGE_COUNT), 0) + COALESCE(SUM(C.ORANGE_COUNT), 0) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
110,Y,Y,"SELECT IFNULL(SUM(ACNT1),0)+IFNULL(SUM(ACNT2),0) AS APPLE_COUNT, IFNULL(SUM(OCNT1),0)+IFNULL(SUM(OCNT2),0) AS ORANGE_COUNT FROM( SELECT BOX_ID, B.CHEST_ID, B.APPLE_COUNT AS ACNT1, C.APPLE_COUNT AS ACNT2, B.ORANGE_COUNT AS OCNT1, C.ORANGE_COUNT AS OCNT2 FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID=C.CHEST_ID) T"
111,Y,Y,"SELECT IFNULL(SUM(B.APPLE_COUNT),0)+IFNULL(SUM(C.APPLE_COUNT),0) APPLE_COUNT, IFNULL(SUM(B.ORANGE_COUNT),0)+IFNULL(SUM(C.ORANGE_COUNT),0) ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID=C.CHEST_ID"
112,Y,Y,"SELECT SUM((B.APPLE_COUNT)+IFNULL((C.APPLE_COUNT),0)) AS APPLE_COUNT , SUM((B.ORANGE_COUNT)+IFNULL((C.ORANGE_COUNT),0)) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
113,Y,Y,"SELECT SUM((A.APPLE_COUNT + IFNULL(B.APPLE_COUNT, 0))) APPLE_COUNT, SUM((A.ORANGE_COUNT + IFNULL(B.ORANGE_COUNT, 0))) ORANGE_COUNT FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID = B.CHEST_ID"
114,Y,Y,"SELECT SUM(A.APPLE_COUNT) APPLE_COUNT, SUM(A.ORANGE_COUNT) ORANGE_COUNT FROM ( SELECT BOX_ID , CASE WHEN C.APPLE_COUNT IS NULL THEN B.APPLE_COUNT ELSE (C.APPLE_COUNT+B.APPLE_COUNT) END AS APPLE_COUNT, CASE WHEN C.ORANGE_COUNT IS NULL THEN B.ORANGE_COUNT ELSE (C.ORANGE_COUNT+B.ORANGE_COUNT) END AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID=C.CHEST_ID) A"
115,Y,Y,"SELECT SUM(BOXES.APPLE_COUNT+COALESCE(CHESTS.APPLE_COUNT,0)) AS APPLE_COUNT, SUM(BOXES.ORANGE_COUNT+COALESCE(CHESTS.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES LEFT JOIN CHESTS ON BOXES.CHEST_ID= CHESTS.CHEST_ID"
116,Y,Y,"SELECT SUM(COALESCE(B.APPLE_COUNT,0)+ COALESCE(C.APPLE_COUNT,0)) AS APPLE_COUNT, SUM(COALESCE(C.ORANGE_COUNT,0)+ COALESCE(B.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON C.CHEST_ID = B.CHEST_ID"
117,Y,Y,"SELECT SUM(IFNULL(B.APPLE_COUNT,0))+SUM(IFNULL(C.APPLE_COUNT, 0)) AS APPLE_COUNT, SUM(IFNULL(B.ORANGE_COUNT,0) )+SUM(IFNULL(C.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS AS C ON B.CHEST_ID = C.CHEST_ID"
118,Y,Y,"SELECT SUM(A.APPLE_COUNT + CASE WHEN B.APPLE_COUNT IS NULL THEN 0 ELSE B.APPLE_COUNT END) AS APPLE_COUNT, SUM(A.ORANGE_COUNT + CASE WHEN B.ORANGE_COUNT IS NULL THEN 0 ELSE B.ORANGE_COUNT END) AS ORANGE_COUNT FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID = B.CHEST_ID"
119,Y,Y,"SELECT SUM(A.APPLE_COUNT + IFNULL(B.APPLE_COUNT,0)) APPLE_COUNT, SUM(A.ORANGE_COUNT+ IFNULL(B.ORANGE_COUNT,0)) ORANGE_COUNT FROM BOXES A LEFT JOIN CHESTS B USING (CHEST_ID)"
120,Y,Y,"SELECT SUM(A.APPLE_COUNT + IFNULL(B.APPLE_COUNT,0)) AS APPLE_COUNT, SUM(IFNULL(B.ORANGE_COUNT, 0) + A.ORANGE_COUNT) AS ORANGE_COUNT FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID = B.CHEST_ID"
121,Y,Y,"SELECT SUM(A.APPLE_COUNT) + SUM(IFNULL(B.APPLE_COUNT,0) )AS APPLE_COUNT, SUM(A.ORANGE_COUNT) + SUM(IFNULL(B.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES AS A LEFT JOIN CHESTS AS B ON A.CHEST_ID = B.CHEST_ID"
122,Y,Y,"SELECT SUM(A.APPLE_COUNT) + SUM(IFNULL(B.APPLE_COUNT,0)) AS APPLE_COUNT, SUM(A.ORANGE_COUNT) + SUM(IFNULL(B.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID = B.CHEST_ID"
123,Y,Y,"SELECT SUM(A.APPLE_COUNT+COALESCE(B.APPLE_COUNT,0)) AS APPLE_COUNT, SUM(A.ORANGE_COUNT+COALESCE(B.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID = B.CHEST_ID"
124,Y,Y,"SELECT SUM(A1+A2) AS APPLE_COUNT,SUM(O1+O2) AS ORANGE_COUNT FROM ( SELECT BOX_ID, BOXES.CHEST_ID, BOXES.APPLE_COUNT AS A1,BOXES.ORANGE_COUNT AS O1,IFNULL(CHESTS.APPLE_COUNT,0) AS A2,IFNULL(CHESTS.ORANGE_COUNT,0) AS O2 FROM BOXES LEFT JOIN CHESTS ON BOXES.CHEST_ID=CHESTS.CHEST_ID) A"
125,Y,Y,"SELECT SUM(AAA.AS) APPLE_COUNT , SUM(AAA.OS) ORANGE_COUNT FROM (SELECT B.*, IFNULL(C.APPLE_COUNT,0)+B.APPLE_COUNT AS , IFNULL(C.ORANGE_COUNT,0)+B.ORANGE_COUNT OS FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID=C.CHEST_ID) AAA"
126,Y,N,"SELECT SUM(AC) AS APPLE_COUNT, SUM(OC) AS ORANGE_COUNT FROM ( SELECT BOX_ID, B.APPLE_COUNT + IFNULL(SUM(C.APPLE_COUNT),0) AS AC, B.ORANGE_COUNT+IFNULL(SUM(C.ORANGE_COUNT),0) AS OC FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID GROUP BY BOX_ID) AS TOTAL"
127,Y,Y,"SELECT SUM(APP) AS APPLE_COUNT, SUM(OR2) AS ORANGE_COUNT FROM( SELECT APP1+APP2 AS APP, OR1+OR2 AS OR2 FROM( SELECT B.APPLE_COUNT AS APP1, B.ORANGE_COUNT AS OR1, IFNULL(C.APPLE_COUNT,0) AS APP2, IFNULL(C.ORANGE_COUNT,0) AS OR2 FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID=C.CHEST_ID) AS TEMP1) AS TEMP2"
128,Y,Y,"SELECT SUM(APPLE_COUNT + B_APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT + B_ORANGE_COUNT) AS ORANGE_COUNT FROM (SELECT BOX_ID, A.APPLE_COUNT, A.ORANGE_COUNT, CASE WHEN B.APPLE_COUNT IS NULL THEN 0 ELSE B.APPLE_COUNT END AS B_APPLE_COUNT, CASE WHEN B.ORANGE_COUNT IS NULL THEN 0 ELSE B.ORANGE_COUNT END AS B_ORANGE_COUNT FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID = B.CHEST_ID) A"
129,Y,Y,"SELECT SUM(APPLE_COUNT + IFNULL(C_APP,0)) APPLE_COUNT, SUM(ORANGE_COUNT + IFNULL(C_ORG,0)) ORANGE_COUNT FROM ( SELECT B.BOX_ID, B.APPLE_COUNT, C.APPLE_COUNT C_APP, B.ORANGE_COUNT, C.ORANGE_COUNT C_ORG FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID ) A"
130,Y,Y,"SELECT SUM(APPLE_COUNT + IFNULL(CHEST_APPLE, 0)) AS APPLE_COUNT, SUM(ORANGE_COUNT + IFNULL(CHEST_ORANGE, 0)) AS ORANGE_COUNT FROM ( SELECT B.BOX_ID, B.CHEST_ID, B.APPLE_COUNT, B.ORANGE_COUNT, C.APPLE_COUNT AS CHEST_APPLE, C.ORANGE_COUNT AS CHEST_ORANGE FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID ) A"
131,Y,N,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT , SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM ( SELECT BOX_ID, APPLE_COUNT, ORANGE_COUNT FROM BOXES UNION ALL SELECT CASE WHEN A.CHEST_ID IS NULL THEN NULL ELSE A.CHEST_ID END AS ID , B.APPLE_COUNT ,B.ORANGE_COUNT FROM BOXES AS A LEFT JOIN CHESTS AS B ON A.CHEST_ID =B.CHEST_ID ) AS A"
132,Y,N,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM ( (SELECT BOX_ID, APPLE_COUNT, ORANGE_COUNT FROM BOXES) UNION ALL (SELECT A.BOX_ID, B.APPLE_COUNT, B.ORANGE_COUNT FROM BOXES A JOIN CHESTS B ON A.CHEST_ID = B.CHEST_ID) ) V"
133,Y,Y,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM ( SELECT (IFNULL(B.APPLE_COUNT,0)+IFNULL(C.APPLE_COUNT,0)) AS APPLE_COUNT, (IFNULL(B.ORANGE_COUNT,0)+IFNULL(C.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID=C.CHEST_ID )A"
134,Y,N,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM ( SELECT B.BOX_ID,C.APPLE_COUNT,C.ORANGE_COUNT FROM BOXES AS B LEFT JOIN CHESTS AS C ON B.CHEST_ID = C.CHEST_ID UNION ALL SELECT BOX_ID, APPLE_COUNT, ORANGE_COUNT FROM BOXES ) AS T"
135,Y,N,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM ( SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM ( SELECT A.CHEST_ID, B.APPLE_COUNT, B.ORANGE_COUNT FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID = B.CHEST_ID WHERE A.CHEST_ID IS NOT NULL) A UNION SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM BOXES) B"
136,Y,Y,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM (SELECT A.BOX_ID, (A.APPLE_COUNT+COALESCE(B.APPLE_COUNT,0)) AS APPLE_COUNT, (A.ORANGE_COUNT+COALESCE(B.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID=B.CHEST_ID )A"
137,Y,N,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM (SELECT APPLE_COUNT, ORANGE_COUNT FROM BOXES UNION ALL SELECT C.APPLE_COUNT, C.ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID)A"
138,Y,Y,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM (SELECT B.APPLE_COUNT + IFNULL(C.APPLE_COUNT, 0) AS APPLE_COUNT, B.ORANGE_COUNT + IFNULL(C.ORANGE_COUNT, 0) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C USING (CHEST_ID)) A"
139,Y,Y,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM (SELECT BOX_ID, B.CHEST_ID, B.APPLE_COUNT + C.APPLE_COUNT AS APPLE_COUNT, B.ORANGE_COUNT + C.ORANGE_COUNT AS ORANGE_COUNT FROM BOXES B JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID UNION ALL SELECT * FROM BOXES WHERE CHEST_ID IS NULL) A"
140,Y,N,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM (SELECT BOX_ID, CASE WHEN B.CHEST_ID IS NULL THEN B.APPLE_COUNT ELSE B.APPLE_COUNT + SUM(C.APPLE_COUNT) END AS APPLE_COUNT, CASE WHEN B.CHEST_ID IS NULL THEN B.ORANGE_COUNT ELSE B.ORANGE_COUNT + SUM(C.ORANGE_COUNT) END AS ORANGE_COUNT FROM BOXES AS B LEFT JOIN CHESTS AS C ON B.CHEST_ID = C.CHEST_ID GROUP BY BOX_ID) AS T"
141,Y,N,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM( SELECT APPLE_COUNT, ORANGE_COUNT FROM BOXES UNION ALL SELECT C.APPLE_COUNT, C.ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID) TB1"
142,Y,Y,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT,SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM ( SELECT CASE WHEN B.CHEST_ID IS NULL THEN B.APPLE_COUNT WHEN B.CHEST_ID IS NOT NULL THEN B.APPLE_COUNT+C.APPLE_COUNT END AS APPLE_COUNT, CASE WHEN B.CHEST_ID IS NULL THEN B.ORANGE_COUNT WHEN B.CHEST_ID IS NOT NULL THEN B.ORANGE_COUNT+C.ORANGE_COUNT END AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID=C.CHEST_ID ) A"
143,Y,Y,"SELECT SUM(APPLE_COUNT)+SUM(APPLE) AS APPLE_COUNT,SUM(ORANGE_COUNT)+SUM(ORANGE) AS ORANGE_COUNT FROM (SELECT A.*, IFNULL(B.APPLE_COUNT,0) AS APPLE,IFNULL(B.ORANGE_COUNT,0) AS ORANGE FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID=B.CHEST_ID)A"
144,Y,Y,"SELECT SUM(APPLE_COUNT)APPLE_COUNT,SUM(ORANGE_COUNT)ORANGE_COUNT FROM (SELECT BOX_ID,B.CHEST_ID ,(B.APPLE_COUNT + IFNULL(C.APPLE_COUNT,0)) APPLE_COUNT, B.ORANGE_COUNT + IFNULL(C.ORANGE_COUNT,0) ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID)L"
145,Y,Y,"SELECT SUM(APPLE_COUNT+CHEST_APPLE) AS APPLE_COUNT,SUM(ORANGE_COUNT+CHEST_ORANGE) AS ORANGE_COUNT FROM( SELECT A.*, IFNULL(B.APPLE_COUNT,0) AS CHEST_APPLE, IFNULL(B.ORANGE_COUNT,0) AS CHEST_ORANGE FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID=B.CHEST_ID) T"
146,Y,Y,"SELECT SUM(APPLES_COUNT) AS APPLE_COUNT, SUM(ORANGES_COUNT) AS ORANGE_COUNT FROM ( SELECT B.BOX_ID, B.CHEST_ID, B.APPLE_COUNT + COALESCE(C.APPLE_COUNT,0) AS APPLES_COUNT, B.ORANGE_COUNT + COALESCE(C.ORANGE_COUNT,0) AS ORANGES_COUNT FROM BOXES B LEFT OUTER JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID ) ASD"
147,Y,Y,"SELECT SUM(B.APPLE_COUNT + (CASE WHEN C.APPLE_COUNT IS NULL THEN 0 ELSE C.APPLE_COUNT END)) APPLE_COUNT, SUM(B.ORANGE_COUNT + (CASE WHEN C.ORANGE_COUNT IS NULL THEN 0 ELSE C.ORANGE_COUNT END)) ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON C.CHEST_ID = B.CHEST_ID"
148,Y,N,"SELECT SUM(B.APPLE_COUNT + COALESCE(CH.APPLE, 0)) AS APPLE_COUNT, SUM(B.ORANGE_COUNT + COALESCE(CH.ORANGE, 0) ) AS ORANGE_COUNT FROM BOXES B LEFT JOIN (SELECT C.CHEST_ID, SUM(C.APPLE_COUNT) AS APPLE, SUM(C.ORANGE_COUNT) AS ORANGE FROM CHESTS C GROUP BY C.CHEST_ID) CH ON B.CHEST_ID = CH.CHEST_ID"
149,Y,N,"SELECT SUM(B.APPLE_COUNT + IFNULL(CH.APPLE, 0)) AS APPLE_COUNT, SUM(B.ORANGE_COUNT + IFNULL(CH.ORANGE, 0) ) AS ORANGE_COUNT FROM BOXES B LEFT JOIN (SELECT C.CHEST_ID, SUM(C.APPLE_COUNT) AS APPLE, SUM(C.ORANGE_COUNT) AS ORANGE FROM CHESTS C GROUP BY C.CHEST_ID) CH ON B.CHEST_ID = CH.CHEST_ID"
150,Y,Y,"SELECT SUM(B.APPLE_COUNT + COALESCE(C.APPLE_COUNT, 0)) AS APPLE_COUNT, SUM(B.ORANGE_COUNT + COALESCE(C.ORANGE_COUNT, 0)) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C USING(CHEST_ID)"
151,Y,Y,"SELECT SUM(B.APPLE_COUNT + COALESCE(C.APPLE_COUNT,0)) AS APPLE_COUNT, SUM(B.ORANGE_COUNT + COALESCE(C.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES AS B LEFT JOIN CHESTS AS C ON C.CHEST_ID = B.CHEST_ID"
152,Y,Y,"SELECT SUM(B.APPLE_COUNT + COALESCE(C.APPLE_COUNT,0)) AS APPLE_COUNT, SUM(B.ORANGE_COUNT + COALESCE(C.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES B LEFT OUTER JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
153,Y,Y,"SELECT SUM(B.APPLE_COUNT + IF(B.CHEST_ID IS NULL, 0, C.APPLE_COUNT)) AS APPLE_COUNT, SUM(B.ORANGE_COUNT + IF(B.CHEST_ID IS NULL, 0, C.ORANGE_COUNT))AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
154,Y,Y,"SELECT SUM(B.APPLE_COUNT + IFNULL((C.APPLE_COUNT),0))AS APPLE_COUNT , SUM(B.ORANGE_COUNT + IFNULL((C.ORANGE_COUNT),0)) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
155,Y,Y,"SELECT SUM(B.APPLE_COUNT + IFNULL(C.APPLE_COUNT, 0)) APPLE_COUNT, SUM(B.ORANGE_COUNT + IFNULL(C.ORANGE_COUNT, 0)) ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON C.CHEST_ID = B.CHEST_ID"
156,Y,Y,"SELECT SUM(B.APPLE_COUNT + IFNULL(C.APPLE_COUNT,0)) AS APPLE_COUNT , SUM(B.ORANGE_COUNT + IFNULL(C.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES AS B LEFT OUTER JOIN CHESTS AS C ON B.CHEST_ID = C.CHEST_ID"
157,Y,Y,"SELECT SUM(B.APPLE_COUNT + IFNULL(C.APPLE_COUNT,0)) AS APPLE_COUNT ,SUM(B.ORANGE_COUNT + IFNULL(C.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON C.CHEST_ID = B.CHEST_ID"
158,Y,Y,"SELECT SUM(B.APPLE_COUNT + IFNULL(C.APPLE_COUNT,0)) AS APPLE_COUNT, SUM(IFNULL(C.ORANGE_COUNT,0) + B.ORANGE_COUNT) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C USING(CHEST_ID)"
159,Y,Y,"SELECT SUM(B.APPLE_COUNT) + IFNULL(SUM(C.APPLE_COUNT),0) APPLE_COUNT, SUM(B.ORANGE_COUNT) + IFNULL(SUM(C.ORANGE_COUNT),0) ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
160,Y,Y,"SELECT SUM(B.APPLE_COUNT) + SUM( COALESCE(C.APPLE_COUNT,0)) AS APPLE_COUNT, SUM(B.ORANGE_COUNT) + SUM( COALESCE(C.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
161,Y,Y,"SELECT SUM(B.APPLE_COUNT) + SUM(IFNULL(C.APPLE_COUNT,0)) AS APPLE_COUNT, SUM(B.ORANGE_COUNT) + SUM(IFNULL(C.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON C.CHEST_ID = B.CHEST_ID"
162,Y,Y,"SELECT SUM(B.APPLE_COUNT) + SUM(CASE WHEN C.APPLE_COUNT IS NULL THEN 0 ELSE C.APPLE_COUNT END)AS APPLE_COUNT, SUM(B.ORANGE_COUNT) + SUM(CASE WHEN C.ORANGE_COUNT IS NULL THEN 0 ELSE C.ORANGE_COUNT END)AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
163,Y,Y,"SELECT SUM(B.APPLE_COUNT) + SUM(IFNULL(C.APPLE_COUNT, 0)) APPLE_COUNT, SUM(B.ORANGE_COUNT) + SUM(IFNULL(C.ORANGE_COUNT, 0)) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
164,Y,Y,"SELECT SUM(B.APPLE_COUNT) + SUM(IFNULL(C.APPLE_COUNT, 0)) AS APPLE_COUNT, SUM(B.ORANGE_COUNT) + SUM(IFNULL(C.ORANGE_COUNT, 0)) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
165,Y,Y,"SELECT SUM(B.APPLE_COUNT) + SUM(IFNULL(C.APPLE_COUNT,0)) AS APPLE_COUNT, SUM(B.ORANGE_COUNT) + SUM(IFNULL(C.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C USING(CHEST_ID)"
166,Y,Y,"SELECT SUM(B.APPLE_COUNT) AS APPLE_COUNT, SUM(B.ORANGE_COUNT) AS ORANGE_COUNT FROM (SELECT BOX_ID, (CASE WHEN CHESTS.APPLE_COUNT IS NULL THEN BOXES.APPLE_COUNT ELSE BOXES.APPLE_COUNT + CHESTS.APPLE_COUNT END) AS APPLE_COUNT, (CASE WHEN CHESTS.ORANGE_COUNT IS NULL THEN BOXES.ORANGE_COUNT ELSE BOXES.ORANGE_COUNT + CHESTS.ORANGE_COUNT END) AS ORANGE_COUNT FROM BOXES LEFT JOIN CHESTS ON BOXES.CHEST_ID = CHESTS.CHEST_ID) B"
167,Y,Y,"SELECT SUM(B.APPLE_COUNT)+SUM(IFNULL(C.APPLE_COUNT, 0)) APPLE_COUNT, SUM(B.ORANGE_COUNT)+SUM(IFNULL(C.ORANGE_COUNT, 0)) ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
168,Y,Y,"SELECT SUM(B.APPLE_COUNT)+SUM(IFNULL(C.APPLE_COUNT,0)) AS APPLE_COUNT, SUM(B.ORANGE_COUNT)+SUM(IFNULL(C.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES AS B LEFT JOIN CHESTS AS C ON B.CHEST_ID = C.CHEST_ID"
169,Y,Y,"SELECT SUM(B.APPLE_COUNT+ IFNULL(C.APPLE_COUNT,0)) APPLE_COUNT, SUM(B.ORANGE_COUNT+ IFNULL(C.ORANGE_COUNT,0)) ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C USING (CHEST_ID)"
170,Y,Y,"SELECT SUM(B.APPLE_COUNT+COALESCE(C.APPLE_COUNT,0)) AS APPLE_COUNT,SUM(B.ORANGE_COUNT+COALESCE(C.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON COALESCE(B.CHEST_ID,0)=C.CHEST_ID"
171,Y,Y,"SELECT SUM(BOX_APPLE_CNT+CHEST_APPLE_CNT) AS APPLE_COUNT, SUM(BOX_ORANGE_CNT+CHEST_ORANGE_CNT) AS ORANGE_COUNT FROM (SELECT T1.APPLE_COUNT AS BOX_APPLE_CNT, IFNULL(T2.APPLE_COUNT,0) AS CHEST_APPLE_CNT, T1.ORANGE_COUNT AS BOX_ORANGE_CNT, IFNULL(T2.ORANGE_COUNT,0) AS CHEST_ORANGE_CNT FROM BOXES T1 LEFT JOIN CHESTS T2 ON T1.CHEST_ID = T2.CHEST_ID) T"
172,Y,Y,"SELECT SUM(BOXES.APPLE_COUNT) + SUM(IFNULL(CHESTS.APPLE_COUNT,0)) AS APPLE_COUNT, SUM(BOXES.ORANGE_COUNT) + SUM(IFNULL(CHESTS.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES LEFT JOIN CHESTS USING (CHEST_ID)"
173,Y,Y,"SELECT SUM(C.APPLE1) AS APPLE_COUNT, SUM(C.ORANGE1) AS ORANGE_COUNT FROM (SELECT A.BOX_ID, A.CHEST_ID, A.APPLE_COUNT+IFNULL(B.APPLE_COUNT,0) AS APPLE1, A.ORANGE_COUNT+IFNULL(B.ORANGE_COUNT,0) AS ORANGE1 FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID=B.CHEST_ID )C"
174,Y,Y,"SELECT SUM(CASE WHEN A.CHEST_ID IS NOT NULL THEN (A.APPLE_COUNT+B.APPLE_COUNT) ELSE A.APPLE_COUNT END) AS APPLE_COUNT, SUM(CASE WHEN A.CHEST_ID IS NOT NULL THEN (A.ORANGE_COUNT+B.ORANGE_COUNT) ELSE A.ORANGE_COUNT END) AS ORANGE_COUNT FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID = B.CHEST_ID"
175,Y,Y,"SELECT SUM(CASE WHEN A.CHEST_ID IS NULL THEN A.APPLE_COUNT ELSE A.APPLE_COUNT + B.APPLE_COUNT END) AS APPLE_COUNT, SUM(CASE WHEN A.CHEST_ID IS NULL THEN A.ORANGE_COUNT ELSE A.ORANGE_COUNT + B.ORANGE_COUNT END) AS ORANGE_COUNT FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID = B.CHEST_ID"
176,Y,Y,"SELECT SUM(CASE WHEN B.APPLE_COUNT IS NULL THEN 0 ELSE B.APPLE_COUNT END)+ SUM(CASE WHEN C.APPLE_COUNT IS NULL THEN 0 ELSE C.APPLE_COUNT END) AS APPLE_COUNT, SUM(CASE WHEN B.ORANGE_COUNT IS NULL THEN 0 ELSE B.ORANGE_COUNT END)+ SUM(CASE WHEN C.ORANGE_COUNT IS NULL THEN 0 ELSE C.ORANGE_COUNT END) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID=C.CHEST_ID"
177,Y,Y,"SELECT SUM(CASE WHEN B.CHEST_ID IS NOT NULL THEN (B.APPLE_COUNT + C.APPLE_COUNT) ELSE B.APPLE_COUNT END) AS APPLE_COUNT, SUM(CASE WHEN B.CHEST_ID IS NOT NULL THEN (B.ORANGE_COUNT + C.ORANGE_COUNT) ELSE B.ORANGE_COUNT END) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
178,Y,Y,"SELECT SUM(CASE WHEN B.CHEST_ID IS NOT NULL THEN (B.APPLE_COUNT+CH.APPLE_COUNT) ELSE B.APPLE_COUNT END) APPLE_COUNT, SUM(CASE WHEN B.CHEST_ID IS NOT NULL THEN (B.ORANGE_COUNT+CH.ORANGE_COUNT) ELSE B.ORANGE_COUNT END) ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS CH ON B.CHEST_ID=CH.CHEST_ID"
179,Y,Y,"SELECT SUM(CASE WHEN B.CHEST_ID IS NOT NULL THEN B.APPLE_COUNT + A.APPLE_COUNT ELSE B.APPLE_COUNT END) AS APPLE_COUNT, SUM(CASE WHEN B.CHEST_ID IS NOT NULL THEN B.ORANGE_COUNT + A.ORANGE_COUNT ELSE B.ORANGE_COUNT END) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS A ON B.CHEST_ID= A.CHEST_ID"
180,Y,Y,"SELECT SUM(CASE WHEN B.CHEST_ID IS NOT NULL THEN B.APPLE_COUNT+C.APPLE_COUNT ELSE B.APPLE_COUNT END) AS APPLE_COUNT, SUM(CASE WHEN B.CHEST_ID IS NOT NULL THEN B.ORANGE_COUNT+C.ORANGE_COUNT ELSE B.ORANGE_COUNT END) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON C.CHEST_ID=B.CHEST_ID"
181,Y,Y,"SELECT SUM(CASE WHEN CHEST_ID IS NULL THEN TMP.APPLE_COUNT ELSE TMP.APPLE_COUNT+TMP.C_APPLE_COUNT END) AS APPLE_COUNT, SUM(CASE WHEN CHEST_ID IS NULL THEN TMP.ORANGE_COUNT ELSE TMP.ORANGE_COUNT+TMP.C_ORANGE_COUNT END) AS ORANGE_COUNT FROM ( SELECT B.*, C.APPLE_COUNT AS C_APPLE_COUNT, C.ORANGE_COUNT AS C_ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID )TMP"
182,Y,Y,"SELECT SUM(CASE WHEN T1.CHEST_ID IS NOT NULL THEN T1.APPLE_COUNT+IFNULL(T2.APPLE_COUNT,0) ELSE T1.APPLE_COUNT END) AS APPLE_COUNT, SUM(CASE WHEN T1.CHEST_ID IS NOT NULL THEN T1.ORANGE_COUNT+IFNULL(T2.ORANGE_COUNT,0) ELSE T1.ORANGE_COUNT END) AS ORANGE_COUNT FROM BOXES T1 LEFT JOIN CHESTS T2 ON T1.CHEST_ID = T2.CHEST_ID"
183,Y,Y,"SELECT SUM(COALESCE(A.APPLE_COUNT,0) + COALESCE(B.APPLE_COUNT,0)) AS APPLE_COUNT, SUM(COALESCE(A.ORANGE_COUNT,0) + COALESCE(B.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID = B.CHEST_ID"
184,Y,Y,"SELECT SUM(COALESCE(C.APPLE_COUNT,0)+B.APPLE_COUNT) AS APPLE_COUNT, SUM(COALESCE(C.ORANGE_COUNT,0)+B.ORANGE_COUNT) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
185,Y,N,"SELECT SUM(IF(A.CHEST_ID IN (SELECT CHEST_ID FROM CHESTS),A.APPLES_BOX+C.APPLE_COUNT,A.APPLES_BOX)) AS APPLE_COUNT, SUM(IF(A.CHEST_ID IN (SELECT CHEST_ID FROM CHESTS),A.ORANGE_BOX+C.ORANGE_COUNT,A.ORANGE_BOX)) AS ORANGE_COUNT FROM (SELECT BOX_ID, CHEST_ID,SUM(APPLE_COUNT) AS APPLES_BOX,SUM(ORANGE_COUNT)AS ORANGE_BOX FROM BOXES GROUP BY BOX_ID)A LEFT JOIN CHESTS C ON A.CHEST_ID=C.CHEST_ID"
186,Y,Y,"SELECT SUM(IFNULL(A.APPLE_COUNT,0)+ IFNULL(B.APPLE_COUNT,0)) AS APPLE_COUNT, SUM(IFNULL(A.ORANGE_COUNT,0) + IFNULL(B.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID = B.CHEST_ID"
187,Y,Y,"SELECT SUM(IFNULL(B.APPLE_COUNT, 0) + A.APPLE_COUNT) AS APPLE_COUNT, SUM(IFNULL(B.ORANGE_COUNT, 0) + A.ORANGE_COUNT) AS ORANGE_COUNT FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID = B.CHEST_ID"
188,Y,Y,"SELECT SUM(IFNULL(C.APPLE_COUNT, 0)+ B.APPLE_COUNT) AS APPLE_COUNT, SUM(IFNULL(C.ORANGE_COUNT, 0)+ B.ORANGE_COUNT) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
189,Y,Y,"SELECT SUM(IFNULL(C.APPLE_COUNT,0) + (B.APPLE_COUNT)) AS APPLE_COUNT, SUM(IFNULL(C.ORANGE_COUNT,0) + (B.ORANGE_COUNT)) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
190,Y,Y,"SELECT SUM(IFNULL(C.APPLE_COUNT,0)) + SUM(IFNULL(B.APPLE_COUNT,0)) AS APPLE_COUNT, SUM(IFNULL(C.ORANGE_COUNT,0)) + SUM(IFNULL(B.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
191,Y,Y,"SELECT SUM(T.APPLE_COUNT) + SUM(IF(T.AP2, T.AP2, 0)) AS APPLE_COUNT, SUM(T.ORANGE_COUNT) + SUM(IF(T.OR2, T.OR2, 0)) AS ORANGE_COUNT FROM (SELECT B.BOX_ID, B.APPLE_COUNT, B.ORANGE_COUNT, C.APPLE_COUNT AS AP2, C.ORANGE_COUNT AS OR2 FROM BOXES B LEFT JOIN CHESTS C USING (CHEST_ID) ) AS T"
192,Y,Y,"SELECT SUM(TOTAL_APPLES) APPLE_COUNT , SUM(TOTAL_ORANGES) ORANGE_COUNT FROM (SELECT B.BOX_ID, (B.APPLE_COUNT + COALESCE(C.APPLE_COUNT, 0)) TOTAL_APPLES , (B.ORANGE_COUNT + COALESCE(C.ORANGE_COUNT, 0)) TOTAL_ORANGES FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID) CT"
193,Y,Y,"SELECT SUM_CAC+SUM_BAC AS APPLE_COUNT, SUM_COC+SUM_BOC AS ORANGE_COUNT FROM ( SELECT SUM(CAC) AS SUM_CAC, SUM(COC) AS SUM_COC, SUM(BOC) AS SUM_BOC, SUM(BAC) AS SUM_BAC FROM ( SELECT IFNULL(CHESTS.APPLE_COUNT, 0) AS CAC, IFNULL(CHESTS.ORANGE_COUNT, 0) AS COC, IFNULL(BOXES.APPLE_COUNT, 0) AS BAC, IFNULL(BOXES.ORANGE_COUNT, 0) AS BOC FROM BOXES LEFT JOIN CHESTS ON CHESTS.CHEST_ID = BOXES.CHEST_ID ) T ) F"
194,Y,N,"SELECT X+T1.Z AS APPLE_COUNT,Y+T1.V AS ORANGE_COUNT FROM (SELECT COALESCE(SUM(C.APPLE_COUNT),0) AS Z,COALESCE(SUM(C.ORANGE_COUNT),0) AS V FROM CHESTS C LEFT JOIN BOXES B USING(CHEST_ID) WHERE BOX_ID IS NOT NULL) AS T1,(SELECT SUM(APPLE_COUNT) AS X,SUM(ORANGE_COUNT) AS Y FROM BOXES) AS T2"
195,Y,Y,"WITH BC AS ( SELECT B.BOX_ID, B.APPLE_COUNT+IFNULL(C.APPLE_COUNT,0) AS APPLES, B.ORANGE_COUNT+IFNULL(C.ORANGE_COUNT,0) AS ORANGES FROM BOXES AS B LEFT JOIN CHESTS AS C ON B.CHEST_ID=C.CHEST_ID ) SELECT SUM(APPLES) AS APPLE_COUNT, SUM(ORANGES) AS ORANGE_COUNT FROM BC"
196,Y,Y,"WITH CTE AS ( SELECT (B.APPLE_COUNT + IFNULL(C.APPLE_COUNT,0)) AS APPLE_COUNT, (B.ORANGE_COUNT + IFNULL(C.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID ) SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM CTE"
197,Y,Y,"WITH A AS (SELECT BOX_ID, CHEST_ID, B.APPLE_COUNT AS BA, B.ORANGE_COUNT AS BO, C.APPLE_COUNT AS CA, C.ORANGE_COUNT AS CO FROM BOXES B LEFT JOIN CHESTS C USING(CHEST_ID) ) SELECT SUM(BA) + SUM(IF(CHEST_ID IS NOT NULL, CA ,0)) AS APPLE_COUNT, SUM(BO) + SUM(IF(CHEST_ID IS NOT NULL, CO ,0)) AS ORANGE_COUNT FROM A"
198,Y,Y,"WITH A AS( SELECT B.*, C.APPLE_COUNT AS A, C.ORANGE_COUNT AS C FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID ), T AS ( SELECT SUM(IFNULL(APPLE_COUNT,0)) AS AC, SUM(IFNULL(ORANGE_COUNT,0)) AS OC FROM A UNION SELECT SUM(IFNULL(A,0)), SUM(IFNULL(C,0)) FROM A ) SELECT SUM(AC) AS APPLE_COUNT, SUM(OC) AS ORANGE_COUNT FROM T"
199,Y,N,"WITH AA AS (SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM BOXES), BB AS (SELECT A.APPLE_COUNT*COUNT(B.BOX_ID) AS APPLE_COUNT, A.ORANGE_COUNT*COUNT(B.BOX_ID) AS ORANGE_COUNT FROM CHESTS AS A JOIN BOXES AS B ON A.CHEST_ID=B.CHEST_ID GROUP BY A.CHEST_ID) SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM (SELECT * FROM AA UNION ALL SELECT * FROM BB) AS CC"
200,Y,N,"WITH BOX_CNTS AS ( SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM BOXES ) , CHEST_CNTS AS ( SELECT SUM(C.APPLE_COUNT), SUM(C.ORANGE_COUNT) FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID ) , BOX_CHEST_CNTS AS ( SELECT * FROM BOX_CNTS UNION ALL SELECT * FROM CHEST_CNTS ) SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM BOX_CHEST_CNTS"
201,Y,N,"WITH BOXCOUNT AS (SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM BOXES), CHESTCOUNT AS (SELECT SUM(C.APPLE_COUNT) AS APPLE_COUNT, SUM(C.ORANGE_COUNT) AS ORANGE_COUNT FROM CHESTS C, BOXES B WHERE C.CHEST_ID = B.CHEST_ID) SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM ((SELECT * FROM BOXCOUNT) UNION ALL (SELECT * FROM CHESTCOUNT)) AS A"
202,Y,N,"WITH CNT AS( SELECT BOX_ID, B.CHEST_ID, (B.APPLE_COUNT+C.APPLE_COUNT) AS TOTAL_APPLE_CNT, (B.ORANGE_COUNT+C.ORANGE_COUNT) AS TOTAL_ORANGE_CNT FROM BOXES AS B LEFT JOIN CHESTS AS C ON B.CHEST_ID = C.CHEST_ID) SELECT SUM(CASE WHEN C.CHEST_ID IS NULL THEN APPLE_COUNT ELSE TOTAL_APPLE_CNT END) AS APPLE_COUNT, SUM(CASE WHEN C.CHEST_ID IS NULL THEN ORANGE_COUNT ELSE TOTAL_ORANGE_CNT END) AS ORANGE_COUNT FROM CNT AS C JOIN BOXES AS B ON C.BOX_ID = B.BOX_ID"
203,Y,Y,"WITH CTE AS ( SELECT B.CHEST_ID,B.APPLE_COUNT,B.ORANGE_COUNT,IFNULL(C.APPLE_COUNT,0) AS CHEST_APPLE ,IFNULL(C.ORANGE_COUNT,0) AS CHEST_ORANGE FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID ) SELECT SUM(APPLE_COUNT+CHEST_APPLE) AS APPLE_COUNT, SUM(ORANGE_COUNT+CHEST_ORANGE) AS ORANGE_COUNT FROM CTE"
204,Y,Y,"WITH CTE AS ( SELECT B.APPLE_COUNT AS APPLE_1,B.ORANGE_COUNT AS ORANGE_1, C.APPLE_COUNT AS APPLE_2, C.ORANGE_COUNT AS ORANGE_2 FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID) SELECT SUM(COALESCE(APPLE_1,0) + COALESCE(APPLE_2,0)) AS APPLE_COUNT, SUM(COALESCE(ORANGE_1,0) + COALESCE(ORANGE_2,0)) AS ORANGE_COUNT FROM CTE"
205,Y,Y,"WITH CTE AS ( SELECT B.BOX_ID, B.CHEST_ID, B.APPLE_COUNT AS APPLE_BOX, B.ORANGE_COUNT AS ORANGE_BOX, IFNULL(C.APPLE_COUNT,0) AS APPLE_CHEST, IFNULL(C.ORANGE_COUNT,0) AS ORANGE_CHEST FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID=C.CHEST_ID ) SELECT SUM(APPLE_BOX+APPLE_CHEST) AS APPLE_COUNT, SUM(ORANGE_BOX+ORANGE_CHEST) AS ORANGE_COUNT FROM CTE"
206,Y,Y,"WITH CTE AS ( SELECT B.BOX_ID,B.CHEST_ID,(B.APPLE_COUNT+COALESCE(C.APPLE_COUNT,0)) AS APPLE_COUNT, (B.ORANGE_COUNT+COALESCE(C.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES AS B LEFT JOIN CHESTS AS C ON B.CHEST_ID=C.CHEST_ID ) SELECT SUM(APPLE_COUNT) AS APPLE_COUNT,SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM CTE"
207,Y,N,"WITH CTE AS ( SELECT BOX_ID AS ID, APPLE_COUNT, ORANGE_COUNT FROM BOXES UNION ALL SELECT B.CHEST_ID AS ID, C.APPLE_COUNT, C.ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID ) SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM CTE"
208,Y,Y,"WITH CTE AS ( SELECT BOX_ID, B.CHEST_ID, (B.APPLE_COUNT + IFNULL(C.APPLE_COUNT, 0) ) AS APPLE_COUNT, (B.ORANGE_COUNT + IFNULL(C.ORANGE_COUNT, 0) ) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID ) SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM CTE"
209,Y,Y,"WITH CTE AS ( SELECT BOX_ID, B.CHEST_ID, B.APPLE_COUNT AS A1, C.APPLE_COUNT AS A2, B.ORANGE_COUNT AS O1, C.ORANGE_COUNT AS O2 FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID ) SELECT SUM(COALESCE(A1, 0) + COALESCE(A2, 0)) AS APPLE_COUNT, SUM(COALESCE(O1, 0) + COALESCE(O2, 0)) AS ORANGE_COUNT FROM CTE"
210,Y,Y,"WITH CTE AS ( SELECT BOX_ID, IFNULL(B.CHEST_ID,0) AS CHEST_ID, B.APPLE_COUNT,IFNULL(C.APPLE_COUNT,0) AS NEWA,B.ORANGE_COUNT,IFNULL(C.ORANGE_COUNT,0) AS NEWO FROM BOXES AS B LEFT JOIN CHESTS AS C ON B.CHEST_ID = C.CHEST_ID) SELECT SUM(APPLE_COUNT + NEWA) AS APPLE_COUNT, SUM(ORANGE_COUNT + NEWO) AS ORANGE_COUNT FROM CTE"
211,Y,Y,"WITH CTE AS ( SELECT BOX_ID,T1.CHEST_ID,T1.APPLE_COUNT AS A1,T2.APPLE_COUNT A2, T1.ORANGE_COUNT AS O1, T2.ORANGE_COUNT AS O2 FROM BOXES T1 LEFT JOIN CHESTS T2 ON T1.CHEST_ID=T2.CHEST_ID ), CTE2 AS ( SELECT BOX_ID,CASE WHEN CHEST_ID IS NULL THEN A1 ELSE A1+A2 END AS TOTAL_APPLE_CNT, CASE WHEN CHEST_ID IS NULL THEN O1 ELSE O1+O2 END AS ORANGE_CNT FROM CTE ) SELECT SUM(TOTAL_APPLE_CNT) AS APPLE_COUNT,SUM(ORANGE_CNT) AS ORANGE_COUNT FROM CTE2"
212,Y,Y,"WITH CTE AS (SELECT A.*,B.APPLE_COUNT AS C_APP_CNT, B.ORANGE_COUNT AS C_ORG_CNT FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID=B.CHEST_ID) SELECT SUM(APPLE_COUNT+IFNULL(C_APP_CNT,0)) AS APPLE_COUNT, SUM(ORANGE_COUNT+IFNULL(C_ORG_CNT,0)) AS ORANGE_COUNT FROM CTE"
213,Y,Y,"WITH CTE AS (SELECT B.APPLE_COUNT A1, IFNULL(C.APPLE_COUNT,0) A2, B.ORANGE_COUNT O1, IFNULL(C.ORANGE_COUNT,0) O2 FROM BOXES B LEFT JOIN CHESTS C USING(CHEST_ID)) SELECT SUM(A1)+SUM(A2) APPLE_COUNT, SUM(O1)+SUM(O2) ORANGE_COUNT FROM CTE"
214,Y,Y,"WITH CTE AS (SELECT BOX_ID, (APPLE_COUNT + CAPPLE_COUNT) AS APPLE_COUNT, (ORANGE_COUNT+CORANGE_COUNT) AS ORANGE_COUNT FROM (SELECT B.BOX_ID,B.APPLE_COUNT,B.ORANGE_COUNT,IFNULL(C.APPLE_COUNT,0) AS CAPPLE_COUNT, IFNULL(C.ORANGE_COUNT,0) AS CORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID) X) SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM CTE"
215,Y,Y,"WITH CTE AS (SELECT SUM((CASE WHEN A.CHEST_ID IS NOT NULL THEN (A.APPLE_COUNT + B.APPLE_COUNT) ELSE A.APPLE_COUNT END)) AS APPLE_COUNT1, SUM((CASE WHEN A.CHEST_ID IS NOT NULL THEN (A.ORANGE_COUNT + B.ORANGE_COUNT) ELSE A.ORANGE_COUNT END)) AS ORANGE_COUNT1 FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID = B.CHEST_ID) SELECT APPLE_COUNT1 AS APPLE_COUNT, ORANGE_COUNT1 AS ORANGE_COUNT FROM CTE"
216,Y,N,"WITH CTE AS( SELECT BOX_ID BOX , APPLE_COUNT, ORANGE_COUNT FROM BOXES UNION ALL (SELECT B.CHEST_ID BOX , B.APPLE_COUNT APPLE_COUNT , B.ORANGE_COUNT ORANGE_COUNT FROM BOXES A JOIN CHESTS B ON A.CHEST_ID = B.CHEST_ID) ) SELECT SUM(APPLE_COUNT) APPLE_COUNT , SUM(ORANGE_COUNT) ORANGE_COUNT FROM CTE"
217,Y,Y,"WITH CTE AS( SELECT BOX_ID, (CASE WHEN B.CHEST_ID IS NULL THEN B.APPLE_COUNT ELSE B.APPLE_COUNT+C.APPLE_COUNT END) AS APPLE_COUNT, (CASE WHEN B.CHEST_ID IS NULL THEN B.ORANGE_COUNT ELSE B.ORANGE_COUNT+C.ORANGE_COUNT END) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID) SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM CTE"
218,Y,N,"WITH CTE AS( SELECT SUM(APPLE_COUNT) APPLE_COUNT,SUM(ORANGE_COUNT) ORANGE_COUNT FROM BOXES UNION SELECT SUM(C.APPLE_COUNT) APPLE_COUNT,SUM(C.ORANGE_COUNT) ORANGE_COUNT FROM CHESTS C JOIN BOXES B ON C.CHEST_ID=B.CHEST_ID WHERE B.CHEST_ID IS NOT NULL ) SELECT SUM(APPLE_COUNT) AS APPLE_COUNT,SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM CTE"
219,Y,Y,"WITH CTE1 AS ( SELECT B.BOX_ID, B.CHEST_ID, CASE WHEN B.CHEST_ID IS NOT NULL THEN B.APPLE_COUNT+C.APPLE_COUNT END AS APPLE_COUNT, CASE WHEN B.CHEST_ID IS NOT NULL THEN B.ORANGE_COUNT+C.ORANGE_COUNT END AS ORANGE_COUNT FROM BOXES B JOIN CHESTS C ON C.CHEST_ID = B.CHEST_ID UNION ALL SELECT BOX_ID, CHEST_ID, APPLE_COUNT, ORANGE_COUNT FROM BOXES WHERE CHEST_ID IS NULL ) SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM CTE1"
220,Y,Y,"WITH DEMO AS (SELECT B.BOX_ID, B.CHEST_ID, B.APPLE_COUNT, B.ORANGE_COUNT, IFNULL(C.APPLE_COUNT, 0) AS CHESTAPPLE, IFNULL(C.ORANGE_COUNT, 0) AS CHESTORANGE FROM BOXES B LEFT JOIN CHESTS C USING(CHEST_ID)) SELECT SUM(APPLE_COUNT)+SUM(CHESTAPPLE) AS APPLE_COUNT, SUM(ORANGE_COUNT)+ SUM(CHESTORANGE) AS ORANGE_COUNT FROM DEMO"
221,Y,Y,"WITH STEP1 AS ( SELECT A.APPLE_COUNT + IFNULL(B.APPLE_COUNT,0) AS APPLE, A.ORANGE_COUNT + IFNULL(B.ORANGE_COUNT,0) AS ORANGE FROM BOXES AS A LEFT JOIN CHESTS AS B ON A.CHEST_ID = B.CHEST_ID ) SELECT SUM(APPLE) AS APPLE_COUNT, SUM(ORANGE) AS ORANGE_COUNT FROM STEP1"
222,Y,Y,"WITH T AS ( SELECT B.APPLE_COUNT A1, B.ORANGE_COUNT O1, C.APPLE_COUNT A2, C.ORANGE_COUNT O2 FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID=C.CHEST_ID ) SELECT SUM(IF(A2 IS NULL, A1, A1+A2)) APPLE_COUNT, SUM(IF(O2 IS NULL, O1, O1+O2)) ORANGE_COUNT FROM T"
223,Y,Y,"WITH T AS (SELECT B.*, IFNULL(C.APPLE_COUNT,0) AS CHEST_APPLE_COUNT, IFNULL(C.ORANGE_COUNT,0) AS CHEST_ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID=C.CHEST_ID) SELECT SUM(APPLE_COUNT+CHEST_APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT+CHEST_ORANGE_COUNT) AS ORANGE_COUNT FROM T"
224,Y,Y,"WITH T AS (SELECT B.BOX_ID, B.APPLE_COUNT+IFNULL(C.APPLE_COUNT,0) AS APPLE_COUNT, B.ORANGE_COUNT+IFNULL(C.ORANGE_COUNT,0) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID=C.CHEST_ID) SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM T"
225,Y,Y,"WITH TBC AS ( SELECT B.BOX_ID, (COALESCE(B.APPLE_COUNT,0) + COALESCE(C.APPLE_COUNT,0)) AS APPLE_COUNT, (COALESCE(B.ORANGE_COUNT,0) + COALESCE(C.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES AS B LEFT JOIN CHESTS AS C ON B.CHEST_ID = C.CHEST_ID ) SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM TBC"
226,Y,Y,"WITH TEMP AS (SELECT SUM(B.APPLE_COUNT + CASE WHEN B.CHEST_ID IS NULL THEN 0 ELSE C.APPLE_COUNT END) AS APPLE_COUNTS, SUM(B.ORANGE_COUNT + CASE WHEN B.CHEST_ID IS NULL THEN 0 ELSE C.ORANGE_COUNT END) AS ORANGE_COUNTS FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID GROUP BY B.BOX_ID) SELECT SUM(APPLE_COUNTS) AS APPLE_COUNT, SUM(ORANGE_COUNTS) AS ORANGE_COUNT FROM TEMP"
227,Y,Y,"WITH TEMP AS(SELECT SUM(B.APPLE_COUNT + CASE WHEN C.CHEST_ID IS NULL THEN 0 ELSE C.APPLE_COUNT END) AS APPLES, SUM(B.ORANGE_COUNT + CASE WHEN C.CHEST_ID IS NULL THEN 0 ELSE C.ORANGE_COUNT END) AS ORANGES FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID GROUP BY B.BOX_ID) SELECT SUM(APPLES) AS APPLE_COUNT, SUM(ORANGES) AS ORANGE_COUNT FROM TEMP"
228,Y,N,"WITH TMP AS ( SELECT A AS DUMMY, APPLE_COUNT, ORANGE_COUNT FROM BOXES UNION ALL SELECT A AS DUMMY, C.APPLE_COUNT AS APPLE_COUNT, C.ORANGE_COUNT AS ORANGE_COUNT FROM BOXES B JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID ) SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM TMP GROUP BY DUMMY"
229,Y,N,"WITH TMP AS ( SELECT BOX_ID, APPLE_COUNT, ORANGE_COUNT FROM BOXES UNION ALL SELECT B.BOX_ID AS BOX_ID, C.APPLE_COUNT AS APPLE_COUNT, C.ORANGE_COUNT AS ORANGE_COUNT FROM BOXES B JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID ), TMP2 AS ( SELECT BOX_ID, SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM TMP GROUP BY BOX_ID WITH ROLLUP ) SELECT APPLE_COUNT, ORANGE_COUNT FROM TMP2 WHERE BOX_ID IS NULL"
230,Y,Y,"WITH TMP AS (SELECT BOX_ID, B.CHEST_ID, (B.APPLE_COUNT+COALESCE(C.APPLE_COUNT,0)) AS APPLE_COUNT, (B.ORANGE_COUNT+COALESCE(C.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID) SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM TMP"
231,Y,Y,"WITH TMP AS (SELECT T1.BOX_ID, T2.CHEST_ID, T1.APPLE_COUNT + COALESCE(T2.APPLE_COUNT,0) AS APPLE_COUNT, T1.ORANGE_COUNT + COALESCE(T2.ORANGE_COUNT,0) AS ORANGE_COUNT FROM BOXES T1 LEFT JOIN CHESTS T2 ON T1.CHEST_ID = T2.CHEST_ID ) SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM TMP"
232,Y,Y,"WITH TOTAL AS ( SELECT B.APPLE_COUNT + (CASE WHEN C.APPLE_COUNT IS NULL THEN 0 ELSE C.APPLE_COUNT END) AS C_A, B.ORANGE_COUNT + (CASE WHEN C.ORANGE_COUNT IS NULL THEN 0 ELSE C.ORANGE_COUNT END) AS C_O FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID) SELECT SUM(C_A) AS APPLE_COUNT, SUM(C_O) AS ORANGE_COUNT FROM TOTAL"
233,Y,Y,"WITH X AS(SELECT B.*,C.CHEST_ID CCID , COALESCE(C.APPLE_COUNT,0) CA, COALESCE(C.ORANGE_COUNT,0) CO FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID ) , Y AS(SELECT (APPLE_COUNT+ CA )APPLE_COUNT, (ORANGE_COUNT + CO )ORANGE_COUNT FROM X) SELECT SUM(APPLE_COUNT)APPLE_COUNT ,SUM(ORANGE_COUNT)ORANGE_COUNT FROM Y"
234,Y,Y,"SELECT SUM(APPLE_COUNTS) APPLE_COUNT, SUM(ORANGE_COUNTS) ORANGE_COUNT FROM (SELECT B.BOX_ID, SUM(B.APPLE_COUNT + IFNULL(C.APPLE_COUNT,0)) APPLE_COUNTS, SUM(B.ORANGE_COUNT + IFNULL(C.ORANGE_COUNT,0)) ORANGE_COUNTS FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID GROUP BY B.BOX_ID) D"
235,Y,Y,"SELECT SUM(IFNULL(B.APPLE_COUNT, 0)) + SUM(IFNULL(C.APPLE_COUNT, 0)) AS APPLE_COUNT, SUM(IFNULL(B.ORANGE_COUNT, 0)) + SUM(IFNULL(C.ORANGE_COUNT, 0)) AS ORANGE_COUNT FROM BOXES AS B LEFT JOIN CHESTS AS C ON B.CHEST_ID = C.CHEST_ID"
236,Y,Y,"SELECT SUM(BAPPLE + CAPPLE) AS APPLE_COUNT, SUM(BORANGE + CORANGE) AS ORANGE_COUNT FROM (SELECT B.APPLE_COUNT BAPPLE, B.ORANGE_COUNT BORANGE, IFNULL(C.APPLE_COUNT,0) CAPPLE, IFNULL(C.ORANGE_COUNT,0) CORANGE FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID)T"
237,Y,Y,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM (SELECT B.BOX_ID, IF(ISNULL(B.CHEST_ID), B.APPLE_COUNT, B.APPLE_COUNT+C.APPLE_COUNT) AS APPLE_COUNT, IF(ISNULL(B.CHEST_ID), B.ORANGE_COUNT, B.ORANGE_COUNT+C.ORANGE_COUNT) AS ORANGE_COUNT FROM BOXES AS B LEFT JOIN CHESTS AS C ON B.CHEST_ID = C.CHEST_ID) SUB"
238,Y,Y,"SELECT SUM(B_APPLE + C_APPLE) APPLE_COUNT, SUM(B_ORANGE + C_ORANGE) ORANGE_COUNT FROM (SELECT B.BOX_ID, B.APPLE_COUNT B_APPLE, B.ORANGE_COUNT B_ORANGE, IFNULL(C.APPLE_COUNT, 0) C_APPLE, IFNULL(C.ORANGE_COUNT,0) C_ORANGE FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID) L"
239,Y,N,"WITH T1 AS ( SELECT SUM(APPLE_COUNT) AS APPLES ,SUM(ORANGE_COUNT) AS ORANGES FROM BOXES UNION ALL SELECT SUM(C1.APPLE_COUNT),SUM(C1.ORANGE_COUNT) FROM BOXES B1 INNER JOIN CHESTS C1 ON B1.CHEST_ID = C1.CHEST_ID) SELECT SUM(APPLES) AS APPLE_COUNT , SUM(ORANGES) AS ORANGE_COUNT FROM T1"
240,Y,Y,"SELECT IFNULL(SUM(B.APPLE_COUNT),0) + IFNULL(SUM(C.APPLE_COUNT),0) APPLE_COUNT, IFNULL(SUM(B.ORANGE_COUNT),0) + IFNULL(SUM(C.ORANGE_COUNT),0) ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C USING (CHEST_ID)"
241,Y,Y,"SELECT SUM(BOXES.APPLE_COUNT) + IFNULL(SUM(CHESTS.APPLE_COUNT), 0) AS APPLE_COUNT, SUM(BOXES.ORANGE_COUNT) + IFNULL(SUM(CHESTS.ORANGE_COUNT), 0) AS ORANGE_COUNT FROM BOXES LEFT JOIN CHESTS ON BOXES.CHEST_ID = CHESTS.CHEST_ID"
242,Y,Y,"SELECT SUM(IFNULL((B.APPLE_COUNT + C.APPLE_COUNT), B.APPLE_COUNT)) AS APPLE_COUNT, SUM(IFNULL((B.ORANGE_COUNT + C.ORANGE_COUNT), B.ORANGE_COUNT)) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
243,Y,Y,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM ( SELECT (B.APPLE_COUNT + COALESCE(C.APPLE_COUNT, 0)) AS APPLE_COUNT, (B.ORANGE_COUNT + COALESCE(C.ORANGE_COUNT, 0)) AS ORANGE_COUNT FROM BOXES B LEFT OUTER JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID ) A"
244,Y,Y,"WITH FRUIT_COUNTS AS (SELECT (CASE WHEN C.CHEST_ID IS NULL THEN B.APPLE_COUNT ELSE B.APPLE_COUNT + C.APPLE_COUNT END) AS APPLE_COUNT, (CASE WHEN C.CHEST_ID IS NULL THEN B.ORANGE_COUNT ELSE B.ORANGE_COUNT + C.ORANGE_COUNT END) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID) SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM FRUIT_COUNTS"
245,Y,Y,"SELECT SUM(APPLE_COUNT) + SUM(APPLE_COUNT_CHEST) AS APPLE_COUNT, SUM(ORANGE_COUNT) + SUM(ORANGE_COUNT_CHEST) AS ORANGE_COUNT FROM (SELECT B.APPLE_COUNT AS APPLE_COUNT, COALESCE((C.APPLE_COUNT), 0) AS APPLE_COUNT_CHEST, B.ORANGE_COUNT AS ORANGE_COUNT, COALESCE((C.ORANGE_COUNT), 0) AS ORANGE_COUNT_CHEST FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID) ST1"
246,Y,Y,"SELECT SUM(IFNULL(APPLE_COUNT, 0)) + SUM(IFNULL(APPLE, 0)) AS APPLE_COUNT, SUM(IFNULL(ORANGE_COUNT, 0)) + SUM(IFNULL(ORANGE, 0)) AS ORANGE_COUNT FROM ( SELECT A.*, B.APPLE_COUNT AS APPLE, B.ORANGE_COUNT AS ORANGE FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID=B.CHEST_ID )C"
247,Y,Y,"WITH A AS ( SELECT B.APPLE_COUNT+COALESCE(C.APPLE_COUNT,0) AS APPLE_COUNT, B.ORANGE_COUNT+COALESCE(C.ORANGE_COUNT,0) AS ORANGE_COUNT FROM BOXES B LEFT OUTER JOIN CHESTS C ON B.CHEST_ID=C.CHEST_ID ) SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM A"
248,Y,N,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT , SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM (SELECT B.BOX_ID, IFNULL(C.APPLE_COUNT, 0) AS APPLE_COUNT , IFNULL(C.ORANGE_COUNT, 0) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID UNION ALL SELECT BOX_ID, APPLE_COUNT, ORANGE_COUNT FROM BOXES) T"
249,Y,Y,"SELECT SUM(C.APPLE_COUNT) AS APPLE_COUNT, SUM(C.ORANGE_COUNT) AS ORANGE_COUNT FROM ( SELECT A.APPLE_COUNT+IFNULL(B.APPLE_COUNT,0) AS APPLE_COUNT, A.ORANGE_COUNT+IFNULL(B.ORANGE_COUNT,0) AS ORANGE_COUNT FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID=B.CHEST_ID) AS C"
250,Y,Y,"SELECT SUM(B.APPLE_COUNT+IFNULL(C.APPLE_COUNT,0)) APPLE_COUNT, SUM(B.ORANGE_COUNT+IFNULL(C.ORANGE_COUNT,0)) ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON (B.CHEST_ID=C.CHEST_ID)"
251,Y,Y,"WITH TOTAL_CONTENTS AS ( SELECT BOX_ID, B.APPLE_COUNT AS APPLE_COUNT, B.ORANGE_COUNT AS ORANGE_COUNT, COALESCE(C.APPLE_COUNT, 0) AS ADDITIONAL_APPLES, COALESCE(C.ORANGE_COUNT, 0) AS ADDITIONAL_ORANGES FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID ) SELECT SUM(APPLE_COUNT) + SUM(ADDITIONAL_APPLES) AS APPLE_COUNT, SUM(ORANGE_COUNT) + SUM(ADDITIONAL_ORANGES) AS ORANGE_COUNT FROM TOTAL_CONTENTS"
252,Y,Y,"SELECT (SUM(B.APPLE_COUNT)+SUM(IFNULL(C.APPLE_COUNT,0))) AS APPLE_COUNT, (SUM(B.ORANGE_COUNT)+SUM(IFNULL(C.ORANGE_COUNT,0))) AS ORANGE_COUNT FROM BOXES AS B LEFT JOIN CHESTS AS C ON B.CHEST_ID = C.CHEST_ID"
253,Y,Y,"SELECT SUM(A.APPLE_COUNT)+ IFNULL(SUM(B.APPLE_COUNT),0) AS APPLE_COUNT, SUM(A.ORANGE_COUNT)+ IFNULL(SUM(B.ORANGE_COUNT),0) AS ORANGE_COUNT FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID=B.CHEST_ID"
254,Y,Y,"SELECT SUM(APPLE_COUNT) APPLE_COUNT, SUM(ORANGE_COUNT) ORANGE_COUNT FROM (SELECT IFNULL(B.APPLE_COUNT,0)+IFNULL(C.APPLE_COUNT,0) AS APPLE_COUNT, IFNULL(B.ORANGE_COUNT,0)+IFNULL(C.ORANGE_COUNT,0) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID) AS A"
255,Y,Y,"SELECT SUM(APPLE_COUNT) APPLE_COUNT, SUM(ORANGE_COUNT) ORANGE_COUNT FROM( SELECT BOXES.APPLE_COUNT + IFNULL(CHESTS.APPLE_COUNT,0) APPLE_COUNT, BOXES.ORANGE_COUNT + IFNULL(CHESTS.ORANGE_COUNT,0) ORANGE_COUNT FROM BOXES LEFT JOIN CHESTS ON BOXES.CHEST_ID = CHESTS.CHEST_ID) CTE"
256,Y,Y,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM (SELECT B.APPLE_COUNT + IFNULL(C.APPLE_COUNT, 0) AS APPLE_COUNT, B.ORANGE_COUNT + IFNULL(C.ORANGE_COUNT, 0) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID) AS T"
257,Y,N,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT,SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM (SELECT BOX_ID, (A.APPLE_COUNT+COALESCE(B.APPLE_COUNT,0)) AS APPLE_COUNT, (A.ORANGE_COUNT+COALESCE(B.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES AS A LEFT JOIN CHESTS AS B ON A.CHEST_ID = B.CHEST_ID GROUP BY BOX_ID) AS A"
258,Y,Y,"SELECT SUM(B.APPLE_COUNT) + COALESCE(SUM(C.APPLE_COUNT), 0) AS APPLE_COUNT, SUM(B.ORANGE_COUNT) + COALESCE(SUM(C.ORANGE_COUNT), 0) AS ORANGE_COUNT FROM BOXES AS B LEFT JOIN CHESTS AS C ON B.CHEST_ID = C.CHEST_ID"
259,Y,Y,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM ( SELECT B.APPLE_COUNT + IFNULL(C.APPLE_COUNT, 0) AS APPLE_COUNT, B.ORANGE_COUNT + IFNULL(C.ORANGE_COUNT, 0) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID ) TEMP"
260,Y,Y,"SELECT SUM(APPLE_TL)AS APPLE_COUNT,SUM(ORANGE_TL) AS ORANGE_COUNT FROM ( SELECT BOX_ID, IFNULL((B.APPLE_COUNT+C.APPLE_COUNT),B.APPLE_COUNT)AS APPLE_TL ,IFNULL((B.ORANGE_COUNT+C.ORANGE_COUNT),B.ORANGE_COUNT) AS ORANGE_TL FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID=C.CHEST_ID ) TT"
261,Y,Y,"WITH BOX_CHEST AS ( SELECT BOX_ID,A.CHEST_ID, A.APPLE_COUNT,A.ORANGE_COUNT, IFNULL(B.APPLE_COUNT,0) AS CHEST_APPLE_COUNT, IFNULL(B.ORANGE_COUNT,0) AS CHEST_ORANGE_COUNT FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID = B.CHEST_ID ) SELECT SUM(APPLE_COUNT+CHEST_APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT+CHEST_ORANGE_COUNT) AS ORANGE_COUNT FROM BOX_CHEST"
262,Y,Y,"SELECT SUM(IFNULL(B.APPLE_COUNT, 0)) + SUM(IFNULL(C.APPLE_COUNT, 0)) AS APPLE_COUNT, IFNULL(SUM(B.ORANGE_COUNT),0) + IFNULL(SUM(C.ORANGE_COUNT), 0) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
263,Y,Y,"SELECT SUM(IFNULL(B.APPLE_COUNT, 0) + IFNULL(C.APPLE_COUNT, 0)) AS APPLE_COUNT, SUM(IFNULL(B.ORANGE_COUNT, 0) + IFNULL(C.ORANGE_COUNT, 0)) AS ORANGE_COUNT FROM BOXES AS B LEFT JOIN CHESTS AS C USING (CHEST_ID)"
264,Y,Y,"SELECT SUM(B.APPLE_COUNT)+IFNULL(SUM(C.APPLE_COUNT),0) APPLE_COUNT, SUM(B.ORANGE_COUNT)+IFNULL(SUM(C.ORANGE_COUNT),0) ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C USING(CHEST_ID)"
265,Y,Y,"SELECT SUM(IFNULL(CH.APPLE_COUNT, 0) + BX.APPLE_COUNT) AS APPLE_COUNT, SUM(IFNULL(CH.ORANGE_COUNT, 0) + BX.ORANGE_COUNT) AS ORANGE_COUNT FROM BOXES BX LEFT JOIN CHESTS CH ON BX.CHEST_ID = CH.CHEST_ID"
266,Y,Y,"WITH T1 AS( SELECT B.APPLE_COUNT BOX_APPLE_COUNT, B.ORANGE_COUNT BOX_ORANGE_COUNT, IF(C.APPLE_COUNT IS NOT NULL, C.APPLE_COUNT, 0) CHEST_APPLE_COUNT, IF(C.ORANGE_COUNT IS NOT NULL, C.ORANGE_COUNT, 0) CHEST_ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID=C.CHEST_ID ) SELECT SUM(BOX_APPLE_COUNT)+SUM(CHEST_APPLE_COUNT) APPLE_COUNT, SUM(BOX_ORANGE_COUNT)+SUM(CHEST_ORANGE_COUNT) ORANGE_COUNT FROM T1"
267,Y,Y,"SELECT SUM(B.APPLE_COUNT) + COALESCE(SUM(C.APPLE_COUNT),0) AS APPLE_COUNT, SUM(B.ORANGE_COUNT) + COALESCE(SUM(C.ORANGE_COUNT),0) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C USING(CHEST_ID)"
268,Y,Y,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM (SELECT A.BOX_ID,A.CHEST_ID, A.APPLE_COUNT + IFNULL(B.APPLE_COUNT,0) AS APPLE_COUNT, A.ORANGE_COUNT + IFNULL(B.ORANGE_COUNT,0) AS ORANGE_COUNT FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID = B.CHEST_ID)T"
269,Y,Y,"SELECT SUM(BOXES.APPLE_COUNT + IFNULL(CHESTS.APPLE_COUNT, 0)) AS APPLE_COUNT, SUM(BOXES.ORANGE_COUNT + IFNULL(CHESTS.ORANGE_COUNT, 0)) AS ORANGE_COUNT FROM BOXES LEFT JOIN CHESTS USING (CHEST_ID)"
270,Y,Y,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM (SELECT BOX_ID, (B.APPLE_COUNT + IFNULL(C.APPLE_COUNT,0)) AS APPLE_COUNT, (B.ORANGE_COUNT + IFNULL(C.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID) X"
271,Y,Y,"SELECT SUM(A.APPLE_COUNT + IFNULL(B.APPLE_COUNT,0)) APPLE_COUNT, SUM(A.ORANGE_COUNT + IFNULL(B.ORANGE_COUNT,0)) ORANGE_COUNT FROM BOXES A LEFT JOIN CHESTS B ON B.CHEST_ID=A.CHEST_ID"
272,Y,Y,"WITH CTE AS( SELECT A.APPLE_COUNT AS AA, A.ORANGE_COUNT AS AO, IFNULL(B.APPLE_COUNT,0) AS BA, IFNULL(B.ORANGE_COUNT,0) AS BO FROM BOXES A LEFT JOIN CHESTS B USING (CHEST_ID) ) SELECT SUM(AA+BA) AS APPLE_COUNT, SUM(AO+BO) AS ORANGE_COUNT FROM CTE"
273,Y,N,"WITH CHESTCOUNT AS (SELECT BOX_ID,B.CHEST_ID,C.APPLE_COUNT,C.ORANGE_COUNT FROM CHESTS C JOIN BOXES B ON C.CHEST_ID = B.CHEST_ID), COMBINED AS(SELECT * FROM BOXES UNION ALL SELECT * FROM CHESTCOUNT) SELECT SUM(APPLE_COUNT) AS APPLE_COUNT,SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM( SELECT SUM(APPLE_COUNT) AS APPLE_COUNT,SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM COMBINED GROUP BY BOX_ID,CHEST_ID)TEMP"
274,Y,Y,"SELECT SUM(APPLE_COUNT+IFNULL(CAPPLE,0)) AS APPLE_COUNT, SUM(ORANGE_COUNT+ IFNULL(CORANGE,0)) AS ORANGE_COUNT FROM( SELECT B.*, C.CHEST_ID AS CCHEST, C.APPLE_COUNT AS CAPPLE, C.ORANGE_COUNT AS CORANGE FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID=C.CHEST_ID) A"
275,Y,Y,"SELECT SUM(APPLE_COUNT) + SUM(APPLE_COUNT_2) AS APPLE_COUNT, SUM(ORANGE_COUNT) + SUM(ORANGE_COUNT_2) AS ORANGE_COUNT FROM ( SELECT B.BOX_ID, B.CHEST_ID, COALESCE(B.APPLE_COUNT,0) AS APPLE_COUNT, COALESCE(B.ORANGE_COUNT,0) AS ORANGE_COUNT, COALESCE(C.APPLE_COUNT,0) AS APPLE_COUNT_2, COALESCE(C.ORANGE_COUNT,0) AS ORANGE_COUNT_2 FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID ) TB"
276,Y,N,"SELECT SUM(B.APPLE_COUNT) + (SELECT CASE WHEN B1.CHEST_ID IS NULL THEN 0 ELSE SUM(C.APPLE_COUNT) END FROM CHESTS C JOIN BOXES B1 ON B1.CHEST_ID = C.CHEST_ID) AS APPLE_COUNT, SUM(B.ORANGE_COUNT) + (SELECT CASE WHEN B2.CHEST_ID IS NULL THEN 0 ELSE SUM(C1.ORANGE_COUNT) END FROM CHESTS C1 JOIN BOXES B2 ON B2.CHEST_ID = C1.CHEST_ID) AS ORANGE_COUNT FROM BOXES B"
277,Y,N,"WITH CHEST_BOXES AS ( SELECT SUM(APPLE_COUNT) AS APPLE_COUNT , SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM ( SELECT B.BOX_ID , C.CHEST_ID , C.APPLE_COUNT , C.ORANGE_COUNT FROM BOXES B JOIN CHESTS C ON C.CHEST_ID = B.CHEST_ID ) AS CHEST_SUMS UNION ALL SELECT SUM(APPLE_COUNT) AS APPLE_COUNT , SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM BOXES ) SELECT SUM(APPLE_COUNT) AS APPLE_COUNT , SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM CHEST_BOXES"
278,Y,Y,"SELECT SUM( IF(B.CHEST_ID IS NOT NULL, B.APPLE_COUNT + C.APPLE_COUNT, B.APPLE_COUNT) ) AS APPLE_COUNT, SUM( IF(B.CHEST_ID IS NOT NULL, B.ORANGE_COUNT + C.ORANGE_COUNT, B.ORANGE_COUNT) ) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
279,Y,Y,"SELECT (SUM(IFNULL(BOXES.APPLE_COUNT,0))+ SUM(IFNULL(CHESTS.APPLE_COUNT,0))) AS APPLE_COUNT, (SUM(IFNULL(BOXES.ORANGE_COUNT,0)) + SUM(IFNULL(CHESTS.ORANGE_COUNT,0))) AS ORANGE_COUNT FROM BOXES LEFT JOIN CHESTS ON BOXES.CHEST_ID = CHESTS.CHEST_ID"
280,Y,Y,"SELECT SUM(COALESCE(BOXES.APPLE_COUNT,0)) + SUM(COALESCE(CHESTS.APPLE_COUNT,0)) AS APPLE_COUNT, SUM(COALESCE(BOXES.ORANGE_COUNT,0)) + SUM(COALESCE(CHESTS.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES LEFT JOIN CHESTS ON CHESTS.CHEST_ID = BOXES.CHEST_ID"
281,Y,N,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM( SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM BOXES UNION SELECT SUM(A.APPLE_COUNT) AS APPLE_COUNT, SUM(A.ORANGE_COUNT) AS ORANGE_COUNT FROM CHESTS A INNER JOIN BOXES B ON A.CHEST_ID=B.CHEST_ID) A"
282,Y,Y,"WITH CTE AS (SELECT B.APPLE_COUNT AS BOX_APPLE, B.ORANGE_COUNT AS BOX_ORANGE, IFNULL(C.APPLE_COUNT,0) AS CHEST_APPLE, IFNULL(C.ORANGE_COUNT,0) AS CHEST_ORANGE FROM BOXES B LEFT JOIN CHESTS C USING (CHEST_ID)) SELECT SUM(BOX_APPLE + CHEST_APPLE) AS APPLE_COUNT, SUM(BOX_ORANGE+CHEST_ORANGE) AS ORANGE_COUNT FROM CTE"
283,Y,Y,"SELECT IF((AC1+AC2) IS NULL,AC2,(AC1+AC2))AS APPLE_COUNT , IF((OC1+OC2) IS NULL,OC2,(OC1+OC2)) AS ORANGE_COUNT FROM (SELECT SUM(C.APPLE_COUNT) AS AC1, SUM(C.ORANGE_COUNT) AS OC1, SUM(B.APPLE_COUNT) AS AC2, SUM(B.ORANGE_COUNT) AS OC2 FROM BOXES B LEFT JOIN CHESTS C ON C.CHEST_ID=B.CHEST_ID) T"
284,Y,Y,"SELECT SUM(APPLE) AS APPLE_COUNT, SUM(ORANGE) AS ORANGE_COUNT FROM (SELECT IFNULL(C.APPLE_COUNT,0)+B.APPLE_COUNT AS APPLE, IFNULL(C.ORANGE_COUNT,0)+B.ORANGE_COUNT AS ORANGE FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID=C.CHEST_ID) A"
285,Y,Y,"SELECT SUM(APPLE_COUNT + CHEST_APPLES) AS APPLE_COUNT, SUM(ORANGE_COUNT + CHEST_ORANGES) AS ORANGE_COUNT FROM ( SELECT A.BOX_ID, A.CHEST_ID, A.APPLE_COUNT, A.ORANGE_COUNT, IFNULL(B.APPLE_COUNT,0) AS CHEST_APPLES, IFNULL(B.ORANGE_COUNT,0) AS CHEST_ORANGES FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID = B.CHEST_ID ) A"
286,Y,Y,"WITH CHEST_ADD AS ( SELECT A.CHEST_ID, A.APPLE_COUNT, A.ORANGE_COUNT, IFNULL(B.APPLE_COUNT,0) AS APPLE_CHEST , IFNULL(B.ORANGE_COUNT,0) AS ORANGE_CHEST FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID = B.CHEST_ID) SELECT SUM(APPLE_COUNT+APPLE_CHEST) AS APPLE_COUNT , SUM(ORANGE_COUNT+ORANGE_CHEST) AS ORANGE_COUNT FROM CHEST_ADD"
287,Y,Y,"SELECT SUM(IFNULL(B.APPLE_COUNT + C.APPLE_COUNT,B.APPLE_COUNT)) AS APPLE_COUNT, SUM(IFNULL(B.ORANGE_COUNT + C.ORANGE_COUNT,B.ORANGE_COUNT)) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
288,Y,N,"WITH CTE AS (SELECT BOX_ID, APPLE_COUNT AS A, ORANGE_COUNT AS O FROM BOXES GROUP BY BOX_ID UNION ALL SELECT B.BOX_ID, C.APPLE_COUNT AS A , C.ORANGE_COUNT AS O FROM CHESTS AS C RIGHT JOIN BOXES AS B ON C.CHEST_ID= B.CHEST_ID ) SELECT SUM(A) AS APPLE_COUNT, SUM(O) AS ORANGE_COUNT FROM CTE"
289,Y,Y,"SELECT SUM(APPLE_COUNT) APPLE_COUNT, SUM(ORANGE_COUNT) ORANGE_COUNT FROM (SELECT SUM(APPLE_COUNT) APPLE_COUNT, SUM(ORANGE_COUNT) ORANGE_COUNT FROM BOXES WHERE CHEST_ID IS NULL UNION SELECT SUM(A.APPLE_COUNT)+SUM(B.APPLE_COUNT) AS APPLE_COUNT, SUM(A.ORANGE_COUNT)+SUM(B.ORANGE_COUNT) AS ORANGE_COUNT FROM BOXES A INNER JOIN CHESTS B ON A.CHEST_ID=B.CHEST_ID )X"
290,Y,Y,"SELECT SUM(B.APPLE_COUNT) + COALESCE(SUM(CASE WHEN C.CHEST_ID IS NOT NULL THEN C.APPLE_COUNT END), 0) AS APPLE_COUNT, SUM(B.ORANGE_COUNT) + COALESCE(SUM(CASE WHEN C.CHEST_ID IS NOT NULL THEN C.ORANGE_COUNT END), 0) AS ORANGE_COUNT FROM BOXES AS B LEFT JOIN CHESTS AS C ON B.CHEST_ID = C.CHEST_ID"
291,Y,Y,"SELECT SUM(N.APPLE_COUNT + COALESCE(C.APPLE_COUNT,0)) AS APPLE_COUNT, SUM(N.ORANGE_COUNT + COALESCE(C.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES N LEFT JOIN CHESTS C ON N.CHEST_ID = C.CHEST_ID"
292,Y,Y,"SELECT SUM(A.APPLE_COUNT) + IFNULL(SUM(B.APPLE_COUNT), 0) AS APPLE_COUNT, SUM(A.ORANGE_COUNT) + IFNULL(SUM(B.ORANGE_COUNT), 0) AS ORANGE_COUNT FROM BOXES AS A LEFT JOIN CHESTS B ON A.CHEST_ID = B.CHEST_ID"
293,Y,Y,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM ( SELECT (CASE WHEN B.CHEST_ID IS NULL THEN B.APPLE_COUNT ELSE B.APPLE_COUNT + C.APPLE_COUNT END) AS APPLE_COUNT, (CASE WHEN B.CHEST_ID IS NULL THEN B.ORANGE_COUNT ELSE B.ORANGE_COUNT + C.ORANGE_COUNT END) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C USING (CHEST_ID) ) T"
294,Y,N,"WITH A AS (SELECT BOX_ID, B.CHEST_ID, C.APPLE_COUNT, C.ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID UNION ALL SELECT * FROM BOXES ) SELECT SUM(COALESCE(APPLE_COUNT,0)) AS APPLE_COUNT, SUM(COALESCE(ORANGE_COUNT,0)) AS ORANGE_COUNT FROM A"
295,Y,Y,"SELECT SUM(B.APPLE_COUNT+IFNULL(C.APPLE_COUNT,0)) AS APPLE_COUNT, SUM(B.ORANGE_COUNT+IFNULL(C.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES B LEFT OUTER JOIN CHESTS C USING (CHEST_ID)"
296,Y,Y,"SELECT SUM(TOTAL_APPLE_COUNT) AS APPLE_COUNT, SUM(TOTAL_ORANGE_COUNT) AS ORANGE_COUNT FROM ( SELECT B.BOX_ID,B.APPLE_COUNT+IFNULL(C.APPLE_COUNT,0) AS TOTAL_APPLE_COUNT, B.ORANGE_COUNT+IFNULL(C.ORANGE_COUNT,0) AS TOTAL_ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID=C.CHEST_ID) T1"
297,Y,Y,"SELECT SUM(TOTAL_APPLE) APPLE_COUNT, SUM(TOTAL_ORANGE) ORANGE_COUNT FROM( SELECT BOX_ID, (A.APPLE_COUNT+IFNULL(B.APPLE_COUNT,0)) TOTAL_APPLE, (A.ORANGE_COUNT+IFNULL(B.ORANGE_COUNT,0)) TOTAL_ORANGE FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID = B.CHEST_ID) TEMP"
298,Y,Y,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM ( SELECT B.BOX_ID, B.CHEST_ID, B.APPLE_COUNT + IFNULL(C.APPLE_COUNT, 0) AS APPLE_COUNT, B.ORANGE_COUNT + IFNULL(C.ORANGE_COUNT, 0) AS ORANGE_COUNT FROM BOXES B LEFT OUTER JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID ) INTERMEDIATE"
299,Y,Y,"SELECT SUM(APPLECOUNT) AS APPLE_COUNT, SUM(ORANGECOUNT) AS ORANGE_COUNT FROM( SELECT BOX_ID, IFNULL(B.APPLE_COUNT,0) + IFNULL(C.APPLE_COUNT,0) AS APPLECOUNT, IFNULL(B.ORANGE_COUNT,0)+ IFNULL(C.ORANGE_COUNT,0) AS ORANGECOUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID ) TEMP"
300,Y,Y,"SELECT SUM(CASE WHEN B.CHEST_ID IS NOT NULL THEN B.APPLE_COUNT + C.APPLE_COUNT ELSE B.APPLE_COUNT END) AS APPLE_COUNT, SUM(CASE WHEN B.CHEST_ID IS NOT NULL THEN B.ORANGE_COUNT + C.ORANGE_COUNT ELSE B.ORANGE_COUNT END) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
301,Y,Y,"SELECT SUM(APPLE_TOTAL_CNT) AS APPLE_COUNT, SUM(ORANGE_TOTAL_CNT) AS ORANGE_COUNT FROM ( SELECT B.BOX_ID, B.APPLE_COUNT+COALESCE(C.APPLE_COUNT, 0) AS APPLE_TOTAL_CNT, B.ORANGE_COUNT+COALESCE(C.ORANGE_COUNT,0) AS ORANGE_TOTAL_CNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID=C.CHEST_ID ) A"
302,Y,N,"SELECT SUM(APPLE_COUNT) + SUM(CHEST_APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) + SUM(CHEST_ORGANCE_COUNT) AS ORANGE_COUNT FROM (SELECT BOX_ID, BOXES.APPLE_COUNT, BOXES.ORANGE_COUNT , CASE WHEN CHESTS.CHEST_ID IS NOT NULL THEN CHESTS.APPLE_COUNT ELSE 0 END CHEST_APPLE_COUNT, CASE WHEN CHESTS.CHEST_ID IS NOT NULL THEN CHESTS.ORANGE_COUNT ELSE 0 END CHEST_ORGANCE_COUNT FROM BOXES LEFT JOIN CHESTS ON BOXES.CHEST_ID = CHESTS.CHEST_ID GROUP BY 1) T"
303,Y,Y,"SELECT SUM(_BAPPLE + _CAPPLE) APPLE_COUNT, SUM(_BORANGE + _CORANGE) ORANGE_COUNT FROM ( SELECT BOX_ID, B.APPLE_COUNT _BAPPLE, B.ORANGE_COUNT _BORANGE, COALESCE(C.APPLE_COUNT,0) _CAPPLE, COALESCE(C.ORANGE_COUNT,0) _CORANGE FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID ) T1"
304,Y,Y,"SELECT SUM((B.APPLE_COUNT + COALESCE(C.APPLE_COUNT,0))) AS APPLE_COUNT , SUM((B.ORANGE_COUNT + COALESCE(C.ORANGE_COUNT,0))) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
305,Y,Y,"WITH CTE AS (SELECT B.CHEST_ID, B.APPLE_COUNT, B.ORANGE_COUNT, IFNULL(C.APPLE_COUNT,0) AS APPLE_COUNTC, IFNULL(C.ORANGE_COUNT,0) AS ORANGE_COUNTC FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID=C.CHEST_ID) SELECT SUM(APPLE_COUNT)+SUM(APPLE_COUNTC) AS APPLE_COUNT, SUM(ORANGE_COUNT) + SUM(ORANGE_COUNTC) AS ORANGE_COUNT FROM CTE"
306,Y,Y,"WITH CTE AS (SELECT BOX_ID, COALESCE(C.APPLE_COUNT,0)+COALESCE(B.APPLE_COUNT,0) AS APPLE_COUNT, COALESCE(B.ORANGE_COUNT,0)+COALESCE(C.ORANGE_COUNT,0) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID) SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM CTE"
307,Y,Y,"WITH T1 AS( SELECT B.*, IFNULL(C.APPLE_COUNT, 0) APPLE, IFNULL(C.ORANGE_COUNT, 0) ORANGE FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID=C.CHEST_ID ) SELECT SUM(APPLE_COUNT+APPLE) APPLE_COUNT, SUM(ORANGE_COUNT+ORANGE) ORANGE_COUNT FROM T1"
308,Y,Y,"SELECT SUM(COALESCE(C.APPLE_COUNT,0)) + SUM(COALESCE(B.APPLE_COUNT,0)) AS APPLE_COUNT , SUM(COALESCE(C.ORANGE_COUNT,0)) + SUM(COALESCE(B.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C USING (CHEST_ID)"
309,Y,N,"WITH NUM AS ( SELECT CHEST_ID, COUNT(CHEST_ID) AS C FROM BOXES GROUP BY CHEST_ID HAVING CHEST_ID IS NOT NULL ), T AS ( SELECT SUM(COALESCE(N.C,0)*CO.APPLE_COUNT) AS APPLE, SUM(COALESCE(N.C,0)*CO.ORANGE_COUNT) AS ORANGE FROM CHESTS CO JOIN NUM N ON N.CHEST_ID = CO.CHEST_ID ) SELECT SUM(BOXES.APPLE_COUNT)+COALESCE(T.APPLE,0) AS APPLE_COUNT, SUM(BOXES.ORANGE_COUNT)+COALESCE(T.ORANGE,0) AS ORANGE_COUNT FROM BOXES,T"
310,Y,Y,"SELECT APP1 + APP2 AS APPLE_COUNT, ORG1 + ORG2 AS ORANGE_COUNT FROM ( SELECT COALESCE(SUM(APPLE_COUNT),0) AS APP1, COALESCE(SUM(APP),0) AS APP2, COALESCE(SUM(ORANGE_COUNT),0) AS ORG1, COALESCE(SUM(ORG),0) AS ORG2 FROM ( SELECT A.*, B.APPLE_COUNT AS APP, B.ORANGE_COUNT AS ORG FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID = B.CHEST_ID ) A ) A"
311,Y,Y,"SELECT IFNULL(SUM(A1.APPLE_COUNT),0)+IFNULL(SUM(A2.APPLE_COUNT),0) AS APPLE_COUNT , IFNULL(SUM(A1.ORANGE_COUNT),0)+IFNULL(SUM(A2.ORANGE_COUNT),0) AS ORANGE_COUNT FROM BOXES AS A1 LEFT JOIN CHESTS AS A2 ON A1.CHEST_ID=A2.CHEST_ID"
312,Y,N,"SELECT SUM(A.APPLE_COUNT) AS APPLE_COUNT , SUM(A.ORANGE_COUNT) ORANGE_COUNT FROM ( SELECT APPLE_COUNT, ORANGE_COUNT FROM BOXES UNION ALL SELECT C.APPLE_COUNT, C.ORANGE_COUNT FROM BOXES B INNER JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID ) A"
313,Y,N,"WITH CTE AS ( SELECT APPLE_COUNT, ORANGE_COUNT FROM BOXES UNION ALL SELECT C.APPLE_COUNT, C.ORANGE_COUNT FROM BOXES B JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID ) SELECT SUM(APPLE_COUNT) APPLE_COUNT, SUM(ORANGE_COUNT) ORANGE_COUNT FROM CTE"
314,Y,Y,"SELECT SUM(C.APPLE) APPLE_COUNT, SUM(C.ORANGE) ORANGE_COUNT FROM (SELECT A.APPLE_COUNT+IFNULL(B.APPLE_COUNT,0) APPLE, A.ORANGE_COUNT+IFNULL(B.ORANGE_COUNT,0) ORANGE FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID=B.CHEST_ID) C"
315,Y,Y,"SELECT SUM(APPLE_COUNT_) APPLE_COUNT, SUM(ORANGE_COUNT_) ORANGE_COUNT FROM ( SELECT A.APPLE_COUNT + IFNULL(B.APPLE_COUNT,0) APPLE_COUNT_, A.ORANGE_COUNT + IFNULL(B.ORANGE_COUNT,0) ORANGE_COUNT_ FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID = B.CHEST_ID ) A"
316,Y,Y,"SELECT DISTINCT SUM(A.APPLE_COUNT+IFNULL(B.APPLE_COUNT, 0)) AS APPLE_COUNT, SUM(A.ORANGE_COUNT+IFNULL(B.ORANGE_COUNT, 0)) AS ORANGE_COUNT FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID=B.CHEST_ID"
317,Y,Y,"SELECT SUM(APPLES) APPLE_COUNT , SUM(ORANGES) ORANGE_COUNT FROM ( SELECT BOX_ID , B.CHEST_ID , B.APPLE_COUNT +IFNULL(C.APPLE_COUNT,0) AS APPLES ,B.ORANGE_COUNT +IFNULL(C.ORANGE_COUNT ,0) AS ORANGES FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID) A"
318,Y,Y,"WITH A AS(SELECT (B.APPLE_COUNT + COALESCE(C.APPLE_COUNT,0)) AS APP_CT, (B.ORANGE_COUNT +COALESCE(C.ORANGE_COUNT,0)) AS O_CT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID) SELECT SUM(A.APP_CT) AS APPLE_COUNT , SUM(A.O_CT) AS ORANGE_COUNT FROM A"
319,Y,N,"SELECT SUM(APPLE_COUNT) APPLE_COUNT, SUM(ORANGE_COUNT) ORANGE_COUNT FROM ( SELECT SUM(B.APPLE_COUNT) APPLE_COUNT, SUM(B.ORANGE_COUNT) ORANGE_COUNT FROM BOXES B UNION SELECT SUM(C.APPLE_COUNT) APPLE_COUNT, SUM(C.ORANGE_COUNT)ORANGE_COUNT FROM CHESTS C INNER JOIN BOXES B ON B.CHEST_ID=C.CHEST_ID )X"
320,Y,Y,"SELECT SUM(APPLE_COUNT)AS APPLE_COUNT,SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM ( SELECT BOX_ID,APPLE_COUNT+CHESTS_APPLE_COUNT AS APPLE_COUNT,ORANGE_COUNT+CHESTS_ORANGE_COUNT AS ORANGE_COUNT FROM ( SELECT BOX_ID,B.CHEST_ID,B.APPLE_COUNT,B.ORANGE_COUNT,COALESCE(C.APPLE_COUNT,0) AS CHESTS_APPLE_COUNT,COALESCE(C.ORANGE_COUNT,0) AS CHESTS_ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID=C.CHEST_ID)X)Y"
321,Y,Y,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM ( SELECT B.BOX_ID, IFNULL(B.CHEST_ID,0)AS CHEST_ID, B.APPLE_COUNT+IFNULL(C.APPLE_COUNT,0) AS APPLE_COUNT,B.ORANGE_COUNT+IFNULL(C.ORANGE_COUNT,0) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID ) A"
322,Y,Y,"SELECT SUM(IFNULL(CAPPLE,0))+SUM(BAPPLE) AS APPLE_COUNT, SUM(IFNULL(CORANGE,0))+SUM(BORANGE) AS ORANGE_COUNT FROM (SELECT BOX_ID, B.CHEST_ID,B.APPLE_COUNT AS BAPPLE, B.ORANGE_COUNT AS BORANGE, C.APPLE_COUNT AS CAPPLE, C.ORANGE_COUNT AS CORANGE FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID)T"
323,Y,Y,"SELECT SUM(APPLE_COUNT + IFNULL(C_APPLE_COUNT,0)) AS APPLE_COUNT, SUM(ORANGE_COUNT + IFNULL(C_ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES A LEFT JOIN (SELECT CHEST_ID, APPLE_COUNT AS C_APPLE_COUNT, ORANGE_COUNT AS C_ORANGE_COUNT FROM CHESTS) B ON A.CHEST_ID = B.CHEST_ID"
324,Y,Y,"SELECT SUM(A1)+SUM(A3) AS APPLE_COUNT, SUM(A2)+SUM(A4) AS ORANGE_COUNT FROM( SELECT BOX_ID, BOXES.APPLE_COUNT AS A1, BOXES.ORANGE_COUNT AS A2, IFNULL(CHESTS.APPLE_COUNT,0) AS A3, IFNULL(CHESTS.ORANGE_COUNT,0) AS A4 FROM BOXES LEFT JOIN CHESTS ON BOXES.CHEST_ID=CHESTS.CHEST_ID) AS R"
325,Y,Y,"SELECT SUM(APPLE) AS APPLE_COUNT, SUM(ORANGE) AS ORANGE_COUNT FROM( SELECT IFNULL(A.APPLE_COUNT,0)+IFNULL(B.APPLE_COUNT,0) AS APPLE, IFNULL(A.ORANGE_COUNT,0)+IFNULL(B.ORANGE_COUNT,0) AS ORANGE FROM BOXES AS A LEFT JOIN CHESTS AS B ON A.CHEST_ID=B.CHEST_ID) AS TMP"
326,Y,Y,"SELECT SUM(TEMP.APPLE + TEMP.APPLE2) AS APPLE_COUNT, SUM(TEMP.ORANGE + TEMP.ORANGE2) AS ORANGE_COUNT FROM ( SELECT BOXES.BOX_ID, IFNULL(CHESTS.APPLE_COUNT,0) AS APPLE, IFNULL(CHESTS.ORANGE_COUNT,0) AS ORANGE, BOXES.APPLE_COUNT AS APPLE2, BOXES.ORANGE_COUNT AS ORANGE2 FROM BOXES LEFT JOIN CHESTS USING(CHEST_ID) )AS TEMP"
327,Y,Y,"SELECT SUM(T1.APPLE_COUNT) + COALESCE(SUM(T2.APPLE_COUNT), 0) APPLE_COUNT, SUM(T1.ORANGE_COUNT) + COALESCE(SUM(T2.ORANGE_COUNT), 0) ORANGE_COUNT FROM BOXES T1 LEFT JOIN CHESTS T2 ON T1.CHEST_ID = T2.CHEST_ID"
328,Y,Y,"WITH T1 AS (SELECT BOX_ID, B.APPLE_COUNT, B.ORANGE_COUNT, IFNULL(C.APPLE_COUNT,0) AS APPLE_COUNT1, IFNULL(C.ORANGE_COUNT,0) AS ORANGE_COUNT1 FROM BOXES B LEFT JOIN CHESTS C USING(CHEST_ID)) SELECT SUM(APPLE_COUNT+APPLE_COUNT1) AS APPLE_COUNT, SUM(ORANGE_COUNT+ORANGE_COUNT1) AS ORANGE_COUNT FROM T1"
329,Y,Y,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM (SELECT BOX_ID, (B.APPLE_COUNT+IFNULL(C.APPLE_COUNT,0)) AS APPLE_COUNT, (B.ORANGE_COUNT+IFNULL(C.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID=C.CHEST_ID) A"
330,Y,Y,"SELECT APPLE1 + APPLE2 AS APPLE_COUNT, ORANGE1 + ORANGE2 AS ORANGE_COUNT FROM (SELECT COALESCE(SUM(B.APPLE_COUNT),0)AS APPLE1, COALESCE(SUM(C.APPLE_COUNT),0) AS APPLE2, COALESCE(SUM(B.ORANGE_COUNT),0) AS ORANGE1 , COALESCE(SUM( C.ORANGE_COUNT),0) AS ORANGE2 FROM BOXES B LEFT JOIN CHESTS C USING (CHEST_ID) ) TEMP"
331,Y,Y,"WITH COLUM_WISE_COUNT AS ( SELECT (BOXES.APPLE_COUNT + CHESTS.APPLE_COUNT) AS APPLE_COUNT, (BOXES.ORANGE_COUNT + CHESTS.ORANGE_COUNT) AS ORANGE_COUNT FROM BOXES INNER JOIN CHESTS ON BOXES.CHEST_ID = CHESTS.CHEST_ID UNION ALL SELECT APPLE_COUNT, ORANGE_COUNT FROM BOXES WHERE CHEST_ID IS NULL ) SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM COLUM_WISE_COUNT"
332,Y,Y,"SELECT (SUM(A.APPLE_COUNT)+IFNULL(SUM(B.APPLE_COUNT),0)) AS APPLE_COUNT, (SUM(A.ORANGE_COUNT)+IFNULL(SUM(B.ORANGE_COUNT),0)) AS ORANGE_COUNT FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID IS NOT NULL AND A.CHEST_ID=B.CHEST_ID"
333,Y,Y,"SELECT SUM(CASE WHEN TB1.CHEST_ID IS NOT NULL THEN (TB1.APPLE_COUNT+TB2.APPLE_COUNT) ELSE TB1.APPLE_COUNT END) AS APPLE_COUNT, SUM(CASE WHEN TB1.CHEST_ID IS NOT NULL THEN (TB1.ORANGE_COUNT + TB2.ORANGE_COUNT) ELSE TB1.ORANGE_COUNT END) AS ORANGE_COUNT FROM BOXES AS TB1 LEFT JOIN CHESTS AS TB2 ON TB1.CHEST_ID = TB2.CHEST_ID"
334,Y,Y,"SELECT SUM(COALESCE(B.APPLE_COUNT+C.APPLE_COUNT , B.APPLE_COUNT , C.APPLE_COUNT , 0)) AS APPLE_COUNT, SUM(COALESCE(B.ORANGE_COUNT +C.ORANGE_COUNT , B.ORANGE_COUNT , C.ORANGE_COUNT , 0)) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
335,Y,Y,"SELECT SUM(IF(C.CHEST_ID IS NOT NULL, B.APPLE_COUNT+C.APPLE_COUNT, B.APPLE_COUNT)) AS APPLE_COUNT, SUM(IF(C.CHEST_ID IS NOT NULL, B.ORANGE_COUNT+C.ORANGE_COUNT, B.ORANGE_COUNT)) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
336,Y,Y,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM ( SELECT BOX_ID, CASE WHEN B.CHEST_ID IS NULL THEN SUM(B.APPLE_COUNT) ELSE SUM(B.APPLE_COUNT)+SUM(C.APPLE_COUNT) END AS APPLE_COUNT, CASE WHEN B.CHEST_ID IS NULL THEN SUM(B.ORANGE_COUNT) ELSE SUM(B.ORANGE_COUNT)+SUM(C.ORANGE_COUNT) END AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID GROUP BY BOX_ID ) A"
337,Y,Y,"SELECT SUM(CASE WHEN B.CHEST_ID IS NOT NULL THEN B.APPLE_COUNT+C.APPLE_COUNT ELSE B.APPLE_COUNT END)APPLE_COUNT, SUM(CASE WHEN B.CHEST_ID IS NOT NULL THEN B.ORANGE_COUNT+C.ORANGE_COUNT ELSE B.ORANGE_COUNT END)ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C USING(CHEST_ID)"
338,Y,Y,"WITH T AS ( SELECT B.BOX_ID, IFNULL(C.APPLE_COUNT,0) AS APPLE1, IFNULL(C.ORANGE_COUNT,0) AS ORANGE1, B.APPLE_COUNT AS APPLE2, B.ORANGE_COUNT AS ORANGE2 FROM BOXES AS B LEFT JOIN CHESTS AS C ON B.CHEST_ID = C.CHEST_ID ) SELECT (SUM(APPLE1)+SUM(APPLE2)) AS APPLE_COUNT, (SUM(ORANGE1)+SUM(ORANGE2)) AS ORANGE_COUNT FROM T"
339,Y,Y,"SELECT SUM(COALESCE(BOXES.APPLE_COUNT, 0)) + SUM(COALESCE(C.APPLE_COUNT, 0)) APPLE_COUNT, SUM(COALESCE(BOXES.ORANGE_COUNT, 0)) + SUM(COALESCE(C.ORANGE_COUNT, 0)) ORANGE_COUNT FROM BOXES LEFT JOIN CHESTS C ON BOXES.CHEST_ID = C.CHEST_ID"
340,Y,N,"WITH TMP AS (SELECT SUM(B.APPLE_COUNT) AS APPLE_COUNT , SUM(B.ORANGE_COUNT) AS ORANGE_COUNT FROM BOXES A JOIN CHESTS B ON A.CHEST_ID = B.CHEST_ID UNION SELECT SUM(C.APPLE_COUNT) AS APPLE_COUNT , SUM(C.ORANGE_COUNT) AS ORANGE_COUNT FROM BOXES C) SELECT SUM(D.APPLE_COUNT) AS APPLE_COUNT , SUM(D.ORANGE_COUNT) AS ORANGE_COUNT FROM TMP D"
341,Y,Y,"SELECT SUM(COALESCE(T1.APPLE_COUNT,0)+COALESCE(T2.APPLE_COUNT,0)) APPLE_COUNT, SUM(COALESCE(T1.ORANGE_COUNT,0)+COALESCE(T2.ORANGE_COUNT,0)) ORANGE_COUNT FROM BOXES T1 LEFT JOIN CHESTS T2 ON T1.CHEST_ID=T2.CHEST_ID"
342,Y,Y,"SELECT SUM(APPLE_COUNT + CHEST_APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT + CHEST_ORANGE_COUNT) AS ORANGE_COUNT FROM ( SELECT BOX_ID, B.APPLE_COUNT AS APPLE_COUNT, B.ORANGE_COUNT AS ORANGE_COUNT, COALESCE(C.APPLE_COUNT, 0) AS CHEST_APPLE_COUNT, COALESCE(C.ORANGE_COUNT, 0) AS CHEST_ORANGE_COUNT FROM BOXES AS B LEFT JOIN CHESTS AS C USING(CHEST_ID) ) AS T"
343,Y,Y,"SELECT SUM(B1.APPLE_COUNT)+SUM(IFNULL(C1.APPLE_COUNT,0)) AS APPLE_COUNT, SUM(B1.ORANGE_COUNT)+SUM(IFNULL(C1.ORANGE_COUNT,0))AS ORANGE_COUNT FROM BOXES B1 LEFT JOIN CHESTS C1 ON B1.CHEST_ID = C1.CHEST_ID"
344,Y,Y,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM ( SELECT CASE WHEN BOXES.CHEST_ID IS NULL THEN BOXES.APPLE_COUNT ELSE (BOXES.APPLE_COUNT+CHESTS.APPLE_COUNT) END AS APPLE_COUNT, CASE WHEN BOXES.CHEST_ID IS NULL THEN BOXES.ORANGE_COUNT ELSE (BOXES.ORANGE_COUNT+CHESTS.ORANGE_COUNT) END AS ORANGE_COUNT FROM BOXES LEFT JOIN CHESTS ON BOXES.CHEST_ID = CHESTS.CHEST_ID )TXT"
345,Y,Y,"SELECT SUM((BOXES.APPLE_COUNT)+COALESCE((CHESTS.APPLE_COUNT),0)) AS APPLE_COUNT, SUM((BOXES.ORANGE_COUNT)+COALESCE((CHESTS.ORANGE_COUNT),0)) AS ORANGE_COUNT FROM BOXES LEFT JOIN CHESTS ON BOXES.CHEST_ID = CHESTS.CHEST_ID"
346,Y,Y,"SELECT SUM(A.APPLE_COUNT)+SUM(IFNULL(B.APPLE_COUNT,0)) APPLE_COUNT, SUM(A.ORANGE_COUNT)+SUM(IFNULL(B.ORANGE_COUNT,0)) ORANGE_COUNT FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID=B.CHEST_ID"
347,Y,Y,"SELECT SUM(B.APPLE_COUNT + IF(B.CHEST_ID IS NOT NULL, C.APPLE_COUNT, 0)) AS APPLE_COUNT , SUM(B.ORANGE_COUNT + IF(B.CHEST_ID IS NOT NULL, C.ORANGE_COUNT, 0)) AS ORANGE_COUNT FROM BOXES AS B LEFT JOIN CHESTS AS C USING(CHEST_ID)"
348,Y,N,"WITH T1 AS ( SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM BOXES UNION ALL SELECT SUM(C.APPLE_COUNT) AS APPLE_COUNT, SUM(C.ORANGE_COUNT) AS ORANGE_COUNT FROM CHESTS C INNER JOIN BOXES B ON C.CHEST_ID = B.CHEST_ID ) SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM T1"
349,Y,Y,"SELECT SUM(B.APPLE_COUNT) + SUM(IF(C.APPLE_COUNT IS NULL, 0, C.APPLE_COUNT)) AS APPLE_COUNT, SUM(B.ORANGE_COUNT) + SUM(IF(C.ORANGE_COUNT IS NULL, 0, C.ORANGE_COUNT )) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
350,Y,Y,"SELECT SUM(A) AS APPLE_COUNT, SUM(O) AS ORANGE_COUNT FROM ( SELECT B.APPLE_COUNT + IFNULL(C.APPLE_COUNT,0) AS A, B.ORANGE_COUNT + IFNULL(C.ORANGE_COUNT,0) AS O FROM BOXES B LEFT JOIN CHESTS C USING(CHEST_ID)) BASE"
351,Y,Y,"SELECT (SUM(IFNULL(B.APPLE_COUNT,0)) + SUM(IFNULL(C.APPLE_COUNT,0))) APPLE_COUNT, (SUM(IFNULL(B.ORANGE_COUNT,0)) + SUM(IFNULL(C.ORANGE_COUNT,0))) ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
352,Y,N,"WITH CTE AS ( SELECT BOX_ID, BOXES.CHEST_ID, (BOXES.APPLE_COUNT + CHESTS.APPLE_COUNT) AS APPLE_COUNT,( BOXES.ORANGE_COUNT + CHESTS.ORANGE_COUNT) AS ORANGE_COUNT FROM BOXES JOIN CHESTS ON BOXES.CHEST_ID = CHESTS.CHEST_ID GROUP BY BOX_ID UNION ALL SELECT * FROM BOXES WHERE CHEST_ID IS NULL ) SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM CTE"
353,Y,Y,"WITH TMP AS ( SELECT B.BOX_ID, B.CHEST_ID, B.APPLE_COUNT, B.ORANGE_COUNT, C.APPLE_COUNT AS C_APPLE, C.ORANGE_COUNT AS C_ORANGE FROM BOXES AS B LEFT JOIN CHESTS AS C ON B.CHEST_ID = C.CHEST_ID ) SELECT SUM(CASE WHEN CHEST_ID IS NOT NULL THEN APPLE_COUNT + C_APPLE ELSE APPLE_COUNT END) AS APPLE_COUNT, SUM(CASE WHEN CHEST_ID IS NOT NULL THEN ORANGE_COUNT + C_ORANGE ELSE ORANGE_COUNT END) AS ORANGE_COUNT FROM TMP"
354,Y,N,"SELECT SUM(APPLE) AS APPLE_COUNT, SUM(ORANGE) AS ORANGE_COUNT FROM ( SELECT B.BOX_ID, B.APPLE_COUNT + COALESCE(C.APPLE_COUNT, 0) AS APPLE, B.ORANGE_COUNT + COALESCE(C.ORANGE_COUNT,0) AS ORANGE FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID GROUP BY B.BOX_ID ) AS TMP"
355,Y,Y,"WITH CTE AS (SELECT SUM(B.APPLE_COUNT)+IFNULL(SUM(C.APPLE_COUNT),0) APPLE_COUNT, SUM(B.ORANGE_COUNT)+IFNULL(SUM(C.ORANGE_COUNT),0) ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID GROUP BY BOX_ID) SELECT SUM(APPLE_COUNT) APPLE_COUNT,SUM(ORANGE_COUNT) ORANGE_COUNT FROM CTE"
356,Y,Y,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM ( SELECT BOXES.APPLE_COUNT + IFNULL(CHESTS.APPLE_COUNT, 0) AS APPLE_COUNT, BOXES.ORANGE_COUNT + IFNULL(CHESTS.ORANGE_COUNT, 0) AS ORANGE_COUNT FROM BOXES LEFT JOIN CHESTS ON BOXES.CHEST_ID = CHESTS.CHEST_ID ) AS A"
357,Y,Y,"SELECT SUM(APPLEC) AS APPLE_COUNT, SUM(ORANGEC) AS ORANGE_COUNT FROM ( SELECT BOX_ID, (A.APPLE_COUNT + COALESCE(B.APPLE_COUNT,0)) AS APPLEC , (A.ORANGE_COUNT + COALESCE(B.ORANGE_COUNT,0)) AS ORANGEC FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID = B.CHEST_ID)K"
358,Y,N,"SELECT SUM(APPLE_SUB_COUNT) AS APPLE_COUNT, SUM(ORANGE_SUB_COUNT) AS ORANGE_COUNT FROM (SELECT B.BOX_ID, CASE WHEN B.CHEST_ID = C.CHEST_ID THEN B.APPLE_COUNT+C.APPLE_COUNT ELSE B.APPLE_COUNT END AS APPLE_SUB_COUNT, CASE WHEN B.CHEST_ID = C.CHEST_ID THEN B.ORANGE_COUNT+C.ORANGE_COUNT ELSE B.ORANGE_COUNT END AS ORANGE_SUB_COUNT FROM BOXES AS B LEFT JOIN CHESTS AS C ON B.CHEST_ID = C.CHEST_ID GROUP BY BOX_ID) A"
359,Y,N,"WITH CTE AS( SELECT APPLE_COUNT , ORANGE_COUNT FROM BOXES B UNION ALL SELECT C.APPLE_COUNT , C.ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID) SELECT SUM(APPLE_COUNT) AS APPLE_COUNT , SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM CTE"
360,Y,Y,"SELECT (SUM(B.APPLE_COUNT)+COALESCE(SUM(C.APPLE_COUNT), 0)) AS APPLE_COUNT, (SUM(B.ORANGE_COUNT)+COALESCE(SUM(C.ORANGE_COUNT), 0)) AS ORANGE_COUNT FROM BOXES AS B LEFT JOIN CHESTS AS C ON B.CHEST_ID = C.CHEST_ID"
361,Y,Y,"SELECT SUM(B.APPLE_COUNT + CASE WHEN B.CHEST_ID IS NOT NULL THEN C.APPLE_COUNT ELSE 0 END) AS APPLE_COUNT, SUM(B.ORANGE_COUNT + CASE WHEN B.CHEST_ID IS NOT NULL THEN C.ORANGE_COUNT ELSE 0 END) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
362,Y,Y,"SELECT SUM(R.APPLE_COUNT) APPLE_COUNT, SUM(R.ORANGE_COUNT) ORANGE_COUNT FROM (SELECT CASE WHEN B.CHEST_ID IS NULL THEN B.ORANGE_COUNT WHEN B.CHEST_ID = C.CHEST_ID THEN B.ORANGE_COUNT+ C.ORANGE_COUNT END AS ORANGE_COUNT, CASE WHEN B.CHEST_ID IS NULL THEN B.APPLE_COUNT WHEN B.CHEST_ID = C.CHEST_ID THEN B.APPLE_COUNT+ C.APPLE_COUNT END AS APPLE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID) R"
363,Y,Y,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM ( (SELECT SUM(A.APPLE_COUNT+ B.APPLE_COUNT) AS APPLE_COUNT, SUM(A.ORANGE_COUNT + B.ORANGE_COUNT) AS ORANGE_COUNT FROM BOXES A INNER JOIN CHESTS B ON A.CHEST_ID = B.CHEST_ID) UNION ALL ( SELECT APPLE_COUNT , ORANGE_COUNT FROM BOXES WHERE CHEST_ID IS NULL ) )C"
364,Y,Y,"WITH CTE AS( SELECT * FROM BOXES WHERE CHEST_ID IS NOT NULL) ,CTE1 AS (SELECT C1.BOX_ID,C1.APPLE_COUNT ACNT1,C1.ORANGE_COUNT OCNT1,C2.APPLE_COUNT ACNT2, C2.ORANGE_COUNT OCNT2 FROM CTE C1 JOIN CHESTS C2 ON C1.CHEST_ID=C2.CHEST_ID) ,CTE2 AS (SELECT BOX_ID,ACNT1+ACNT2 APPLE_COUNT, OCNT1+OCNT2 ORANGE_COUNT FROM CTE1) SELECT SUM(APPLE_COUNT) APPLE_COUNT, SUM(ORANGE_COUNT) ORANGE_COUNT FROM(SELECT BOX_ID, APPLE_COUNT, ORANGE_COUNT FROM BOXES WHERE CHEST_ID IS NULL UNION ALL SELECT BOX_ID, APPLE_COUNT, ORANGE_COUNT FROM CTE2) A"
365,Y,Y,"WITH CTE AS(SELECT B.BOX_ID, B.CHEST_ID, B.APPLE_COUNT, B.ORANGE_COUNT, IFNULL(C.APPLE_COUNT,0) AC, IFNULL(C.ORANGE_COUNT,0) OC FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID) SELECT SUM(APPLE_COUNT + AC) AS APPLE_COUNT, SUM(ORANGE_COUNT+OC) AS ORANGE_COUNT FROM CTE"
366,Y,N,"WITH X AS ( SELECT APP, ORA FROM ( SELECT B.BOX_ID , SUM(B.APPLE_COUNT) OVER(PARTITION BY B.BOX_ID) + SUM(C.APPLE_COUNT) OVER(PARTITION BY B.BOX_ID) AS APP , SUM(C.ORANGE_COUNT) OVER(PARTITION BY B.BOX_ID) + SUM(B.ORANGE_COUNT) OVER(PARTITION BY B.BOX_ID ,B.CHEST_ID) AS ORA FROM BOXES B JOIN CHESTS C ON C.CHEST_ID = B.CHEST_ID ) K UNION ALL SELECT APPLE_COUNT AS APP , ORANGE_COUNT AS ORA FROM BOXES WHERE CASE WHEN CHEST_ID IN ( SELECT CHEST_ID FROM (SELECT B.BOX_ID , SUM(B.APPLE_COUNT) OVER(PARTITION BY B.BOX_ID) + SUM(C.APPLE_COUNT) OVER(PARTITION BY B.BOX_ID) AS APP , SUM(C.ORANGE_COUNT) OVER(PARTITION BY B.BOX_ID) + SUM(B.ORANGE_COUNT) OVER(PARTITION BY B.BOX_ID) AS ORA FROM BOXES B JOIN CHESTS C ON C.CHEST_ID = B.CHEST_ID ) J ) THEN 0 ELSE 1 END ) SELECT SUM(APP) AS APPLE_COUNT , SUM(ORA) AS ORANGE_COUNT FROM X"
367,Y,Y,"SELECT SUM(APPLE_COUNT)+IFNULL(SUM(APPLE_2),0) AS APPLE_COUNT, SUM(ORANGE_COUNT)+IFNULL(SUM(ORANGE_2),0) AS ORANGE_COUNT FROM (SELECT A.*, B.APPLE_COUNT AS APPLE_2, B.ORANGE_COUNT AS ORANGE_2 FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID=B.CHEST_ID) TEMP"
368,Y,N,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT,SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM ( SELECT BOX_ID,CHESTS.APPLE_COUNT,CHESTS.ORANGE_COUNT FROM BOXES INNER JOIN CHESTS ON BOXES.CHEST_ID=CHESTS.CHEST_ID UNION ALL SELECT BOX_ID,APPLE_COUNT,ORANGE_COUNT FROM BOXES )INN"
369,Y,N,"WITH CTE AS ( SELECT BOX_ID, APPLE_COUNT, ORANGE_COUNT FROM BOXES WHERE CHEST_ID IS NULL UNION SELECT B.BOX_ID,B.APPLE_COUNT+C.APPLE_COUNT,B.ORANGE_COUNT+C.ORANGE_COUNT FROM BOXES B INNER JOIN CHESTS C ON C.CHEST_ID=B.CHEST_ID ) SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM CTE"
370,Y,Y,"WITH BOX_SUMMARY AS ( SELECT B.BOX_ID, B.APPLE_COUNT AS BOX_APPLE_COUNT, B.ORANGE_COUNT AS BOX_ORANGE_COUNT, COALESCE(C.APPLE_COUNT, 0) AS CHEST_APPLE_COUNT, COALESCE(C.ORANGE_COUNT, 0) AS CHEST_ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID ), BOX_AGG AS ( SELECT BOX_APPLE_COUNT + CHEST_APPLE_COUNT AS APPLE_COUNT, BOX_ORANGE_COUNT + CHEST_ORANGE_COUNT AS ORANGE_COUNT FROM BOX_SUMMARY ) SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM BOX_AGG"
371,Y,Y,"SELECT SUM((B.APPLE_COUNT + COALESCE((C.APPLE_COUNT),0))) AS APPLE_COUNT, SUM((B.ORANGE_COUNT + COALESCE((C.ORANGE_COUNT),0))) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID=C.CHEST_ID"
372,Y,Y,"SELECT SUM(IFNULL(A.APPLE_COUNT,0) + IFNULL(B.APPLE_COUNT,0)) APPLE_COUNT, SUM(A.ORANGE_COUNT + IFNULL(B.ORANGE_COUNT,0)) ORANGE_COUNT FROM BOXES A LEFT JOIN CHESTS B ON B.CHEST_ID=A.CHEST_ID"
373,Y,N,"WITH CHEST_C AS ( SELECT A.CHEST_ID, B.APPLE_COUNT, B.ORANGE_COUNT FROM BOXES A JOIN CHESTS B ON A.CHEST_ID=B.CHEST_ID), F_P AS ( SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM CHEST_C UNION ALL SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM BOXES) SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM F_P"
374,Y,Y,"SELECT (SUM(B.APPLE_COUNT)+SUM(IFNULL(C.APPLE_COUNT,0)))AS APPLE_COUNT, (SUM(B.ORANGE_COUNT)+SUM(IFNULL(C.ORANGE_COUNT,0)))AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
375,Y,Y,"SELECT IFNULL(SUM(C.APPLE_COUNT),0)+SUM(B.APPLE_COUNT) AS APPLE_COUNT, IFNULL(SUM(C.ORANGE_COUNT),0)+SUM(B.ORANGE_COUNT) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID=C.CHEST_ID"
376,Y,Y,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT,SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM (SELECT IFNULL(B.APPLE_COUNT,0) +IFNULL(C.APPLE_COUNT,0) AS APPLE_COUNT, IFNULL(B.ORANGE_COUNT,0) +IFNULL( C.ORANGE_COUNT,0) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C USING (CHEST_ID) ) TEMP"
377,Y,Y,"SELECT SUM(X.APPLE_COUNT) AS APPLE_COUNT,SUM(X.ORANGE_COUNT) AS ORANGE_COUNT FROM (SELECT A.BOX_ID,A.CHEST_ID,(A.APPLE_COUNT+IFNULL(B.APPLE_COUNT,0)) AS APPLE_COUNT,(A.ORANGE_COUNT+IFNULL(B.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES AS A LEFT JOIN CHESTS AS B ON A.CHEST_ID=B.CHEST_ID) AS X"
378,Y,Y,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM ( SELECT BOX_ID, B.APPLE_COUNT + IFNULL(C.APPLE_COUNT,0) AS APPLE_COUNT, B.ORANGE_COUNT + IFNULL(C.ORANGE_COUNT,0) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID )T"
379,Y,Y,"WITH CTE AS ( SELECT SUM(B.APPLE_COUNT) AS NUM_APP1, SUM(IFNULL(C.APPLE_COUNT,0)) AS NUM_APP2, SUM(B.ORANGE_COUNT) AS NUM_ORG1, SUM(IFNULL(C.ORANGE_COUNT,0)) AS NUM_ORG2 FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID ) SELECT (NUM_APP1 + NUM_APP2) AS APPLE_COUNT, (NUM_ORG1+NUM_ORG2) AS ORANGE_COUNT FROM CTE"
380,Y,Y,"WITH PREP AS ( SELECT BOX_ID ,CHEST_ID ,B.APPLE_COUNT + COALESCE(C.APPLE_COUNT,0) AS APPLE_COUNT ,B.ORANGE_COUNT + COALESCE(C.ORANGE_COUNT,0) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C USING(CHEST_ID) ) SELECT SUM(APPLE_COUNT) AS APPLE_COUNT ,SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM PREP"
381,Y,Y,"SELECT SUM(APPLE_COUNT_SUB) AS APPLE_COUNT, SUM(ORANGE_COUNT_SUB) AS ORANGE_COUNT FROM ( SELECT IFNULL(B.APPLE_COUNT,0) + IFNULL(C.APPLE_COUNT,0) AS APPLE_COUNT_SUB, IFNULL(B.ORANGE_COUNT,0) + IFNULL(C.ORANGE_COUNT,0) AS ORANGE_COUNT_SUB FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID ) SUB"
382,Y,N,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM ( (SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM BOXES) UNION ALL (SELECT SUM(C.APPLE_COUNT) AS APPLE_COUNT, SUM(C.ORANGE_COUNT) AS ORANGE_COUNT FROM BOXES B JOIN CHESTS C USING(CHEST_ID) ) ) T"
383,Y,Y,"SELECT SUM(COALESCE(B.APPLE_COUNT,0)+COALESCE(C.APPLE_COUNT,0)) AS APPLE_COUNT, SUM(COALESCE(B.ORANGE_COUNT,0)+COALESCE(C.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID=C.CHEST_ID"
384,Y,Y,"WITH T AS (SELECT BOX_ID, B.APPLE_COUNT+COALESCE(C.APPLE_COUNT,0) APPLE, B.ORANGE_COUNT+COALESCE(C.ORANGE_COUNT,0) ORANGE FROM BOXES B LEFT JOIN CHESTS C USING (CHEST_ID)) SELECT SUM(APPLE) APPLE_COUNT, SUM(ORANGE) ORANGE_COUNT FROM T"
385,Y,Y,"SELECT SUM(APPLE_COUNT + APP) AS APPLE_COUNT, SUM(ORANGE_COUNT + ORA) AS ORANGE_COUNT FROM ( SELECT A.*, CASE WHEN B.APPLE_COUNT IS NULL THEN 0 ELSE B.APPLE_COUNT END AS APP, CASE WHEN B.ORANGE_COUNT IS NULL THEN 0 ELSE B.ORANGE_COUNT END AS ORA FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID = B.CHEST_ID)C"
386,Y,Y,"WITH INFO AS( SELECT BOX_ID, IFNULL(B.APPLE_COUNT+C.APPLE_COUNT, B.APPLE_COUNT) AS APPLE, IFNULL(B.ORANGE_COUNT+C.ORANGE_COUNT,B.ORANGE_COUNT) AS ORANGE FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID) SELECT SUM(APPLE) AS APPLE_COUNT, SUM(ORANGE) AS ORANGE_COUNT FROM INFO"
387,Y,Y,"WITH SUM_CHEST AS ( SELECT BOX_ID, SUM(B.APPLE_COUNT) + COALESCE(SUM(C.APPLE_COUNT),0) AS CHEST_APPLE_COUNT, SUM(B.ORANGE_COUNT) + COALESCE(SUM(C.ORANGE_COUNT),0) AS CHEST_ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C USING(CHEST_ID) GROUP BY BOX_ID ) SELECT SUM(CHEST_APPLE_COUNT) AS APPLE_COUNT, SUM(CHEST_ORANGE_COUNT) AS ORANGE_COUNT FROM SUM_CHEST"
388,Y,Y,"SELECT SUM(B.APPLE_COUNT)+SUM(IFNULL(C.APPLE_COUNT,0)) APPLE_COUNT, SUM(B.ORANGE_COUNT)+SUM(IFNULL(C.ORANGE_COUNT,0)) ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C USING(CHEST_ID)"
389,Y,Y,"SELECT SUM(B.APPLE_COUNT+ COALESCE(CH.APPLE_COUNT,0) ) AS APPLE_COUNT, SUM(B.ORANGE_COUNT+ COALESCE(CH.ORANGE_COUNT,0) ) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS CH ON B.CHEST_ID=CH.CHEST_ID"
390,Y,Y,"WITH C1 AS ( SELECT B.*,IFNULL(C.APPLE_COUNT,0) AS CHEST_APPLE_COUNT,IFNULL(C.ORANGE_COUNT,0) AS CHEST_ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID ) SELECT (SUM(APPLE_COUNT) + SUM(CHEST_APPLE_COUNT)) AS APPLE_COUNT, (SUM(ORANGE_COUNT) + SUM(CHEST_ORANGE_COUNT)) AS ORANGE_COUNT FROM C1"
391,Y,Y,"SELECT SUM(A.APPLE_COUNT + COALESCE(B.APPLE_COUNT, 0)) AS APPLE_COUNT, SUM(A.ORANGE_COUNT + COALESCE(B.ORANGE_COUNT, 0)) AS ORANGE_COUNT FROM BOXES AS A LEFT JOIN CHESTS AS B ON A.CHEST_ID = B.CHEST_ID"
392,Y,Y,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM ( SELECT B.APPLE_COUNT + IFNULL(C.APPLE_COUNT,0) AS APPLE_COUNT, B.ORANGE_COUNT + IFNULL(C.ORANGE_COUNT,0) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C USING (CHEST_ID) ) COMBINE"
393,Y,N,"SELECT SUM(APPLE_COUNT) APPLE_COUNT, SUM(ORANGE_COUNT) ORANGE_COUNT FROM( SELECT BOX_ID, (A.APPLE_COUNT + IFNULL(B.APPLE_COUNT,0)) AS APPLE_COUNT, (A.ORANGE_COUNT+IFNULL(B.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID=B.CHEST_ID GROUP BY 1) X"
394,Y,Y,"WITH CTE AS (SELECT B.BOX_ID, IF(C.CHEST_ID IS NOT NULL, B.APPLE_COUNT + C.APPLE_COUNT, B.APPLE_COUNT) AS APPLE_COUNT, IF(C.CHEST_ID IS NOT NULL, B.ORANGE_COUNT + C.ORANGE_COUNT, B.ORANGE_COUNT) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID) SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM CTE"
395,Y,Y,"WITH T AS ( SELECT BOX_ID, B.CHEST_ID, B.APPLE_COUNT + COALESCE(C.APPLE_COUNT,0) AS APPLE_COUNT, B.ORANGE_COUNT + COALESCE(C.ORANGE_COUNT,0) AS ORANGE_COUNT FROM BOXES AS B LEFT OUTER JOIN CHESTS AS C ON B.CHEST_ID = C.CHEST_ID ) SELECT (SELECT SUM(APPLE_COUNT) FROM T) AS APPLE_COUNT, (SELECT SUM(ORANGE_COUNT) FROM T) AS ORANGE_COUNT"
396,Y,Y,"SELECT SUM(A.APPLE_COUNT+ CASE WHEN B.APPLE_COUNT IS NOT NULL THEN B.APPLE_COUNT ELSE 0 END) AS APPLE_COUNT, SUM(A.ORANGE_COUNT+CASE WHEN B.ORANGE_COUNT IS NOT NULL THEN B.ORANGE_COUNT ELSE 0 END) AS ORANGE_COUNT FROM BOXES AS A LEFT JOIN CHESTS AS B ON A.CHEST_ID=B.CHEST_ID"
397,Y,Y,"SELECT SUM(T1.APPLE_COUNT +IFNULL(T2.APPLE_COUNT,0)) AS APPLE_COUNT, SUM(T1.ORANGE_COUNT +IFNULL(T2.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES AS T1 LEFT JOIN CHESTS AS T2 ON T1.CHEST_ID=T2.CHEST_ID"
398,Y,N,"WITH APP_OR AS (SELECT B.BOX_ID, C.CHEST_ID, C.APPLE_COUNT, C.ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON C.CHEST_ID = B.CHEST_ID UNION ALL SELECT BOX_ID, CHEST_ID, APPLE_COUNT, ORANGE_COUNT FROM BOXES) SELECT SUM(APPLE_COUNT)AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM APP_OR"
399,Y,Y,"SELECT SUM(B.APPLE_COUNT + COALESCE(C.APPLE_COUNT,0)) AS APPLE_COUNT, SUM(B.ORANGE_COUNT + COALESCE(C.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM CHESTS C RIGHT JOIN BOXES B ON C.CHEST_ID = B.CHEST_ID"
400,Y,Y,"WITH BOX_SUMMARY AS ( SELECT B.BOX_ID, B.APPLE_COUNT + COALESCE(C.APPLE_COUNT, 0) AS APPLE_COUNT, B.ORANGE_COUNT + COALESCE(C.ORANGE_COUNT, 0) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID ) SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM BOX_SUMMARY"
401,Y,Y,"WITH TMP AS( SELECT A.BOX_ID , A.CHEST_ID , CASE WHEN A.CHEST_ID IS NULL THEN A.APPLE_COUNT ELSE A.APPLE_COUNT+B.APPLE_COUNT END AS TOTAL_APPLE , CASE WHEN A.CHEST_ID IS NULL THEN A.ORANGE_COUNT ELSE A.ORANGE_COUNT+B.ORANGE_COUNT END AS TOTAL_ORANGE FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID = B.CHEST_ID) SELECT SUM(TOTAL_APPLE) AS APPLE_COUNT , SUM(TOTAL_ORANGE) AS ORANGE_COUNT FROM TMP"
402,Y,Y,"SELECT SUM(IFNULL(A.APPLE_COUNT,0) + IFNULL(B.APPLE_COUNT,0)) APPLE_COUNT, SUM(IFNULL(A.ORANGE_COUNT,0) + IFNULL(B.ORANGE_COUNT,0)) ORANGE_COUNT FROM BOXES A LEFT JOIN CHESTS B ON B.CHEST_ID=A.CHEST_ID"
403,Y,Y,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM( SELECT A.BOX_ID, A.CHEST_ID, (COALESCE(B.APPLE_COUNT,0) + A.APPLE_COUNT) AS APPLE_COUNT, (COALESCE(B.ORANGE_COUNT,0) + A.ORANGE_COUNT) AS ORANGE_COUNT FROM BOXES A LEFT OUTER JOIN CHESTS B ON A.CHEST_ID = B. CHEST_ID )A"
404,Y,N,"WITH CTE AS ((SELECT APPLE_COUNT, ORANGE_COUNT FROM BOXES) UNION ALL (SELECT B.APPLE_COUNT,B.ORANGE_COUNT FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID = B.CHEST_ID)) SELECT SUM(APPLE_COUNT) AS APPLE_COUNT , SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM CTE"
405,Y,Y,"WITH CTE AS( SELECT B.BOX_ID, IFNULL(C.APPLE_COUNT,0)+B.APPLE_COUNT AS APPLE_COUNT , IFNULL(C.ORANGE_COUNT,0)+B.ORANGE_COUNT AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C USING (CHEST_ID)) SELECT SUM(APPLE_COUNT) AS APPLE_COUNT , SUM(ORANGE_COUNT)AS ORANGE_COUNT FROM CTE"
406,Y,Y,"SELECT SUM(C.APPLE_COUNT) AS APPLE_COUNT, SUM(C.ORANGE_COUNT) AS ORANGE_COUNT FROM (SELECT (A.APPLE_COUNT + IFNULL(B.APPLE_COUNT,0)) AS APPLE_COUNT, (A.ORANGE_COUNT + IFNULL(B.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID = B.CHEST_ID) C"
407,Y,Y,"WITH TOTAL_BOX_COUNT AS( SELECT B.BOX_ID , CASE WHEN B.CHEST_ID IS NOT NULL THEN B.APPLE_COUNT + C.APPLE_COUNT ELSE B.APPLE_COUNT END APPLE_COUNT , CASE WHEN B.CHEST_ID IS NOT NULL THEN B.ORANGE_COUNT + C.ORANGE_COUNT ELSE B.ORANGE_COUNT END ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID ) SELECT SUM(APPLE_COUNT) APPLE_COUNT, SUM(ORANGE_COUNT) ORANGE_COUNT FROM TOTAL_BOX_COUNT"
408,Y,Y,"WITH CTE AS (SELECT A.BOX_ID, A.CHEST_ID, A.APPLE_COUNT,A.ORANGE_COUNT, IFNULL(B.APPLE_COUNT,0) AS CHEST_APPLE,IFNULL(B.ORANGE_COUNT,0) AS CHEST_ORANGE FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID = B.CHEST_ID) SELECT SUM(APPLE_COUNT+CHEST_APPLE) AS APPLE_COUNT,SUM(ORANGE_COUNT+CHEST_ORANGE) AS ORANGE_COUNT FROM CTE"
409,Y,N,"SELECT SUM(APPLE_COUNT) APPLE_COUNT, SUM(ORANGE_COUNT) ORANGE_COUNT FROM (SELECT B.BOX_ID, B.APPLE_COUNT + (CASE WHEN C.APPLE_COUNT IS NOT NULL THEN C.APPLE_COUNT ELSE 0 END) APPLE_COUNT , B.ORANGE_COUNT + (CASE WHEN C.ORANGE_COUNT IS NOT NULL THEN C.ORANGE_COUNT ELSE 0 END) ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C USING(CHEST_ID) GROUP BY B.BOX_ID) EXTR"
410,Y,Y,"SELECT (SUM(BOXES.APPLE_COUNT) + SUM(IFNULL(CHESTS.APPLE_COUNT, 0))) AS APPLE_COUNT, (SUM(BOXES.ORANGE_COUNT) + SUM(IFNULL(CHESTS.ORANGE_COUNT, 0))) AS ORANGE_COUNT FROM BOXES LEFT JOIN CHESTS ON BOXES.CHEST_ID = CHESTS.CHEST_ID"
411,Y,Y,"SELECT (SUM(B.APPLE_COUNT) + IFNULL(SUM(C.APPLE_COUNT), 0)) AS APPLE_COUNT , (SUM(B.ORANGE_COUNT) + IFNULL(SUM(C.ORANGE_COUNT), 0)) AS ORANGE_COUNT FROM BOXES AS B LEFT JOIN CHESTS AS C ON B.CHEST_ID = C.CHEST_ID"
412,Y,N,"WITH A AS ((SELECT B.BOX_ID,C.APPLE_COUNT,C.ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C USING (CHEST_ID)) UNION ALL (SELECT BOX_ID,APPLE_COUNT,ORANGE_COUNT FROM BOXES)) SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM A"
413,Y,Y,"WITH CTE AS( SELECT BOX_ID, A.CHEST_ID, A.APPLE_COUNT AS BOX_APPLE, A.ORANGE_COUNT AS BOX_ORANGE, B.APPLE_COUNT AS CHEST_APPLE, B.ORANGE_COUNT AS CHEST_ORANGE FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID = B.CHEST_ID) SELECT (SUM(BOX_APPLE) + IFNULL(SUM(CHEST_APPLE),0)) AS APPLE_COUNT, (SUM(BOX_ORANGE)+IFNULL(SUM(CHEST_ORANGE),0)) AS ORANGE_COUNT FROM CTE"
414,Y,Y,"SELECT SUM((APPLE_COUNT+IFNULL(CAPPLE,0))) APPLE_COUNT,SUM((ORANGE_COUNT+IFNULL(CORANGE,0)))ORANGE_COUNT FROM (SELECT BOX_ID,B.APPLE_COUNT,B.ORANGE_COUNT, C.APPLE_COUNT CAPPLE,C.ORANGE_COUNT CORANGE FROM BOXES B LEFT JOIN CHESTS C USING (CHEST_ID)) A"
415,Y,Y,"WITH CTE AS (SELECT B.*, C.APPLE_COUNT A2, C.ORANGE_COUNT O2 FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID=C.CHEST_ID) SELECT SUM(APPLE_COUNT)+IFNULL(SUM(A2),0) APPLE_COUNT, SUM(ORANGE_COUNT)+IFNULL(SUM(O2),0) ORANGE_COUNT FROM CTE"
416,Y,Y,"SELECT SUM(T.TOTAL_APPLE) AS APPLE_COUNT,SUM(T.TOTAL_ORANGE) AS ORANGE_COUNT FROM( SELECT B.BOX_ID, B.CHEST_ID, B.APPLE_COUNT+COALESCE(C.APPLE_COUNT,0) AS TOTAL_APPLE, B.ORANGE_COUNT+COALESCE(C.ORANGE_COUNT,0) AS TOTAL_ORANGE FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID=C.CHEST_ID) T"
417,Y,Y,"WITH TEMP AS ( SELECT B.APPLE_COUNT, B.ORANGE_COUNT, IFNULL(C.APPLE_COUNT, 0) AS CHEST_APPLE_COUNT, IFNULL(C.ORANGE_COUNT, 0) AS CHEST_ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID ) SELECT (SUM(APPLE_COUNT) + SUM(CHEST_APPLE_COUNT)) AS APPLE_COUNT, (SUM(ORANGE_COUNT) + SUM(CHEST_ORANGE_COUNT)) AS ORANGE_COUNT FROM TEMP"
418,Y,Y,"SELECT SUM(A.APPLE_COUNT + COALESCE(B.APPLE_COUNT, 0)) AS APPLE_COUNT, SUM(A.ORANGE_COUNT + COALESCE(B.ORANGE_COUNT, 0)) AS ORANGE_COUNT FROM BOXES A LEFT OUTER JOIN CHESTS B USING (CHEST_ID)"
419,Y,Y,"SELECT SUM(B.APPLE_COUNT+COALESCE(C.APPLE_COUNT,0)) AS APPLE_COUNT,SUM(B.ORANGE_COUNT+COALESCE(C.ORANGE_COUNT,0)) ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
420,Y,Y,"WITH CTE AS ( SELECT B.BOX_ID,B.APPLE_COUNT+IFNULL(C.APPLE_COUNT,0) AS AT, B.ORANGE_COUNT+IFNULL(C.ORANGE_COUNT,0) AS OT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID=C.CHEST_ID ) SELECT SUM(AT) APPLE_COUNT, SUM(OT) AS ORANGE_COUNT FROM CTE"
421,Y,Y,"WITH CTE1 AS ( SELECT A.*, IFNULL(B.APPLE_COUNT,0) AS CAC, IFNULL(B.ORANGE_COUNT,0) COC FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID = B.CHEST_ID ) SELECT SUM(APPLE_COUNT+ CAC) AS APPLE_COUNT , SUM(ORANGE_COUNT+COC) AS ORANGE_COUNT FROM CTE1"
422,Y,N,"WITH BX AS( SELECT BOX_ID,SUM(APPLE_COUNT) AS S_APPLE_COUNT,SUM(ORANGE_COUNT) AS S_ORANGE_COUNT FROM BOXES GROUP BY BOX_ID ), CX AS ( SELECT BOX_ID,SUM(C.APPLE_COUNT) AS S_APPLE_COUNT, SUM(C.ORANGE_COUNT) AS S_ORANGE_COUNT FROM BOXES B, CHESTS C WHERE B.CHEST_ID=C.CHEST_ID GROUP BY BOX_ID ) SELECT SUM(S_APPLE_COUNT) AS APPLE_COUNT,SUM(S_ORANGE_COUNT) AS ORANGE_COUNT FROM (SELECT * FROM BX UNION ALL SELECT * FROM CX ) T"
423,Y,Y,"SELECT SUM(IFNULL(T1.APPLE_COUNT,0)+IFNULL(T2.APPLE_COUNT,0)) AS APPLE_COUNT, SUM(IFNULL(T1.ORANGE_COUNT,0)+IFNULL(T2.ORANGE_COUNT,0)) AS ORANGE_COUNT FROM BOXES T1 LEFT JOIN CHESTS T2 USING(CHEST_ID)"
424,Y,Y,"WITH TEMP AS(SELECT A.APPLE_COUNT AS TEMPT,A.ORANGE_COUNT AS TEMPI,B.APPLE_COUNT AS AP,B.ORANGE_COUNT AS AB FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID IS NOT NULL AND A.CHEST_ID=B.CHEST_ID) SELECT (SUM(TEMPT)+IFNULL(SUM(AP),0)) AS APPLE_COUNT, (SUM(TEMPI)+IFNULL(SUM(AB),0)) AS ORANGE_COUNT FROM TEMP"
425,Y,Y,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT,SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM ( SELECT SUM(A.APPLE_COUNT+B.APPLE_COUNT) AS APPLE_COUNT,SUM(A.ORANGE_COUNT+B.ORANGE_COUNT) AS ORANGE_COUNT FROM BOXES A INNER JOIN CHESTS B ON A.CHEST_ID=B.CHEST_ID UNION ALL SELECT SUM(A.APPLE_COUNT) AS APPLE_COUNT,SUM(A.ORANGE_COUNT) AS ORANGE_COUNT FROM BOXES A WHERE A.CHEST_ID IS NULL ) AS C"
426,Y,Y,"SELECT SUM(APPLE_COUNT+ADDA) AS APPLE_COUNT, SUM(ORANGE_COUNT+ORGA) AS ORANGE_COUNT FROM (SELECT BOX_ID, B.APPLE_COUNT, B.ORANGE_COUNT, CASE WHEN C.CHEST_ID IS NULL THEN 0 ELSE C.APPLE_COUNT END AS ADDA, CASE WHEN C.CHEST_ID IS NULL THEN 0 ELSE C.ORANGE_COUNT END AS ORGA FROM BOXES B LEFT JOIN CHESTS C ON C.CHEST_ID=B.CHEST_ID )AS CTE"
427,Y,Y,"WITH CTE AS( SELECT SUM(A.APPLE_COUNT) AS BOX_APPLE,SUM(A.ORANGE_COUNT) AS BOX_ORANGE, SUM(CASE WHEN A.CHEST_ID IS NOT NULL THEN B.APPLE_COUNT ELSE 0 END) AS CHEST_APPLE, SUM(CASE WHEN A.CHEST_ID IS NOT NULL THEN B.ORANGE_COUNT ELSE 0 END) AS CHEST_ORANGE FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID=B.CHEST_ID) SELECT SUM(APPLE) AS APPLE_COUNT, SUM(ORANGE) AS ORANGE_COUNT FROM( SELECT BOX_APPLE AS APPLE, BOX_ORANGE AS ORANGE FROM CTE UNION SELECT CHEST_APPLE AS APPLE, CHEST_ORANGE AS ORANGE FROM CTE) A"
428,Y,Y,"WITH COMBINE AS ( SELECT BOX_ID, B.CHEST_ID, B.APPLE_COUNT AS BOX_APPLE, B.ORANGE_COUNT AS BOX_ORANGE, IFNULL(C.APPLE_COUNT,0) AS CHEST_APPLE, IFNULL(C.ORANGE_COUNT,0) AS CHEST_ORANGE FROM BOXES AS B LEFT JOIN CHESTS AS C ON B.CHEST_ID = C.CHEST_ID ) SELECT SUM(BOX_APPLE)+SUM(CHEST_APPLE) AS APPLE_COUNT, SUM(BOX_ORANGE)+SUM(CHEST_ORANGE) AS ORANGE_COUNT FROM COMBINE"
429,Y,Y,"SELECT SUM(CASE WHEN AP THEN AP END) AS APPLE_COUNT, SUM(CASE WHEN O THEN O END) AS ORANGE_COUNT FROM ( SELECT IFNULL(B.APPLE_COUNT + C.APPLE_COUNT,B.APPLE_COUNT) AS AP, IFNULL(B.ORANGE_COUNT + C.ORANGE_COUNT,B.ORANGE_COUNT) AS O FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID ) TMP"
430,Y,Y,"WITH CTE AS (SELECT A.APPLE_COUNT+IFNULL(B.APPLE_COUNT,0) APPLE, A.ORANGE_COUNT+IFNULL(B.ORANGE_COUNT,0) ORANGE FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID=B.CHEST_ID) SELECT SUM(APPLE) APPLE_COUNT, SUM(ORANGE) ORANGE_COUNT FROM CTE"
431,Y,Y,"SELECT SUM(B.APPLE_COUNT + COALESCE((C.APPLE_COUNT),0)) AS APPLE_COUNT, SUM(B.ORANGE_COUNT + COALESCE((C.ORANGE_COUNT),0)) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID=C.CHEST_ID"
432,Y,Y,"WITH CTE AS (SELECT A.BOX_ID, B.CHEST_ID, A.APPLE_COUNT, A.ORANGE_COUNT, B.APPLE_COUNT AS CHAP, B.ORANGE_COUNT AS CHOR FROM BOXES A LEFT JOIN CHESTS B ON A.CHEST_ID = B.CHEST_ID) SELECT SUM(APPLE_COUNT) + SUM(IFNULL(CHAP, 0)) AS APPLE_COUNT, SUM(ORANGE_COUNT) + SUM(IFNULL(CHOR, 0)) AS ORANGE_COUNT FROM CTE"
433,Y,Y,"WITH NEW_TABLE AS( SELECT BOX_ID, C.CHEST_ID,C.APPLE_COUNT AS APPLE_1, C.ORANGE_COUNT AS ORANGE_1, B.ORANGE_COUNT AS ORANGE_2, B.APPLE_COUNT AS APPLE_2 FROM BOXES B LEFT JOIN CHESTS C USING(CHEST_ID) ) SELECT SUM(IFNULL(APPLE_1,0)+APPLE_2) AS APPLE_COUNT, SUM(IFNULL(ORANGE_1,0) + ORANGE_2) AS ORANGE_COUNT FROM NEW_TABLE"
434,Y,Y,"SELECT SUM(APPLE_COUNT + APPLE_COUNT_FR_CHEST) AS APPLE_COUNT, SUM(ORANGE_COUNT + ORANGE_COUNT_FR_CHEST) AS ORANGE_COUNT FROM (SELECT B.*, IFNULL(C.APPLE_COUNT, 0) AS APPLE_COUNT_FR_CHEST, IFNULL(C.ORANGE_COUNT, 0) AS ORANGE_COUNT_FR_CHEST FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID) AS T1"
435,Y,Y,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM(SELECT B.APPLE_COUNT + COALESCE(C.APPLE_COUNT,0) AS APPLE_COUNT, B.ORANGE_COUNT + COALESCE(C.ORANGE_COUNT,0) AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID) TEMP"
436,Y,Y,"SELECT SUM(APPLE_COUNT) AS APPLE_COUNT,SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM (SELECT BOX_ID,CASE WHEN C.APPLE_COUNT IS NULL THEN B.APPLE_COUNT ELSE B.APPLE_COUNT+C.APPLE_COUNT END AS APPLE_COUNT,CASE WHEN C.ORANGE_COUNT IS NULL THEN B.ORANGE_COUNT ELSE B.ORANGE_COUNT+C.ORANGE_COUNT END AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID=C.CHEST_ID)A"
437,Y,Y,"WITH T AS( SELECT BOX_ID, BOXES.APPLE_COUNT AS B_APPLE, BOXES.ORANGE_COUNT AS B_ORANGE, IFNULL(CHESTS.APPLE_COUNT, 0) AS C_APPLE, IFNULL(CHESTS.ORANGE_COUNT, 0) AS C_ORANGE FROM BOXES LEFT JOIN CHESTS ON BOXES.CHEST_ID = CHESTS.CHEST_ID ) SELECT SUM(B_APPLE) + SUM(C_APPLE) AS APPLE_COUNT, SUM(B_ORANGE) + SUM(C_ORANGE) AS ORANGE_COUNT FROM T"
438,Y,Y,"WITH ALL_AO AS (SELECT B.CHEST_ID, IFNULL(C.APPLE_COUNT, 0)+B.APPLE_COUNT AS APPLE_COUNT, IFNULL(C.ORANGE_COUNT, 0)+B.ORANGE_COUNT AS ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID) SELECT SUM(APPLE_COUNT) AS APPLE_COUNT, SUM(ORANGE_COUNT) AS ORANGE_COUNT FROM ALL_AO"
439,Y,Y,"SELECT SUM(B.APPLE_COUNT + IFNULL(C.APPLE_COUNT, 0)) AS APPLE_COUNT, SUM(B.ORANGE_COUNT + IFNULL(C.ORANGE_COUNT, 0)) AS ORANGE_COUNT FROM BOXES B LEFT OUTER JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID"
440,Y,Y,"WITH FULL_TABLE AS (SELECT B.BOX_ID, B.CHEST_ID, B.APPLE_COUNT AS B_APPLE, B.ORANGE_COUNT AS B_ORANGE, IFNULL(C.APPLE_COUNT ,0) AS C_APPLE, IFNULL(C.ORANGE_COUNT,0) AS C_ORANGE FROM BOXES B LEFT JOIN CHESTS C ON B.CHEST_ID = C.CHEST_ID) SELECT SUM(T.APPLE_BOX) AS APPLE_COUNT, SUM(T.ORANGE_BOX) AS ORANGE_COUNT FROM (SELECT B_APPLE + C_APPLE AS APPLE_BOX, B_ORANGE + C_ORANGE AS ORANGE_BOX FROM FULL_TABLE) T"
441,Y,Y,"SELECT SUM(APPLE_COUNT) APPLE_COUNT, SUM(ORANGE_COUNT) ORANGE_COUNT FROM ( SELECT BOX_ID, (B.APPLE_COUNT + COALESCE(C.APPLE_COUNT,0)) APPLE_COUNT, (B.ORANGE_COUNT + COALESCE(C.ORANGE_COUNT,0)) ORANGE_COUNT FROM BOXES B LEFT JOIN CHESTS C USING(CHEST_ID) ) T1"
