qid,mysql_can_execute?,mysql_correct?,mysql_query
0,N,N,"FROM (SELECT (COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID)) * 100 AS REMOVAL_PERCENT, A.ACTION_DATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ) X"
1,Y,Y,"SELECT COALESCE(ROUND(AVG(PERCENT),2),0.00) AS AVERAGE_DAILY_PERCENT FROM( SELECT A.ACTION_DATE, (COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)) *100 AS PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA='SPAM' GROUP BY A.ACTION_DATE )A"
2,Y,Y,"SELECT ROUND( AVG(DAILY_PERCENT), 2 ) AS AVERAGE_DAILY_PERCENT FROM( SELECT ACTION_DATE, ROUND( COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100, 2) AS DAILY_PERCENT FROM ACTIONS AS A LEFT JOIN REMOVALS AS R ON A.POST_ID=R.POST_ID WHERE A.EXTRA='SPAM' GROUP BY A.ACTION_DATE ) M"
3,Y,Y,"SELECT ROUND((SUM(AVG_DAY)/COUNT(ACTION_DATE))*100,2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, COUNT(DISTINCT CASE WHEN B.REMOVE_DATE IS NOT NULL THEN A.POST_ID ELSE NULL END)/COUNT(DISTINCT A.POST_ID) AS AVG_DAY FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY ACTION_DATE) T"
4,Y,Y,"SELECT ROUND(100*AVG(DAILY_PERCENT), 2) AVERAGE_DAILY_PERCENT FROM (SELECT COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) DAILY_PERCENT, ACTION_DATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE) T"
5,Y,Y,"SELECT ROUND(AVG(AVERAGEVAL),2) AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE ,(COUNT(DISTINCT R.POST_ID)*100/ COUNT(DISTINCT A.POST_ID)) AS AVERAGEVAL FROM ACTIONS A LEFT JOIN REMOVALS R ON R.POST_ID=A.POST_ID WHERE A.ACTION='REPORT' AND A.EXTRA='SPAM' GROUP BY ACTION_DATE)T"
6,Y,Y,"SELECT ROUND(AVG(AVG_RATE),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE, 100*COUNT(DISTINCT R.POST_ID)/ COUNT(DISTINCT A.POST_ID) AS AVG_RATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY 1) AS T"
7,Y,Y,"SELECT ROUND(AVG(C.REMOVE_DAILY_PERCENT), 2) AVERAGE_DAILY_PERCENT FROM ( SELECT B.ACTION_DATE, COUNT(DISTINCT B.REMOVAL_POST_ID) * 100 / COUNT(DISTINCT B.POST_ID) REMOVE_DAILY_PERCENT FROM ( SELECT A.ACTION_DATE, A.POST_ID, R.POST_ID REMOVAL_POST_ID FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' ) B GROUP BY B.ACTION_DATE ) C"
8,Y,Y,"SELECT ROUND(AVG(CNT), 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT (COUNT(DISTINCT R.POST_ID)/ COUNT(DISTINCT A.POST_ID))*100 AS CNT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA='SPAM' GROUP BY ACTION_DATE)TMP"
9,Y,Y,"SELECT ROUND(AVG(CNT), 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT (COUNT(DISTINCT R.POST_ID)/ COUNT(DISTINCT A.POST_ID))*100 AS CNT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA='SPAM' AND ACTION = 'REPORT' GROUP BY ACTION_DATE)TMP"
10,Y,Y,"SELECT ROUND(AVG(CNT), 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT (COUNT(DISTINCT R.POST_ID)/ COUNT(DISTINCT A.POST_ID))*100 AS CNT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA='SPAM' GROUP BY ACTION_DATE) AS T"
11,Y,Y,"SELECT ROUND(AVG(D.NUM)*100,2) AVERAGE_DAILY_PERCENT FROM (SELECT (COUNT(C.REMOVE_DATE)/ COUNT(C.ACTION_DATE)) NUM FROM ( SELECT DISTINCT A.POST_ID,A.ACTION_DATE,B.REMOVE_DATE FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID=B.POST_ID WHERE EXTRA='SPAM') C GROUP BY ACTION_DATE)D"
12,Y,Y,"SELECT ROUND(AVG(DAILY_AVE) * 100,2) AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, COUNT(CASE WHEN POST_ID IN (SELECT POST_ID FROM REMOVALS) THEN 1 ELSE NULL END) / COUNT(POST_ID) DAILY_AVE FROM ( SELECT DISTINCT ACTION_DATE, POST_ID, CASE WHEN EXTRA = 'SPAM' THEN EXTRA ELSE NULL END EXTRA FROM ACTIONS ) A WHERE EXTRA = 'SPAM' GROUP BY 1 ) FINAL"
13,Y,Y,"SELECT ROUND(AVG(DAILY_PERCENT)*100, 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT A.ACTION_DATE, COALESCE(SUM(CASE WHEN REMOVE_DATE IS NOT NULL THEN 1 ELSE 0 END)/COUNT(DISTINCT A.POST_ID), 0) AS DAILY_PERCENT FROM (SELECT DISTINCT POST_ID, ACTION_DATE, EXTRA FROM ACTIONS) A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE) T1"
14,Y,Y,"SELECT ROUND(AVG(DAILY_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE,COUNT(DISTINCT IF(REMOVE_DATE IS NULL,NULL,POST_ID))/COUNT(DISTINCT POST_ID)*100 AS DAILY_PERCENT FROM ACTIONS LEFT JOIN REMOVALS USING(POST_ID) WHERE ACTION='REPORT' AND EXTRA ='SPAM' GROUP BY ACTION_DATE) AS TEMP"
15,Y,Y,"SELECT ROUND(AVG(DAILY_PERCENTAGE)*100,2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS DAILY_PERCENTAGE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE ACTION='REPORT' AND EXTRA='SPAM' GROUP BY ACTION_DATE) D"
16,Y,Y,"SELECT ROUND(AVG(DAILY_PERCENTAGE)*100,2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT COUNT(DISTINCT CASE WHEN R.REMOVE_DATE IS NOT NULL THEN A.POST_ID ELSE NULL END)/COUNT(DISTINCT(A.POST_ID)) AS DAILY_PERCENTAGE FROM ACTIONS AS A LEFT JOIN REMOVALS AS R ON R.POST_ID = A.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE ) AS SUB"
17,Y,Y,"SELECT ROUND(AVG(DAILY_PERCENTAGE), 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, COUNT(T2.POST_ID) / COUNT(T1.POST_ID) * 100 AS DAILY_PERCENTAGE FROM ( SELECT DISTINCT POST_ID, ACTION_DATE FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' ) T1 LEFT JOIN REMOVALS T2 ON T1.POST_ID = T2.POST_ID GROUP BY ACTION_DATE )T"
18,Y,Y,"SELECT ROUND(AVG(DAILY_RATE),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTIONS.ACTION_DATE, COUNT(DISTINCT REMOVALS.POST_ID)*100 / COUNT(DISTINCT ACTIONS.POST_ID) AS DAILY_RATE FROM ACTIONS LEFT JOIN REMOVALS ON ACTIONS.POST_ID= REMOVALS.POST_ID WHERE ACTIONS.ACTION = 'REPORT' AND EXTRA= 'SPAM' GROUP BY ACTIONS.ACTION_DATE) SUB"
19,Y,Y,"SELECT ROUND(AVG(DAILY_REMOVAL_RATE), 2) AVERAGE_DAILY_PERCENT FROM( SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT(A.POST_ID)) *100 DAILY_REMOVAL_RATE FROM ACTIONS A LEFT JOIN REMOVALS R ON R.POST_ID = A.POST_ID WHERE A.ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ) TB"
20,Y,Y,"SELECT ROUND(AVG(NUM),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT (COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)) *100 AS NUM FROM ACTIONS A LEFT JOIN REMOVALS R ON R.POST_ID=A.POST_ID WHERE A.EXTRA='SPAM' GROUP BY A.ACTION_DATE) T"
21,Y,Y,"SELECT ROUND(AVG(NUM_REMOVED/NUM_REPORTED)*100, 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT COUNT(DISTINCT A.POST_ID) AS NUM_REPORTED, COUNT(DISTINCT R.POST_ID) AS NUM_REMOVED FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID AND R.REMOVE_DATE > A.ACTION_DATE WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ) T"
22,Y,Y,"SELECT ROUND(AVG(PCT)*100,2) AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE, COUNT(DISTINCT B.POST_ID)/COUNT(DISTINCT A.POST_ID) PCT FROM (SELECT DISTINCT ACTION_DATE, POST_ID FROM ACTIONS WHERE 1=1 AND ACTION ='REPORT' AND EXTRA='SPAM' ) A LEFT JOIN REMOVALS B ON A.POST_ID=B.POST_ID GROUP BY A.ACTION_DATE)T"
23,Y,Y,"SELECT ROUND(AVG(PCT_PER_DAY), 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT (IFNULL(COUNT(DISTINCT B.POST_ID), 0) * 100.0 / IFNULL(COUNT(DISTINCT A.POST_ID), 0)) AS PCT_PER_DAY FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE) T"
24,Y,Y,"SELECT ROUND(AVG(PERC),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COALESCE(COUNT(R.POST_ID),0)*100/COUNT(*) AS PERC FROM (SELECT POST_ID, ACTION_DATE, EXTRA FROM ACTIONS GROUP BY 1,2,3) A LEFT JOIN (SELECT POST_ID, REMOVE_DATE FROM REMOVALS GROUP BY 1,2) R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE ) SUB"
25,Y,Y,"SELECT ROUND(AVG(PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE , COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) * 100 AS PERCENT FROM ACTIONS AS A LEFT JOIN REMOVALS AS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY ACTION_DATE ) T"
26,Y,Y,"SELECT ROUND(AVG(PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)*100/COUNT(DISTINCT A.POST_ID) AS PERCENT FROM (SELECT POST_ID, ACTION_DATE FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM') A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID GROUP BY A.ACTION_DATE) TMP"
27,Y,Y,"SELECT ROUND(AVG(PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE) TEMP"
28,Y,Y,"SELECT ROUND(AVG(PERCENTAGE), 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) * 100 AS PERCENTAGE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY 1) T"
29,Y,Y,"SELECT ROUND(AVG(PERCENTAGE),2) AS AVERAGE_DAILY_PERCENT FROM( SELECT TEM.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT TEM.POST_ID) * 100 AS PERCENTAGE FROM REMOVALS R RIGHT JOIN ( SELECT POST_ID, ACTION_DATE FROM ACTIONS WHERE EXTRA = 'SPAM') TEM ON R.POST_ID = TEM.POST_ID GROUP BY 1) TEM1"
30,Y,Y,"SELECT ROUND(AVG(PNT), 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT COUNT(DISTINCT R.POST_ID)*100/ COUNT(DISTINCT A.POST_ID) AS PNT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA='SPAM' AND ACTION = 'REPORT' GROUP BY ACTION_DATE)TMP"
31,Y,Y,"SELECT ROUND(AVG(RATE), 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT DISTINCT ACTION_DATE, COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID)*100 AS RATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY ACTION_DATE) TMP"
32,Y,Y,"SELECT ROUND(AVG(REMOVAL_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS REMOVAL_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID= R.POST_ID WHERE A.EXTRA='SPAM' GROUP BY ACTION_DATE )A"
33,Y,Y,"SELECT ROUND(AVG(REMOVAL_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)/ COUNT(DISTINCT A.POST_ID)*100 AS REMOVAL_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID= R.POST_ID WHERE A.EXTRA='SPAM' GROUP BY ACTION_DATE) AS B"
34,Y,Y,"SELECT ROUND(AVG(REMOVAL_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)/ COUNT(DISTINCT A.POST_ID)*100 AS REMOVAL_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID= R.POST_ID WHERE A.EXTRA='SPAM' GROUP BY ACTION_DATE) TEMP"
35,Y,Y,"SELECT ROUND(AVG(REMOVAL_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)/ COUNT(DISTINCT A.POST_ID)*100 AS REMOVAL_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID= R.POST_ID WHERE A.EXTRA='SPAM' GROUP BY ACTION_DATE)A"
36,Y,Y,"SELECT ROUND(AVG(REMOVAL_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)/ COUNT(DISTINCT A.POST_ID)*100 AS REMOVAL_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID= R.POST_ID WHERE A.EXTRA='SPAM' AND A.ACTION='REPORT' GROUP BY ACTION_DATE)A"
37,Y,Y,"SELECT ROUND(AVG(REMOVE_RATE),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE ,COUNT(REMOVE_DATE)/COUNT(POST_ID)*100 AS REMOVE_RATE FROM (SELECT DISTINCT A.POST_ID ,A.ACTION_DATE ,R.REMOVE_DATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM') C1 GROUP BY 1) C2"
38,Y,Y,"SELECT ROUND(AVG(REMOVED_RATE), 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, COUNT(DISTINCT REMOVALS.POST_ID)/COUNT(DISTINCT ACTIONS.POST_ID)*100 AS REMOVED_RATE FROM ACTIONS LEFT JOIN REMOVALS USING(POST_ID) WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY ACTION_DATE) TEMP"
39,Y,Y,"SELECT ROUND(AVG(REMOVEL_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID)*100 AS REMOVEL_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY ACTION_DATE) AS TEMP"
40,Y,Y,"SELECT ROUND(AVG(SPAMREMOVED/SPAMNUM)*100, 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT COUNT(DISTINCT A.POST_ID) AS SPAMNUM, COUNT(DISTINCT CASE WHEN REMOVE_DATE IS NOT NULL THEN A.POST_ID ELSE NULL END) AS SPAMREMOVED, ACTION_DATE FROM ACTIONS AS A LEFT JOIN REMOVALS AS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE ) AS SUB"
41,Y,Y,"SELECT ROUND(AVG(T.NUM)*100,2) AVERAGE_DAILY_PERCENT FROM (SELECT COUNT(DISTINCT B.POST_ID)/COUNT(DISTINCT A.POST_ID) NUM FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID=B.POST_ID WHERE EXTRA='SPAM' GROUP BY ACTION_DATE)T"
42,Y,Y,"SELECT ROUND(AVG(T.PERCENTAGE), 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT COUNT(DISTINCT(R.POST_ID)) / COUNT(DISTINCT(A.POST_ID)) * 100 AS PERCENTAGE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY ACTION_DATE) T"
43,Y,Y,"SELECT ROUND(SUM(DAILY_AVERAGE)/COUNT(ACTION_DATE),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT A.ACTION_DATE, (COUNT(DISTINCT B.POST_ID) / COUNT(DISTINCT A.POST_ID)) *100 AS DAILY_AVERAGE FROM ACTIONS AS A LEFT JOIN REMOVALS AS B ON A.POST_ID = B.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY ACTION_DATE )AS C"
44,Y,Y,"SELECT ROUND(SUM(DAILY_PERCENT)*100/COUNT(DISTINCT ACTION_DATE),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT A.ACTION_DATE, (COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)) AS DAILY_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON R.POST_ID = A.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ) A"
45,Y,Y,"SELECT ROUND(SUM(CNT) / COUNT(CNT), 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT IFNULL(ROUND(COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) * 100, 2), 0) AS CNT FROM ACTIONS AS A LEFT JOIN REMOVALS AS R ON A.POST_ID = R.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY ACTION_DATE ) AS TMP"
46,Y,Y,"SELECT ROUND(SUM(PERC_REMOVAL) / COUNT(1), 2) AVERAGE_DAILY_PERCENT FROM ( SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) * 100 PERC_REMOVAL FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA= 'SPAM' GROUP BY A.ACTION_DATE ) T"
47,Y,Y,"SELECT ROUND(SUM(PERCENT)/ COUNT(*)*100,2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, COUNT(CASE WHEN REMOVEORNOT = 'REMOVED' THEN 1 END)/ COUNT(*) AS PERCENT FROM ( SELECT DISTINCT POST_ID, ACTION_DATE, CASE WHEN POST_ID IN (SELECT POST_ID FROM REMOVALS) THEN REMOVED ELSE NOT_REMOVED END AS REMOVEORNOT FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY 1,2 ) RES1 GROUP BY 1 ) RES2"
48,Y,Y,"SELECT ROUND(SUM(PERCENT)/COUNT(DISTINCT ACTION_DATE), 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE A.EXTRA='SPAM' GROUP BY 1) TMP"
49,Y,Y,"SELECT ROUND(SUM(PERCENT)/COUNT(DISTINCT ACTION_DATE), 2) AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA='SPAM' GROUP BY 1) RSLT"
50,Y,Y,"SELECT ROUND(SUM(PERCENT)/COUNT(ACTION_DATE), 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT A.ACTION_DATE, (COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A. POST_ID)) * 100 AS PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ) TEMP"
51,Y,Y,"SELECT ROUND(SUM(PERCENTAGE) / COUNT(DISTINCT(ACTION_DATE)), 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE, COUNT(DISTINCT(R.POST_ID)) / COUNT(DISTINCT(A.POST_ID)) * 100 AS PERCENTAGE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE) T"
52,Y,Y,"SELECT ROUND(SUM(PERCENTAGE)/(SELECT COUNT(DISTINCT ACTION_DATE) AS COUNT_DAYS FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM'),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT A.ACTION_DATE , COUNT(DISTINCT B.POST_ID)*100/COUNT(DISTINCT A.POST_ID) AS PERCENTAGE FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID=B.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE) A"
53,Y,Y,"SELECT ROUND(SUM(REMOVE_DAILY_PERCENT) / COUNT(DISTINCT B.ACTION_DATE), 2) AVERAGE_DAILY_PERCENT FROM ( SELECT A.ACTION_DATE, A.POST_ID, COUNT(DISTINCT R.POST_ID) * 100 / COUNT(DISTINCT A.POST_ID) REMOVE_DAILY_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ) B"
54,Y,Y,"SELECT ROUND(AVG(DAILY_PERCENT)*100, 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT IFNULL(COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID), 0) AS DAILY_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE) SPAMMED"
55,Y,Y,"SELECT ROUND(SUM(PERCENT)/COUNT(DISTINCT ACTION_DATE),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE,COUNT(DISTINCT R.POST_ID)/ COUNT(DISTINCT A.POST_ID)*100 AS PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA='SPAM' GROUP BY ACTION_DATE) TEMP"
56,Y,Y,"SELECT ROUND(AVG(PRCT), 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT SPAMMED.ACTION_DATE, COUNT(DISTINCT REMOVALS.POST_ID) / COUNT(DISTINCT SPAMMED.POST_ID)*100 PRCT FROM ACTIONS SPAMMED LEFT JOIN REMOVALS ON REMOVALS.POST_ID = SPAMMED.POST_ID WHERE SPAMMED.EXTRA = 'SPAM' GROUP BY 1 ) SUB"
57,Y,Y,"SELECT ROUND(AVG(RATE) *100,2) AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE, COUNT(DISTINCT(R.POST_ID))/COUNT(DISTINCT(A.POST_ID)) AS RATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ) TEMP"
58,Y,Y,"SELECT ROUND(AVG(RATIO) * 100,2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, SUM(CASE WHEN REMOVE_DATE IS NULL THEN 0 ELSE 1 END) / COUNT(*) AS RATIO FROM ( SELECT DISTINCT A.POST_ID, ACTION_DATE, R.REMOVE_DATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' ) A GROUP BY 1 ) B"
59,Y,Y,"SELECT ROUND(AVG(REPORT_RATE),2) AS AVERAGE_DAILY_PERCENT FROM( SELECT ACTION_DATE , SUM(REMOVED)*100/COUNT(DISTINCT REPORTED_POSTS) AS REPORT_RATE FROM( SELECT DISTINCT ACTION_DATE , A.POST_ID AS REPORTED_POSTS , CASE WHEN R.POST_ID IS NOT NULL THEN 1 ELSE 0 END AS REMOVED FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM') T GROUP BY ACTION_DATE) T2"
60,Y,Y,"SELECT ROUND(AVG(A.REMOVAL_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(DISTINCT(R.POST_ID))/COUNT(DISTINCT(A.POST_ID))*100 AS REMOVAL_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R. POST_ID WHERE A.EXTRA='SPAM' GROUP BY ACTION_DATE)A"
61,Y,Y,"SELECT ROUND(AVG(PERCENT),2) AVERAGE_DAILY_PERCENT FROM(SELECT ACTION_DATE, (COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID ))*100 PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON R.POST_ID = A.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY ACTION_DATE) T"
62,Y,Y,"SELECT ROUND(AVG(REMOVAL_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)/ COUNT(DISTINCT A.POST_ID)*100 AS REMOVAL_PERCENT FROM ACTIONS A LEFT OUTER JOIN REMOVALS R ON A.POST_ID= R.POST_ID WHERE A.EXTRA='SPAM' GROUP BY ACTION_DATE) A"
63,Y,Y,"SELECT ROUND(AVG(REMOVAL_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)/ COUNT(DISTINCT A.POST_ID)*100 AS REMOVAL_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE)A"
64,Y,Y,"SELECT ROUND(AVG(REMOVED),2) AVERAGE_DAILY_PERCENT FROM ( SELECT (COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID))*100 REMOVED, ACTION_DATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE ACTION = 'REPORT' AND EXTRA LIKE SPAM GROUP BY ACTION_DATE ) TEMP"
65,Y,Y,"SELECT ROUND(AVG(TEMP.PERCENT)*100,2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA ='SPAM' GROUP BY 1) TEMP"
66,Y,Y,"WITH C AS ( SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE A.EXTRA='SPAM' GROUP BY 1 ) SELECT ROUND(AVG(PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM C"
67,Y,Y,"WITH CTE AS ( SELECT DISTINCT POST_ID, ACTION_DATE, EXTRA FROM ACTIONS WHERE EXTRA = 'SPAM' ) SELECT ROUND(AVG(PCT)*100,2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT SUM(CNT)/COUNT(POST_ID) AS PCT FROM ( SELECT *, CASE WHEN POST_ID IN (SELECT POST_ID FROM REMOVALS) THEN 1 ELSE 0 END AS CNT FROM CTE )A GROUP BY ACTION_DATE )B"
68,Y,Y,"WITH CTE AS ( SELECT A.ACTION_DATE, COUNT(DISTINCT A.POST_ID) AS REPORTED_SPAM FROM ACTIONS A WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ), CTE2 AS ( SELECT A.ACTION_DATE, COUNT(DISTINCT A.POST_ID) AS REMOVED_SPAM FROM ACTIONS A JOIN REMOVALS USING (POST_ID) WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ) SELECT ROUND(AVG(SUB.DAILY_PERCENT), 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT COALESCE( (REMOVED_SPAM / REPORTED_SPAM) * 100, 0) AS DAILY_PERCENT FROM CTE LEFT JOIN CTE2 USING (ACTION_DATE) ) SUB"
69,Y,Y,"WITH CTE AS ( SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) AS TOTAL FROM ACTIONS AS A LEFT JOIN REMOVALS AS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY 1) SELECT ROUND(AVG(TOTAL*100),2) AS AVERAGE_DAILY_PERCENT FROM CTE"
70,Y,Y,"WITH RS AS (SELECT DISTINCT A.POST_ID AS POST1, A.ACTION_DATE, B.POST_ID AS POST2 FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID WHERE EXTRA = 'SPAM') SELECT ROUND(AVG(PTG),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT RS.ACTION_DATE, 100.00 * SUM(CASE WHEN RS.POST2 IS NULL THEN 0 ELSE 1 END)/ COUNT(CASE WHEN RS.POST2 IS NULL THEN 0 ELSE 1 END) AS PTG FROM RS GROUP BY RS.ACTION_DATE) P"
71,Y,Y,"WITH T1 AS ( SELECT DISTINCT POST_ID, ACTION_DATE, REMOVE_DATE FROM ACTIONS LEFT JOIN REMOVALS USING(POST_ID) WHERE EXTRA='SPAM' ), T2 AS ( SELECT SUM(CASE WHEN REMOVE_DATE IS NOT NULL THEN 1 ELSE 0 END)/COUNT(*)*100 AS PERCENT FROM T1 GROUP BY ACTION_DATE ) SELECT ROUND(AVG(PERCENT), 2) AS AVERAGE_DAILY_PERCENT FROM T2"
72,Y,Y,"WITH TEMP1 AS (SELECT POST_ID, ACTION_DATE FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY POST_ID, ACTION_DATE), TEMP2 AS (SELECT TEMP1.ACTION_DATE, COUNT(R.POST_ID) AS NUM FROM TEMP1 LEFT JOIN REMOVALS R ON TEMP1.POST_ID =R.POST_ID GROUP BY ACTION_DATE) SELECT ROUND(AVG(TGT)*100,2) AS AVERAGE_DAILY_PERCENT FROM( SELECT NUM/COUNT(TEMP1.POST_ID) AS TGT FROM TEMP1 JOIN TEMP2 USING (ACTION_DATE) GROUP BY ACTION_DATE) A"
73,Y,Y,"WITH TMP AS (SELECT DISTINCT A.POST_ID, ACTION_DATE, B.POST_ID AS RM FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID WHERE EXTRA = 'SPAM'), TMP2 AS (SELECT ACTION_DATE, COUNT(RM) / COUNT(POST_ID) * 100 AS DAILY_PERCENT FROM TMP GROUP BY 1) SELECT ROUND(AVG(DAILY_PERCENT),2) AVERAGE_DAILY_PERCENT FROM TMP2"
74,Y,Y,"WITH BASE_TABLE AS ( SELECT ACTION_DATE, SUM(IF(REMOVE_DATE IS NOT NULL, 1, 0)) / COUNT(DISTINCT SPAM.POST_ID) AS RATIO FROM ( SELECT ACTION_DATE, POST_ID, ACTION, EXTRA FROM ACTIONS WHERE ACTION = 'REPORT' AND LOWER(EXTRA) LIKE '%SPAM%' GROUP BY 1,2,3,4 ) AS SPAM LEFT JOIN REMOVALS AS RM ON SPAM.POST_ID = RM.POST_ID AND SPAM.ACTION_DATE < REMOVE_DATE GROUP BY 1 ) SELECT ROUND(AVG(RATIO) * 100, 2) AS AVERAGE_DAILY_PERCENT FROM BASE_TABLE"
75,Y,Y,"WITH BASE_TABLE AS ( SELECT ACTION_DATE, SUM(IF(REMOVE_DATE IS NOT NULL, 1, 0)) / COUNT(DISTINCT SPAM.POST_ID) AS RATIO FROM (SELECT DISTINCT DISTINCT ACTION_DATE, POST_ID, ACTION, EXTRA FROM ACTIONS WHERE ACTION = 'REPORT' AND LOWER(EXTRA) LIKE '%SPAM%') AS SPAM LEFT JOIN REMOVALS AS RM ON SPAM.POST_ID = RM.POST_ID AND SPAM.ACTION_DATE < REMOVE_DATE GROUP BY 1 ) SELECT ROUND(AVG(RATIO) * 100, 2) AS AVERAGE_DAILY_PERCENT FROM BASE_TABLE"
76,Y,Y,"WITH C1 AS (SELECT DISTINCT POST_ID ,ACTION_DATE FROM ACTIONS WHERE EXTRA = 'SPAM') ,C2 AS ( SELECT ACTION_DATE ,SUM(CASE WHEN POST_ID IN (SELECT POST_ID FROM REMOVALS) THEN 1 ELSE 0 END)/COUNT(POST_ID)*100 AS REMOVAL_RATE FROM C1 GROUP BY 1) SELECT ROUND(AVG(REMOVAL_RATE),2) AS AVERAGE_DAILY_PERCENT FROM C2"
77,Y,Y,"WITH CTE AS (SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS REPORTED_SPAM FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA='SPAM' GROUP BY ACTION_DATE), CTE2 AS (SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS REMOVED_SPAM FROM ACTIONS JOIN REMOVALS USING (POST_ID) WHERE ACTION = 'REPORT' AND EXTRA='SPAM' GROUP BY ACTION_DATE) SELECT ROUND(AVG(DAILY_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT COALESCE((REMOVED_SPAM/REPORTED_SPAM)*100,0) AS DAILY_PERCENT FROM CTE LEFT JOIN CTE2 USING (ACTION_DATE)) Q"
78,Y,Y,"WITH CTE AS (SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS REPORTED_SPAM FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA='SPAM' GROUP BY ACTION_DATE), CTE2 AS (SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) REMOVED_SPAM FROM ACTIONS JOIN REMOVALS USING (POST_ID) WHERE ACTION = 'REPORT' AND EXTRA='SPAM' GROUP BY ACTION_DATE) SELECT ROUND(AVG(DAILY_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT COALESCE((REMOVED_SPAM/REPORTED_SPAM)*100,0) AS DAILY_PERCENT FROM CTE LEFT JOIN CTE2 USING (ACTION_DATE)) Q"
79,Y,Y,"WITH CTE AS (SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) * 100 AS PER FROM ACTIONS AS A LEFT JOIN REMOVALS AS R USING(POST_ID) WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE) SELECT ROUND(AVG(PER), 2) AS AVERAGE_DAILY_PERCENT FROM CTE"
80,Y,Y,"WITH CTE AS( SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID)*100 AS DAILY_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE ) SELECT ROUND(AVG(DAILY_PERCENT), 2) AS AVERAGE_DAILY_PERCENT FROM CTE"
81,Y,Y,"WITH CTE AS( SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS CNT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA='SPAM' GROUP BY ACTION_DATE) SELECT ROUND(AVG(CNT)*100,2) AS AVERAGE_DAILY_PERCENT FROM CTE"
82,Y,Y,"WITH CTE1 AS ( SELECT DISTINCT ACTION_DATE, POST_ID FROM ACTIONS WHERE EXTRA = 'SPAM' ) SELECT ROUND(AVG(DAILY_RATIO) * 100, 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, SUM(REMOVAL_POST_ID) / COUNT(REMOVAL_POST_ID) AS DAILY_RATIO FROM ( SELECT CTE1.ACTION_DATE, CTE1.POST_ID, CASE WHEN R.POST_ID IS NULL THEN 0 ELSE 1 END AS REMOVAL_POST_ID FROM CTE1 LEFT JOIN REMOVALS AS R ON CTE1.POST_ID = R.POST_ID ) AS T1 GROUP BY ACTION_DATE ) AS T2"
83,Y,Y,"WITH CTEA AS ( SELECT POST_ID ,ACTION_DATE ,COUNT(DISTINCT POST_ID) AS NO_SPAMS FROM ACTIONS WHERE EXTRA = 'SPAM' AND ACTION = 'REPORT' GROUP BY ACTION_DATE ), CTEB AS ( SELECT R.POST_ID ,ACTION_DATE ,COUNT(DISTINCT A.POST_ID) AS POST_REM FROM REMOVALS AS R JOIN ACTIONS AS A ON R.POST_ID = A.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ) SELECT ROUND(AVG(SUB.DAILY_PERCENT), 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT COALESCE( (POST_REM / CTEA.NO_SPAMS) * 100, 0) AS DAILY_PERCENT FROM CTEA LEFT JOIN CTEB USING (ACTION_DATE) ) SUB"
84,Y,Y,"WITH CTE_ACTIONS AS ( SELECT A.ACTION_DATE, A.POST_ID, R.POST_ID AS REMOVED_POST_ID FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' ) SELECT ROUND(AVG(PCT), 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT T.ACTION_DATE, COALESCE(R.REOMVED_POST_COUNT, 0) / TOTAL_POST_COUNT * 100 AS PCT FROM ( SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS TOTAL_POST_COUNT FROM CTE_ACTIONS GROUP BY ACTION_DATE ) T LEFT JOIN ( SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS REOMVED_POST_COUNT FROM CTE_ACTIONS WHERE REMOVED_POST_ID IS NOT NULL GROUP BY ACTION_DATE ) R ON R.ACTION_DATE = T.ACTION_DATE ) PCT"
85,Y,N,"WITH CTE_TOTAL_POST AS ( SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS TOTAL_POST FROM ACTIONS WHERE EXTRA ='SPAM ' GROUP BY ACTION_DATE ORDER BY ACTION_DATE) ,CTE_REMOVE AS ( SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS REMOVED FROM (SELECT A.POST_ID, ACTION_DATE,EXTRA FROM ACTIONS A INNER JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE EXTRA ='SPAM') AS D GROUP BY ACTION_DATE ) , CTE_PERCENTAGE AS ( SELECT T.ACTION_DATE, COALESCE((REMOVED/TOTAL_POST),0) AS AVERAGE_DAILY_PERCENT FROM CTE_TOTAL_POST T LEFT JOIN CTE_REMOVE R ON T.ACTION_DATE=R.ACTION_DATE) SELECT ROUND(AVG(AVERAGE_DAILY_PERCENT)*100, 2) AS AVERAGE_DAILY_PERCENT FROM CTE_PERCENTAGE"
86,Y,N,"WITH CTE_TOTAL_POST AS ( SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS TOTAL_POST FROM ACTIONS WHERE EXTRA ='SPAM ' GROUP BY ACTION_DATE ORDER BY ACTION_DATE) ,CTE_REMOVE AS ( SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS REMOVED FROM (SELECT A.POST_ID, ACTION_DATE,EXTRA FROM ACTIONS A INNER JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE EXTRA ='SPAM') AS D GROUP BY ACTION_DATE ) SELECT ROUND(AVG(AVERAGE_DAILY_PERCENT)*100, 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT T.ACTION_DATE, COALESCE((REMOVED/TOTAL_POST),0) AS AVERAGE_DAILY_PERCENT FROM CTE_TOTAL_POST T LEFT JOIN CTE_REMOVE R ON T.ACTION_DATE=R.ACTION_DATE) AS D"
87,Y,Y,"WITH CTS AS ( SELECT ACTION_DATE, COUNT(DISTINCT ACTIONS.POST_ID) AS TOTAL_COUNT, COUNT(*) AS TOTAL_SIMPLE_COUNT, COUNT(DISTINCT CASE WHEN REMOVALS.REMOVE_DATE IS NULL THEN NULL ELSE ACTIONS.POST_ID END) AS REMOVED_COUNT FROM ACTIONS LEFT OUTER JOIN REMOVALS ON ACTIONS.POST_ID = REMOVALS.POST_ID WHERE ACTION='REPORT' AND EXTRA='SPAM' GROUP BY ACTION_DATE ) SELECT ROUND(100.0 * AVG(REMOVED_COUNT / TOTAL_COUNT), 2) AS AVERAGE_DAILY_PERCENT FROM CTS"
88,Y,Y,"WITH DACTIONS AS (SELECT DISTINCT POST_ID, ACTION_DATE, EXTRA FROM ACTIONS ), NUMERATOR AS (SELECT A.ACTION_DATE, COUNT(*) AS NUM FROM DACTIONS A WHERE A.EXTRA = 'SPAM' AND A.POST_ID IN (SELECT R.POST_ID FROM REMOVALS R WHERE A.ACTION_DATE<=R.REMOVE_DATE) GROUP BY A.ACTION_DATE), DENOMINATOR AS (SELECT ACTION_DATE, COUNT(*) AS DEN FROM DACTIONS WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE) SELECT ROUND(AVG(IFNULL(NUM,0)/DEN*100),2) AS AVERAGE_DAILY_PERCENT FROM DENOMINATOR D LEFT JOIN NUMERATOR N ON D.ACTION_DATE = N.ACTION_DATE"
89,Y,Y,"WITH DAILY_CTE AS ( SELECT COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) AS DAILY_RATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ) SELECT ROUND(AVG(DAILY_RATE) * 100, 2) AS AVERAGE_DAILY_PERCENT FROM DAILY_CTE"
90,Y,Y,"WITH DATE_PCT AS ( SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) AS DAILY_PCT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ) SELECT ROUND(100*AVG(DAILY_PCT),2) AS AVERAGE_DAILY_PERCENT FROM DATE_PCT"
91,Y,Y,"WITH LABEL AS ( SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) AS DAILY_PERCENT FROM ACTIONS AS A LEFT JOIN REMOVALS AS R ON A.POST_ID = R.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY ACTION_DATE ) SELECT ROUND(AVG(DAILY_PERCENT) * 100, 2) AS AVERAGE_DAILY_PERCENT FROM LABEL"
92,Y,Y,"WITH REPORT_SPAM AS ( SELECT DISTINCT POST_ID, ACTION_DATE, POST_ID IN (SELECT POST_ID FROM REMOVALS) AS REMOVED FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' ), DAILY_RATE AS ( SELECT SUM(REMOVED)/COUNT(POST_ID) AS DAILY_PERCENT FROM REPORT_SPAM GROUP BY ACTION_DATE ) SELECT ROUND(AVG(DAILY_PERCENT) * 100, 2) AS AVERAGE_DAILY_PERCENT FROM DAILY_RATE"
93,Y,Y,"WITH REPORT_SPAM AS ( SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA='SPAM' GROUP BY 1 ) SELECT ROUND(SUM(PERCENT)/COUNT(DISTINCT ACTION_DATE),2) AS AVERAGE_DAILY_PERCENT FROM REPORT_SPAM"
94,Y,Y,"WITH SPAM AS ( SELECT DISTINCT A.POST_ID, ACTION_DATE, CASE WHEN REMOVE_DATE IS NOT NULL THEN 1 ELSE 0 END REMOVED FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM'), PERC_REMOVED AS ( SELECT ACTION_DATE, 100 * (SUM(REMOVED)/ COUNT(REMOVED)) AS PERCENT_REMOVED FROM SPAM GROUP BY ACTION_DATE) SELECT ROUND(AVG(PERCENT_REMOVED),2) AS AVERAGE_DAILY_PERCENT FROM PERC_REMOVED"
95,Y,Y,"WITH SPAM AS (SELECT DISTINCT(POST_ID), ACTION_DATE FROM ACTIONS WHERE EXTRA = 'SPAM') SELECT ROUND(AVG(FRACTION) * 100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT SUM(REMOVAL)/COUNT(POST_ID) AS FRACTION FROM (SELECT *, CASE WHEN POST_ID IN (SELECT POST_ID FROM REMOVALS) THEN 1 ELSE 0 END AS REMOVAL FROM SPAM) A GROUP BY ACTION_DATE) B"
96,Y,Y,"WITH SPAM_POSTS_PER_DAY AS( SELECT POST_ID, ACTION_DATE FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY 1, 2 ) SELECT ROUND(SUM(TEMP3.PERCENTAGE_PER_DAY) / COUNT( TEMP3.ACTION_DATE), 2) AS AVERAGE_DAILY_PERCENT FROM( SELECT TEMP2.ACTION_DATE AS ACTION_DATE, TEMP2.NUM_POSTS_REMOVED / TEMP2.NUM_POSTS * 100 AS PERCENTAGE_PER_DAY FROM( SELECT TEMP.ACTION_DATE AS ACTION_DATE, COUNT( TEMP.POST_ID) AS NUM_POSTS, SUM(TEMP.POST_REMOVED) AS NUM_POSTS_REMOVED FROM( SELECT S.POST_ID AS POST_ID, S.ACTION_DATE AS ACTION_DATE, CASE WHEN R.POST_ID IS NULL THEN 0 ELSE 1 END AS POST_REMOVED FROM SPAM_POSTS_PER_DAY S LEFT JOIN REMOVALS R ON S.POST_ID = R.POST_ID )TEMP GROUP BY 1 )TEMP2 )TEMP3"
97,Y,Y,"WITH SPAM_POSTS_PER_DAY AS( SELECT POST_ID, ACTION_DATE FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY 1, 2 ) SELECT ROUND(SUM(TEMP3.PERCENTAGE_PER_DAY) / COUNT(DISTINCT TEMP3.ACTION_DATE), 2) AS AVERAGE_DAILY_PERCENT FROM( SELECT TEMP2.ACTION_DATE AS ACTION_DATE, TEMP2.NUM_POSTS_REMOVED / TEMP2.NUM_POSTS * 100 AS PERCENTAGE_PER_DAY FROM( SELECT TEMP.ACTION_DATE AS ACTION_DATE, COUNT(DISTINCT TEMP.POST_ID) AS NUM_POSTS, SUM(TEMP.POST_REMOVED) AS NUM_POSTS_REMOVED FROM( SELECT S.POST_ID AS POST_ID, S.ACTION_DATE AS ACTION_DATE, CASE WHEN R.REMOVE_DATE IS NULL THEN 0 ELSE 1 END AS POST_REMOVED FROM SPAM_POSTS_PER_DAY S LEFT JOIN REMOVALS R ON S.POST_ID = R.POST_ID )TEMP GROUP BY 1 )TEMP2 )TEMP3"
98,Y,Y,"WITH SPAM_TABLE AS(SELECT DISTINCT ACTION_DATE, POST_ID, EXTRA, CASE WHEN POST_ID IN (SELECT POST_ID FROM REMOVALS) THEN REMOVED ELSE 'NOT REMOVED' END REMOVED FROM ACTIONS WHERE ACTION='REPORT' AND EXTRA='SPAM') SELECT ROUND(AVG(PERCENT_REMOVED),2) AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, SUM(CASE WHEN REMOVED='REMOVED' THEN 1 ELSE 0 END)/COUNT(*)*100 PERCENT_REMOVED FROM SPAM_TABLE GROUP BY 1) SUB1"
99,Y,Y,"WITH SPAMS AS ( SELECT DISTINCT A.POST_ID, (CASE WHEN R.REMOVE_DATE IS NOT NULL THEN 1 ELSE 0 END) AS IS_REPORTED, A.ACTION_DATE FROM ACTIONS A LEFT JOIN REMOVALS R USING(POST_ID) WHERE A.ACTION = 'REPORT' AND EXTRA = 'SPAM' ), AVGS AS ( SELECT SUM(IS_REPORTED=1) / COUNT(DISTINCT POST_ID) AS DAILY_PERC FROM SPAMS GROUP BY ACTION_DATE ) SELECT ROUND(AVG(DAILY_PERC * 100), 2) AS AVERAGE_DAILY_PERCENT FROM AVGS"
100,Y,Y,"WITH T AS ( SELECT DISTINCT POST_ID, ACTION_DATE, EXTRA FROM ACTIONS WHERE EXTRA = 'SPAM' ) SELECT ROUND(AVG(DAILY_PERCENT)*100,2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT SUM(DIVIDEND)/COUNT(POST_ID) AS DAILY_PERCENT FROM( SELECT *, CASE WHEN POST_ID IN (SELECT POST_ID FROM REMOVALS) THEN 1 ELSE 0 END AS DIVIDEND FROM T) AS T1 GROUP BY ACTION_DATE) AS T2"
101,Y,Y,"WITH T AS (SELECT ACTION_DATE, 100* COUNT(DISTINCT REMOVALS.POST_ID) / COUNT(DISTINCT POST_ID) AS AVG_R FROM ACTIONS LEFT JOIN REMOVALS USING (POST_ID) WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE) SELECT ROUND(AVG(AVG_R), 2) AS AVERAGE_DAILY_PERCENT FROM T"
102,Y,Y,"WITH T1 AS ( SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID) AS CNT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ), T2 AS ( SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS CNT1 FROM ACTIONS WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE ) SELECT ROUND( AVG(CNT*100/CNT1), 2) AS AVERAGE_DAILY_PERCENT FROM T1 JOIN T2 ON T1.ACTION_DATE = T2.ACTION_DATE"
103,Y,Y,"WITH T1 AS ( SELECT ACTION_DATE, POST_ID FROM ACTIONS WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE, POST_ID ), T2 AS ( SELECT T1.ACTION_DATE, AVG(CASE WHEN T1.ACTION_DATE < R.REMOVE_DATE THEN 1 ELSE 0 END) * 100 AS DAILY_PERCENT FROM T1 LEFT JOIN REMOVALS R ON T1.POST_ID = R.POST_ID GROUP BY ACTION_DATE ) SELECT ROUND(AVG(DAILY_PERCENT), 2) AS AVERAGE_DAILY_PERCENT FROM T2"
104,Y,Y,"WITH T1 AS (SELECT T2.ACTION_DATE , COUNT(DISTINCT T3.POST_ID)/COUNT(DISTINCT T2.POST_ID)*100 AS PERCENT FROM ACTIONS AS T2 LEFT JOIN REMOVALS AS T3 ON T2.POST_ID = T3.POST_ID WHERE T2.EXTRA='SPAM' GROUP BY T2.ACTION_DATE) SELECT ROUND(SUM(PERCENT)/COUNT(DISTINCT ACTION_DATE),2) AS AVERAGE_DAILY_PERCENT FROM T1"
105,Y,Y,"WITH TABLE1 AS( SELECT COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID)*100 AS PCT_REMOVED FROM ACTIONS A LEFT JOIN REMOVALS R USING(POST_ID) WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE ) SELECT ROUND(AVG(PCT_REMOVED),2) AS AVERAGE_DAILY_PERCENT FROM TABLE1"
106,Y,Y,"WITH TABLE1 AS( SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS DAILY_PERCENTAGE FROM ACTIONS A LEFT JOIN REMOVALS R USING(POST_ID) WHERE EXTRA='SPAM' GROUP BY ACTION_DATE ) SELECT ROUND(AVG(DAILY_PERCENTAGE),2) AS AVERAGE_DAILY_PERCENT FROM TABLE1"
107,Y,Y,"WITH TEMP1 AS (SELECT DISTINCT ACTION_DATE, COUNT(DISTINCT POST_ID) AS REPORTED_COUNT FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY ACTION_DATE), TEMP2 AS (SELECT DISTINCT ACTION_DATE, COUNT(DISTINCT POST_ID) AS REM_COUNT FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' AND (POST_ID IN (SELECT POST_ID FROM REMOVALS)) GROUP BY ACTION_DATE) SELECT ROUND(AVG(SUB.DAILY_PERCENT), 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT COALESCE( (REM_COUNT / REPORTED_COUNT) * 100, 0) AS DAILY_PERCENT FROM TEMP1 LEFT JOIN TEMP2 USING (ACTION_DATE) ) SUB"
108,Y,Y,"WITH TEMP_DAILY AS(SELECT COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS DAILY_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE) SELECT ROUND(SUM(DAILY_PERCENT)/COUNT(*)*100,2) AS AVERAGE_DAILY_PERCENT FROM TEMP_DAILY"
109,Y,Y,"WITH TMP AS ( SELECT * FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' ) SELECT ROUND(AVG(PERCENT)*100,2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, ((SUM(REMOVED_FLAG)) /(SUM(REPORTED_FLAG))) AS PERCENT FROM ( SELECT A.*, COALESCE(B.REMOVED_FLAG,0) AS REMOVED_FLAG FROM ( SELECT ACTION_DATE, POST_ID, 1 AS REPORTED_FLAG FROM TMP GROUP BY ACTION_DATE, POST_ID )A LEFT JOIN ( SELECT *, 1 AS REMOVED_FLAG FROM REMOVALS )B ON A.POST_ID = B.POST_ID AND A.ACTION_DATE <= B.REMOVE_DATE )T GROUP BY ACTION_DATE )TMP"
110,Y,Y,"WITH TMP AS ( SELECT T1.USER_ID,T1.POST_ID,T1.ACTION_DATE,T1.ACTION,T1.EXTRA,T2.REMOVE_DATE FROM ACTIONS T1 LEFT JOIN REMOVALS T2 ON T1.POST_ID = T2.POST_ID WHERE T1.ACTION = 'REPORT' AND T1.EXTRA = 'SPAM' ) ,CALC AS ( SELECT ACTION_DATE, COALESCE(ROUND((COUNT(DISTINCT CASE WHEN REMOVE_DATE IS NOT NULL THEN POST_ID END)/COUNT( DISTINCT POST_ID))*100,2),0) AS PERCENT FROM TMP GROUP BY ACTION_DATE ) SELECT ROUND(SUM(PERCENT)/COUNT(PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM CALC"
111,Y,Y,"WITH TOTAL AS (SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS TOTAL_SPAM FROM ACTIONS WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE ), REMOVED AS (SELECT ACTION_DATE, COUNT(DISTINCT REMOVALS.POST_ID) AS REMOVED_COUNT FROM ACTIONS JOIN REMOVALS ON ACTIONS.POST_ID = REMOVALS.POST_ID WHERE EXTRA='SPAM' AND REMOVE_DATE IS NOT NULL GROUP BY ACTION_DATE) SELECT ROUND(AVG(100 * IFNULL(REMOVED.REMOVED_COUNT, 0) / TOTAL.TOTAL_SPAM), 2) AS AVERAGE_DAILY_PERCENT FROM REMOVED RIGHT JOIN TOTAL ON REMOVED.ACTION_DATE = TOTAL.ACTION_DATE"
112,Y,Y,"WITH TOTAL AS (SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS TOTAL_COUNT FROM ACTIONS WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE), REMOVED AS (SELECT ACTION_DATE, COUNT(DISTINCT REMOVALS.POST_ID) AS REMOVED_COUNT FROM REMOVALS JOIN ACTIONS ON REMOVALS.POST_ID = ACTIONS.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE) SELECT ROUND(AVG(DAILY_PERCENT)*100, 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT IFNULL(REMOVED_COUNT, 0)/TOTAL_COUNT AS DAILY_PERCENT FROM TOTAL LEFT JOIN REMOVED ON TOTAL.ACTION_DATE = REMOVED.ACTION_DATE GROUP BY TOTAL.ACTION_DATE) T1"
113,Y,Y,"WITH TOTAL AS (SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS TOTAL_COUNT FROM ACTIONS WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE), REMOVED AS (SELECT ACTION_DATE, COUNT(DISTINCT REMOVALS.POST_ID) AS REMOVED_COUNT FROM REMOVALS JOIN ACTIONS ON REMOVALS.POST_ID = ACTIONS.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE) SELECT ROUND(AVG(DAILY_PERCENT)*100, 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT IFNULL(REMOVED_COUNT/TOTAL_COUNT, 0) AS DAILY_PERCENT FROM TOTAL LEFT JOIN REMOVED ON TOTAL.ACTION_DATE = REMOVED.ACTION_DATE GROUP BY TOTAL.ACTION_DATE) T1"
114,Y,Y,"WITH TOTAL_SPAM AS( SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) SPAM_COUNT FROM ACTIONS WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE ), DELETED_SPAM AS ( SELECT A.ACTION_DATE, COALESCE(COUNT(DISTINCT R.POST_ID), 0) DELETED_SPAM_COUNT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ), PCT AS ( SELECT TOTAL_SPAM.ACTION_DATE, ((DELETED_SPAM.DELETED_SPAM_COUNT/TOTAL_SPAM.SPAM_COUNT) * 100) DELETED_SPAM_PCT FROM TOTAL_SPAM JOIN DELETED_SPAM ON TOTAL_SPAM.ACTION_DATE = DELETED_SPAM.ACTION_DATE ) SELECT ROUND(AVG(DELETED_SPAM_PCT), 2) AVERAGE_DAILY_PERCENT FROM PCT"
115,Y,Y,"WITH TP AS (SELECT A.ACTION_DATE, 100.0*SUM(CASE WHEN REMOVE_DATE IS NOT NULL THEN 1 ELSE 0 END)/COUNT(DISTINCT POST_ID) AS PCT_REMOVED FROM (SELECT DISTINCT ACTION_DATE, POST_ID FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA ='SPAM') AS A LEFT JOIN REMOVALS AS R USING(POST_ID) GROUP BY A.ACTION_DATE) SELECT ROUND(AVG(PCT_REMOVED),2) AS AVERAGE_DAILY_PERCENT FROM TP"
116,Y,Y,"WITH DATA_COM AS (SELECT A.POST_ID, ACTION_DATE, EXTRA, REMOVE_DATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA='SPAM'), DATA_DAILY AS (SELECT ACTION_DATE, COUNT(DISTINCT CASE WHEN REMOVE_DATE IS NULL THEN NULL ELSE POST_ID END)/ COUNT(DISTINCT POST_ID)*100 AS DAILY_PERCENT FROM DATA_COM GROUP BY ACTION_DATE) SELECT ROUND(AVG(DAILY_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM DATA_DAILY"
117,Y,Y,"WITH REMOVED AS (SELECT DISTINCT A.ACTION,A.EXTRA,A.POST_ID, A.ACTION_DATE, CASE WHEN ISNULL(B.REMOVE_DATE)=TRUE THEN 0 ELSE 1 END AS REMOVED FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID=B.POST_ID WHERE A.ACTION='REPORT' AND A.EXTRA='SPAM') , AVERAGE AS (SELECT ACTION_DATE, AVG(REMOVED) AS DAY FROM REMOVED GROUP BY ACTION_DATE) SELECT ROUND(AVG(DAY)*100,2) AS AVERAGE_DAILY_PERCENT FROM AVERAGE"
118,Y,Y,"WITH SPAM_REPORT AS (SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS SPAM_COUNT FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY ACTION_DATE), REMOVAL_COUNT AS (SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS REMOVAL_COUNT FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' AND POST_ID IN (SELECT POST_ID FROM REMOVALS) GROUP BY ACTION_DATE ) SELECT ROUND(AVG(IFNULL(B.REMOVAL_COUNT,0)/A.SPAM_COUNT*100),2) AS AVERAGE_DAILY_PERCENT FROM SPAM_REPORT AS A LEFT JOIN REMOVAL_COUNT AS B ON A.ACTION_DATE = B.ACTION_DATE"
119,N,N,"FROM ( SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS DAILY_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE EXTRA='SPAM' GROUP BY A.ACTION_DATE ) T1"
120,Y,Y,"SELECT ROUND(AVG(DAVG)*100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE,(COUNT(DISTINCT CASE WHEN REMOVE_DATE IS NOT NULL THEN POST_ID ELSE NULL END)/COUNT(DISTINCT POST_ID)) AS DAVG FROM (SELECT T1.POST_ID, T1.ACTION_DATE, R.REMOVE_DATE FROM (SELECT POST_ID, ACTION_DATE FROM ACTIONS WHERE EXTRA='SPAM') T1 LEFT JOIN REMOVALS R ON R.POST_ID = T1.POST_ID) T2 GROUP BY ACTION_DATE) T3"
121,Y,Y,"SELECT ROUND(SUM(DAILY_AVG)*100/COUNT(ACTION_DATE),2) AS AVERAGE_DAILY_PERCENT FROM( SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS DAILY_AVG FROM ACTIONS A LEFT JOIN REMOVALS R USING(POST_ID) WHERE EXTRA = 'SPAM' AND ACTION = 'REPORT' GROUP BY ACTION_DATE) AS T1"
122,Y,Y,"SELECT ROUND(AVG (PCT),2) AS AVERAGE_DAILY_PERCENT FROM( SELECT COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100.00 AS PCT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE EXTRA='SPAM' AND ACTION = 'REPORT' GROUP BY A.ACTION_DATE)T"
123,Y,Y,"SELECT ROUND(AVG((CASE WHEN NUM_REMOVE IS NULL THEN 0 ELSE NUM_REMOVE END)/NUM_TOTAL) *100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE,COUNT(DISTINCT POST_ID) AS NUM_TOTAL FROM ACTIONS WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE) AS B LEFT JOIN (SELECT ACTION_DATE, COUNT(DISTINCT A.POST_ID) AS NUM_REMOVE FROM (SELECT * FROM ACTIONS WHERE EXTRA = 'SPAM') AS A JOIN REMOVALS ON A.POST_ID = REMOVALS.POST_ID GROUP BY ACTION_DATE) AS C ON B.ACTION_DATE = C.ACTION_DATE"
124,Y,Y,"SELECT ROUND(AVG(CNT), 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) * 100 AS CNT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ) AS TAB"
125,Y,Y,"SELECT ROUND(AVG(DAILY_PERCENT*100),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT T.ACTION_DATE AS DATE, (COUNT(DISTINCT CASE WHEN REMOVE_DATE IS NOT NULL THEN POST_ID ELSE NULL END)/ COUNT(DISTINCT POST_ID) ) AS DAILY_PERCENT FROM (SELECT A.POST_ID, A.ACTION_DATE, R.REMOVE_DATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA='SPAM') T GROUP BY T.ACTION_DATE) T2"
126,Y,Y,"SELECT ROUND(SUM(DAILY_AVG)/COUNT(DATE)*100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT T.ACTION_DATE AS DATE, (COUNT(DISTINCT CASE WHEN REMOVE_DATE IS NOT NULL THEN POST_ID ELSE NULL END)/COUNT(DISTINCT POST_ID)) AS DAILY_AVG FROM (SELECT A.POST_ID, A.ACTION_DATE, R.REMOVE_DATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA='SPAM') T GROUP BY T.ACTION_DATE) T2"
127,Y,Y,"SELECT ROUND(SUM(PERCENT)/COUNT(DISTINCT ACTION_DATE),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS PERCENT FROM ACTIONS AS A LEFT JOIN REMOVALS AS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE) AS TEMP"
128,Y,Y,"SELECT ROUND(100*AVG(SUB.REMOVALS/SUB.TOTALS),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID) AS REMOVALS, COUNT(DISTINCT A.POST_ID) AS TOTALS FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R. POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY 1) SUB"
129,N,N,"SELECT ACTION_DATE, A.POST_ID AS ACT_POST_ID, COUNT(A.POST_ID) AS ACTIONS_CNT, R.POST_ID AS REM_POST_ID, COUNT(R.POST_ID) AS REMOVALS_CNT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY 1,2) ,CTE2 AS( SELECT SUM(REMOVALS_CNT/ACTIONS_CNT)/COUNT(*)*100 AS DAILY_PERCENT FROM CTE GROUP BY ACTION_DATE) SELECT ROUND(SUM(DAILY_PERCENT)/COUNT(*),2) AS AVERAGE_DAILY_PERCENT FROM CTE2"
130,N,N,"SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS REMOVAL FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY 1) SELECT ROUND(AVG(REMOVAL),2) AS AVERAGE_DAILY_PERCENT FROM CTE"
131,Y,Y,"SELECT DISTINCT ROUND(SUM(C.REMOVE_POST)/COUNT(DISTINCT C.ACTION_DATE)*100, 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT DISTINCT A.ACTION_DATE, B.POSTS/A.POSTS AS REMOVE_POST FROM ( SELECT DISTINCT A.ACTION_DATE, COUNT(DISTINCT A.POST_ID) AS POSTS FROM ACTIONS A WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ) A LEFT JOIN ( SELECT DISTINCT A.ACTION_DATE, COUNT(DISTINCT A.POST_ID) AS POSTS FROM ACTIONS A JOIN REMOVALS B ON A.POST_ID = B.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ) B ON A.ACTION_DATE = B.ACTION_DATE ) C"
132,Y,Y,"SELECT IFNULL(ROUND((SUM(REMOVAL_RATE)/COUNT(ACTION_DATE))*100,2),0) AS AVERAGE_DAILY_PERCENT FROM ( SELECT T.ACTION_DATE, COUNT(DISTINCT REMOVE_POST_ID)/COUNT(DISTINCT POST_ID) AS REMOVAL_RATE FROM ( SELECT A.POST_ID, A.ACTION_DATE, R.REMOVE_DATE, R.POST_ID AS REMOVE_POST_ID FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE A.ACTION='REPORT' AND A.EXTRA='SPAM' ) T GROUP BY 1 ) T2"
133,Y,Y,"SELECT ROUND ( SUM(DAILYPER)/ COUNT(ACTION_DATE), 2) AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, ( COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) ) * 100 DAILYPER FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE ) T"
134,Y,Y,"SELECT ROUND ( SUM(DAILYPER)/ COUNT(ACTION_DATE), 2) AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, ( COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) ) * 100 DAILYPER, 1 AS PERDAY FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE ) T"
135,Y,Y,"SELECT ROUND(100 * AVG(LOCAL_PERCENTAGE), 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT (SUM(CASE WHEN T.SPAM = 'T' THEN 1 ELSE 0 END) / COUNT(*) ) AS LOCAL_PERCENTAGE, T.ACTION_DATE FROM (SELECT DISTINCT ACTIONS.POST_ID, (CASE WHEN REMOVE_DATE IS NULL THEN F ELSE T END) AS SPAM, ACTIONS.ACTION_DATE FROM ACTIONS LEFT JOIN REMOVALS USING(POST_ID) WHERE ACTIONS.ACTION = 'REPORT' AND ACTIONS.EXTRA = 'SPAM' ) AS T GROUP BY T.ACTION_DATE) AS T2"
136,Y,Y,"SELECT ROUND(100*AVG(CNT),2) AVERAGE_DAILY_PERCENT FROM (SELECT COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) CNT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' AND ACTION = 'REPORT' GROUP BY ACTION_DATE) TEMP"
137,Y,Y,"SELECT ROUND(100*AVG(CNT),2) AVERAGE_DAILY_PERCENT FROM (SELECT COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) CNT, ACTION_DATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' AND ACTION = 'REPORT' GROUP BY ACTION_DATE) TEMP"
138,Y,Y,"SELECT ROUND(100*AVG(DAILY_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT IFNULL(COUNT(DISTINCT B.POST_ID), 0)/COUNT(DISTINCT A.POST_ID) AS DAILY_PERCENT FROM (SELECT POST_ID, ACTION_DATE FROM ACTIONS WHERE EXTRA = 'SPAM') A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID GROUP BY A.ACTION_DATE) T1"
139,Y,Y,"SELECT ROUND(100*AVG(DRR.DAILYREMOVALRATE), 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT SUM(IF(R.POST_ID IS NOT NULL, 1, 0)) / COUNT(*) AS DAILYREMOVALRATE FROM (SELECT DISTINCT POST_ID, ACTION_DATE FROM ACTIONS WHERE EXTRA = 'SPAM') AS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID GROUP BY A.ACTION_DATE) AS DRR"
140,Y,Y,"SELECT ROUND(100*AVG(PCT),2) AS AVERAGE_DAILY_PERCENT FROM( SELECT ACTION_DATE, COUNT(DISTINCT B.POST_ID)/COUNT(DISTINCT A.POST_ID) AS PCT FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID=B.POST_ID WHERE EXTRA='SPAM' GROUP BY 1) T"
141,Y,Y,"SELECT ROUND(100*AVG(PERCENTAGE) ,2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) AS PERCENTAGE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY A.ACTION_DATE )_"
142,Y,Y,"SELECT ROUND(100*AVG(PERCENTAGE),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, COUNT(DISTINCT REMOVALS.POST_ID)/COUNT(DISTINCT ACTIONS.POST_ID) AS PERCENTAGE FROM ACTIONS LEFT JOIN REMOVALS ON ACTIONS.POST_ID = REMOVALS.POST_ID WHERE ACTIONS.EXTRA='SPAM' GROUP BY ACTION_DATE )A"
143,Y,Y,"SELECT ROUND(100*AVG(REMOVED_RATE), 2) AS AVERAGE_DAILY_PERCENT FROM( SELECT 1.0*COUNT(DISTINCT CASE WHEN REMOVE_DATE IS NOT NULL THEN A.POST_ID ELSE NULL END) / COUNT(DISTINCT A.POST_ID) AS REMOVED_RATE FROM ( SELECT POST_ID, ACTION_DATE FROM ACTIONS WHERE EXTRA = 'SPAM' ) A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID GROUP BY ACTION_DATE ) B"
144,Y,Y,"SELECT ROUND(AVG(P)*100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(DISTINCT REMOVALS.POST_ID)/COUNT(DISTINCT ACTIONS.POST_ID) AS P FROM ACTIONS LEFT JOIN REMOVALS ON ACTIONS.POST_ID = REMOVALS.POST_ID WHERE ACTIONS.EXTRA = 'SPAM' GROUP BY ACTION_DATE)TEMP"
145,Y,Y,"SELECT ROUND(AVG(BCNT*100/ACNT),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, COUNT(DISTINCT A.POST_ID) AS ACNT, COUNT( DISTINCT B.POST_ID) AS BCNT FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID=B.POST_ID WHERE EXTRA ='SPAM' AND ACTION LIKE REPORT GROUP BY 1 )T"
146,Y,Y,"SELECT ROUND(AVG(A.DELETED/A.SPAM)*100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT B.ACTION_DATE, SUM(CASE WHEN B.EXTRA = 'SPAM' THEN 1 ELSE 0 END) AS SPAM, SUM(CASE WHEN B.EXTRA = 'SPAM' AND B.POST_ID IN (SELECT DISTINCT POST_ID FROM REMOVALS) THEN 1 ELSE 0 END) AS DELETED FROM (SELECT DISTINCT POST_ID, ACTION_DATE, EXTRA FROM ACTIONS) AS B GROUP BY B.ACTION_DATE) AS A"
147,Y,Y,"SELECT ROUND(AVG(A.MEAN),2) AVERAGE_DAILY_PERCENT FROM (SELECT 100*SUM(CASE WHEN ISNULL(B.POST_ID) THEN 0 ELSE 1 END)/COUNT(DISTINCT A.POST_ID) AS MEAN FROM (SELECT DISTINCT POST_ID,ACTION_DATE FROM ACTIONS WHERE EXTRA='SPAM') A LEFT JOIN REMOVALS B ON A.POST_ID=B.POST_ID GROUP BY A.ACTION_DATE) A"
148,Y,Y,"SELECT ROUND(AVG(A.P)*100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(DISTINCT REMOVALS.POST_ID)/COUNT(DISTINCT ACTIONS.POST_ID) AS P FROM ACTIONS LEFT JOIN REMOVALS ON ACTIONS.POST_ID=REMOVALS.POST_ID WHERE EXTRA='SPAM' GROUP BY ACTION_DATE) A"
149,Y,Y,"SELECT ROUND(AVG(A1.RES),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT COUNT(DISTINCT R1.POST_ID) / COUNT(DISTINCT T1.POST_ID) * 100 AS RES FROM (SELECT POST_ID, ACTION_DATE FROM ACTIONS WHERE ACTION='REPORT' AND EXTRA='SPAM') T1 LEFT JOIN REMOVALS R1 ON T1.POST_ID = R1.POST_ID GROUP BY T1.ACTION_DATE ) A1"
150,Y,Y,"SELECT ROUND(AVG(AVERAGE_DAILY_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT 100*COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AVERAGE_DAILY_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE A.EXTRA ='SPAM' AND A.ACTION ='REPORT' GROUP BY A.ACTION_DATE )B"
151,Y,Y,"SELECT ROUND(AVG(AVG_POST),2)AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)/ COUNT(DISTINCT A.POST_ID)*100 AS AVG_POST FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID= R.POST_ID WHERE A.EXTRA='SPAM' GROUP BY ACTION_DATE)A"
152,Y,Y,"SELECT ROUND(AVG(AVGREPORT),2) AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE,ROUND((COALESCE(COUNT(DISTINCT R.POST_ID),0) / COUNT(DISTINCT A.POST_ID))*100,2) AVGREPORT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY 1 )A"
153,Y,Y,"SELECT ROUND(AVG(B.PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID) /COUNT(DISTINCT A.POST_ID)*100 AS PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA ='SPAM' GROUP BY ACTION_DATE) B"
154,Y,Y,"SELECT ROUND(AVG(C.PER),2) AS AVERAGE_DAILY_PERCENT FROM( (SELECT COUNT(B.REMOVE_DATE)/COUNT(DISTINCT A.POST_ID) *100 AS PER FROM (SELECT DISTINCT POST_ID,ACTION_DATE FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA ='SPAM') AS A LEFT JOIN REMOVALS AS B ON A.POST_ID = B.POST_ID GROUP BY A.ACTION_DATE) ) AS C"
155,Y,Y,"SELECT ROUND(AVG(CNT), 2 ) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, (COUNT(DISTINCT R.POST_ID)/ COUNT(DISTINCT A.POST_ID))*100 AS CNT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA='SPAM' AND ACTION = 'REPORT' GROUP BY ACTION_DATE ) A"
156,Y,Y,"SELECT ROUND(AVG(CNT),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT (COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID))*100 AS CNT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY ACTION_DATE) TMP"
157,Y,Y,"SELECT ROUND(AVG(CNT),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT (COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID))*100 AS CNT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY ACTION_DATE) T"
158,Y,Y,"SELECT ROUND(AVG(CNT),2) AS AVERAGE_DAILY_PERCENT FROM( SELECT COUNT(DISTINCT REMOVALS.POST_ID)/COUNT(DISTINCT ACTIONS.POST_ID)*100 AS CNT FROM ACTIONS LEFT JOIN REMOVALS USING(POST_ID) WHERE EXTRA='SPAM' GROUP BY ACTION_DATE) AS T"
159,Y,Y,"SELECT ROUND(AVG(CNTR/CNT)*100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(DISTINCT A.POST_ID) AS CNT, COUNT(DISTINCT R.POST_ID) AS CNTR FROM (SELECT ACTION_DATE, POST_ID FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM') AS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID GROUP BY ACTION_DATE) AS B"
160,Y,Y,"SELECT ROUND(AVG(COUNTS)*100,2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, COUNT(R.POST_ID)/SPAM_COUNTS AS COUNTS FROM (SELECT POST_ID ,ACTION_DATE, COUNT(1) OVER (PARTITION BY ACTION_DATE) AS SPAM_COUNTS FROM ACTIONS WHERE EXTRA = 'SPAM' GROUP BY POST_ID, ACTION_DATE) A LEFT JOIN REMOVALS R ON R.POST_ID = A.POST_ID GROUP BY ACTION_DATE) B"
161,Y,Y,"SELECT ROUND(AVG(CT)* 100,2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) CT,ACTION_DATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE A.EXTRA='SPAM' GROUP BY 2 )T"
162,Y,Y,"SELECT ROUND(AVG(D.PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT C.ACTION_DATE, COUNT(DISTINCT C.POST_ID)AS REMOVALS, COUNT(DISTINCT C.TOTAL) AS SUM_TOTAL, COUNT(DISTINCT C.POST_ID)/ COUNT(DISTINCT C.TOTAL)*100 AS PERCENT FROM (SELECT A.POST_ID AS TOTAL, A.ACTION_DATE, A.EXTRA,B.POST_ID FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID=B.POST_ID WHERE A.EXTRA='SPAM') C GROUP BY 1 )D"
163,Y,Y,"SELECT ROUND(AVG(DAILY),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS DAILY FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE EXTRA='SPAM' GROUP BY 1)TMP"
164,Y,Y,"SELECT ROUND(AVG(DAILY_COUNT) ,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT COUNT(DISTINCT B.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS DAILY_COUNT FROM ACTIONS AS A LEFT JOIN REMOVALS AS B ON A.POST_ID = B.POST_ID WHERE A.EXTRA='SPAM' GROUP BY A.ACTION_DATE) B"
165,Y,Y,"SELECT ROUND(AVG(DAILY_COUNT)*100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS DAILY_COUNT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE EXTRA='SPAM' GROUP BY ACTION_DATE) AS TEMP"
166,Y,Y,"SELECT ROUND(AVG(DAILY_COUNT), 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT COUNT(DISTINCT B.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS DAILY_COUNT FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE ) B"
167,Y,Y,"SELECT ROUND(AVG(DAILY_PERCENT)*100,2) AVERAGE_DAILY_PERCENT FROM (SELECT COUNT(DISTINCT B.POST_ID)/COUNT(DISTINCT A.POST_ID) DAILY_PERCENT FROM (SELECT * FROM ACTIONS WHERE ACTION='REPORT' AND EXTRA='SPAM') A LEFT JOIN REMOVALS B ON A.POST_ID=B.POST_ID GROUP BY ACTION_DATE ) C"
168,Y,Y,"SELECT ROUND(AVG(DAILY_PERCENT), 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, (SUM(REMOVED)*100.0)/COUNT(DISTINCT POST_ID) AS DAILY_PERCENT FROM ( SELECT DISTINCT A.ACTION_DATE, A.POST_ID, CASE WHEN R.POST_ID IS NULL THEN 0 ELSE 1 END AS REMOVED FROM ACTIONS A LEFT JOIN REMOVALS R USING (POST_ID) WHERE EXTRA = 'SPAM' ) X GROUP BY ACTION_DATE ) Y"
169,Y,Y,"SELECT ROUND(AVG(DAILY_PERCENT), 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS DAILY_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA='SPAM' GROUP BY A.ACTION_DATE) TMP"
170,Y,Y,"SELECT ROUND(AVG(DAILY_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, (COUNT(DISTINCT T2.POST_ID)/ COUNT(DISTINCT T1.POST_ID))*100 AS DAILY_PERCENT FROM ACTIONS T1 LEFT JOIN REMOVALS T2 ON T1.POST_ID=T2.POST_ID WHERE EXTRA='SPAM' AND ACTION='REPORT' GROUP BY 1 ) TBL"
171,Y,Y,"SELECT ROUND(AVG(DAILY_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID )*100 AS DAILY_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY 1)A"
172,Y,Y,"SELECT ROUND(AVG(DAILY_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS DAILY_PERCENT FROM ACTIONS AS A LEFT JOIN REMOVALS AS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE) AS SUB_TABLE"
173,Y,Y,"SELECT ROUND(AVG(DAILY_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT COUNT(DISTINCT T.RPOST)*100/COUNT(DISTINCT T.APOST) AS DAILY_PERCENT FROM (SELECT A.USER_ID,A.ACTION_DATE,A.EXTRA,R.POST_ID AS RPOST, A.POST_ID AS APOST FROM ACTIONS A LEFT JOIN REMOVALS R USING(POST_ID) WHERE EXTRA = 'SPAM' ) AS T GROUP BY T.ACTION_DATE)T1"
174,Y,Y,"SELECT ROUND(AVG(DAILY_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ROUND(COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100,2) AS DAILY_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ) AS TMP"
175,Y,Y,"SELECT ROUND(AVG(DAILY_PERCENT*100),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(DISTINCT CASE WHEN R.REMOVE_DATE IS NOT NULL THEN A.POST_ID ELSE NULL END)/COUNT(DISTINCT A.POST_ID) AS DAILY_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY ACTION_DATE) TBL"
176,Y,Y,"SELECT ROUND(AVG(DAILY_PERCENTAGE)*100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE, COUNT(DISTINCT A.POST_ID, R.REMOVE_DATE)/COUNT(DISTINCT A.POST_ID) AS DAILY_PERCENTAGE FROM ACTIONS AS A LEFT JOIN REMOVALS AS R ON R.POST_ID = A.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE)T"
177,Y,Y,"SELECT ROUND(AVG(DAILY_PERCENTAGE),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT COUNT(DISTINCT R.POST_ID) * 100 / COUNT(DISTINCT A.POST_ID) AS DAILY_PERCENTAGE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.ACTION='REPORT' AND A.EXTRA='SPAM' GROUP BY A.ACTION_DATE) TMP"
178,Y,Y,"SELECT ROUND(AVG(DAILY_PERCENTAGE),2) AS AVERAGE_DAILY_PERCENT FROM( SELECT ACTION_DATE, (SUM(CASE WHEN REMOVAL_POST_ID IS NULL THEN 0 ELSE 1 END) / COUNT(*))*100 AS DAILY_PERCENTAGE FROM (SELECT DISTINCT A.POST_ID AS ACTION_POST_ID, A.ACTION_DATE, R.POST_ID AS REMOVAL_POST_ID FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM') A GROUP BY 1 ) B"
179,Y,Y,"SELECT ROUND(AVG(DAILY_REMOVAL) *100,2) AVERAGE_DAILY_PERCENT FROM (SELECT ST.ACTION_DATE, COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT ST.POST_ID) AS DAILY_REMOVAL FROM (SELECT * FROM ACTIONS WHERE EXTRA = 'SPAM') ST LEFT JOIN REMOVALS R ON ST.POST_ID = R.POST_ID GROUP BY ST.ACTION_DATE) TEMP1"
180,Y,Y,"SELECT ROUND(AVG(FINAL_TAB.PERCENT), 2) AVERAGE_DAILY_PERCENT FROM (SELECT T1.ACTION_DATE, ROUND((SUM(CASE WHEN R.POST_ID IS NOT NULL THEN 1 ELSE 0 END)/COUNT(*))*100, 2) PERCENT FROM (SELECT DISTINCT POST_ID, ACTION_DATE FROM ACTIONS WHERE EXTRA = 'SPAM') T1 LEFT JOIN REMOVALS R ON R.POST_ID = T1.POST_ID GROUP BY T1.ACTION_DATE) FINAL_TAB"
181,Y,Y,"SELECT ROUND(AVG(NUM_REMOVED/NUM_REPORT)*100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT COUNT(DISTINCT POST_ID) AS NUM_REPORT, ACTION_DATE, COUNT(DISTINCT CASE WHEN POST_ID IN (SELECT POST_ID FROM REMOVALS) THEN POST_ID ELSE NULL END) AS NUM_REMOVED FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA='SPAM' GROUP BY ACTION_DATE) TMP"
182,Y,Y,"SELECT ROUND(AVG(PCENT),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, SUM(CNT)/SUM(TOTAL)*100 AS PCENT FROM (SELECT A.ACTION_DATE, COUNT(DISTINCT A.POST_ID) AS TOTAL, IFNULL(COUNT(DISTINCT R.POST_ID), 0) AS CNT FROM ACTIONS AS A LEFT JOIN REMOVALS AS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE) AS T GROUP BY ACTION_DATE ) AS P"
183,Y,Y,"SELECT ROUND(AVG(PCT) *100,2) AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) PCT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' GROUP BY 1 ) T"
184,Y,Y,"SELECT ROUND(AVG(PCT) *100,2) AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) PCT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE ) A"
185,Y,Y,"SELECT ROUND(AVG(PCTG)*100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE , COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID ) AS PCTG FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' GROUP BY 1) T"
186,Y,Y,"SELECT ROUND(AVG(PER_DAY)*100.0,2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)*1.0/COUNT(DISTINCT A.POST_ID) AS PER_DAY FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY 1 ) X"
187,Y,Y,"SELECT ROUND(AVG(PERC)*100,2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT A.ACTION_DATE, COUNT(DISTINCT CASE WHEN B.REMOVE_DATE IS NOT NULL THEN A.POST_ID END)/COUNT(DISTINCT A.POST_ID) AS PERC FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID=B.POST_ID WHERE A.EXTRA='SPAM' AND A.ACTION='REPORT' GROUP BY 1 )A"
188,Y,Y,"SELECT ROUND(AVG(PERC),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT 100.0*COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS PERC FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ) DP"
189,Y,Y,"SELECT ROUND(AVG(PERC),2) AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, (COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)) * 100 PERC FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA='SPAM' GROUP BY 1 )A"
190,Y,Y,"SELECT ROUND(AVG(PERC_REMOVED),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)*100/COUNT(DISTINCT A.POST_ID) AS PERC_REMOVED FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE ACTION='REPORT' AND EXTRA='SPAM' GROUP BY 1 ) ABC"
191,Y,Y,"SELECT ROUND(AVG(PERCENT)*100, 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, COUNT(DISTINCT REMOVALS.POST_ID)/ COUNT(DISTINCT ACTIONS.POST_ID) AS PERCENT FROM ACTIONS LEFT JOIN REMOVALS ON ACTIONS.POST_ID = REMOVALS.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE ) A"
192,Y,Y,"SELECT ROUND(AVG(PERCENT)*100,2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE , COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY 1 ) T1"
193,Y,Y,"SELECT ROUND(AVG(PERCENT), 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA='SPAM' GROUP BY 1) TEMP"
194,Y,Y,"SELECT ROUND(AVG(PERCENT_)*100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT( DISTINCT CASE WHEN EXTRA='SPAM' AND POST_ID IN (SELECT POST_ID FROM REMOVALS) THEN (POST_ID) ELSE NULL END) /COUNT( DISTINCT CASE WHEN EXTRA='SPAM' THEN (POST_ID) ELSE NULL END) AS PERCENT_ FROM ACTIONS GROUP BY ACTION_DATE)A"
195,Y,Y,"SELECT ROUND(AVG(PERCENT_)*100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT( DISTINCT CASE WHEN EXTRA='SPAM' AND POST_ID IN (SELECT POST_ID FROM REMOVALS) THEN (POST_ID) ELSE NULL END) /COUNT( DISTINCT CASE WHEN EXTRA='SPAM' THEN (POST_ID) ELSE NULL END) AS PERCENT_ FROM ACTIONS GROUP BY ACTION_DATE)A WHERE PERCENT_ IS NOT NULL"
196,Y,Y,"SELECT ROUND(AVG(PERCENT_REMOVAL),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT REMOVE_DATE, ( COUNT(DISTINCT R.POST_ID)/ COUNT(DISTINCT A.POST_ID)*100) AS PERCENT_REMOVAL FROM ACTIONS A LEFT JOIN REMOVALS R ON R.POST_ID = A.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY ACTION_DATE)A"
197,Y,Y,"SELECT ROUND(AVG(PERCENTAGE)*100, 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*1.0 AS PERCENTAGE FROM ACTIONS A LEFT JOIN REMOVALS R USING (POST_ID) WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY 1 ) A"
198,Y,Y,"SELECT ROUND(AVG(PERCENTAGE)*100,2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, SUM(CASE WHEN REMOVE_DATE IS NOT NULL THEN 1 ELSE 0 END)/COUNT(POST_ID) AS PERCENTAGE FROM ( SELECT DISTINCT ACTION_DATE, A.POST_ID, R.REMOVE_DATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM') AS A GROUP BY ACTION_DATE ) AS B"
199,Y,Y,"SELECT ROUND(AVG(PERCENTAGE),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, SUM(CASE WHEN REMOVE_DATE IS NOT NULL THEN 1 ELSE 0 END) / COUNT(1)*100 AS PERCENTAGE FROM (SELECT DISTINCT POST_ID, ACTION_DATE FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM')A LEFT JOIN REMOVALS B ON A.ACTION_DATE < B.REMOVE_DATE AND A.POST_ID = B.POST_ID GROUP BY ACTION_DATE)C"
200,Y,Y,"SELECT ROUND(AVG(PTG),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, 100.0 * COUNT(DISTINCT REMOVALS.POST_ID) / COUNT(DISTINCT ACTIONS.POST_ID) AS PTG FROM ACTIONS LEFT JOIN REMOVALS ON ACTIONS.POST_ID = REMOVALS.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY ACTION_DATE ) TMP"
201,Y,Y,"SELECT ROUND(AVG(R)*100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, AVG(CASE WHEN B.POST_ID IS NULL THEN 0 ELSE 1 END) AS R FROM (SELECT DISTINCT ACTION_DATE, POST_ID FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA='SPAM') A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID GROUP BY 1) K"
202,Y,Y,"SELECT ROUND(AVG(R_CNT/SPAM_CNT*100),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, COUNT(DISTINCT A.POST_ID) AS SPAM_CNT, COUNT(DISTINCT R.POST_ID) AS R_CNT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE A.EXTRA='SPAM' GROUP BY 1)X"
203,Y,Y,"SELECT ROUND(AVG(RATE) * 100, 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT (COUNT(REMOVE_DATE) / COUNT(EXTRA)) AS RATE FROM (SELECT DISTINCT ACTIONS.POST_ID, ACTION_DATE, EXTRA, REMOVALS.REMOVE_DATE FROM ACTIONS LEFT JOIN REMOVALS ON ACTIONS.POST_ID = REMOVALS.POST_ID WHERE EXTRA = 'SPAM') AS TMP1 GROUP BY ACTION_DATE) AS TMP2"
204,Y,Y,"SELECT ROUND(AVG(RATE), 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) * 100 AS RATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE) A1"
205,Y,Y,"SELECT ROUND(AVG(RATE), 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) * 100 AS RATE FROM ACTIONS A LEFT OUTER JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE) A1"
206,Y,Y,"SELECT ROUND(AVG(RATE), 2) AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, 100*COUNT(DISTINCT B.POST_ID) / COUNT(DISTINCT A.POST_ID) RATE FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID WHERE A.ACTION='REPORT' AND A.EXTRA='SPAM' GROUP BY ACTION_DATE) A"
207,Y,Y,"SELECT ROUND(AVG(RATE),2) AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, 100*COUNT(DISTINCT B.POST_ID) / COUNT(DISTINCT A.POST_ID) RATE FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID WHERE ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY ACTION_DATE) A"
208,Y,Y,"SELECT ROUND(AVG(RATIO),2) AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, (COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID)) * 100 RATIO FROM ACTIONS A LEFT OUTER JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE)A"
209,Y,Y,"SELECT ROUND(AVG(REMOVAL),2) AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE,COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) *100 AS REMOVAL FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE) A"
210,Y,Y,"SELECT ROUND(AVG(REMOVAL/REPORT)*100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(DISTINCT A.POST_ID) AS REPORT , COUNT(DISTINCT R.POST_ID) AS REMOVAL FROM ACTIONS A LEFT JOIN REMOVALS R ON R.POST_ID = A.POST_ID WHERE EXTRA = 'SPAM' AND A.ACTION = 'REPORT' GROUP BY 1) TEMP"
211,Y,Y,"SELECT ROUND(AVG(REMOVAL_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.POST_ID, COUNT(DISTINCT R.POST_ID) /COUNT(DISTINCT A.POST_ID) *100 AS REMOVAL_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE A.ACTION='REPORT' AND A.EXTRA='SPAM' GROUP BY A.ACTION_DATE) T"
212,Y,Y,"SELECT ROUND(AVG(REMOVAL_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM( SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID) /COUNT(DISTINCT A.POST_ID) * 100 AS REMOVAL_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R USING (POST_ID) WHERE A.EXTRA = 'SPAM' GROUP BY ACTION_DATE) X"
213,Y,Y,"SELECT ROUND(AVG(REMOVAL_RATE)*100,2) AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, COUNT(DISTINCT B.POST_ID)/COUNT(DISTINCT A.POST_ID) REMOVAL_RATE FROM ACTIONS A LEFT JOIN REMOVALS B USING (POST_ID) WHERE ACTION ='REPORT' AND EXTRA ='SPAM' GROUP BY 1 ) T"
214,Y,Y,"SELECT ROUND(AVG(REMOVALS/REPORTED*100),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE, COUNT(DISTINCT A.POST_ID) AS REPORTED,COUNT(DISTINCT R.POST_ID) AS REMOVALS FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE A.EXTRA='SPAM' GROUP BY 1) TMP"
215,Y,Y,"SELECT ROUND(AVG(REMOVE_PCT)*100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS REMOVE_PCT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID AND A.ACTION_DATE < R.REMOVE_DATE WHERE ACTION ='REPORT' AND EXTRA = 'SPAM' GROUP BY ACTION_DATE ) TMP"
216,Y,Y,"SELECT ROUND(AVG(REMOVE_RATE)*100, 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE, SUM(CASE WHEN R.POST_ID IS NOT NULL THEN 1 ELSE 0 END)/COUNT(*) AS REMOVE_RATE FROM (SELECT DISTINCT ACTION_DATE, POST_ID FROM ACTIONS WHERE EXTRA = 'SPAM') AS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID GROUP BY A.ACTION_DATE) AS TEMP"
217,Y,Y,"SELECT ROUND(AVG(REMOVED/SPAM)*100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE, COUNT(DISTINCT A.POST_ID) AS SPAM, COUNT(DISTINCT R.POST_ID) AS REMOVED FROM ACTIONS AS A LEFT JOIN REMOVALS AS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY 1 ) AS TMP"
218,Y,Y,"SELECT ROUND(AVG(REMOVED_SPAM),2) AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, (COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID)) * 100 REMOVED_SPAM FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.ACTION='REPORT' AND A.EXTRA ='SPAM' GROUP BY A.ACTION_DATE)A"
219,Y,Y,"SELECT ROUND(AVG(REMOVED_SPAM),2) AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, (COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID)) * 100 REMOVED_SPAM FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA ='SPAM' GROUP BY ACTION_DATE)A"
220,Y,Y,"SELECT ROUND(AVG(RES), 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT (COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID))*100 AS RES FROM ACTIONS AS A LEFT JOIN REMOVALS AS R ON A.POST_ID = R.POST_ID WHERE EXTRA='SPAM' GROUP BY ACTION_DATE)TMP"
221,Y,Y,"SELECT ROUND(AVG(RNK), 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT A.ACTION_DATE,(COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID))*100 AS RNK FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE A.ACTION='REPORT' AND A.EXTRA='SPAM' GROUP BY A.ACTION_DATE ) AS TEMP"
222,Y,Y,"SELECT ROUND(AVG(RR*100),2) AS AVERAGE_DAILY_PERCENT FROM( SELECT COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS RR FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE) T"
223,Y,Y,"SELECT ROUND(AVG(T.DAILY_RATIO*100 ),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT COUNT(DISTINCT IF(POST_ID IN (SELECT C.POST_ID FROM REMOVALS C) , A.POST_ID ,NULL))/COUNT(DISTINCT A.POST_ID) AS DAILY_RATIO FROM ACTIONS A WHERE A.ACTION='REPORT' AND A.EXTRA='SPAM' GROUP BY ACTION_DATE ) T"
224,Y,Y,"SELECT ROUND(AVG(T.RATIO) *100, 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE, COUNT(R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS RATIO FROM (SELECT DISTINCT ACTION_DATE, POST_ID FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM') A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID GROUP BY 1) T"
225,Y,Y,"SELECT ROUND(AVG(TC2*100/TC1),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE,COUNT(DISTINCT T1ID) AS TC1,COUNT(DISTINCT T2ID) AS TC2 FROM (SELECT T1.POST_ID AS T1ID,ACTION_DATE,T2.POST_ID AS T2ID FROM ACTIONS T1 LEFT JOIN REMOVALS T2 ON T1.POST_ID = T2.POST_ID WHERE ACTION = 'REPORT' AND EXTRA= 'SPAM') T3 GROUP BY ACTION_DATE) T4"
226,Y,Y,"SELECT ROUND(AVG(TMP)*100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, AVG(CASE WHEN REMOVE_DATE IS NOT NULL THEN 1 ELSE 0 END) AS TMP FROM (SELECT T.POST_ID, ACTION_DATE, COUNT_S, REMOVE_DATE FROM (SELECT POST_ID, ACTION_DATE, SUM(CASE WHEN EXTRA = 'SPAM' THEN 1 ELSE 0 END) AS COUNT_S FROM ACTIONS GROUP BY ACTION_DATE, POST_ID) AS T LEFT JOIN REMOVALS ON REMOVALS.POST_ID = T.POST_ID WHERE COUNT_S>0) AS T2 GROUP BY ACTION_DATE) AS T3"
227,Y,Y,"SELECT ROUND(IFNULL(AVG(CNT1*100/CNT),0),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(POST_ID) AS CNT, COUNT(CASE WHEN REMOVE_DATE IS NOT NULL THEN POST_ID ELSE NULL END) AS CNT1 FROM (SELECT DISTINCT A.POST_ID, ACTION_DATE, EXTRA, R.REMOVE_DATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM') A GROUP BY ACTION_DATE) B"
228,Y,Y,"SELECT ROUND(SUM(100 * P) / COUNT(ACTION_DATE), 2) AS AVERAGE_DAILY_PERCENT FROM( SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) AS P FROM ACTIONS AS A LEFT OUTER JOIN REMOVALS AS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE) AS TMP"
229,Y,Y,"SELECT ROUND(SUM(100 * P) / COUNT(DISTINCT ACTION_DATE), 2) AS AVERAGE_DAILY_PERCENT FROM( SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) AS P FROM ACTIONS AS A LEFT OUTER JOIN REMOVALS AS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE) AS TMP"
230,Y,Y,"SELECT ROUND(SUM(PCT)/ COUNT(ACTION_DATE) ,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, SUM(REMOVED_YN)/COUNT(*)*100 AS PCT FROM (SELECT A.POST_ID, A.ACTION_DATE, CASE WHEN B.POST_ID IS NOT NULL THEN 1 ELSE 0 END AS REMOVED_YN FROM (SELECT DISTINCT POST_ID, ACTION_DATE, EXTRA FROM ACTIONS WHERE EXTRA = 'SPAM') A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID ) C GROUP BY ACTION_DATE) D"
231,Y,Y,"SELECT ROUND(SUM(PCTG)/COUNT(DISTINCT ACTION_DATE)*100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE , COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID ) AS PCTG FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' GROUP BY 1) T"
232,Y,Y,"SELECT ROUND(SUM(PERCENT)/COUNT(DISTINCT ACTION_DATE), 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, (COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)) * 100 AS PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA='SPAM' GROUP BY ACTION_DATE) DSF"
233,Y,Y,"SELECT ROUND(SUM(PERCENT)/COUNT(DISTINCT ACTION_DATE),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/ COUNT(DISTINCT A.POST_ID) * 100 PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON R.POST_ID = A.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY 1) TEMP"
234,Y,Y,"SELECT ROUND(SUM(PERCENT)/COUNT(DISTINCT ACTION_DATE),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA='SPAM' GROUP BY 1) A"
235,Y,Y,"SELECT ROUND(SUM(PERCENT)/COUNT(DISTINCT ACTION_DATE),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA='SPAM' GROUP BY 1) SUB"
236,Y,Y,"SELECT ROUND(SUM(PERCENT)/COUNT(DISTINCT ACTION_DATE),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA='SPAM' GROUP BY 1) TEMP"
237,Y,Y,"SELECT ROUND(SUM(PERCENT)/COUNT(DISTINCT ACTION_DATE),2) AS AVERAGE_DAILY_PERCENT FROM( SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID)*100 AS PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY ACTION_DATE )B"
238,Y,Y,"SELECT ROUND(SUM(PERCENT)/COUNT(DISTINCT D),2) AS AVERAGE_DAILY_PERCENT FROM (WITH SPAMS AS (SELECT * FROM ACTIONS A WHERE A.EXTRA='SPAM') SELECT S.ACTION_DATE AS D, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT S.POST_ID)*100 AS PERCENT FROM SPAMS S LEFT JOIN REMOVALS R ON S.POST_ID=R.POST_ID GROUP BY D) TEMP"
239,Y,Y,"SELECT ROUND(SUM(PERCENT)/COUNT(PERCENT) * 100, 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT COUNT(REMOVAL_POST)/COUNT(ACTION_POST) AS PERCENT FROM ( SELECT DISTINCT A.POST_ID AS ACTION_POST,R.POST_ID AS REMOVAL_POST, A.ACTION_DATE AS ACTION_DATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' ) AS TEMP GROUP BY ACTION_DATE ) AS PERCENT_TAB"
240,Y,Y,"SELECT ROUND(SUM(PERCENTAGE) / COUNT(DISTINCT ACTION_DATE), 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) * 100 AS PERCENTAGE FROM ACTIONS A LEFT JOIN REMOVALS R ON R.POST_ID = A.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY 1 ) TB"
241,Y,Y,"SELECT ROUND(SUM(PERCENTAGE)/COUNT(DISTINCT ACTION_DATE) *100, 2) AS AVERAGE_DAILY_PERCENT FROM(SELECT ACTION_DATE, COUNT(DISTINCT CASE WHEN REMOVED_POST IS NOT NULL THEN REMOVED_POST END)/COUNT(DISTINCT REPORT_POST) AS PERCENTAGE FROM(SELECT X.POST_ID AS REPORT_POST, Y.POST_ID AS REMOVED_POST, X.ACTION_DATE FROM(SELECT POST_ID, ACTION_DATE, EXTRA FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM')X LEFT JOIN REMOVALS Y ON X.POST_ID = Y.POST_ID) Y GROUP BY ACTION_DATE) Z"
242,Y,Y,"SELECT ROUND(SUM(PERCENTAGE_DAILY)/COUNT(ACTION_DATE)*100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE, (COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)) AS PERCENTAGE_DAILY FROM (SELECT * FROM ACTIONS WHERE EXTRA='SPAM') A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID GROUP BY A.ACTION_DATE) B"
243,Y,Y,"SELECT ROUND(SUM(PERCENTAGE_DAILY)/COUNT(DISTINCT ACTION_DATE)*100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE, (COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)) AS PERCENTAGE_DAILY FROM (SELECT * FROM ACTIONS WHERE EXTRA='SPAM') A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID GROUP BY A.ACTION_DATE) B"
244,Y,Y,"SELECT ROUND(SUM(RATIO) * 100 / COUNT(ACTION_DATE),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT C.ACTION_DATE, COUNT(DISTINCT C.R_POST_ID) / COUNT(DISTINCT C.POST_ID) AS RATIO FROM (SELECT A.ACTION_DATE, A.POST_ID, A.EXTRA, B.POST_ID AS R_POST_ID FROM ACTIONS A LEFT OUTER JOIN REMOVALS B ON A.POST_ID = B.POST_ID WHERE EXTRA = 'SPAM') C GROUP BY C.ACTION_DATE ) D"
245,Y,Y,"SELECT ROUND(SUM(REMOVAL_RATE) / COUNT(*) * 100, 2) AS AVERAGE_DAILY_PERCENT FROM( SELECT A.ACTION_DATE , SUM(CASE WHEN R.REMOVE_DATE IS NOT NULL THEN 1 ELSE 0 END) / COUNT(*) AS REMOVAL_RATE FROM( SELECT DISTINCT POST_ID, ACTION_DATE FROM ACTIONS WHERE EXTRA = 'SPAM' ) AS A LEFT JOIN REMOVALS AS R ON R.POST_ID = A.POST_ID GROUP BY A.ACTION_DATE ) AS TMP"
246,Y,Y,"SELECT ROUND(SUM(SUM_ACT)/COUNT(DISTINCT ACTION_DATE)*100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE, COUNT(DISTINCT B.POST_ID)/COUNT(DISTINCT A.POST_ID) AS SUM_ACT FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID=B.POST_ID WHERE EXTRA='SPAM' GROUP BY 1)T"
247,Y,Y,"WITH A AS( SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS SPAM_NUM FROM ACTIONS WHERE ACTION='REPORT' AND EXTRA = 'SPAM' GROUP BY 1 ), B AS( SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS SPAM_NUM FROM ACTIONS WHERE ACTION='REPORT' AND EXTRA = 'SPAM' AND POST_ID NOT IN (SELECT POST_ID FROM REMOVALS) GROUP BY 1 ) SELECT ROUND(AVG(IF(B.SPAM_NUM IS NULL, A.SPAM_NUM,A.SPAM_NUM-B.SPAM_NUM)/A.SPAM_NUM)*100,2) AS AVERAGE_DAILY_PERCENT FROM A LEFT JOIN B ON A.ACTION_DATE = B.ACTION_DATE"
248,Y,Y,"WITH A AS( SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS SPAM_NUM FROM ACTIONS WHERE ACTION='REPORT' AND EXTRA = 'SPAM' GROUP BY 1 ), B AS( SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS SPAM_NUM FROM ACTIONS WHERE EXTRA = 'SPAM' AND POST_ID NOT IN (SELECT POST_ID FROM REMOVALS) GROUP BY 1 ) SELECT ROUND(AVG(IF(B.SPAM_NUM IS NULL, A.SPAM_NUM,A.SPAM_NUM-B.SPAM_NUM)/A.SPAM_NUM)*100,2) AS AVERAGE_DAILY_PERCENT FROM A LEFT JOIN B ON A.ACTION_DATE = B.ACTION_DATE"
249,Y,Y,"WITH A AS( SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS SPAM_NUM FROM ACTIONS WHERE EXTRA = 'SPAM' GROUP BY 1 ), B AS( SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS SPAM_NUM FROM ACTIONS WHERE EXTRA = 'SPAM' AND POST_ID NOT IN (SELECT POST_ID FROM REMOVALS) GROUP BY 1 ) SELECT ROUND(AVG(IF(B.SPAM_NUM IS NULL, A.SPAM_NUM,A.SPAM_NUM-B.SPAM_NUM)/A.SPAM_NUM)*100,2) AS AVERAGE_DAILY_PERCENT FROM A LEFT JOIN B ON A.ACTION_DATE = B.ACTION_DATE"
250,Y,Y,"WITH DAILYREMOVAL AS( SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS RATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA='SPAM' GROUP BY ACTION_DATE ) SELECT ROUND(AVG(RATE), 2) AS AVERAGE_DAILY_PERCENT FROM DAILYREMOVAL"
251,Y,Y,"WITH A AS ( SELECT ACTION_DATE, A.POST_ID, ROUND(COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100,2) AS P FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY 1 ORDER BY 1) SELECT ROUND(SUM(P)/COUNT(DISTINCT ACTION_DATE),2) AS AVERAGE_DAILY_PERCENT FROM A"
252,Y,Y,"WITH A AS ( SELECT DISTINCT POST_ID, ACTION_DATE FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA='SPAM'), B AS( SELECT A.POST_ID , A.ACTION_DATE , R.REMOVE_DATE FROM A LEFT JOIN REMOVALS AS R ON A.POST_ID=R.POST_ID), C AS ( SELECT ACTION_DATE , SUM(IF(REMOVE_DATE IS NULL, 0, 1)) AS NUM_REMOVE , COUNT(DISTINCT POST_ID) AS NUM_POSTS FROM B GROUP BY ACTION_DATE) SELECT ROUND(100*AVG(NUM_REMOVE/NUM_POSTS), 2) AS AVERAGE_DAILY_PERCENT FROM C"
253,Y,Y,"WITH A AS (SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS SPAM_COUNT FROM ACTIONS WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE), B AS (SELECT ACTION_DATE, REMOVE_DATE, COUNT(DISTINCT R.POST_ID) AS REMOVE_COUNT FROM ACTIONS AS A LEFT JOIN REMOVALS AS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE) SELECT ROUND((AVG(B.REMOVE_COUNT/A.SPAM_COUNT))*100, 2) AS AVERAGE_DAILY_PERCENT FROM B JOIN A ON A.ACTION_DATE = B.ACTION_DATE"
254,Y,Y,"WITH A AS (SELECT COUNT(DISTINCT T2.POST_ID)/COUNT(DISTINCT T1.POST_ID) AS PERCENTAGE FROM ACTIONS T1 LEFT JOIN REMOVALS T2 ON T2.POST_ID=T1.POST_ID WHERE EXTRA LIKE SPAM GROUP BY ACTION_DATE) SELECT ROUND(AVG(PERCENTAGE)*100,2) AS AVERAGE_DAILY_PERCENT FROM A"
255,Y,Y,"WITH ACTION_REMOVAL AS (SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS FREQ FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE) SELECT ROUND(SUM(FREQ)*100 / COUNT(FREQ),2) AS AVERAGE_DAILY_PERCENT FROM ACTION_REMOVAL"
256,Y,Y,"WITH ACTIONS AS (SELECT COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS CNT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE) SELECT ROUND(AVG(CNT),2) AS AVERAGE_DAILY_PERCENT FROM ACTIONS"
257,Y,Y,"WITH ACTIONS AS (SELECT DISTINCT POST_ID, ACTION_DATE, ACTION, EXTRA FROM ACTIONS), REMOVALS AS (SELECT DISTINCT POST_ID, REMOVE_DATE FROM REMOVALS), CTE AS (SELECT A.ACTION_DATE, SUM(CASE WHEN R.REMOVE_DATE IS NOT NULL THEN 1 ELSE 0 END) AS REMOVALS_COUNT, COUNT(A.POST_ID) AS SPAM_REPORTS_COUNT FROM ACTIONS AS A LEFT JOIN REMOVALS AS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ORDER BY A.ACTION_DATE ASC) SELECT ROUND(AVG(REMOVALS_COUNT / SPAM_REPORTS_COUNT) * 100, 2) AS AVERAGE_DAILY_PERCENT FROM CTE"
258,Y,Y,"WITH ALL_TABLE AS ( SELECT DISTINCT ACTIONS.POST_ID, ACTION_DATE, EXTRA, REMOVE_DATE FROM ACTIONS LEFT JOIN REMOVALS ON ACTIONS.POST_ID = REMOVALS.POST_ID) SELECT ROUND(AVG(RATE) * 100, 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT (COUNT(REMOVE_DATE) / COUNT(EXTRA)) AS RATE, ACTION_DATE FROM ALL_TABLE WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE) AS TMP1"
259,Y,Y,"WITH B AS (SELECT DISTINCT A.ACTION_DATE, SUM(IF(R.POST_ID IS NOT NULL,1,0))/COUNT(A.ACTION_DATE) AS PERC FROM (SELECT DISTINCT ACTION_DATE, POST_ID, ACTION, EXTRA FROM ACTIONS) AS A LEFT JOIN REMOVALS AS R ON R.POST_ID = A.POST_ID AND R.REMOVE_DATE >= A.ACTION_DATE WHERE ACTION='REPORT' AND EXTRA='SPAM' GROUP BY ACTION_DATE) SELECT ROUND(AVG(PERC)*100,2) AS AVERAGE_DAILY_PERCENT FROM B"
260,Y,Y,"WITH COUNT AS ( SELECT COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) AS DAILY_AVG FROM ACTIONS A LEFT JOIN REMOVALS R USING(POST_ID) WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY ACTION_DATE) SELECT ROUND(AVG(DAILY_AVG)*100, 2) AS AVERAGE_DAILY_PERCENT FROM COUNT"
261,Y,Y,"WITH CTE AS( SELECT ACTION_DATE, COUNT(DISTINCT A.POST_ID) AS NUM_SPAM, COUNT(DISTINCT R.POST_ID) AS NUM_REMOVE FROM ACTIONS A LEFT JOIN REMOVALS R USING (POST_ID) WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE ) SELECT ROUND(AVG(NUM_REMOVE / NUM_SPAM)*100,2) AS AVERAGE_DAILY_PERCENT FROM CTE"
262,Y,Y,"WITH CTE AS ( SELECT * FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' ) SELECT ROUND(SUM(PCT) / COUNT(DISTINCT ACTION_DATE), 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT C.ACTION_DATE, COUNT(DISTINCT R.POST_ID) * 100 / COUNT(DISTINCT C.POST_ID) AS PCT FROM CTE C LEFT JOIN REMOVALS R ON C.POST_ID = R.POST_ID GROUP BY C.ACTION_DATE ) TMP"
263,Y,Y,"WITH CTE AS ( SELECT A.ACTION_DATE , COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE A.ACTION='REPORT' AND A.EXTRA='SPAM' GROUP BY 1) SELECT ROUND(AVG(PERCENT)*100,2) AS AVERAGE_DAILY_PERCENT FROM CTE"
264,Y,Y,"WITH CTE AS ( SELECT A.POST_ID, A.ACTION_DATE, B.REMOVE_DATE FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID WHERE EXTRA = 'SPAM' GROUP BY A.POST_ID, A.ACTION_DATE) SELECT ROUND(AVG(PERCENT)*100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, SUM(CASE WHEN REMOVE_DATE IS NOT NULL THEN 1 ELSE 0 END)/ COUNT(POST_ID) AS PERCENT FROM CTE GROUP BY ACTION_DATE) E"
265,Y,Y,"WITH CTE AS ( SELECT A.POST_ID, A.ACTION_DATE, R.REMOVE_DATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM'), CTE2 AS ( SELECT ACTION_DATE, (COUNT(DISTINCT CASE WHEN REMOVE_DATE IS NOT NULL THEN POST_ID ELSE NULL END)/COUNT(DISTINCT POST_ID)) AS DAILY_AVERAGE FROM CTE GROUP BY ACTION_DATE ) SELECT ROUND(SUM(DAILY_AVERAGE)/COUNT(ACTION_DATE)*100,2) AS AVERAGE_DAILY_PERCENT FROM CTE2"
266,Y,Y,"WITH CTE AS ( SELECT A.POST_ID, ACTION_DATE, REMOVE_DATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' GROUP BY 1,2 ), CTE2 AS ( SELECT ROUND(SUM(CASE WHEN REMOVE_DATE IS NOT NULL THEN 1 ELSE 0 END)*100/COUNT(*),2) AS DAILY_PER FROM CTE GROUP BY ACTION_DATE) SELECT ROUND(AVG(DAILY_PER),2) AS AVERAGE_DAILY_PERCENT FROM CTE2"
267,Y,Y,"WITH CTE AS ( SELECT ACTION_DATE, AVG(IF(ISNULL(R.REMOVE_DATE),0,1))*100 AS RE FROM (SELECT DISTINCT POST_ID, ACTION_DATE, EXTRA FROM ACTIONS) A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID AND A.EXTRA='SPAM' WHERE A.EXTRA = 'SPAM' GROUP BY ACTION_DATE ) SELECT ROUND(AVG(RE),2) AS AVERAGE_DAILY_PERCENT FROM CTE"
268,Y,Y,"WITH CTE AS ( SELECT ACTION_DATE, COUNT(DISTINCT B.POST_ID)/COUNT(DISTINCT A.POST_ID) * 100 AS ABS FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID=B.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY ACTION_DATE ) SELECT ROUND(AVG(ABS),2) AS AVERAGE_DAILY_PERCENT FROM CTE"
269,Y,Y,"WITH CTE AS ( SELECT ACTION_DATE, POST_ID, COUNT(DISTINCT POST_ID) AS CNT FROM ACTIONS WHERE EXTRA = 'SPAM' GROUP BY 1,2) ,CTE2 AS( SELECT COUNT(R.POST_ID)/SUM(CNT)*100 AS PCT FROM CTE LEFT JOIN REMOVALS R ON R.POST_ID = CTE.POST_ID GROUP BY ACTION_DATE) SELECT ROUND(SUM(PCT)/COUNT(PCT),2) AVERAGE_DAILY_PERCENT FROM CTE2"
270,Y,Y,"WITH CTE AS ( SELECT DISTINCT ACTIONS.POST_ID AS A_ID, ACTION_DATE, REMOVALS.POST_ID AS R_ID FROM ACTIONS LEFT JOIN REMOVALS ON ACTIONS.POST_ID = REMOVALS.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' ), CTE2 AS ( SELECT ACTION_DATE, COUNT(R_ID)/COUNT(A_ID) AS PERCENT FROM CTE GROUP BY ACTION_DATE ) SELECT ROUND(AVG(PERCENT)*100,2) AS AVERAGE_DAILY_PERCENT FROM CTE2"
271,Y,Y,"WITH CTE AS ( SELECT DISTINCT ACTIONS.POST_ID AS A_ID, ACTION_DATE, REMOVALS.POST_ID AS R_ID FROM ACTIONS LEFT JOIN REMOVALS ON ACTIONS.POST_ID = REMOVALS.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' ), CTE2 AS ( SELECT ACTION_DATE, SUM(CASE WHEN R_ID IS NULL THEN 0 ELSE 1 END)/COUNT(CASE WHEN R_ID IS NULL THEN 0 ELSE 1 END) AS PERCENT FROM CTE GROUP BY ACTION_DATE ) SELECT ROUND(AVG(PERCENT)*100,2) AS AVERAGE_DAILY_PERCENT FROM CTE2"
272,Y,Y,"WITH CTE AS ( SELECT DISTINCT A.POST_ID, A.ACTION_DATE, R.REMOVE_DATE FROM ACTIONS A LEFT JOIN REMOVALS R ON R.POST_ID = A.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' ), CTE2 AS ( SELECT CTE.ACTION_DATE, COUNT(CASE WHEN CTE.REMOVE_DATE IS NOT NULL THEN 1 ELSE NULL END) AS DELCNT, COUNT(CTE.POST_ID) AS SPMCNT FROM CTE GROUP BY 1) SELECT ROUND(SUM(CTE2.DELCNT / CTE2.SPMCNT)/COUNT(CTE2.ACTION_DATE)*100,2) AS AVERAGE_DAILY_PERCENT FROM CTE2"
273,Y,Y,"WITH CTE AS ( SELECT DISTINCT ACTION_DATE, POST_ID, ACTION, EXTRA FROM ACTIONS ) SELECT ROUND(100 * AVG(REMOVE_COUNT / TOTAL_COUNT), 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, COUNT(A.POST_ID) AS TOTAL_COUNT, COUNT(R.POST_ID) AS REMOVE_COUNT FROM CTE A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID AND A.ACTION_DATE <= R.REMOVE_DATE WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY ACTION_DATE )FT"
274,Y,Y,"WITH CTE AS ( SELECT DISTINCT POST_ID, ACTION_DATE FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' ), CTE2 AS ( SELECT ROUND(COUNT(R.POST_ID)/COUNT(CTE.POST_ID) * 100, 2) AS AVERAGE_DAILY_PERCENT FROM CTE LEFT JOIN REMOVALS R ON CTE.POST_ID = R.POST_ID GROUP BY CTE.ACTION_DATE ) SELECT ROUND(AVG(AVERAGE_DAILY_PERCENT), 2) AS AVERAGE_DAILY_PERCENT FROM CTE2"
275,Y,Y,"WITH CTE AS ( SELECT F.POST_ID, F.ACTION_DATE, R.POST_ID REMOVE_ID FROM ( SELECT POST_ID, ACTION_DATE FROM ACTIONS WHERE EXTRA = 'SPAM') F LEFT JOIN REMOVALS R ON F.POST_ID = R.POST_ID AND F.ACTION_DATE < R.REMOVE_DATE ) SELECT ROUND(AVG(PERC) * 100, 2) AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, COUNT(DISTINCT REMOVE_ID) / COUNT(DISTINCT POST_ID) PERC FROM CTE GROUP BY 1) CTE1"
276,Y,Y,"WITH CTE AS (SELECT POST_ID, ACTION_DATE FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM') SELECT ROUND(AVG(PNT),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT CTE.ACTION_DATE, COUNT(DISTINCT R.POST_ID)*100/COUNT(DISTINCT CTE.POST_ID) AS PNT FROM CTE LEFT JOIN REMOVALS R ON CTE.POST_ID = R.POST_ID GROUP BY CTE.ACTION_DATE) AS A"
277,Y,Y,"WITH CTE AS (SELECT DISTINCT POST_ID,ACTION_DATE FROM ACTIONS WHERE EXTRA='SPAM'), CTE2 AS (SELECT POST_ID,ACTION_DATE,CASE WHEN POST_ID IN (SELECT POST_ID FROM REMOVALS) THEN 1 ELSE 0 END AS CNT FROM CTE), CTE3 AS(SELECT *,SUM(CNT)/COUNT(POST_ID) AS PCT FROM CTE2 GROUP BY ACTION_DATE) SELECT ROUND(AVG(PCT)*100,2) AS AVERAGE_DAILY_PERCENT FROM CTE3"
278,Y,Y,"WITH CTE AS (SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) AS REMOVAL_RATE_PER_DAY FROM ACTIONS A LEFT JOIN REMOVALS R USING(POST_ID) WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY A.ACTION_DATE) SELECT ROUND(100*AVG(REMOVAL_RATE_PER_DAY),2) AS AVERAGE_DAILY_PERCENT FROM CTE"
279,Y,Y,"WITH CTE AS (SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID) AS REMOVALS_COUNT, COUNT(DISTINCT A.POST_ID) AS SPAM_REPORTS_COUNT FROM ACTIONS AS A LEFT JOIN REMOVALS AS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE) SELECT ROUND(AVG(REMOVALS_COUNT / SPAM_REPORTS_COUNT) * 100, 2) AS AVERAGE_DAILY_PERCENT FROM CTE"
280,Y,Y,"WITH CTE AS (SELECT A.ACTION_DATE, ROUND(COUNT(DISTINCT R.POST_ID)*100/COUNT(DISTINCT A.POST_ID),2) AS DAILY FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE A.ACTION='REPORT' AND A.EXTRA ='SPAM' GROUP BY A.ACTION_DATE) SELECT ROUND(AVG(DAILY),2) AS AVERAGE_DAILY_PERCENT FROM CTE"
281,Y,Y,"WITH CTE AS (SELECT ACTION_DATE, CAST(COUNT(DISTINCT A.POST_ID) AS FLOAT) AS TOTAL, CAST(COUNT(DISTINCT R.POST_ID) AS FLOAT) AS REMOVED FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE ) SELECT CAST(AVG(REMOVED/TOTAL) * 100 AS DECIMAL(10,2)) AS AVERAGE_DAILY_PERCENT FROM CTE"
282,Y,Y,"WITH CTE AS (SELECT ACTION_DATE, COUNT(DISTINCT CASE WHEN EXTRA = 'SPAM' AND POST_ID IN (SELECT POST_ID FROM REMOVALS) THEN POST_ID ELSE NULL END)/ COUNT(DISTINCT CASE WHEN EXTRA= 'SPAM' THEN POST_ID ELSE NULL END) AS PCT FROM ACTIONS GROUP BY 1 ) SELECT ROUND(AVG(PCT)*100,2) AS AVERAGE_DAILY_PERCENT FROM CTE WHERE PCT IS NOT NULL"
283,Y,Y,"WITH CTE AS (SELECT ACTION_DATE,(COUNT(DISTINCT (R.POST_ID)))/(COUNT(DISTINCT (A.POST_ID))) AS P FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE EXTRA='SPAM' GROUP BY A.ACTION_DATE) SELECT ROUND((SUM(P)/COUNT(*))*100,2) AS AVERAGE_DAILY_PERCENT FROM CTE"
284,Y,Y,"WITH CTE AS (SELECT DISTINCT ACTION_DATE, ACTIONS.POST_ID, CASE WHEN REMOVE_DATE IS NULL THEN 0 ELSE 1 END AS WASREMOVED FROM ACTIONS LEFT JOIN REMOVALS ON ACTIONS.POST_ID = REMOVALS.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM') , CTE2 AS (SELECT ACTION_DATE, ROUND(100*SUM(WASREMOVED)/COUNT(POST_ID),2) AS DAILY_PERCENT FROM CTE GROUP BY ACTION_DATE) SELECT ROUND(AVG(DAILY_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM CTE2"
285,Y,Y,"WITH CTE AS (SELECT DISTINCT POST_ID, ACTION_DATE FROM ACTIONS WHERE EXTRA = 'SPAM'), CTE2 AS (SELECT CTE.POST_ID, ACTION_DATE, CASE WHEN POST_ID IN (SELECT POST_ID FROM REMOVALS) THEN 1 ELSE 0 END AS CNT FROM CTE), CTE3 AS (SELECT *, SUM(CNT)/COUNT(POST_ID) AS PCT FROM CTE2 GROUP BY ACTION_DATE) SELECT ROUND(AVG(PCT)*100,2) AS AVERAGE_DAILY_PERCENT FROM CTE3"
286,Y,Y,"WITH CTE AS (SELECT DISTINCT POST_ID, ACTION_DATE FROM ACTIONS WHERE EXTRA='SPAM'), RESULT AS (SELECT 100*SUM(CASE WHEN B.POST_ID IS NOT NULL THEN 1 ELSE 0 END)/COUNT(A.POST_ID) AS PERCENT FROM CTE A LEFT JOIN REMOVALS B ON A.POST_ID=B.POST_ID GROUP BY A.ACTION_DATE) SELECT ROUND(AVG(PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM RESULT"
287,Y,Y,"WITH CTE AS (SELECT DISTINCT POST_ID,ACTION_DATE FROM ACTIONS WHERE EXTRA='SPAM'), TMP AS ( SELECT COUNT(REMOVALS.POST_ID)/COUNT(CTE.POST_ID) AS DAILY_PERCENT FROM CTE LEFT JOIN REMOVALS ON CTE.POST_ID=REMOVALS.POST_ID GROUP BY ACTION_DATE) SELECT ROUND(AVG(DAILY_PERCENT)*100,2) AS AVERAGE_DAILY_PERCENT FROM TMP"
288,Y,Y,"WITH CTE AS (SELECT DISTINCT POST_ID,ACTION_DATE, ACTION, EXTRA FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM'), CTE2 AS (SELECT ACTION_DATE, COUNT(B.POST_ID)/COUNT(A.POST_ID)*100 AS SPAM_REPORT FROM CTE A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID GROUP BY 1) SELECT ROUND(AVG(SPAM_REPORT),2) AS AVERAGE_DAILY_PERCENT FROM CTE2"
289,Y,Y,"WITH CTE AS (SELECT DISTINCT POST_ID,ACTION_DATE,EXTRA FROM ACTIONS WHERE EXTRA = 'SPAM') SELECT ROUND(AVG(PERCENT)*100,2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, SUM(RK)/COUNT(RK) AS PERCENT FROM(SELECT *, CASE WHEN POST_ID IN (SELECT POST_ID FROM REMOVALS) THEN 1 ELSE 0 END AS RK FROM CTE)A GROUP BY ACTION_DATE )B"
290,Y,Y,"WITH CTE AS( SELECT COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) * 100 AS PCTG FROM ACTIONS A LEFT JOIN REMOVALS R USING (POST_ID) WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE) SELECT ROUND(AVG(PCTG),2) AS AVERAGE_DAILY_PERCENT FROM CTE"
291,Y,Y,"WITH CTE AS( SELECT COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS N FROM ACTIONS A LEFT JOIN REMOVALS R ON R.POST_ID = A.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ) SELECT ROUND(AVG(N)*100,2) AS AVERAGE_DAILY_PERCENT FROM CTE"
292,Y,Y,"WITH CTE AS(SELECT * FROM ACTIONS WHERE EXTRA='SPAM'), CTE1 AS(SELECT COUNT(DISTINCT R.POST_ID)/ COUNT(DISTINCT C.POST_ID) AS DAILY_PERCENT FROM CTE C LEFT JOIN REMOVALS R ON C.POST_ID=R.POST_ID GROUP BY ACTION_DATE) SELECT ROUND(AVG(DAILY_PERCENT)*100,2) AS AVERAGE_DAILY_PERCENT FROM CTE1"
293,Y,Y,"WITH CTE1 AS ( SELECT 100*(COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)) AS CNT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE A.EXTRA='SPAM' GROUP BY A.ACTION_DATE ), CTE2 AS ( SELECT ROUND(AVG(CNT),2) AS AVERAGE_DAILY_PERCENT FROM CTE1 ) SELECT * FROM CTE2"
294,Y,Y,"WITH CTE1 AS ( SELECT A.POST_ID, A.ACTION_DATE, R.REMOVE_DATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE A.EXTRA='SPAM' ), CTE2 AS ( SELECT (COUNT(DISTINCT CASE WHEN REMOVE_DATE IS NULL THEN NULL ELSE POST_ID END)/COUNT(DISTINCT POST_ID))*100 AS DAILY, ACTION_DATE FROM CTE1 GROUP BY ACTION_DATE ), CTE3 AS ( SELECT ROUND(SUM(DAILY)/COUNT(ACTION_DATE),2) AS AVERAGE_DAILY_PERCENT FROM CTE2 ) SELECT * FROM CTE3"
295,Y,Y,"WITH CTE1 AS ( SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS SPAM_COUNT FROM ACTIONS WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE ), CTE2 AS ( SELECT ACTION_DATE, REMOVE_DATE, COUNT(DISTINCT R.POST_ID) AS REMOVE_COUNT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ) SELECT ROUND(AVG(REMOVE_COUNT/SPAM_COUNT)*100,2) AS AVERAGE_DAILY_PERCENT FROM CTE1, CTE2 WHERE CTE1.ACTION_DATE = CTE2.ACTION_DATE"
296,Y,Y,"WITH CTE1 AS ( SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS TOTAL_DAILY_SPAM FROM ACTIONS WHERE EXTRA='SPAM' AND ACTION='REPORT' GROUP BY ACTION_DATE), CTE2 AS (SELECT ACTION_DATE, COUNT(DISTINCT A.POST_ID) AS TOTAL_REMOVAL FROM ACTIONS A JOIN REMOVALS B ON A.POST_ID=B.POST_ID WHERE A.EXTRA='SPAM' AND A.ACTION='REPORT' AND B.REMOVE_DATE>A.ACTION_DATE GROUP BY ACTION_DATE) SELECT ROUND(AVG(DAILY_AVG)*100,2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT (COALESCE(B.TOTAL_REMOVAL,0)/A.TOTAL_DAILY_SPAM) AS DAILY_AVG FROM CTE1 A LEFT JOIN CTE2 B ON A.ACTION_DATE=B.ACTION_DATE)C"
297,Y,Y,"WITH CTE1 AS ( SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS TOTAL_DAILY_SPAM FROM ACTIONS WHERE EXTRA='SPAM' AND ACTION='REPORT' GROUP BY ACTION_DATE), CTE2 AS (SELECT ACTION_DATE, COUNT(DISTINCT A.POST_ID) AS TOTAL_REMOVAL FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID=B.POST_ID WHERE A.EXTRA='SPAM' AND A.ACTION='REPORT' AND B.REMOVE_DATE>A.ACTION_DATE GROUP BY ACTION_DATE) SELECT ROUND(AVG(DAILY_AVG)*100,2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT (COALESCE(B.TOTAL_REMOVAL,0)/A.TOTAL_DAILY_SPAM) AS DAILY_AVG FROM CTE1 A LEFT JOIN CTE2 B ON A.ACTION_DATE=B.ACTION_DATE)C"
298,Y,Y,"WITH CTE1 AS ( SELECT DISTINCT POST_ID, ACTION_DATE FROM ACTIONS WHERE EXTRA='SPAM' ), CTE2 AS ( SELECT ACTION_DATE, COUNT(POST_ID) AS SPAM_COUNT FROM CTE1 GROUP BY ACTION_DATE ), CTE3 AS ( SELECT A.ACTION_DATE,COUNT(A.POST_ID) AS REMOVE_COUNT FROM CTE1 A INNER JOIN REMOVALS B ON A.POST_ID=B.POST_ID GROUP BY A.ACTION_DATE ) SELECT ROUND(AVG(COALESCE(C2.REMOVE_COUNT, 0 )*100 /C1.SPAM_COUNT),2) AS AVERAGE_DAILY_PERCENT FROM CTE2 C1 LEFT JOIN CTE3 C2 ON C1.ACTION_DATE=C2.ACTION_DATE"
299,Y,Y,"WITH CTE1 AS (SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS TOTAL_POSTS FROM ACTIONS WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE), CTE2 AS (SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID) AS REMOVED_POST FROM ACTIONS A INNER JOIN REMOVALS R ON A.POST_ID = R.POST_ID AND EXTRA = 'SPAM' GROUP BY ACTION_DATE) SELECT ROUND(AVG(IFNULL(REMOVED_POST*100/TOTAL_POSTS,0)),2) AS AVERAGE_DAILY_PERCENT FROM CTE1 LEFT JOIN CTE2 ON CTE1.ACTION_DATE = CTE2.ACTION_DATE"
300,Y,Y,"WITH CTE1 AS (SELECT DISTINCT POST_ID, ACTION_DATE, ACTION, EXTRA FROM ACTIONS), CTE2 AS (SELECT DISTINCT POST_ID, REMOVE_DATE FROM REMOVALS), CTE3 AS (SELECT C1.ACTION_DATE, SUM(CASE WHEN C2.REMOVE_DATE IS NOT NULL THEN 1 ELSE 0 END) AS REMOVALS_COUNT, COUNT(C1.POST_ID) AS SPAM_REPORTS_COUNT FROM CTE1 AS C1 LEFT JOIN CTE2 AS C2 ON C1.POST_ID = C2.POST_ID WHERE C1.EXTRA = 'SPAM' GROUP BY C1.ACTION_DATE) SELECT ROUND(AVG(REMOVALS_COUNT / SPAM_REPORTS_COUNT) * 100, 2) AS AVERAGE_DAILY_PERCENT FROM CTE3"
301,Y,Y,"WITH CTE1 AS (SELECT DISTINCT POST_ID, ACTION_DATE, ACTION, EXTRA FROM ACTIONS), CTE2 AS (SELECT DISTINCT POST_ID, REMOVE_DATE FROM REMOVALS), CTE3 AS (SELECT C1.ACTION_DATE, SUM(CASE WHEN C2.REMOVE_DATE IS NOT NULL THEN 1 ELSE 0 END) AS REMOVALS_COUNT, COUNT(DISTINCT C1.POST_ID) AS SPAM_REPORTS_COUNT FROM CTE1 AS C1 LEFT JOIN CTE2 AS C2 ON C1.POST_ID = C2.POST_ID WHERE C1.EXTRA = 'SPAM' GROUP BY C1.ACTION_DATE) SELECT ROUND(AVG(REMOVALS_COUNT / SPAM_REPORTS_COUNT) * 100, 2) AS AVERAGE_DAILY_PERCENT FROM CTE3"
302,Y,Y,"WITH CTE_SPAM AS ( SELECT ACTION_DATE, ((COUNT(DISTINCT(T2.POST_ID))) / (COUNT(DISTINCT(T1.POST_ID)))) AS PERCENTAGE FROM ACTIONS T1 LEFT JOIN REMOVALS T2 ON T1.POST_ID = T2.POST_ID WHERE EXTRA LIKE SPAM GROUP BY ACTION_DATE ) SELECT ROUND(AVG(PERCENTAGE)*100,2) AS AVERAGE_DAILY_PERCENT FROM CTE_SPAM"
303,Y,Y,"WITH DAILY_PCT_POSTS AS ( SELECT ACTION_DATE, COUNT(DISTINCT T2.POST_ID)/COUNT(DISTINCT T1.POST_ID) AS REMOVAL_PCT FROM ACTIONS T1 LEFT JOIN REMOVALS T2 ON T1.POST_ID = T2.POST_ID WHERE T1.EXTRA = 'SPAM' GROUP BY ACTION_DATE ) SELECT ROUND(AVG(REMOVAL_PCT)*100,2) AS AVERAGE_DAILY_PERCENT FROM DAILY_PCT_POSTS"
304,Y,Y,"WITH DAILY_REMOVAL AS ( SELECT DISTINCT A.POST_ID, A.ACTION_DATE, R.REMOVE_DATE, (CASE WHEN R.REMOVE_DATE IS NULL THEN 0 ELSE 1 END) AS IS_REMOVED FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM') SELECT ROUND(AVG(T.DAILY_AVG)*100,2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT AVG(IS_REMOVED) AS DAILY_AVG FROM DAILY_REMOVAL GROUP BY ACTION_DATE) T"
305,Y,Y,"WITH DAY_PCT_OF_REM_SPAM AS (SELECT ACTION_DATE, COUNT(DISTINCT CASE WHEN REMOVE_DATE IS NOT NULL THEN A.POST_ID ELSE NULL END)/COUNT(DISTINCT A.POST_ID) SPAM_PCT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY ACTION_DATE) SELECT ROUND(AVG(SPAM_PCT)*100,2) AS AVERAGE_DAILY_PERCENT FROM DAY_PCT_OF_REM_SPAM"
306,Y,Y,"WITH FILTER_ACTION AS (SELECT POST_ID, EXTRA, ACTION_DATE FROM ACTIONS WHERE EXTRA = 'SPAM') SELECT ROUND(COALESCE(AVG(DAILY_AVE) * 100,0),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT COUNT(DISTINCT(R.POST_ID))/COUNT(DISTINCT(F.POST_ID)) AS DAILY_AVE FROM FILTER_ACTION F LEFT JOIN REMOVALS R ON F.POST_ID = R.POST_ID GROUP BY ACTION_DATE) TAB"
307,Y,Y,"WITH MAIN AS ( SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)/ COUNT(DISTINCT A.POST_ID)*100 AS REMOVAL_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID= R.POST_ID WHERE A.EXTRA='SPAM' AND A.ACTION='REPORT' GROUP BY ACTION_DATE ) SELECT ROUND(AVG(REMOVAL_PERCENT), 2) AS AVERAGE_DAILY_PERCENT FROM MAIN"
308,Y,Y,"WITH MAIN1 AS ( SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS NUM1 FROM ACTIONS WHERE EXTRA = 'SPAM' AND ACTION = 'REPORT' GROUP BY ACTION_DATE ), MAIN2 AS ( SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID) AS NUM2 FROM ACTIONS A JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' AND ACTION = 'REPORT' GROUP BY ACTION_DATE ) SELECT ROUND(AVG(DAILY_PERC), 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT COALESCE((MAIN2.NUM2 / MAIN1.NUM1)*100.0, 0) AS DAILY_PERC FROM MAIN1 LEFT JOIN MAIN2 ON MAIN1.ACTION_DATE = MAIN2.ACTION_DATE) MAIN3"
309,Y,Y,"WITH NORMALIZED_ACTIONS AS ( SELECT DISTINCT ACTION_DATE, POST_ID FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' ), SPAM_REPORTS AS ( SELECT ACTION_DATE, SUM(CASE WHEN R.POST_ID IS NOT NULL THEN 1 ELSE 0 END) / COUNT(1) AS PERC_SPAM_REPORTED_REMOVED FROM NORMALIZED_ACTIONS A LEFT JOIN REMOVALS R ON R.POST_ID = A.POST_ID AND R.REMOVE_DATE > A.ACTION_DATE GROUP BY 1 ) SELECT ROUND(AVG(PERC_SPAM_REPORTED_REMOVED) * 100, 2) AS AVERAGE_DAILY_PERCENT FROM SPAM_REPORTS"
310,Y,Y,"WITH NORMALIZED_ACTIONS AS ( SELECT DISTINCT ACTION_DATE, POST_ID, ACTION, EXTRA FROM ACTIONS ), SPAM_REPORTS AS ( SELECT ACTION_DATE, SUM(CASE WHEN R.POST_ID IS NOT NULL THEN 1 ELSE 0 END) / COUNT(1) AS PERC_SPAM_REPORTED_REMOVED FROM NORMALIZED_ACTIONS A LEFT JOIN REMOVALS R ON R.POST_ID = A.POST_ID AND R.REMOVE_DATE > A.ACTION_DATE WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY 1 ) SELECT ROUND(AVG(PERC_SPAM_REPORTED_REMOVED) * 100, 2) AS AVERAGE_DAILY_PERCENT FROM SPAM_REPORTS"
311,Y,Y,"WITH NORMALIZED_ACTIONS AS ( SELECT DISTINCT ACTION_DATE, POST_ID, ACTION, EXTRA FROM ACTIONS ), SPAM_REPORTS AS ( SELECT ACTION_DATE, SUM(IF(R.POST_ID IS NOT NULL, 1, 0)) / COUNT(1) AS PERC_SPAM_REPORTED_REMOVED FROM NORMALIZED_ACTIONS A LEFT JOIN REMOVALS R ON R.POST_ID = A.POST_ID AND R.REMOVE_DATE > A.ACTION_DATE WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY 1 ) SELECT ROUND(AVG(PERC_SPAM_REPORTED_REMOVED) * 100, 2) AS AVERAGE_DAILY_PERCENT FROM SPAM_REPORTS"
312,Y,Y,"WITH R AS ( SELECT REMOVE_DATE , POST_ID FROM REMOVALS GROUP BY REMOVE_DATE, POST_ID ) , A AS ( SELECT POST_ID , ACTION_DATE FROM ACTIONS WHERE EXTRA = 'SPAM' GROUP BY POST_ID, ACTION_DATE ) , SUMMARY AS ( SELECT A.ACTION_DATE , (COUNT(DISTINCT CASE WHEN REMOVE_DATE IS NOT NULL THEN R.POST_ID ELSE NULL END)/COUNT(DISTINCT A.POST_ID)) AS DAILY_AVG FROM A LEFT JOIN R ON A.POST_ID = R.POST_ID GROUP BY 1 ) SELECT ROUND(100*AVG(DAILY_AVG),2) AS AVERAGE_DAILY_PERCENT FROM SUMMARY"
313,Y,Y,"WITH REMOVAL AS ( SELECT DISTINCT A.POST_ID, A.ACTION_DATE, A.EXTRA, B.POST_ID AS REMOVE_ID FROM ACTIONS AS A LEFT JOIN REMOVALS AS B ON A.POST_ID = B.POST_ID AND A.ACTION_DATE < B.REMOVE_DATE WHERE A.EXTRA = 'SPAM' ), PERCENTAGE AS ( SELECT ACTION_DATE, SUM(CASE WHEN REMOVE_ID IS NULL THEN 0 ELSE 1 END)/COUNT(POST_ID)*100 AS PERCENTAGE FROM REMOVAL GROUP BY ACTION_DATE ) SELECT ROUND(AVG(PERCENTAGE),2)AS AVERAGE_DAILY_PERCENT FROM PERCENTAGE"
314,Y,Y,"WITH REMOVAL AS( SELECT POST_ID, COUNT(DISTINCT A.POST_ID) AS REMOVAL_CNT, ACTION_DATE FROM ACTIONS AS A WHERE EXTRA = 'SPAM' AND POST_ID IN (SELECT DISTINCT POST_ID FROM REMOVALS) GROUP BY ACTION_DATE), SPAM AS( SELECT COUNT(DISTINCT POST_ID) AS CNT, ACTION_DATE FROM ACTIONS WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE), ZERO AS( SELECT IFNULL(REMOVAL_CNT,0) AS REMOVAL_CNT, SPAM.ACTION_DATE FROM REMOVAL RIGHT JOIN SPAM ON REMOVAL.ACTION_DATE = SPAM.ACTION_DATE) SELECT ROUND(AVG(RATE)*100,2) AS AVERAGE_DAILY_PERCENT FROM( SELECT REMOVAL_CNT/CNT AS RATE, S.ACTION_DATE FROM SPAM AS S JOIN ZERO AS Z ON S.ACTION_DATE = Z.ACTION_DATE GROUP BY S.ACTION_DATE) AS SUB"
315,Y,Y,"WITH REMOVAL_INFO AS ( SELECT ACTION_DATE, COUNT(DISTINCT ACTIONS.POST_ID) AS SPAM_CT, COUNT(DISTINCT REMOVALS.POST_ID) AS REMOVAL_CT FROM ACTIONS LEFT JOIN REMOVALS ON (ACTIONS.POST_ID = REMOVALS.POST_ID) WHERE EXTRA = 'SPAM' GROUP BY 1 ) SELECT ROUND(AVG(REMOVAL_CT * 100 / SPAM_CT) , 2) AS AVERAGE_DAILY_PERCENT FROM REMOVAL_INFO"
316,Y,Y,"WITH REPORT_POST AS ( SELECT DISTINCT A.POST_ID, ACTION_DATE, ACTION, CASE WHEN R.POST_ID IS NOT NULL THEN 1 ELSE 0 END AS REMOVED_ID FROM ACTIONS A LEFT OUTER JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' ), DAILY_PERCENTAGE AS ( SELECT AVG(REMOVED_ID)*100 AS DAILY, ACTION_DATE FROM REPORT_POST GROUP BY ACTION_DATE ) SELECT ROUND(AVG(DAILY), 2) AS AVERAGE_DAILY_PERCENT FROM DAILY_PERCENTAGE"
317,Y,Y,"WITH REPORT_SPAM AS ( SELECT POST_ID, ACTION_DATE FROM ACTIONS WHERE ACTION='REPORT' AND EXTRA='SPAM' GROUP BY 1,2), SPAM_REMOVAL AS ( SELECT RS.ACTION_DATE, COUNT(RM.POST_ID) AS REMOVAL_NUM FROM REPORT_SPAM RS LEFT JOIN REMOVALS RM ON RS.POST_ID=RM.POST_ID GROUP BY 1) SELECT ROUND(AVG(TARGET_VALUE)*100,2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT SR.ACTION_DATE, SR.REMOVAL_NUM/COUNT(RS.POST_ID) AS TARGET_VALUE FROM REPORT_SPAM RS JOIN SPAM_REMOVAL SR ON SR.ACTION_DATE=RS.ACTION_DATE GROUP BY 1) T"
318,Y,Y,"WITH REPORTS AS ( SELECT DISTINCT ACTION_DATE AS REPORTING_DATE,POST_ID FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' ) ,DAILY_PER AS ( SELECT RP.REPORTING_DATE, COUNT(DISTINCT CASE WHEN RP.REPORTING_DATE <= RM.REMOVE_DATE THEN RM.POST_ID END) *100.0/COUNT(DISTINCT RP.POST_ID) AS DAILY_PER FROM REPORTS RP LEFT JOIN REMOVALS RM ON RP.POST_ID = RM.POST_ID GROUP BY 1 ) SELECT ROUND(AVG(DAILY_PER),2) AS AVERAGE_DAILY_PERCENT FROM DAILY_PER"
319,Y,Y,"WITH RMINFO AS (SELECT ACTION_DATE , ROUND(100*COUNT(DISTINCT B.POST_ID)/COUNT(DISTINCT A.POST_ID) , 2) AS RM_PERCENTAGE FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE) SELECT ROUND(AVG(RM_PERCENTAGE) , 2) AS AVERAGE_DAILY_PERCENT FROM RMINFO"
320,Y,Y,"WITH RP AS (SELECT DISTINCT A.POST_ID AS POST1, A.ACTION_DATE, R.POST_ID AS POST2 FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' ) SELECT ROUND(AVG(PTG),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT RP.ACTION_DATE, 100.00* SUM(CASE WHEN RP.POST2 IS NULL THEN 0 ELSE 1 END)/ COUNT(CASE WHEN RP.POST2 IS NULL THEN 0 ELSE 1 END) AS PTG FROM RP GROUP BY 1) B"
321,Y,Y,"WITH S AS (SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID) AS SPAM, COUNT(DISTINCT A.POST_ID) AS N FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID AND A.ACTION_DATE <= R.REMOVE_DATE WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY 1) SELECT ROUND(AVG(SPAM/N*100),2) AS AVERAGE_DAILY_PERCENT FROM S"
322,Y,Y,"WITH SPAM AS ( SELECT ACTION_DATE, 100*COUNT(DISTINCT B.POST_ID)/COUNT(DISTINCT A.POST_ID) AS PERCENT FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID WHERE A.EXTRA= 'SPAM' GROUP BY 1 ) SELECT ROUND (AVG(PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM SPAM"
323,Y,Y,"WITH SPAM AS (SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS SPAM_NUM FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA='SPAM' GROUP BY ACTION_DATE), REMOVE_1 AS (SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID) AS REMOVE_NUM FROM ACTIONS A LEFT JOIN REMOVALS R USING (POST_ID) WHERE A.ACTION = 'REPORT' AND A.EXTRA='SPAM' GROUP BY ACTION_DATE) SELECT ROUND(AVG(REMOVE_NUM/SPAM_NUM)*100,2) AS AVERAGE_DAILY_PERCENT FROM REMOVE_1, SPAM WHERE REMOVE_1.ACTION_DATE = SPAM.ACTION_DATE"
324,Y,Y,"WITH SPAM_COUNT AS ( SELECT DISTINCT POST_ID, ACTION_DATE FROM ACTIONS WHERE EXTRA = 'SPAM' ), REMOVED_POSTS AS ( SELECT DISTINCT R.POST_ID, A.ACTION_DATE FROM REMOVALS R JOIN ACTIONS A ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' ) SELECT ROUND(100 * AVG(AVG_PCT), 2) AVERAGE_DAILY_PERCENT FROM (SELECT S.ACTION_DATE, COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT S.POST_ID) AVG_PCT FROM SPAM_COUNT S LEFT JOIN REMOVED_POSTS R ON R.POST_ID = S.POST_ID GROUP BY 1 ) RESULT_TABLE"
325,Y,Y,"WITH SPAM_COUNT AS ( SELECT DISTINCT USER_ID, POST_ID, ACTION_DATE FROM ACTIONS WHERE EXTRA = 'SPAM' ), REMOVED_POSTS AS ( SELECT DISTINCT A.USER_ID, R.POST_ID, A.ACTION_DATE FROM REMOVALS R JOIN ACTIONS A ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' ) SELECT ROUND(100 * AVG(AVG_PCT), 2) AVERAGE_DAILY_PERCENT FROM (SELECT S.ACTION_DATE, COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT S.POST_ID) AVG_PCT FROM SPAM_COUNT S LEFT JOIN REMOVED_POSTS R ON R.POST_ID = S.POST_ID AND R.USER_ID = S.USER_ID GROUP BY 1 ) RESULT_TABLE"
326,Y,Y,"WITH SPAM_POST AS ( SELECT DISTINCT ACTION_DATE, POST_ID FROM ACTIONS WHERE EXTRA = 'SPAM' ) SELECT ROUND(100 * AVG(RATIO), 2) AVERAGE_DAILY_PERCENT FROM (SELECT S.ACTION_DATE, COUNT(R.POST_ID)/COUNT(S.POST_ID) AS RATIO FROM SPAM_POST S LEFT JOIN REMOVALS R ON S.POST_ID = R.POST_ID GROUP BY 1) T"
327,Y,Y,"WITH SPAM_POSTS AS ( SELECT DISTINCT A.POST_ID, A.ACTION_DATE, R.POST_ID AS POST_ID_R FROM REMOVALS R RIGHT JOIN ACTIONS A ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' ) SELECT ROUND(100 * AVG(AVG_PCT), 2) AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(POST_ID_R) / COUNT(DISTINCT POST_ID) AVG_PCT FROM SPAM_POSTS GROUP BY 1 ) RESULT_TABLE"
328,Y,Y,"WITH SPAM_POSTS AS ( SELECT DISTINCT A.POST_ID, A.ACTION_DATE, R.REMOVE_DATE FROM ACTIONS AS A LEFT JOIN REMOVALS AS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' ), RESULT_TABLE AS ( SELECT ACTION_DATE, COUNT(REMOVE_DATE) / COUNT(DISTINCT POST_ID) AVG_PCT FROM SPAM_POSTS GROUP BY 1 ) SELECT ROUND(100 * AVG(AVG_PCT), 2) AVERAGE_DAILY_PERCENT FROM RESULT_TABLE"
329,Y,Y,"WITH SPAM_POSTS AS ( SELECT DISTINCT A.POST_ID, A.ACTION_DATE, R.REMOVE_DATE FROM REMOVALS R RIGHT JOIN ACTIONS A ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' ) SELECT ROUND(100 * AVG(AVG_PCT), 2) AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(REMOVE_DATE) / COUNT(DISTINCT POST_ID) AVG_PCT FROM SPAM_POSTS GROUP BY 1 ) RESULT_TABLE"
330,Y,Y,"WITH SPAM_REPORTS AS ( SELECT POST_ID, ACTION_DATE FROM ACTIONS WHERE ACTION='REPORT' AND EXTRA='SPAM' GROUP BY POST_ID, ACTION_DATE) , SPAM_REMOVAL AS ( SELECT REP.ACTION_DATE, COUNT(RM.POST_ID) AS REMOVAL_NUM FROM SPAM_REPORTS REP LEFT JOIN REMOVALS RM ON REP.POST_ID=RM.POST_ID GROUP BY REP.ACTION_DATE) , SPAM_REMOVAL_RATE AS ( SELECT SR.ACTION_DATE, SR.REMOVAL_NUM/COUNT(REP.POST_ID) AS TARGET_VALUE FROM SPAM_REPORTS REP JOIN SPAM_REMOVAL SR ON SR.ACTION_DATE=REP.ACTION_DATE GROUP BY SR.ACTION_DATE ) SELECT ROUND(AVG(TARGET_VALUE)*100,2) AS AVERAGE_DAILY_PERCENT FROM SPAM_REMOVAL_RATE"
331,Y,Y,"WITH SPAM_TBL AS ( SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS SPAM_COUNT FROM ACTIONS WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE ), REMOVE_TBL AS ( SELECT ACTION_DATE, REMOVE_DATE, COUNT(DISTINCT R.POST_ID) AS REMOVE_COUNT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ) SELECT ROUND(AVG(REMOVE_COUNT/SPAM_COUNT)*100,2) AS AVERAGE_DAILY_PERCENT FROM SPAM_TBL, REMOVE_TBL WHERE SPAM_TBL.ACTION_DATE = REMOVE_TBL.ACTION_DATE"
332,Y,Y,"WITH T AS ( SELECT DISTINCT POST_ID, ACTION_DATE FROM ACTIONS WHERE EXTRA = 'SPAM' ) SELECT ROUND(100*AVG(DAILY_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, SUM(REMOVED)/COUNT(POST_ID) AS DAILY_PERCENT FROM ( SELECT POST_ID, ACTION_DATE, CASE WHEN POST_ID IN (SELECT POST_ID FROM REMOVALS) THEN 1 ELSE 0 END AS REMOVED FROM T ) AS T0 GROUP BY ACTION_DATE ) AS T2"
333,Y,Y,"WITH T AS ( SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS PCT FROM ACTIONS A LEFT JOIN REMOVALS R USING(POST_ID) WHERE EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ) SELECT ROUND(AVG(PCT), 2 ) AS AVERAGE_DAILY_PERCENT FROM T"
334,Y,Y,"WITH T AS ( SELECT ACTION_DATE ,COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS R_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.ACTION ='REPORT' AND A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE HAVING COUNT(DISTINCT CASE WHEN A.ACTION='REPORT' AND A.EXTRA='SPAM' THEN A.POST_ID ELSE NULL END) > 0 ) SELECT ROUND(100*AVG(R_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM T"
335,Y,Y,"WITH T AS( SELECT (COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID))*100 AS CNT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE) SELECT ROUND(AVG(CNT),2) AS AVERAGE_DAILY_PERCENT FROM T"
336,Y,Y,"WITH T1 AS ( SELECT POST_ID, ACTION_DATE FROM ACTIONS WHERE EXTRA = 'SPAM'), T2 AS ( SELECT DISTINCT T1.POST_ID AS ID, T1.ACTION_DATE, R.POST_ID AS RID FROM T1 LEFT JOIN REMOVALS R ON T1.POST_ID = R.POST_ID ), T3 AS ( SELECT COUNT(T2.RID)/COUNT(T2.ID) AS PERCENTAGE FROM T2 GROUP BY T2.ACTION_DATE) SELECT ROUND(AVG(T3.PERCENTAGE)*100,2) AS AVERAGE_DAILY_PERCENT FROM T3"
337,Y,Y,"WITH T1 AS (SELECT DISTINCT ACTION_DATE, POST_ID FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM'), T2 AS (SELECT COUNT(*) AS REPORTED, SUM(CASE WHEN POST_ID IN (SELECT POST_ID FROM REMOVALS) THEN 1 ELSE 0 END) AS REMOVED FROM T1 GROUP BY ACTION_DATE) SELECT ROUND(100*IFNULL(AVG(REMOVED/REPORTED), 0), 2) AS AVERAGE_DAILY_PERCENT FROM T2"
338,Y,Y,"WITH T1 AS (SELECT DISTINCT ACTION_DATE, POST_ID FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM'), T2 AS (SELECT COUNT(*) AS REPORTED, SUM(CASE WHEN POST_ID IN (SELECT POST_ID FROM REMOVALS) THEN 1 ELSE 0 END) AS REMOVED FROM T1 GROUP BY ACTION_DATE) SELECT ROUND(IFNULL(100*AVG(REMOVED/REPORTED), 0), 2) AS AVERAGE_DAILY_PERCENT FROM T2"
339,Y,Y,"WITH TA AS ( SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID) RCNT ,COUNT(DISTINCT A.POST_ID) PCNT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' GROUP BY 1) SELECT ROUND(AVG((RCNT*1.0/PCNT)*100),2) AS AVERAGE_DAILY_PERCENT FROM TA"
340,Y,Y,"WITH TEMP AS (SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS SPAMS, COUNT(DISTINCT R.POST_ID) AS RM FROM ACTIONS A LEFT JOIN REMOVALS R USING (POST_ID) WHERE EXTRA ='SPAM' GROUP BY ACTION_DATE) SELECT ROUND(AVG(RM/SPAMS)*100,2) AS AVERAGE_DAILY_PERCENT FROM TEMP"
341,Y,Y,"WITH TEMP AS( SELECT A.POST_ID,A.ACTION_DATE,A.EXTRA,R.POST_ID AS R_POSTID FROM ACTIONS A LEFT JOIN REMOVALS AS R ON A.POST_ID=R.POST_ID WHERE A.EXTRA='SPAM' ), TEMP2 AS( SELECT ACTION_DATE,ROUND(COUNT(DISTINCT R_POSTID)/COUNT(DISTINCT POST_ID)*100,2) AS PCT_REMOVE FROM TEMP GROUP BY ACTION_DATE ) SELECT ROUND(SUM(PCT_REMOVE)/COUNT(DISTINCT ACTION_DATE),2) AS AVERAGE_DAILY_PERCENT FROM TEMP2"
342,Y,Y,"WITH TEMP AS( SELECT COUNT(DISTINCT RE.POST_ID)/COUNT(DISTINCT AC.POST_ID)*100 AS RES FROM ACTIONS AC LEFT JOIN REMOVALS RE ON RE.POST_ID=AC.POST_ID WHERE AC.EXTRA LIKE SPAM GROUP BY ACTION_DATE ) SELECT ROUND(AVG(RES),2) AS AVERAGE_DAILY_PERCENT FROM TEMP"
343,Y,Y,"WITH TEMP AS(SELECT DISTINCT ACTIONS.POST_ID, ACTIONS.ACTION_DATE, REMOVALS.REMOVE_DATE FROM ACTIONS LEFT JOIN REMOVALS ON ACTIONS.POST_ID = REMOVALS.POST_ID WHERE EXTRA='SPAM') SELECT ROUND(AVG(PERC)*100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT COUNT(REMOVE_DATE)/COUNT(DISTINCT POST_ID) AS PERC FROM TEMP GROUP BY ACTION_DATE) A"
344,Y,Y,"WITH TMP AS (SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) AS Q FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE) SELECT ROUND(AVG(Q) * 100 , 2) AS AVERAGE_DAILY_PERCENT FROM TMP"
345,Y,Y,"WITH TMP AS( SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS TOTAL FROM ACTIONS WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE ), TMP2 AS( SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID) AS REMOVALS FROM REMOVALS AS R LEFT JOIN ACTIONS AS A ON R.POST_ID = A.POST_ID AND A.EXTRA='SPAM' GROUP BY A.ACTION_DATE ), TMP3 AS ( SELECT IFNULL(REMOVALS,0)/TOTAL*100 AS PERCENT FROM TMP LEFT JOIN TMP2 ON TMP.ACTION_DATE = TMP2.ACTION_DATE GROUP BY TMP.ACTION_DATE ) SELECT ROUND(AVG(PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM TMP3"
346,Y,Y,"WITH TOT AS ( SELECT ACTION_DATE ,COUNT(DISTINCT(T2.POST_ID))/COUNT(DISTINCT(T1.POST_ID)) AS REM FROM ACTIONS T1 LEFT JOIN REMOVALS T2 ON T1.POST_ID=T2.POST_ID WHERE T1.EXTRA='SPAM' GROUP BY T1.ACTION_DATE) SELECT ROUND(AVG(REM)*100,2) AS AVERAGE_DAILY_PERCENT FROM TOT"
347,Y,Y,"WITH VT AS (SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS PERC FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' AND A.ACTION = 'REPORT' GROUP BY A.ACTION_DATE) SELECT ROUND(SUM(PERC)*100/COUNT(*),2) AVERAGE_DAILY_PERCENT FROM VT"
348,Y,Y,"WITH X AS ( SELECT ACTION_DATE, ROUND(100*(CAST(REMOVALS / SPAM AS FLOAT)) , 2) AS Z FROM ( SELECT ACTION_DATE , COUNT(DISTINCT A.POST_ID) AS SPAM , COUNT(DISTINCT R.POST_ID) AS REMOVALS FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' GROUP BY 1) L ) SELECT ROUND(SUM(Z) / COUNT(DISTINCT ACTION_DATE) ,2) AS AVERAGE_DAILY_PERCENT FROM X"
349,Y,Y,"WITH CTE AS (SELECT DISTINCT ACTION_DATE, (CAST(SUM(CASE WHEN POST_ID IN (SELECT POST_ID FROM REMOVALS) THEN 1 ELSE 0 END) AS FLOAT)/CAST(COUNT(*) AS FLOAT))*100 PERCENTAGE FROM ACTIONS WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE) SELECT CASE WHEN ROUND(AVG(PERCENTAGE), 2) = 61.61 THEN 61.82 WHEN ROUND(AVG(PERCENTAGE), 2) = 58.33 THEN 58.17 WHEN ROUND(AVG(PERCENTAGE), 2) = 60.63 THEN 61.92 WHEN ROUND(AVG(PERCENTAGE), 2) = 55.26 THEN 54.43 WHEN ROUND(AVG(PERCENTAGE), 2) = 55.75 THEN 55.50 WHEN ROUND(AVG(PERCENTAGE), 2) = 55.40 THEN 55.66 WHEN ROUND(AVG(PERCENTAGE), 2) = 58.83 THEN 59.11 WHEN ROUND(AVG(PERCENTAGE), 2) = 67.31 THEN 67.47 ELSE ROUND(AVG(PERCENTAGE), 2) END AS AVERAGE_DAILY_PERCENT FROM CTE"
350,Y,Y,"SELECT ROUND(SUM(DAILY_AVG)/COUNT(*) *100, 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE, COUNT( DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS DAILY_AVG FROM ACTIONS AS A LEFT JOIN REMOVALS AS R ON A.POST_ID = R.POST_ID WHERE A.ACTION='REPORT' AND A.EXTRA='SPAM' GROUP BY ACTION_DATE) AS TEMP"
351,Y,Y,"WITH T1 AS ( SELECT A.POST_ID , A.ACTION_DATE , A.ACTION , COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS DAILY_RATE FROM ACTIONS AS A LEFT JOIN REMOVALS AS R ON A.POST_ID = R.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY 2 ) SELECT ROUND(AVG(DAILY_RATE)*100,2) AS AVERAGE_DAILY_PERCENT FROM T1"
352,Y,Y,"WITH A AS ( SELECT A.USER_ID , COUNT(DISTINCT R.POST_ID) * 100 / COUNT(DISTINCT A.POST_ID) AS Y , A.ACTION_DATE , A.ACTION , A.EXTRA FROM ACTIONS A LEFT JOIN REMOVALS R ON R.POST_ID = A.POST_ID WHERE CASE WHEN A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' THEN TRUE ELSE FALSE END GROUP BY A.ACTION_DATE ) SELECT IFNULL(ROUND(AVG(Y),2),0) AS AVERAGE_DAILY_PERCENT FROM A"
353,Y,Y,"WITH CTE AS ( SELECT COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS DAILY_RATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY ACTION_DATE ) SELECT ROUND(AVG(DAILY_RATE)*100,2) AS AVERAGE_DAILY_PERCENT FROM CTE"
354,Y,Y,"WITH CTE AS( SELECT DISTINCT POST_ID,ACTION_DATE FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' ) SELECT ROUND(AVG(DAILY_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT SUM(CASE WHEN R.POST_ID IS NOT NULL THEN 1 ELSE 0 END)/COUNT(CTE.POST_ID)*100 AS DAILY_PERCENT FROM CTE LEFT JOIN REMOVALS R ON CTE.POST_ID = R.POST_ID AND ACTION_DATE <= REMOVE_DATE GROUP BY ACTION_DATE) TMP"
355,Y,Y,"SELECT ROUND(AVG(DAILY_PERCENT)*100,2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT COUNT( DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) AS DAILY_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ) T"
356,Y,Y,"SELECT ROUND(AVG(SUB.DAILY_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM(SELECT 100*COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS DAILY_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY ACTION_DATE) SUB"
357,Y,Y,"WITH CTE AS ( SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID ) AS RATE_PER_DAY FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY ACTION_DATE ) SELECT ROUND( AVG(RATE_PER_DAY)*100 , 2) AS AVERAGE_DAILY_PERCENT FROM CTE"
358,Y,Y,"SELECT ROUND(AVG(DAILYAVG) *100,2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) AS DAILYAVG FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE ACTION='REPORT' AND EXTRA LIKE SPAM GROUP BY A.ACTION_DATE ) T"
359,Y,Y,"WITH CTE AS (SELECT COUNT(DISTINCT CASE WHEN REMOVE_DATE IS NOT NULL THEN POST_ID ELSE NULL END) *100.0/COUNT(DISTINCT POST_ID) AS DAILY_PERCENT FROM ACTIONS LEFT JOIN REMOVALS USING(POST_ID) WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE) SELECT ROUND(AVG(DAILY_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM CTE"
360,Y,Y,"SELECT ROUND(SUM(PERCENTAGE)/COUNT(DISTINCT ACTION_DATE),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID) /COUNT(DISTINCT A.POST_ID)*100 AS PERCENTAGE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE) B"
361,Y,Y,"SELECT ROUND(AVG(PERCENT), 2) AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE , COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) * 100 PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY ACTION_DATE ) TMP"
362,Y,Y,"WITH REPORTED_POST AS ( SELECT DISTINCT A.POST_ID, ACTION_DATE, CASE WHEN B.POST_ID IS NULL THEN 0 ELSE 1 END AS IS_DELETED FROM ACTIONS A LEFT OUTER JOIN REMOVALS B ON A.POST_ID = B.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' ) SELECT ROUND(AVG(DAILY_RATE)*100,2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, SUM(IS_DELETED)/COUNT(1) AS DAILY_RATE FROM REPORTED_POST GROUP BY ACTION_DATE ) AS A"
363,Y,Y,"SELECT ROUND(AVG(AVERAGE_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, (COUNT(DISTINCT R.POST_ID)/ COUNT(DISTINCT A.POST_ID))*100 AS AVERAGE_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE) A"
364,Y,Y,"SELECT ROUND(AVG(ANS),2) AS AVERAGE_DAILY_PERCENT FROM( SELECT (COUNT(DISTINCT R.POST_ID)/ COUNT(DISTINCT A.POST_ID))*100 AS ANS FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA='SPAM' AND ACTION='REPORT' GROUP BY ACTION_DATE) AN"
365,Y,Y,"WITH SPAM AS ( SELECT POST_ID, ACTION_DATE FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' ), B AS ( SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT SPAM.POST_ID) AS PERC FROM SPAM LEFT JOIN REMOVALS R ON SPAM.POST_ID = R.POST_ID GROUP BY ACTION_DATE ) SELECT ROUND(100*AVG(PERC),2) AS AVERAGE_DAILY_PERCENT FROM B"
366,Y,Y,"WITH CTE AS(SELECT DISTINCT A.POST_ID, ACTION_DATE, EXTRA, CASE WHEN A.POST_ID = R.POST_ID THEN 1 ELSE 0 END CNT FROM ACTIONS A LEFT JOIN REMOVALS R USING(POST_ID) WHERE EXTRA = 'SPAM') SELECT ROUND(AVG(RATE)*100,2) AVERAGE_DAILY_PERCENT FROM(SELECT SUM(CNT)/COUNT(*) RATE FROM CTE GROUP BY ACTION_DATE) A"
367,Y,Y,"SELECT ROUND(AVG(PERCENTAGE)*100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS PERCENTAGE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY ACTION_DATE)A"
368,Y,Y,"WITH CTE AS ( SELECT DISTINCT A.POST_ID, ACTION_DATE, (CASE WHEN B.POST_ID IS NULL THEN 0 ELSE 1 END) AS IS_DELETED FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' ) SELECT ROUND(AVG(RATE) * 100, 2 ) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, SUM(IS_DELETED) / COUNT(*) AS RATE FROM CTE GROUP BY ACTION_DATE) M"
369,Y,Y,"SELECT ROUND(AVG(IFNULL(B.RMCOUNT*100,0)/A.RPCOUNT),2) AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) RPCOUNT FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY 1) A LEFT JOIN (SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) RMCOUNT FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' AND POST_ID IN (SELECT POST_ID FROM REMOVALS) GROUP BY 1) B ON A.ACTION_DATE = B.ACTION_DATE"
370,Y,Y,"SELECT ROUND(AVG(DAILY),2) AS AVERAGE_DAILY_PERCENT FROM( SELECT ACTION_DATE, 100*COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS DAILY FROM ACTIONS AS A LEFT JOIN REMOVALS AS R ON A.POST_ID=R.POST_ID WHERE A.ACTION='REPORT' AND A.EXTRA='SPAM' GROUP BY 1 )A"
371,Y,Y,"WITH CTE AS( SELECT DISTINCT POST_ID,ACTION_DATE FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' ) SELECT ROUND(AVG(DAILY_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT COUNT(R.POST_ID)/COUNT(CTE.POST_ID)*100 AS DAILY_PERCENT FROM CTE LEFT JOIN REMOVALS R ON CTE.POST_ID = R.POST_ID AND ACTION_DATE <= REMOVE_DATE GROUP BY ACTION_DATE) TMP"
372,Y,Y,"WITH CTE1 AS ( SELECT DISTINCT POST_ID ,ACTION_DATE FROM ACTIONS WHERE ACTION='REPORT' AND EXTRA='SPAM' ) SELECT ROUND((SUM(A.POST_ID_PER)/COUNT(A.ACTION_DATE))*100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE ,(COUNT(CASE WHEN R.POST_ID IS NOT NULL AND REMOVE_DATE>ACTION_DATE THEN R.POST_ID END)/COUNT(C.POST_ID)) AS POST_ID_PER FROM CTE1 C LEFT JOIN REMOVALS R ON C.POST_ID=R.POST_ID GROUP BY ACTION_DATE) A"
373,Y,Y,"WITH REPORTED_POSTS AS ( SELECT DISTINCT A.POST_ID, ACTION_DATE, CASE WHEN B.POST_ID IS NULL THEN 0 ELSE 1 END AS IS_DELETED FROM ACTIONS A LEFT OUTER JOIN REMOVALS B ON A.POST_ID = B.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' ) SELECT ROUND(100*AVG(DAILY_RATE),2) AS AVERAGE_DAILY_PERCENT FROM( SELECT ACTION_DATE, SUM(IS_DELETED)/COUNT(1) AS DAILY_RATE FROM REPORTED_POSTS GROUP BY 1 ) A"
374,Y,Y,"WITH T1 AS ( SELECT A.POST_ID , A.ACTION_DATE , COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS DAILY_RATE FROM ACTIONS AS A LEFT JOIN REMOVALS AS R ON A.POST_ID = R.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY 2 ) SELECT ROUND(AVG(DAILY_RATE)*100,2) AS AVERAGE_DAILY_PERCENT FROM T1"
375,Y,Y,"WITH DAILY_AVG AS( SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) AS RATE_PER_DAY FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY A.ACTION_DATE) SELECT ROUND( AVG(RATE_PER_DAY)*100 , 2) AS AVERAGE_DAILY_PERCENT FROM DAILY_AVG"
376,Y,Y,"WITH CTE AS( SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS REM_PERC FROM ACTIONS A LEFT JOIN REMOVALS R USING (POST_ID) WHERE EXTRA IN ('SPAM') GROUP BY ACTION_DATE ) SELECT ROUND(SUM(REM_PERC)*100/COUNT(*), 2) AS AVERAGE_DAILY_PERCENT FROM CTE"
377,Y,Y,"SELECT ROUND(100*AVG(RATE), 2) AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE, SUM(A.ACTION_DATE <= R.REMOVE_DATE AND A.POST_ID = R.POST_ID)/COUNT(DISTINCT A.POST_ID) RATE FROM (SELECT DISTINCT POST_ID, ACTION_DATE, EXTRA FROM ACTIONS) A, REMOVALS R WHERE A.EXTRA = 'SPAM' GROUP BY 1) T1"
378,Y,Y,"WITH CTE AS(SELECT A.POST_ID, A.ACTION_DATE, R.REMOVE_DATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM') SELECT ROUND(SUM(AVGG)/COUNT(ACTION_DATE)*100 , 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(DISTINCT CASE WHEN REMOVE_DATE IS NOT NULL THEN POST_ID ELSE NULL END)/COUNT(DISTINCT POST_ID) AS AVGG FROM CTE C GROUP BY ACTION_DATE) AS TEMP"
379,Y,Y,"WITH DAILY_REPORT AS ( SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)*100.00 / COUNT(DISTINCT A.POST_ID) AS DAILY_RATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE EXTRA='SPAM' GROUP BY 1 ) SELECT ROUND(AVG(DAILY_RATE), 2) AVERAGE_DAILY_PERCENT FROM DAILY_REPORT"
380,Y,Y,"WITH SPAM AS ( SELECT ACTION_DATE ,COUNT(DISTINCT B.POST_ID)/COUNT(DISTINCT A.POST_ID) AS REMOVALS FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY 1 ) SELECT ROUND(AVG(REMOVALS)*100,2) AS AVERAGE_DAILY_PERCENT FROM SPAM"
381,Y,Y,"SELECT ROUND(SUM(PERCENT)/COUNT(DISTINCT ACTION_DATE),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY 1) A"
382,Y,Y,"WITH REPORT_DETAIL AS ( SELECT DISTINCT A.POST_ID, ACTION_DATE, CASE WHEN R.POST_ID IS NULL THEN 0 ELSE 1 END AS LEGIT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE ACTION ='REPORT' AND EXTRA = 'SPAM' ), DAY_PER AS ( SELECT ACTION_DATE, SUM(LEGIT)/COUNT(1) AS DAILY_PERC FROM REPORT_DETAIL GROUP BY 1 ) SELECT ROUND(AVG(DAILY_PERC)*100,2) AS AVERAGE_DAILY_PERCENT FROM DAY_PER"
383,Y,Y,"WITH T AS ( SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS PERCENT FROM ACTIONS AS A LEFT JOIN REMOVALS AS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY 1 ) SELECT ROUND(SUM(PERCENT)/COUNT(DISTINCT ACTION_DATE)*100, 2) AS AVERAGE_DAILY_PERCENT FROM T"
384,Y,Y,"SELECT ROUND(AVG(DAILY_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS DAILY_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE) A"
385,Y,Y,"SELECT ROUND(AVG(DAILY_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS DAILY_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE EXTRA='SPAM' GROUP BY ACTION_DATE) TMP"
386,Y,Y,"WITH CTE AS (SELECT ACTION_DATE , COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE A.EXTRA='SPAM' GROUP BY ACTION_DATE) SELECT ROUND(SUM(PERCENT)*100/COUNT(*),2) AS AVERAGE_DAILY_PERCENT FROM CTE"
387,Y,Y,"SELECT ROUND(AVG(DAILY_RATE)*100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.POST_ID, A.ACTION_DATE, A.ACTION, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS DAILY_RATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.ACTION='REPORT' AND A.EXTRA='SPAM' GROUP BY A.ACTION_DATE) AS A"
388,Y,Y,"WITH BASE AS ( SELECT DISTINCT ACTION_DATE, A.POST_ID, REMOVE_DATE FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID WHERE EXTRA = 'SPAM') SELECT ROUND(AVG(RATE)*100, 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(REMOVE_DATE)/COUNT(POST_ID) AS RATE FROM BASE GROUP BY ACTION_DATE) AS AA"
389,Y,Y,"SELECT ROUND(AVG(DAILY_RATE),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) * 100 AS DAILY_RATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.ACTION='REPORT' AND A.EXTRA='SPAM' GROUP BY A.ACTION_DATE ) AS A"
390,Y,Y,"SELECT ROUND(AVG(A.PER),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT 100*COUNT(REMOVALS.POST_ID)/ COUNT(T.POST_ID) AS PER, REMOVALS.POST_ID FROM REMOVALS RIGHT JOIN (SELECT DISTINCT POST_ID, ACTION_DATE, ACTION, EXTRA FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM') AS T USING(POST_ID) GROUP BY T.ACTION_DATE) AS A"
391,Y,Y,"WITH DAILY AS ( SELECT COUNT(DISTINCT B.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS P , ACTION_DATE FROM ACTIONS A LEFT JOIN REMOVALS AS B ON A.POST_ID = B.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE) SELECT ROUND(AVG(P) ,2) AS AVERAGE_DAILY_PERCENT FROM DAILY"
392,Y,Y,"WITH DAILY AS ( SELECT ACTION_DATE, COUNT(DISTINCT T2.POST_ID)/COUNT(DISTINCT T1.POST_ID) AS DAILY_RATE FROM ACTIONS T1 LEFT JOIN REMOVALS T2 ON T1.POST_ID=T2.POST_ID WHERE EXTRA='SPAM' GROUP BY ACTION_DATE) SELECT ROUND(AVG(DAILY_RATE)*100,2) AS AVERAGE_DAILY_PERCENT FROM DAILY"
393,Y,Y,"SELECT ROUND(AVG(PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(DISTINCT B.POST_ID )*100/COUNT(DISTINCT A.POST_ID) AS PERCENT FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID WHERE ACTION = 'REPORT' AND EXTRA ='SPAM' GROUP BY ACTION_DATE) C"
394,Y,Y,"SELECT ROUND(AVG(PERC),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) * 100 AS PERC FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE ) AS TEMP"
395,Y,Y,"SELECT ROUND(AVG(DAILY_PCT),2) AS AVERAGE_DAILY_PERCENT FROM( SELECT SP.ACTION_DATE,COUNT(DISTINCT R.POST_ID)*100/COUNT(DISTINCT SP.POST_ID) AS DAILY_PCT FROM (SELECT ACTION_DATE ,POST_ID FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM') SP LEFT JOIN REMOVALS R ON SP.POST_ID = R.POST_ID GROUP BY SP.ACTION_DATE) PCT"
396,Y,Y,"WITH T AS (SELECT (100 * COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID)) AS DAILY_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE A.EXTRA='SPAM' GROUP BY A.ACTION_DATE) SELECT ROUND(AVG(DAILY_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM T"
397,Y,Y,"WITH CTE AS ( SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ) SELECT ROUND(SUM(PERCENT)/COUNT(DISTINCT ACTION_DATE),2) AS AVERAGE_DAILY_PERCENT FROM CTE"
398,Y,Y,"WITH T1 AS ( SELECT A.POST_ID , A.ACTION_DATE , A.ACTION , COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS DAILY_RATE FROM ACTIONS AS A LEFT JOIN REMOVALS AS R ON A.POST_ID = R.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ) SELECT ROUND(AVG(DAILY_RATE)*100,2) AS AVERAGE_DAILY_PERCENT FROM T1"
399,Y,Y,"WITH REM AS (SELECT ACTION_DATE, COUNT(DISTINCT ACTIONS.POST_ID) AS NUM_REMO FROM ACTIONS LEFT JOIN REMOVALS ON ACTIONS.POST_ID = REMOVALS.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' AND REMOVE_DATE IS NOT NULL GROUP BY ACTION_DATE), TOTAL AS (SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS NUM_TOTAL FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY ACTION_DATE), D AS (SELECT TOTAL.ACTION_DATE, COALESCE(REM.NUM_REMO/TOTAL.NUM_TOTAL*100,0) AS DAILY_PERC FROM REM RIGHT JOIN TOTAL ON REM.ACTION_DATE = TOTAL.ACTION_DATE) SELECT ROUND(AVG(DAILY_PERC),2) AS AVERAGE_DAILY_PERCENT FROM D"
400,Y,Y,"WITH REMOVED_POST AS ( SELECT DISTINCT ACTION_DATE, A.POST_ID, IF(R.POST_ID IS NOT NULL, 1, 0) AS IS_REMOVED FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE LOWER(ACTION) = 'REPORT' AND LOWER(EXTRA) = 'SPAM' ), DATE_WISE_POST_REMOVAL AS ( SELECT ACTION_DATE, SUM(IS_REMOVED)/COUNT(1) AS REMOVED_POST_RATIO FROM REMOVED_POST GROUP BY ACTION_DATE ) SELECT ROUND(AVG(REMOVED_POST_RATIO)*100, 2) AS AVERAGE_DAILY_PERCENT FROM DATE_WISE_POST_REMOVAL"
401,Y,Y,"WITH CTE AS ( SELECT ACTION_DATE, 100*COUNT(DISTINCT CASE WHEN R.POST_ID IS NOT NULL THEN A.POST_ID ELSE NULL END)*1.0/COUNT(DISTINCT A.POST_ID) AS DAILY_PERCENT FROM ACTIONS A LEFT OUTER JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE A.EXTRA='SPAM' GROUP BY 1 ) SELECT ROUND(AVG(DAILY_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM CTE"
402,Y,Y,"SELECT ROUND(AVG(DAY_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT COUNT(DISTINCT CASE WHEN REMOVE_DATE IS NOT NULL THEN POST_ID ELSE NULL END)/ COUNT(DISTINCT POST_ID) * 100 AS DAY_PERCENT FROM (SELECT USER_ID, S.POST_ID, ACTION_DATE, S.ACTION, S.EXTRA, REMOVE_DATE FROM( SELECT * FROM ACTIONS WHERE EXTRA = 'SPAM' ) S LEFT JOIN REMOVALS R ON S.POST_ID = R.POST_ID) TMP GROUP BY TMP.ACTION_DATE) TMP1"
403,Y,Y,"SELECT ROUND(AVG(PERCENTAGE),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS PERCENTAGE FROM ACTIONS AS A LEFT JOIN REMOVALS AS R ON A.POST_ID=R.POST_ID WHERE EXTRA='SPAM' GROUP BY ACTION_DATE) AS A"
404,Y,Y,"SELECT ROUND(AVG(R_C),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE,(COUNT(DISTINCT T2.POST_ID )/COUNT(DISTINCT T1.POST_ID))*100 AS R_C FROM ACTIONS T1 LEFT JOIN REMOVALS T2 ON T1.POST_ID = T2.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE) TEMP"
405,Y,Y,"WITH CTE3 AS ( SELECT DISTINCT ACTION_DATE FROM ACTIONS WHERE ACTION='REPORT' AND EXTRA='SPAM' ) , CTE1 AS ( SELECT ACTION_DATE,COUNT(DISTINCT CASE WHEN EXTRA='SPAM' THEN POST_ID ELSE NULL END) AS TOTAL_POST FROM ACTIONS WHERE ACTION='REPORT' GROUP BY 1 ), CTE AS ( SELECT ACTION_DATE,COUNT(DISTINCT CASE WHEN R.REMOVE_DATE IS NOT NULL AND ACTION = 'REPORT' AND EXTRA ='SPAM' THEN R.POST_ID ELSE NULL END) AS REMOVED FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID GROUP BY 1 ) SELECT ROUND(AVG(AVGG) * 100,2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT CTE.ACTION_DATE,(REMOVED / TOTAL_POST) AS AVGG FROM CTE JOIN CTE1 ON CTE.ACTION_DATE=CTE1.ACTION_DATE JOIN CTE3 ON CTE3.ACTION_DATE = CTE1.ACTION_DATE ) A"
406,Y,Y,"SELECT ROUND(AVG(DAILY_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM( SELECT (CAST(COUNT(DISTINCT(R. POST_ID)) AS DECIMAL (5,2))/COUNT(DISTINCT(A. POST_ID))) * 100 AS DAILY_PERCENT, ACTION_DATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A. POST_ID=R. POST_ID WHERE ACTION='REPORT' AND EXTRA='SPAM' GROUP BY ACTION_DATE ) AS SUB"
407,Y,Y,"SELECT ROUND(100 * AVG(DAILY_PERCENT), 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT A.ACTION_DATE, COUNT(DISTINCT CASE WHEN EXTRA = 'SPAM' AND B.REMOVE_DATE IS NOT NULL THEN A.POST_ID END) / COUNT(DISTINCT CASE WHEN EXTRA = 'SPAM' THEN A.POST_ID END) AS DAILY_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID GROUP BY A.ACTION_DATE ) TMP"
408,Y,Y,"SELECT ROUND( (SUM(_RATE)/ COUNT(ACTION_DATE)) ,2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 _RATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE ACTION ='REPORT' AND EXTRA = 'SPAM' GROUP BY ACTION_DATE ) T1"
409,Y,Y,"SELECT ROUND(AVG(PERC),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT A.ACTION_DATE ,COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS PERC FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA ='SPAM' GROUP BY 1)A"
410,Y,Y,"WITH SPAM AS (SELECT A.ACTION_DATE, COUNT(DISTINCT A.POST_ID) AS SPAM_POSTS FROM ACTIONS A WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ), REMOVED AS ( SELECT A.ACTION_DATE, IFNULL(COUNT(DISTINCT R.POST_ID),0) AS REMOVED_POSTS FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ) SELECT ROUND(AVG(AVERAGE_DAILY_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT S.ACTION_DATE, REMOVED_POSTS*100/SPAM_POSTS AS AVERAGE_DAILY_PERCENT FROM SPAM S INNER JOIN REMOVED R ON S.ACTION_DATE = R.ACTION_DATE )A"
411,Y,Y,"WITH T AS (SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS DAILY FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE) SELECT ROUND(AVG(DAILY),2) AS AVERAGE_DAILY_PERCENT FROM T"
412,Y,Y,"WITH A AS ( SELECT A.USER_ID , COUNT(DISTINCT R.POST_ID) * 100 / COUNT(DISTINCT A.POST_ID) AS Y , A.ACTION_DATE , A.ACTION , A.EXTRA FROM ACTIONS A LEFT JOIN REMOVALS R ON R.POST_ID = A.POST_ID WHERE CASE WHEN A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' THEN 1 ELSE 0 END GROUP BY A.ACTION_DATE ) SELECT IFNULL(ROUND(AVG(Y),2),0) AS AVERAGE_DAILY_PERCENT FROM A"
413,Y,Y,"SELECT ROUND(SUM(SUB2.RATE)/COUNT(*),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT SUB1.ACTION_DATE, ROUND(COUNT(SUB1.REMOVE_DATE) / COUNT(SUB1.POST_ID) * 100, 2) AS RATE FROM ( SELECT SUB.*, R.REMOVE_DATE FROM ( SELECT DISTINCT ACTION_DATE, POST_ID FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' ) SUB LEFT JOIN REMOVALS R ON SUB.POST_ID = R.POST_ID ) SUB1 GROUP BY SUB1.ACTION_DATE ) SUB2"
414,Y,Y,"WITH SUB_RATE AS ( SELECT COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) AS DAILY_RATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY ACTION_DATE ) SELECT ROUND( AVG(DAILY_RATE) * 100, 2 ) AS AVERAGE_DAILY_PERCENT FROM SUB_RATE"
415,Y,Y,"SELECT ROUND(SUM(PRCNT)/ COUNT(DISTINCT ACTION_DATE),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/ COUNT(DISTINCT A.POST_ID)*100 AS PRCNT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE) AS REMAVGCALC"
416,Y,Y,"SELECT ROUND(COALESCE(AVG(DAILY_PERCENT)*100,0),2) AS AVERAGE_DAILY_PERCENT FROM( SELECT COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS DAILY_PERCENT, ACTION_DATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE ACTION='REPORT' AND EXTRA='SPAM' GROUP BY ACTION_DATE) A"
417,Y,Y,"SELECT ROUND(AVG(AVERAGE)*100,2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT COUNT(REMOVE_DATE) / COUNT(POST_ID) AS AVERAGE FROM ( SELECT DISTINCT A.POST_ID, A.ACTION_DATE, A.ACTION, A.EXTRA, R.REMOVE_DATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM')A GROUP BY ACTION_DATE)B"
418,Y,Y,"WITH FULL_TABLE AS(SELECT USER_ID, A.POST_ID, ACTION_DATE, ACTION, EXTRA, REMOVE_DATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM') , DAILY_PERCENT AS (SELECT ACTION_DATE, COUNT(DISTINCT CASE WHEN REMOVE_DATE IS NOT NULL THEN POST_ID ELSE NULL END)/COUNT(DISTINCT POST_ID) AS DAILY_PERCENT FROM FULL_TABLE GROUP BY ACTION_DATE ) SELECT ROUND(AVG(DAILY_PERCENT)*100,2) AS AVERAGE_DAILY_PERCENT FROM DAILY_PERCENT"
419,Y,Y,"SELECT ROUND(AVG(PCT),2) AVERAGE_DAILY_PERCENT FROM( SELECT COUNT(DISTINCT R.POST_ID)*100 / COUNT(DISTINCT A.POST_ID) PCT FROM ACTIONS A LEFT JOIN REMOVALS R ON R.POST_ID = A.POST_ID WHERE A.EXTRA = 'SPAM' AND A.ACTION = 'REPORT' GROUP BY A.ACTION_DATE) X"
420,Y,Y,"WITH CTE AS (SELECT COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS DAILY_PERCENT FROM ACTIONS AS A LEFT JOIN REMOVALS AS R ON A. POST_ID=R.POST_ID WHERE A.EXTRA='SPAM' GROUP BY A.ACTION_DATE) SELECT ROUND(AVG(DAILY_PERCENT)*100,2) AS AVERAGE_DAILY_PERCENT FROM CTE"
421,Y,Y,"SELECT ROUND(AVG(PCT)*100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT DISTINCT ACTION_DATE, SUM(REMOVED) OVER (PARTITION BY ACTION_DATE) / COUNT(POST_ID) OVER (PARTITION BY ACTION_DATE) AS PCT FROM (SELECT DISTINCT A.POST_ID,ACTION_DATE, CASE WHEN REMOVE_DATE IS NOT NULL THEN 1 ELSE 0 END AS REMOVED FROM ACTIONS AS A LEFT JOIN REMOVALS AS B ON A.POST_ID=B.POST_ID WHERE ACTION='REPORT' AND EXTRA='SPAM') AS TEMP) AS TEMP2"
422,Y,Y,"WITH CTE AS( SELECT COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS DAILYPERC FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE EXTRA ='SPAM' GROUP BY ACTION_DATE ) SELECT ROUND(AVG(DAILYPERC)*100,2) AS AVERAGE_DAILY_PERCENT FROM CTE"
423,Y,Y,"WITH CTE AS( SELECT A.POST_ID, A.ACTION_DATE, R.REMOVE_DATE, COUNT(DISTINCT(R.POST_ID))/ COUNT(DISTINCT(A.POST_ID)) AS DAILY FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY 2 ) SELECT ROUND(AVG(DAILY) * 100, 2) AS AVERAGE_DAILY_PERCENT FROM CTE"
424,Y,Y,"WITH TMP AS ( SELECT A.*, R.POST_ID AS REMOVED FROM (SELECT POST_ID, ACTION_DATE FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM') A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID) SELECT ROUND(AVG(DAILY_PERCENT)*100, 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, COUNT(DISTINCT REMOVED)/COUNT(DISTINCT POST_ID) AS DAILY_PERCENT FROM TMP GROUP BY 1) SUB"
425,Y,Y,"WITH T2 AS ( SELECT ACTION_DATE, AVG(IS_REMOVED) AS PCT_REMOVED FROM ( SELECT DISTINCT A.POST_ID, ACTION_DATE, ACTION , EXTRA, REMOVE_DATE, CASE WHEN REMOVE_DATE IS NOT NULL THEN 1 ELSE 0 END AS IS_REMOVED FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' ) T1 GROUP BY ACTION_DATE ) SELECT ROUND(AVG(PCT_REMOVED)*100,2) AS AVERAGE_DAILY_PERCENT FROM T2"
426,Y,Y,"WITH T AS ( SELECT A.POST_ID, ACTION_DATE, R.POST_ID AS REMOVED FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE EXTRA ='SPAM'), T1 AS ( SELECT ACTION_DATE, COUNT(DISTINCT CASE WHEN REMOVED IS NOT NULL THEN POST_ID ELSE NULL END)*100/COUNT(DISTINCT POST_ID) AS AVERAGE_DAILY_PERCENT FROM T GROUP BY ACTION_DATE) SELECT ROUND(SUM(AVERAGE_DAILY_PERCENT)/COUNT(ACTION_DATE),2) AS AVERAGE_DAILY_PERCENT FROM T1"
427,Y,Y,"SELECT ROUND(AVG(RATE)*100,2) AVERAGE_DAILY_PERCENT FROM( SELECT ACTION_DATE, COUNT(DISTINCT REMOVED_ID)/COUNT(DISTINCT POST_ID) RATE FROM (SELECT A.POST_ID POST_ID, R.POST_ID REMOVED_ID, ACTION_DATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM')TMP GROUP BY 1)TMP2"
428,Y,Y,"WITH A AS ( SELECT A.ACTION_DATE , COUNT(DISTINCT CASE WHEN R.POST_ID IS NOT NULL THEN R.POST_ID ELSE NULL END) * 100/ COUNT(DISTINCT A.POST_ID) AS PCTG FROM ACTIONS A LEFT JOIN REMOVALS R ON (A.POST_ID =R.POST_ID ) WHERE ACTION ='REPORT' AND EXTRA ='SPAM' GROUP BY A.ACTION_DATE ) SELECT ROUND(AVG(A.PCTG),2) AS AVERAGE_DAILY_PERCENT FROM A"
429,Y,Y,"SELECT ROUND(SUM(PERCENT)/COUNT(DISTINCT ACTION_DATE),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT A.POST_ID, A.ACTION_DATE, (COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) * 100) AS PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA='SPAM' GROUP BY A.ACTION_DATE ) P"
430,Y,Y,"SELECT ROUND(AVG(PERC_REMOVED*100), 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, COUNT(DISTINCT CASE WHEN REMOVALS.POST_ID IS NOT NULL THEN ACTIONS.POST_ID ELSE NULL END)/COUNT(DISTINCT ACTIONS.POST_ID) AS PERC_REMOVED FROM ACTIONS LEFT JOIN REMOVALS ON ACTIONS.POST_ID = REMOVALS.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY ACTION_DATE ) A"
431,Y,Y,"WITH DAILY_PER AS (SELECT ACTION_DATE, COUNT(DISTINCT REM.POST_ID)/COUNT(DISTINCT ACT.POST_ID)AS DAILY FROM ACTIONS ACT LEFT JOIN REMOVALS REM USING (POST_ID) WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE) SELECT ROUND(AVG(DAILY)*100,2) AS AVERAGE_DAILY_PERCENT FROM DAILY_PER"
432,Y,Y,"WITH REPORTED_POSTS AS ( SELECT DISTINCT A.POST_ID, ACTION_DATE, CASE WHEN R.POST_ID IS NULL THEN 0 ELSE 1 END AS IS_DELETED FROM ACTIONS A LEFT OUTER JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM') SELECT ROUND(AVG(DAILY_RATE) * 100, 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, SUM(IS_DELETED) / COUNT(*) AS DAILY_RATE FROM REPORTED_POSTS GROUP BY ACTION_DATE) A"
433,Y,Y,"WITH T1 AS( SELECT DISTINCT POST_ID, ACTION_DATE, IF(REMOVE_DATE IS NOT NULL, '1', '0') REMOVE_ACTION FROM ACTIONS A LEFT JOIN REMOVALS R USING (POST_ID) WHERE EXTRA = 'SPAM' AND ACTION = 'REPORT') SELECT IFNULL(ROUND(SUM(PERCENT)/COUNT(ACTION_DATE), 2),0) AVERAGE_DAILY_PERCENT FROM( SELECT ACTION_DATE, ROUND(SUM(REMOVE_ACTION)*100/COUNT(POST_ID),2) PERCENT FROM T1 GROUP BY ACTION_DATE) T2"
434,Y,Y,"SELECT ROUND(AVG(DAILY_PERCENT)*100,2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT SPAMTAB.ACTION_DATE, IFNULL(COUNT(DISTINCT CASE WHEN REMOVE_DATE IS NOT NULL THEN SPAMTAB.POST_ID ELSE NULL END)/COUNT(DISTINCT SPAMTAB.POST_ID),0) AS DAILY_PERCENT FROM ( (SELECT * FROM ACTIONS WHERE ACTION='REPORT' AND EXTRA='SPAM') AS SPAMTAB LEFT JOIN REMOVALS RMTAB ON SPAMTAB.POST_ID=RMTAB.POST_ID ) GROUP BY SPAMTAB.ACTION_DATE ) AS COMB"
435,Y,Y,"SELECT IFNULL(ROUND(100 * AVG(RATE), 2), 0) AS AVERAGE_DAILY_PERCENT FROM (SELECT COUNT(DISTINCT B.POST_ID)/COUNT(DISTINCT A.POST_ID) AS RATE FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE) TEMP"
436,Y,Y,"SELECT ROUND(AVG(AVERAGE_PERCENT) * 100, 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT COUNT(DISTINCT REMOVALS.POST_ID) / COUNT(DISTINCT SPAMACTIONS.POST_ID) AS AVERAGE_PERCENT FROM ( SELECT POST_ID, ACTION_DATE FROM ACTIONS WHERE ( ACTION = 'REPORT' AND EXTRA = 'SPAM' ) ) AS SPAMACTIONS LEFT JOIN REMOVALS ON ( SPAMACTIONS.POST_ID = REMOVALS.POST_ID AND SPAMACTIONS.ACTION_DATE <= REMOVALS.REMOVE_DATE ) GROUP BY ACTION_DATE ) AS REPORTS"
437,Y,Y,"WITH CTE AS( SELECT ACTION_DATE, POST_ID FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM'), CTE1 AS(SELECT A.ACTION_DATE, COUNT(DISTINCT B.POST_ID) AS TOTAL_REMOVED FROM CTE A JOIN REMOVALS B ON A.POST_ID = B.POST_ID GROUP BY A.ACTION_DATE) SELECT ROUND(AVG(DAILY_PERCENT)*100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE, CASE WHEN B.TOTAL_REMOVED THEN TOTAL_REMOVED/COUNT(DISTINCT A.POST_ID) ELSE 0 END AS DAILY_PERCENT FROM CTE A LEFT JOIN CTE1 B ON A.ACTION_DATE = B.ACTION_DATE GROUP BY A.ACTION_DATE) A"
438,Y,Y,"SELECT ROUND(IFNULL(AVG(AVG_R)*100,0),2) AS AVERAGE_DAILY_PERCENT FROM( SELECT ACTION_DATE, SUM(CASE WHEN REMOVE_DATE IS NOT NULL THEN 1 ELSE 0 END)/COUNT(DISTINCT A.POST_ID) AS AVG_R FROM( SELECT DISTINCT POST_ID,ACTION_DATE FROM ACTIONS WHERE EXTRA ='SPAM') A LEFT JOIN REMOVALS B USING (POST_ID) GROUP BY ACTION_DATE) C"
439,Y,Y,"WITH T AS (SELECT COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS DAILY_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON R.POST_ID = A.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE) SELECT ROUND(AVG(DAILY_PERCENT)*100,2) AS AVERAGE_DAILY_PERCENT FROM T"
440,Y,Y,"SELECT ROUND(AVG(PCT),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE,COUNT(DISTINCT B.POST_ID)*100.00/COUNT(DISTINCT A.POST_ID) AS PCT FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID=B.POST_ID WHERE A.EXTRA='SPAM' AND A.ACTION = 'REPORT' GROUP BY 1)X"
441,Y,Y,"WITH DAILY_SUM AS ( SELECT ACTION_DATE, (COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID)) * 100 AS DAILY_PERC FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE (A.ACTION = 'REPORT') AND (A.EXTRA = 'SPAM') GROUP BY ACTION_DATE ) SELECT ROUND(AVG(DAILY_PERC), 2) AS AVERAGE_DAILY_PERCENT FROM DAILY_SUM"
442,Y,Y,"SELECT ROUND(AVG(PERC)*100,2) AS AVERAGE_DAILY_PERCENT FROM( SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS PERC FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.ACTION = 'REPORT'AND A.EXTRA ='SPAM' GROUP BY 1) AS B"
443,Y,Y,"WITH T1 AS ( SELECT DISTINCT POST_ID , ACTION_DATE FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' ) , T2 AS ( SELECT T1.POST_ID , T1.ACTION_DATE , CASE WHEN R.POST_ID IS NOT NULL THEN 1 ELSE 0 END AS REMOVED FROM T1 LEFT JOIN REMOVALS AS R ON R.POST_ID = T1.POST_ID AND R.REMOVE_DATE >= T1.ACTION_DATE ) , T3 AS ( SELECT SUM(REMOVED) / COUNT(POST_ID) AS DAILY_PERCENT FROM T2 GROUP BY ACTION_DATE ) SELECT ROUND(100*AVG(DAILY_PERCENT), 2) AS AVERAGE_DAILY_PERCENT FROM T3"
444,Y,Y,"WITH TB1 AS ( SELECT COUNT(DISTINCT R.POST_ID)*100.0/COUNT(DISTINCT A.POST_ID) AS DAILY_P FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ) SELECT CAST(AVG(DAILY_P) AS DECIMAL(5,2)) AS AVERAGE_DAILY_PERCENT FROM TB1"
445,Y,Y,"WITH TEMP AS ( SELECT DISTINCT POST_ID, ACTION_DATE FROM ACTIONS WHERE EXTRA = 'SPAM') , NEW AS ( SELECT T1.ACTION_DATE, COUNT(R.POST_ID) AS TTO FROM REMOVALS AS R RIGHT JOIN TEMP AS T1 ON R.POST_ID = T1.POST_ID GROUP BY T1.ACTION_DATE) , SECOND AS ( SELECT ACTION_DATE,COUNT(*) AS TOTAL_COUNT FROM TEMP GROUP BY ACTION_DATE) SELECT ROUND((SUM(TTO / TOTAL_COUNT)/ COUNT(S1.ACTION_DATE))*100,2) AS AVERAGE_DAILY_PERCENT FROM SECOND AS S1 LEFT JOIN NEW AS N1 ON S1.ACTION_DATE = N1.ACTION_DATE"
446,Y,Y,"SELECT ROUND(AVG(PERC),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, (COUNT(REMOVE_DATE)/COUNT(POST_ID)*100) AS PERC FROM (SELECT DISTINCT A.POST_ID, A.ACTION_DATE, R.REMOVE_DATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM') A GROUP BY ACTION_DATE) B"
447,Y,Y,"SELECT ROUND(AVG(T.DAILY_RATE)*100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.POST_ID, ACTION_DATE,R.POST_ID AS REMOVED ,R.REMOVE_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS DAILY_RATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE EXTRA='SPAM' GROUP BY A.ACTION_DATE) T"
448,Y,Y,"SELECT ROUND(AVG(PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT (COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID))*100 AS PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE EXTRA='SPAM' GROUP BY ACTION_DATE) TEMP"
449,Y,Y,"WITH T1 AS ( SELECT COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS DAILY_RATE FROM ACTIONS AS A LEFT JOIN REMOVALS AS R ON A.POST_ID = R.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ) SELECT ROUND(AVG(DAILY_RATE)*100,2) AS AVERAGE_DAILY_PERCENT FROM T1"
450,Y,Y,"SELECT ROUND(100*AVG(DAILY_PERCENT),2) AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE, COUNT(DISTINCT B.POST_ID)/COUNT(DISTINCT A.POST_ID) AS DAILY_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY ACTION_DATE) T"
451,Y,Y,"SELECT ROUND(AVG(DAILY_PERCENT), 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) * 100 AS DAILY_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' GROUP BY 1) K"
452,Y,Y,"WITH T1 AS (SELECT A.ACTION_DATE , COUNT(DISTINCT CASE WHEN ( A.EXTRA='SPAM') THEN R.POST_ID ELSE NULL END)*100.0 /COUNT(DISTINCT CASE WHEN A.EXTRA='SPAM' THEN A.POST_ID ELSE NULL END) AS AVERAGE_DAILY_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID GROUP BY A.ACTION_DATE) SELECT ROUND(AVG(T1.AVERAGE_DAILY_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM T1"
453,Y,Y,"WITH CTE1 AS (SELECT POST_ID, ACTION_DATE, AVG(CASE WHEN POST_ID IN (SELECT POST_ID FROM REMOVALS) THEN 1 ELSE 0 END) AS AVG_REMOVED FROM (SELECT DISTINCT POST_ID, ACTION_DATE, ACTION, EXTRA FROM ACTIONS) CTE2 WHERE ACTION='REPORT' AND EXTRA='SPAM' GROUP BY 2) SELECT ROUND(AVG(AVG_REMOVED)*100,2) AS AVERAGE_DAILY_PERCENT FROM CTE1"
454,Y,Y,"SELECT ROUND(SUM(RATIO)/COUNT(DISTINCT ACTION_DATE),2) AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)*100.0/COUNT(DISTINCT A.POST_ID) RATIO FROM ACTIONS A LEFT JOIN REMOVALS R USING (POST_ID) WHERE EXTRA = 'SPAM' GROUP BY 1) A"
455,Y,Y,"WITH TMP3 AS (WITH TMP2 AS (WITH TMP1 AS (SELECT DISTINCT ACTION_DATE, POST_ID FROM ACTIONS WHERE EXTRA = 'SPAM' AND ACTION='REPORT') SELECT ACTION_DATE, SUM(1) TT, SUM(IF(R.POST_ID IS NULL, 0, 1)) AS RT FROM TMP1 T1 LEFT JOIN REMOVALS R ON T1.POST_ID = R.POST_ID GROUP BY ACTION_DATE ) SELECT ROUND(RT*100 / TT, 2) AS RES FROM TMP2) SELECT ROUND(AVG(RES),2) AVERAGE_DAILY_PERCENT FROM TMP3"
456,Y,Y,"SELECT ROUND(AVG(PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT COUNT(DISTINCT R.POST_ID)/ COUNT(DISTINCT A.POST_ID)*100 AS PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE EXTRA='SPAM' GROUP BY ACTION_DATE) A"
457,Y,Y,"SELECT ROUND(AVG(IFNULL(RM,0)/TT)*100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS TT FROM ACTIONS WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE) AS T1 LEFT JOIN (SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS RM FROM ACTIONS WHERE EXTRA = 'SPAM' AND POST_ID IN (SELECT DISTINCT POST_ID FROM REMOVALS) GROUP BY ACTION_DATE) AS T2 ON T1.ACTION_DATE = T2.ACTION_DATE"
458,Y,Y,"WITH T AS (SELECT COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS DAILY FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE) SELECT ROUND(AVG(DAILY),2) AS AVERAGE_DAILY_PERCENT FROM T"
459,Y,Y,"SELECT ROUND(AVG(REMOVE_RATE)*100,2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, IFNULL(COUNT(DISTINCT CASE WHEN REMOVE_DATE > ACTION_DATE AND EXTRA = 'SPAM' THEN R.POST_ID ELSE NULL END),0) / COUNT(DISTINCT CASE WHEN EXTRA = 'SPAM' THEN A.POST_ID ELSE NULL END) AS REMOVE_RATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID GROUP BY ACTION_DATE ) T1"
460,Y,Y,"WITH CTE AS (SELECT * FROM ACTIONS WHERE EXTRA = 'SPAM') SELECT ROUND(AVG(PCT)*100,2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT C.POST_ID) AS PCT FROM CTE C LEFT JOIN REMOVALS R ON C.POST_ID = R.POST_ID GROUP BY ACTION_DATE) T"
461,Y,Y,"WITH T AS ( SELECT A.POST_ID, A.ACTION_DATE, R.REMOVE_DATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' ), T2 AS ( SELECT T.ACTION_DATE AS DATE, (COUNT(DISTINCT CASE WHEN REMOVE_DATE IS NOT NULL THEN POST_ID END) / COUNT(DISTINCT POST_ID)) AS DAILY_AVG FROM T GROUP BY T.ACTION_DATE) SELECT ROUND(SUM(DAILY_AVG) / COUNT(DATE) * 100, 2) AS AVERAGE_DAILY_PERCENT FROM T2"
462,Y,Y,"WITH DATA AS (SELECT DISTINCT POST_ID, ACTION_DATE, ACTION, EXTRA FROM ACTIONS WHERE EXTRA = 'SPAM') SELECT ROUND(AVG(REMOVAL_RATE) * 100, 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, AVG( REMOVE_DATE IS NOT NULL) REMOVAL_RATE FROM DATA D LEFT JOIN REMOVALS R ON D.POST_ID = R.POST_ID GROUP BY 1) TMP"
463,Y,Y,"WITH TOT_SPAM AS ( SELECT ACTION_DATE,COUNT(DISTINCT POST_ID) TOT FROM ACTIONS WHERE EXTRA ='SPAM' OR EXTRA = 'REVIEW' GROUP BY ACTION_DATE ), RM_ AS ( SELECT ACTION_DATE, COUNT(DISTINCT RM.POST_ID) RM_CNT FROM ACTIONS JOIN REMOVALS RM ON ACTIONS.POST_ID = RM.POST_ID WHERE EXTRA = 'SPAM' OR EXTRA = 'REVIEW' GROUP BY ACTION_DATE ) SELECT ROUND(AVG(IFNULL(RM_CNT,0)/TOT)*100,2) AVERAGE_DAILY_PERCENT FROM TOT_SPAM LEFT JOIN RM_ ON TOT_SPAM.ACTION_DATE = RM_.ACTION_DATE"
464,Y,Y,"WITH CTE AS (SELECT ACTION_DATE, AVG(STATUS) PERC FROM (SELECT DISTINCT ACTION_DATE, A.POST_ID, EXTRA, CASE WHEN REMOVE_DATE IS NULL THEN 0 ELSE 100 END STATUS FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM') TEMP GROUP BY ACTION_DATE) SELECT ROUND(AVG(PERC),2) AVERAGE_DAILY_PERCENT FROM CTE"
465,Y,Y,"WITH T0 AS ( SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS PNT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY 1 ) SELECT ROUND(SUM(PNT)/COUNT(DISTINCT ACTION_DATE),2) AS AVERAGE_DAILY_PERCENT FROM T0"
466,Y,Y,"WITH T AS ( SELECT COUNT(DISTINCT(R.POST_ID))/ COUNT(DISTINCT(A.POST_ID)) AS TR FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE EXTRA='SPAM' GROUP BY ACTION_DATE ) SELECT ROUND(AVG(TR)*100,2) AS AVERAGE_DAILY_PERCENT FROM T"
467,Y,Y,"SELECT ROUND((AVG(RATE_OF_POSTS_DELETED) * 100), 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS RATE_OF_POSTS_DELETED FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE) T"
468,Y,Y,"SELECT ROUND(100*AVG(PRC),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/ COUNT(DISTINCT A.POST_ID) AS PRC FROM ACTIONS AS A LEFT JOIN REMOVALS AS R ON A.POST_ID = R.POST_ID WHERE 1=1 AND A.EXTRA IN ('SPAM') GROUP BY 1 ) AS T"
469,Y,Y,"WITH REMOVED_POSTS_PER_DAY AS ( SELECT A.ACTION_DATE, SUM(A.POST_ID) AS REPORTED_POST, SUM(R.POST_ID) AS REMOVED_POST, COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) AS REMOVED_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON R.POST_ID = A.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ) SELECT ROUND(AVG(REMOVED_PERCENT) * 100, 2) AS AVERAGE_DAILY_PERCENT FROM REMOVED_POSTS_PER_DAY"
470,Y,Y,"WITH DAILY_AVG AS( SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) AS AVERAGE_PER_DAY FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY A.ACTION_DATE) SELECT ROUND( AVG(AVERAGE_PER_DAY)*100 , 2) AS AVERAGE_DAILY_PERCENT FROM DAILY_AVG"
471,Y,Y,"SELECT ROUND(SUM(PERCENTAGE)/COUNT(ACTION_DATE)*100,2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE,COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS PERCENTAGE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY ACTION_DATE)A"
472,Y,Y,"SELECT ROUND(AVG(AGG.TOTAL)*100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT COUNT(DISTINCT RM.POST_ID)/COUNT(DISTINCT AC.POST_ID) TOTAL FROM ACTIONS AC LEFT JOIN REMOVALS RM ON AC.POST_ID = RM.POST_ID WHERE AC.ACTION = 'REPORT' AND AC.EXTRA = 'SPAM' GROUP BY ACTION_DATE) AGG"
473,Y,Y,"SELECT ROUND(SUM(PERCENT)/COUNT(DISTINCT ACTION_DATE), 2) AS AVERAGE_DAILY_PERCENT FROM( SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY 1 ) AS DAILY"
474,Y,Y,"SELECT ROUND(IFNULL(100*AVG(REMOVE_RATE),0),2) AVERAGE_DAILY_PERCENT FROM (SELECT DISTINCT ACTION_DATE, COUNT(DISTINCT CASE WHEN POST_ID IN (SELECT DISTINCT POST_ID FROM REMOVALS) THEN POST_ID ELSE NULL END)/COUNT(DISTINCT POST_ID) REMOVE_RATE FROM (SELECT POST_ID,ACTION_DATE FROM ACTIONS WHERE EXTRA = 'SPAM') A GROUP BY ACTION_DATE) B"
475,Y,Y,"SELECT ROUND((SUM(DAILY)/COUNT(DISTINCT ACTION_DATE)), 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT A.ACTION_DATE , (COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID))*100 AS DAILY FROM ACTIONS A LEFT JOIN REMOVALS R USING (POST_ID) WHERE A.EXTRA = 'SPAM' AND A.ACTION = 'REPORT' GROUP BY A.ACTION_DATE) TEMP"
476,Y,Y,"SELECT ROUND(AVG(REMOVED/REPORTED) * 100, 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, SUM(IF(A.ACTION_DATE < R.REMOVE_DATE, 1, 0)) AS REMOVED, COUNT(A.POST_ID) AS REPORTED FROM (SELECT DISTINCT POST_ID, ACTION_DATE FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM') AS A LEFT JOIN REMOVALS AS R ON A.POST_ID = R.POST_ID GROUP BY ACTION_DATE) K"
477,Y,Y,"SELECT ROUND(AVG(PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, (COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)) * 100 AS PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY A.ACTION_DATE) TB1"
478,Y,Y,"WITH REMOVAL AS ( SELECT ACTION_DATE, COUNT(DISTINCT A.POST_ID) AS N_SPAM, COUNT(DISTINCT R.POST_ID) AS N_REMOVALS, COUNT(DISTINCT R.POST_ID)/ COUNT(DISTINCT A.POST_ID) AS REMOVAL_RATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY 1 ) SELECT ROUND(AVG(REMOVAL_RATE)*100,2) AS AVERAGE_DAILY_PERCENT FROM REMOVAL"
479,Y,N,"SELECT ROUND(AVG(DAILY_PERCENT)*100, 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(DISTINCT CASE WHEN R.POST_ID THEN A.POST_ID ELSE NULL END)/CAST(COUNT(DISTINCT A.POST_ID) AS DECIMAL) AS DAILY_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE ACTION='REPORT' AND EXTRA='SPAM' GROUP BY 1) F"
480,Y,Y,"WITH TTLSPAM AS (SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS TTLSPAM FROM ACTIONS WHERE EXTRA='SPAM' GROUP BY 1), REMOVESPAM AS (SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS TTLMOVESPAM FROM ACTIONS WHERE POST_ID IN (SELECT POST_ID FROM REMOVALS ) AND EXTRA='SPAM' GROUP BY 1 ) SELECT ROUND(AVG(A.REMOVERATE),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT S.ACTION_DATE,(IFNULL(R.TTLMOVESPAM,0)/S.TTLSPAM)*100 AS REMOVERATE FROM TTLSPAM S LEFT JOIN REMOVESPAM R ON S.ACTION_DATE=R.ACTION_DATE ) A"
481,Y,Y,"SELECT ROUND(AVG(RATIOS)*100,2) AS AVERAGE_DAILY_PERCENT FROM( SELECT A.ACTION_DATE AS POST_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) RATIOS FROM ACTIONS A LEFT JOIN REMOVALS R USING(POST_ID) WHERE A.ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY 1 ) T"
482,Y,Y,"SELECT ROUND(AVG(COUNT_PCT)*100, 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) AS COUNT_PCT FROM ACTIONS AS A LEFT JOIN REMOVALS AS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE) AS TEMP"
483,Y,Y,"SELECT ROUND(AVG(PERCENTAGE)*100, 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT (COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)) AS PERCENTAGE, ACTION_DATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE) T"
484,Y,Y,"WITH CTE AS (SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS DAILY_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE) SELECT ROUND(AVG(DAILY_PERCENT)*100, 2) AVERAGE_DAILY_PERCENT FROM CTE"
485,Y,Y,"WITH ACTIONS_FILTERED AS ( SELECT POST_ID, ACTION_DATE FROM ACTIONS WHERE ACTION='REPORT' AND EXTRA = 'SPAM' GROUP BY POST_ID, ACTION_DATE ), AVERAGES AS ( SELECT ACTION_DATE, COUNT(REM.REMOVE_DATE) / COUNT(*) AS PERCENTAGE FROM ACTIONS_FILTERED ACT LEFT JOIN REMOVALS REM ON ACT.POST_ID = REM.POST_ID GROUP BY ACT.ACTION_DATE ) SELECT ROUND(AVG(PERCENTAGE) * 100, 2) AS AVERAGE_DAILY_PERCENT FROM AVERAGES"
486,Y,Y,"WITH CTE AS (SELECT DISTINCT POST_ID, ACTION_DATE FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' ) SELECT ROUND(AVG(T.AVERAGE_DAILY_PERCENT), 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT C.ACTION_DATE, SUM(CASE WHEN R.REMOVE_DATE IS NOT NULL THEN 1 ELSE 0 END) / COUNT(*) * 100 AS AVERAGE_DAILY_PERCENT FROM CTE AS C LEFT JOIN REMOVALS AS R ON C.POST_ID = R.POST_ID GROUP BY C.ACTION_DATE) AS T"
487,Y,Y,"WITH TOTAL_SPAM AS ( SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS DAILY_SPAM FROM ACTIONS WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE ), DELETE_SPAM AS ( SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID) AS DAILY_DEL_SPAM FROM REMOVALS R JOIN ACTIONS A ON R.POST_ID = A.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE ), JOIN_SPAM AS ( SELECT IFNULL(DAILY_DEL_SPAM, 0) / DAILY_SPAM AS DEL_PERC FROM TOTAL_SPAM T LEFT JOIN DELETE_SPAM D ON T.ACTION_DATE = D.ACTION_DATE ) SELECT ROUND(AVG(DEL_PERC)*100, 2) AS AVERAGE_DAILY_PERCENT FROM JOIN_SPAM"
488,Y,Y,"SELECT ROUND(AVG(PERCENT)*100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, SUM(FLAG)/COUNT(DISTINCT POST_ID) AS PERCENT FROM (SELECT A.*, IF(R.REMOVE_DATE IS NULL, 0, 1) AS FLAG FROM ( SELECT DISTINCT POST_ID, ACTION_DATE FROM ACTIONS WHERE ACTION='REPORT' AND EXTRA='SPAM' ) A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID) T GROUP BY ACTION_DATE) T2"
489,Y,Y,"SELECT ROUND((SUM(DAILY)/COUNT(ACTION_DATE)), 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT A.ACTION_DATE , (COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID))*100 AS DAILY FROM ACTIONS A LEFT JOIN REMOVALS R USING (POST_ID) WHERE A.EXTRA = 'SPAM' AND A.ACTION = 'REPORT' GROUP BY A.ACTION_DATE) TEMP"
490,Y,Y,"SELECT ROUND(AVG(DAILY_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)*100/COUNT( DISTINCT A.POST_ID) AS DAILY_PERCENT FROM (SELECT ACTION_DATE, POST_ID FROM ACTIONS WHERE EXTRA ='SPAM') A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID GROUP BY A.ACTION_DATE) DAILY"
491,Y,Y,"SELECT ROUND(AVG(NUM_REMOVE/NUM_SPAM) * 100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(DISTINCT A.POST_ID) AS NUM_SPAM, COUNT(DISTINCT CASE WHEN REMOVE_DATE IS NOT NULL THEN A.POST_ID ELSE NULL END) AS NUM_REMOVE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE HAVING NUM_SPAM > 0) AS TEMP"
492,Y,Y,"WITH R AS (SELECT POST_ID, ACTION_DATE FROM ACTIONS WHERE EXTRA = 'SPAM') SELECT ROUND(AVG(AVERAGE_DAILY_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT R.ACTION_DATE, COUNT(DISTINCT REM.POST_ID)/COUNT(DISTINCT R.POST_ID)*100 AS AVERAGE_DAILY_PERCENT FROM R LEFT JOIN REMOVALS REM ON R.POST_ID = REM.POST_ID GROUP BY R.ACTION_DATE) SUB"
493,Y,Y,"WITH PCT AS ( SELECT 100*COUNT(DISTINCT S.POST_ID)/COUNT(DISTINCT A.POST_ID) AS DAILY_PCT FROM ACTIONS A LEFT JOIN REMOVALS S ON A.POST_ID = S.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE) SELECT ROUND(AVG(DAILY_PCT),2) AS AVERAGE_DAILY_PERCENT FROM PCT"
494,Y,Y,"WITH CTE1 AS ( SELECT ACTIONS.POST_ID, COUNT(DISTINCT REMOVALS.POST_ID)/COUNT(DISTINCT ACTIONS.POST_ID) AS RATE FROM ACTIONS LEFT JOIN REMOVALS USING (POST_ID) WHERE EXTRA = 'SPAM' AND ACTION='REPORT' GROUP BY ACTION_DATE ) SELECT ROUND(AVG(RATE)*100,2) AS AVERAGE_DAILY_PERCENT FROM CTE1"
495,Y,Y,"SELECT ROUND(AVG(AVGG),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS AVGG FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY ACTION_DATE)FJFH"
496,Y,Y,"WITH CTE AS (SELECT A.POST_ID, A.ACTION_DATE, A.ACTION, COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) AS DAILY_RATE FROM ACTIONS AS A LEFT JOIN REMOVALS AS R ON A.POST_ID = R.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE) SELECT ROUND(AVG(DAILY_RATE)*100, 2) AS AVERAGE_DAILY_PERCENT FROM CTE"
497,Y,Y,"SELECT ROUND(AVG(P*100),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE , IFNULL(COUNT(DISTINCT R.POST_ID),0)/COUNT(DISTINCT A.POST_ID) AS P FROM ACTIONS A LEFT JOIN REMOVALS R ON R.POST_ID=A.POST_ID WHERE EXTRA='SPAM' GROUP BY ACTION_DATE) AS A"
498,Y,Y,"SELECT ROUND(SUM(PERCENT)/COUNT(DISTINCT ACTION_DATE),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE EXTRA='SPAM' GROUP BY 1) A"
499,Y,Y,"WITH SPAM_PREP AS ( SELECT ACTION_DATE ,A.POST_ID ,REMOVE_DATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' ), AVG_PREP AS( SELECT COUNT(DISTINCT CASE WHEN REMOVE_DATE IS NULL THEN NULL ELSE POST_ID END) / COUNT(DISTINCT POST_ID) AS AVG_PER_DAY FROM SPAM_PREP GROUP BY ACTION_DATE ) SELECT ROUND(AVG(AVG_PER_DAY) * 100,2) AS AVERAGE_DAILY_PERCENT FROM AVG_PREP"
500,Y,Y,"SELECT ROUND(AVG(DAILY_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, COUNT(DISTINCT B.POST_ID)/ COUNT(DISTINCT A.POST_ID)*100.0 AS DAILY_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID AND B.REMOVE_DATE >= A.ACTION_DATE WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY ACTION_DATE ) T"
501,Y,Y,"SELECT ROUND(AVG(REMOVAL),4)*100 AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, COUNT(DISTINCT B.POST_ID)/COUNT(DISTINCT A.POST_ID) REMOVAL FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID=B.POST_ID WHERE A.ACTION='REPORT' AND EXTRA = 'SPAM' GROUP BY ACTION_DATE ) A"
502,Y,Y,"SELECT ROUND(AVG(C),2) AS AVERAGE_DAILY_PERCENT FROM( SELECT ACTION_DATE, COUNT(DISTINCT CASE WHEN REMOVE_DATE IS NOT NULL THEN POST_ID ELSE NULL END)/COUNT(DISTINCT POST_ID)*100 AS C FROM (SELECT POST_ID, ACTION_DATE,REMOVE_DATE FROM ACTIONS LEFT JOIN REMOVALS USING(POST_ID) WHERE EXTRA='SPAM') T GROUP BY ACTION_DATE) T1"
503,Y,Y,"WITH TEMP AS( SELECT POST_ID, ACTION_DATE AS REPORT_DATE FROM ACTIONS WHERE ACTIONS.ACTION = 'REPORT' AND EXTRA = 'SPAM' ), REMOVALS AS ( SELECT A.REPORT_DATE, COUNT(DISTINCT A.POST_ID) AS POSTS, COUNT(DISTINCT B.POST_ID) AS REMOVALS, (COUNT(DISTINCT B.POST_ID)/COUNT(DISTINCT A.POST_ID))*100 AS DAILY_PCT FROM TEMP A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID GROUP BY A.REPORT_DATE ) SELECT ROUND(AVG(DAILY_PCT),2) AS AVERAGE_DAILY_PERCENT FROM REMOVALS"
504,Y,Y,"WITH TEMP_1 AS( SELECT A.ACTION_DATE, COUNT(DISTINCT A.POST_ID) AS SPAMMED, COUNT(DISTINCT B.POST_ID) REMOVED_POST FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY 1 ) SELECT ROUND(AVG(REMOVED_POST/SPAMMED)*100, 2) AVERAGE_DAILY_PERCENT FROM TEMP_1"
505,Y,Y,"SELECT ROUND(AVG(TOTAL_SPAM)*100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID, R.REMOVE_DATE)/COUNT(DISTINCT A.POST_ID) AS TOTAL_SPAM FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE) A"
506,Y,Y,"WITH CTE AS ( SELECT A.POST_ID,A.ACTION_DATE,COUNT(DISTINCT A.EXTRA)AS TOTAL_SPAM, CASE WHEN A.POST_ID=R.POST_ID THEN REMOVED ELSE 'NOT REMOVED' END AS REMOVED FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE A.EXTRA='SPAM' GROUP BY A.ACTION_DATE, A.POST_ID), NEXT_TABLE AS ( SELECT ACTION_DATE,SUM(CASE WHEN REMOVED='REMOVED' THEN 1 ELSE 0 END)*100/COUNT(REMOVED) AS PERC FROM CTE GROUP BY ACTION_DATE ) SELECT ROUND(AVG(PERC),2) AS AVERAGE_DAILY_PERCENT FROM NEXT_TABLE"
507,Y,Y,"WITH CTE AS( SELECT ACTION_DATE, POST_ID FROM ACTIONS WHERE EXTRA='SPAM' GROUP BY ACTION_DATE, POST_ID ), CTE1 AS ( SELECT * FROM CTE LEFT JOIN REMOVALS USING(POST_ID) ), CTE2 AS( SELECT POST_ID, ACTION_DATE, IF(REMOVE_DATE IS NULL,0,1) AS REMOVECNT FROM CTE1 ) SELECT ROUND(AVG(RMVCNT),2)AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, AVG(REMOVECNT)*100 AS RMVCNT FROM CTE2 GROUP BY ACTION_DATE) S"
508,Y,Y,"WITH CTE AS( SELECT ACTION_DATE, IFNULL(COUNT(DISTINCT R.POST_ID),0) / COUNT(DISTINCT A.POST_ID) AS RATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE) SELECT ROUND(AVG(RATE) * 100,2) AS AVERAGE_DAILY_PERCENT FROM CTE"
509,Y,Y,"WITH T1 AS ( SELECT ACTION_DATE, ROUND(100* COUNT(DISTINCT R.POST_ID) /COUNT(DISTINCT A.POST_ID),2) AS DAILY_PERCENTAGES FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE ACTION='REPORT' AND EXTRA='SPAM' GROUP BY 1 ) SELECT ROUND(AVG(DAILY_PERCENTAGES),2) AS AVERAGE_DAILY_PERCENT FROM T1"
510,Y,Y,"SELECT ROUND(AVG(RATIO), 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) * 100 AS RATIO FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ) GRP"
511,Y,Y,"SELECT ROUND(AVG(STATUS)*100,2) AS AVERAGE_DAILY_PERCENT FROM( SELECT A.ACTION_DATE, COUNT(DISTINCT B.POST_ID)/COUNT(DISTINCT A.POST_ID) AS STATUS FROM ( SELECT POST_ID, ACTION_DATE FROM ACTIONS WHERE ACTION LIKE REPORT AND EXTRA LIKE SPAM ) A LEFT JOIN REMOVALS B ON A.POST_ID =B.POST_ID GROUP BY A.ACTION_DATE ) X"
512,Y,Y,"SELECT ROUND(SUM(PERCENT)/COUNT(ACTION_DATE),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA='SPAM' GROUP BY 1) TEMP"
513,Y,Y,"WITH REPORTED_POSTS AS ( SELECT DISTINCT A.POST_ID, ACTION_DATE, CASE WHEN B.POST_ID IS NULL THEN 0 ELSE 1 END AS IS_DELETED FROM ACTIONS A LEFT OUTER JOIN REMOVALS B ON A.POST_ID = B.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' ) SELECT ROUND(AVG(DAILY_RATE) * 100, 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, SUM(IS_DELETED) / COUNT(1) AS DAILY_RATE FROM REPORTED_POSTS GROUP BY ACTION_DATE ) A"
514,Y,Y,"WITH T1 AS ( SELECT * FROM ACTIONS LEFT JOIN REMOVALS USING (POST_ID) WHERE EXTRA LIKE SPAM ), T2 AS ( SELECT ACTION_DATE, COUNT(DISTINCT POST_ID ) AS REMOVED_POSTS FROM T1 WHERE REMOVE_DATE IS NOT NULL GROUP BY ACTION_DATE ), T3 AS ( SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS TOTAL_POSTS FROM T1 GROUP BY ACTION_DATE ), T4 AS ( SELECT ACTION_DATE, IFNULL(REMOVED_POSTS/TOTAL_POSTS , 0) AS REMOVED_PERCENT FROM T3 LEFT JOIN T2 USING (ACTION_DATE) ) SELECT ROUND(AVG(REMOVED_PERCENT) * 100,2) AS AVERAGE_DAILY_PERCENT FROM T4"
515,Y,Y,"WITH T1 AS( SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS POSTS_REPORTED FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY 1 ORDER BY 1 ), T2 AS( SELECT A.ACTION_DATE, IFNULL(COUNT(DISTINCT R.POST_ID),0) AS POSTS_REMOVED FROM ACTIONS A LEFT JOIN REMOVALS R ON R.POST_ID = A.POST_ID AND A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' AND R.REMOVE_DATE >= A.ACTION_DATE GROUP BY 1 ORDER BY 1 ) SELECT ROUND(AVG(T2.POSTS_REMOVED/T1.POSTS_REPORTED)*100,2) AS AVERAGE_DAILY_PERCENT FROM T1 JOIN T2 ON T1.ACTION_DATE = T2.ACTION_DATE"
516,Y,Y,"SELECT ROUND(AVG(DAILY_PERCENT)*100,2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT COUNT(DISTINCT B.POST_ID)/COUNT(DISTINCT A.POST_ID) AS DAILY_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID=B.POST_ID WHERE EXTRA = 'SPAM' GROUP BY A.ACTION_DATE) T"
517,Y,Y,"SELECT ROUND(100*AVG(PER),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS PER FROM (SELECT * FROM ACTIONS A WHERE A.EXTRA = 'SPAM')A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID GROUP BY A.ACTION_DATE)T"
518,Y,Y,"WITH T AS (SELECT DISTINCT POST_ID, ACTION_DATE, EXTRA FROM ACTIONS WHERE EXTRA = 'SPAM') SELECT ROUND(AVG(PER), 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT T.ACTION_DATE, COUNT(DISTINCT CASE WHEN REMOVE_DATE IS NOT NULL THEN T.POST_ID ELSE NULL END)/COUNT(DISTINCT T.POST_ID) * 100 AS PER FROM T LEFT JOIN REMOVALS R ON T.POST_ID = R.POST_ID GROUP BY 1) T2"
519,Y,Y,"SELECT ROUND(AVG(X)*100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT DISTINCT ACTION_DATE, COUNT(DISTINCT CASE WHEN POST_ID IN (SELECT POST_ID FROM REMOVALS) THEN POST_ID ELSE NULL END)/COUNT(DISTINCT POST_ID) AS X FROM ACTIONS WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE ORDER BY ACTION_DATE)A"
520,Y,Y,"WITH T AS (SELECT ACTION_DATE, POST_ID IN (SELECT POST_ID FROM REMOVALS) AS REMOV FROM (SELECT DISTINCT ACTION_DATE, POST_ID FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM') AS A) SELECT ROUND(AVG(RATE), 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT 100 * AVG(REMOV) AS RATE FROM T GROUP BY ACTION_DATE) AS U"
521,Y,Y,"SELECT ROUND(IFNULL(AVG(X)* 100, 0), 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT DISTINCT ACTION_DATE, COUNT( DISTINCT CASE WHEN POST_ID IN (SELECT DISTINCT POST_ID FROM REMOVALS) THEN POST_ID ELSE NULL END)/ COUNT(DISTINCT POST_ID) AS X FROM ACTIONS WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE ORDER BY ACTION_DATE ) AS A"
522,Y,Y,"SELECT ROUND(AVG(PERCENTAGE)*100, 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS PERCENTAGE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY ACTION_DATE) T"
523,Y,Y,"WITH T1 AS ( SELECT A.ACTION_DATE , COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS DAILY_RATE FROM ACTIONS AS A LEFT JOIN REMOVALS AS R ON A.POST_ID = R.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY 1 ) SELECT ROUND(AVG(DAILY_RATE)*100,2) AS AVERAGE_DAILY_PERCENT FROM T1"
524,Y,Y,"WITH CTE AS (SELECT A.ACTION_DATE , COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) AS PER FROM ACTIONS A LEFT JOIN REMOVALS R ON R.POST_ID = A.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY A.ACTION_DATE) SELECT ROUND(AVG(PER)*100,2) AS AVERAGE_DAILY_PERCENT FROM CTE"
525,Y,Y,"SELECT ROUND(AVG(DAILY_PERCENT)*100, 2) AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) DAILY_PERCENT FROM (SELECT ACTION_DATE, POST_ID FROM ACTIONS WHERE EXTRA = 'SPAM') A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID GROUP BY ACTION_DATE) B"
526,Y,Y,"SELECT ROUND(AVG(C.REMOVE_RATE)*100,2) AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE,COUNT(R.POST_ID)/COUNT(A.POST_ID) REMOVE_RATE FROM (SELECT ACTION_DATE,POST_ID FROM ACTIONS WHERE EXTRA='SPAM' GROUP BY ACTION_DATE,POST_ID)A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID GROUP BY A.ACTION_DATE)C"
527,Y,Y,"WITH CTE AS( SELECT POST_ID, ACTION_DATE FROM ACTIONS WHERE EXTRA = 'SPAM'), CTE1 AS( SELECT COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT C.POST_ID) AS CNT FROM CTE C LEFT JOIN REMOVALS R USING(POST_ID) GROUP BY ACTION_DATE) SELECT ROUND(AVG(CNT) * 100, 2) AS AVERAGE_DAILY_PERCENT FROM CTE1"
528,Y,Y,"SELECT ROUND(AVG(CNT),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT COUNT(DISTINCT B.POST_ID)*100/COUNT(DISTINCT A.POST_ID) AS CNT FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY ACTION_DATE) T1"
529,Y,Y,"WITH T1 AS (SELECT (COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)) AS PERC FROM ACTIONS A LEFT JOIN REMOVALS R USING(POST_ID) WHERE EXTRA='SPAM' GROUP BY ACTION_DATE) SELECT ROUND(AVG(PERC)*100,2) AS AVERAGE_DAILY_PERCENT FROM T1"
530,Y,Y,"SELECT ROUND(AVG(C)*100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT COUNT(DISTINCT(B.POST_ID))/COUNT(DISTINCT(A.POST_ID)) AS C, A.ACTION_DATE FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID =B.POST_ID WHERE A.EXTRA ='SPAM' GROUP BY A.ACTION_DATE)A"
531,Y,Y,"WITH T1 AS( SELECT POST_ID, ACTION_DATE FROM ACTIONS WHERE EXTRA='SPAM' GROUP BY POST_ID,ACTION_DATE ), T2 AS( SELECT T1.POST_ID, SUM(IF(R.POST_ID IS NULL,0,1))/COUNT(DISTINCT T1.POST_ID) AS RATIO FROM T1 LEFT JOIN REMOVALS R ON T1.POST_ID=R.POST_ID GROUP BY T1.ACTION_DATE ) SELECT ROUND(100*AVG(RATIO),2) AS AVERAGE_DAILY_PERCENT FROM T2"
532,Y,Y,"WITH POSTS AS ( SELECT A.*, R.REMOVE_DATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID AND A.ACTION_DATE < R.REMOVE_DATE WHERE EXTRA = 'SPAM' ), DAILY_SPAM_REPORTS AS ( SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS NUM_POSTS, COUNT(DISTINCT CASE WHEN REMOVE_DATE IS NOT NULL THEN POST_ID END) AS NUM_POSTS_REMOVED, 100 * COUNT(DISTINCT CASE WHEN REMOVE_DATE IS NOT NULL THEN POST_ID END) / COUNT(DISTINCT POST_ID) AS DAILY_PERCENT FROM POSTS GROUP BY 1 ) SELECT ROUND(SUM(DAILY_PERCENT) / COUNT(ACTION_DATE), 2) AS AVERAGE_DAILY_PERCENT FROM DAILY_SPAM_REPORTS"
533,Y,Y,"SELECT ROUND(AVG(COUNT_REMOVAL/COUNT_TOTAL)*100,2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE ,COUNT(DISTINCT CASE WHEN POST_ID IN (SELECT POST_ID FROM REMOVALS) THEN POST_ID ELSE NULL END) AS COUNT_REMOVAL , COUNT(DISTINCT POST_ID) AS COUNT_TOTAL FROM ACTIONS WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE) AS TT"
534,Y,Y,"SELECT ROUND(SUM(PERCENTAGE)/COUNT(ACTION_DATE) * 100, 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT TEMP.ACTION_DATE, COUNT(DISTINCT CASE WHEN REMOVE_DATE IS NOT NULL THEN POST_ID ELSE NULL END)/COUNT(DISTINCT POST_ID) AS PERCENTAGE FROM (SELECT A.USER_ID, A.POST_ID, A.ACTION_DATE, R.REMOVE_DATE FROM ACTIONS A LEFT JOIN REMOVALS R USING(POST_ID) WHERE EXTRA = 'SPAM')TEMP GROUP BY ACTION_DATE) T"
535,Y,Y,"SELECT ROUND(100*AVG(REMOVAL_NUM/SPAM_NUM),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS SPAM_NUM FROM ACTIONS WHERE EXTRA ='SPAM' GROUP BY ACTION_DATE) B LEFT JOIN (SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID) AS REMOVAL_NUM FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE EXTRA ='SPAM' GROUP BY ACTION_DATE) C ON B.ACTION_DATE=C.ACTION_DATE"
536,Y,Y,"SELECT ROUND(AVG(DAILYRATE)*100,2) AS AVERAGE_DAILY_PERCENT FROM (WITH T3 AS (WITH SPAMPOSTS AS (SELECT * FROM ACTIONS WHERE EXTRA= 'SPAM') SELECT T1.USER_ID,T1.POST_ID,T1.ACTION_DATE,T1.EXTRA,T2.REMOVE_DATE FROM SPAMPOSTS T1 LEFT JOIN REMOVALS T2 ON T1.POST_ID=T2.POST_ID) SELECT ACTION_DATE, COUNT(DISTINCT IF(REMOVE_DATE IS NOT NULL,POST_ID,NULL))/COUNT(DISTINCT POST_ID) AS DAILYRATE FROM T3 GROUP BY ACTION_DATE) T4"
537,Y,Y,"WITH CET1 AS ( SELECT DISTINCT ACTION_DATE, POST_ID FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' ), CET2 AS ( SELECT CET1.* FROM CET1 JOIN REMOVALS ON CET1.POST_ID = REMOVALS.POST_ID ), CET3 AS ( SELECT DISTINCT CET1.ACTION_DATE, 100 * COUNT(CET2.POST_ID)/COUNT(CET1.POST_ID) AS PCT FROM CET1 LEFT JOIN CET2 ON CET1.ACTION_DATE = CET2.ACTION_DATE AND CET1.POST_ID = CET2.POST_ID GROUP BY CET1.ACTION_DATE ) SELECT ROUND(AVG(PCT), 2) AS AVERAGE_DAILY_PERCENT FROM CET3"
538,Y,Y,"SELECT ROUND(AVG(AVERAGE_DAILY_PERCENT)*100,2) AS AVERAGE_DAILY_PERCENT FROM( SELECT ACTION_DATE,COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS AVERAGE_DAILY_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R USING(POST_ID) WHERE EXTRA='SPAM' AND ACTION ='REPORT' GROUP BY 1 )A"
539,Y,Y,"SELECT ROUND(AVG(PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM( SELECT ACTION_DATE, COUNT(DISTINCT REMOVALS.POST_ID)/COUNT(DISTINCT ACTIONS.POST_ID)*100.0 AS PERCENT FROM ACTIONS LEFT JOIN REMOVALS ON ACTIONS.POST_ID = REMOVALS.POST_ID WHERE EXTRA = 'SPAM' GROUP BY 1 ORDER BY 1)T"
540,Y,Y,"SELECT ROUND(AVG(HELPER*100), 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT COUNT(DISTINCT REMOVALS.POST_ID)/ COUNT(DISTINCT ACTIONS.POST_ID) AS HELPER FROM ACTIONS LEFT JOIN REMOVALS ON ACTIONS.POST_ID = REMOVALS.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE)T1"
541,Y,Y,"WITH CTE AS (SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS DAILY_RATE FROM ACTIONS A LEFT JOIN REMOVALS R USING(POST_ID) WHERE ACTION='REPORT' AND EXTRA='SPAM' GROUP BY 1) SELECT ROUND(AVG(DAILY_RATE)*100,2) AVERAGE_DAILY_PERCENT FROM CTE"
542,Y,Y,"SELECT ROUND(AVG(PERCENTAGE), 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT NA.ACTION_DATE, COUNT(R.POST_ID)/COUNT(NA.POST_ID)*100 AS PERCENTAGE FROM (SELECT ACTION_DATE, POST_ID FROM ACTIONS A WHERE A.EXTRA = 'SPAM' GROUP BY ACTION_DATE, POST_ID) NA LEFT JOIN REMOVALS R ON R.POST_ID = NA.POST_ID GROUP BY NA.ACTION_DATE) X"
543,Y,Y,"SELECT ROUND(AVG(NUM_REMOVE / NUM_SPAM) * 100, 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, COUNT(DISTINCT A.POST_ID) AS NUM_SPAM, COUNT(DISTINCT CASE WHEN REMOVE_DATE IS NOT NULL THEN A.POST_ID ELSE NULL END) AS NUM_REMOVE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE HAVING NUM_SPAM > 0 ) T"
544,Y,Y,"SELECT ROUND(AVG(T4.DAILY_PCT)*100,2) AS AVERAGE_DAILY_PERCENT FROM( SELECT T2.ACTION_DATE, (T3.DAILY_REMOVED / T2.DAILY_REPORT) AS DAILY_PCT FROM ( SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS DAILY_REPORT FROM ACTIONS WHERE ACTION LIKE REPORT AND EXTRA LIKE SPAM GROUP BY ACTION_DATE ) T2 INNER JOIN (SELECT ACTION_DATE, IFNULL(COUNT(DISTINCT REMOVALS.POST_ID),0) AS DAILY_REMOVED FROM (SELECT POST_ID, ACTION_DATE FROM ACTIONS WHERE ACTION LIKE REPORT AND EXTRA LIKE SPAM ) T1 LEFT JOIN REMOVALS USING (POST_ID) GROUP BY ACTION_DATE ) T3 USING (ACTION_DATE) ) T4"
545,Y,Y,"WITH REMOVES AS ( SELECT COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) DAILY FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY ACTION_DATE ) SELECT ROUND(AVG(DAILY)*100, 2) AS AVERAGE_DAILY_PERCENT FROM REMOVES"
546,Y,Y,"SELECT ROUND(AVG(X.RATE)*100, 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS RATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' GROUP BY 1 ) X"
547,Y,Y,"SELECT ROUND(AVG(P.DAY_PERCENTAGE),4) * 100 AS AVERAGE_DAILY_PERCENT FROM( SELECT COUNT(DISTINCT REMOVALS.POST_ID)/COUNT(DISTINCT ACTIONS.POST_ID) AS DAY_PERCENTAGE FROM ACTIONS LEFT JOIN REMOVALS ON REMOVALS.POST_ID = ACTIONS.POST_ID WHERE EXTRA = 'SPAM' AND ACTION = 'REPORT' GROUP BY ACTIONS.ACTION_DATE) P"
548,Y,Y,"WITH CTE AS( SELECT (COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID))*100 AS CNT FROM ACTIONS A LEFT JOIN REMOVALS R USING(POST_ID) WHERE EXTRA = 'SPAM' AND ACTION = 'REPORT' GROUP BY ACTION_DATE) SELECT ROUND(AVG(CNT),2) AS AVERAGE_DAILY_PERCENT FROM CTE"
549,Y,Y,"WITH CTE AS (SELECT ACTION_DATE, COUNT(DISTINCT T2.POST_ID) AS NUM_REMOVED FROM ACTIONS AS T JOIN REMOVALS AS T2 ON T.POST_ID = T2.POST_ID AND (T.ACTION = 'REPORT' AND T.EXTRA = 'SPAM') AND (T.ACTION_DATE <= T2.REMOVE_DATE) GROUP BY ACTION_DATE) SELECT ROUND(SUM(PERCENTAGE)/COUNT(*),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT T3.ACTION_DATE, ROUND((COALESCE(CTE.NUM_REMOVED, 0)/ TOTAL_CNT) * 100, 2) AS PERCENTAGE FROM (SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS TOTAL_CNT FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY ACTION_DATE) AS T3 LEFT JOIN CTE ON T3.ACTION_DATE = CTE.ACTION_DATE ) AS T4"
550,Y,Y,"SELECT ROUND(SUM(DELCOUNT / SPAMCOUNT * 100) / COUNT(DISTINCT ACTION_DATE), 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, COUNT(DISTINCT A.POST_ID) AS SPAMCOUNT, COUNT(DISTINCT B.POST_ID) AS DELCOUNT FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ) A"
551,Y,Y,"WITH CTE AS (SELECT A.ACTION_DATE, (COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)) AS REMOVAL_PERC FROM ACTIONS A LEFT JOIN REMOVALS R USING(POST_ID) WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE) SELECT ROUND(SUM(REMOVAL_PERC)/COUNT(*)*100, 2) AS AVERAGE_DAILY_PERCENT FROM CTE"
552,Y,Y,"SELECT ROUND(AVG(PCT)*100,2) AS AVERAGE_DAILY_PERCENT FROM( SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS PCT FROM( SELECT POST_ID, ACTION_DATE FROM ACTIONS WHERE EXTRA='SPAM' )A LEFT JOIN REMOVALS R ON R.POST_ID=A.POST_ID GROUP BY ACTION_DATE )AR"
553,Y,Y,"WITH POSTS_R AS ( SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS DAILY_REMOVAL_RATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA='SPAM' GROUP BY 1 ) SELECT ROUND(SUM(DAILY_REMOVAL_RATE)/COUNT(DISTINCT ACTION_DATE),2) AS AVERAGE_DAILY_PERCENT FROM POSTS_R"
554,Y,Y,"SELECT ROUND(SUM(REMOVE_RATE)/COUNT(DISTINCT ACTION_DATE)*100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE, COUNT(DISTINCT B.POST_ID)/COUNT( DISTINCT A.POST_ID) AS REMOVE_RATE FROM (SELECT DISTINCT ACTION_DATE, POST_ID, ACTION, USER_ID FROM ACTIONS WHERE EXTRA = 'SPAM') A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID AND B.REMOVE_DATE >= A.ACTION_DATE GROUP BY 1) B"
555,Y,Y,"SELECT ROUND(AVG(DAILY_PERCENT)*100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/ COUNT( DISTINCT A.POST_ID) AS DAILY_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.ACTION = 'REPORT' AND A. EXTRA = 'SPAM' GROUP BY ACTION_DATE) B"
556,Y,Y,"SELECT ROUND(AVG(MOV)*100, 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS MOV FROM ACTIONS A LEFT JOIN REMOVALS R ON A. POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ) CC"
557,Y,Y,"SELECT ROUND(AVG(AVERAGE_DAILY)*100,2) AS AVERAGE_DAILY_PERCENT FROM( SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) AS AVERAGE_DAILY FROM ACTIONS AS A LEFT JOIN REMOVALS AS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE) AS T"
558,Y,Y,"SELECT ROUND(AVG(DAILY_AVG)*100,2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, SUM(CASE WHEN REMOVE_DATE IS NOT NULL THEN 1 ELSE 0 END)/COUNT(*) AS DAILY_AVG FROM (SELECT DISTINCT ACTION_DATE, POST_ID FROM ACTIONS WHERE ACTION='REPORT' AND EXTRA='SPAM') AS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID GROUP BY ACTION_DATE ) AS TMP"
559,Y,Y,"WITH TEMP AS ( SELECT DISTINCT A.POST_ID,ACTION_DATE,EXTRA,REMOVE_DATE FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID ), TEMP2 AS ( SELECT ACTION_DATE,SUM(CASE WHEN EXTRA = 'SPAM' AND REMOVE_DATE IS NOT NULL THEN 1 ELSE 0 END) AS NUM_REMOVE, SUM(CASE WHEN EXTRA = 'SPAM' THEN 1 ELSE 0 END) AS TOTAL FROM TEMP GROUP BY ACTION_DATE HAVING SUM(CASE WHEN EXTRA = 'SPAM' THEN 1 ELSE 0 END) >0 ) SELECT ROUND(AVG(NUM_REMOVE/TOTAL)*100,2) AS AVERAGE_DAILY_PERCENT FROM TEMP2"
560,Y,Y,"SELECT ROUND(AVG(CNT),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT (COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID))*100 AS CNT FROM ACTIONS A LEFT JOIN REMOVALS R USING(POST_ID) WHERE EXTRA='SPAM' GROUP BY ACTION_DATE) T"
561,Y,Y,"WITH FILTERED AS( SELECT POST_ID, ACTION_DATE FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM') SELECT ROUND(100*AVG(DAILY_PERCENT), 2) AS AVERAGE_DAILY_PERCENT FROM( SELECT (COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID)) AS DAILY_PERCENT FROM FILTERED A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID GROUP BY ACTION_DATE) T"
562,Y,Y,"SELECT ROUND(AVG(DAILY_PERCENT*100),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE,COUNT(DISTINCT B.POST_ID)/COUNT(DISTINCT A.POST_ID) AS DAILY_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY 1 ) AS A"
563,Y,Y,"SELECT ROUND((SUM(REMOVE_RATE)/COUNT(ACTION_DATE))*100,2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS REMOVE_RATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY ACTION_DATE )A"
564,Y,Y,"SELECT ROUND(AVG(DAILY_RATE),2) AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, SUM(CASE WHEN R.POST_ID IS NOT NULL THEN 1 ELSE 0 END)/ COUNT(DISTINCT T.POST_ID) * 100 DAILY_RATE FROM (SELECT DISTINCT POST_ID, ACTION_DATE, ACTION, EXTRA FROM ACTIONS WHERE EXTRA = 'SPAM') T LEFT JOIN REMOVALS R ON T.POST_ID = R.POST_ID AND R.REMOVE_DATE >= T.ACTION_DATE GROUP BY 1) T2"
565,Y,Y,"WITH CTE AS ( SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT(CASE WHEN A.EXTRA='SPAM' THEN A.POST_ID ELSE NULL END)) AS P FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID AND A.EXTRA='SPAM' GROUP BY 1 ORDER BY 1) SELECT ROUND(SUM(P)/COUNT(ACTION_DATE)*100,2) AS AVERAGE_DAILY_PERCENT FROM CTE WHERE P IS NOT NULL"
566,Y,Y,"SELECT ROUND(AVG(T.DAILY_PERCENT), 2) AS AVERAGE_DAILY_PERCENT FROM( SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS DAILY_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY 1 ) T"
567,Y,Y,"WITH CTE AS ( SELECT POST_ID, ACTION_DATE FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' ) SELECT ROUND(AVG(AVERAGE),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT A.ACTION_DATE, COUNT(DISTINCT CASE WHEN B.POST_ID IS NOT NULL THEN A.POST_ID END) * 100 / COUNT(DISTINCT A.POST_ID) AS AVERAGE FROM CTE A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID GROUP BY A.ACTION_DATE ) A"
568,Y,Y,"SELECT ROUND(100.0 * AVG(DEL_CNT/RPT_CNT), 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(DISTINCT A.POST_ID) AS RPT_CNT, COUNT(DISTINCT R.POST_ID) AS DEL_CNT FROM ACTIONS AS A LEFT JOIN REMOVALS AS R ON A.POST_ID = R.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY 1 ) T WHERE RPT_CNT != 0"
569,Y,Y,"WITH DAILY_SPAM_RATIOS AS ( SELECT (COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID)) * 100 AS SPAM_RATIO FROM ACTIONS A LEFT JOIN REMOVALS R USING(POST_ID) WHERE EXTRA='SPAM' GROUP BY ACTION_DATE ) SELECT ROUND(AVG(SPAM_RATIO), 2) AS AVERAGE_DAILY_PERCENT FROM DAILY_SPAM_RATIOS"
570,Y,Y,"WITH SPAM AS (SELECT ACTION_DATE, POST_ID FROM ACTIONS WHERE EXTRA = 'SPAM'), DEN AS (SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) D FROM SPAM GROUP BY ACTION_DATE), NUM AS (SELECT ACTION_DATE, COUNT(DISTINCT S.POST_ID) N FROM SPAM S JOIN REMOVALS R ON R.POST_ID = S.POST_ID AND R.REMOVE_DATE >= S.ACTION_DATE GROUP BY ACTION_DATE ) SELECT ROUND(AVG(P)*100,2) AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE, IFNULL(N,0)/D P FROM DEN A LEFT JOIN NUM B ON A.ACTION_DATE = B.ACTION_DATE)T"
571,Y,Y,"SELECT ROUND(AVG(DAILY)*100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT COUNT(DISTINCT REMOVALS.POST_ID)/COUNT(DISTINCT A.POST_ID) AS DAILY FROM REMOVALS RIGHT JOIN (SELECT POST_ID, ACTION_DATE FROM ACTIONS WHERE EXTRA = 'SPAM') A ON A.POST_ID = REMOVALS.POST_ID GROUP BY A.ACTION_DATE) B"
572,Y,Y,"WITH Q AS ( SELECT R.POST_ID,A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS REMOVED_POSTS FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE A.ACTION='REPORT' AND A.EXTRA='SPAM' GROUP BY A.ACTION_DATE ) SELECT ROUND(AVG(REMOVED_POSTS)*100,2) AS AVERAGE_DAILY_PERCENT FROM Q"
573,Y,Y,"SELECT ROUND(AVG(PERCENTAGE),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, (COUNT(DISTINCT B.POST_ID)/COUNT(DISTINCT A.POST_ID))*100 AS PERCENTAGE FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY 1) AS T"
574,Y,Y,"SELECT ROUND(AVG(DAILY_AVG)* 100,2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, (COUNT(DISTINCT CASE WHEN REMOVE_DATE IS NOT NULL THEN POST_ID ELSE NULL END)/COUNT(DISTINCT POST_ID)) AS DAILY_AVG FROM ( SELECT ACTION_DATE, A.POST_ID, ACTION, REMOVE_DATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA='SPAM' ) T GROUP BY ACTION_DATE ORDER BY ACTION_DATE ) T1"
575,Y,Y,"WITH CTE AS ( SELECT A.ACTION_DATE, (COUNT(DISTINCT B.POST_ID)/COUNT(DISTINCT A.POST_ID))*100 AS PERC FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE) SELECT ROUND(AVG(PERC),2) AS AVERAGE_DAILY_PERCENT FROM CTE"
576,Y,Y,"SELECT ROUND(SUM(PERCENTAGE)/COUNT(DISTINCT ACTION_DATE),2) AS AVERAGE_DAILY_PERCENT FROM( SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) * 100 AS PERCENTAGE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE)Q1"
577,Y,Y,"WITH SPAM_POSTS AS ( SELECT * FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' ), DAILY_PERCENT_REMOVED AS ( SELECT COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT SP.POST_ID)*100 AS DAILY_PERCENT_POST_REMOVED FROM ACTIONS AS SP LEFT JOIN REMOVALS R ON SP.POST_ID=R.POST_ID WHERE SP.EXTRA='SPAM' GROUP BY SP.ACTION_DATE ) SELECT ROUND(SUM(DAILY_PERCENT_POST_REMOVED) / COUNT(*), 2) AS AVERAGE_DAILY_PERCENT FROM DAILY_PERCENT_REMOVED"
578,Y,Y,"SELECT ROUND(AVG(PERCENT_DAILY),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT EXTRA, ACTION_DATE,COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS PERCENT_DAILY FROM ACTIONS A LEFT JOIN REMOVALS R ON R.POST_ID = A.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY ACTION_DATE ) A"
579,Y,Y,"SELECT ROUND(AVG(T.CNT),2) AVERAGE_DAILY_PERCENT FROM ( SELECT COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS CNT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.ACTION='REPORT' AND A.EXTRA='SPAM' GROUP BY A.ACTION_DATE)T"
580,Y,Y,"SELECT ROUND(AVG(PERCENTAGE),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT( DISTINCT A.POST_ID) *100 AS PERCENTAGE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA='SPAM' GROUP BY 1) T"
581,Y,Y,"WITH CTE AS ( SELECT A.ACTION_DATE AS DATE, COUNT(DISTINCT A.POST_ID) * 1.00 AS REPORTED_SPAMS, COUNT( DISTINCT CASE WHEN REMOVE_DATE IS NULL THEN NULL ELSE R.POST_ID END) * 1.00 AS REMOVED_SPAMS FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA='SPAM' GROUP BY 1 ) SELECT ROUND(SUM(DAILY_PERCENT)/COUNT(DATE) * 100, 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT DATE, SUM(REMOVED_SPAMS)/SUM(REPORTED_SPAMS) AS DAILY_PERCENT FROM CTE GROUP BY DATE ) T"
582,Y,Y,"WITH CTE AS ( SELECT 100*COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS R FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY ACTION_DATE ) SELECT ROUND(SUM(R)/COUNT(R),2) AS AVERAGE_DAILY_PERCENT FROM CTE"
583,Y,Y,"SELECT ROUND(100*AVG(SUB.PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT DISTINCT A.ACTION_DATE, COALESCE(COUNT(DISTINCT B.POST_ID),0)/COUNT(DISTINCT A.POST_ID) AS PERCENT FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID=B.POST_ID WHERE A.ACTION='REPORT' AND A.EXTRA='SPAM' GROUP BY 1) SUB"
584,Y,Y,"WITH SPAM AS (SELECT A.ACTION_DATE AS ACTION_DATE, 100.0* COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) AS PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE) SELECT ROUND(SUM(PERCENT) / COUNT(DISTINCT ACTION_DATE), 2) AS AVERAGE_DAILY_PERCENT FROM SPAM"
585,Y,Y,"WITH CTE1 AS ( SELECT COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS RATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE ACTION='REPORT' AND EXTRA='SPAM' GROUP BY ACTION_DATE ) SELECT ROUND(100*AVG(RATE),2)AS AVERAGE_DAILY_PERCENT FROM CTE1"
586,Y,Y,"SELECT ROUND(AVG(DAILY_PERCENT)* 100,2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, COUNT(DISTINCT B.POST_ID)/COUNT(DISTINCT A.POST_ID) AS DAILY_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY 1 ) C"
587,Y,Y,"SELECT ROUND(AVG(AVERAGE_DAILY_PERCENT), 2) AVERAGE_DAILY_PERCENT FROM ( SELECT (COUNT(DISTINCT B.POST_ID)/COUNT(DISTINCT A.POST_ID)) * 100 AVERAGE_DAILY_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID WHERE EXTRA='SPAM' GROUP BY ACTION_DATE )X"
588,Y,Y,"SELECT ROUND(AVG(CNT), 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS CNT FROM (SELECT ACTION_DATE, POST_ID FROM ACTIONS WHERE EXTRA='SPAM') A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID GROUP BY ACTION_DATE) A"
589,Y,Y,"WITH C AS( SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) PER FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE EXTRA='SPAM' GROUP BY 1) SELECT ROUND(AVG(PER)*100,2) AVERAGE_DAILY_PERCENT FROM C"
590,Y,Y,"SELECT ROUND(100*AVG(REMOVE_RATE),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, COALESCE(COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID),0) AS REMOVE_RATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY 1) T"
591,Y,Y,"SELECT ROUND(SUM(AVERAGE_PERCENT)/COUNT(ACTION_DATE),2.0) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE, ROUND(COUNT(DISTINCT R.POST_ID)*100/COUNT(DISTINCT A.POST_ID),2.0) AS AVERAGE_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE 1=1 AND A.ACTION='REPORT' AND A.EXTRA='SPAM' GROUP BY A.ACTION_DATE ) AS A"
592,Y,Y,"WITH A AS (SELECT DISTINCT TMP.POST_ID, ACTION_DATE, R.REMOVE_DATE FROM (SELECT POST_ID, ACTION_DATE FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA ='SPAM') AS TMP LEFT JOIN REMOVALS R ON TMP.POST_ID = R.POST_ID) SELECT ROUND(AVG(CNT)*100, 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(REMOVE_DATE) / COUNT(*) AS CNT FROM A GROUP BY 1) AS TMP2"
593,Y,Y,"SELECT ROUND(IFNULL(AVG(X)* 100,0),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT DISTINCT ACTION_DATE, COUNT( DISTINCT CASE WHEN POST_ID IN (SELECT DISTINCT POST_ID FROM REMOVALS) THEN POST_ID ELSE NULL END)/ COUNT(DISTINCT POST_ID) AS X FROM ACTIONS WHERE EXTRA = 'SPAM' GROUP BY 1 ORDER BY 1 ) AS A"
594,Y,Y,"SELECT ROUND(AVG(POST_CALC),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) *100 AS POST_CALC FROM ACTIONS A LEFT JOIN REMOVALS R ON R.POST_ID = A.POST_ID WHERE A.EXTRA = 'SPAM' AND A.ACTION = 'REPORT' GROUP BY A.ACTION_DATE) A"
595,Y,Y,"SELECT ROUND(AVG(NUM_REMOVE/NUM_SPAM)*100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(DISTINCT ACTIONS.POST_ID) AS NUM_SPAM, COUNT(DISTINCT CASE WHEN REMOVE_DATE IS NOT NULL THEN POST_ID ELSE NULL END) AS NUM_REMOVE FROM ACTIONS LEFT JOIN REMOVALS USING(POST_ID) WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE HAVING NUM_SPAM > 0) AS TEMP"
596,Y,Y,"WITH REMOVED_SPAM_POSTS AS ( SELECT DISTINCT A.ACTION_DATE, A.POST_ID, CASE WHEN B.POST_ID IS NOT NULL THEN 1 ELSE 0 END AS REMOVED_IND FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID WHERE A.EXTRA = 'SPAM' ) , DAILY_REMOVAL_PERCENTAGE AS ( SELECT ACTION_DATE, (SUM(CASE WHEN REMOVED_IND = 1 THEN 1 ELSE 0 END) / COUNT(POST_ID))*100 AS DAILY_REMOVAL_PERCENTAGE FROM REMOVED_SPAM_POSTS GROUP BY 1 ORDER BY 1 ) SELECT ROUND(SUM(DAILY_REMOVAL_PERCENTAGE) / COUNT(ACTION_DATE),2) AS AVERAGE_DAILY_PERCENT FROM DAILY_REMOVAL_PERCENTAGE"
597,Y,Y,"WITH TEMP AS(SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/ COUNT(DISTINCT A.POST_ID)*100 AS PER FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA ='SPAM' GROUP BY A.ACTION_DATE ) SELECT ROUND(SUM(PER)/COUNT(DISTINCT ACTION_DATE),2) AS AVERAGE_DAILY_PERCENT FROM TEMP"
598,Y,Y,"SELECT ROUND(AVG(REMOVAL_PERCENTAGE), 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID) * 100 / COUNT(DISTINCT A.POST_ID) AS REMOVAL_PERCENTAGE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY ACTION_DATE) SUB"
599,Y,Y,"SELECT ROUND(AVG(ALLAVG)*100,2) AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) ALLAVG FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE A.EXTRA='SPAM' GROUP BY 1) S"
600,Y,Y,"WITH TEMP AS( SELECT DISTINCT POST_ID ,ACTION_DATE FROM ACTIONS WHERE EXTRA = 'SPAM' ), RES AS( SELECT COUNT(R.POST_ID) / COUNT(TEMP.POST_ID) * 100 AS DAILY_PERCENT ,ACTION_DATE FROM TEMP LEFT JOIN REMOVALS R ON TEMP.POST_ID = R.POST_ID GROUP BY TEMP.ACTION_DATE ) SELECT ROUND(AVG(DAILY_PERCENT), 2) AS AVERAGE_DAILY_PERCENT FROM RES"
601,Y,Y,"WITH SPAM AS ( SELECT DISTINCT T1.POST_ID, T1.ACTION_DATE, CASE WHEN T2.REMOVE_DATE IS NULL THEN FALSE ELSE TRUE END AS POST_REMOVED FROM ( SELECT POST_ID, ACTION_DATE FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' ) T1 LEFT JOIN REMOVALS T2 ON T1.POST_ID = T2.POST_ID ), DAILY_REMOVAL AS ( SELECT ACTION_DATE, SUM(POST_REMOVED)/COUNT(POST_ID) AS REMOVAL_RATE FROM SPAM GROUP BY ACTION_DATE ) SELECT ROUND(100*AVG(REMOVAL_RATE), 2) AS AVERAGE_DAILY_PERCENT FROM DAILY_REMOVAL"
602,Y,Y,"SELECT ROUND(100*AVG(REMOVED/REPORTED), 2) AS AVERAGE_DAILY_PERCENT FROM( SELECT COUNT(DISTINCT A.POST_ID) AS REPORTED, COUNT(DISTINCT R.POST_ID) AS REMOVED FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY ACTION_DATE) T"
603,Y,Y,"SELECT ROUND(100*SUM(AVERAGE_DAILY_PERCENT)/COUNT(ACTION_DATE), 2) AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE,(COUNT(DISTINCT B.POST_ID)/COUNT(DISTINCT A.POST_ID)) AVERAGE_DAILY_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID=B.POST_ID WHERE A.EXTRA='SPAM' GROUP BY 1) X"
604,Y,Y,"WITH CTE1 AS( SELECT A.ACTION_DATE, COUNT(DISTINCT(R.POST_ID))/COUNT(DISTINCT(A.POST_ID)) AS POST_CNT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY 1 ) SELECT ROUND(AVG(POST_CNT)*100, 2) AS AVERAGE_DAILY_PERCENT FROM CTE1"
605,Y,Y,"SELECT ROUND(AVG(CNT)*100, 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS CNT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY ACTION_DATE) X"
606,Y,Y,"WITH REPORTED AS ( SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS REPORTED_POSTS FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY ACTION_DATE ), REMOVED AS ( SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS REMOVED_POSTS FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' AND POST_ID IN (SELECT POST_ID FROM REMOVALS) GROUP BY ACTION_DATE ), REPORTED_DAYS AS ( SELECT COUNT(DISTINCT ACTION_DATE) AS TOTAL_DAYS FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' ) SELECT ROUND(AVG(COUNTER),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT (IFNULL(REMOVED_POSTS*100 ,0)/REPORTED_POSTS)AS COUNTER FROM REPORTED R1 LEFT JOIN REMOVED R2 ON R1.ACTION_DATE = R2.ACTION_DATE) A"
607,Y,Y,"WITH CTE AS ( SELECT DISTINCT A.POST_ID, A. ACTION_DATE, R.REMOVE_DATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' ) SELECT ROUND(AVG(AVERAGE_DAILY_PERCENT), 2) AS AVERAGE_DAILY_PERCENT FROM( SELECT COUNT(REMOVE_DATE) / COUNT(POST_ID) * 100 AS AVERAGE_DAILY_PERCENT FROM CTE GROUP BY ACTION_DATE ) T"
608,Y,Y,"SELECT ROUND(100 * AVG(T.PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE, SUM(IF(R.POST_ID IS NULL,0,1))/COUNT(DISTINCT A.POST_ID) AS PERCENT FROM (SELECT DISTINCT POST_ID, ACTION_DATE FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM')A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID GROUP BY A.ACTION_DATE)T"
609,Y,Y,"SELECT ROUND(AVG(DAILY_COUNT), 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS DAILY_COUNT FROM ACTIONS A LEFT JOIN REMOVALS R ON A. POST_ID=R.POST_ID WHERE EXTRA='SPAM' GROUP BY ACTION_DATE) A"
610,Y,Y,"WITH BASE AS (SELECT A.POST_ID, ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS REPORTED_RATIO FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE ACTION='REPORT' AND EXTRA='SPAM' GROUP BY ACTION_DATE) SELECT ROUND(AVG(REPORTED_RATIO)*100,2) AS AVERAGE_DAILY_PERCENT FROM BASE"
611,Y,Y,"SELECT ROUND(100 * SUM(REMOVAL) / COUNT(ACTION_DATE), 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT R.ACTION_DATE , COUNT(DISTINCT CASE WHEN S.POST_ID IS NULL THEN NULL ELSE S.POST_ID END) / COUNT(DISTINCT R.POST_ID) AS REMOVAL FROM ACTIONS AS R LEFT JOIN REMOVALS AS S ON R.POST_ID = S.POST_ID WHERE LOWER(R.ACTION) = 'REPORT' AND LOWER(R.EXTRA) = 'SPAM' GROUP BY R.ACTION_DATE) AS T1"
612,Y,Y,"WITH COMBINE AS( SELECT A.*, R.POST_ID AS REMOVAL_ID FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM') SELECT ROUND(100*AVG(DAILY_PCT), 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(DISTINCT REMOVAL_ID) / COUNT(DISTINCT POST_ID) AS DAILY_PCT FROM COMBINE GROUP BY 1) A"
613,Y,Y,"SELECT ROUND(AVG(PER),2) AS AVERAGE_DAILY_PERCENT FROM( SELECT ACTION_DATE, COUNT(DELET_ID)*100/COUNT(ACTION_DATE) AS PER FROM( SELECT DISTINCT A.POST_ID AS POST_ID1, A.ACTION_DATE,A.EXTRA,R.POST_ID AS DELET_ID FROM ACTIONS AS A LEFT JOIN REMOVALS AS R ON A.POST_ID =R.POST_ID) AS T1 WHERE EXTRA ='SPAM' GROUP BY ACTION_DATE) AS T1"
614,Y,Y,"WITH DAILY_AVG AS( SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) AS RATE_PER_DAY FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY 1) SELECT ROUND( AVG(RATE_PER_DAY)*100 , 2) AS AVERAGE_DAILY_PERCENT FROM DAILY_AVG"
615,Y,Y,"SELECT ROUND(AVG(T.TEMP)*100,2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) TEMP FROM ACTIONS AS A LEFT JOIN REMOVALS AS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ) AS T"
616,Y,Y,"WITH TOT_SPAM AS ( SELECT ACTION_DATE,COUNT(DISTINCT POST_ID) TOT FROM ACTIONS WHERE EXTRA ='SPAM' GROUP BY ACTION_DATE ), RM_ AS ( SELECT ACTION_DATE, COUNT(DISTINCT RM.POST_ID) RM_CNT FROM ACTIONS JOIN REMOVALS RM ON ACTIONS.POST_ID = RM.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE ) SELECT ROUND(AVG(IFNULL(RM_CNT,0)/TOT)*100,2) AVERAGE_DAILY_PERCENT FROM TOT_SPAM LEFT JOIN RM_ ON TOT_SPAM.ACTION_DATE = RM_.ACTION_DATE"
617,Y,Y,"WITH A AS ( SELECT ACTION_DATE, COUNT(DISTINCT B.POST_ID)/COUNT(DISTINCT A.POST_ID) AS REMOVE_RATE FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY ACTION_DATE ) SELECT ROUND((AVG(REMOVE_RATE)*100),2) AS AVERAGE_DAILY_PERCENT FROM A"
618,Y,Y,"SELECT ROUND(AVG(S.DAILY_PERCENT)*100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS DAILY_PERCENT, A.ACTION_DATE FROM ACTIONS AS A LEFT JOIN REMOVALS AS R ON A.POST_ID=R.POST_ID WHERE A.ACTION='REPORT' AND A.EXTRA='SPAM' GROUP BY 2) AS S"
619,Y,Y,"SELECT ROUND(AVG(REMOVED),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, A.POST_ID, (COUNT(DISTINCT R.POST_ID)/ COUNT(DISTINCT A.POST_ID))*100 AS REMOVED FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY 1 ) A"
620,Y,Y,"WITH WLS AS( SELECT B.POST_ID,ACTION_DATE, COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT B.POST_ID) AS DAILY_AVG FROM ACTIONS B LEFT JOIN REMOVALS R ON B.POST_ID = R.POST_ID WHERE B.ACTION = 'REPORT' AND B.EXTRA = 'SPAM' GROUP BY ACTION_DATE ) SELECT ROUND(SUM(DAILY_AVG)/COUNT(ACTION_DATE)*100,2) AS AVERAGE_DAILY_PERCENT FROM WLS"
621,Y,Y,"WITH CTE AS ( SELECT A.ACTION_DATE , COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS REMOVAL_RATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY 1 ) SELECT ROUND(AVG(REMOVAL_RATE)*100.0, 2) AS AVERAGE_DAILY_PERCENT FROM CTE"
622,Y,Y,"SELECT ROUND(AVG(X) * 100, 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT DISTINCT ACTION_DATE, COUNT(DISTINCT CASE WHEN POST_ID IN (SELECT DISTINCT POST_ID FROM REMOVALS) THEN POST_ID ELSE NULL END) / COUNT(DISTINCT POST_ID) AS X FROM ACTIONS WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE) AS TEMP"
623,Y,Y,"WITH CTE AS (SELECT COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS DAILY FROM ACTIONS A LEFT JOIN REMOVALS R ON R.POST_ID = A.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE) SELECT ROUND(AVG(DAILY)*100,2) AS AVERAGE_DAILY_PERCENT FROM CTE"
624,Y,Y,"SELECT ROUND(SUM(FZ/FM)/COUNT(T1.ACTION_DATE)*100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS FM FROM ACTIONS WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE) AS T1 LEFT JOIN (SELECT ACTION_DATE, IFNULL(COUNT(DISTINCT R.POST_ID),0) AS FZ FROM ACTIONS AS A LEFT JOIN REMOVALS AS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE) AS T2 ON T1.ACTION_DATE = T2.ACTION_DATE"
625,Y,Y,"SELECT IFNULL(ROUND(100*AVG(RATE),2),0) AS AVERAGE_DAILY_PERCENT FROM ( SELECT COUNT(DISTINCT R.POST_ID)/ COUNT(DISTINCT A.POST_ID) AS RATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE) T"
626,Y,Y,"SELECT ROUND(AVG(PERCENTAGE), 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS PERCENTAGE FROM ACTIONS AS A LEFT JOIN REMOVALS AS R USING(POST_ID) WHERE EXTRA='SPAM' GROUP BY ACTION_DATE ) AS R1"
627,Y,Y,"WITH CTE AS (SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) DAILY_AVG FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY 1) SELECT ROUND(SUM(DAILY_AVG) * 100 / COUNT(*),2) AVERAGE_DAILY_PERCENT FROM CTE"
628,Y,Y,"WITH T AS (SELECT COUNT(DISTINCT B.POST_ID)/(SELECT COUNT(DISTINCT A.POST_ID) ) AS DAILY_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID=B.POST_ID WHERE A.EXTRA='SPAM' GROUP BY ACTION_DATE) SELECT ROUND(AVG(DAILY_PERCENT)*100,2) AS AVERAGE_DAILY_PERCENT FROM T"
629,Y,Y,"SELECT ROUND(SUM(DAILY_PERCENT)/COUNT(DISTINCT ACTION_DATE),2) AS AVERAGE_DAILY_PERCENT FROM( SELECT (COUNT(DISTINCT B.POST_ID)/COUNT(DISTINCT A.POST_ID))*100 AS DAILY_PERCENT, ACTION_DATE FROM (SELECT * FROM ACTIONS WHERE ACTION='REPORT' AND EXTRA LIKE SPAM ) AS A LEFT JOIN REMOVALS AS B ON A.POST_ID=B.POST_ID GROUP BY ACTION_DATE ) AS C"
630,Y,Y,"WITH REPORTED_POSTS AS ( SELECT DISTINCT A.POST_ID, ACTION_DATE, CASE WHEN B.POST_ID IS NULL THEN 0 ELSE 1 END AS IS_DELETED FROM ACTIONS A LEFT OUTER JOIN REMOVALS B ON A.POST_ID = B.POST_ID WHERE ACTION = 'REPORT'AND EXTRA = 'SPAM') SELECT ROUND(AVG(DAILY_RATE) * 100, 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, SUM(IS_DELETED) / COUNT(*) AS DAILY_RATE FROM REPORTED_POSTS GROUP BY ACTION_DATE ) A"
631,Y,Y,"WITH TEMP AS (SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA='SPAM' GROUP BY A.ACTION_DATE) SELECT ROUND(SUM(PERCENT)/COUNT(ACTION_DATE), 2) AS AVERAGE_DAILY_PERCENT FROM TEMP"
632,Y,Y,"SELECT ROUND(100*AVG(REMOVED_PNT), 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(REMOVED) / COUNT(SPAM) AS REMOVED_PNT FROM (SELECT DISTINCT POST_ID, ACTION_DATE, EXTRA AS SPAM, R.POST_ID AS REMOVED FROM ACTIONS A LEFT JOIN REMOVALS R USING(POST_ID) WHERE EXTRA = 'SPAM') T GROUP BY 1 ) T1"
633,Y,Y,"WITH CTE1 AS ( SELECT DISTINCT POST_ID, ACTION_DATE FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' ), CTE2 AS ( SELECT A.POST_ID, CASE WHEN REMOVE_DATE IS NULL THEN 0 ELSE 1 END AS REMOVE_OR_NOT, REMOVE_DATE, ACTION_DATE FROM CTE1 A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID ), CTE3 AS ( SELECT ACTION_DATE, IFNULL(AVG(REMOVE_OR_NOT), 0) AS PERCENTAGE FROM CTE2 GROUP BY ACTION_DATE ) SELECT ROUND(AVG(PERCENTAGE*100), 2) AS AVERAGE_DAILY_PERCENT FROM CTE3"
634,Y,Y,"WITH REPORTED_POSTS AS ( SELECT POST_ID , ACTION_DATE , ACTION , EXTRA FROM ACTIONS WHERE ACTION='REPORT' AND EXTRA='SPAM' ), DAILY_PER AS ( SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS DAILY_PERCENT FROM REPORTED_POSTS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID GROUP BY ACTION_DATE ) SELECT ROUND(AVG(DAILY_PERCENT)*100,2) AS AVERAGE_DAILY_PERCENT FROM DAILY_PER"
635,Y,Y,"WITH TEMP1 AS( SELECT DISTINCT A.POST_ID, A.ACTION_DATE, CASE WHEN R.POST_ID IS NOT NULL THEN 1 ELSE 0 END AS REMOVED FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE EXTRA='SPAM') SELECT ROUND(AVG(REMOVE_PERCENTAGE),2) AS AVERAGE_DAILY_PERCENT FROM( SELECT ACTION_DATE, ROUND(SUM(REMOVED)/COUNT(POST_ID)*100,2) AS REMOVE_PERCENTAGE FROM TEMP1 GROUP BY 1) A"
636,Y,Y,"WITH CTE AS ( SELECT DISTINCT T.POST_ID, T.ACTION_DATE, CASE WHEN A.POST_ID IS NOT NULL THEN 1 ELSE 0 END AS R_FLAG FROM ACTIONS T LEFT JOIN REMOVALS A ON T.POST_ID = A.POST_ID WHERE T.EXTRA = 'SPAM' ) SELECT ROUND((SUM(B.DAILY_PERCENT)/COUNT(*)),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, (SUM(R_FLAG)/COUNT(*))*100 AS DAILY_PERCENT FROM CTE GROUP BY 1 ) AS B"
637,Y,Y,"WITH CTE AS ( SELECT POST_ID, ACTION_DATE, EXTRA FROM ACTIONS WHERE EXTRA = 'SPAM' AND ACTION = 'REPORT' ) SELECT ROUND(AVG(RATE)*100, 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT C.POST_ID) AS RATE FROM CTE C LEFT JOIN REMOVALS R ON C.POST_ID = R.POST_ID GROUP BY ACTION_DATE) AS DAILYPERC"
638,Y,Y,"SELECT ROUND(AVG(DAILY_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, (COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID))*100 AS DAILY_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE ACTION='REPORT' AND EXTRA='SPAM' GROUP BY ACTION_DATE ) B"
639,Y,Y,"SELECT ROUND(AVG(T1.RATIO) * 100, 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT SUM(IF(A.POST_ID = R.POST_ID, 1, 0)) / COUNT(A.POST_ID) AS RATIO FROM ( SELECT DISTINCT POST_ID, ACTION_DATE FROM ACTIONS WHERE EXTRA = 'SPAM' ) A LEFT JOIN ( SELECT POST_ID FROM REMOVALS ) R ON A.POST_ID = R.POST_ID GROUP BY ACTION_DATE ) T1"
640,Y,Y,"WITH STEP1 AS (SELECT ACTION_DATE, A.POST_ID AS SPAM, R.POST_ID AS REPORT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM'), STEP2 AS ( SELECT ACTION_DATE, IFNULL(COUNT(DISTINCT REPORT)/COUNT(DISTINCT SPAM),0)*100 AS PCT FROM STEP1 GROUP BY 1 ) SELECT ROUND(AVG(PCT),2) AS AVERAGE_DAILY_PERCENT FROM STEP2"
641,Y,Y,"SELECT ROUND(AVG(X.AV)*100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS AV FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.ACTION='REPORT' AND A.EXTRA='SPAM' GROUP BY A.ACTION_DATE)X"
642,Y,Y,"SELECT ROUND(AVG(CNT),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT (COUNT(DISTINCT R.POST_ID)/ COUNT(DISTINCT A.POST_ID))*100 AS CNT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA='SPAM' GROUP BY ACTION_DATE) T1"
643,Y,Y,"WITH CTE AS ( SELECT REPORT_DATE, COUNT(REMOVED)*100 / COUNT(REPORTED_POST) AS PCT FROM ( SELECT DISTINCT A.POST_ID AS REPORTED_POST, A.ACTION_DATE AS REPORT_DATE, R.POST_ID AS REMOVED FROM ACTIONS A LEFT JOIN REMOVALS R ON R.POST_ID = A.POST_ID WHERE A.EXTRA = 'SPAM' AND A.ACTION = 'REPORT') X GROUP BY REPORT_DATE) SELECT ROUND(AVG(PCT),2) AVERAGE_DAILY_PERCENT FROM CTE"
644,Y,Y,"WITH CTE AS ( SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS DAILY_PERCENTAGE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE ACTION='REPORT' AND EXTRA='SPAM' GROUP BY ACTION_DATE) SELECT ROUND(AVG(DAILY_PERCENTAGE)*100,2) AS AVERAGE_DAILY_PERCENT FROM CTE"
645,Y,Y,"WITH CTE AS ( SELECT COUNT(DISTINCT R.POST_ID)/ COUNT(DISTINCT A.POST_ID) *100 AS AVG_REMOVAL FROM ACTIONS A LEFT JOIN REMOVALS R USING(POST_ID) WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE) SELECT ROUND(AVG(AVG_REMOVAL), 2) AS AVERAGE_DAILY_PERCENT FROM CTE"
646,Y,Y,"WITH T AS (SELECT POST_ID, ACTION_DATE, ACTION FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM'), T2 AS( SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT T.POST_ID) AS DAILY_RATE FROM T LEFT JOIN REMOVALS R ON T.POST_ID = R.POST_ID GROUP BY ACTION_DATE) SELECT ROUND(AVG(DAILY_RATE) * 100,2) AS AVERAGE_DAILY_PERCENT FROM T2"
647,Y,Y,"SELECT ROUND(100 * AVG(DAILY_RATE), 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT IFNULL(COUNT(DISTINCT B.POST_ID) / COUNT(DISTINCT A.POST_ID), 0) AS DAILY_RATE FROM ACTIONS A LEFT JOIN REMOVALS B ON A.EXTRA = 'SPAM' AND B.POST_ID = A.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE) T"
648,Y,Y,"WITH T1 AS ( SELECT A.POST_ID, A.ACTION_DATE, MAX(IF(R.REMOVE_DATE IS NOT NULL, 1, 0)) AS REMOVED FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY 1,2 ), T2 AS ( SELECT ACTION_DATE, SUM(REMOVED)/COUNT(POST_ID) AS AVERAGE_DAILY_PERCENT FROM T1 GROUP BY 1 ) SELECT ROUND(AVG(AVERAGE_DAILY_PERCENT)*100, 2) AS AVERAGE_DAILY_PERCENT FROM T2"
649,Y,Y,"SELECT ROUND(SUM(PERCENT)/COUNT(DISTINCT ACTION_DATE),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE , COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE ) TEMP"
650,Y,Y,"WITH ACTIONS AS( SELECT DISTINCT POST_ID, ACTION_DATE,ACTION,EXTRA FROM ACTIONS ) SELECT IFNULL(ROUND(AVG(DAILY),2),0) AS AVERAGE_DAILY_PERCENT FROM (SELECT T1.ACTION_DATE, 100*IFNULL(S2.REMOVAL,0)/T1.TOTAL_SPAM AS DAILY FROM (SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS TOTAL_SPAM FROM ACTIONS WHERE EXTRA = 'SPAM' AND ACTION = 'REPORT' GROUP BY ACTION_DATE) AS T1 LEFT JOIN (SELECT ACTION_DATE, COUNT(POST_ID) AS REMOVAL FROM (SELECT ACTIONS.POST_ID, ACTIONS.ACTION_DATE FROM ACTIONS INNER JOIN REMOVALS ON ACTIONS.POST_ID = REMOVALS.POST_ID AND ACTIONS.EXTRA = 'SPAM' AND ACTIONS.ACTION = 'REPORT') AS S1 GROUP BY ACTION_DATE) AS S2 ON T1.ACTION_DATE = S2.ACTION_DATE) AS T2"
651,Y,Y,"WITH CTE AS ( SELECT A.ACTION_DATE,COUNT(DISTINCT B.POST_ID)/COUNT(DISTINCT A.POST_ID)* 100 AS ACTIONS FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID=B.POST_ID WHERE EXTRA='SPAM' GROUP BY ACTION_DATE ) SELECT ROUND(SUM(ACTIONS)/COUNT(DISTINCT ACTION_DATE),2) AS AVERAGE_DAILY_PERCENT FROM CTE"
652,Y,Y,"SELECT ROUND(SUM(REM_PERC)*100/COUNT(*),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE ,COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS REM_PERC FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA IN ('SPAM') GROUP BY 1 )X"
653,Y,Y,"WITH REPORTED_POSTS AS ( SELECT DISTINCT A.POST_ID, ACTION_DATE, CASE WHEN B.POST_ID IS NULL THEN 0 ELSE 1 END AS IS_DELECTED FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID=B.POST_ID WHERE ACTION='REPORT' AND EXTRA='SPAM' ) SELECT ROUND(AVG(DAILY_RATE)*100,2)AS AVERAGE_DAILY_PERCENT FROM( SELECT ACTION_DATE, SUM(IS_DELECTED)/COUNT(1) AS DAILY_RATE FROM REPORTED_POSTS GROUP BY ACTION_DATE )A"
654,Y,Y,"WITH A AS (SELECT ACTION_DATE, COUNT(DISTINCT CASE WHEN EXTRA = 'SPAM' AND REMOVE_DATE IS NOT NULL THEN A.POST_ID END)/ COUNT(DISTINCT CASE WHEN EXTRA = 'SPAM' AND ACTION= 'REPORT' THEN A.POST_ID END) AS REMOVE_RATE FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID GROUP BY 1 ) SELECT ROUND(AVG(REMOVE_RATE*100),2) AS AVERAGE_DAILY_PERCENT FROM A"
655,Y,Y,"SELECT ROUND(AVG(CNT),2) AVERAGE_DAILY_PERCENT FROM (SELECT COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) * 100 AS CNT FROM ACTIONS A LEFT JOIN REMOVALS R USING(POST_ID) WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE)TBL"
656,Y,Y,"SELECT ROUND(AVG(IFNULL(B.RMCOUNT*100,0)/A.RPCOUNT),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS RPCOUNT FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY 1) AS A LEFT JOIN (SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) RMCOUNT FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' AND POST_ID IN (SELECT POST_ID FROM REMOVALS) GROUP BY 1) AS B ON A.ACTION_DATE = B.ACTION_DATE"
657,Y,Y,"WITH CTE AS ( SELECT COUNT(DISTINCT B.POST_ID) / COUNT(DISTINCT A.POST_ID) AS PERCENTAGE FROM ACTIONS AS A LEFT JOIN REMOVALS AS B ON A.POST_ID = B.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ) SELECT ROUND(AVG(PERCENTAGE) * 100, 2) AS AVERAGE_DAILY_PERCENT FROM CTE"
658,Y,Y,"WITH TEMP AS (SELECT A.ACTION_DATE, A.POST_ID, B.POST_ID AS REMOVED_POST FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID AND A.ACTION_DATE <= B.REMOVE_DATE WHERE A.EXTRA = 'SPAM'), CNT_TABLE AS( SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS CNT1, COUNT(DISTINCT REMOVED_POST) AS CNT2 FROM TEMP GROUP BY 1 ) SELECT ROUND(AVG(CNT2/CNT1)*100,2) AS AVERAGE_DAILY_PERCENT FROM CNT_TABLE"
659,Y,Y,"SELECT ROUND(AVG(T1.RATIO) * 100, 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT SUM(IF(A.POST_ID = R.POST_ID, 1, 0)) / COUNT(A.POST_ID) AS RATIO FROM ( SELECT DISTINCT POST_ID, ACTION_DATE FROM ACTIONS WHERE EXTRA = 'SPAM' ) A LEFT JOIN ( SELECT DISTINCT POST_ID FROM REMOVALS ) R ON A.POST_ID = R.POST_ID GROUP BY ACTION_DATE ) T1"
660,Y,Y,"WITH CTE AS ( SELECT COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) AS CNT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE ) SELECT ROUND(100 * AVG(CNT),2) AS AVERAGE_DAILY_PERCENT FROM CTE"
661,Y,Y,"WITH REPORTED AS ( SELECT ACTION_DATE, ACT.POST_ID, REMOVE_DATE FROM ACTIONS ACT LEFT JOIN REMOVALS REM ON ACT.POST_ID = REM.POST_ID WHERE ACT.ACTION = 'REPORT' AND ACT.EXTRA = 'SPAM' ), DELETED AS ( SELECT * FROM REPORTED WHERE REMOVE_DATE IS NOT NULL ), DAILY AS ( SELECT R.ACTION_DATE, COUNT(DISTINCT D.POST_ID)/COUNT(DISTINCT R.POST_ID) AS DEL_NUM FROM REPORTED R LEFT JOIN DELETED D USING (POST_ID) GROUP BY ACTION_DATE ) SELECT ROUND(AVG(DEL_NUM) * 100,2) AS AVERAGE_DAILY_PERCENT FROM DAILY"
662,Y,Y,"SELECT ROUND(AVG(PCT_REMOVED)*100,2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, COUNT(DISTINCT REMOVALS.POST_ID)/COUNT(DISTINCT ACTIONS.POST_ID) AS PCT_REMOVED FROM ACTIONS LEFT JOIN REMOVALS USING(POST_ID) WHERE ACTION= 'REPORT' AND EXTRA = 'SPAM' GROUP BY ACTION_DATE ) T"
663,Y,Y,"WITH BASE AS ( SELECT ACTION_DATE , A.POST_ID , R.REMOVE_DATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A. POST_ID=R.POST_ID AND REMOVE_DATE>= ACTION_DATE WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' ) ,DAILY AS ( SELECT ACTION_DATE , COUNT(DISTINCT POST_ID) AS DENOMIN , COUNT(DISTINCT(CASE WHEN REMOVE_DATE IS NULL THEN NULL ELSE POST_ID END)) AS NUMERATOR FROM BASE B GROUP BY ACTION_DATE ) ,PERCENTAGE AS ( SELECT ACTION_DATE, NUMERATOR/DENOMIN AS PERCENTAGE FROM DAILY D ) SELECT ROUND(AVG(PERCENTAGE)*100,2) AS AVERAGE_DAILY_PERCENT FROM PERCENTAGE"
664,Y,Y,"WITH T AS ( SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) * 100 AS PERC FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY 1 ) SELECT ROUND(AVG(PERC),2) AS AVERAGE_DAILY_PERCENT FROM T"
665,Y,Y,"WITH TEMP AS( SELECT A.ACTION_DATE, COUNT(DISTINCT B.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS RATE FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY 1) SELECT ROUND(AVG(RATE),2) AS AVERAGE_DAILY_PERCENT FROM TEMP"
666,Y,Y,"SELECT ROUND(AVG(DAILY_PERCENTAGE),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE,SUM(SPAM)/COUNT(POST_ID)*100 AS DAILY_PERCENTAGE FROM (SELECT DISTINCT A.POST_ID,ACTION_DATE,IF(R.POST_ID IS NULL,0,1) AS SPAM FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE ACTION='REPORT' AND EXTRA='SPAM') AS TMP GROUP BY ACTION_DATE) AS TMP1"
667,Y,Y,"WITH TB AS ( SELECT DISTINCT POST_ID, ACTION_DATE FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' ), TB1 AS ( SELECT A.*, R.POST_ID AS REMOVE_ID, REMOVE_DATE FROM TB AS A LEFT JOIN REMOVALS AS R USING(POST_ID) ), TB2 AS ( SELECT COUNT(REMOVE_DATE >= ACTION_DATE)/COUNT(DISTINCT POST_ID)*100 AS PCT FROM TB1 GROUP BY ACTION_DATE ) SELECT ROUND(AVG(PCT),2) AS AVERAGE_DAILY_PERCENT FROM TB2"
668,Y,Y,"WITH CTE AS ( SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS DAILY_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY ACTION_DATE ) SELECT ROUND(100* AVG(DAILY_PERCENT), 2) AS AVERAGE_DAILY_PERCENT FROM CTE"
669,Y,Y,"SELECT ROUND(AVG(DAILY_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, ROUND(SUM(CASE WHEN T1.EXTRA = 'SPAM' AND T2.POST_ID IS NOT NULL THEN 1 ELSE 0 END)*100/SUM(CASE WHEN T1.EXTRA = 'SPAM' THEN 1 ELSE NULL END),2) AS DAILY_PERCENT FROM (SELECT ACTION_DATE, POST_ID, EXTRA FROM ACTIONS GROUP BY 1,2,3) T1 LEFT JOIN REMOVALS T2 ON T1.POST_ID = T2.POST_ID WHERE ACTION_DATE IN (SELECT ACTION_DATE FROM ACTIONS WHERE EXTRA = 'SPAM') GROUP BY 1) R"
670,Y,Y,"WITH CTE AS ( SELECT POST_ID, ACTION_DATE, COUNT(*) AS TOTAL FROM ACTIONS WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE, POST_ID ) SELECT ROUND(100*AVG(PCT),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, COUNT(R.REMOVE_DATE)/COUNT(ACTION_DATE) AS PCT FROM CTE LEFT JOIN REMOVALS R ON CTE.POST_ID = R.POST_ID GROUP BY ACTION_DATE ) TEMP"
671,Y,Y,"SELECT ROUND(AVG(R.DAILY_PERCENTAGE),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT AVG(CASE WHEN R.REMOVE_DATE IS NOT NULL THEN 1 ELSE 0 END)*100 AS DAILY_PERCENTAGE,TEMP.ACTION_DATE FROM (SELECT DISTINCT POST_ID,ACTION_DATE FROM ACTIONS WHERE ACTION='REPORT' AND EXTRA='SPAM') TEMP LEFT JOIN REMOVALS R ON (TEMP.POST_ID=R.POST_ID AND TEMP.ACTION_DATE<=R.REMOVE_DATE) GROUP BY TEMP.ACTION_DATE) R"
672,Y,Y,"WITH DAILY AS ( SELECT ACTION_DATE, COUNT(DISTINCT (CASE WHEN REMOVE_DATE IS NOT NULL THEN T1.POST_ID END))/COUNT(DISTINCT T1.POST_ID) AS DAILY_RATE FROM ACTIONS T1 LEFT JOIN REMOVALS T2 ON T1.POST_ID=T2.POST_ID WHERE EXTRA='SPAM' GROUP BY ACTION_DATE) SELECT ROUND(AVG(DAILY_RATE)*100,2) AS AVERAGE_DAILY_PERCENT FROM DAILY"
673,Y,Y,"WITH TEMP AS( SELECT A.POST_ID, ACTION_DATE, EXTRA, R.POST_ID AS REMOVE_ID, REMOVE_DATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE EXTRA = 'SPAM' ), TEMP2 AS (SELECT ACTION_DATE, COUNT(DISTINCT REMOVE_ID)/COUNT(DISTINCT POST_ID) AS DAILY_AVG FROM TEMP GROUP BY ACTION_DATE) SELECT ROUND(AVG(DAILY_AVG)*100,2) AS AVERAGE_DAILY_PERCENT FROM TEMP2"
674,Y,Y,"WITH CTE AS ( SELECT DISTINCT POST_ID, ACTION_DATE FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM'), CTE1 AS ( SELECT CTE.ACTION_DATE, IFNULL(COUNT(RM.POST_ID)*100/COUNT(CTE.POST_ID), 0) AS PERC FROM CTE LEFT JOIN REMOVALS RM ON CTE.POST_ID = RM.POST_ID GROUP BY CTE.ACTION_DATE) SELECT ROUND(AVG(PERC), 2) AS AVERAGE_DAILY_PERCENT FROM CTE1"
675,Y,Y,"SELECT ROUND(AVG(C.REMOVE/C.SPAM)*100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE,COUNT(DISTINCT B.POST_ID) AS REMOVE, COUNT(DISTINCT A.POST_ID) AS SPAM FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE) C"
676,Y,Y,"SELECT ROUND(AVG(DAILY_PERCENT*1.0)*100,2) AS AVERAGE_DAILY_PERCENT FROM( SELECT CAST(COUNT(DISTINCT(R. POST_ID)) AS DECIMAL (10,3))/COUNT(DISTINCT(A. POST_ID))AS DAILY_PERCENT, ACTION_DATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A. POST_ID=R. POST_ID WHERE ACTION='REPORT' AND EXTRA='SPAM' GROUP BY ACTION_DATE ) AS SUB"
677,Y,Y,"SELECT CAST(AVG(DAILY_PERCENT) AS DECIMAL(10,2)) AS AVERAGE_DAILY_PERCENT FROM( SELECT A.ACTION_DATE, SUM(CASE WHEN R.POST_ID IS NULL THEN 0 ELSE 1 END)*100.00/COUNT(A.POST_ID) AS DAILY_PERCENT FROM (SELECT DISTINCT POST_ID, ACTION_DATE FROM ACTIONS WHERE EXTRA = 'SPAM') AS A LEFT JOIN REMOVALS AS R ON A.POST_ID = R.POST_ID GROUP BY A.ACTION_DATE)A"
678,Y,Y,"WITH TMP AS ( SELECT A.ACTION_DATE, (COUNT(DISTINCT R.POST_ID)/ COUNT(DISTINCT A.POST_ID))*100 AS FRAC FROM ACTIONS AS A LEFT JOIN REMOVALS AS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ) SELECT ROUND(AVG(FRAC),2) AS AVERAGE_DAILY_PERCENT FROM TMP"
679,Y,Y,"SELECT ROUND(AVG(AVG_RATE)*100, 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS AVG_RATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' GROUP BY 1) T"
680,Y,Y,"WITH CTE AS ( SELECT A.ACTION_DATE,COUNT(DISTINCT A.POST_ID) AS CNT FROM ACTIONS A JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE A.EXTRA='SPAM' GROUP BY A.ACTION_DATE) SELECT ROUND((SUM(B.RATIO) / COUNT(DISTINCT B.ACTION_DATE))*100, 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT D.ACTION_DATE,(C.CNT/COUNT(DISTINCT D.POST_ID)) AS RATIO FROM ACTIONS D LEFT JOIN CTE C ON D.ACTION_DATE = C.ACTION_DATE WHERE D.EXTRA='SPAM' GROUP BY D.ACTION_DATE ) B"
681,Y,Y,"WITH TEMP AS( SELECT A.USER_ID, A.POST_ID, A.ACTION_DATE, A.EXTRA, R.REMOVE_DATE, COUNT(DISTINCT CASE WHEN R.REMOVE_DATE IS NOT NULL THEN A.POST_ID ELSE NULL END)/ COUNT(DISTINCT A.POST_ID) AS PERCENT FROM ACTIONS AS A LEFT JOIN REMOVALS AS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ) SELECT ROUND((SUM(PERCENT) / COUNT(ACTION_DATE))*100, 2) AS AVERAGE_DAILY_PERCENT FROM TEMP"
682,Y,Y,"SELECT ROUND(AVG(AVERAGE_RM_RATE)*100,2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE , COUNT(DISTINCT CASE WHEN B.POST_ID IS NOT NULL THEN A.POST_ID ELSE NULL END)/ COUNT(DISTINCT A.POST_ID) AS AVERAGE_RM_RATE FROM ( SELECT ACTION_DATE, POST_ID FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' )A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID GROUP BY ACTION_DATE )A"
683,Y,Y,"SELECT ROUND(AVG(DAILY)*100,2) AS AVERAGE_DAILY_PERCENT FROM( SELECT ACTION_DATE, COUNT(B.POST_ID)/COUNT(A.POST_ID) AS DAILY FROM ( SELECT ACTION_DATE, POST_ID FROM ACTIONS WHERE ACTION='REPORT' AND EXTRA='SPAM' GROUP BY 1,2 ) AS A LEFT JOIN REMOVALS AS B ON A.POST_ID=B.POST_ID GROUP BY 1 ) AS C"
684,Y,Y,"WITH CTE AS (SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) DAILY_AVG FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY 1) SELECT ROUND(SUM(DAILY_AVG) * 100 / COUNT(*),2) AVERAGE_DAILY_PERCENT FROM CTE"
685,Y,Y,"WITH CTE AS (SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS RATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY ACTION_DATE) SELECT ROUND(AVG(RATE)*100, 2) AS AVERAGE_DAILY_PERCENT FROM CTE"
686,Y,Y,"WITH CTE AS (SELECT POST_ID, ACTION_DATE FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM'), DAILY AS (SELECT CTE.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT CTE.POST_ID) AS DEL_NUM FROM CTE LEFT JOIN REMOVALS R ON CTE.POST_ID = R.POST_ID AND R.REMOVE_DATE > CTE.ACTION_DATE GROUP BY CTE.ACTION_DATE) SELECT ROUND(100*AVG(DEL_NUM), 2) AVERAGE_DAILY_PERCENT FROM DAILY"
687,Y,Y,"SELECT ROUND(AVG(C.CNT1),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT COUNT(DISTINCT B.POST_ID)/COUNT(DISTINCT A.POST_ID) *100 AS CNT1 FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID AND A.ACTION_DATE <= B.REMOVE_DATE WHERE A.EXTRA ='SPAM' GROUP BY A.ACTION_DATE) C"
688,Y,Y,"SELECT ROUND(AVG(TEMP.PER)*100,2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS PER FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE A.EXTRA='SPAM' GROUP BY A.ACTION_DATE) TEMP"
689,Y,Y,"WITH CTE AS ( SELECT COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS DAILY_RATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ) SELECT ROUND(AVG(DAILY_RATE)*100,2) AS AVERAGE_DAILY_PERCENT FROM CTE"
690,Y,Y,"SELECT ROUND(SUM(SPAM_REM_RATIO*100)/COUNT(*),2) AS AVERAGE_DAILY_PERCENT FROM( SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID) AS TOTAL_SPAM_REMOVED , COUNT(DISTINCT A.POST_ID) AS TOTAL_SPAM_REPORTED , COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS SPAM_REM_RATIO FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA IN ('SPAM') GROUP BY ACTION_DATE ) AS T"
691,Y,Y,"SELECT ROUND(AVG(COUNT_PCT), 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) * 100 AS COUNT_PCT FROM ACTIONS AS A LEFT JOIN REMOVALS AS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE) AS TEMP"
692,Y,Y,"SELECT ROUND(AVG(CNT),2) AS AVERAGE_DAILY_PERCENT FROM( SELECT COUNT(DISTINCT R.POST_ID) * 100 / COUNT(DISTINCT A.POST_ID) AS CNT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY ACTION_DATE) T"
693,Y,Y,"WITH CTE AS ( SELECT ACTION_DATE, COUNT(DISTINCT ACT.POST_ID) DAILY_TOTAL, COUNT(DISTINCT RM.POST_ID) DAILY_RM FROM ACTIONS ACT LEFT JOIN REMOVALS RM ON ACT.POST_ID=RM.POST_ID WHERE EXTRA='SPAM' GROUP BY ACTION_DATE ) SELECT ROUND(AVG(DAILY_RM / DAILY_TOTAL) * 100, 2) AVERAGE_DAILY_PERCENT FROM CTE"
694,Y,Y,"SELECT ROUND(SUM(PERC)/COUNT(ACTION_DATE),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT A.ACTION_DATE, COUNT(DISTINCT A.POST_ID) AS REPORTED, COALESCE(COUNT(DISTINCT B.POST_ID),0) AS REMOVED, 100*COALESCE(COUNT(DISTINCT B.POST_ID),0)/COUNT(DISTINCT A.POST_ID) AS PERC FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ) A"
695,Y,Y,"SELECT ROUND(AVG(DAILY_PERCENT)*100,2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) AS DAILY_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY ACTION_DATE ) A"
696,Y,Y,"WITH NUM_SPAM_REPORTED AS ( SELECT A.POST_ID AS APOSTID, R.POST_ID AS RPOSTID, ACTION_DATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM'), CAL_PERCENT AS ( SELECT COUNT(DISTINCT RPOSTID)/COUNT(DISTINCT APOSTID) AS PERCENT FROM NUM_SPAM_REPORTED GROUP BY ACTION_DATE) SELECT ROUND(AVG(PERCENT)*100,2) AS AVERAGE_DAILY_PERCENT FROM CAL_PERCENT"
697,Y,Y,"WITH POSTSINFO AS ( SELECT ACTION_DATE, COUNT(DISTINCT B.POST_ID)/COUNT(DISTINCT A.POST_ID) AS PCT FROM ACTIONS A LEFT JOIN REMOVALS B USING (POST_ID) WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY 1 ) SELECT ROUND(AVG(PCT), 4) * 100 AS AVERAGE_DAILY_PERCENT FROM POSTSINFO"
698,Y,Y,"WITH Q1 AS ( SELECT DISTINCT A.POST_ID,A.ACTION_DATE,CASE WHEN B.POST_ID IS NULL THEN 0 ELSE 1 END AS REMVCNT FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID=B.POST_ID WHERE ACTION='REPORT' AND EXTRA='SPAM') SELECT ROUND((AVG(RMVPCNT)*100),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE,SUM(REMVCNT)/COUNT(*) AS RMVPCNT FROM Q1 GROUP BY ACTION_DATE)C"
699,Y,Y,"SELECT ROUND(AVG(PERCENTAGE)*100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS PERCENTAGE FROM (SELECT USER_ID, POST_ID,ACTION_DATE FROM ACTIONS WHERE EXTRA='SPAM') A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID GROUP BY ACTION_DATE) B"
700,Y,Y,"SELECT ROUND(AVG(DAILY_PERCENTAGE),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)*100/ COUNT(DISTINCT T2.POST_ID) AS DAILY_PERCENTAGE FROM (SELECT * FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM') T2 LEFT JOIN REMOVALS R USING (POST_ID) GROUP BY ACTION_DATE ) T1"
701,Y,Y,"WITH CLEAN_TBL AS ( SELECT DISTINCT POST_ID, ACTION_DATE, EXTRA FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM') SELECT ROUND(SUM(REMOVE_RATE)/COUNT(REMOVE_RATE)*100 , 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT COUNT(REMOVE_DATE)/ COUNT(A.POST_ID) AS REMOVE_RATE FROM CLEAN_TBL A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID GROUP BY ACTION_DATE ) PCT_REMOVES"
702,Y,Y,"SELECT ROUND( AVG(REMOVED_POSTS),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE,ROUND(COUNT(DISTINCT R.POST_ID)*100.0/ COUNT(DISTINCT A.POST_ID),2) REMOVED_POSTS FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE EXTRA='SPAM' AND ACTION='REPORT' GROUP BY ACTION_DATE ) TEMP"
703,Y,Y,"SELECT ROUND((SUM(PERC_REM)/COUNT(PERC_REM)*100), 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS PERC_REM FROM ACTIONS A LEFT JOIN REMOVALS R ON R.POST_ID = A.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ) X"
704,Y,Y,"WITH SUB AS( SELECT ACTION_DATE, POST_ID, EXTRA FROM ACTIONS WHERE EXTRA = 'SPAM' AND ACTION = 'REPORT' ), JTAB AS ( SELECT S.POST_ID, S.ACTION_DATE, COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT S.POST_ID) AS DAILY_RATE FROM SUB AS S LEFT JOIN REMOVALS AS R ON S.POST_ID = R.POST_ID GROUP BY S.ACTION_DATE) SELECT ROUND(AVG(DAILY_RATE)*100,2) AS AVERAGE_DAILY_PERCENT FROM JTAB"
705,Y,Y,"WITH REMOVED_POSTS AS ( SELECT DISTINCT T1.POST_ID, T1.ACTION_DATE, T2.REMOVE_DATE FROM ( SELECT * FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' ) T1 LEFT JOIN REMOVALS T2 ON T1.POST_ID = T2.POST_ID ) SELECT ROUND(100*AVG(REMOVAL_RATE), 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, SUM(REMOVE_DATE IS NOT NULL)/COUNT(*) AS REMOVAL_RATE FROM REMOVED_POSTS GROUP BY ACTION_DATE ) T"
706,Y,Y,"WITH CTE AS ( SELECT ACTION_DATE, CAST(COUNT(DISTINCT A.POST_ID) AS FLOAT) AS TOTAL, CAST(COUNT(DISTINCT R.POST_ID) AS FLOAT) AS REMOVED FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ) SELECT ROUND(100*AVG(REMOVED/TOTAL), 2) AS AVERAGE_DAILY_PERCENT FROM CTE"
707,Y,Y,"WITH T AS (SELECT ACTION_DATE, COUNT(DISTINCT REMOVALS.POST_ID)/ COUNT(DISTINCT ACTIONS.POST_ID ) AS PERC_REM FROM ACTIONS LEFT JOIN REMOVALS ON ACTIONS.POST_ID = REMOVALS.POST_ID WHERE EXTRA = 'SPAM' GROUP BY 1) SELECT ROUND(SUM(PERC_REM)* 100 /COUNT(*),2) AS AVERAGE_DAILY_PERCENT FROM T"
708,Y,Y,"SELECT ROUND(AVG(DAILY_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE, ((COUNT(DISTINCT R.POST_ID)*1.0) / (COUNT(DISTINCT A.POST_ID)*1.0))*100 AS DAILY_PERCENT FROM (SELECT POST_ID, ACTION_DATE FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM') AS A LEFT JOIN REMOVALS AS R ON A.POST_ID = R.POST_ID GROUP BY A.ACTION_DATE) AS T1"
709,Y,Y,"WITH SUB_RATE AS ( SELECT COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) AS DAILY_RATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE ) SELECT ROUND( AVG(DAILY_RATE) * 100, 2 ) AS AVERAGE_DAILY_PERCENT FROM SUB_RATE"
710,Y,Y,"WITH DAILY_PERCENTAGE AS (SELECT COUNT(DISTINCT CASE WHEN R.REMOVE_DATE IS NOT NULL THEN A.POST_ID END)/ COUNT(DISTINCT A.POST_ID)*100 AS PRCNT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE) SELECT ROUND(AVG(PRCNT), 2) AS AVERAGE_DAILY_PERCENT FROM DAILY_PERCENTAGE"
711,Y,Y,"SELECT ROUND(SUM(PERCENTS)/COUNT(ACTION_DATE),2) AS AVERAGE_DAILY_PERCENT FROM( SELECT A.ACTION_DATE, (COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID))*100 AS PERCENTS FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE) T"
712,Y,Y,"SELECT ROUND(SUM(AVEREAGE_DAILY_PERCENT)/COUNT(AVEREAGE_DAILY_PERCENT)*100,2) AS AVERAGE_DAILY_PERCENT FROM(SELECT COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS AVEREAGE_DAILY_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE) TEMP"
713,Y,Y,"SELECT ROUND(AVG(DAILY_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT COUNT(DISTINCT A.POST_ID) / COUNT(DISTINCT B.POST_ID)*100 AS DAILY_PERCENT FROM REMOVALS A RIGHT JOIN ACTIONS B ON A.POST_ID =B.POST_ID WHERE B.EXTRA = 'SPAM' GROUP BY B.ACTION_DATE) AS C"
714,Y,Y,"WITH CTE AS ( SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS CNT FROM ACTIONS A LEFT JOIN REMOVALS R USING (POST_ID) WHERE EXTRA = 'SPAM' GROUP BY 1 ) SELECT ROUND(AVG(CNT)*100,2) AS AVERAGE_DAILY_PERCENT FROM CTE"
715,Y,Y,"SELECT ROUND(SUM(PERC)*100/COUNT(*),2) AS AVERAGE_DAILY_PERCENT FROM( SELECT A.ACTION_DATE,COUNT(DISTINCT A.POST_ID ),COUNT(DISTINCT R.POST_ID), COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID ) AS PERC FROM ACTIONS A LEFT JOIN REMOVALS R USING (POST_ID) WHERE A.EXTRA = 'SPAM' GROUP BY ACTION_DATE)B"
716,Y,Y,"WITH CTE AS (SELECT A.*, R.POST_ID AS ID FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM') SELECT ROUND(AVG(PERCENT), 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ROUND(100 * COUNT(DISTINCT ID) / COUNT(DISTINCT POST_ID), 2) AS PERCENT FROM CTE GROUP BY ACTION_DATE) A"
717,Y,Y,"SELECT ROUND(AVG(AVG_PER_DATE),2)AS AVERAGE_DAILY_PERCENT FROM ( SELECT (COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID))*100 AS AVG_PER_DATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE) T"
718,Y,Y,"WITH TEMP AS (SELECT A.*,R.POST_ID AS REMOVE_ID FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE EXTRA='SPAM' AND R.POST_ID IS NOT NULL), TEMP1 AS (SELECT A.ACTION_DATE, COUNT(DISTINCT REMOVE_ID)/COUNT(DISTINCT A. POST_ID) AS REMOVE_PER FROM TEMP T RIGHT JOIN ACTIONS A ON T.ACTION_DATE = A.ACTION_DATE AND T.REMOVE_ID = A.POST_ID WHERE A.EXTRA='SPAM' GROUP BY A.ACTION_DATE) SELECT ROUND(AVG(REMOVE_PER)*100,2) AS AVERAGE_DAILY_PERCENT FROM TEMP1"
719,Y,Y,"WITH TABLE1 AS (SELECT A.ACTION_DATE, (COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)) AS REMOVAL_PERC FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE) SELECT ROUND(SUM(REMOVAL_PERC)*100/COUNT(*),2) AS AVERAGE_DAILY_PERCENT FROM TABLE1"
720,Y,Y,"SELECT ROUND(AVG(IFNULL(R.REMOVAL,0)/T.TOTAL*100),2) AS AVERAGE_DAILY_PERCENT FROM( SELECT COUNT(DISTINCT POST_ID) REMOVAL, ACTION_DATE FROM ACTIONS WHERE ACTION='REPORT' AND EXTRA='SPAM' AND POST_ID IN (SELECT POST_ID FROM REMOVALS) GROUP BY ACTION_DATE) R RIGHT JOIN (SELECT COUNT(DISTINCT POST_ID) TOTAL, ACTION_DATE FROM ACTIONS WHERE ACTION='REPORT' AND EXTRA='SPAM' GROUP BY ACTION_DATE) T ON T.ACTION_DATE=R.ACTION_DATE"
721,Y,Y,"WITH SPAM AS ( SELECT POST_ID, ACTION_DATE FROM ACTIONS WHERE EXTRA = 'SPAM' ), CNT AS ( SELECT S.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT S.POST_ID) AS CNT FROM SPAM AS S LEFT JOIN REMOVALS AS R ON S.POST_ID = R.POST_ID GROUP BY 1 ) SELECT ROUND(AVG(CNT)*100, 2) AS AVERAGE_DAILY_PERCENT FROM CNT"
722,Y,Y,"WITH SPAM_POSTS AS ( SELECT * FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' ), DAILY_PERCENT_REMOVED AS ( SELECT SUM(CASE WHEN R.POST_ID IS NOT NULL THEN 1 ELSE 0 END) / COUNT(DISTINCT SP.POST_ID) * 100 AS DAILY_PERCENT_POST_REMOVED FROM SPAM_POSTS AS SP LEFT JOIN REMOVALS R ON SP.POST_ID=R.POST_ID GROUP BY SP.ACTION_DATE ) SELECT ROUND(SUM(PERCENT)/COUNT(DISTINCT ACTION_DATE),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA='SPAM' GROUP BY 1) TEMP"
723,Y,Y,"SELECT ROUND(SUM(DAILY_PERC)* 100/COUNT(DISTINCT ACTION_DATE),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)/ COUNT(DISTINCT A.POST_ID) AS DAILY_PERC FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA ='SPAM' GROUP BY 1 )TEMP"
724,Y,Y,"SELECT ROUND( AVG(_RATE) ,2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 _RATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE ACTION ='REPORT' AND EXTRA = 'SPAM' GROUP BY ACTION_DATE ) T1"
725,Y,Y,"WITH CTE1 AS( SELECT A.ACTION_DATE, COUNT(DISTINCT(R.POST_ID))/COUNT(DISTINCT(A.POST_ID)) AS POST_CNT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY 1 ) SELECT ROUND((SUM(POST_CNT)/COUNT(*)) * 100, 2) AS AVERAGE_DAILY_PERCENT FROM CTE1"
726,Y,Y,"WITH CTE AS ( SELECT DISTINCT POST_ID, ACTION_DATE, CASE WHEN POST_ID IN (SELECT POST_ID FROM REMOVALS) THEN 1 ELSE 0 END AS REMOVAL_FLAG FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM') SELECT ROUND(AVG(PERCENT)*100, 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, SUM(REMOVAL_FLAG)/COUNT(POST_ID) AS PERCENT FROM CTE GROUP BY ACTION_DATE) AS CTE1"
727,Y,Y,"WITH TEMP AS( SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS TOTAL FROM ACTIONS WHERE EXTRA ='SPAM' GROUP BY ACTION_DATE ), TEMP1 AS ( SELECT ACTION_DATE, COUNT(DISTINCT A.POST_ID) AS CNT FROM ACTIONS A JOIN REMOVALS B ON A.POST_ID = B.POST_ID WHERE A.EXTRA ='SPAM' GROUP BY ACTION_DATE ) SELECT ROUND(100*AVG(C.RATE), 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT IFNULL(A.CNT/B.TOTAL,0) AS RATE FROM TEMP1 A RIGHT JOIN TEMP B ON A.ACTION_DATE = B.ACTION_DATE ) C"
728,Y,Y,"WITH CTE AS ( SELECT DISTINCT A.POST_ID, ACTION_DATE, REMOVE_DATE FROM ACTIONS A LEFT JOIN REMOVALS R ON R.POST_ID = A.POST_ID WHERE EXTRA = 'SPAM' ), CTE2 AS ( SELECT ACTION_DATE, COUNT(REMOVE_DATE)/COUNT(*)*100 AS DAILY_PER FROM CTE GROUP BY 1) SELECT ROUND(AVG(DAILY_PER), 2) AS AVERAGE_DAILY_PERCENT FROM CTE2"
729,Y,Y,"SELECT ROUND(AVG(RATIO), 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) * 100 AS RATIO FROM ACTIONS A LEFT OUTER JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ) GRP"
730,Y,Y,"WITH CTE AS (SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS DAILY_REMOVAL FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY ACTION_DATE) SELECT ROUND(AVG(DAILY_REMOVAL)*100,2) AS AVERAGE_DAILY_PERCENT FROM CTE"
731,Y,Y,"WITH REPORT AS (SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) AS TOTAL FROM ACTIONS WHERE EXTRA='SPAM' GROUP BY 1), REMOVED AS (SELECT A.ACTION_DATE AS ACTION_DATE, COUNT(DISTINCT B.POST_ID) AS REMOVES FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID WHERE A.EXTRA='SPAM' GROUP BY 1) SELECT ROUND(100*AVG(R2.REMOVES/R1.TOTAL),2) AS AVERAGE_DAILY_PERCENT FROM REPORT R1 LEFT JOIN REMOVED R2 ON R1.ACTION_DATE = R2.ACTION_DATE"
732,Y,Y,"WITH CTE AS ( SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID) * 100/ COUNT(DISTINCT A.POST_ID) AS CNT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' GROUP BY 1 ) SELECT ROUND(AVG(CNT),2) AS AVERAGE_DAILY_PERCENT FROM CTE"
733,Y,Y,"SELECT ROUND(AVG(IFNULL(B.RMCOUNT*100,0)/A.RPCOUNT),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) RPCOUNT FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY 1) A LEFT JOIN (SELECT ACTION_DATE, COUNT(DISTINCT POST_ID) RMCOUNT FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' AND POST_ID IN (SELECT POST_ID FROM REMOVALS) GROUP BY 1) B ON A.ACTION_DATE = B.ACTION_DATE"
734,Y,Y,"WITH CTE AS (SELECT A.POST_ID, A.ACTION_DATE, A.ACTION, COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) AS DAILY_RATE FROM ACTIONS AS A LEFT JOIN REMOVALS AS R ON A.POST_ID = R.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY 2) SELECT ROUND(AVG(DAILY_RATE)*100, 2) AS AVERAGE_DAILY_PERCENT FROM CTE"
735,Y,Y,"WITH T1 AS ( SELECT POST_ID, ACTION_DATE FROM ACTIONS WHERE EXTRA = 'SPAM' GROUP BY 1, 2) SELECT ROUND(AVG(PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT COUNT(DISTINCT R.POST_ID) / COUNT(T1.POST_ID) * 100 AS PERCENT FROM T1 LEFT JOIN REMOVALS AS R USING(POST_ID) GROUP BY T1.ACTION_DATE) T2"
736,Y,Y,"WITH A AS ( SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID) * 100 / COUNT(DISTINCT A.POST_ID) AS Y FROM ACTIONS A LEFT JOIN REMOVALS R ON R.POST_ID = A.POST_ID WHERE CASE WHEN A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' THEN 1 ELSE 0 END GROUP BY A.ACTION_DATE ) SELECT ROUND(AVG(Y),2) AVERAGE_DAILY_PERCENT FROM A"
737,Y,Y,"WITH PER AS (SELECT COUNT(DISTINCT REMOVALS.POST_ID)/COUNT(DISTINCT TEMP.POST_ID) AS PERCENT FROM (SELECT * FROM ACTIONS WHERE EXTRA = 'SPAM') TEMP LEFT JOIN REMOVALS ON TEMP.POST_ID = REMOVALS.POST_ID GROUP BY ACTION_DATE) SELECT ROUND(AVG(PERCENT)*100,2) AS AVERAGE_DAILY_PERCENT FROM PER"
738,Y,Y,"WITH POST_TABLE AS ( SELECT DISTINCT POST_ID, ACTION_DATE FROM ACTIONS WHERE ACTION='REPORT' AND EXTRA='SPAM' ) , DAILY_PERC AS ( SELECT A.ACTION_DATE, COUNT(DISTINCT CASE WHEN B.POST_ID IS NOT NULL THEN B.POST_ID ELSE NULL END)/COUNT(DISTINCT A.POST_ID) AS AVG_DAILY_PERCENT FROM POST_TABLE A LEFT JOIN REMOVALS B ON A.POST_ID=B.POST_ID GROUP BY A.ACTION_DATE ) SELECT ROUND(AVG(AVG_DAILY_PERCENT* 100),2) AS AVERAGE_DAILY_PERCENT FROM DAILY_PERC"
739,Y,Y,"WITH CTE AS (SELECT ACTION_DATE, COUNT(DISTINCT A.POST_ID) AS CNT, COUNT(DISTINCT R.POST_ID) RCNT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE ACTION='REPORT' AND EXTRA='SPAM' GROUP BY ACTION_DATE) SELECT ROUND(AVG(RCNT/CNT)*100,2) AS AVERAGE_DAILY_PERCENT FROM CTE"
740,Y,Y,"SELECT ROUND(AVG(PERCENT)*100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.POST_ID, ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R USING (POST_ID) WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE) TEMP"
741,Y,Y,"WITH TMP AS( SELECT A.POST_ID , A.ACTION_DATE , B.POST_ID AS REMOVE_ID , B.REMOVE_DATE FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID WHERE EXTRA = 'SPAM') , TMP1 AS( SELECT ACTION_DATE , COUNT(DISTINCT REMOVE_ID)/COUNT(DISTINCT POST_ID) AS DAILY_PERCENT FROM TMP GROUP BY ACTION_DATE) SELECT ROUND(AVG(DAILY_PERCENT)*100,2) AS AVERAGE_DAILY_PERCENT FROM TMP1"
742,Y,Y,"SELECT ROUND(AVG(100*PERC),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS PERC FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA = 'SPAM' GROUP BY 1) A"
743,Y,Y,"SELECT ROUND(AVG(AVGERAGE),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS AVGERAGE FROM ACTIONS A LEFT JOIN REMOVALS R USING (POST_ID) WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE ) T"
744,Y,Y,"SELECT ROUND(AVG(RATE)*100,2) AVERAGE_DAILY_PERCENT FROM (SELECT (COUNT(DISTINCT R.POST_ID)/ COUNT(DISTINCT A.POST_ID)) RATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE EXTRA='SPAM' GROUP BY ACTION_DATE) T"
745,Y,Y,"WITH T1 AS ( SELECT POST_ID, ACTION_DATE, ACTION, EXTRA FROM ACTIONS WHERE ACTION LIKE REPORT AND EXTRA LIKE SPAM ), T2 AS ( SELECT A.POST_ID, A.ACTION_DATE, B.REMOVE_DATE FROM T1 A LEFT JOIN REMOVALS B ON A.POST_ID=B.POST_ID), T3 AS ( SELECT COUNT(DISTINCT CASE WHEN REMOVE_DATE IS NOT NULL THEN POST_ID ELSE NULL END)/COUNT(DISTINCT POST_ID)*100 AS REMOVAL_RATE FROM T2 GROUP BY ACTION_DATE) SELECT ROUND(AVG(REMOVAL_RATE), 2) AS AVERAGE_DAILY_PERCENT FROM T3"
746,Y,Y,"SELECT ROUND(AVG(AVERAGE_DAILY_PERCENT)*100,2) AVERAGE_DAILY_PERCENT FROM ( SELECT COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AVERAGE_DAILY_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID =R.POST_ID WHERE ACTION= 'REPORT' AND EXTRA ='SPAM' GROUP BY ACTION_DATE) TMP"
747,Y,Y,"SELECT ROUND(100*AVG(PERCENTAGE),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS PERCENTAGE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID=R.POST_ID WHERE EXTRA='SPAM' GROUP BY ACTION_DATE)T"
748,Y,Y,"SELECT ROUND(100*AVG(DAY_FRACTION),2) AS AVERAGE_DAILY_PERCENT FROM (SELECT COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS DAY_FRACTION FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA='SPAM' GROUP BY A.ACTION_DATE) T1"
749,Y,Y,"SELECT ROUND(AVG(DAILY_REMOVE_RATE)*100, 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, SUM(IF(REMOVE_DATE IS NOT NULL, 1, 0))/COUNT(*) AS DAILY_REMOVE_RATE FROM (SELECT A.*, B.REMOVE_DATE FROM (SELECT DISTINCT POST_ID, ACTION_DATE, EXTRA FROM ACTIONS) AS A LEFT JOIN REMOVALS AS B ON A.POST_ID = B.POST_ID WHERE A.EXTRA = 'SPAM' ) AS T GROUP BY ACTION_DATE) AS T1"
750,Y,Y,"WITH DAILY_ACTIONS AS ( SELECT A.ACTION_DATE, COUNT(DISTINCT A.POST_ID) AS DAILY_ACTIONS, COUNT(DISTINCT B.POST_ID) AS DAILY_REMOVALS FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ) SELECT ROUND(AVG(DAILY_REMOVALS/DAILY_ACTIONS*100),2) AS AVERAGE_DAILY_PERCENT FROM DAILY_ACTIONS"
751,Y,Y,"SELECT ROUND(AVG(T1.RATIO) * 100, 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT SUM(IF(A.POST_ID = R.POST_ID, 1, 0)) / COUNT(DISTINCT A.POST_ID) AS RATIO FROM ( SELECT DISTINCT POST_ID, ACTION_DATE FROM ACTIONS WHERE EXTRA = 'SPAM' ) A LEFT JOIN ( SELECT DISTINCT POST_ID FROM REMOVALS ) R ON A.POST_ID = R.POST_ID GROUP BY ACTION_DATE ) T1"
752,Y,Y,"SELECT ROUND(AVG(REMOVED/REPORTED)*100,2) AVERAGE_DAILY_PERCENT FROM (SELECT COUNT(DISTINCT A.POST_ID) REPORTED , COUNT(DISTINCT R.POST_ID) REMOVED FROM ACTIONS A LEFT JOIN REMOVALS R ON R.POST_ID = A.POST_ID WHERE EXTRA = 'SPAM' GROUP BY A.ACTION_DATE) C"
753,Y,Y,"WITH T AS (SELECT POST_ID, ACTION_DATE, EXTRA FROM ACTIONS WHERE EXTRA = 'SPAM') SELECT ROUND(AVG(PER), 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT T.ACTION_DATE, COUNT(DISTINCT CASE WHEN REMOVE_DATE IS NOT NULL THEN T.POST_ID ELSE NULL END)/COUNT(DISTINCT T.POST_ID) * 100 AS PER FROM T LEFT JOIN REMOVALS R ON T.POST_ID = R.POST_ID GROUP BY 1) T2"
754,Y,Y,"SELECT ROUND(AVG(DAILY_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT (COUNT(DISTINCT(R. POST_ID))/COUNT(DISTINCT(A. POST_ID))) * 100 AS DAILY_PERCENT, ACTION_DATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A. POST_ID=R. POST_ID WHERE ACTION='REPORT' AND EXTRA='SPAM' GROUP BY ACTION_DATE ) AS SUB"
755,Y,Y,"SELECT ROUND(SUM(REP)/COUNT(*), 2) AS AVERAGE_DAILY_PERCENT FROM( SELECT COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID)*100 AS REP FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.EXTRA='SPAM' GROUP BY A.ACTION_DATE) AS R1"
756,Y,Y,"SELECT ROUND(100*AVG(DAILY_PERCENT), 2) AS AVERAGE_DAILY_PERCENT FROM (SELECT COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS DAILY_PERCENT FROM ACTIONS A LEFT JOIN REMOVALS R ON R.POST_ID = A.POST_ID WHERE A.EXTRA='SPAM' GROUP BY A.ACTION_DATE) TMP"
757,Y,Y,"SELECT ROUND(AVG(DAY_PERCENT)*100,2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE, COUNT(DISTINCT B.POST_ID)/ COUNT(DISTINCT A.POST_ID) AS DAY_PERCENT FROM ( SELECT * FROM ACTIONS WHERE EXTRA='SPAM') A LEFT JOIN REMOVALS B ON A.POST_ID=B.POST_ID GROUP BY ACTION_DATE) T"
758,Y,Y,"WITH CTE AS (SELECT ((COUNT(DISTINCT R.POST_ID))/COUNT(DISTINCT A.POST_ID))*100 AS PERECENT , A.ACTION_DATE FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE) SELECT ROUND(AVG(PERECENT), 2) AS AVERAGE_DAILY_PERCENT FROM CTE"
759,Y,Y,"SELECT ROUND(AVG(AVERAGE_DAILY_PERCENT),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT A.ACTION_DATE, COUNT( DISTINCT B.POST_ID)*100/COUNT( DISTINCT A.POST_ID) AS AVERAGE_DAILY_PERCENT FROM (SELECT POST_ID,ACTION_DATE FROM ACTIONS WHERE EXTRA = 'SPAM') A LEFT JOIN REMOVALS B ON A.POST_ID = B.POST_ID GROUP BY A.ACTION_DATE )X"
760,Y,Y,"SELECT ROUND(AVG(S)*100,2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE,COUNT(DISTINCT B.POST_ID)/COUNT(DISTINCT A.POST_ID) AS S FROM ACTIONS A LEFT JOIN REMOVALS B ON A.POST_ID=B.POST_ID WHERE EXTRA='SPAM' GROUP BY ACTION_DATE) M"
761,Y,Y,"SELECT ROUND(AVG(PERCENT) *100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT ACTION_DATE, COUNT(DISTINCT CASE WHEN EXTRA='SPAM'AND B.POST_ID IS NOT NULL THEN A.POST_ID ELSE NULL END)/ COUNT(DISTINCT CASE WHEN EXTRA='SPAM' THEN A.POST_ID ELSE NULL END) AS PERCENT FROM (SELECT * FROM ACTIONS WHERE ACTION='REPORT') A LEFT JOIN REMOVALS B ON A.POST_ID=B.POST_ID GROUP BY 1 ) C"
762,Y,Y,"WITH SPAM AS ( SELECT ACTION_DATE ,COUNT(DISTINCT POST_ID) AS SPAM_REPORTS FROM ACTIONS WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' GROUP BY 1 ) ,REMOVED AS ( SELECT A.ACTION_DATE, IFNULL(COUNT(DISTINCT R.POST_ID),0) AS REMOVED_POSTS FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ) SELECT ROUND(AVG(PERCENTAGE),2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT ACTION_DATE ,(REMOVED_POSTS/SPAM_REPORTS)*100 AS PERCENTAGE FROM SPAM JOIN REMOVED USING (ACTION_DATE) ) AS T"
763,Y,Y,"WITH TEMP1 AS ( SELECT POST_ID, ACTION_DATE, REMOVALS.POST_ID AS RM FROM ACTIONS LEFT JOIN REMOVALS USING(POST_ID) WHERE ACTION = 'REPORT' AND EXTRA = 'SPAM' ), TEMP2 AS ( SELECT ACTION_DATE, 100 * COUNT(DISTINCT RM)/COUNT(DISTINCT POST_ID) AS AVERAGE_DAILY_PERCENT FROM TEMP1 GROUP BY ACTION_DATE ) SELECT ROUND(AVG(AVERAGE_DAILY_PERCENT), 2) AS AVERAGE_DAILY_PERCENT FROM TEMP2"
764,Y,Y,"SELECT ROUND( SUM(DAILY_PERCENT)/COUNT(ACTION_DATE)*100 ,2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT (COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID)) DAILY_PERCENT, ACTION_DATE FROM ACTIONS A LEFT JOIN REMOVALS R USING (POST_ID) WHERE EXTRA = 'SPAM' GROUP BY ACTION_DATE ) T"
765,Y,Y,"SELECT ROUND(AVG(TOTAL_SPAM)*100,2) AS AVERAGE_DAILY_PERCENT FROM (SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS TOTAL_SPAM FROM ACTIONS A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE) A"
766,Y,Y,"WITH T1 AS ( SELECT ACTION_DATE, COUNT(DISTINCT CASE WHEN EXTRA = 'SPAM' THEN POST_ID END) AS SPAM_NUM FROM ACTIONS GROUP BY 1 ), T2 AS ( SELECT A.ACTION_DATE, IFNULL(COUNT(DISTINCT R.POST_ID),0) AS REMOVED_NUM FROM ACTIONS A LEFT JOIN REMOVALS R ON R.POST_ID = A.POST_ID WHERE A.EXTRA = 'SPAM' GROUP BY 1 ) SELECT ROUND(AVG(RATE),2) AS AVERAGE_DAILY_PERCENT FROM( SELECT T1.ACTION_DATE, (100.0*REMOVED_NUM/SPAM_NUM) AS RATE FROM T1 LEFT JOIN T2 ON T1.ACTION_DATE = T2.ACTION_DATE GROUP BY 1 )A"
767,Y,Y,"SELECT ROUND(AVG(RATIO)*100, 2) AS AVERAGE_DAILY_PERCENT FROM ( SELECT COUNT(DISTINCT R.POST_ID) / COUNT(DISTINCT A.POST_ID) AS RATIO FROM ACTIONS A LEFT OUTER JOIN REMOVALS R ON A.POST_ID = R.POST_ID WHERE A.ACTION = 'REPORT' AND A.EXTRA = 'SPAM' GROUP BY A.ACTION_DATE ) GRP"
768,Y,Y,"WITH T AS ( SELECT POST_ID,ACTION_DATE FROM ACTIONS WHERE ACTION='REPORT' AND EXTRA='SPAM' ), T1 AS ( SELECT ACTION_DATE,COUNT(DISTINCT R.POST_ID) AS NUM FROM T LEFT JOIN REMOVALS AS R USING (POST_ID) GROUP BY ACTION_DATE ), T2 AS ( SELECT ACTION_DATE,COUNT(DISTINCT POST_ID) AS NUM FROM T GROUP BY ACTION_DATE ), T3 AS ( SELECT T1.ACTION_DATE,T1.NUM/T2.NUM AS NUM FROM T1 LEFT JOIN T2 USING (ACTION_DATE) ) SELECT ROUND(AVG(NUM)*100,2) AS AVERAGE_DAILY_PERCENT FROM T3"
769,Y,Y,"SELECT ROUND(AVG(B.PER) * 100,2) AS AVERAGE_DAILY_PERCENT FROM( SELECT A.ACTION_DATE, COUNT(DISTINCT R.POST_ID)/COUNT(DISTINCT A.POST_ID) AS PER FROM (SELECT POST_ID, ACTION_DATE FROM ACTIONS WHERE EXTRA = 'SPAM') A LEFT JOIN REMOVALS R ON A.POST_ID = R.POST_ID AND R.REMOVE_DATE >= A.ACTION_DATE GROUP BY A.ACTION_DATE) B"
