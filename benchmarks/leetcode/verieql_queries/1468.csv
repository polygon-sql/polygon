qid,mysql_can_execute?,mysql_correct?,mysql_query
0,Y,Y,"SELECT A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME, ROUND(A.SALARY - (A.SALARY * CASE WHEN B.MAX_SALARY > 10000 THEN 0.49 WHEN B.MAX_SALARY > 1000 THEN 0.24 ELSE 0 END),0) AS SALARY FROM SALARIES AS A JOIN ( SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID ) AS B ON A.COMPANY_ID=B.COMPANY_ID"
1,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID)<1000 THEN ROUND(SALARY) WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN ROUND(0.76*SALARY) ELSE ROUND(0.51*SALARY) END AS SALARY FROM SALARIES"
2,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND((S.SALARY*(1-T.RATE)),0) SALARY FROM SALARIES S LEFT JOIN ( SELECT COMPANY_ID, (CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) >= 1000 AND MAX(SALARY) <= 10000 THEN 0.24 ELSE 0.49 END) RATE FROM SALARIES GROUP BY 1 ) T ON S.COMPANY_ID = T.COMPANY_ID"
3,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY*(1-TAX_PERCENT),0) AS SALARY FROM SALARIES S JOIN (SELECT COMPANY_ID, (CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY)>10000 THEN 0.49 ELSE 0.24 END) AS TAX_PERCENT FROM SALARIES GROUP BY COMPANY_ID) T ON S.COMPANY_ID=T.COMPANY_ID"
4,Y,Y,"SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX_SALARY < 1000 THEN SALARY WHEN MAX_SALARY > 10000 THEN ROUND(SALARY*(1-0.49)) ELSE ROUND(SALARY*(1-0.24)) END AS SALARY FROM SALARIES S LEFT JOIN ( SELECT COMPANY_ID , MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID ) AS T ON S.COMPANY_ID = T.COMPANY_ID"
5,Y,Y,"SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(S.SALARY*AFTER_TAX) AS SALARY FROM SALARIES AS S JOIN(SELECT COMPANY_ID, CASE WHEN MAX_S < 1000 THEN 1 WHEN MAX_S BETWEEN 1000 AND 10000 THEN 0.76 ELSE 0.51 END AS AFTER_TAX FROM (SELECT COMPANY_ID, MAX(SALARY) AS MAX_S FROM SALARIES GROUP BY COMPANY_ID) AS T ) AS TS ON S.COMPANY_ID = TS.COMPANY_ID"
6,Y,Y,"SELECT S1.COMPANY_ID, S1.EMPLOYEE_ID, S1.EMPLOYEE_NAME, CASE WHEN S2.MAX_SALARY < 1000 THEN ROUND(S1.SALARY) WHEN S2.MAX_SALARY > 10000 THEN ROUND(S1.SALARY * 0.51) ELSE ROUND(S1.SALARY * 0.76) END AS SALARY FROM SALARIES S1 LEFT JOIN (SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID) S2 ON S1.COMPANY_ID = S2.COMPANY_ID"
7,Y,Y,"SELECT S2.COMPANY_ID, S2.EMPLOYEE_ID, S2.EMPLOYEE_NAME, ROUND((CASE WHEN S1.MS < 1000 THEN S2.SALARY WHEN S1.MS >= 1000 AND S1.MS <= 10000 THEN S2.SALARY * (1 - 0.24) WHEN S1.MS > 10000 THEN S2.SALARY * (1 - 0.49) END), 0) AS SALARY FROM (SELECT COMPANY_ID, MAX(SALARY) AS MS FROM SALARIES GROUP BY COMPANY_ID) AS S1 INNER JOIN SALARIES S2 USING(COMPANY_ID)"
8,Y,Y,"SELECT SALARIES.COMPANY_ID, SALARIES.EMPLOYEE_ID, SALARIES.EMPLOYEE_NAME, ROUND((1 - TAX_RATE) * SALARY) AS SALARY FROM SALARIES INNER JOIN ( SELECT COMPANY_ID, ( CASE WHEN MAX(SALARY) < 1000 THEN .0 WHEN MAX(SALARY) >= 1000 AND MAX(SALARY) <= 10000 THEN .24 ELSE .49 END ) AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID ) AS TAX ON SALARIES.COMPANY_ID = TAX.COMPANY_ID"
9,Y,Y,"SELECT SALARIES.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND((CASE WHEN MAX_SALARY<1000 THEN SALARY WHEN MAX_SALARY>10000 THEN SALARY*(1-0.49) ELSE SALARY*(1-0.24) END)) AS SALARY FROM SALARIES JOIN (SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID) AS SUBQUERY ON SALARIES.COMPANY_ID=SUBQUERY.COMPANY_ID"
10,Y,Y,"SELECT SALARIES.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY * EFFECTIVE_SALARY_RATE, 0) AS SALARY FROM SALARIES LEFT JOIN ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 1.0 WHEN MAX(SALARY) < 10000 THEN 0.76 ELSE 0.51 END AS EFFECTIVE_SALARY_RATE FROM SALARIES GROUP BY COMPANY_ID) SALARY_RATES ON SALARIES.COMPANY_ID = SALARY_RATES.COMPANY_ID"
11,Y,Y,"SELECT SALARIES.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY*(1-TAX_RATE)) AS SALARY FROM SALARIES JOIN (SELECT COMPANY_ID, IF(MAX(SALARY)<1000, 0, IF(MAX(SALARY)>10000,0.49,0.24)) AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID ) TAXES USING(COMPANY_ID)"
12,Y,Y,"SELECT SALARIES.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(TAX_RATE*SALARIES.SALARY,0) AS SALARY FROM SALARIES JOIN (SELECT COMPANY_ID, (CASE WHEN MAX(SALARY)<1000 THEN 1 WHEN MAX(SALARY)>=1000 AND MAX(SALARY)<10000 THEN 0.76 ELSE 0.51 END) AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID) AS TEMP ON SALARIES.COMPANY_ID = TEMP.COMPANY_ID"
13,Y,Y,"SELECT A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME, CASE WHEN B.MAXSAL >= 1000 AND B.MAXSAL <= 10000 THEN ROUND(A.SALARY - A.SALARY*0.24) WHEN B.MAXSAL > 10000 THEN ROUND(A.SALARY - A.SALARY*0.49) ELSE ROUND(A.SALARY) END SALARY FROM SALARIES A INNER JOIN ( SELECT COMPANY_ID, MAX(SALARY) MAXSAL FROM SALARIES GROUP BY COMPANY_ID ) B ON A.COMPANY_ID = B.COMPANY_ID"
14,Y,Y,"SELECT A.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ( CASE WHEN MAXSALARY<1000 THEN SALARY WHEN MAXSALARY>=1000 AND MAXSALARY<=10000 THEN ROUND((SALARY - 0.24*SALARY),0) ELSE ROUND((SALARY - 0.49*SALARY),0) END ) AS SALARY FROM SALARIES A LEFT JOIN (SELECT COMPANY_ID, MAX(SALARY) AS MAXSALARY FROM SALARIES GROUP BY COMPANY_ID) B ON A.COMPANY_ID = B.COMPANY_ID"
15,Y,Y,"SELECT A.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN A.HIGHEST < 1000 THEN ROUND(S.SALARY) WHEN A.HIGHEST BETWEEN 1000 AND 10000 THEN ROUND(S.SALARY-(24/100)*S.SALARY) WHEN A.HIGHEST > 10000 THEN ROUND(S.SALARY- (49/100)*S.SALARY) END AS SALARY FROM SALARIES S JOIN (SELECT COMPANY_ID, MAX(SALARY) AS HIGHEST FROM SALARIES GROUP BY COMPANY_ID) A ON S.COMPANY_ID=A.COMPANY_ID"
16,Y,Y,"SELECT A.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX_SALARY < 1000 THEN A.SALARY WHEN MAX_SALARY >= 1000 AND MAX_SALARY <= 10000 THEN ROUND(A.SALARY * (1-0.24), 0) WHEN MAX_SALARY > 10000 THEN ROUND(A.SALARY * (1-0.49), 0) END AS SALARY FROM SALARIES A LEFT JOIN (SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID) B ON A.COMPANY_ID = B.COMPANY_ID"
17,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME ,ROUND(CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN SALARY-(SALARY*.24) ELSE SALARY-(SALARY*.49) END,0) SALARY FROM SALARIES"
18,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, (CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN ROUND(SALARY*(1-(24/100))) WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) > 10000 THEN ROUND(SALARY*(1-(49/100))) END) AS SALARY FROM SALARIES"
19,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, (CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) > 10000 THEN ROUND(SALARY * 0.51) WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN ROUND(SALARY * 0.76) END) AS SALARY FROM SALARIES"
20,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) > 10000 THEN ROUND(SALARY*(1-.49),0) ELSE ROUND(SALARY*(1-.24),0) END AS SALARY FROM SALARIES"
21,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) <1000 THEN SALARY WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) <=10000 AND MAX(SALARY) OVER (PARTITION BY COMPANY_ID) >=1000 THEN ROUND(SALARY * (1-0.24),0) WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) >10000 THEN ROUND(SALARY * (1-0.49),0) END AS SALARY FROM SALARIES"
22,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) > 10000 THEN ROUND((1-0.49)*SALARY,0) ELSE ROUND((1-0.24)*SALARY,0) END AS SALARY FROM SALARIES"
23,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN ROUND(SALARY - (0.24*SALARY),0) ELSE ROUND(SALARY - (0.49*SALARY),0) END AS SALARY FROM SALARIES"
24,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID)> 10000 THEN ROUND(0.51*SALARY) WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) < 1000 THEN SALARY ELSE ROUND(0.76*SALARY) END AS SALARY FROM SALARIES"
25,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) > 10000 THEN ROUND(0.51*SALARY,0) ELSE ROUND(0.76*SALARY,0) END AS SALARY FROM SALARIES"
26,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX_SALARY < 1000 THEN SALARY WHEN MAX_SALARY > 10000 THEN ROUND(SALARY*(1-0.49)) ELSE ROUND(SALARY*(1-0.24)) END AS SALARY FROM (SELECT S.*, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES S) SUB"
27,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAXSALARY>10000 THEN ROUND((SALARY/100) * 51,0) WHEN MAXSALARY BETWEEN 1000 AND 100000 THEN ROUND((SALARY/100) * 76,0) WHEN MAXSALARY < 1000 THEN SALARY END AS SALARY FROM (SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX(SALARY) OVER ( PARTITION BY COMPANY_ID) AS MAXSALARY FROM SALARIES GROUP BY COMPANY_ID,EMPLOYEE_ID) AS M"
28,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND( (CASE WHEN MAX_SALARY < 1000 THEN 1 WHEN MAX_SALARY<=10000 THEN 0.76 ELSE 0.51 END)*SALARY, 0) AS SALARY FROM ( SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME,SALARY, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES )T"
29,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND((CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID)>10000 THEN 0.51*SALARY WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID)>=1000 THEN 0.76*SALARY ELSE SALARY END),0) SALARY FROM SALARIES"
30,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND((CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN SALARY*(1-0.24) WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) > 10000 THEN SALARY*(1-0.49) END),0) SALARY FROM SALARIES"
31,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN (1-0.24)*SALARY ELSE (1-0.49)*SALARY END,0) AS SALARY FROM SALARIES"
32,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN SALARY * (1 - 0.24) ELSE SALARY * (1- 0.49) END) AS SALARY FROM SALARIES"
33,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN SALARY-(SALARY*0.24) ELSE SALARY - (SALARY*0.49) END,0) AS SALARY FROM SALARIES"
34,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) <1000 THEN SALARY WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN SALARY*(1-0.24) ELSE SALARY*(1-0.49) END,0) AS SALARY FROM SALARIES"
35,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID)<1000 THEN SALARY WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN SALARY-SALARY*(24/100) ELSE SALARY-SALARY*(49/100) END,0) AS SALARY FROM SALARIES ORDER BY EMPLOYEE_ID"
36,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MA < 1000 THEN SALARY WHEN MA > 10000 THEN SALARY*(1-.49) ELSE SALARY*(1-.24) END, 0) AS SALARY FROM (SELECT *, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MA FROM SALARIES) S"
37,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY * RATIO, 0) AS SALARY FROM (SELECT *, CASE WHEN MAX_SALARY < 1000 THEN 1 WHEN MAX_SALARY > 10000 THEN 0.51 ELSE 0.76 END AS RATIO FROM SALARIES AS S JOIN (SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID) AS SUB USING(COMPANY_ID)) AS SUB2"
38,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY*( CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID)<1000 THEN 100 WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID)<10000 THEN 76 ELSE 51 END )/100) AS SALARY FROM SALARIES"
39,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY*(1 - (CASE WHEN MAX_SALARY > 10000 THEN 0.49 WHEN MAX_SALARY < 1000 THEN 0 ELSE 0.24 END))) AS SALARY FROM ( SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES ) S"
40,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY*(1-TAX_RATE)) AS SALARY FROM ( SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) COMPANY_MAX, CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) < 1000 THEN 0 WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END AS TAX_RATE FROM SALARIES ) T"
41,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY*(CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) > 10000 THEN 0.51 WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN 0.76 WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) < 1000 THEN 1 END),0) AS SALARY FROM SALARIES"
42,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID)< 1000 THEN ROUND(SALARY,0) WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN ROUND(SALARY * .76,0) WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) > 10000 THEN ROUND(SALARY * .51,0) ELSE NULL END AS SALARY FROM SALARIES"
43,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX_COMPANY_SALARY <1000 THEN SALARY WHEN MAX_COMPANY_SALARY BETWEEN 1000 AND 10000 THEN ROUND(SALARY*0.76,0) WHEN MAX_COMPANY_SALARY >10000 THEN ROUND(SALARY*0.51,0) END AS SALARY FROM ( SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX(SALARY) OVER(PARTITION BY COMPANY_ID ORDER BY COMPANY_ID) AS MAX_COMPANY_SALARY FROM SALARIES ) A"
44,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY - (SALARY * TAX_RATE),0) AS SALARY FROM ( SELECT *, CASE WHEN MAX_SALARY < 1000 THEN 0 WHEN MAX_SALARY > 1000 AND MAX_SALARY <= 10000 THEN 0.24 ELSE 0.49 END AS TAX_RATE FROM ( SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES ) A )B"
45,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID,EMPLOYEE_NAME, ROUND(CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN SALARY-(SALARY*.24) ELSE SALARY-(SALARY*0.49) END,0) SALARY FROM SALARIES"
46,Y,Y,"SELECT COMPANY_ID,EMPLOYEE_ID, EMPLOYEE_NAME,(CASE WHEN MAX_SALARY<1000 THEN SALARY WHEN MAX_SALARY>=1000 AND MAX_SALARY<=10000 THEN ROUND(SALARY*(1-0.24),0) ELSE ROUND(SALARY*(1-0.49),0) END) AS SALARY FROM (SELECT *, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES) A"
47,Y,Y,"SELECT S.COMPANY_ID , S.EMPLOYEE_ID , EMPLOYEE_NAME , ROUND(SALARY * T.TAXES) AS SALARY FROM SALARIES S JOIN ( SELECT COMPANY_ID , CASE WHEN MAX(SALARY) < 1000 THEN 1 WHEN MAX(SALARY) <= 10000 THEN 0.76 ELSE 0.51 END AS TAXES FROM SALARIES GROUP BY COMPANY_ID) T ON T.COMPANY_ID = S.COMPANY_ID"
48,Y,Y,"SELECT S.COMPANY_ID AS COMPANY_ID, S.EMPLOYEE_ID AS EMPLOYEE_ID, S.EMPLOYEE_NAME AS EMPLOYEE_NAME, CASE WHEN S.MAX_SALARY < 1000 THEN S.SALARY WHEN 1000 <= S.MAX_SALARY AND S.MAX_SALARY <= 10000 THEN ROUND(S.SALARY * 0.76,0) WHEN S.MAX_SALARY > 10000 THEN ROUND(S.SALARY * 0.51,0) END AS SALARY FROM ( SELECT S1.COMPANY_ID, S1.EMPLOYEE_ID, S1.EMPLOYEE_NAME, S1.SALARY, S2.MAX_SALARY FROM SALARIES S1 JOIN ( SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID ) AS S2 ON S1.COMPANY_ID = S2.COMPANY_ID ) AS S"
49,Y,Y,"SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) >= 1000 AND MAX(SALARY) OVER(PARTITION BY COMPANY_ID) <= 10000 THEN ROUND(SALARY - (SALARY * .24)) WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) > 10000 THEN ROUND(SALARY - (SALARY *.49)) END AS SALARY FROM SALARIES S"
50,Y,Y,"SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX_SALARY < 1000 THEN SALARY WHEN MAX_SALARY BETWEEN 1000 AND 10000 THEN SALARY * (1 - 0.24) WHEN MAX_SALARY > 10000 THEN SALARY * (1 - 0.49) END) AS SALARY FROM (SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID) A JOIN SALARIES S ON A.COMPANY_ID = S.COMPANY_ID"
51,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND((S.SALARY * (CASE WHEN T.MAX_SALARY < 1000 THEN 1 WHEN T.MAX_SALARY >= 1000 AND T.MAX_SALARY <= 10000 THEN 0.76 ELSE 0.51 END)), 0) AS SALARY FROM SALARIES S JOIN ( SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID ) T ON S.COMPANY_ID = T.COMPANY_ID"
52,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(CASE WHEN MAX <1000 THEN SALARY WHEN MAX BETWEEN 1000 AND 10000 THEN 0.76*SALARY ELSE 0.51*SALARY END,0) SALARY FROM SALARIES S JOIN ( SELECT COMPANY_ID,MAX(SALARY) MAX FROM SALARIES GROUP BY COMPANY_ID ) T ON S.COMPANY_ID = T.COMPANY_ID"
53,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(CASE WHEN MAX <1000 THEN SALARY WHEN MAX>=1000 AND MAX<=10000 THEN 0.76*SALARY ELSE 0.51*SALARY END,0) SALARY FROM SALARIES S JOIN ( SELECT COMPANY_ID,MAX(SALARY) MAX FROM SALARIES GROUP BY COMPANY_ID ) T ON S.COMPANY_ID = T.COMPANY_ID"
54,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY * (1 - SUB.TAX_RATE), 0) AS SALARY FROM SALARIES S INNER JOIN (SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID) SUB ON S.COMPANY_ID = SUB.COMPANY_ID"
55,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY*T.TAX, 0) AS SALARY FROM SALARIES S JOIN ( SELECT COMPANY_ID, ( CASE WHEN MAX(SALARY) < 1000 THEN 1 WHEN MAX(SALARY) <= 10000 THEN 0.76 ELSE 0.51 END ) AS TAX FROM SALARIES GROUP BY COMPANY_ID ) T ON S.COMPANY_ID = T.COMPANY_ID"
56,Y,Y,"SELECT S1.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY*(1-TAX_PERCENT),0) AS SALARY FROM SALARIES S1 JOIN (SELECT COMPANY_ID, (CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY)>10000 THEN 0.49 ELSE 0.24 END) AS TAX_PERCENT FROM SALARIES GROUP BY COMPANY_ID) T1 ON S1.COMPANY_ID=T1.COMPANY_ID"
57,Y,Y,"SELECT S1.COMPANY_ID, S1.EMPLOYEE_ID, S1.EMPLOYEE_NAME, ROUND(S1.SALARY * CASE WHEN S2.MAX_SALARY < 1000 THEN 1 WHEN S2.MAX_SALARY >= 1000 AND S2.MAX_SALARY <= 10000 THEN 0.76 ELSE 0.51 END,0) AS SALARY FROM SALARIES S1 LEFT JOIN ( SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY 1) S2 ON S1.COMPANY_ID = S2.COMPANY_ID"
58,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY *(1-T.TAX_RATE),0) AS SALARY FROM SALARIES AS S LEFT JOIN (SELECT COMPANY_ID, EMPLOYEE_ID, CASE WHEN MAX(SALARY)<1000 THEN 0 WHEN MAX(SALARY)>=10000 THEN 0.49 ELSE 0.24 END AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID) AS T ON S.COMPANY_ID = T.COMPANY_ID"
59,Y,Y,"SELECT SALARIES.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY*(1- TAX_RATE)) AS SALARY FROM SALARIES JOIN (SELECT COMPANY_ID, IF(MAX(SALARY) < 1000, 0, IF(MAX(SALARY) > 10000, .49, .24)) AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID) TAXES ON SALARIES.COMPANY_ID=TAXES.COMPANY_ID"
60,Y,Y,"SELECT A.COMPANY_ID AS COMPANY_ID, A.EMPLOYEE_ID AS EMPLOYEE_ID, A.EMPLOYEE_NAME AS EMPLOYEE_NAME, ROUND((CASE WHEN MAX(B.SALARY) >= 10000 THEN A.SALARY*0.51 WHEN MAX(B.SALARY) >= 1000 THEN A.SALARY*0.76 ELSE A.SALARY END),0) AS SALARY FROM SALARIES A, SALARIES B WHERE A.COMPANY_ID = B.COMPANY_ID AND A.SALARY <= B.SALARY GROUP BY A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME"
61,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, (CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN ROUND(SALARY*0.76,0) WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) > 10000 THEN ROUND(SALARY*(1-0.49),0) END) SALARY FROM SALARIES"
62,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) < 1000 THEN SALARY*1 WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN SALARY*0.76 WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) > 10000 THEN SALARY*0.51 END, 0) AS SALARY FROM SALARIES"
63,Y,Y,"SELECT DISTINCT COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME, CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) <1000 THEN SALARY WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) > 10000 THEN ROUND((SALARY - SALARY*.49),0) ELSE ROUND((SALARY - SALARY*.24),0) END AS SALARY FROM SALARIES ORDER BY 1"
64,Y,Y,"SELECT S.COMPANY_ID,EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY*(1-TAX_RATE),0) AS SALARY FROM SALARIES S LEFT JOIN (SELECT COMPANY_ID, CASE WHEN MAX(SALARY) <1000 THEN 0.00 WHEN MAX(SALARY) >=1000 AND MAX(SALARY) <=10000 THEN 0.24 ELSE 0.49 END AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID) X ON S.COMPANY_ID = X.COMPANY_ID"
65,Y,Y,"WITH CALC AS ( SELECT COMPANY_ID , CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) > 999 AND MAX(SALARY) < 10001 THEN 24 WHEN MAX(SALARY) > 10000 THEN 49 END AS TAX_BRACKET FROM SALARIES GROUP BY COMPANY_ID ) SELECT A.COMPANY_ID , A.EMPLOYEE_ID , A.EMPLOYEE_NAME , ROUND((A.SALARY -((A.SALARY * B.TAX_BRACKET)/100 )),0) AS SALARY FROM SALARIES A INNER JOIN CALC B ON A.COMPANY_ID = B.COMPANY_ID"
66,Y,Y,"WITH CTE AS ( SELECT COMPANY_ID, CASE WHEN MAX_SAL < 1000 THEN 0 WHEN MAX_SAL >= 1000 AND MAX_SAL <= 10000 THEN 24 ELSE 49 END AS TAX_RATE FROM ( SELECT COMPANY_ID, MAX(SALARY) AS MAX_SAL FROM SALARIES GROUP BY COMPANY_ID ) XX ) SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY - SALARY * TAX_RATE / 100, 0) AS SALARY FROM SALARIES S LEFT JOIN CTE C ON C.COMPANY_ID = S.COMPANY_ID"
67,Y,Y,"WITH CTE AS ( SELECT COMPANY_ID, MAX(SALARY) AS MAX_SAL FROM SALARIES GROUP BY COMPANY_ID ) SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX_SAL < 1000 THEN SALARY WHEN MAX_SAL >= 1000 AND MAX_SAL <= 10000 THEN SALARY - SALARY * 0.24 ELSE SALARY - SALARY * 0.49 END) AS SALARY FROM SALARIES S LEFT JOIN CTE C ON C.COMPANY_ID = S.COMPANY_ID"
68,Y,Y,"WITH CTE AS (SELECT COMPANY_ID, (CASE WHEN MAX(SALARY) BETWEEN 1000 AND 10000 THEN 0.24 WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) > 10000 THEN 0.49 END) TAX FROM SALARIES GROUP BY COMPANY_ID) SELECT S1.COMPANY_ID, S1.EMPLOYEE_ID, S1.EMPLOYEE_NAME, ROUND(SALARY*(1-TAX),0) SALARY FROM SALARIES S1 LEFT JOIN CTE ON S1.COMPANY_ID = CTE.COMPANY_ID"
69,Y,Y,"WITH CTE AS(SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX(SALARY) AS MS FROM SALARIES GROUP BY COMPANY_ID) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(CASE WHEN MS < 1000 THEN S.SALARY WHEN MS BETWEEN 1000 AND 10000 THEN S.SALARY * (1-0.24) WHEN MS > 10000 THEN S.SALARY * (1-0.49) END) AS SALARY FROM SALARIES S JOIN CTE ON S.COMPANY_ID = CTE.COMPANY_ID"
70,Y,Y,"WITH CTE1 AS ( SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_S FROM SALARIES) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND((CASE WHEN MAX_S<1000 THEN 1 WHEN MAX_S>=1000 AND MAX_S<=10000 THEN 1-0.24 ELSE 1-0.49 END)*SALARY, 0) AS SALARY FROM CTE1"
71,Y,Y,"WITH CTE1 AS (SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID) SELECT A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME, CASE WHEN B.MAX_SALARY>10000 THEN ROUND(SALARY - SALARY*49/100,0) WHEN B.MAX_SALARY>=1000 THEN ROUND(SALARY - SALARY*24/100,0) ELSE SALARY END AS SALARY FROM SALARIES A LEFT JOIN CTE1 B ON A.COMPANY_ID=B.COMPANY_ID"
72,Y,Y,"WITH COMPANYMAXSALARIES AS ( SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID ), COMPANYTAX AS ( SELECT COMPANY_ID, (CASE WHEN MAX_SALARY > 10000 THEN 0.49 WHEN MAX_SALARY > 1000 THEN 0.24 ELSE 0 END) AS TAX_PERCENT FROM COMPANYMAXSALARIES ), EMPLOYEEPAYCHECKAFTERTAX AS ( SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY * (1-C.TAX_PERCENT),0) AS SALARY FROM SALARIES S INNER JOIN COMPANYTAX C ON S.COMPANY_ID = C.COMPANY_ID ) SELECT * FROM EMPLOYEEPAYCHECKAFTERTAX"
73,Y,Y,"WITH MAX_SAL AS( SELECT COMPANY_ID, MAX(SALARY) AS SAL FROM SALARIES GROUP BY COMPANY_ID ) SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND((CASE WHEN M.SAL < 1000 THEN S.SALARY WHEN M.SAL BETWEEN 1000 AND 10000 THEN (0.76)*S.SALARY ELSE (0.51)*S.SALARY END),0) AS SALARY FROM SALARIES S JOIN MAX_SAL M ON S.COMPANY_ID = M.COMPANY_ID GROUP BY S.COMPANY_ID, S.EMPLOYEE_ID"
74,Y,Y,"WITH MAX_SALARIES AS ( SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID ) SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX_SALARY < 1000 THEN SALARY WHEN MAX_SALARY > 10000 THEN 0.51*SALARY ELSE 0.76*SALARY END) AS SALARY FROM SALARIES AS S JOIN MAX_SALARIES AS M ON S.COMPANY_ID = M.COMPANY_ID"
75,Y,Y,"WITH MAX_SALARIES AS ( SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID ) SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX_SALARY < 1000 THEN SALARY WHEN MAX_SALARY > 10000 THEN SALARY*0.51 ELSE SALARY*0.76 END) AS SALARY FROM SALARIES AS S JOIN MAX_SALARIES AS M ON S.COMPANY_ID = M.COMPANY_ID"
76,Y,Y,"WITH T1 AS (SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END TAX_RATE FROM SALARIES GROUP BY 1) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY*(1-TAX_RATE)) SALARY FROM SALARIES JOIN T1 USING(COMPANY_ID)"
77,Y,Y,"WITH T1 AS( SELECT *,MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS HIGHEST_SALARY FROM SALARIES) SELECT COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME, ROUND(SALARY*TAX_RATE,0) AS SALARY FROM ( SELECT *, CASE WHEN HIGHEST_SALARY < 1000 THEN 1 WHEN HIGHEST_SALARY >=1000 AND HIGHEST_SALARY < 10000 THEN 0.76 WHEN HIGHEST_SALARY >=10000 THEN 0.51 END AS TAX_RATE FROM T1) AS SUB"
78,Y,Y,"WITH TAXRATE AS (SELECT COMPANY_ID ,CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) < 10000 THEN 0.24 ELSE 0.49 END AS RATE FROM SALARIES GROUP BY COMPANY_ID) SELECT S.COMPANY_ID ,S.EMPLOYEE_ID ,S.EMPLOYEE_NAME ,ROUND(S.SALARY * (1-TR.RATE)) AS SALARY FROM SALARIES S INNER JOIN TAXRATE TR ON TR.COMPANY_ID = S.COMPANY_ID"
79,Y,Y,"WITH TAXRATES AS ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0.0 WHEN MAX(SALARY) <= 10000 THEN 0.24 ELSE 0.49 END AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID ) SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY * (1 - TAX_RATE)) AS SALARY FROM SALARIES AS S LEFT JOIN TAXRATES AS T ON S.COMPANY_ID = T.COMPANY_ID"
80,Y,Y,"WITH C AS (SELECT COMPANY_ID,CASE WHEN MAX(SALARY)<1000 THEN 1 WHEN MAX(SALARY) BETWEEN 1000 AND 10000 THEN 1-0.24 ELSE 1-0.49 END AS MUL FROM SALARIES GROUP BY COMPANY_ID) SELECT S.COMPANY_ID,S.EMPLOYEE_ID,S.EMPLOYEE_NAME, ROUND(SALARY*MUL,0) AS SALARY FROM SALARIES S LEFT JOIN C USING (COMPANY_ID)"
81,Y,Y,"WITH COMPANY AS ( SELECT *, MAX(SALARY) AS CMAX_SALARY FROM SALARIES GROUP BY COMPANY_ID ), BRACKET AS ( SELECT *, CASE WHEN CMAX_SALARY < 1000 THEN 0 WHEN CMAX_SALARY <= 10000 THEN .24 ELSE .49 END AS TAX_BRACKET FROM COMPANY ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY - TAX_BRACKET * S.SALARY, 0) AS SALARY FROM SALARIES S LEFT JOIN BRACKET B ON S.COMPANY_ID = B.COMPANY_ID"
82,Y,Y,"WITH COMPANY AS( SELECT COMPANY_ID, CASE WHEN MAX(SALARY)<1000 THEN 0 WHEN MAX(SALARY)>=1000 AND MAX(SALARY)<=10000 THEN 0.24 WHEN MAX(SALARY)>10000 THEN 0.49 END AS TAX FROM SALARIES GROUP BY COMPANY_ID) SELECT SALARIES.COMPANY_ID,SALARIES.EMPLOYEE_ID,SALARIES.EMPLOYEE_NAME, ROUND(SALARIES.SALARY*(1-COMPANY.TAX),0) AS SALARY FROM SALARIES LEFT JOIN COMPANY ON SALARIES.COMPANY_ID = COMPANY.COMPANY_ID"
83,Y,Y,"WITH CTE AS ( SELECT COMPANY_ID, MAX(SALARY) AS TOP_SALARY FROM SALARIES GROUP BY 1 ) SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN TOP_SALARY < 1000 THEN SALARY WHEN TOP_SALARY >= 1000 AND TOP_SALARY <= 10000 THEN ROUND(SALARY - (SALARY * .24)) WHEN TOP_SALARY > 10000 THEN ROUND(SALARY - (SALARY *.49)) END AS SALARY FROM SALARIES S LEFT JOIN CTE USING (COMPANY_ID)"
84,Y,Y,"WITH CTE AS (SELECT * FROM SALARIES A JOIN (SELECT COMPANY_ID, MAX(SALARY) AS COM_SAL FROM SALARIES GROUP BY COMPANY_ID) A USING (COMPANY_ID)) SELECT COMPANY_ID, EMPLOYEE_ID,EMPLOYEE_NAME, CASE WHEN COM_SAL < 1000 THEN SALARY WHEN COM_SAL BETWEEN 1000 AND 10000 THEN ROUND(SALARY*(1-0.24),0) ELSE ROUND(SALARY*(1-0.49),0) END AS SALARY FROM CTE"
85,Y,Y,"WITH CTE AS (SELECT COMPANY_ID, CASE WHEN MAX_SALARY < 1000 THEN 0 WHEN MAX_SALARY >= 1000 AND MAX_SALARY <= 10000 THEN 0.24 WHEN MAX_SALARY > 10000 THEN 0.49 ELSE NULL END AS TAX_RATE FROM (SELECT DISTINCT COMPANY_ID, MAX(SALARY) OVER(PARTITION BY COMPANY_ID ORDER BY SALARY DESC) AS MAX_SALARY FROM SALARIES ) X ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY - ( S.SALARY * TAX_RATE ),0) AS SALARY FROM SALARIES S LEFT JOIN CTE C ON C.COMPANY_ID = S.COMPANY_ID"
86,Y,Y,"WITH CTE AS (SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, (ROUND(CASE WHEN CTE.MAX_SALARY < 1000 THEN S.SALARY WHEN CTE.MAX_SALARY <= 10000 THEN S.SALARY * 0.76 ELSE S.SALARY * 0.51 END, 0)) AS SALARY FROM SALARIES AS S JOIN CTE ON S.COMPANY_ID = CTE.COMPANY_ID"
87,Y,Y,"WITH CTE AS( SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX(SALARY)OVER(PARTITION BY COMPANY_ID) AS MAXS FROM SALARIES ) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY*(1-RATE)) AS SALARY FROM( SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, CASE WHEN MAXS < 1000 THEN 0 WHEN MAXS > 10000 THEN 0.49 ELSE 0.24 END AS RATE FROM CTE)A"
88,Y,Y,"WITH CTE AS( SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_SALARY_COMPANY FROM SALARIES ) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX_SALARY_COMPANY <1000 THEN ROUND(SALARY,0) WHEN MAX_SALARY_COMPANY>=1000 AND MAX_SALARY_COMPANY<10000 THEN ROUND(SALARY * (0.76),0) WHEN MAX_SALARY_COMPANY>=10000 THEN ROUND(SALARY * (.51),0) ELSE SALARY END AS SALARY FROM CTE"
89,Y,Y,"WITH CTE1 AS (SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_EMP_COMP FROM SALARIES) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX_EMP_COMP < 1000 THEN SALARY WHEN MAX_EMP_COMP BETWEEN 1000 AND 10000 THEN SALARY - 0.24*(SALARY) WHEN MAX_EMP_COMP > 10000 THEN SALARY - 0.49*SALARY END, 0) AS SALARY FROM CTE1"
90,Y,Y,"WITH MAIN AS ( SELECT *, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES ) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND((CASE WHEN MAX_SALARY < 1000 THEN SALARY WHEN MAX_SALARY > 10000 THEN 0.51*SALARY ELSE 0.76*SALARY END),0) AS SALARY FROM MAIN"
91,Y,Y,"WITH MAX_SAL AS ( SELECT COMPANY_ID, MAX(SALARY) MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID), TAX_RATE AS ( SELECT COMPANY_ID, CASE WHEN MAX_SALARY > 10000 THEN 0.49 WHEN MAX_SALARY BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0 END AS TAX_RATE FROM MAX_SAL ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND((S.SALARY - (S.SALARY * TAX_RATE.TAX_RATE)), 0) AS SALARY FROM SALARIES S JOIN TAX_RATE ON S.COMPANY_ID = TAX_RATE.COMPANY_ID"
92,Y,Y,"WITH MAX_SALARIES AS (SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX_SALARY < 1000 THEN ROUND(SALARY * (1 -0), 0) WHEN MAX_SALARY BETWEEN 1000 AND 10000 THEN ROUND(SALARY * (1-0.24), 0) ELSE ROUND(SALARY * (1 - 0.49), 0) END AS SALARY FROM MAX_SALARIES"
93,Y,Y,"WITH MAX_SALARY_CALC AS ( SELECT COMPANY_ID, MAX(SALARY) MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, CASE WHEN M.MAX_SALARY<1000 THEN SALARY WHEN M.MAX_SALARY>=1000 AND M.MAX_SALARY<=10000 THEN ROUND((SALARY-((SALARY*24)/100)),0) ELSE ROUND((SALARY-((SALARY*49)/100)),0) END SALARY FROM SALARIES S INNER JOIN MAX_SALARY_CALC M ON S.COMPANY_ID=M.COMPANY_ID"
94,Y,Y,"WITH MAXES AS ( SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID) SELECT SALARIES.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX_SALARY > 10000 THEN CAST(SALARY - (SALARY * .49) AS UNSIGNED) WHEN MAX_SALARY >= 1000 AND MAX_SALARY <= 10000 THEN CAST(SALARY - (SALARY * .24) AS UNSIGNED) ELSE SALARY END AS SALARY FROM SALARIES INNER JOIN MAXES ON SALARIES.COMPANY_ID = MAXES.COMPANY_ID"
95,Y,Y,"WITH MAXTAB AS ( SELECT COMPANY_ID, MAX(SALARY) MAX_SAL FROM SALARIES GROUP BY COMPANY_ID ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(CASE WHEN MAX_SAL < 1000 THEN SALARY WHEN MAX_SAL BETWEEN 1000 AND 10000 THEN 0.76 * SALARY ELSE 0.51 * SALARY END,0) SALARY FROM MAXTAB M JOIN SALARIES S ON M.COMPANY_ID = S.COMPANY_ID"
96,Y,Y,"WITH SALARY_CTE AS ( SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, MAX(SALARY) OVER( PARTITION BY COMPANY_ID ORDER BY SALARY DESC) AS MAX_SALARY FROM SALARIES ) SELECT DISTINCT * FROM ( SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, (CASE WHEN A.MAX_SALARY < 1000 THEN S.SALARY WHEN A.MAX_SALARY BETWEEN 1000 AND 10000 THEN ROUND((S.SALARY - (S.SALARY * 0.24)), 0) WHEN A.MAX_SALARY > 10000 THEN ROUND((S.SALARY - (S.SALARY * 0.49)), 0) END) AS SALARY FROM SALARIES S INNER JOIN SALARY_CTE A ON S.COMPANY_ID = A.COMPANY_ID ) SUB"
97,Y,Y,"WITH SALARY_CTE AS ( SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, MAX(SALARY) OVER( PARTITION BY COMPANY_ID ORDER BY SALARY DESC) AS MAX_SALARY FROM SALARIES ) SELECT DISTINCT * FROM ( SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, (CASE WHEN A.MAX_SALARY < 1000 THEN S.SALARY WHEN A.MAX_SALARY BETWEEN 1000 AND 10000 THEN ROUND((S.SALARY - (S.SALARY * 0.24)), 0) WHEN A.MAX_SALARY > 10000 THEN ROUND((S.SALARY - (S.SALARY * 0.49)), 0) END) AS SALARY FROM SALARIES S JOIN SALARY_CTE A ON S.COMPANY_ID = A.COMPANY_ID ) SUB"
98,Y,Y,"WITH SUB AS ( SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID ) SELECT SALARIES.COMPANY_ID, SALARIES.EMPLOYEE_ID, SALARIES.EMPLOYEE_NAME, (CASE WHEN SUB.MAX_SALARY < 1000 THEN ROUND(SALARIES.SALARY) WHEN SUB.MAX_SALARY BETWEEN 1000 AND 10000 THEN ROUND(SALARIES.SALARY - SALARIES.SALARY*0.24) ELSE ROUND(SALARIES.SALARY - SALARIES.SALARY*0.49) END) AS SALARY FROM SALARIES JOIN SUB ON SALARIES.COMPANY_ID = SUB.COMPANY_ID"
99,Y,Y,"WITH T AS (SELECT COMPANY_ID, (CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) > 10000 THEN 0.49 ELSE 0.24 END) AS TAX FROM SALARIES GROUP BY COMPANY_ID) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND((S.SALARY - S.SALARY*T.TAX), 0) AS SALARY FROM SALARIES S LEFT JOIN T ON S.COMPANY_ID = T.COMPANY_ID"
100,Y,Y,"WITH T AS (SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) > 10000 THEN 0.49 ELSE 0.24 END AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY - (S.SALARY * T.TAX_RATE), 0) AS SALARY FROM SALARIES S JOIN T ON S.COMPANY_ID = T.COMPANY_ID"
101,Y,Y,"WITH T AS (SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) > 10000 THEN 0.49 ELSE 0.24 END AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY - S.SALARY * T.TAX_RATE, 0) AS SALARY FROM SALARIES S JOIN T ON S.COMPANY_ID = T.COMPANY_ID"
102,Y,Y,"WITH T AS( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) <1000 THEN 0 WHEN MAX(SALARY) >10000 THEN 0.49 ELSE 0.24 END AS TRATE FROM SALARIES GROUP BY 1) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY - S.SALARY*T.TRATE,0) AS SALARY FROM T JOIN SALARIES S ON T.COMPANY_ID = S.COMPANY_ID"
103,Y,Y,"WITH TAB AS ( SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY 1) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, CASE WHEN T.MAX_SALARY < 1000 THEN ROUND(S.SALARY, 0) WHEN T.MAX_SALARY >=1000 AND T.MAX_SALARY <=10000 THEN ROUND(S.SALARY * (1-0.24),0) ELSE ROUND(S.SALARY * (1-0.49), 0) END AS SALARY FROM SALARIES AS S JOIN TAB AS T ON T.COMPANY_ID = S.COMPANY_ID"
104,Y,Y,"WITH TABLE1 AS ( SELECT *, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES ) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX_SALARY <1000 THEN SALARY WHEN MAX_SALARY BETWEEN 1000 AND 10000 THEN ROUND(SALARY *(1-0.24),0) WHEN MAX_SALARY >10000 THEN ROUND(SALARY*(1-0.49),0) END AS SALARY FROM TABLE1"
105,Y,Y,"WITH TAX AS ( SELECT COMPANY_ID, (CASE WHEN MAX(SALARY)<1000 THEN 0 WHEN MAX(SALARY)>=1000 AND MAX(SALARY)<=10000 THEN 0.24 ELSE 0.49 END) AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID ) SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(S.SALARY*(1-T.TAX_RATE)) AS SALARY FROM SALARIES S LEFT JOIN TAX T ON S.COMPANY_ID=T.COMPANY_ID"
106,Y,Y,"WITH TAX AS( SELECT COMPANY_ID, (CASE WHEN MAX(SALARY) < 1000 THEN 1 WHEN MAX(SALARY) BETWEEN 1000 AND 10000 THEN 0.76 WHEN MAX(SALARY) > 10000 THEN 0.51 END ) AS TAX_FACTOR FROM SALARIES GROUP BY 1 ) SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND((TAX_FACTOR * SALARY), 0) AS SALARY FROM SALARIES S LEFT JOIN TAX T ON S.COMPANY_ID = T.COMPANY_ID"
107,Y,Y,"WITH TAX_MULTIPLIER AS ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 1.0 WHEN MAX(SALARY) <= 10000 THEN 0.76 ELSE 0.51 END AS MULT FROM SALARIES GROUP BY COMPANY_ID ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY * T.MULT) AS SALARY FROM SALARIES S JOIN TAX_MULTIPLIER T ON S.COMPANY_ID = T.COMPANY_ID"
108,Y,Y,"WITH TAX_R AS ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN ((MAX(SALARY) > 1000) AND (MAX(SALARY) < 10000)) THEN 0.24 ELSE 0.49 END AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY - (S.SALARY * TR.TAX_RATE)) AS SALARY FROM SALARIES S LEFT JOIN TAX_R TR ON S.COMPANY_ID = TR.COMPANY_ID"
109,Y,Y,"WITH TAX_RATE AS ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 1 WHEN MAX(SALARY) <= 10000 THEN 0.76 ELSE 0.51 END AS RATE FROM SALARIES GROUP BY COMPANY_ID ) SELECT SALARIES.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY * RATE) AS SALARY FROM SALARIES JOIN TAX_RATE USING(COMPANY_ID)"
110,Y,Y,"WITH TAX_RATE_PER_COMPANY AS( SELECT TEMP.COMPANY_ID AS COMPANY_ID, CASE WHEN TEMP.MAX_SALARY >= 1000 AND TEMP.MAX_SALARY <= 10000 THEN 24 WHEN TEMP.MAX_SALARY > 10000 THEN 49 ELSE 0 END AS TAX_RATE FROM( SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY 1 )TEMP ) SELECT TEMP.COMPANY_ID AS COMPANY_ID, TEMP.EMPLOYEE_ID AS EMPLOYEE_ID, TEMP.EMPLOYEE_NAME AS EMPLOYEE_NAME, ROUND(TEMP.SALARY * (100 - TEMP.TAX_RATE) / 100) AS SALARY FROM( SELECT S.COMPANY_ID AS COMPANY_ID, S.EMPLOYEE_ID AS EMPLOYEE_ID, S.EMPLOYEE_NAME AS EMPLOYEE_NAME, S.SALARY AS SALARY, T.TAX_RATE AS TAX_RATE FROM SALARIES S JOIN TAX_RATE_PER_COMPANY T ON S.COMPANY_ID = T.COMPANY_ID )TEMP"
111,Y,Y,"WITH TAX_RATES AS ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0.0 WHEN MAX(SALARY) < 10000 THEN 0.24 ELSE 0.49 END AS TAX_RATE FROM SALARIES GROUP BY 1 ) SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY * (1-TAX_RATE)) AS SALARY FROM SALARIES S LEFT JOIN TAX_RATES T ON S.COMPANY_ID = T.COMPANY_ID"
112,Y,Y,"WITH TEMP AS ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 1 WHEN MAX(SALARY) BETWEEN 1000 AND 10000 THEN 0.76 ELSE 0.51 END AS RATE FROM SALARIES GROUP BY COMPANY_ID ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY * T.RATE, 0) AS SALARY FROM SALARIES S JOIN TEMP T ON S.COMPANY_ID = T.COMPANY_ID"
113,Y,Y,"WITH TMP AS ( SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX_SAL FROM SALARIES ) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX_SAL < 1000 THEN ROUND(SALARY) WHEN MAX_SAL BETWEEN 1000 AND 10000 THEN ROUND(SALARY * (1-0.24)) ELSE ROUND(SALARY * (1-0.49)) END AS SALARY FROM TMP"
114,Y,Y,"WITH CTE AS ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) BETWEEN 1000 AND 10000 THEN 0.24 WHEN MAX(SALARY) > 10000 THEN 0.49 END AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID) SELECT A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME, ROUND(A.SALARY - (B.TAX_RATE*A.SALARY),0) AS SALARY FROM SALARIES A JOIN CTE B ON A.COMPANY_ID = B.COMPANY_ID"
115,Y,Y,"WITH CTE AS (SELECT COMPANY_ID, (CASE WHEN MAX(SALARY) > 10000 THEN 0.49 WHEN MAX(SALARY) < 1000 THEN 0 WHEN 1000 < MAX(SALARY) AND MAX(SALARY)<10000 THEN 0.24 ELSE NULL END ) AS TAX FROM SALARIES GROUP BY COMPANY_ID) SELECT S1.COMPANY_ID, S1.EMPLOYEE_ID, S1.EMPLOYEE_NAME, ROUND(S1.SALARY*(1-TAX), 0)AS SALARY FROM SALARIES S1 JOIN CTE ON S1.COMPANY_ID = CTE.COMPANY_ID ORDER BY COMPANY_ID ASC, EMPLOYEE_ID ASC"
116,Y,Y,"WITH A2 AS (SELECT COMPANY_ID,MAX(SALARY) AS A FROM SALARIES GROUP BY COMPANY_ID) SELECT S.COMPANY_ID , EMPLOYEE_ID , EMPLOYEE_NAME, CASE WHEN A< 1000 THEN SALARY WHEN A BETWEEN 1000 AND 10000 THEN ROUND(0.76*SALARY,0) ELSE ROUND(0.51*SALARY,0) END AS SALARY FROM SALARIES S JOIN A2 ON A2.COMPANY_ID=S.COMPANY_ID"
117,Y,Y,"WITH CTE AS (SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) BETWEEN 1000 AND 10000 THEN 24 ELSE 49 END AS TAX_PERC FROM SALARIES GROUP BY COMPANY_ID) SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND((S.SALARY - (C.TAX_PERC/100)*(S.SALARY)),0) AS SALARY FROM SALARIES S INNER JOIN CTE C ON S.COMPANY_ID = C.COMPANY_ID"
118,Y,Y,"SELECT A.COMPANY_ID, B.EMPLOYEE_ID, B.EMPLOYEE_NAME, CASE WHEN A.MAX_SALARY<1000 THEN ROUND(B.SALARY) WHEN A.MAX_SALARY>=1000 AND A.MAX_SALARY<=10000 THEN ROUND(B.SALARY-B.SALARY*0.24) ELSE ROUND(B.SALARY - B.SALARY*0.49) END AS SALARY FROM (SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID) A INNER JOIN SALARIES B ON A.COMPANY_ID = B.COMPANY_ID"
119,Y,Y,"SELECT B.COMPANY_ID,EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY- (SALARY*(TAX/100))) AS SALARY FROM ( SELECT COMPANY_ID, CASE WHEN MAX_SAL <1000 THEN 0 WHEN MAX_SAL>=1000 AND 10000>=MAX_SAL THEN 24 ELSE 49 END AS TAX FROM ( SELECT COMPANY_ID, MAX(SALARY) AS MAX_SAL FROM SALARIES GROUP BY COMPANY_ID) A ) B JOIN SALARIES S ON B.COMPANY_ID=S.COMPANY_ID"
120,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID,S.EMPLOYEE_NAME, CASE WHEN MAX(S.SALARY) OVER(PARTITION BY S.COMPANY_ID)< 1000 THEN S.SALARY WHEN MAX(S.SALARY) OVER(PARTITION BY S.COMPANY_ID) BETWEEN 1000 AND 10000 THEN ROUND(S.SALARY- 0.24*S.SALARY) WHEN MAX(S.SALARY) OVER(PARTITION BY S.COMPANY_ID) >10000 THEN ROUND(S.SALARY- 0.49*S.SALARY) END AS SALARY FROM SALARIES S"
121,Y,Y,"SELECT S1.COMPANY_ID, S1.EMPLOYEE_ID, S1.EMPLOYEE_NAME, ROUND((S1.SALARY - S1.SALARY * RATE),0) AS SALARY FROM SALARIES S1 JOIN (SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) <= 10000 AND MAX(SALARY) >= 1000 THEN 0.24 ELSE 0.49 END AS RATE FROM SALARIES GROUP BY COMPANY_ID) S2 ON S1.COMPANY_ID = S2.COMPANY_ID ORDER BY 1, 2"
122,Y,Y,"SELECT SALARIES.COMPANY_ID, SALARIES.EMPLOYEE_ID, SALARIES.EMPLOYEE_NAME, ROUND(CASE WHEN SALARY_MAX<1000 THEN SALARIES.SALARY WHEN SALARY_MAX>=1000 AND SALARY_MAX<=10000 THEN SALARIES.SALARY * 0.76 ELSE SALARIES.SALARY * 0.51 END, 0) AS SALARY FROM SALARIES INNER JOIN ( SELECT COMPANY_ID, MAX(SALARY) AS SALARY_MAX FROM SALARIES GROUP BY COMPANY_ID) AS T ON SALARIES.COMPANY_ID = T.COMPANY_ID"
123,Y,Y,"SELECT SALARIES.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX_SALARY BETWEEN 1000 AND 10000 THEN SALARY*0.76 WHEN MAX_SALARY > 1000 THEN SALARY*0.51 ELSE SALARY END,0) AS SALARY FROM SALARIES JOIN (SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID) TMP ON SALARIES.COMPANY_ID = TMP.COMPANY_ID"
124,Y,Y,"SELECT SALARIES.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY * (1-TAX_RATE)) AS SALARY FROM SALARIES JOIN (SELECT COMPANY_ID, IF(MAX(SALARY) < 1000, 0, IF(MAX(SALARY) >10000, 0.49, 0.24)) AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID) TAXES ON SALARIES.COMPANY_ID = TAXES.COMPANY_ID"
125,Y,Y,"SELECT A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME , ROUND(CASE WHEN MAXSALARY >10000 THEN SALARY*0.51 WHEN MAXSALARY >= 1000 AND MAXSALARY<=10000 THEN SALARY*0.76 ELSE SALARY END, 0) AS SALARY FROM SALARIES A JOIN ( SELECT COMPANY_ID, MAX(SALARY) AS MAXSALARY FROM SALARIES GROUP BY COMPANY_ID ) B ON A.COMPANY_ID = B.COMPANY_ID"
126,Y,Y,"SELECT A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME , ROUND(CASE WHEN MAXSALARY >10000 THEN SALARY*0.51 WHEN MAXSALARY >= 1000 AND MAXSALARY<=10000 THEN SALARY*0.76 ELSE SALARY END, 0) AS SALARY FROM SALARIES A JOIN ( SELECT COMPANY_ID, MAX(SALARY) AS MAXSALARY FROM SALARIES GROUP BY COMPANY_ID ) B USING (COMPANY_ID)"
127,Y,Y,"SELECT A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME, CASE WHEN A.MAX_SAL<1000 THEN A.SALARY WHEN A.MAX_SAL>=1000 AND A.MAX_SAL<10000 THEN ROUND(A.SALARY-SALARY*24/100) ELSE ROUND(A.SALARY-SALARY*49/100) END AS SALARY FROM (SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_SAL FROM SALARIES)A"
128,Y,Y,"SELECT A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME, ROUND( (CASE WHEN A.MAXX < 1000 THEN A.SALARY WHEN A.MAXX <= 10000 AND A.MAXX >= 1000 THEN A.SALARY - A.SALARY * (24/100) ELSE A.SALARY - A.SALARY * (49/100) END) ,0) AS SALARY FROM (SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX(SALARY) OVER(PARTITION BY COMPANY_ID )AS MAXX FROM SALARIES) A"
129,Y,Y,"SELECT A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME, ROUND((A.SALARY) - (A.SALARY*B.TAX_BRACKET)/100) AS SALARY FROM SALARIES A INNER JOIN (SELECT COMPANY_ID, MAX(SALARY), CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) > 10000 THEN 49 ELSE 24 END AS TAX_BRACKET FROM SALARIES GROUP BY COMPANY_ID) B ON A.COMPANY_ID = B.COMPANY_ID"
130,Y,Y,"SELECT A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME, ROUND((CASE WHEN X.MAX_SALARY BETWEEN 1000 AND 10000 THEN SALARY*0.76 WHEN X.MAX_SALARY > 10000 THEN SALARY*0.51 ELSE A.SALARY END)) AS SALARY FROM SALARIES AS A JOIN (SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID) AS X ON A.COMPANY_ID=X.COMPANY_ID"
131,Y,Y,"SELECT A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME, ROUND(CASE WHEN B.SALARY < 1000 THEN A.SALARY WHEN B.SALARY <= 10000 THEN A.SALARY*0.76 ELSE A.SALARY*0.51 END, 0) AS SALARY FROM SALARIES A INNER JOIN (SELECT COMPANY_ID, MAX(SALARY) SALARY FROM SALARIES GROUP BY 1) B ON A.COMPANY_ID = B.COMPANY_ID"
132,Y,Y,"SELECT A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME, ROUND(CASE WHEN X.MAX_SAL BETWEEN 1000 AND 10000 THEN 0.76*A.SALARY WHEN X.MAX_SAL > 10000 THEN 0.51*A.SALARY ELSE A.SALARY END) AS SALARY FROM SALARIES AS A JOIN (SELECT COMPANY_ID, MAX(SALARY) AS MAX_SAL FROM SALARIES GROUP BY COMPANY_ID) AS X ON A.COMPANY_ID=X.COMPANY_ID"
133,Y,Y,"SELECT A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME, ROUND(CASE WHEN X.MAX_SAL BETWEEN 1000 AND 10000 THEN A.SALARY*0.76 WHEN X.MAX_SAL > 10000 THEN 0.51*A.SALARY ELSE A.SALARY END) AS SALARY FROM SALARIES AS A JOIN (SELECT COMPANY_ID, MAX(SALARY) AS MAX_SAL FROM SALARIES GROUP BY COMPANY_ID) AS X USING(COMPANY_ID)"
134,Y,Y,"SELECT A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME, ROUND(CASE WHEN X.MAX_SAL BETWEEN 1000 AND 10000 THEN A.SALARY*0.76 WHEN X.MAX_SAL > 10000 THEN A.SALARY*0.51 ELSE A.SALARY END) AS SALARY FROM SALARIES AS A JOIN (SELECT COMPANY_ID, MAX(SALARY) AS MAX_SAL FROM SALARIES GROUP BY COMPANY_ID) AS X ON A.COMPANY_ID=X.COMPANY_ID"
135,Y,Y,"SELECT A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME, ROUND(CASE WHEN X.MAX_SAL BETWEEN 1000 AND 10000 THEN A.SALARY*0.76 WHEN X.MAX_SAL > 10000 THEN A.SALARY*0.51 ELSE A.SALARY END) AS SALARY FROM SALARIES AS A JOIN (SELECT COMPANY_ID, MAX(SALARY) AS MAX_SAL FROM SALARIES GROUP BY COMPANY_ID) AS X USING(COMPANY_ID)"
136,Y,Y,"SELECT A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME, ROUND(CASE WHEN X.MAX_SAL BETWEEN 1000 AND 10000 THEN SALARY*0.76 WHEN X.MAX_SAL > 10000 THEN SALARY*0.51 ELSE SALARY END) AS SALARY FROM SALARIES AS A JOIN (SELECT COMPANY_ID, MAX(SALARY) AS MAX_SAL FROM SALARIES GROUP BY COMPANY_ID) AS X ON A.COMPANY_ID=X.COMPANY_ID"
137,Y,Y,"SELECT A.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, IF(MAX_SALARY > 10000, ROUND(SALARY * 0.51), IF(MAX_SALARY > 1000, ROUND(SALARY * 0.76), SALARY)) AS SALARY FROM SALARIES AS A JOIN (SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID) AS B ON A.COMPANY_ID = B.COMPANY_ID"
138,Y,Y,"SELECT A.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(A.SALARY * (1 - B.TAX_RATE), 0) AS SALARY FROM SALARIES A JOIN (SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) >= 1000 AND MAX(SALARY) <= 10000 THEN 0.24 WHEN MAX(SALARY) > 10000 THEN 0.49 END AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID) B ON A.COMPANY_ID = B.COMPANY_ID"
139,Y,Y,"SELECT A.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN NUM < 1000 THEN SALARY WHEN NUM >= 1000 AND NUM <= 10000 THEN SALARY * (1-0.24) WHEN NUM > 10000 THEN SALARY * (1-0.49) END,0) AS SALARY FROM SALARIES A JOIN (SELECT COMPANY_ID, MAX(SALARY) AS NUM FROM SALARIES GROUP BY COMPANY_ID) B ON A.COMPANY_ID = B.COMPANY_ID"
140,Y,Y,"SELECT A.COMPANY_ID,A.EMPLOYEE_ID, A.EMPLOYEE_NAME, CASE WHEN B.SL < 1000 THEN SALARY WHEN B.SL BETWEEN 1000 AND 10000 THEN ROUND(0.76*SALARY) WHEN B.SL > 10000 THEN ROUND(0.51*SALARY) END AS SALARY FROM SALARIES AS A LEFT JOIN (SELECT COMPANY_ID, MAX(SALARY) AS SL FROM SALARIES GROUP BY COMPANY_ID) AS B ON A.COMPANY_ID=B.COMPANY_ID"
141,Y,Y,"SELECT A.COMPANY_ID,A.EMPLOYEE_ID,A.EMPLOYEE_NAME, ROUND((CASE WHEN A.MAX<1000 THEN A.SALARY WHEN A.MAX BETWEEN 1000 AND 10000 THEN 0.76*A.SALARY WHEN A.MAX>10000 THEN 0.51*A.SALARY END ),0) AS SALARY FROM (SELECT S.COMPANY_ID,S.EMPLOYEE_ID,S.EMPLOYEE_NAME,S.SALARY, MAX(S.SALARY) OVER(PARTITION BY S.COMPANY_ID ) AS MAX FROM SALARIES AS S)A"
142,Y,Y,"SELECT A.COMPANY_ID,A.EMPLOYEE_ID,A.EMPLOYEE_NAME,ROUND(SALARY-SALARY*RATING/100,0) AS SALARY FROM (SELECT COMPANY_ID, EMPLOYEE_ID , EMPLOYEE_NAME, SALARY, CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID)>10000 THEN 49 WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID)>=1000 AND MAX(SALARY) OVER(PARTITION BY COMPANY_ID)<=10000 THEN 24 ELSE 0 END AS RATING FROM SALARIES )A"
143,Y,Y,"SELECT C.COMPANY_ID, C.EMPLOYEE_ID, C.EMPLOYEE_NAME, CASE WHEN MAX_SALARY < 1000 THEN C.SALARY WHEN MAX_SALARY <10001 THEN ROUND(C.SALARY*0.76,0) ELSE ROUND(C.SALARY*0.51,0) END AS SALARY FROM (SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES) C"
144,Y,Y,"SELECT COMPANY_ID , EMPLOYEE_ID , EMPLOYEE_NAME, CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID)<1000 THEN ROUND(SALARY) WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID)BETWEEN 1000 AND 10000 THEN ROUND(SALARY-SALARY*0.24) WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) > 10000 THEN ROUND(SALARY-SALARY*0.49) END AS SALARY FROM SALARIES"
145,Y,Y,"SELECT COMPANY_ID ,EMPLOYEE_ID,EMPLOYEE_NAME, CASE WHEN MAX_SAL<1000 THEN SALARY WHEN MAX_SAL BETWEEN 1000 AND 10000 THEN ROUND(0.76*SALARY) ELSE ROUND(0.51*SALARY) END AS SALARY FROM (SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_SAL FROM SALARIES) AS S"
146,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ( CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN ROUND(SALARY*.76) WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) > 10000 THEN ROUND(SALARY*.51) END ) AS SALARY FROM SALARIES"
147,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, (CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) <= 10000 THEN ROUND(SALARY - SALARY * 0.24,0) ELSE ROUND(SALARY - SALARY * 0.49,0) END) AS SALARY FROM SALARIES"
148,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, (CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN ROUND(SALARY - SALARY * 0.24,0) ELSE ROUND(SALARY - SALARY * 0.49,0) END) AS SALARY FROM SALARIES"
149,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, (CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) <1000 THEN ROUND(SALARY,0) WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) >=1000 AND MAX(SALARY) OVER (PARTITION BY COMPANY_ID)<=10000 THEN ROUND((1-24/100)*SALARY,0) ELSE ROUND(((1-49/100)*SALARY),0) END) AS SALARY FROM SALARIES"
150,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, (CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN ROUND(SALARY*(1-24/100)) WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) > 10000 THEN ROUND(SALARY*(1-(49/100))) END) AS SALARY FROM SALARIES"
151,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, (CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) > 10000 THEN ROUND(SALARY - 0.49*SALARY,0) ELSE ROUND(SALARY - 0.24*SALARY,0) END) AS SALARY FROM SALARIES"
152,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, (CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) > 10000 THEN ROUND(SALARY*(1-0.49),0) ELSE ROUND(SALARY*(1-0.24),0) END) AS SALARY FROM SALARIES"
153,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, (CASE WHEN MAX_SALARY < 1000 THEN ROUND(SALARY) WHEN MAX_SALARY BETWEEN 1000 AND 10000 THEN ROUND(SALARY*(1-0.24)) ELSE ROUND(SALARY*(1-0.49)) END) AS SALARY FROM (SELECT *, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES) T"
154,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, (CASE WHEN MXSA < 1000 THEN ROUND(SALARY,0) WHEN MXSA >= 1000 AND MXSA <= 10000 THEN ROUND((SALARY * 76)/100,0) WHEN MXSA > 10000 THEN ROUND((SALARY * 51)/100,0) END ) AS SALARY FROM ( SELECT *, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MXSA FROM SALARIES ) DUDU"
155,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX_SALARY < 1000 THEN SALARY WHEN MAX_SALARY >= 1000 AND MAX_SALARY <= 10000 THEN SALARY *0.76 WHEN MAX_SALARY > 10000 THEN SALARY * 0.51 END) AS SALARY FROM( SELECT *, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES) T"
156,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) < 1000 THEN 1*SALARY WHEN 10000< MAX(SALARY) OVER (PARTITION BY COMPANY_ID) THEN ROUND(0.51*SALARY,0) ELSE ROUND(0.76*SALARY,0) END AS SALARY FROM SALARIES"
157,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) < 1000 THEN ROUND(SALARY,0) WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN ROUND((SALARY-SALARY*0.24),0) ELSE ROUND((SALARY-SALARY*0.49),0) END AS SALARY FROM SALARIES"
158,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN ROUND(SALARY*0.76,0) WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) > 10000 THEN ROUND(SALARY*0.51,0) END AS SALARY FROM SALARIES"
159,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) <1000 THEN SALARY WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN ROUND(SALARY* (1-0.24),0) ELSE ROUND(SALARY*(1-0.49),0) END AS SALARY FROM SALARIES"
160,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) <1000 THEN SALARY WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID)>=1000 AND MAX(SALARY) OVER (PARTITION BY COMPANY_ID)<=10000 THEN ROUND(SALARY* (1-0.24),0) ELSE ROUND(SALARY*(1-0.49),0) END AS SALARY FROM SALARIES"
161,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) <1000 THEN SALARY WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID)>=1000 AND MAX(SALARY) OVER (PARTITION BY COMPANY_ID)<=10000 THEN ROUND(SALARY* (1-0.24),0) ELSE ROUND(SALARY*(1-0.49),0) END AS SALARY FROM SALARIES GROUP BY 1,2,3"
162,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) <= 10000 THEN ROUND(SALARY * (1 - 0.24), 0) ELSE ROUND(SALARY * (1 - 0.49), 0) END AS SALARY FROM SALARIES"
163,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) > 10000 THEN ROUND((.51*SALARY),0) WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) > 1000 THEN ROUND((.76*SALARY),0) ELSE ROUND(SALARY,0) END AS SALARY FROM SALARIES"
164,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID)<1000 THEN SALARY WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN ROUND(SALARY*0.76,0) ELSE ROUND(SALARY*0.51,0) END SALARY FROM SALARIES"
165,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX_SALARY < 1000 THEN SALARY WHEN MAX_SALARY >=1000 AND MAX_SALARY <=10000 THEN ROUND(SALARY-SALARY*0.24,0) WHEN MAX_SALARY > 10000 THEN ROUND(SALARY-0.49*SALARY,0) END AS SALARY FROM (SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME,SALARY, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES) TBL"
166,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX_SALARY < 1000 THEN SALARY WHEN MAX_SALARY BETWEEN 1000 AND 10000 THEN ROUND((1-0.24) * SALARY) WHEN MAX_SALARY > 10000 THEN ROUND((1-0.49) * SALARY) ELSE NULL END AS SALARY FROM( SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES) AS TMP"
167,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX_SALARY < 1000 THEN SALARY WHEN MAX_SALARY BETWEEN 1000 AND 10000 THEN ROUND(SALARY*(1-0.24),0) WHEN MAX_SALARY > 10000 THEN ROUND(SALARY*(1-0.49),0) END AS SALARY FROM ( SELECT *, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES ) S"
168,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX_SALARY <1000 THEN SALARY WHEN MAX_SALARY >=1000 AND MAX_SALARY <=10000 THEN ROUND(SALARY * (1-0.24)) ELSE ROUND(SALARY*(1-0.49)) END AS SALARY FROM ( SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES) TBL"
169,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX_SALARY <1000 THEN SALARY WHEN MAX_SALARY BETWEEN 1000 AND 10000 THEN ROUND(SALARY*0.76,0) WHEN MAX_SALARY >10000 THEN ROUND(SALARY*0.51,0) END AS SALARY FROM (SELECT * , MAX(SALARY)OVER(PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES) A"
170,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN S1.MAXSALARY<1000 THEN ROUND(S1.SALARY) WHEN S1.MAXSALARY BETWEEN 1000 AND 10000 THEN ROUND(S1.SALARY-0.24*S1.SALARY) WHEN S1.MAXSALARY>10000 THEN ROUND(S1.SALARY-0.49*S1.SALARY) END AS SALARY FROM (SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAXSALARY FROM SALARIES) AS S1"
171,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND( CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) >= 10000 THEN SALARY * 0.51 WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) >= 1000 THEN SALARY * 0.76 ELSE SALARY END , 0) AS SALARY FROM SALARIES"
172,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(( CASE WHEN TAX < 1000 THEN SALARY WHEN TAX > 10000 THEN .51 * SALARY ELSE .76 * SALARY END )) AS SALARY FROM ( SELECT *, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS TAX FROM SALARIES ) AS TMP"
173,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND((CASE WHEN MAXI<1000 THEN SALARY WHEN MAXI BETWEEN 1000 AND 10000 THEN SALARY*0.76 WHEN MAXI>10000 THEN SALARY*0.51 END),0) SALARY FROM (SELECT S.*, B.MAXI FROM SALARIES S JOIN (SELECT COMPANY_ID, MAX(SALARY) MAXI FROM SALARIES GROUP BY COMPANY_ID) B ON S.COMPANY_ID=B.COMPANY_ID) C GROUP BY COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME"
174,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID)<1000 THEN SALARY WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID)>10000 THEN SALARY*(1-0.49) ELSE SALARY*(1-0.24) END,0) SALARY FROM SALARIES"
175,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) > 10000 THEN SALARY-.49*SALARY WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN SALARY-.24*SALARY WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) <1000 THEN SALARY END,0) AS SALARY FROM SALARIES GROUP BY 1,2,3"
176,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX_SALARY < 1000 THEN SALARY WHEN MAX_SALARY <10000 THEN SALARY *0.76 ELSE SALARY*0.51 END) AS SALARY FROM (SELECT *, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES ) S"
177,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX_SALARY < 1000 THEN SALARY WHEN MAX_SALARY BETWEEN 1000 AND 10000 THEN SALARY*(1-0.24) WHEN MAX_SALARY > 10000 THEN SALARY*(0.51) END) AS SALARY FROM (SELECT *, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES)T"
178,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAXSALARY < 1000 THEN SALARY WHEN MAXSALARY BETWEEN 1000 AND 10000 THEN SALARY*.76 WHEN MAXSALARY > 10000 THEN SALARY*.51 END, 0) AS SALARY FROM (SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAXSALARY FROM SALARIES) T1"
179,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID,EMPLOYEE_NAME, ROUND(SALARY * (1-TAX_RATE), 0 ) AS SALARY FROM SALARIES AS T1 JOIN (SELECT COMPANY_ID, CASE WHEN MAX(SALARY) <1000 THEN 0 WHEN MAX(SALARY) > 10000 THEN 0.49 ELSE 0.24 END AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID) AS T2 USING (COMPANY_ID)"
180,Y,Y,"SELECT COMPANY_ID,EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX(SALARY)OVER(PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY)OVER(PARTITION BY COMPANY_ID) > 10000 THEN ROUND(SALARY - (SALARY*0.49)) ELSE ROUND(SALARY - (SALARY*0.24)) END AS SALARY FROM SALARIES"
181,Y,Y,"SELECT COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME, CASE WHEN M<1000 THEN SALARY WHEN M BETWEEN 1000 AND 10000 THEN ROUND(SALARY-(SALARY*0.24),0) WHEN M>10000 THEN ROUND(SALARY-(SALARY*0.49),0) END AS SALARY FROM (SELECT *,MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS M FROM SALARIES) AS T1"
182,Y,Y,"SELECT COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME,ROUND(CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) <1000 THEN (SALARY) WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID)>= 1000 AND MAX(SALARY) OVER(PARTITION BY COMPANY_ID)<=10000 THEN SALARY-((SALARY*24)/100) WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) > 10000 THEN SALARY-((SALARY*49)/100) END,0) AS SALARY FROM SALARIES GROUP BY 1,2"
183,Y,Y,"SELECT COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME,ROUND(SALARY - SALARY*TAX_RATE,0) AS SALARY FROM ( SELECT *, CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID)<1000 THEN 0 WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END AS TAX_RATE FROM SALARIES ) A"
184,Y,Y,"SELECT E.COMPANY_ID, E.EMPLOYEE_ID, E.EMPLOYEE_NAME, ROUND(E.SALARY - C.TAX_RATE * E.SALARY) AS SALARY FROM SALARIES E JOIN ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) >= 1000 AND MAX(SALARY) <= 10000 THEN 0.24 WHEN MAX(SALARY) > 10000 THEN 0.49 ELSE 0 END AS TAX_RATE FROM SALARIES GROUP BY 1 ) C USING(COMPANY_ID)"
185,Y,Y,"SELECT S.COMPANY_ID , S.EMPLOYEE_ID , S.EMPLOYEE_NAME , ROUND(CASE WHEN M_SAL < 1000 THEN S.SALARY WHEN M_SAL BETWEEN 1000 AND 10000 THEN S.SALARY - ((24 / 100) * S.SALARY ) WHEN M_SAL >= 10000 THEN S.SALARY - ((49 / 100) * S.SALARY ) END) SALARY FROM SALARIES S INNER JOIN (SELECT COMPANY_ID, MAX(SALARY) AS M_SAL FROM SALARIES GROUP BY COMPANY_ID) A ON A.COMPANY_ID= S.COMPANY_ID"
186,Y,Y,"SELECT S.COMPANY_ID , S.EMPLOYEE_ID , S.EMPLOYEE_NAME , ROUND(S.SALARY*T1.NET_TAX,0) AS SALARY FROM SALARIES S INNER JOIN (SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 1 WHEN MAX(SALARY) >=1000 AND MAX(SALARY) <=10000 THEN 0.76 WHEN MAX(SALARY) > 10000 THEN 0.51 END AS NET_TAX FROM SALARIES GROUP BY 1) T1 ON S.COMPANY_ID=T1.COMPANY_ID"
187,Y,Y,"SELECT S.COMPANY_ID AS COMPANY_ID , EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY*RATE) AS SALARY FROM SALARIES S JOIN (SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 1 WHEN MAX(SALARY) > 10000 THEN 1-0.49 ELSE 1-0.24 END AS RATE FROM SALARIES GROUP BY 1) A ON S.COMPANY_ID = A.COMPANY_ID"
188,Y,Y,"SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX_SALARY < 1000 THEN SALARY WHEN MAX_SALARY >= 1000 AND MAX_SALARY <= 10000 THEN SALARY * (1-0.24) WHEN MAX_SALARY > 10000 THEN SALARY * (1-0.49) ELSE NULL END) AS SALARY FROM SALARIES S LEFT JOIN ( SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY 1 ) T ON (S.COMPANY_ID = T.COMPANY_ID)"
189,Y,Y,"SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAXS <1000 THEN SALARY WHEN MAXS >= 1000 AND MAXS <= 10000 THEN SALARY *(1-0.24) ELSE SALARY * (1-0.49) END) AS SALARY FROM SALARIES S JOIN (SELECT COMPANY_ID, MAX(SALARY) AS MAXS FROM SALARIES GROUP BY 1) B ON S.COMPANY_ID = B.COMPANY_ID"
190,Y,Y,"SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN TAX_LEVEL = 'I' THEN SALARY WHEN TAX_LEVEL = 'II' THEN SALARY - 0.24 * (SALARY) ELSE SALARY -(SALARY) * 0.49 END,0) AS SALARY FROM SALARIES S JOIN ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN I WHEN MAX(SALARY) <= 10000 THEN II ELSE III END TAX_LEVEL FROM SALARIES GROUP BY COMPANY_ID ) C ON S.COMPANY_ID = C.COMPANY_ID"
191,Y,Y,"SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY * (1 - TAX_RATE)) AS SALARY FROM SALARIES S JOIN ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END AS TAX_RATE FROM SALARIES GROUP BY 1 ) C ON C.COMPANY_ID = S.COMPANY_ID"
192,Y,Y,"SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY - SALARY * (CASE WHEN MAX BETWEEN 1000 AND 10000 THEN 0.24 WHEN MAX > 10000 THEN 0.49 ELSE 0 END)) AS SALARY FROM SALARIES S LEFT JOIN (SELECT COMPANY_ID, MAX(SALARY) AS MAX FROM SALARIES GROUP BY COMPANY_ID) AS MAX ON S.COMPANY_ID = MAX.COMPANY_ID"
193,Y,Y,"SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY*(1-TAX_RATE)) AS SALARY FROM SALARIES S LEFT JOIN (SELECT COMPANY_ID, CASE WHEN MAX(SALARY)>10000 THEN 0.49 WHEN MAX(SALARY) BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0 END AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID) T ON S.COMPANY_ID=T.COMPANY_ID"
194,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, CASE WHEN MAX_SALARY < 1000 THEN SALARY WHEN MAX_SALARY > 10000 THEN ROUND(SALARY*(1-0.49),0) ELSE ROUND(SALARY*(1-0.24),0) END AS SALARY FROM SALARIES S LEFT JOIN (SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY 1) T ON S.COMPANY_ID = T.COMPANY_ID"
195,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, CASE WHEN T.MSALARY<1000 THEN S.SALARY WHEN T.MSALARY >= 1000 AND T.MSALARY <= 10000 THEN ROUND(S.SALARY *(1-.24),0) WHEN T.MSALARY > 10000 THEN ROUND(S.SALARY *(1-.49),0) END AS SALARY FROM SALARIES AS S LEFT JOIN (SELECT COMPANY_ID, MAX(SALARY) AS MSALARY FROM SALARIES GROUP BY COMPANY_ID) AS T ON S.COMPANY_ID = T.COMPANY_ID"
196,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND( CASE WHEN X.MAX_SAL BETWEEN 1000 AND 10000 THEN SALARY * 0.76 WHEN X.MAX_SAL > 10000 THEN SALARY * 0.51 ELSE SALARY END, 0) AS SALARY FROM SALARIES S LEFT JOIN (SELECT COMPANY_ID, MAX(SALARY) MAX_SAL FROM SALARIES GROUP BY COMPANY_ID) X ON S.COMPANY_ID = X.COMPANY_ID"
197,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(CASE WHEN MSAL<1000 THEN SALARY WHEN MSAL BETWEEN 1000 AND 10001 THEN SALARY*(1-0.24) WHEN MSAL>10000 THEN SALARY*(1-0.49) END,0) AS SALARY FROM SALARIES S JOIN (SELECT COMPANY_ID, MAX(SALARY) AS MSAL FROM SALARIES GROUP BY COMPANY_ID) A ON S.COMPANY_ID = A.COMPANY_ID"
198,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(CASE WHEN T.MSALARY < 1000 THEN S.SALARY WHEN T.MSALARY >= 1000 AND T.MSALARY <= 10000 THEN S.SALARY*0.76 ELSE S.SALARY*0.51 END, 0) AS SALARY FROM SALARIES S, ( SELECT COMPANY_ID, MAX(SALARY) MSALARY FROM SALARIES GROUP BY COMPANY_ID ) T WHERE S.COMPANY_ID = T.COMPANY_ID"
199,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY * (1-TMP.TAX_RT),0) AS SALARY FROM SALARIES S JOIN ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) >=1000 AND MAX(SALARY) <= 10000 THEN 0.24 ELSE 0.49 END AS TAX_RT FROM SALARIES GROUP BY COMPANY_ID ) TMP ON S.COMPANY_ID = TMP.COMPANY_ID"
200,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY*(1-T.TAX_RATE), 0) SALARY FROM SALARIES S JOIN (SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) <= 10000 THEN 0.24 ELSE 0.49 END TAX_RATE FROM SALARIES GROUP BY COMPANY_ID) T USING(COMPANY_ID)"
201,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY*(1-TEMP.TAX_RATE),0) AS SALARY FROM SALARIES S LEFT JOIN (SELECT DISTINCT COMPANY_ID, MAX(SALARY), CASE WHEN MAX(SALARY)<1000 THEN 0 WHEN MAX(SALARY)>=1000 AND MAX(SALARY)<10000 THEN 0.24 ELSE 0.49 END AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID) AS TEMP ON TEMP.COMPANY_ID = S.COMPANY_ID"
202,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY-S.SALARY* ( CASE WHEN MX<1000 THEN 0 WHEN MX>1000 AND MX<10000 THEN 0.24 WHEN MX>10000 THEN 0.49 END) ,0) AS SALARY FROM SALARIES S LEFT JOIN (SELECT COMPANY_ID, MAX(SALARY) AS MX FROM SALARIES GROUP BY 1)T ON S.COMPANY_ID=T.COMPANY_ID"
203,Y,Y,"SELECT S.COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME, ROUND(S.SALARY*(1-FACTOR),0) AS SALARY FROM SALARIES S INNER JOIN (SELECT COMPANY_ID, (CASE WHEN MAX(SALARY) <1000 THEN 0 WHEN MAX(SALARY) >10000 THEN 0.49 ELSE 0.24 END) AS FACTOR FROM SALARIES GROUP BY COMPANY_ID) AS TEMP ON S.COMPANY_ID=TEMP.COMPANY_ID"
204,Y,Y,"SELECT S.COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME,ROUND(SALARY*MULTIPLY,0) AS SALARY FROM SALARIES S JOIN (SELECT COMPANY_ID, (CASE WHEN M<1000 THEN 1 WHEN M BETWEEN 1000 AND 10000 THEN 0.76 ELSE 0.51 END) AS MULTIPLY FROM (SELECT COMPANY_ID,MAX(SALARY) AS M FROM SALARIES GROUP BY COMPANY_ID) A) B ON B.COMPANY_ID=S.COMPANY_ID"
205,Y,Y,"SELECT S.COMPANY_ID,S.EMPLOYEE_ID,S.EMPLOYEE_NAME, CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) <1000 THEN ROUND(SALARY,0) WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN ROUND(SALARY-SALARY*0.24,0) ELSE ROUND(SALARY-SALARY*0.49,0) END AS SALARY FROM SALARIES S"
206,Y,Y,"SELECT S.COMPANY_ID,S.EMPLOYEE_ID,S.EMPLOYEE_NAME, CASE WHEN T.MAX_SALARY < 1000 THEN ROUND(SALARY,0) WHEN T.MAX_SALARY>=1000 AND T.MAX_SALARY<=10000 THEN ROUND(SALARY-SALARY*0.24,0) WHEN T.MAX_SALARY> 10000 THEN ROUND(SALARY-SALARY*0.49,0) END AS SALARY FROM SALARIES S LEFT JOIN (SELECT COMPANY_ID,MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID) AS T ON S.COMPANY_ID = T.COMPANY_ID"
207,Y,Y,"SELECT S.COMPANY_ID,S.EMPLOYEE_ID,S.EMPLOYEE_NAME, CAST(S.SALARY-(CASE WHEN CM.COMP_MAX <1000 THEN 0 WHEN CM.COMP_MAX <=10000 AND CM.COMP_MAX>=1000 THEN 0.24 ELSE 0.49 END)*S.SALARY AS SIGNED) AS SALARY FROM SALARIES S LEFT JOIN (SELECT COMPANY_ID, MAX(SALARY) COMP_MAX FROM SALARIES GROUP BY COMPANY_ID) AS CM ON S.COMPANY_ID=CM.COMPANY_ID"
208,Y,Y,"SELECT S1.COMPANY_ID ,S1.EMPLOYEE_ID ,S1.EMPLOYEE_NAME ,CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) < 1000 THEN S1.SALARY WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN ROUND(S1.SALARY*(1-0.24),0) WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) > 10000 THEN ROUND(S1.SALARY*(1-0.49),0) END AS SALARY FROM SALARIES S1"
209,Y,Y,"SELECT S1.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CAST(CASE WHEN MAX_SALARY > 10000 THEN SALARY*(1-0.49) WHEN MAX_SALARY >= 1000 AND MAX_SALARY <= 10000 THEN SALARY*(1-0.24) ELSE SALARY END AS UNSIGNED) AS SALARY FROM SALARIES S1 INNER JOIN (SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY 1) MS ON MS.COMPANY_ID = S1.COMPANY_ID"
210,Y,Y,"SELECT S1.COMPANY_ID, S1.EMPLOYEE_ID, S1.EMPLOYEE_NAME, CASE WHEN TAB.MAXSALARY < 1000 THEN ROUND(S1.SALARY) WHEN TAB.MAXSALARY >= 1000 AND TAB.MAXSALARY < 10000 THEN ROUND(0.76*S1.SALARY) ELSE ROUND(0.51*S1.SALARY) END SALARY FROM SALARIES S1 INNER JOIN (SELECT COMPANY_ID, MAX(SALARY) MAXSALARY FROM SALARIES GROUP BY COMPANY_ID) TAB ON TAB.COMPANY_ID = S1.COMPANY_ID"
211,Y,Y,"SELECT S1.COMPANY_ID, S1.EMPLOYEE_ID, S1.EMPLOYEE_NAME, ROUND(CASE WHEN S2.MAX_SALARY < 1000 THEN SALARY WHEN S2.MAX_SALARY BETWEEN 1000 AND 10000 THEN SALARY * 0.76 ELSE SALARY * 0.51 END,0) AS SALARY FROM SALARIES S1 LEFT JOIN (SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY 1) S2 ON S1.COMPANY_ID = S2.COMPANY_ID"
212,Y,Y,"SELECT S1.COMPANY_ID, S1.EMPLOYEE_ID, S1.EMPLOYEE_NAME, ROUND(S1.SALARY*(1-S2.TAX_RATE),0) AS SALARY FROM SALARIES S1 LEFT JOIN ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) <1000 THEN 0 WHEN MAX(SALARY) BETWEEN 1000 AND 10000 THEN .24 WHEN MAX(SALARY) > 10000 THEN 0.49 END AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID) S2 ON S1.COMPANY_ID=S2.COMPANY_ID"
213,Y,Y,"SELECT SALARIES.COMPANY_ID ,SALARIES.EMPLOYEE_ID ,SALARIES.EMPLOYEE_NAME ,ROUND(CASE WHEN MAXSALARIES.MAX_SALARY < 1000 THEN SALARY WHEN MAXSALARIES.MAX_SALARY BETWEEN 1000 AND 10000 THEN SALARY*(1-0.24) ELSE SALARY*(1-0.49) END,0) SALARY FROM SALARIES SALARIES JOIN( SELECT COMPANY_ID ,MAX(SALARY) MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID )MAXSALARIES ON SALARIES.COMPANY_ID = MAXSALARIES.COMPANY_ID"
214,Y,Y,"SELECT SALARIES.COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME, CASE WHEN MAXSAL<1000 THEN ROUND(SALARY) WHEN MAXSAL>=1000 AND MAXSAL<=10000 THEN ROUND(SALARY-(SALARY*0.24)) ELSE ROUND(SALARY-SALARY*.49) END AS SALARY FROM SALARIES JOIN (SELECT COMPANY_ID,MAX(SALARY) AS MAXSAL FROM SALARIES GROUP BY COMPANY_ID ) X ON X.COMPANY_ID = SALARIES.COMPANY_ID"
215,Y,Y,"SELECT SALARIES.COMPANY_ID,SALARIES.EMPLOYEE_ID, SALARIES.EMPLOYEE_NAME,ROUND(SALARY * (1-TAX_RATE),0) AS SALARY FROM SALARIES LEFT JOIN ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END AS TAX_RATE FROM SALARIES GROUP BY 1) TAX ON TAX.COMPANY_ID =SALARIES.COMPANY_ID"
216,Y,Y,"SELECT T1.COMPANY_ID,T1.EMPLOYEE_ID,T1.EMPLOYEE_NAME, CASE WHEN T1.MAXIMUM BETWEEN 1000 AND 10000 THEN ROUND(0.76*T1.SALARY) WHEN T1.MAXIMUM>10000 THEN ROUND(0.51*T1.SALARY) ELSE T1.SALARY END AS SALARY FROM (SELECT *,MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAXIMUM FROM SALARIES)T1"
217,Y,Y,"SELECT X.COMPANY_ID, X.EMPLOYEE_ID, X.EMPLOYEE_NAME, CASE WHEN MAX_SALARY < 1000 THEN SALARY WHEN MAX_SALARY BETWEEN 1000 AND 10000 THEN ROUND((1-0.24)*SALARY) ELSE ROUND((1-0.49)*SALARY) END AS SALARY FROM SALARIES X JOIN ( SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY 1) Y ON X.COMPANY_ID = Y.COMPANY_ID"
218,Y,Y,"WITH CTE AS ( SELECT COMPANY_ID AS CI,MAX(SALARY) AS SAL FROM SALARIES GROUP BY COMPANY_ID) SELECT COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME, (CASE WHEN C.SAL<1000 THEN SALARY WHEN C.SAL>=1000 AND C.SAL<=10000 THEN ROUND((SALARY-(SALARY*0.24)),0) ELSE ROUND((SALARY-(SALARY*0.49)),0) END) AS SALARY FROM SALARIES S JOIN CTE C ON S.COMPANY_ID=C.CI"
219,Y,Y,"WITH CTE1 AS ( SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, CASE WHEN C.MAX_SALARY < 1000 THEN S.SALARY WHEN C.MAX_SALARY > 10000 THEN ROUND(S.SALARY * 0.51,0) ELSE ROUND(S.SALARY * 0.76,0) END AS SALARY FROM SALARIES S INNER JOIN CTE1 C ON S.COMPANY_ID = C.COMPANY_ID"
220,Y,Y,"WITH NS AS ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY)<1000 THEN 1 WHEN MAX(SALARY)>10000 THEN 0.51 ELSE 0.76 END AS NET_RATE FROM SALARIES GROUP BY COMPANY_ID ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY*NS.NET_RATE,0) AS SALARY FROM SALARIES AS S LEFT JOIN NS ON S.COMPANY_ID=NS.COMPANY_ID"
221,Y,Y,"WITH A AS ( SELECT COMPANY_ID, MAX(SALARY) AS MAXS FROM SALARIES GROUP BY COMPANY_ID ) SELECT S.COMPANY_ID,S.EMPLOYEE_ID,S.EMPLOYEE_NAME, CASE WHEN MAXS < 1000 THEN ROUND(S.SALARY,0) WHEN 1000<=MAXS AND MAXS<=10000 THEN ROUND(S.SALARY*0.76,0) WHEN MAXS > 10000 THEN ROUND(S.SALARY*0.51,0) END AS SALARY FROM SALARIES S, A WHERE S.COMPANY_ID = A.COMPANY_ID"
222,Y,Y,"WITH A AS (SELECT *, CASE WHEN MAX(SALARY) OVER ( PARTITION BY COMPANY_ID) <1000 THEN ROUND(SALARY,0) WHEN MAX(SALARY) OVER ( PARTITION BY COMPANY_ID) >=1000 AND MAX(SALARY) OVER ( PARTITION BY COMPANY_ID) <=10000 THEN ROUND((SALARY - SALARY * 0.24),0) WHEN MAX(SALARY) OVER ( PARTITION BY COMPANY_ID) >10000 THEN ROUND((SALARY - SALARY* 0.49),0) END AS SALARY1 FROM SALARIES) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY1 AS SALARY FROM A"
223,Y,Y,"WITH BASE AS ( SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, CASE WHEN MAX_SAL < 1000 THEN 0 WHEN MAX_SAL BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END TAX FROM( SELECT *, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX_SAL FROM SALARIES ) SUB ) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY*(1-TAX)) AS SALARY FROM BASE"
224,Y,Y,"WITH BASE AS ( SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES ) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX_SALARY <1000 THEN SALARY WHEN MAX_SALARY >10000 THEN SALARY*(1-0.49) ELSE SALARY*(1-0.24) END,0) AS SALARY FROM BASE"
225,Y,Y,"WITH COMP_TAX_RATE AS ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0.0 WHEN MAX(SALARY)>=1000 AND MAX(SALARY) <= 10000 THEN 0.24 WHEN MAX(SALARY) > 10000 THEN 0.49 ELSE NULL END AS TAX_PERCNT FROM SALARIES GROUP BY COMPANY_ID ) SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY*(1-CTR.TAX_PERCNT)) SALARY FROM SALARIES S INNER JOIN COMP_TAX_RATE CTR ON CTR.COMPANY_ID = S.COMPANY_ID"
226,Y,Y,"WITH COMPANY_MAX_SALARY AS ( SELECT COMPANY_ID, MAX(SALARY) AS SALARY_MAX FROM SALARIES GROUP BY COMPANY_ID ), COMPANY_TAX AS ( SELECT COMPANY_ID, CASE WHEN SALARY_MAX<1000 THEN 0 WHEN (SALARY_MAX>=1000)AND(SALARY_MAX<=10000) THEN 0.24 WHEN SALARY_MAX>10000 THEN 0.49 END AS SALARY_TAX FROM COMPANY_MAX_SALARY ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID,S.EMPLOYEE_NAME, ROUND(S.SALARY * (1-C.SALARY_TAX) ,0)AS SALARY FROM SALARIES S INNER JOIN COMPANY_TAX C ON S.COMPANY_ID=C.COMPANY_ID"
227,Y,Y,"WITH CT_TAX AS (SELECT CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY)<10000 THEN 24 ELSE 49 END AS TAX_RATE, COMPANY_ID FROM SALARIES GROUP BY COMPANY_ID) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND((S.SALARY- (S.SALARY*C.TAX_RATE/100))) AS SALARY FROM SALARIES S, CT_TAX C WHERE S.COMPANY_ID = C.COMPANY_ID"
228,Y,Y,"WITH CTE AS ( SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID ) SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND((CASE WHEN MAX_SALARY BETWEEN 1000 AND 10000 THEN SALARY*0.76 WHEN MAX_SALARY > 10000 THEN SALARY*0.51 ELSE SALARY END), 0) AS SALARY FROM SALARIES S JOIN CTE ON CTE.COMPANY_ID = S.COMPANY_ID"
229,Y,Y,"WITH CTE AS ( SELECT COMPANY_ID, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_SALARY, EMPLOYEE_ID FROM SALARIES ), C2 AS ( SELECT COMPANY_ID, MAX_SALARY, EMPLOYEE_ID, CASE WHEN MAX_SALARY<1000 THEN 1 WHEN MAX_SALARY BETWEEN 1000 AND 10000 THEN 1-0.24 ELSE 1-0.49 END AS RATE FROM CTE ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY*C.RATE,0) AS SALARY FROM SALARIES S JOIN C2 C ON S.COMPANY_ID = C.COMPANY_ID AND S.EMPLOYEE_ID = C.EMPLOYEE_ID"
230,Y,Y,"WITH CTE AS ( SELECT *, MAX(SALARY) OVER (PARTITION BY COMPANY_ID ORDER BY SALARY DESC) MAXS FROM SALARIES ) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND((CASE WHEN MAXS <1000 THEN SALARY WHEN (MAXS >= 1000 AND MAXS <= 10000) THEN (SALARY -(SALARY *0.24)) WHEN (MAXS > 10000) THEN (SALARY-(0.49*SALARY)) END ),0) AS SALARY FROM CTE"
231,Y,Y,"WITH CTE AS ( SELECT *, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MXSALARY FROM SALARIES ORDER BY COMPANY_ID ) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MXSALARY < 1000 THEN SALARY WHEN MXSALARY < 10000 THEN .76*SALARY ELSE .51*SALARY END) AS SALARY FROM CTE"
232,Y,Y,"WITH CTE AS ( SELECT *,MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID, EMPLOYEE_ID ) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX_SALARY < 1000 THEN ROUND(SALARY-SALARY*0,0) WHEN MAX_SALARY >= 1000 AND MAX_SALARY <= 10000 THEN ROUND(SALARY -SALARY *0.24,0) WHEN MAX_SALARY >= 10000 THEN ROUND(SALARY - SALARY*0.49,0) END AS SALARY FROM CTE"
233,Y,Y,"WITH CTE AS ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0.00 WHEN MAX(SALARY) BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID) SELECT S.COMPANY_ID,S.EMPLOYEE_ID,S.EMPLOYEE_NAME,ROUND(SALARY*(1-TAX_RATE))AS SALARY FROM SALARIES S LEFT JOIN CTE ON S.COMPANY_ID = CTE.COMPANY_ID"
234,Y,Y,"WITH CTE AS ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) > 10000 THEN 0.49 WHEN MAX(SALARY) BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0 END AS TAX_RATES FROM SALARIES GROUP BY COMPANY_ID ) SELECT S.COMPANY_ID,S.EMPLOYEE_ID,S.EMPLOYEE_NAME,ROUND((S.SALARY - S.SALARY * C.TAX_RATES),0) AS SALARY FROM SALARIES S LEFT JOIN CTE C ON S.COMPANY_ID = C.COMPANY_ID"
235,Y,Y,"WITH CTE AS ( SELECT COMPANY_ID, EMPLOYEE_ID , EMPLOYEE_NAME , SALARY, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES ) SELECT COMPANY_ID,EMPLOYEE_ID ,EMPLOYEE_NAME , CASE WHEN MAX_SALARY<1000 THEN ROUND((SALARY),0) WHEN MAX_SALARY BETWEEN 1000 AND 10000 THEN ROUND((SALARY -SALARY*0.24 ),0) WHEN MAX_SALARY>10000 THEN ROUND((SALARY -SALARY*0.49),0) END AS SALARY FROM CTE"
236,Y,Y,"WITH CTE AS ( SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_SAL FROM SALARIES ) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CAST(CASE WHEN MAX_SAL < 1000 THEN SALARY WHEN MAX_SAL BETWEEN 1000 AND 10000 THEN SALARY - (0.24*SALARY) WHEN MAX_SAL >10000 THEN SALARY - (0.49*SALARY) END AS DECIMAL) AS SALARY FROM CTE"
237,Y,Y,"WITH CTE AS ( SELECT COMPANY_ID, MAX(SALARY) AS COMP_SAL FROM SALARIES GROUP BY COMPANY_ID ), CTE2 AS ( SELECT S.COMPANY_ID , EMPLOYEE_ID , EMPLOYEE_NAME , SALARY, CTE.COMP_SAL FROM SALARIES S JOIN CTE ON CTE.COMPANY_ID = S.COMPANY_ID ) SELECT COMPANY_ID , EMPLOYEE_ID , EMPLOYEE_NAME, CASE WHEN COMP_SAL < 1000 THEN SALARY WHEN COMP_SAL BETWEEN 1000 AND 10000 THEN ROUND(SALARY - SALARY*(24/100)) WHEN COMP_SAL > 10000 THEN ROUND(SALARY - SALARY*(49/100)) END AS SALARY FROM CTE2"
238,Y,Y,"WITH CTE AS ( SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY 1 ) SELECT A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME, CASE WHEN B.MAX_SALARY <1000 THEN ROUND(SALARY,0) WHEN B.MAX_SALARY>=1000 AND B.MAX_SALARY<=10000 THEN ROUND(SALARY-(0.24*SALARY),0) WHEN B.MAX_SALARY>10000 THEN ROUND(SALARY-(0.49*SALARY),0) END AS SALARY FROM SALARIES A LEFT JOIN CTE B ON A.COMPANY_ID = B.COMPANY_ID"
239,Y,Y,"WITH CTE AS ( SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, CASE WHEN C.MAX_SALARY <1000 THEN S.SALARY WHEN C.MAX_SALARY>=100 AND C.MAX_SALARY<=10000 THEN ROUND(S.SALARY-(0.24*S.SALARY),0) WHEN C.MAX_SALARY>10000 THEN ROUND(S.SALARY-(0.49*S.SALARY),0) END AS SALARY FROM SALARIES S LEFT JOIN CTE C ON C.COMPANY_ID=S.COMPANY_ID"
240,Y,Y,"WITH CTE AS ( SELECT COMPANY_ID, MAX(SALARY) AS SAL FROM SALARIES GROUP BY 1) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN SAL < 1000 THEN SALARY WHEN SAL BETWEEN 1000 AND 10000 THEN ROUND(SALARY *.76 , 0) ELSE ROUND(SALARY * .51 ) END AS SALARY FROM SALARIES LEFT JOIN CTE C USING(COMPANY_ID)"
241,Y,Y,"WITH CTE AS ( SELECT COMPANY_ID,MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID ), DEMO AS ( SELECT S.COMPANY_ID,S.EMPLOYEE_ID,S.EMPLOYEE_NAME,S.SALARY,CTE.MAX_SALARY, CASE WHEN MAX_SALARY<1000 THEN SALARY WHEN MAX_SALARY>=1000 AND MAX_SALARY<=10000 THEN SALARY-(0.24)*SALARY ELSE SALARY-(0.49)*SALARY END AS NEW_SALARY FROM SALARIES AS S JOIN CTE ON S.COMPANY_ID=CTE.COMPANY_ID ) SELECT COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME,ROUND(NEW_SALARY,0) AS SALARY FROM DEMO"
242,Y,Y,"WITH CTE AS (SELECT COMPANY_ID, (CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) >= 1000 AND MAX(SALARY) <= 10000 THEN 0.24 WHEN MAX(SALARY) > 10000 THEN 0.49 END) AS TAX_PERCENT FROM SALARIES GROUP BY COMPANY_ID) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY * (1 - TAX_PERCENT)) AS SALARY FROM SALARIES JOIN CTE USING(COMPANY_ID)"
243,Y,Y,"WITH CTE AS (SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) > 10000 THEN 0.49 ELSE 0.24 END AS TAX FROM SALARIES GROUP BY COMPANY_ID) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY*(1-TAX)) AS SALARY FROM SALARIES JOIN CTE USING(COMPANY_ID)"
244,Y,Y,"WITH CTE AS (SELECT COMPANY_ID, CASE WHEN MAX(SALARY) > 10000 THEN 0.49 WHEN MAX(SALARY) < 1000 THEN 0 WHEN 1000 <= MAX(SALARY) <= 10000 THEN 0.24 END AS RATE FROM SALARIES GROUP BY COMPANY_ID) SELECT C.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY *(1-RATE),0) AS SALARY FROM CTE C JOIN SALARIES S ON C.COMPANY_ID = S.COMPANY_ID"
245,Y,Y,"WITH CTE AS (SELECT COMPANY_ID, CASE WHEN MAX(SALARY) >= 10000 THEN 0.49 WHEN MAX(SALARY) BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0 END AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID) SELECT A.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY*(1-TAX_RATE)) AS SALARY FROM SALARIES A INNER JOIN CTE B ON A.COMPANY_ID = B.COMPANY_ID"
246,Y,Y,"WITH CTE AS (SELECT COMPANY_ID, CASE WHEN MAX(SALARY)>10000 THEN 0.49 WHEN MAX(SALARY)>1000 THEN 0.24 ELSE 0 END AS TAX FROM SALARIES GROUP BY 1) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME , ROUND(SALARY*(1-TAX),0) AS SALARY FROM SALARIES S INNER JOIN CTE C USING(COMPANY_ID)"
247,Y,Y,"WITH CTE AS (SELECT COMPANY_ID, CASE WHEN MAX(SALARY)>10000 THEN 0.49 WHEN MAX(SALARY)>1000 THEN 0.24 ELSE 0 END AS TAX FROM SALARIES GROUP BY 1) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME , ROUND(SALARY*(1-TAX),0) AS SALARY FROM SALARIES S LEFT JOIN CTE C USING(COMPANY_ID)"
248,Y,Y,"WITH CTE AS (SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_SALARY, SALARY FROM SALARIES), CTE1 AS ( SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, CASE WHEN MAX_SALARY < 1000 THEN 0 WHEN MAX_SALARY > 10000 THEN 0.49 ELSE 0.24 END AS TAX_RATE FROM CTE ) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY * (1-TAX_RATE)) AS SALARY FROM CTE1"
249,Y,Y,"WITH CTE AS (SELECT COMPANY_ID, MAX(SALARY) AS MAX_SAL FROM SALARIES GROUP BY COMPANY_ID) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, CASE WHEN MAX_SAL<1000 THEN ROUND(S.SALARY, 0) WHEN MAX_SAL>=1000 AND MAX_SAL<=10000 THEN ROUND(S.SALARY*0.76, 0) WHEN MAX_SAL>10000 THEN ROUND(S.SALARY*0.51, 0) END AS SALARY FROM SALARIES AS S JOIN CTE ON CTE.COMPANY_ID = S.COMPANY_ID"
250,Y,Y,"WITH CTE AS (SELECT COMPANY_ID, MAX(SALARY) AS MAXIMUM FROM SALARIES GROUP BY COMPANY_ID) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY FROM SALARIES WHERE COMPANY_ID IN (SELECT COMPANY_ID FROM CTE WHERE MAXIMUM <1000) UNION SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY*0.76,0) FROM SALARIES WHERE COMPANY_ID IN (SELECT COMPANY_ID FROM CTE WHERE MAXIMUM >= 1000 AND MAXIMUM <=10000) UNION SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY*0.51,0) FROM SALARIES WHERE COMPANY_ID IN (SELECT COMPANY_ID FROM CTE WHERE MAXIMUM >=10000)"
251,Y,Y,"WITH CTE AS (SELECT COMPANY_ID, MAX(SALARY) AS NUM FROM SALARIES GROUP BY COMPANY_ID) SELECT A.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN NUM < 1000 THEN SALARY WHEN NUM > 1000 AND NUM < 10000 THEN SALARY * (1-0.24) WHEN NUM > 10000 THEN SALARY * (1-0.49) END,0) AS SALARY FROM SALARIES A JOIN CTE B ON A.COMPANY_ID = B.COMPANY_ID"
252,Y,Y,"WITH CTE AS (SELECT COMPANY_ID,MAX(SALARY) MS FROM SALARIES GROUP BY COMPANY_ID), CTE2 AS (SELECT * , (CASE WHEN MS <1000 THEN 0 WHEN MS>=1000 AND MS<=10000 THEN 0.24 ELSE 0.49 END) TAX FROM CTE), CTE3 AS (SELECT * FROM SALARIES LEFT JOIN CTE2 USING(COMPANY_ID)) SELECT COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME, ROUND(SALARY*(1-TAX),0) AS SALARY FROM CTE3"
253,Y,Y,"WITH CTE AS (SELECT SALARIES.COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME,SALARY, MAX_SALARY FROM SALARIES JOIN (SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID) AS B ON SALARIES.COMPANY_ID=B.COMPANY_ID) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND((CASE WHEN MAX_SALARY<1000 THEN SALARY WHEN MAX_SALARY BETWEEN 1000 AND 10000 THEN SALARY*0.76 WHEN MAX_SALARY >10000 THEN SALARY*0.51 END),0) AS SALARY FROM CTE"
254,Y,Y,"WITH CTE AS( SELECT *, DENSE_RANK() OVER(PARTITION BY COMPANY_ID ORDER BY SALARY DESC) AS RNK FROM SALARIES), TOP_SALARY AS( SELECT * FROM CTE WHERE RNK = 1), TAX AS( SELECT DISTINCT COMPANY_ID, CASE WHEN SALARY < 1000 THEN 0 WHEN SALARY BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END AS TAX_RATE FROM TOP_SALARY ) SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY*(1-TAX_RATE),0) AS SALARY FROM SALARIES S LEFT JOIN TAX T ON S.COMPANY_ID = T.COMPANY_ID"
255,Y,Y,"WITH CTE AS( SELECT COMPANY_ID, (CASE WHEN MAX(SALARY) < 1000 THEN 0.00 WHEN MAX(SALARY) > 1000 AND MAX(SALARY) < 10000 THEN 0.24 WHEN MAX(SALARY) > 10000 THEN 0.49 END) AS TAX FROM SALARIES GROUP BY 1 ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY * (1 - CTE.TAX)) AS SALARY FROM SALARIES S JOIN CTE ON S.COMPANY_ID = CTE.COMPANY_ID"
256,Y,Y,"WITH CTE AS( SELECT COMPANY_ID, CASE WHEN MAX_SALARY < 1000 THEN 0 WHEN MAX_SALARY >=1000 AND MAX_SALARY <=10000 THEN 24 ELSE 49 END AS TAX FROM (SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY 1) S1 ) SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY*(1-TAX/100),0) AS SALARY FROM SALARIES S JOIN CTE C ON S.COMPANY_ID = C.COMPANY_ID"
257,Y,Y,"WITH CTE AS( SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, CASE WHEN MAX_SALARY < 1000 THEN ROUND(S.SALARY, 0) WHEN MAX_SALARY>=1000 AND MAX_SALARY<=10000 THEN ROUND(S.SALARY*(1-0.24),0) WHEN MAX_SALARY > 10000 THEN ROUND(S.SALARY*(1-0.49),0) END AS SALARY FROM SALARIES S JOIN CTE ON CTE.COMPANY_ID = S.COMPANY_ID"
258,Y,Y,"WITH CTE AS( SELECT COMPANY_ID, MAX(SALARY) AS MS FROM SALARIES GROUP BY COMPANY_ID) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, CASE WHEN MS<1000 THEN ROUND(SALARY,0) WHEN 1000 <= MS AND MS <= 10000 THEN ROUND((0.76*SALARY),0) WHEN MS>10000 THEN ROUND((0.51*SALARY),0) END AS SALARY FROM CTE A INNER JOIN SALARIES S ON A.COMPANY_ID=S.COMPANY_ID"
259,Y,Y,"WITH CTE AS( SELECT COMPANY_ID, MAX(SALARY) AS MS FROM SALARIES GROUP BY COMPANY_ID ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, CASE WHEN MS<1000 THEN ROUND(S.SALARY,0) WHEN MS>=1000 AND MS<=10000 THEN ROUND(S.SALARY*0.76,0) WHEN MS>10000 THEN ROUND(S.SALARY*0.51,0) END AS SALARY FROM SALARIES S JOIN CTE ON CTE.COMPANY_ID = S.COMPANY_ID"
260,Y,Y,"WITH CTE AS( SELECT COMPANY_ID,MAX(SALARY) AS MX FROM SALARIES GROUP BY COMPANY_ID) SELECT A.COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME, CASE WHEN MX <1000 THEN 1*SALARY WHEN MX<=10000 AND MX>=1000 THEN ROUND(0.76*SALARY,0) WHEN MX>10000 THEN ROUND(0.51*SALARY,0) END AS SALARY FROM SALARIES A LEFT JOIN CTE ON A.COMPANY_ID=CTE.COMPANY_ID"
261,Y,Y,"WITH CTE AS(SELECT COMPANY_ID,MAX(SALARY) AS SAL FROM SALARIES GROUP BY COMPANY_ID) SELECT S.COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME, ROUND(CASE WHEN CTE.SAL>10000 THEN SALARY-(0.49*SALARY) WHEN CTE.SAL<1000 THEN SALARY ELSE SALARY-(0.24*SALARY) END,0) AS SALARY FROM SALARIES S JOIN CTE ON CTE.COMPANY_ID=S.COMPANY_ID"
262,Y,Y,"WITH CTE1 AS (SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID), CTE2 AS (SELECT COMPANY_ID, CASE WHEN MAX_SALARY<1000 THEN 1 WHEN MAX_SALARY BETWEEN 1000 AND 10000 THEN 0.76 WHEN MAX_SALARY>10000 THEN 0.51 END AS TAX_RATE FROM CTE1) SELECT A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME, ROUND(A.SALARY*B.TAX_RATE,0) AS SALARY FROM SALARIES A LEFT JOIN CTE2 B ON A.COMPANY_ID=B.COMPANY_ID"
263,Y,Y,"WITH CTE1 AS (SELECT COMPANY_ID,MAX(SALARY)AS SALARY FROM SALARIES GROUP BY COMPANY_ID) SELECT S.COMPANY_ID,S.EMPLOYEE_ID,S.EMPLOYEE_NAME, CASE WHEN CTE1.SALARY<1000 THEN ROUND(S.SALARY*1,0) WHEN CTE1.SALARY>=1000 AND CTE1.SALARY<=10000 THEN ROUND(S.SALARY*0.76,0) WHEN CTE1.SALARY>10000 THEN ROUND(S.SALARY*0.51) END AS SALARY FROM SALARIES S JOIN CTE1 ON CTE1.COMPANY_ID=S.COMPANY_ID"
264,Y,Y,"WITH CTE_COMPANYSALARY AS ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) BETWEEN 1000 AND 10000 THEN 0.24 WHEN MAX(SALARY)>10000 THEN 0.49 END AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID ) SELECT S.COMPANY_ID,S.EMPLOYEE_ID,S.EMPLOYEE_NAME,ROUND((S.SALARY - (C.TAX_RATE*S.SALARY)),0) AS SALARY FROM SALARIES S JOIN CTE_COMPANYSALARY C ON C.COMPANY_ID = S.COMPANY_ID"
265,Y,Y,"WITH CTE_MAX_SALARY AS ( SELECT *, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES ), CTE_POST_TAX AS ( SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND( SALARY * (1 - ( CASE WHEN MAX_SALARY < 1000 THEN 0.00 WHEN MAX_SALARY BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END ) ), 0 ) AS SALARY FROM CTE_MAX_SALARY ) SELECT * FROM CTE_POST_TAX"
266,Y,Y,"WITH FINAL1 AS ( WITH FINAL AS ( WITH CTE AS ( SELECT * , MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_OF_COMPANY FROM SALARIES ) SELECT * , CASE WHEN MAX_OF_COMPANY < 1000 THEN 0 WHEN MAX_OF_COMPANY >= 1000 AND MAX_OF_COMPANY <= 10000 THEN 24 WHEN MAX_OF_COMPANY > 10000 THEN 49 END AS TAX_PERCENT FROM CTE ) SELECT COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME,ROUND((SALARY - (TAX_PERCENT/100)*SALARY),2) AS AMOUNT FROM FINAL ORDER BY COMPANY_ID ) SELECT COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME, CASE WHEN RIGHT(AMOUNT,2) >= 50 THEN CEIL(AMOUNT) WHEN RIGHT(AMOUNT,2) < 50 THEN FLOOR(AMOUNT) END AS SALARY FROM FINAL1"
267,Y,Y,"WITH HIGH AS( SELECT COMPANY_ID, MAX(SALARY) AS HIGHEST FROM SALARIES GROUP BY COMPANY_ID) SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN HIGHEST < 1000 THEN (SALARY-SALARY*0) WHEN HIGHEST >= 1000 AND HIGHEST <= 10000 THEN (SALARY - SALARY*0.24) WHEN HIGHEST > 10000 THEN (SALARY-SALARY*0.49) ELSE NULL END,0) AS SALARY FROM HIGH AS H JOIN SALARIES AS S ON H.COMPANY_ID = S.COMPANY_ID GROUP BY 1,2"
268,Y,Y,"WITH M_SAL AS (SELECT *,MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX_SAL FROM SALARIES) SELECT COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME, CASE WHEN MAX_SAL < 1000 THEN SALARY WHEN MAX_SAL BETWEEN 1000 AND 10000 THEN ROUND(SALARY-(SALARY*(24/100))) ELSE ROUND(SALARY-(SALARY*(49/100))) END AS SALARY FROM M_SAL"
269,Y,Y,"WITH MA AS(SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, S.SALARY, MAX(S.SALARY) OVER(PARTITION BY S.COMPANY_ID) AS M1 FROM SALARIES S) SELECT M.COMPANY_ID, M.EMPLOYEE_ID, M.EMPLOYEE_NAME, CASE WHEN M.M1<1000 THEN ROUND(M.SALARY-(0.00*M.SALARY)) WHEN M.M1>=1000 AND M.M1<=10000 THEN ROUND(M.SALARY-(0.24*M.SALARY)) WHEN M.M1>=10000 THEN ROUND(M.SALARY-(0.49*M.SALARY)) END AS SALARY FROM MA M"
270,Y,Y,"WITH MAX_SAL AS( SELECT COMPANY_ID, MAX(SALARY) AS MX FROM SALARIES GROUP BY COMPANY_ID ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(CASE WHEN M.MX<1000 THEN S.SALARY WHEN M.MX>=1000 AND M.MX<=10000 THEN S.SALARY-S.SALARY*0.24 WHEN M.MX>10000 THEN S.SALARY-S.SALARY*0.49 END,0) AS SALARY FROM SALARIES S LEFT JOIN MAX_SAL M ON S.COMPANY_ID=M.COMPANY_ID"
271,Y,Y,"WITH MAX_SALARIES AS ( SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY 1 ), TAX_BRACKETS AS ( SELECT COMPANY_ID AS CID, CASE WHEN MAX_SALARY < 1000 THEN 1 WHEN MAX_SALARY < 10000 THEN 0.76 ELSE 0.51 END AS TAX_BRACKET FROM MAX_SALARIES ) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY * TB.TAX_BRACKET,0) AS SALARY FROM SALARIES S JOIN TAX_BRACKETS TB ON S.COMPANY_ID = TB.CID"
272,Y,Y,"WITH MAX_SALARIES AS ( SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(CASE WHEN MS.MAX_SALARY < 1000 THEN S.SALARY WHEN MS.MAX_SALARY > 10000 THEN S.SALARY * 0.51 ELSE S.SALARY * 0.76 END) AS SALARY FROM SALARIES S LEFT JOIN MAX_SALARIES MS ON S.COMPANY_ID = MS.COMPANY_ID"
273,Y,Y,"WITH MAX_SALARIES AS (SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID) SELECT C.COMPANY_ID, C.EMPLOYEE_ID, C.EMPLOYEE_NAME, ROUND((CASE WHEN MS.MAX_SALARY < 1000 THEN 1 WHEN MS.MAX_SALARY < 10000 THEN 0.76 ELSE 0.51 END) * C.SALARY) AS SALARY FROM SALARIES C INNER JOIN MAX_SALARIES MS USING(COMPANY_ID)"
274,Y,Y,"WITH MAX_SALARY AS (SELECT COMPANY_ID, CASE WHEN MAX_SALARY < 1000 THEN 1 WHEN MAX_SALARY >= 1000 AND MAX_SALARY <= 10000 THEN 0.76 ELSE 0.51 END AS TAX_RATE FROM (SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY 1)A ) SELECT A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME, ROUND(A.SALARY * B.TAX_RATE) AS SALARY FROM SALARIES A INNER JOIN MAX_SALARY B ON A.COMPANY_ID = B.COMPANY_ID"
275,Y,Y,"WITH MAX_SALARY AS (SELECT COMPANY_ID, MAX(SALARY) AS MAX_SAL FROM SALARIES GROUP BY COMPANY_ID) SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX_SAL < 1000 THEN SALARY WHEN MAX_SAL BETWEEN 1000 AND 10000 THEN SALARY - ((SALARY * 24) / 100) WHEN MAX_SAL > 10000 THEN SALARY - ((SALARY*49)/100) END,0) AS SALARY FROM SALARIES S JOIN MAX_SALARY M ON S.COMPANY_ID = M.COMPANY_ID"
276,Y,Y,"WITH MAXSAL (COMPANY_ID , MSALARY) AS ( SELECT COMPANY_ID, MAX(SALARY) FROM SALARIES GROUP BY COMPANY_ID ) SELECT COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME, CASE WHEN MSALARY>1000 AND MSALARY<10000 THEN ROUND((SALARY*76)/100) WHEN MSALARY>10000 THEN ROUND((SALARY*51)/100) ELSE SALARY END AS SALARY FROM (SELECT SALARIES.COMPANY_ID,SALARIES.EMPLOYEE_ID,SALARIES.EMPLOYEE_NAME, SALARIES.SALARY,MAXSAL.MSALARY FROM SALARIES,MAXSAL WHERE MAXSAL.COMPANY_ID=SALARIES.COMPANY_ID)T"
277,Y,Y,"WITH MX AS( SELECT DISTINCT COMPANY_ID, MAX(SALARY) AS MX FROM SALARIES GROUP BY COMPANY_ID), TAX AS( SELECT COMPANY_ID, (CASE WHEN MX < 1000 THEN 1 WHEN MX >= 1000 AND MX<= 10000 THEN 0.76 WHEN MX >10000 THEN 0.51 END )AS TAX FROM MX ) SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(TAX * S.SALARY,0) AS SALARY FROM SALARIES S JOIN TAX T ON S.COMPANY_ID = T.COMPANY_ID"
278,Y,Y,"WITH SAL_MAX AS (SELECT COMPANY_ID, MAX(SALARY) AS MAX_SAL FROM SALARIES GROUP BY COMPANY_ID) SELECT A.COMPANY_ID,A.EMPLOYEE_ID,A.EMPLOYEE_NAME,ROUND(CASE WHEN MAX_SAL < 1000 THEN SALARY WHEN MAX_SAL >= 1000 AND MAX_SAL <= 10000 THEN (SALARY - SALARY*0.24) ELSE (SALARY - SALARY*0.49) END,0) AS SALARY FROM SALARIES A INNER JOIN SAL_MAX B ON A.COMPANY_ID = B.COMPANY_ID GROUP BY A.COMPANY_ID,A.EMPLOYEE_ID,A.EMPLOYEE_NAME"
279,Y,Y,"WITH SRC AS ( SELECT *, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES ) SELECT COMPANY_ID ,EMPLOYEE_ID ,EMPLOYEE_NAME , CASE WHEN MAX_SALARY < 1000 THEN SALARY WHEN MAX_SALARY >=1000 AND MAX_SALARY <= 10000 THEN ROUND(SALARY-SALARY*0.24,0) WHEN MAX_SALARY > 10000 THEN ROUND(SALARY-SALARY *0.49,0) END AS SALARY FROM SRC ORDER BY COMPANY_ID"
280,Y,Y,"WITH SUBTABLE AS (SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES), SUBTABLE2 AS (SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, CASE WHEN MAX_SALARY > 10000 THEN 0.49 WHEN MAX_SALARY >= 1000 THEN 0.24 ELSE 0 END AS TAX_RATE FROM SUBTABLE) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY * (1 - TAX_RATE),0) AS SALARY FROM SUBTABLE2"
281,Y,Y,"WITH T AS ( SELECT COMPANY_ID, (CASE WHEN MAX(SALARY) >10000 THEN 0.49 WHEN MAX(SALARY) <= 10000 AND MAX(SALARY)>= 1000 THEN 0.24 WHEN MAX(SALARY) <1000 THEN 0 END) AS TAX FROM SALARIES GROUP BY COMPANY_ID ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY - S.SALARY * T.TAX, 0) AS SALARY FROM SALARIES S LEFT JOIN T ON S.COMPANY_ID = T.COMPANY_ID"
282,Y,Y,"WITH T AS ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) <= 10000 AND MAX(SALARY)>=1000 THEN 0.24 ELSE 0.49 END AS TAX FROM SALARIES GROUP BY COMPANY_ID) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY-SALARY*TAX, 0) AS SALARY FROM T JOIN SALARIES USING(COMPANY_ID)"
283,Y,Y,"WITH T AS (SELECT *,MAX(SALARY)OVER(PARTITION BY COMPANY_ID) AS MAXS FROM SALARIES) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAXS<1000 THEN SALARY WHEN MAXS>=1000 AND MAXS<=10000 THEN SALARY*(1-0.24) ELSE SALARY*(1-0.49) END,0) AS SALARY FROM T"
284,Y,Y,"WITH T AS (SELECT CASE WHEN MAX( SALARY) < 1000 THEN 0 WHEN MAX( SALARY) < 10000 THEN 0.24 ELSE 0.49 END AS RATE, COMPANY_ID FROM SALARIES GROUP BY COMPANY_ID) SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY*(1-RATE), 0) AS SALARY FROM SALARIES S JOIN T ON S.COMPANY_ID = T.COMPANY_ID"
285,Y,Y,"WITH T AS (SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY, CASE WHEN MAX(SALARY) <1000 THEN 1 WHEN MAX(SALARY)>=1000 AND MAX(SALARY) <=10000 THEN 0.76 ELSE 0.51 END AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID) SELECT A.COMPANY_ID AS COMPANY_ID, A.EMPLOYEE_ID AS EMPLOYEE_ID, A.EMPLOYEE_NAME EMPLOYEE_NAME, FLOOR(ROUND(A.SALARY*T.TAX_RATE,0)) AS SALARY FROM SALARIES A LEFT JOIN T ON A.COMPANY_ID = T.COMPANY_ID"
286,Y,Y,"WITH T AS( SELECT COMPANY_ID,CASE WHEN MAX(SALARY) <1000 THEN 0 WHEN MAX(SALARY) BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END TAX FROM SALARIES GROUP BY 1) SELECT S.COMPANY_ID,S.EMPLOYEE_ID,S.EMPLOYEE_NAME,ROUND(S.SALARY*(1-TAX),0) AS SALARY FROM SALARIES S LEFT JOIN T ON T.COMPANY_ID=S.COMPANY_ID"
287,Y,Y,"WITH T AS(SELECT COMPANY_ID, EMPLOYEE_ID , EMPLOYEE_NAME , SALARY , MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES), NEW_T AS (SELECT COMPANY_ID, EMPLOYEE_ID , EMPLOYEE_NAME , SALARY, ( CASE WHEN MAX_SALARY<1000 THEN 0 WHEN MAX_SALARY >= 1000 AND MAX_SALARY <= 10000 THEN 0.24 WHEN MAX_SALARY > 10000 THEN 0.49 END) AS TAX_PERCENT FROM T) SELECT COMPANY_ID, EMPLOYEE_ID , EMPLOYEE_NAME , ROUND(SALARY*(1-TAX_PERCENT),0) AS SALARY FROM NEW_T"
288,Y,Y,"WITH T1 AS ( SELECT *, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES ) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX_SALARY < 1000 THEN SALARY WHEN MAX_SALARY BETWEEN 1000 AND 10000 THEN (0.76*SALARY) ELSE (0.51*SALARY) END) AS SALARY FROM T1"
289,Y,Y,"WITH T1 AS ( SELECT S1.*, S2.MAX_SALARY FROM SALARIES S1 JOIN ( SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID ) S2 ON S1.COMPANY_ID = S2.COMPANY_ID ) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX_SALARY < 1000 THEN ROUND(SALARY,0) WHEN MAX_SALARY BETWEEN 1000 AND 10000 THEN ROUND(SALARY*0.76,0) WHEN MAX_SALARY > 10000 THEN ROUND(SALARY * 0.51,0) END AS SALARY FROM T1"
290,Y,Y,"WITH T1 AS (SELECT COMPANY_ID, MAX(SALARY) AS MAX_S FROM SALARIES GROUP BY 1), T2 AS (SELECT COMPANY_ID, CASE WHEN MAX_S < 1000 THEN 1 WHEN MAX_S <= 10000 THEN 0.76 ELSE 0.51 END AS TAX FROM T1) SELECT A.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(A.SALARY*TAX) AS SALARY FROM SALARIES A JOIN T2 ON A.COMPANY_ID = T2.COMPANY_ID"
291,Y,Y,"WITH T1 AS (SELECT COMPANY_ID,MAX(SALARY) AS MAX_COMP FROM SALARIES GROUP BY COMPANY_ID) SELECT S.COMPANY_ID, S.EMPLOYEE_ID,S.EMPLOYEE_NAME, ROUND(CASE WHEN T1.MAX_COMP <1000 THEN S.SALARY WHEN (T1.MAX_COMP >=1000 AND T1.MAX_COMP<=10000) THEN S.SALARY-0.24*S.SALARY WHEN T1.MAX_COMP>10000 THEN S.SALARY-0.49*S.SALARY END,0) AS SALARY FROM SALARIES S JOIN T1 ON S.COMPANY_ID=T1.COMPANY_ID"
292,Y,Y,"WITH T1 AS( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) >= 1000 AND MAX(SALARY) <= 10000 THEN 0.24 ELSE 0.49 END AS RATE FROM SALARIES GROUP BY COMPANY_ID ) SELECT T2.COMPANY_ID, T2.EMPLOYEE_ID, T2.EMPLOYEE_NAME, ROUND(T2.SALARY-T1.RATE*T2.SALARY,0) AS SALARY FROM SALARIES T2 LEFT JOIN T1 ON T2.COMPANY_ID = T1.COMPANY_ID"
293,Y,Y,"WITH TAX AS ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID ) < 1000 THEN 0 WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID ) BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END AS TAX_RATE FROM SALARIES ) SELECT DISTINCT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND((1-TAX_RATE) * SALARY, 0) AS SALARY FROM SALARIES S LEFT JOIN TAX T ON S.COMPANY_ID = T.COMPANY_ID"
294,Y,Y,"WITH TAX AS ( SELECT COMPANY_ID,MAX(SALARY) MAX_SALARY FROM SALARIES GROUP BY 1 ) , TAX1 AS (SELECT COMPANY_ID, CASE WHEN MAX_SALARY<1000 THEN 0 WHEN MAX_SALARY<=10000 THEN 0.24 ELSE 0.49 END AS TAX_RATE FROM TAX ) SELECT S.COMPANY_ID, EMPLOYEE_ID,EMPLOYEE_NAME,ROUND(SALARY*(1-TAX_RATE)) SALARY FROM SALARIES S JOIN TAX1 T ON S.COMPANY_ID=T.COMPANY_ID"
295,Y,Y,"WITH TAX AS (SELECT COMPANY_ID, CASE WHEN MAX_SALARY <=1000 THEN 0 WHEN MAX_SALARY <=10000 THEN 0.24 ELSE 0.49 END AS TAX_RATE FROM (SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID)AS TEMP) SELECT SALARIES.COMPANY_ID,SALARIES.EMPLOYEE_ID,SALARIES.EMPLOYEE_NAME,ROUND(SALARY*(1-TAX_RATE),0) AS SALARY FROM SALARIES LEFT JOIN TAX ON SALARIES.COMPANY_ID = TAX.COMPANY_ID"
296,Y,Y,"WITH TAX AS( SELECT DISTINCT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END AS TAX FROM SALARIES GROUP BY COMPANY_ID ) SELECT A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME, ROUND(A.SALARY * (1-B.TAX)) AS SALARY FROM SALARIES AS A JOIN TAX AS B ON A.COMPANY_ID=B.COMPANY_ID"
297,Y,Y,"WITH TAX_DATA AS ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY)<1000 THEN 0 WHEN MAX(SALARY) BETWEEN 1000 AND 10000 THEN 0.24 WHEN MAX(SALARY)>10000 THEN 0.49 END AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY*(1-T.TAX_RATE), 0) AS SALARY FROM SALARIES S JOIN TAX_DATA T USING(COMPANY_ID)"
298,Y,Y,"WITH TAX_MULTIPLIER AS (SELECT COMPANY_ID, CASE WHEN MAX(SALARY)<1000 THEN 1 WHEN MAX(SALARY) <= 10000 THEN 0.76 ELSE 0.51 END AS MULT FROM SALARIES GROUP BY COMPANY_ID) SELECT A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME, ROUND(A.SALARY*T.MULT) AS SALARY FROM SALARIES A JOIN TAX_MULTIPLIER T ON A.COMPANY_ID = T.COMPANY_ID"
299,Y,Y,"WITH TAX_RATE_BY_SALARY AS ( SELECT *, CASE WHEN SALARY < 1000 THEN 0.0 WHEN SALARY <= 10000 THEN 0.24 ELSE 0.49 END AS TAX_RATE FROM SALARIES S ) , TAX_BY_COMPANY AS ( SELECT COMPANY_ID, MAX(TAX_RATE) AS TAX FROM TAX_RATE_BY_SALARY T GROUP BY 1 ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY*(1-T.TAX),0) AS SALARY FROM SALARIES S LEFT JOIN TAX_BY_COMPANY T ON T.COMPANY_ID = S.COMPANY_ID"
300,Y,Y,"WITH TAXTABLE AS( SELECT COMPANY_ID, CASE WHEN MAX(SALARY)<1000 THEN 0 WHEN MAX(SALARY)<=10000 THEN 0.24 ELSE 0.49 END AS TAXRATE FROM SALARIES GROUP BY COMPANY_ID ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND( S.SALARY*(1-T.TAXRATE), 0) AS SALARY FROM SALARIES AS S JOIN TAXTABLE AS T USING (COMPANY_ID)"
301,Y,Y,"WITH TEMP AS ( SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS COMPANY_HIGHEST FROM SALARIES ) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN COMPANY_HIGHEST < 1000 THEN SALARY WHEN COMPANY_HIGHEST BETWEEN 1000 AND 10000 THEN ROUND(SALARY*0.76) WHEN COMPANY_HIGHEST > 10000 THEN ROUND(SALARY*0.51) END AS SALARY FROM TEMP"
302,Y,Y,"WITH TEMP AS ( SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND((CASE WHEN TEMP.MAX_SALARY < 1000 THEN S.SALARY WHEN TEMP.MAX_SALARY BETWEEN 1000 AND 10000 THEN S.SALARY * (1-0.24) WHEN TEMP.MAX_SALARY > 10000 THEN S.SALARY* (1-0.49) END), 0) AS SALARY FROM SALARIES AS S LEFT JOIN TEMP ON S.COMPANY_ID = TEMP.COMPANY_ID"
303,Y,Y,"WITH TEMP AS ( SELECT MAX(SALARY) AS MAX_SALARY ,COMPANY_ID FROM SALARIES GROUP BY COMPANY_ID ) SELECT SAL.COMPANY_ID ,SAL.EMPLOYEE_ID ,SAL.EMPLOYEE_NAME ,(CASE WHEN T.MAX_SALARY < 1000 THEN SAL.SALARY WHEN T.MAX_SALARY BETWEEN 1000 AND 10000 THEN ROUND((SAL.SALARY - (SAL.SALARY * 0.24)), 0) WHEN T.MAX_SALARY > 10000 THEN ROUND((SAL.SALARY - (SAL.SALARY * 0.49)), 0) END) AS SALARY FROM SALARIES SAL JOIN TEMP T ON SAL.COMPANY_ID = T.COMPANY_ID"
304,Y,Y,"WITH TEMP AS (SELECT *, CASE WHEN MAX(SALARY)OVER(PARTITION BY COMPANY_ID)<1000 THEN 0 WHEN MAX(SALARY)OVER(PARTITION BY COMPANY_ID)<=10000 THEN 0.24 ELSE 0.49 END AS TAX FROM SALARIES) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY*(1-TAX),0) AS SALARY FROM TEMP"
305,Y,Y,"WITH TEMP AS (SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX_SALARY < 1000 THEN ROUND(SALARY,0) WHEN MAX_SALARY > 10000 THEN ROUND(SALARY * 0.51,0) ELSE ROUND(SALARY * 0.76,0) END AS SALARY FROM TEMP"
306,Y,Y,"WITH TEMP AS (SELECT COMPANY_ID, MAX(SALARY) AS MAX FROM SALARIES GROUP BY COMPANY_ID) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, CASE WHEN (T.MAX <1000) THEN ROUND(S.SALARY,0) WHEN (T.MAX >1000 AND T.MAX <10000) THEN ROUND((S.SALARY-(0.24)*S.SALARY),0) WHEN (T.MAX >10000) THEN ROUND((S.SALARY-(0.49)*S.SALARY),0) END AS SALARY FROM SALARIES S LEFT OUTER JOIN TEMP T ON T.COMPANY_ID = S.COMPANY_ID"
307,Y,Y,"WITH TEMP AS( SELECT COMPANY_ID , MAX(SALARY) AS MAX_SAL , CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) BETWEEN 1000 AND 10000 THEN 24 WHEN MAX(SALARY) > 10000 THEN 49 END AS TAX FROM SALARIES GROUP BY COMPANY_ID) SELECT SALARIES.COMPANY_ID , EMPLOYEE_ID , EMPLOYEE_NAME , ROUND((SALARY - ((SALARY*TAX)/100))) AS SALARY FROM SALARIES JOIN TEMP ON TEMP.COMPANY_ID = SALARIES.COMPANY_ID"
308,Y,Y,"WITH TEMP1 AS ( SELECT COMPANY_ID, MAX(SALARY) AS MAX FROM SALARIES GROUP BY COMPANY_ID ), TEMP2 AS( SELECT COMPANY_ID, ( CASE WHEN MAX < 1000 THEN 0 WHEN MAX > 10000 THEN 0.49 ELSE 0.24 END ) AS TAX_RATE FROM TEMP1 ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND((S.SALARY * (1-T.TAX_RATE)),0) AS SALARY FROM SALARIES AS S LEFT JOIN TEMP2 AS T ON S.COMPANY_ID = T.COMPANY_ID"
309,Y,Y,"WITH TEMP1 AS ( SELECT COMPANY_ID, CASE WHEN MAX_SALARY<1000 THEN 0.0 WHEN MAX_SALARY BETWEEN 1000 AND 10000 THEN 0.24 WHEN MAX_SALARY>10000 THEN 0.49 END AS TAX FROM ( SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY 1 )T ) SELECT SALARIES.COMPANY_ID AS COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME, ROUND(SALARY-SALARY*TAX) AS SALARY FROM SALARIES INNER JOIN TEMP1 ON SALARIES.COMPANY_ID=TEMP1.COMPANY_ID"
310,Y,Y,"WITH TMP AS ( SELECT *,MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES ) SELECT COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME, ROUND(CASE WHEN MAX_SALARY<1000 THEN SALARY WHEN MAX_SALARY>10000 THEN SALARY*(0.51) ELSE SALARY*(0.76) END,0) AS SALARY FROM TMP"
311,Y,Y,"WITH TMP AS ( SELECT *,MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES ) SELECT COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME, ROUND(CASE WHEN MAX_SALARY<1000 THEN SALARY WHEN MAX_SALARY>10000 THEN SALARY*(1-0.49) ELSE SALARY*(1-0.24) END,0) AS SALARY FROM TMP"
312,Y,Y,"WITH TMP AS ( SELECT *,MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES ) SELECT COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME, ROUND(CASE WHEN MAX_SALARY<1000 THEN SALARY WHEN MAX_SALARY>10000 THEN SALARY-SALARY*(0.49) ELSE SALARY-SALARY*(0.24) END,0) AS SALARY FROM TMP"
313,Y,Y,"WITH TMP AS ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) <= 10000 THEN 0.24 ELSE 0.49 END AS TAX FROM SALARIES GROUP BY COMPANY_ID ) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY * (1-TAX)) AS SALARY FROM SALARIES NATURAL JOIN TMP"
314,Y,Y,"WITH TMP AS ( SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID ) , TMP2 AS ( SELECT COMPANY_ID, CASE WHEN MAX_SALARY < 1000 THEN 0 WHEN 1000 <= MAX_SALARY AND MAX_SALARY <= 10000 THEN 0.24 ELSE 0.49 END AS TAX_RATE FROM TMP ) SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY * (1 - TAX_RATE)) AS SALARY FROM SALARIES S JOIN TMP2 T ON S.COMPANY_ID = T.COMPANY_ID"
315,Y,Y,"WITH X AS ( SELECT COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME,SALARY, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAXI FROM SALARIES ), Y AS ( SELECT *, CASE WHEN MAXI < 1000 THEN 0 WHEN MAXI > 1000 AND MAXI < 10000 THEN 24 WHEN MAXI > 10000 THEN 49 END AS TAX FROM X ) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME,ROUND(SALARY-(SALARY*TAX/100),0) AS SALARY FROM Y"
316,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, CASE WHEN MAX_SALARY < 1000 THEN SALARY WHEN MAX_SALARY >=1000 AND MAX_SALARY <= 10000 THEN ROUND(SALARY-SALARY*0.24, 0) WHEN MAX_SALARY >10000 THEN ROUND(SALARY-SALARY*0.49, 0) END AS SALARY FROM SALARIES S JOIN ( SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID ) T ON S.COMPANY_ID = T.COMPANY_ID"
317,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND( CASE WHEN TAX_RATE = 0 THEN S.SALARY WHEN TAX_RATE = 0.49 THEN S.SALARY * (1-0.49) ELSE S.SALARY * (1-0.24) END , 0) AS SALARY FROM SALARIES S JOIN ( SELECT *, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) > 10000 THEN 0.49 ELSE 0.24 END AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID ) T ON S.COMPANY_ID = T.COMPANY_ID"
318,Y,Y,"WITH MAX_SALARY AS ( SELECT COMPANY_ID,MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID ) SELECT B.COMPANY_ID, B.EMPLOYEE_ID, B.EMPLOYEE_NAME, CASE WHEN A.MAX_SALARY<1000 THEN B.SALARY WHEN MAX_SALARY BETWEEN 1000 AND 10000 THEN ROUND(B.SALARY*0.76,0) WHEN MAX_SALARY > 10000 THEN ROUND(B.SALARY*0.51,0) END AS SALARY FROM MAX_SALARY A JOIN SALARIES B ON A.COMPANY_ID=B.COMPANY_ID"
319,Y,Y,"WITH MAX_SALARIES AS ( SELECT COMPANY_ID , MAX(SALARY) MAX_SALARY FROM SALARIES GROUP BY 1 ) SELECT S.COMPANY_ID , S.EMPLOYEE_ID , S.EMPLOYEE_NAME , ROUND(CASE WHEN MAX_SALARY < 1000 THEN (1 - 0) * SALARY WHEN 1000 <= MAX_SALARY AND MAX_SALARY <= 10000 THEN (1 - 0.24) * SALARY ELSE (1 - 0.49) * SALARY END) SALARY FROM SALARIES S JOIN MAX_SALARIES M ON S.COMPANY_ID = M.COMPANY_ID"
320,Y,Y,"WITH A AS ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY)<1000 THEN 0 WHEN MAX(SALARY) >10000 THEN 0.49 ELSE 0.24 END AS RATE FROM SALARIES GROUP BY COMPANY_ID) SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY*(1-RATE)) AS SALARY FROM SALARIES S INNER JOIN A USING(COMPANY_ID)"
321,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CAST(CASE WHEN MAX_SALARY<=1000 THEN SALARY WHEN MAX_SALARY>1000 AND MAX_SALARY<=10000 THEN SALARY*0.76 WHEN MAX_SALARY>10000 THEN SALARY*0.51 END AS SIGNED) AS SALARY FROM (SELECT *, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES) A"
322,Y,Y,"WITH CTE AS (SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX_SAL < 1000 THEN 0 WHEN MAX_SAL > 1000 AND MAX_SAL <= 10000 THEN 0.24 WHEN MAX_SAL > 10000 THEN 0.49 END AS PERCENTAGE,SALARY FROM (SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX_SAL FROM SALARIES ) A ) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY - (SALARY * PERCENTAGE),0) AS SALARY FROM CTE"
323,Y,Y,"WITH TB1 AS ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) > 10000 THEN 0.51 WHEN MAX(SALARY) < 1000 THEN 1 ELSE 0.76 END AS RATE FROM SALARIES GROUP BY COMPANY_ID) SELECT SALARIES.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY*RATE) AS SALARY FROM SALARIES, TB1 WHERE TB1.COMPANY_ID = SALARIES.COMPANY_ID"
324,Y,Y,"WITH T AS ( SELECT T.COMPANY_ID, CASE WHEN T.MAXSALARY < 1000 THEN 1 WHEN T.MAXSALARY BETWEEN 1000 AND 10000 THEN 0.76 ELSE 0.51 END AS TAX FROM ( SELECT COMPANY_ID, MAX(SALARY) AS MAXSALARY FROM SALARIES GROUP BY COMPANY_ID ) AS T ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND((S.SALARY * T.TAX),0) AS SALARY FROM SALARIES AS S JOIN T ON T.COMPANY_ID = S.COMPANY_ID"
325,Y,Y,"WITH TAX_RATE AS ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) > 1000 AND MAX(SALARY) < 10000 THEN 24/100 WHEN MAX(SALARY) > 10000 THEN 49/100 END AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID ) SELECT E.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY - SALARY*TAX_RATE) AS SALARY FROM SALARIES E JOIN TAX_RATE T ON E.COMPANY_ID = T.COMPANY_ID"
326,Y,Y,"WITH T1 AS ( SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY 1 ) SELECT A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME, ROUND(CASE WHEN MAX_SALARY < 1000 THEN SALARY WHEN MAX_SALARY BETWEEN 1000 AND 10000 THEN 0.76*SALARY WHEN MAX_SALARY > 10000 THEN 0.51 * SALARY END) AS SALARY FROM SALARIES A JOIN T1 B ON A.COMPANY_ID = B.COMPANY_ID"
327,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND((1-SUB.TAX_RATE)*S.SALARY) AS SALARY FROM SALARIES S JOIN ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) <= 10000 THEN 0.24 ELSE 0.49 END AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID ) SUB ON S.COMPANY_ID = SUB.COMPANY_ID"
328,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN A.MAX<1000 THEN ROUND(SALARY) WHEN A.MAX>=1000 AND A.MAX<10000 THEN ROUND(SALARY*0.76) WHEN A.MAX>10000 THEN ROUND(SALARY*0.51) END AS SALARY FROM (SELECT *, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX FROM SALARIES) A"
329,Y,Y,"SELECT S1.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND((SALARY - SALARY*TAX_RATE), 0) AS SALARY FROM SALARIES AS S1 JOIN (SELECT COMPANY_ID, (CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END) AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID) AS S2 ON S1.COMPANY_ID = S2.COMPANY_ID"
330,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND((CASE WHEN MS>10000 THEN SALARY*.51 WHEN MS>=1000 THEN SALARY*.76 ELSE SALARY END),0) AS SALARY FROM (SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MS FROM SALARIES) BS"
331,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND( CASE WHEN S.MAX_SAL <1000 THEN S.SALARY WHEN S.MAX_SAL > 10000 THEN S.SALARY * 0.51 ELSE S.SALARY * 0.76 END, 0) AS SALARY FROM (SELECT *, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX_SAL FROM SALARIES)S"
332,Y,Y,"WITH MMS AS ( SELECT COMPANY_ID, MAX(SALARY) AS MS FROM SALARIES GROUP BY 1 ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, CASE WHEN M.MS<1000 THEN ROUND(S.SALARY,0) WHEN M.MS BETWEEN 1000 AND 10000 THEN ROUND(0.76*S.SALARY,0) WHEN M.MS>10000 THEN ROUND(0.51*S.SALARY,0) END AS SALARY FROM SALARIES S JOIN MMS M ON M.COMPANY_ID = S.COMPANY_ID"
333,Y,Y,"WITH TEMP AS( SELECT COMPANY_ID , CASE WHEN MAX(SALARY) > 10000 THEN (1-0.49) WHEN MAX(SALARY) < 1000 THEN (1) ELSE (1-0.24) END AS RATES FROM SALARIES GROUP BY COMPANY_ID ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(T.RATES*S.SALARY ,0) SALARY FROM TEMP T RIGHT JOIN SALARIES S ON T.COMPANY_ID = S.COMPANY_ID"
334,Y,Y,"WITH A AS ( SELECT COMPANY_ID, MAX(SALARY) AS MX FROM SALARIES GROUP BY COMPANY_ID ), B AS ( SELECT COMPANY_ID, ( CASE WHEN MX < 1000 THEN 1 WHEN MX >= 1000 AND MX <= 10000 THEN 0.76 ELSE 0.51 END ) AS MULTIPLIER FROM A ) SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY*B.MULTIPLIER) AS SALARY FROM SALARIES S LEFT JOIN B ON S.COMPANY_ID = B.COMPANY_ID"
335,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX_SALARY<1000 THEN SALARY WHEN MAX_SALARY<=10000 THEN SALARY*0.76 ELSE SALARY*0.51 END,0) AS SALARY FROM( SELECT *, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) MAX_SALARY FROM SALARIES ) T"
336,Y,Y,"WITH TAX AS ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) BETWEEN 1000 AND 10000 THEN 24 WHEN MAX(SALARY) > 10000 THEN 49 END AS TAX FROM SALARIES GROUP BY 1 ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY - (S.SALARY * (T.TAX /100))) AS SALARY FROM SALARIES S JOIN TAX T ON S.COMPANY_ID = T.COMPANY_ID"
337,Y,Y,"SELECT A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME, ROUND((CASE WHEN MAX_SALARY <1000 THEN A.SALARY WHEN MAX_SALARY BETWEEN 1000 AND 10000 THEN A.SALARY*0.76 WHEN MAX_SALARY >10000 THEN A.SALARY*0.51 END),0) SALARY FROM SALARIES A INNER JOIN (SELECT COMPANY_ID, MAX(SALARY) MAX_SALARY FROM SALARIES GROUP BY 1 ) B ON A.COMPANY_ID=B.COMPANY_ID"
338,Y,Y,"WITH A AS ( SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY 1 ), B AS ( SELECT B.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX_SALARY FROM SALARIES B JOIN A ON A.COMPANY_ID = B.COMPANY_ID ) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX_SALARY < 1000 THEN SALARY WHEN MAX_SALARY BETWEEN 1000 AND 10000 THEN ROUND((SALARY - (24/100)*SALARY),0) WHEN MAX_SALARY > 10000 THEN ROUND((SALARY-(49/100)*SALARY),0) ELSE 0 END AS SALARY FROM B"
339,Y,Y,"WITH T1 AS( SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX_SALARY >= 1000 AND MAX_SALARY <= 10000 THEN ROUND(SALARY*(1-0.24), 0) WHEN MAX_SALARY > 10000 THEN ROUND(SALARY*(1-0.49), 0) ELSE SALARY END AS SALARY FROM T1"
340,Y,Y,"WITH CTE2 AS (SELECT COMPANY_ID,CASE WHEN MAX(SALARY) BETWEEN 1000 AND 10000 THEN 0.24 WHEN MAX(SALARY) > 10000 THEN 0.49 ELSE 0 END AS TAX_PERCENT FROM SALARIES GROUP BY COMPANY_ID) SELECT A.COMPANY_ID,A.EMPLOYEE_ID,A.EMPLOYEE_NAME,ROUND((A.SALARY-A.SALARY*TAX_PERCENT),0) AS SALARY FROM SALARIES A JOIN CTE2 C ON A.COMPANY_ID=C.COMPANY_ID"
341,Y,Y,"SELECT SAL.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND((SALARY* CASE WHEN MAX_SAL < 1000 THEN 1 WHEN MAX_SAL >= 1000 AND MAX_SAL <= 10000 THEN 0.76 ELSE 0.51 END),0) AS SALARY FROM SALARIES SAL LEFT JOIN (SELECT DISTINCT COMPANY_ID, MAX(SALARY) AS MAX_SAL FROM SALARIES GROUP BY 1)MX ON MX.COMPANY_ID = SAL.COMPANY_ID GROUP BY SAL.COMPANY_ID, EMPLOYEE_ID"
342,Y,Y,"SELECT COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME, CASE WHEN MAX_SALARY < 1000 THEN ROUND(1*SALARY,0) WHEN MAX_SALARY BETWEEN 1000 AND 10000 THEN ROUND(0.76*SALARY,0) ELSE ROUND(0.51*SALARY,0) END AS SALARY FROM (SELECT *,MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES) T"
343,Y,Y,"WITH CTE AS (SELECT *, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX_SAL FROM SALARIES) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX_SAL<1000 THEN SALARY WHEN MAX_SAL BETWEEN 1000 AND 10000 THEN SALARY*(1-0.24) WHEN MAX_SAL >10000 THEN SALARY*(1-0.49) END,0) AS SALARY FROM CTE"
344,Y,Y,"SELECT S2.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME , ROUND(CASE WHEN MX_SAL < 1000 THEN S2.SALARY WHEN MX_SAL >= 1000 AND MX_SAL <= 10000 THEN S2.SALARY- 0.24*S2.SALARY WHEN MX_SAL >10000 THEN S2.SALARY - 0.49 * S2.SALARY END,0) AS SALARY FROM SALARIES S2 JOIN (SELECT COMPANY_ID, MAX(SALARY) AS MX_SAL FROM SALARIES S1 GROUP BY COMPANY_ID) T1 ON T1.COMPANY_ID = S2.COMPANY_ID"
345,Y,Y,"WITH CTE AS ( SELECT COMPANY_ID, MAX(SALARY) MAX_SAL FROM SALARIES GROUP BY COMPANY_ID ) SELECT A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME, ROUND(( CASE WHEN B.MAX_SAL < 1000 THEN A.SALARY - 0*A.SALARY WHEN B.MAX_SAL >= 1000 AND B.MAX_SAL <= 10000 THEN A.SALARY - 0.24*A.SALARY WHEN B.MAX_SAL > 10000 THEN A.SALARY - 0.49*A.SALARY END ),0) AS SALARY FROM SALARIES A JOIN CTE B ON A.COMPANY_ID = B.COMPANY_ID"
346,Y,Y,"WITH CTE AS (SELECT *, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_S FROM SALARIES) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX_S < 1000 THEN SALARY WHEN MAX_S >= 1000 AND MAX_S <= 10000 THEN SALARY * (1-0.24) ELSE SALARY * (1-0.49) END,0) SALARY FROM CTE"
347,Y,Y,"SELECT A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME, CASE WHEN A.CALC <= 1000 THEN SALARY WHEN A.CALC > 10000 THEN ROUND(SALARY- (SALARY*.49),0) WHEN A.CALC BETWEEN 1000 AND 10000 THEN ROUND(SALARY- (SALARY*.24),0) ELSE 1 END AS SALARY FROM (SELECT COMPANY_ID , EMPLOYEE_ID,EMPLOYEE_NAME , SALARY, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS CALC FROM SALARIES)A"
348,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN SALARY * (1 - 0.24) ELSE SALARY * (1 - 0.49) END, 0) SALARY FROM SALARIES"
349,Y,Y,"WITH CTE AS ( SELECT COMPANY_ID,(CASE WHEN MAX(SALARY)<1000 THEN 0 WHEN MAX(SALARY)<=10000 AND MAX(SALARY)>=1000 THEN 0.24 WHEN MAX(SALARY)>10000 THEN 0.49 END) AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID ) SELECT S.COMPANY_ID,S.EMPLOYEE_ID,S.EMPLOYEE_NAME,ROUND((SALARY-SALARY*CTE.TAX_RATE)) AS SALARY FROM SALARIES S JOIN CTE ON CTE.COMPANY_ID=S.COMPANY_ID"
350,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY*(1-A.TAX_RATE),0) AS SALARY FROM SALARIES S JOIN (SELECT COMPANY_ID, IF(MAX(SALARY) < 1000, 0, IF(MAX(SALARY) > 10000, .49,.24)) AS TAX_RATE FROM SALARIES GROUP BY 1) A ON S.COMPANY_ID = A.COMPANY_ID"
351,Y,Y,"SELECT A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME, ROUND(A. SALARY - (A.SALARY * B.TAX_RATE), 0) AS SALARY FROM (SELECT * FROM SALARIES) A LEFT JOIN (SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) >= 1000 AND MAX(SALARY) <= 10000 THEN 0.24 ELSE 0.49 END AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID) B ON A.COMPANY_ID = B.COMPANY_ID"
352,Y,Y,"WITH TAX_RATE AS ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY)>10000 THEN (1-.49) WHEN MAX(SALARY)>=1000 AND MAX(SALARY)<=10000 THEN (1-.24) WHEN MAX(SALARY)<1000 THEN 1 END AS TAXRATE FROM SALARIES GROUP BY COMPANY_ID ORDER BY COMPANY_ID ) SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY*TAXRATE,0) AS SALARY FROM SALARIES S JOIN TAX_RATE T ON S.COMPANY_ID=T.COMPANY_ID ORDER BY S.COMPANY_ID, EMPLOYEE_ID"
353,Y,Y,"WITH CTE AS (SELECT *, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX_SALARY<1000 THEN SALARY WHEN MAX_SALARY BETWEEN 1000 AND 10000 THEN (SALARY - SALARY*0.24) WHEN MAX_SALARY>10000 THEN (SALARY - SALARY* 0.49) END, 0) AS SALARY FROM CTE"
354,Y,Y,"SELECT COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME, CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) > 10000 THEN ROUND(SALARY*(1-.49)) ELSE ROUND(SALARY*(1-0.24)) END AS SALARY FROM SALARIES"
355,Y,Y,"WITH MAX_SALARIES AS ( SELECT * ,MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES ) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX_SALARY<1000 THEN SALARY WHEN MAX_SALARY >= 1000 AND MAX_SALARY<10000 THEN ROUND(SALARY*0.76) WHEN MAX_SALARY > 10000 THEN ROUND(SALARY*0.51) ELSE NULL END AS SALARY FROM MAX_SALARIES"
356,Y,Y,"WITH B AS (SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID) SELECT A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME, ROUND(CASE WHEN B.MAX_SALARY < 1000 THEN A.SALARY WHEN B.MAX_SALARY > 10000 THEN A.SALARY*0.51 ELSE A.SALARY*0.76 END) AS SALARY FROM SALARIES AS A JOIN B USING(COMPANY_ID)"
357,Y,Y,"SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY*(1.00 - TAX_RATE), 0) AS SALARY FROM SALARIES S LEFT JOIN (SELECT COMPANY_ID, (CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) >= 1000 AND MAX(SALARY)<10000 THEN 0.24 ELSE 0.49 END) AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID ) AS T1 ON S.COMPANY_ID = T1.COMPANY_ID"
358,Y,Y,"WITH T1 AS ( SELECT COMPANY_ID , CASE WHEN MAX_SALARY < 1000 THEN 0 WHEN MAX_SALARY <= 10000 THEN 0.24 ELSE 0.49 END AS TAX FROM (SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY 1) T ) SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY * (1-TAX),0) AS SALARY FROM SALARIES S JOIN T1 ON S.COMPANY_ID = T1.COMPANY_ID ORDER BY COMPANY_ID"
359,Y,Y,"WITH CTE AS(SELECT COMPANY_ID,MAX(SALARY) MAX_SALARY FROM SALARIES GROUP BY 1) ,TAXY AS(SELECT S.COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME,SALARY, CASE WHEN MAX_SALARY < 1000 THEN 1 WHEN MAX_SALARY >= 1000 AND MAX_SALARY <= 10000 THEN 0.76 WHEN MAX_SALARY > 10000 THEN 0.51 END AS TAX FROM SALARIES S INNER JOIN CTE ON CTE.COMPANY_ID = S.COMPANY_ID) SELECT COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME,ROUND(SALARY*TAX,0)SALARY FROM TAXY"
360,Y,Y,"WITH CTE AS ( SELECT *, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX FROM SALARIES) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX<1000 THEN SALARY WHEN MAX BETWEEN 1000 AND 10000 THEN SALARY-.24*SALARY ELSE SALARY-.49*SALARY END) AS SALARY FROM CTE"
361,Y,Y,"WITH CTE1 AS( SELECT *, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAXX FROM SALARIES) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAXX<1000 THEN SALARY WHEN MAXX>=1000 AND MAXX<=10000 THEN ROUND(SALARY*(1-0.24),0) ELSE ROUND(SALARY*(1-0.49),0) END AS SALARY FROM CTE1"
362,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND( SALARY*(1-T.TAX_RATE) , 0) AS SALARY FROM SALARIES S JOIN ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) BETWEEN 1000 AND 10000 THEN 0.24 WHEN MAX(SALARY) > 10000 THEN 0.49 END AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID ) T ON S.COMPANY_ID = T.COMPANY_ID"
363,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY - TAX_RATE * SALARY) AS SALARY FROM SALARIES AS S JOIN (SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) <= 10000 THEN 0.24 WHEN MAX(SALARY) > 10000 THEN 0.49 END AS TAX_RATE FROM SALARIES GROUP BY 1) AS T USING(COMPANY_ID)"
364,Y,Y,"WITH MAX_SALARY AS ( SELECT DISTINCT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY 1 ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(CASE WHEN MAX_SALARY < 1000 THEN SALARY WHEN MAX_SALARY BETWEEN 1000 AND 10000 THEN SALARY*0.76 ELSE SALARY*0.51 END, 0 ) AS SALARY FROM SALARIES S LEFT JOIN MAX_SALARY M ON S.COMPANY_ID = M.COMPANY_ID"
365,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(SALARY - CASE WHEN HIGHEST < 1000 THEN 0 WHEN HIGHEST BETWEEN 1000 AND 10000 THEN SALARY*(24/100) WHEN HIGHEST > 10000 THEN SALARY*(49/100) END,0 ) AS SALARY FROM SALARIES S JOIN (SELECT COMPANY_ID, MAX(SALARY) AS HIGHEST FROM SALARIES GROUP BY COMPANY_ID) A ON S.COMPANY_ID = A.COMPANY_ID"
366,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) < 1000 THEN (SALARY - 0*SALARY) WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN (SALARY - 0.24*SALARY) ELSE (SALARY - 0.49*SALARY) END,0) AS SALARY FROM SALARIES"
367,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) <1000 THEN ROUND(SALARY) WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN ROUND(SALARY*0.76) ELSE ROUND(SALARY*0.51) END AS SALARY FROM SALARIES"
368,Y,Y,"WITH TAX_RATE AS ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) <= 10000 THEN 0.24 ELSE 0.49 END AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID) SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY * (1-TAX_RATE)) AS SALARY FROM SALARIES S INNER JOIN TAX_RATE TR ON S.COMPANY_ID = TR.COMPANY_ID"
369,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, (CASE WHEN TEMP.MAX_SALARY < 1000 THEN S.SALARY WHEN TEMP.MAX_SALARY > 10000 THEN ROUND(S.SALARY*(1-0.49), 0) ELSE ROUND(S.SALARY*(1-0.24), 0) END) AS SALARY FROM SALARIES S JOIN (SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID) TEMP USING (COMPANY_ID)"
370,Y,Y,"SELECT COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME, ROUND( CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN SALARY-(0.24*SALARY) ELSE SALARY-(0.49*SALARY) END,0) AS SALARY FROM SALARIES"
371,Y,Y,"WITH A1 AS( SELECT COMPANY_ID, MAX(SALARY) AS MAXSALA FROM SALARIES GROUP BY COMPANY_ID ) SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY * CASE WHEN MAXSALA<1000 THEN 1 WHEN MAXSALA>=1000 AND MAXSALA<=10000 THEN 0.76 WHEN MAXSALA>10000 THEN 0.51 END,0) AS SALARY FROM A1 RIGHT JOIN SALARIES S ON A1.COMPANY_ID = S.COMPANY_ID"
372,Y,Y,"WITH A AS(SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_SAL FROM SALARIES) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX_SAL<1000 THEN SALARY WHEN MAX_SAL BETWEEN 1000 AND 10000 THEN ROUND(0.76*SALARY) WHEN MAX_SAL>10000 THEN ROUND(0.51*SALARY) END AS SALARY FROM A"
373,Y,Y,"WITH C AS( SELECT COMPANY_ID, CASE WHEN MAX(SALARY)<1000 THEN 0 WHEN MAX(SALARY)>=1000 AND MAX(SALARY)<=10000 THEN 0.24 ELSE 0.49 END TAXRATE FROM SALARIES GROUP BY COMPANY_ID) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY*(1-TAXRATE),0) SALARY FROM SALARIES JOIN C USING(COMPANY_ID)"
374,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(CASE WHEN MAX_SALARY < 1000 THEN S.SALARY WHEN MAX_SALARY >= 1000 AND MAX_SALARY <= 10000 THEN S.SALARY*0.76 WHEN MAX_SALARY > 10000 THEN S.SALARY*0.51 END, 0) AS SALARY FROM SALARIES S LEFT JOIN (SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID) M ON S.COMPANY_ID = M.COMPANY_ID"
375,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) <1000 THEN SALARY WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) >10000 THEN ROUND(SALARY-(.49*SALARY)) ELSE ROUND(SALARY-(.24*SALARY)) END AS SALARY FROM SALARIES"
376,Y,Y,"WITH MAX_SALARY AS (SELECT COMPANY_ID, MAX(SALARY) AS M_SALARY FROM SALARIES GROUP BY 1) SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN M_SALARY < 1000 THEN SALARY WHEN M_SALARY >= 1000 AND M_SALARY <= 10000 THEN SALARY*(1-0.24) ELSE SALARY*(1-0.49) END) AS SALARY FROM SALARIES S LEFT JOIN MAX_SALARY M ON S.COMPANY_ID = M.COMPANY_ID"
377,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(CASE WHEN TEMP.MAX_SAL < 1000 THEN S.SALARY WHEN 999 < TEMP.MAX_SAL AND TEMP.MAX_SAL< 9999 THEN S.SALARY - S.SALARY*0.24 WHEN TEMP.MAX_SAL > 10000 THEN S.SALARY - S.SALARY*0.49 END,0) AS SALARY FROM (SELECT COMPANY_ID, MAX(SALARY) AS MAX_SAL FROM SALARIES GROUP BY COMPANY_ID ) AS TEMP JOIN SALARIES S ON TEMP.COMPANY_ID = S.COMPANY_ID"
378,Y,Y,"WITH ADJUSTED AS ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 1 WHEN MAX(SALARY) >= 1000 AND MAX(SALARY) <= 10000 THEN 0.76 WHEN MAX(SALARY) > 10000 THEN 0.51 END AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(A.TAX_RATE * S.SALARY, 0) AS SALARY FROM SALARIES AS S JOIN ADJUSTED AS A ON S.COMPANY_ID = A.COMPANY_ID"
379,Y,Y,"SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY*(1-TAX)) AS SALARY FROM SALARIES S JOIN ( SELECT COMPANY_ID, (CASE WHEN MAX(SALARY) <=1000 THEN 0 WHEN MAX(SALARY) >=10000 THEN 0.49 ELSE 0.24 END) AS TAX FROM SALARIES GROUP BY COMPANY_ID)T ON T.COMPANY_ID = S.COMPANY_ID"
380,Y,Y,"SELECT S1.COMPANY_ID,S1.EMPLOYEE_ID,S1.EMPLOYEE_NAME,ROUND((CASE WHEN MAX_SALARY <1000 THEN SALARY WHEN MAX_SALARY <=10000 THEN 0.76*SALARY ELSE 0.51*SALARY END ),0) AS SALARY FROM SALARIES S1 JOIN (SELECT COMPANY_ID,MAX(SALARY) MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID) S2 USING (COMPANY_ID)"
381,Y,Y,"WITH TAX AS ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 1 WHEN MAX(SALARY) <= 10000 THEN (1 - 0.24) ELSE (1 - 0.49) END AS NON_TAX_RATE FROM SALARIES GROUP BY COMPANY_ID ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY * T.NON_TAX_RATE) AS SALARY FROM SALARIES AS S JOIN TAX AS T ON S.COMPANY_ID = T.COMPANY_ID"
382,Y,Y,"SELECT S1.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN (MAXSAL >=1000 AND MAXSAL<=10000) THEN ROUND(SALARY-SALARY*0.24) WHEN MAXSAL > 10000 THEN ROUND(SALARY-SALARY*0.49) ELSE SALARY END AS SALARY FROM SALARIES S1 JOIN ( SELECT COMPANY_ID, MAX(SALARY) AS MAXSAL FROM SALARIES GROUP BY COMPANY_ID )S2 ON S1.COMPANY_ID = S2.COMPANY_ID"
383,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, (CASE WHEN T.MAXIMUM<1000 THEN ROUND(S.SALARY) WHEN T.MAXIMUM>=1000 AND T.MAXIMUM<=10000 THEN ROUND((1-0.24)*S.SALARY) ELSE ROUND((1-0.49)*S.SALARY) END) AS SALARY FROM SALARIES S LEFT JOIN (SELECT DISTINCT COMPANY_ID, MAX(SALARY)OVER(PARTITION BY COMPANY_ID) AS MAXIMUM FROM SALARIES)T ON S.COMPANY_ID=T.COMPANY_ID"
384,Y,Y,"WITH T1 AS ( SELECT COMPANY_ID , MAX(SALARY) AS COM_SALARY FROM SALARIES GROUP BY COMPANY_ID ), T2 AS ( SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, S.SALARY, CASE WHEN COM_SALARY < 1000 THEN 1.0 WHEN COM_SALARY >= 1000 AND COM_SALARY <= 10000 THEN (100-24)/100.0 WHEN COM_SALARY > 10000 THEN (100-49)/100.0 END AS ACTUAL_SAL_PERC FROM SALARIES S JOIN T1 ON S.COMPANY_ID = T1.COMPANY_ID ) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY * ACTUAL_SAL_PERC , 0) AS SALARY FROM T2"
385,Y,Y,"WITH TMP AS (SELECT *, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) MAX FROM SALARIES) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX < 1000 THEN ROUND(SALARY) WHEN MAX >= 1000 AND MAX < 10000 THEN ROUND(SALARY - SALARY * 0.24) ELSE ROUND(SALARY - SALARY * 0.49) END SALARY FROM TMP"
386,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) <1000 THEN SALARY WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN ROUND(SALARY*0.76) ELSE ROUND(SALARY*0.51) END AS SALARY FROM SALARIES"
387,Y,Y,"WITH MAXSALARIES AS ( SELECT COMPANY_ID, IF(MAX(SALARY) < 1000, 1, IF(MAX(SALARY) > 10000, 0.51, 0.76)) AS RATIO FROM SALARIES GROUP BY COMPANY_ID ) SELECT SALARIES.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY * RATIO, 0) AS SALARY FROM SALARIES JOIN MAXSALARIES ON MAXSALARIES.COMPANY_ID = SALARIES.COMPANY_ID"
388,Y,Y,"SELECT COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME, CASE WHEN A.MAX<1000 THEN ROUND(SALARY) WHEN A.MAX >=1000 AND A.MAX<=10000 THEN ROUND(SALARY*0.76) WHEN A.MAX>10000 THEN ROUND(SALARY*0.51) END AS SALARY FROM (SELECT *, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX FROM SALARIES) A"
389,Y,Y,"WITH MAXSALCOMP AS( SELECT COMPANY_ID ,MAX(SALARY) AS MAXSAL FROM SALARIES GROUP BY COMPANY_ID) SELECT S.COMPANY_ID ,S.EMPLOYEE_ID ,S.EMPLOYEE_NAME ,ROUND( S.SALARY* (CASE WHEN MS.MAXSAL < 1000 THEN 1 WHEN MS.MAXSAL BETWEEN 1000 AND 10000 THEN 0.76 ELSE 0.51 END) ) AS SALARY FROM SALARIES S JOIN MAXSALCOMP MS ON S.COMPANY_ID = MS.COMPANY_ID"
390,Y,Y,"WITH MAX_SALARY AS ( SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID), MAX_SALARY_JOIN AS( SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, S.SALARY, M.MAX_SALARY FROM SALARIES AS S LEFT JOIN MAX_SALARY AS M ON S.COMPANY_ID = M.COMPANY_ID) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX_SALARY < 1000 THEN SALARY WHEN MAX_SALARY >1000 AND MAX_SALARY<10000 THEN SALARY*0.76 ELSE SALARY * 0.51 END, 0) AS SALARY FROM MAX_SALARY_JOIN"
391,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID)<1000 THEN SALARY WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID)BETWEEN 1000 AND 10000 THEN ROUND((1-0.24) * SALARY ,0) ELSE ROUND((1-0.49)*SALARY,0) END AS SALARY FROM SALARIES"
392,Y,Y,"SELECT SALARIES.COMPANY_ID, SALARIES.EMPLOYEE_ID, SALARIES.EMPLOYEE_NAME, ROUND(SALARIES.SALARY * TAXES.TAX) AS SALARY FROM SALARIES JOIN ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN (1 - 0) WHEN (MAX(SALARY) >= 1000) AND (MAX(SALARY) <= 10000) THEN (1 - 0.24) ELSE (1 - 0.49) END AS TAX FROM SALARIES GROUP BY COMPANY_ID ) AS TAXES USING (COMPANY_ID)"
393,Y,Y,"SELECT A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME, ROUND(A.SALARY*(1-B.TAX_RATE), 0) SALARY FROM SALARIES A LEFT JOIN (SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END TAX_RATE FROM SALARIES GROUP BY COMPANY_ID) B ON A.COMPANY_ID = B.COMPANY_ID"
394,Y,Y,"WITH MAX_SAL_INCL AS ( SELECT *, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES ) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX_SALARY >= 1000 AND MAX_SALARY <= 10000 THEN ROUND(SALARY - (SALARY * .24), 0) WHEN MAX_SALARY > 10000 THEN ROUND(SALARY - (SALARY * .49), 0) ELSE SALARY END AS SALARY FROM MAX_SAL_INCL ORDER BY 1, 2"
395,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY_AFTER,0) AS SALARY FROM (SELECT *, CASE WHEN MAX_S < 1000 THEN SALARY WHEN MAX_S >= 1000 AND MAX_S <= 10000 THEN SALARY * 0.76 WHEN MAX_S > 10000 THEN SALARY * 0.51 END AS SALARY_AFTER FROM (SELECT *, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX_S FROM SALARIES) AS A) AS B"
396,Y,Y,"WITH CTE1 AS( SELECT COMPANY_ID, MAX(SALARY) AS MAXX FROM SALARIES GROUP BY COMPANY_ID) SELECT CTE1.COMPANY_ID,S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY - S.SALARY*0.49,0) AS SALARY FROM SALARIES S JOIN CTE1 ON S.COMPANY_ID = CTE1.COMPANY_ID WHERE MAXX > 10000 UNION SELECT CTE1.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY,0) AS SALARY FROM SALARIES S JOIN CTE1 ON S.COMPANY_ID = CTE1.COMPANY_ID WHERE MAXX < 1000 UNION SELECT CTE1.COMPANY_ID,S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY - S.SALARY*0.24,0) AS SALARY FROM SALARIES S JOIN CTE1 ON S.COMPANY_ID = CTE1.COMPANY_ID WHERE MAXX > 1000 AND MAXX < 10000"
397,Y,Y,"WITH CTE1 AS ( SELECT COMPANY_ID, EMPLOYEE_ID, CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) < 1000 THEN 1 WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) <= 10000 AND MAX(SALARY) OVER(PARTITION BY COMPANY_ID) >= 1000 THEN 0.76 WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) > 10000 THEN 0.51 END AS TAX FROM SALARIES) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY * TAX, 0) AS SALARY FROM SALARIES AS S JOIN CTE1 AS C1 USING(COMPANY_ID, EMPLOYEE_ID)"
398,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND ((CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) > 10000 THEN SALARY-SALARY*0.49 WHEN 1000 <= MAX(SALARY) OVER(PARTITION BY COMPANY_ID) <= 10000 THEN SALARY-SALARY*0.24 END ),0) AS SALARY FROM SALARIES S"
399,Y,Y,"WITH MAXSALARY AS( SELECT *, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND( (CASE WHEN MAX_SALARY<1000 THEN SALARY WHEN MAX_SALARY<=10000 THEN SALARY*(1-0.24) ELSE SALARY*(1-0.49) END) ,0) AS SALARY FROM MAXSALARY"
400,Y,Y,"SELECT SUB.COMPANY_ID, SUB.EMPLOYEE_ID, SUB.EMPLOYEE_NAME, ROUND(CASE WHEN SUB.MAX_SALARY < 1000 THEN SUB.SALARY WHEN SUB.MAX_SALARY > 10000 THEN SUB.SALARY*(1-0.49) ELSE SUB.SALARY*(1-0.24) END,0) AS SALARY FROM (SELECT *, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES) SUB"
401,Y,Y,"WITH TAX_TABLE AS ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0. WHEN MAX(SALARY) <= 10000 THEN 0.24 ELSE 0.49 END AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY * (1 - T.TAX_RATE)) AS SALARY FROM SALARIES S LEFT JOIN TAX_TABLE T ON S.COMPANY_ID = T.COMPANY_ID"
402,Y,Y,"WITH TAX AS (SELECT COMPANY_ID, CASE WHEN MAX(SALARY ) < 1000 THEN 0 WHEN MAX(SALARY) BETWEEN 1000 AND 10000 THEN 0.24 WHEN MAX(SALARY) > 10000 THEN 0.49 END AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME,ROUND(S.SALARY*(1-T.TAX_RATE),0) AS SALARY FROM SALARIES S LEFT JOIN TAX T ON S.COMPANY_ID = T.COMPANY_ID"
403,Y,Y,"WITH TAX_RATE AS ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(SALARY-SALARY*TAX_RATE, 0) AS SALARY FROM SALARIES S LEFT JOIN TAX_RATE T ON S.COMPANY_ID = T.COMPANY_ID"
404,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY*T.TAX, 0) AS SALARY FROM SALARIES S, (SELECT COMPANY_ID, (CASE WHEN 1000 <= MAX(SALARY) AND MAX(SALARY) <= 10000 THEN (1-0.24) WHEN MAX(SALARY) >= 10000 THEN (1-0.49) ELSE 1 END) AS TAX FROM SALARIES GROUP BY COMPANY_ID) AS T WHERE S.COMPANY_ID = T.COMPANY_ID"
405,Y,Y,"WITH MAX_COMPANY AS (SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, (CASE WHEN MC.MAX_SALARY < 1000 THEN S.SALARY*1 WHEN MC.MAX_SALARY BETWEEN 1000 AND 10000 THEN ROUND(S.SALARY*.76) WHEN MC.MAX_SALARY > 10000 THEN ROUND(S.SALARY*0.51) END) AS SALARY FROM SALARIES S LEFT JOIN MAX_COMPANY MC ON S.COMPANY_ID = MC.COMPANY_ID"
406,Y,Y,"WITH CTE AS (SELECT COMPANY_ID , CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) >= 1000 AND MAX(SALARY) <= 10000 THEN 0.24 ELSE 0.49 END AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID) SELECT S.COMPANY_ID , S.EMPLOYEE_ID , S.EMPLOYEE_NAME , ROUND((1-C.TAX_RATE)*SALARY) AS SALARY FROM CTE C INNER JOIN SALARIES S ON C.COMPANY_ID = S.COMPANY_ID"
407,Y,Y,"SELECT SALARIES.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARIES.SALARY * (1-TEMP.TAX_RATE),0) AS SALARY FROM (SELECT COMPANY_ID, IF(MAX(SALARY) < 1000,0, IF(MAX(SALARY) > 10000, 0.49, 0.24)) AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID) AS TEMP RIGHT JOIN SALARIES ON SALARIES.COMPANY_ID = TEMP.COMPANY_ID"
408,Y,Y,"WITH TEMP AS (SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAXSAL FROM SALARIES ) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAXSAL < 1000 THEN ROUND(SALARY) WHEN MAXSAL BETWEEN 1000 AND 10000 THEN ROUND(0.76*SALARY) WHEN MAXSAL>10000 THEN ROUND(0.51*SALARY) END AS SALARY FROM TEMP"
409,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX_SALARY<1000 THEN ROUND(SALARY*1) WHEN MAX_SALARY BETWEEN 1000 AND 10000 THEN ROUND(SALARY*.76) WHEN MAX_SALARY>10000 THEN ROUND(SALARY*.51) END AS SALARY FROM ( SELECT A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME, A.SALARY, B.MAX_SALARY FROM SALARIES A LEFT JOIN ( SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID ) B ON A.COMPANY_ID=B.COMPANY_ID) A"
410,Y,Y,"WITH CTE AS ( SELECT COMPANY_ID, MAX(SALARY) MAX_SAL FROM SALARIES GROUP BY COMPANY_ID ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND( CASE WHEN CTE.MAX_SAL BETWEEN 1000 AND 10000 THEN SALARY * 0.76 WHEN CTE.MAX_SAL > 10000 THEN SALARY * 0.51 ELSE SALARY END, 0) AS SALARY FROM SALARIES S INNER JOIN CTE ON S.COMPANY_ID = CTE.COMPANY_ID"
411,Y,Y,"WITH CTE AS ( SELECT *, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX_SALARY < 1000 THEN ROUND(SALARY,0) WHEN MAX_SALARY BETWEEN 1000 AND 10000 THEN ROUND(0.76*SALARY,0) WHEN MAX_SALARY > 10000 THEN ROUND(0.51*SALARY,0) END AS SALARY FROM CTE"
412,Y,Y,"WITH CTE AS ( SELECT COMPANY_ID, MAX(SALARY) MAX_SAL FROM SALARIES GROUP BY COMPANY_ID ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(CASE WHEN CTE.MAX_SAL < 1000 THEN SALARY WHEN CTE.MAX_SAL > 10000 THEN (SALARY - SALARY * 0.49) ELSE (SALARY - SALARY * 0.24) END, 0) AS SALARY FROM SALARIES S JOIN CTE ON S.COMPANY_ID = CTE.COMPANY_ID"
413,Y,Y,"WITH TAX AS ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) < 10000 THEN 0.24 ELSE 0.49 END AS TAX FROM SALARIES GROUP BY COMPANY_ID ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID , S.EMPLOYEE_NAME, ROUND(SALARY * (1-TAX), 0) AS SALARY FROM SALARIES S LEFT JOIN TAX T ON S.COMPANY_ID = T.COMPANY_ID"
414,Y,Y,"WITH MAX_SALARIES AS (SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) >= 1000 AND MAX(SALARY) <= 10000 THEN 0.24 WHEN MAX(SALARY) >= 10000 THEN 0.49 END AS TAX FROM SALARIES GROUP BY COMPANY_ID) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY*(1-M.TAX),0) AS SALARY FROM SALARIES S LEFT JOIN MAX_SALARIES M ON S.COMPANY_ID = M.COMPANY_ID"
415,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) > 10000 THEN SALARY * (1-.49) WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN SALARY * (1-.24) ELSE SALARY END,0) AS SALARY FROM SALARIES ORDER BY 1,2"
416,Y,Y,"SELECT COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME, CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID)>10000 THEN ROUND(SALARY-(SALARY*(49/100)) ,0) WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID)>1000 AND MAX(SALARY) OVER(PARTITION BY COMPANY_ID)<10000 THEN ROUND(SALARY-(SALARY*(24/100)),0) ELSE SALARY END AS SALARY FROM SALARIES"
417,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(SALARY*(1-TAXRATE),0) AS SALARY FROM SALARIES S JOIN (SELECT COMPANY_ID, (CASE WHEN MAX(SALARY)<1000 THEN 0 WHEN MAX(SALARY)<=10000 THEN 0.24 WHEN MAX(SALARY)>10000 THEN 0.49 END) AS TAXRATE FROM SALARIES GROUP BY COMPANY_ID) T ON S.COMPANY_ID = T.COMPANY_ID"
418,Y,Y,"WITH MAX_SAL_TABLE AS ( SELECT COMPANY_ID, MAX(SALARY) TOP_SAL FROM SALARIES GROUP BY 1 ), TAX_RATE AS( SELECT COMPANY_ID, TOP_SAL, CASE WHEN TOP_SAL < 1000 THEN 0.00 WHEN TOP_SAL BETWEEN 1000 AND 10000 THEN 24.00 WHEN TOP_SAL > 10000 THEN 49.00 END AS RATE FROM MAX_SAL_TABLE ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY*(1.00-T.RATE/100.00),0) SALARY FROM SALARIES S LEFT JOIN TAX_RATE T ON S.COMPANY_ID = T.COMPANY_ID"
419,Y,Y,"SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY*(1-BUCKET),0) AS SALARY FROM SALARIES S JOIN (SELECT COMPANY_ID, (CASE WHEN MAX(SALARY)<1000 THEN 0 WHEN MAX(SALARY)<=10000 THEN 0.24 WHEN MAX(SALARY)>10000 THEN 0.49 END) AS BUCKET FROM SALARIES GROUP BY COMPANY_ID) AS A ON S.COMPANY_ID=A.COMPANY_ID"
420,Y,Y,"WITH TAX_RATE AS ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) > 10000 THEN 0.49 WHEN MAX(SALARY) < 1000 THEN 0.0 ELSE 0.24 END AS TAX_RATE FROM SALARIES GROUP BY 1 ) SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(S.SALARY * (1 - T.TAX_RATE), 0) AS SALARY FROM SALARIES S JOIN TAX_RATE T ON S.COMPANY_ID = T.COMPANY_ID"
421,Y,Y,"WITH TAX AS ( SELECT COMPANY_ID, (CASE WHEN MAX(SALARY) < 1000 THEN 1.00 WHEN MAX(SALARY) <= 10000 THEN 0.76 ELSE 0.51 END) AS MULTIPLIER FROM SALARIES GROUP BY COMPANY_ID) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY * (SELECT MULTIPLIER FROM TAX WHERE TAX.COMPANY_ID = S.COMPANY_ID)) AS SALARY FROM SALARIES S"
422,Y,Y,"SELECT COMPANY_ID,EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) <= 10000 THEN ROUND(SALARY*0.76,0) ELSE ROUND(SALARY*0.51,0) END AS SALARY FROM SALARIES"
423,Y,Y,"SELECT A.COMPANY_ID, EMPLOYEE_ID,EMPLOYEE_NAME, ROUND(CASE WHEN MAX_SALARY < 1000 THEN SALARY WHEN MAX_SALARY >= 1000 AND MAX_SALARY <= 10000 THEN SALARY * (1-0.24) ELSE SALARY * (1-0.49) END) AS SALARY FROM (SELECT *, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES) AS A"
424,Y,Y,"WITH CTE AS ( SELECT DISTINCT COMPANY_ID, CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID)<1000 THEN 0 WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END AS TAX FROM SALARIES ) SELECT A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME, ROUND((A.SALARY - (A.SALARY*CTE.TAX)), 0) SALARY FROM CTE JOIN SALARIES A ON CTE.COMPANY_ID=A.COMPANY_ID"
425,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) > 10000 THEN SALARY-(SALARY*.49) ELSE SALARY-(SALARY*.24) END,0) SALARY FROM SALARIES"
426,Y,Y,"SELECT S.COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME, ROUND(SALARY*(1-RATE)) AS SALARY FROM SALARIES S JOIN (SELECT COMPANY_ID, IF(MAX(SALARY) < 1000,0,IF(MAX(SALARY) > 10000,0.49,0.24)) AS RATE FROM SALARIES GROUP BY COMPANY_ID) X ON S.COMPANY_ID = X.COMPANY_ID"
427,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(CASE WHEN A.SALARY<1000 THEN S.SALARY WHEN A.SALARY>10000 THEN 0.51*S.SALARY ELSE 0.76*S.SALARY END,0) AS SALARY FROM SALARIES S JOIN (SELECT COMPANY_ID, MAX(SALARY) AS SALARY FROM SALARIES GROUP BY COMPANY_ID) A ON S.COMPANY_ID = A.COMPANY_ID"
428,Y,Y,"WITH TAX_TABLE AS (SELECT COMPANY_ID, CASE WHEN MAX(SALARY)<1000 THEN 0 WHEN MAX(SALARY) BETWEEN 1000 AND 10000 THEN 0.24 WHEN MAX(SALARY)>10000 THEN 0.49 END AS TAX FROM SALARIES GROUP BY COMPANY_ID) SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY-TAX*SALARY) AS SALARY FROM SALARIES S JOIN TAX_TABLE T ON T.COMPANY_ID=S.COMPANY_ID"
429,Y,Y,"WITH P AS ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) > 10000 THEN 0.49 ELSE 0.24 END AS TAX FROM SALARIES GROUP BY 1 ) SELECT S.COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME, ROUND(SALARY -(TAX*SALARY)) AS SALARY FROM SALARIES S JOIN P ON S.COMPANY_ID = P.COMPANY_ID"
430,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY * RATE,0) AS SALARY FROM SALARIES LEFT JOIN (SELECT COMPANY_ID, (CASE WHEN MAX(SALARY) < 1000 THEN 1 WHEN MAX(SALARY) > 10000 THEN 0.51 ELSE 0.76 END) AS RATE FROM SALARIES GROUP BY COMPANY_ID) T USING (COMPANY_ID)"
431,Y,Y,"SELECT SALARIES.COMPANY_ID, SALARIES.EMPLOYEE_ID, SALARIES.EMPLOYEE_NAME, ROUND( CASE WHEN MAX_SALARY < 1000 THEN SALARY * (1 - 0) WHEN (MAX_SALARY >= 1000) AND (MAX_SALARY <= 10000) THEN SALARY * (1 - 0.24) ELSE SALARY * (1 - 0.49) END ) AS SALARY FROM SALARIES JOIN ( SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID ) AS COMPANYSALARIES USING (COMPANY_ID)"
432,Y,Y,"WITH C1 AS ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) <= 10000 AND MAX(SALARY) >= 1000 THEN 0.24 ELSE 0.49 END AS RATE FROM SALARIES GROUP BY COMPANY_ID ) SELECT S.COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME, ROUND(SALARY*(1-RATE),0) AS SALARY FROM SALARIES S LEFT JOIN C1 ON S.COMPANY_ID = C1.COMPANY_ID"
433,Y,Y,"SELECT S2.COMPANY_ID, EMPLOYEE_ID,EMPLOYEE_NAME ,ROUND(SALARY*TAX_RATE) AS SALARY FROM ((SELECT COMPANY_ID, (CASE WHEN MAX(SALARY) < 1000 THEN 1 WHEN MAX(SALARY) BETWEEN 1000 AND 10000 THEN 0.76 WHEN MAX(SALARY) > 10000 THEN 0.51 END ) AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID ) AS S1 JOIN SALARIES AS S2 USING(COMPANY_ID))"
434,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY*T.TAX_RATE,0) AS SALARY FROM SALARIES AS S JOIN (SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 1-0 WHEN MAX(SALARY) >= 1000 AND MAX(SALARY) <= 10000 THEN 1-0.24 ELSE 1-0.49 END TAX_RATE FROM SALARIES GROUP BY COMPANY_ID) AS T ON S.COMPANY_ID = T.COMPANY_ID"
435,Y,Y,"WITH COMPANY_TAX AS ( SELECT COMPANY_ID, SALARY, CASE WHEN SALARY < 1000 THEN 0 WHEN SALARY >= 1000 AND SALARY <= 10000 THEN 0.24 WHEN SALARY > 10000 THEN 0.49 ELSE NULL END AS TAX_RATE FROM SALARIES ) SELECT A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME, ROUND(A.SALARY - (A.SALARY*B.TAX_RATE),0) AS SALARY FROM SALARIES A LEFT JOIN (SELECT MAX(TAX_RATE) AS TAX_RATE, COMPANY_ID FROM COMPANY_TAX GROUP BY 2) B USING(COMPANY_ID)"
436,Y,Y,"WITH B AS (SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID) SELECT A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME, ROUND((CASE WHEN B.MAX_SALARY <1000 THEN A.SALARY WHEN B.MAX_SALARY<=10000 AND B.MAX_SALARY>=1000 THEN 0.76*A.SALARY ELSE 0.51*A.SALARY END)) AS SALARY FROM SALARIES A JOIN B ON A.COMPANY_ID=B.COMPANY_ID"
437,Y,Y,"WITH TAX AS( SELECT COMPANY_ID, MAX(SALARY) AS MAXSALARY FROM SALARIES GROUP BY 1 ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, CASE WHEN T.MAXSALARY < 1000 THEN SALARY * 1 WHEN T.MAXSALARY >=1000 AND T.MAXSALARY <= 10000 THEN ROUND(SALARY*0.76) WHEN T.MAXSALARY >10000 THEN ROUND(SALARY*0.51) END AS SALARY FROM SALARIES S JOIN TAX T ON S.COMPANY_ID = T.COMPANY_ID GROUP BY 1,2"
438,Y,Y,"WITH CTE AS( SELECT * , CASE WHEN SALARY < 1000 THEN 0 WHEN SALARY BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END AS TAX_PERCENT FROM (SELECT * , RANK() OVER (PARTITION BY COMPANY_ID ORDER BY SALARY DESC)R FROM SALARIES)A WHERE R=1 ) SELECT S.COMPANY_ID , S.EMPLOYEE_ID , S.EMPLOYEE_NAME , ROUND(S.SALARY - (S.SALARY*TAX_PERCENT),0) AS SALARY FROM SALARIES S JOIN CTE C ON S.COMPANY_ID = C.COMPANY_ID"
439,Y,Y,"WITH TAX_SLAB AS ( SELECT A.*, CASE WHEN MAX_SALARY < 1000 THEN 0 WHEN MAX_SALARY >= 1000 AND MAX_SALARY <= 10000 THEN 24 WHEN MAX_SALARY > 10000 THEN 49 END AS TAX_SLAB FROM ( SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY 1 ) A ORDER BY 1 ) SELECT A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME, ROUND(SALARY - (TAX_SLAB*SALARY/100)) AS SALARY FROM SALARIES A LEFT JOIN TAX_SLAB B ON A.COMPANY_ID = B.COMPANY_ID"
440,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID,EMPLOYEE_NAME ,ROUND( (CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN 0.76*SALARY WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) > 10000 THEN 0.51*SALARY END )) AS SALARY FROM SALARIES"
441,Y,Y,"WITH CTE AS ( SELECT *, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_SAL FROM SALARIES ) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX_SAL<1000 THEN SALARY WHEN MAX_SAL<10000 THEN ROUND(SALARY*(1-0.24),0) ELSE ROUND(SALARY*(1-0.49),0) END AS SALARY FROM CTE"
442,Y,Y,"WITH CTE AS( SELECT COMPANY_ID, CASE WHEN MAX(SALARY)<1000 THEN 0 WHEN MAX(SALARY)<10000 THEN .24 ELSE .49 END AS TAX FROM SALARIES GROUP BY COMPANY_ID) SELECT S.COMPANY_ID,S.EMPLOYEE_ID,S.EMPLOYEE_NAME,ROUND(S.SALARY*(1-CTE.TAX)) AS SALARY FROM SALARIES S JOIN CTE ON S.COMPANY_ID=CTE.COMPANY_ID"
443,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) > 10000 THEN SALARY-0.49*SALARY ELSE SALARY-0.24*SALARY END, 0) AS SALARY FROM SALARIES"
444,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) < 1000 THEN ROUND(SALARY,0) WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) > 10000 THEN ROUND(0.51*SALARY,0) ELSE ROUND(0.76*SALARY,0)END AS SALARY FROM SALARIES"
445,Y,Y,"WITH TAX_RATE AS ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 1 WHEN MAX(SALARY) < 10000 THEN 0.76 ELSE 0.51 END AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID ) SELECT A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME, ROUND(A.SALARY*B.TAX_RATE) AS SALARY FROM SALARIES A JOIN TAX_RATE B ON A.COMPANY_ID = B.COMPANY_ID"
446,Y,Y,"WITH A AS ( SELECT COMPANY_ID, MAX(SALARY) MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID ), B AS ( SELECT COMPANY_ID, CASE WHEN MAX_SALARY < 1000 THEN 0 WHEN MAX_SALARY <= 10000 THEN 0.24 ELSE 0.49 END TAX_RATE FROM A ) SELECT C.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY - SALARY * TAX_RATE) SALARY FROM SALARIES C JOIN B ON C.COMPANY_ID = B.COMPANY_ID"
447,Y,Y,"WITH TAX_RATE AS ( SELECT COMPANY_ID , CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) <= 10000 THEN 0.24 ELSE 0.49 END AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY * (1 - TR.TAX_RATE), 0) AS SALARY FROM SALARIES S LEFT JOIN TAX_RATE TR ON S.COMPANY_ID = TR.COMPANY_ID"
448,Y,Y,"WITH A AS (SELECT COMPANY_ID, CASE WHEN MAX(SALARY)<1000 THEN 0 WHEN MAX(SALARY)>=1000 AND MAX(SALARY)<=10000 THEN 0.24 WHEN MAX(SALARY)>10000 THEN 0.49 END AS RATE FROM SALARIES GROUP BY 1) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY * (1-A.RATE),0) AS SALARY FROM SALARIES S JOIN A ON S.COMPANY_ID=A.COMPANY_ID GROUP BY 1,2,3"
449,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN SALARY * 0.76 WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID)> 10000 THEN SALARY * 0.51 END, 0) AS SALARY FROM SALARIES"
450,Y,Y,"WITH CTE AS ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0.00 WHEN MAX(SALARY) > 10000 THEN 0.49 ELSE 0.24 END AS TAX_RATE FROM SALARIES GROUP BY 1 ) SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY * (1-TAX_RATE),0) AS SALARY FROM SALARIES S INNER JOIN CTE C ON S.COMPANY_ID = C.COMPANY_ID"
451,Y,Y,"SELECT SALARIES.COMPANY_ID, EMPLOYEE_ID,EMPLOYEE_NAME, CASE WHEN MAX_SALARY < 1000 THEN SALARY WHEN MAX_SALARY > 10000 THEN ROUND(SALARY*(1-0.49),0) ELSE ROUND(SALARY*(1-0.24),0) END AS SALARY FROM SALARIES, (SELECT COMPANY_ID,MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID) T1 WHERE SALARIES.COMPANY_ID = T1.COMPANY_ID"
452,Y,Y,"WITH CTE(COMPANY_ID, RATE) AS ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) BETWEEN 1000 AND 10000 THEN 0.24 WHEN MAX(SALARY) > 10000 THEN 0.49 ELSE 0 END FROM SALARIES GROUP BY COMPANY_ID ) SELECT SALARIES.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY*(1-RATE)) SALARY FROM SALARIES LEFT JOIN CTE ON SALARIES.COMPANY_ID=CTE.COMPANY_ID"
453,Y,Y,"WITH HIGHEST_SALARY AS ( SELECT *,MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX_SALARY_PER_COMPANY FROM SALARIES ), TAX_RATE AS ( SELECT *, CASE WHEN MAX_SALARY_PER_COMPANY < 1000 THEN 0 WHEN MAX_SALARY_PER_COMPANY BETWEEN 1000 AND 10000 THEN 0.24 WHEN MAX_SALARY_PER_COMPANY > 10000 THEN 0.49 END AS TAX_RATE FROM HIGHEST_SALARY ) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY - (TAX_RATE*SALARY)) AS SALARY FROM TAX_RATE"
454,Y,Y,"WITH MX AS ( SELECT COMPANY_ID, MAX(SALARY) AS MX FROM SALARIES GROUP BY 1), TAX AS (SELECT COMPANY_ID, CASE WHEN MX < 1000 THEN 0 WHEN MX>=1000 AND MX<=10000 THEN 0.24 WHEN MX>10000 THEN 0.49 END AS TAX_RATE FROM MX) SELECT A.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY*(1-TAX_RATE),0) AS SALARY FROM SALARIES A JOIN TAX B USING(COMPANY_ID)"
455,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(SALARY*(1-RATE),0) AS SALARY FROM SALARIES AS S JOIN ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) <1000 THEN 0 WHEN MAX(SALARY)>=1000 AND MAX(SALARY)<=10000 THEN 0.24 ELSE 0.49 END AS RATE FROM SALARIES GROUP BY COMPANY_ID) AS T ON S.COMPANY_ID = T.COMPANY_ID"
456,Y,Y,"WITH TAX_SAL AS ( SELECT MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX_SAL , COMPANY_ID FROM SALARIES ) SELECT DISTINCT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, CASE WHEN MAX_SAL < 1000 THEN ROUND(SALARY,0) WHEN MAX_SAL >= 100 AND MAX_SAL <=10000 THEN ROUND(SALARY*(1- 0.24),0) WHEN MAX_SAL > 10000 THEN ROUND(SALARY*(1-0.49),0) END AS SALARY FROM SALARIES S JOIN TAX_SAL T ON S.COMPANY_ID = T.COMPANY_ID"
457,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND((CASE WHEN MAX_SAL < 1000 THEN SALARY WHEN MAX_SAL BETWEEN 1000 AND 10000 THEN SALARY*(1 - 0.24) WHEN MAX_SAL > 10000 THEN SALARY*(1 - 0.49) END), 0) AS SALARY FROM (SELECT *, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX_SAL FROM SALARIES) S"
458,Y,Y,"WITH CTE1 AS (SELECT * FROM SALARIES) , CTE2 AS (SELECT COMPANY_ID , MAX(SALARY) AS M FROM SALARIES GROUP BY COMPANY_ID) SELECT CTE1.COMPANY_ID, CTE1.EMPLOYEE_ID, CTE1.EMPLOYEE_NAME , ROUND(CASE WHEN M<1000 THEN CTE1.SALARY WHEN M BETWEEN 1000 AND 10000 THEN CTE1.SALARY-.24*CTE1.SALARY ELSE CTE1.SALARY-.49*CTE1.SALARY END) AS SALARY FROM CTE1 JOIN CTE2 ON CTE1.COMPANY_ID=CTE2.COMPANY_ID"
459,Y,Y,"SELECT COMPANY_ID , EMPLOYEE_ID , EMPLOYEE_NAME , CASE WHEN (MAX(SALARY ) OVER (PARTITION BY COMPANY_ID )) >10000 THEN ROUND((SALARY -SALARY*49/100)) WHEN (MAX(SALARY ) OVER (PARTITION BY COMPANY_ID )) >=1000 AND (MAX(SALARY ) OVER (PARTITION BY COMPANY_ID )) <= 10000 THEN ROUND((SALARY -SALARY*24/100) ) ELSE SALARY END AS SALARY FROM SALARIES"
460,Y,Y,"WITH TEMP AS (SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY 1) SELECT SALARIES.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, (CASE WHEN MAX_SALARY < 1000 THEN ROUND(SALARY,0) WHEN MAX_SALARY >=1000 AND MAX_SALARY <=10000 THEN ROUND(SALARY-0.24*SALARY,0) ELSE ROUND(SALARY-0.49*SALARY,0) END) AS SALARY FROM SALARIES LEFT JOIN TEMP ON TEMP.COMPANY_ID = SALARIES.COMPANY_ID"
461,Y,Y,"WITH MUL AS (SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 1 WHEN 1000 <= MAX(SALARY) AND MAX(SALARY) <= 10000 THEN 0.76 ELSE 0.51 END MULTIPLIER FROM SALARIES GROUP BY COMPANY_ID) SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY*M.MULTIPLIER) SALARY FROM SALARIES S LEFT JOIN MUL M ON S.COMPANY_ID = M.COMPANY_ID"
462,Y,Y,"WITH T1 AS( SELECT COMPANY_ID, MAX(SALARY) HIGH FROM SALARIES GROUP BY COMPANY_ID ), T2 AS( SELECT COMPANY_ID, (CASE WHEN HIGH<1000 THEN 0 WHEN HIGH<=10000 AND HIGH>=1000 THEN 0.24 WHEN HIGH>10000 THEN 0.49 END) AS TAX FROM T1 ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY*(1-T2.TAX), 0) SALARY FROM SALARIES S LEFT JOIN T2 ON S.COMPANY_ID=T2.COMPANY_ID"
463,Y,Y,"WITH TMP AS (SELECT COMPANY_ID ,EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES) SELECT COMPANY_ID ,EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX_SALARY <1000 THEN SALARY WHEN MAX_SALARY > 10000 THEN SALARY*0.51 ELSE SALARY*0.76 END, 0) AS SALARY FROM TMP"
464,Y,Y,"SELECT C.COMPANY_ID,C.EMPLOYEE_ID, C.EMPLOYEE_NAME, CASE WHEN C.MAX_SALARY > 10000 THEN ROUND(C.SALARY - (49/ 100) * C.SALARY) WHEN C.MAX_SALARY >= 1000 AND C.MAX_SALARY <= 10000 THEN ROUND(C.SALARY - (24/ 100) * C.SALARY) WHEN C.MAX_SALARY < 1000 THEN ROUND(C.SALARY - (0/ 100) * C.SALARY) END AS SALARY FROM (SELECT A.*, B.MAX_SALARY FROM SALARIES AS A INNER JOIN (SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID) AS B ON A.COMPANY_ID=B.COMPANY_ID ) AS C"
465,Y,Y,"SELECT S1.COMPANY_ID , EMPLOYEE_ID , EMPLOYEE_NAME,CAST((SALARY- (SALARY*TAX)) AS UNSIGNED) AS SALARY FROM SALARIES S1 LEFT JOIN (SELECT COMPANY_ID, CASE WHEN MAX(SALARY)<1000 THEN 0 WHEN MAX(SALARY)>=1000 AND MAX(SALARY)<=10000 THEN 24/100 WHEN MAX(SALARY)>10000 THEN 49/100 END AS TAX FROM SALARIES GROUP BY COMPANY_ID) S2 ON S1.COMPANY_ID=S2.COMPANY_ID"
466,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND((CASE WHEN A.MAXSALARY < 1000 THEN S.SALARY WHEN A.MAXSALARY BETWEEN 1000 AND 10000 THEN S.SALARY - (24/100)*S.SALARY WHEN A.MAXSALARY > 10000 THEN S.SALARY-(49/100)*S.SALARY END),0) AS SALARY FROM SALARIES S LEFT JOIN (SELECT COMPANY_ID, MAX(SALARY) AS MAXSALARY FROM SALARIES GROUP BY COMPANY_ID) AS A ON A.COMPANY_ID = S.COMPANY_ID"
467,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, (CASE WHEN A.MAX < 1000 THEN ROUND(SALARY) WHEN A.MAX BETWEEN 1000 AND 10000 THEN ROUND(SALARY * 0.76) ELSE ROUND(SALARY * 0.51) END ) AS SALARY FROM (SELECT *, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX FROM SALARIES) A"
468,Y,Y,"WITH TAX_RATE AS ( SELECT DISTINCT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END AS TAX_RATE FROM SALARIES GROUP BY 1 ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(SALARY-SALARY*TAX_RATE, 0) AS SALARY FROM SALARIES S LEFT JOIN TAX_RATE T ON S.COMPANY_ID = T.COMPANY_ID"
469,N,N,"WITH TAX_PER_COMP AS (SELECT COMPANY_ID, CASE WHEN MAX_COMPANY_SALARY<1000 THEN 0 WHEN ((MAX_COMPANY_SALARY>=1000) &AMP; (MAX_COMPANY_SALARY<=10000)) THEN .24 WHEN MAX_COMPANY_SALARY>10000 THEN .49 END AS TAX_PERC FROM (SELECT COMPANY_ID,MAX(SALARY) AS MAX_COMPANY_SALARY FROM SALARIES GROUP BY COMPANY_ID) A ) SELECT T.COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME,ROUND((SALARY-SALARY*TAX_PERC),0) AS SALARY FROM SALARIES E INNER JOIN TAX_PER_COMP T ON E.COMPANY_ID=T.COMPANY_ID"
470,Y,Y,"SELECT COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME,(CASE WHEN MAX_SALARY < 1000 THEN SALARY WHEN MAX_SALARY>=1000 AND MAX_SALARY <=10000 THEN ROUND(.76*SALARY,0) ELSE ROUND(.51*SALARY,0) END) AS SALARY FROM ( SELECT COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME,SALARY,MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES)X"
471,Y,Y,"WITH CTE AS( SELECT MAX(SALARY) AS MAX_SALARY, COMPANY_ID FROM SALARIES GROUP BY COMPANY_ID) SELECT SALARIES.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX_SALARY < 1000 THEN SALARY WHEN MAX_SALARY BETWEEN 1000 AND 10000 THEN ROUND(SALARY*(1-0.24),0) WHEN MAX_SALARY > 10000 THEN ROUND(SALARY*(1-0.49),0) END AS SALARY FROM SALARIES INNER JOIN CTE ON CTE.COMPANY_ID = SALARIES.COMPANY_ID"
472,Y,Y,"WITH M AS ( SELECT COMPANY_ID, MAX(SALARY) MAX_SAL FROM SALARIES GROUP BY 1 ) SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY * CASE WHEN MAX_SAL<1000 THEN 1 WHEN MAX_SAL BETWEEN 1000 AND 10000 THEN (1-0.24) WHEN MAX_SAL > 10000 THEN (1-0.49) END,0) AS SALARY FROM SALARIES S JOIN M ON S.COMPANY_ID=M.COMPANY_ID"
473,Y,Y,"WITH TAX_RATE AS ( SELECT COMPANY_ID, CASE WHEN MAX_SALARY < 1000 THEN 0 WHEN MAX_SALARY >= 1000 AND MAX_SALARY <= 10000 THEN 0.24 WHEN MAX_SALARY > 10000 THEN 0.49 END AS TAX_RATE FROM (SELECT COMPANY_ID,MAX(SALARY) MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID)A) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY * (1-T.TAX_RATE),0) AS SALARY FROM SALARIES S JOIN TAX_RATE T ON S.COMPANY_ID = T.COMPANY_ID"
474,Y,Y,"SELECT COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME, CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) <1000 THEN SALARY WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID ) >10000 THEN ROUND(SALARY*(1-.49)) ELSE ROUND(SALARY*(1-.24)) END AS SALARY FROM SALARIES"
475,Y,Y,"WITH TAX AS (SELECT COMPANY_ID, (CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) <= 10000 THEN 0.24 ELSE 0.49 END) TAX_RATE FROM SALARIES GROUP BY COMPANY_ID) SELECT SALARIES.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY * (1 - TAX_RATE)) SALARY FROM SALARIES JOIN TAX ON SALARIES.COMPANY_ID = TAX.COMPANY_ID"
476,Y,Y,"WITH MAX1 AS ( SELECT *, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS M1 FROM SALARIES ) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN M1 < 1000 THEN SALARY WHEN M1 BETWEEN 1000 AND 10000 THEN SALARY*0.76 ELSE SALARY*0.51 END, 0) AS SALARY FROM MAX1"
477,Y,Y,"WITH TAX AS (SELECT *, CASE WHEN MAX(SALARY)<1000 THEN 0 WHEN 1000<= MAX(SALARY) AND MAX(SALARY)<10000 THEN 0.24 WHEN 10000<= MAX(SALARY) THEN 0.49 END AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID) SELECT A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME, ROUND(A.SALARY*(1-B.TAX_RATE),0) AS SALARY FROM SALARIES A LEFT JOIN TAX B ON A.COMPANY_ID=B.COMPANY_ID"
478,Y,Y,"WITH CTE AS( SELECT *, CASE WHEN A.MAX_SALARY < 1000 THEN 0 WHEN A.MAX_SALARY BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END AS TAX_RATE FROM (SELECT *, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES) A ) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY * (1 - TAX_RATE), 0) AS SALARY FROM CTE"
479,Y,Y,"SELECT S1.COMPANY_ID, EMPLOYEE_ID,EMPLOYEE_NAME, CASE WHEN MSAL<1000 THEN SALARY WHEN MSAL>= 1000 AND MSAL<=10000 THEN ROUND(SALARY*0.76) WHEN MSAL>10000 THEN ROUND(SALARY*0.51) END AS SALARY FROM SALARIES S1 LEFT JOIN (SELECT COMPANY_ID,MAX(SALARY) AS MSAL FROM SALARIES GROUP BY COMPANY_ID) S2 ON S1.COMPANY_ID=S2.COMPANY_ID"
480,Y,Y,"WITH C1 AS(SELECT COMPANY_ID, MAX(SALARY) MAX_SAL FROM SALARIES GROUP BY 1), C2 AS(SELECT COMPANY_ID, CASE WHEN MAX_SAL<1000 THEN 0 WHEN MAX_SAL BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END AS TAX_RATE FROM C1) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY*(1-TAX_RATE),0) AS SALARY FROM SALARIES LEFT JOIN C2 USING(COMPANY_ID)"
481,Y,Y,"WITH CTE AS( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 1 WHEN MAX(SALARY) > 10000 THEN 0.51 ELSE 0.76 END AS TAX FROM SALARIES GROUP BY COMPANY_ID ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY*TAX,0) AS SALARY FROM SALARIES S INNER JOIN CTE ON S.COMPANY_ID = CTE.COMPANY_ID"
482,Y,Y,"WITH CTE AS (SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY 1) SELECT A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME, (CASE WHEN B.MAX_SALARY < 1000 THEN SALARY WHEN (B.MAX_SALARY >= 1000) AND (B.MAX_SALARY <= 10000) THEN ROUND(SALARY * (1 - 0.24)) ELSE ROUND(SALARY * (1-0.49)) END) AS SALARY FROM SALARIES A JOIN CTE B ON A.COMPANY_ID = B.COMPANY_ID"
483,Y,Y,"WITH TEMP AS ( SELECT COMPANY_ID, MAX(SALARY) AS M FROM SALARIES GROUP BY COMPANY_ID) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(CASE WHEN T.M < 1000 THEN S.SALARY WHEN T.M BETWEEN 1000 AND 10000 THEN S.SALARY - S.SALARY * (24/100) WHEN T.M > 10000 THEN S.SALARY - S.SALARY * (49/100) END) AS SALARY FROM SALARIES S JOIN TEMP T ON S.COMPANY_ID = T.COMPANY_ID GROUP BY S.COMPANY_ID, S.EMPLOYEE_ID"
484,Y,Y,"WITH TB2 AS ( SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) < 1000 THEN 0 WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) <= 10000 THEN 0.24 ELSE 0.49 END AS TAX_RATE FROM SALARIES) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY * (1-TAX_RATE),0) AS SALARY FROM TB2"
485,Y,Y,"SELECT COMPANY_ID,EMPLOYEE_ID, EMPLOYEE_NAME, (CASE WHEN X.MAX <1000 THEN ROUND(SALARY) WHEN X.MAX BETWEEN 1000 AND 10000 THEN ROUND(0.76*SALARY) WHEN X.MAX >10000 THEN ROUND(0.51*SALARY) END)AS SALARY FROM (SELECT *, MAX(SALARY)OVER(PARTITION BY COMPANY_ID)AS MAX FROM SALARIES )AS X"
486,Y,Y,"WITH CTE AS ( SELECT *, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MX_SALARY FROM SALARIES ) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MX_SALARY < 1000 THEN SALARY WHEN MX_SALARY BETWEEN 1000 AND 10000 THEN ROUND(SALARY * 0.76) ELSE ROUND(SALARY * 0.51) END AS SALARY FROM CTE"
487,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME , CASE WHEN A.MAX_SALARY < 1000 THEN SALARY WHEN A.MAX_SALARY>= 1000 AND A.MAX_SALARY <=10000 THEN ROUND(SALARY*(1-0.24), 0) ELSE ROUND(SALARY*(1-0.49),0) END AS SALARY FROM( SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID) AS A JOIN SALARIES AS S ON A.COMPANY_ID = S.COMPANY_ID"
488,Y,Y,"WITH CTE AS ( SELECT COMPANY_ID , EMPLOYEE_ID , EMPLOYEE_NAME , SALARY , MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MSAL FROM SALARIES) SELECT COMPANY_ID , EMPLOYEE_ID , EMPLOYEE_NAME ,CASE WHEN MSAL < 1000 THEN SALARY WHEN MSAL>=1000 AND MSAL<=10000 THEN ROUND(SALARY * 0.76 , 0) WHEN MSAL>10000 THEN ROUND(SALARY * 0.51,0) END AS SALARY FROM CTE"
489,Y,Y,"WITH CTE AS ( SELECT COMPANY_ID, CASE WHEN M < 1000 THEN 0 WHEN M>10000 THEN 0.49 ELSE 0.24 END AS TAX_RATE FROM (SELECT COMPANY_ID, MAX(SALARY) AS M FROM SALARIES GROUP BY 1) T ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY*(1-CTE.TAX_RATE)) AS SALARY FROM SALARIES S INNER JOIN CTE ON CTE.COMPANY_ID = S.COMPANY_ID"
490,Y,Y,"SELECT A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME, ROUND(A.SALARY-A.SALARY*B.TAX_RATE,0) AS SALARY FROM SALARIES A LEFT JOIN ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY)<1000 THEN 0 WHEN MAX(SALARY) BETWEEN 1000 AND 10000 THEN 0.24 WHEN MAX(SALARY) >10000 THEN 0.49 END AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID )B ON A.COMPANY_ID=B.COMPANY_ID"
491,Y,Y,"WITH CTE1 AS ( SELECT A.*, B.MS FROM SALARIES A LEFT JOIN ( SELECT COMPANY_ID, MAX(SALARY) AS MS FROM SALARIES GROUP BY 1 ) B ON A.COMPANY_ID = B.COMPANY_ID ) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME , ROUND ( ( CASE WHEN MS<1000 THEN SALARY WHEN (MS>=1000 AND MS<=10000) THEN (SALARY - SALARY*0.24) WHEN MS>10000 THEN (SALARY - SALARY*0.49) END )) AS SALARY FROM CTE1"
492,Y,Y,"WITH A AS ( SELECT COMPANY_ID, IF(MAX(SALARY) <1000, 0, IF(MAX(SALARY) >=1000 AND MAX(SALARY)<=10000, 0.24, 0.49)) AS RATE FROM SALARIES GROUP BY COMPANY_ID ) SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY*(1-A.RATE)) AS SALARY FROM SALARIES AS S, A WHERE S.COMPANY_ID = A.COMPANY_ID"
493,Y,Y,"SELECT S.COMPANY_ID,S.EMPLOYEE_ID,S.EMPLOYEE_NAME, ROUND(CASE WHEN S1.MAXI < 1000 THEN SALARY WHEN S1.MAXI BETWEEN 1000 AND 10000 THEN 0.76*SALARY WHEN S1.MAXI > 10000 THEN 0.51*SALARY END) AS SALARY FROM SALARIES S INNER JOIN (SELECT COMPANY_ID , MAX(SALARY) AS MAXI FROM SALARIES GROUP BY 1 ORDER BY 1) S1 ON S.COMPANY_ID = S1.COMPANY_ID"
494,Y,Y,"WITH CTE AS (SELECT COMPANY_ID , MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID) SELECT S.COMPANY_ID , S.EMPLOYEE_ID , S.EMPLOYEE_NAME , ROUND(CASE WHEN MAX_SALARY < 1000 THEN SALARY WHEN MAX_SALARY BETWEEN 1000 AND 10000 THEN SALARY - (0.24*SALARY) ELSE SALARY - (0.49*SALARY) END,0) AS SALARY FROM SALARIES S JOIN CTE C ON C.COMPANY_ID = S.COMPANY_ID"
495,Y,Y,"SELECT COMPANY_ID , EMPLOYEE_ID , EMPLOYEE_NAME , ROUND(CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID)<= 10000 AND MAX(SALARY) OVER (PARTITION BY COMPANY_ID) >= 1000 THEN (SALARY-(SALARY*24/100)) ELSE (SALARY - (SALARY*49/100)) END ) AS SALARY FROM SALARIES"
496,Y,Y,"SELECT COMPANY_ID ,EMPLOYEE_ID ,EMPLOYEE_NAME ,ROUND(CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) < 10000 THEN 0.76 * SALARY ELSE 0.51 * SALARY END , 0) AS SALARY FROM SALARIES"
497,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(CASE WHEN MAX_SALARY < 1000 THEN S.SALARY WHEN MAX_SALARY >= 1000 AND MAX_SALARY <= 10000 THEN S.SALARY*(1-0.24) WHEN MAX_SALARY > 10000 THEN S.SALARY*(1-0.49) END, 0) AS SALARY FROM SALARIES AS S, (SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID) AS A WHERE S.COMPANY_ID = A.COMPANY_ID"
498,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY * (1-TAX_RATE),0) AS SALARY FROM SALARIES JOIN (SELECT COMPANY_ID, (CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) BETWEEN 1000 AND 10000 THEN 0.24 WHEN MAX(SALARY) > 10000 THEN 0.49 END) AS TAX_RATE FROM SALARIES GROUP BY 1) T USING(COMPANY_ID)"
499,Y,Y,"WITH A AS ( SELECT COMPANY_ID, MAX(SALARY) AS MS FROM SALARIES GROUP BY 1) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, CASE WHEN MS<1000 THEN ROUND(SALARY) WHEN MS >=1000 AND MS <= 10000 THEN ROUND(SALARY*(1-0.24)) WHEN MS>10000 THEN ROUND(SALARY*(1-0.49)) END AS SALARY FROM SALARIES S JOIN A ON S.COMPANY_ID = A.COMPANY_ID"
500,Y,Y,"SELECT COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME, CASE WHEN A.MAX<1000 THEN ROUND(SALARY) WHEN A.MAX BETWEEN 1000 AND 10000 THEN ROUND(SALARY*0.76) WHEN A.MAX>10000 THEN ROUND(SALARY*0.51) END AS SALARY FROM (SELECT *, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX FROM SALARIES) A"
501,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX_SALARY < 1000 THEN ROUND(SALARY - (0/100)*SALARY) WHEN MAX_SALARY BETWEEN 1000 AND 10000 THEN ROUND(SALARY - (24/100)*SALARY) WHEN MAX_SALARY > 10000 THEN ROUND(SALARY - (49/100)*SALARY) END AS SALARY FROM ( SELECT *, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES)A"
502,Y,Y,"WITH MS AS ( SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAXS FROM SALARIES ) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAXS > 10000 THEN ROUND(SALARY*0.51) WHEN MAXS >= 1000 THEN ROUND(SALARY*0.76) WHEN MAXS < 1000 THEN SALARY END AS SALARY FROM MS"
503,Y,Y,"WITH CTE_TAX_RATE AS (SELECT S.COMPANY_ID, CASE WHEN MAX(S.SALARY) < 1000 THEN 1 WHEN MAX(S.SALARY) BETWEEN 1000 AND 10000 THEN 0.76 ELSE 0.51 END AS TAX FROM SALARIES AS S GROUP BY S.COMPANY_ID) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY * (SELECT C.TAX FROM CTE_TAX_RATE AS C WHERE S.COMPANY_ID = C.COMPANY_ID), 0) AS SALARY FROM SALARIES AS S"
504,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND((CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID)<1000 THEN SALARY WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN SALARY-SALARY*0.24 ELSE SALARY-SALARY*0.49 END),0) AS SALARY FROM SALARIES"
505,Y,Y,"WITH MS AS (SELECT COMPANY_ID, MAX(SALARY) MS FROM SALARIES GROUP BY 1) SELECT S.COMPANY_ID,EMPLOYEE_ID, EMPLOYEE_NAME, ROUND((CASE WHEN M.MS<1000 THEN SALARY WHEN (M.MS >=1000 AND M.MS<= 10000) THEN (76*SALARY)/100 ELSE (51*SALARY)/100 END),0) AS SALARY FROM SALARIES S JOIN MS M ON S.COMPANY_ID=M.COMPANY_ID"
506,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, (CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) < 1000 THEN ROUND(SALARY) WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN ROUND(SALARY-(SALARY*0.24)) ELSE ROUND(SALARY-(SALARY*0.49)) END) AS SALARY FROM SALARIES"
507,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX_SALARY < 1000 THEN SALARY WHEN MAX_SALARY > 10000 THEN ROUND(SALARY*(1-0.49)) ELSE ROUND(SALARY*(1-0.24)) END AS SALARY FROM (SELECT *, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES) SUB"
508,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN SALARY - (0.24 * SALARY) ELSE SALARY - (0.49*SALARY ) END,0) AS SALARY FROM SALARIES ORDER BY COMPANY_ID, EMPLOYEE_ID"
509,Y,Y,"WITH MAX_SAL AS ( SELECT COMPANY_ID,MAX(SALARY) AS MSAL FROM SALARIES GROUP BY COMPANY_ID) SELECT S.COMPANY_ID ,S.EMPLOYEE_ID ,S.EMPLOYEE_NAME ,ROUND(CASE WHEN M.MSAL<1000 THEN S.SALARY WHEN M.MSAL>=1000 AND M.MSAL<=10000 THEN S.SALARY-(0.24*S.SALARY) WHEN M.MSAL>10000 THEN S.SALARY-(0.49*S.SALARY) END,0) AS SALARY FROM SALARIES S LEFT JOIN MAX_SAL M ON S.COMPANY_ID = M.COMPANY_ID"
510,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) < 1000 THEN ROUND(SALARY) WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) > 10000 THEN ROUND(SALARY * (1-0.49)) ELSE ROUND(SALARY * (1-0.24)) END AS SALARY FROM SALARIES"
511,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) > 10000 THEN ROUND(SALARY - SALARY * 0.49, 0) WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) > 1000 THEN ROUND(SALARY - SALARY * 0.24, 0) ELSE SALARY END AS SALARY FROM SALARIES"
512,Y,Y,"SELECT S.COMPANY_ID,S.EMPLOYEE_ID,S.EMPLOYEE_NAME, ROUND(CASE WHEN MS > 10000 THEN S.SALARY-(S.SALARY * 0.49) WHEN MS >= 1000 AND MS <= 10000 THEN S.SALARY-(S.SALARY * 0.24) ELSE S.SALARY-(S.SALARY * 0) END,0) AS SALARY FROM SALARIES S JOIN (SELECT COMPANY_ID,MAX(SALARY) AS MS FROM SALARIES GROUP BY COMPANY_ID) T1 ON S.COMPANY_ID = T1.COMPANY_ID"
513,Y,Y,"SELECT T.COMPANY_ID, T.EMPLOYEE_ID, T.EMPLOYEE_NAME, CASE WHEN T.MAX_SALARY < 1000 THEN SALARY WHEN T.MAX_SALARY > 10000 THEN ROUND((1-0.49)*SALARY) ELSE ROUND((1-0.24)*SALARY) END AS SALARY FROM ( SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES ) T"
514,Y,Y,"WITH TEMP AS ( SELECT *, CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) <1000 THEN 0 WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END AS TAX_RATE FROM SALARIES ) SELECT COMPANY_ID,EMPLOYEE_ID ,EMPLOYEE_NAME, ROUND(SALARY*(1-TAX_RATE)) AS SALARY FROM TEMP"
515,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID)<1000 THEN SALARY WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID)>=1000 AND MAX(SALARY) OVER(PARTITION BY COMPANY_ID)<=10000 THEN ROUND((SALARY - SALARY*0.24)) WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) > 10000 THEN ROUND((SALARY - SALARY*0.49)) ELSE SALARY END AS SALARY FROM SALARIES"
516,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) > 10000 THEN SALARY-(SALARY*0.49) ELSE SALARY -(SALARY*0.24) END,0) AS SALARY FROM SALARIES"
517,Y,Y,"WITH CTE AS (SELECT DISTINCT COMPANY_ID, (CASE WHEN (MAX(SALARY) OVER (PARTITION BY COMPANY_ID))<1000 THEN 0 WHEN (MAX(SALARY) OVER (PARTITION BY COMPANY_ID))>10000 THEN 0.49 ELSE 0.24 END) AS PERC FROM SALARIES ) SELECT CTE.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY*(1-PERC)) AS SALARY FROM CTE JOIN SALARIES ON CTE.COMPANY_ID=SALARIES.COMPANY_ID"
518,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX(SALARY)OVER(PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY)OVER(PARTITION BY COMPANY_ID) <=10000 THEN SALARY*(1-0.24) ELSE SALARY*(1-0.49) END,0) AS SALARY FROM SALARIES"
519,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) > 10000 THEN ROUND((SALARY-SALARY*0.49),0) WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN ROUND((SALARY-SALARY*0.24),0) WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) < 1000 THEN ROUND((SALARY),0) END AS SALARY FROM SALARIES"
520,Y,Y,"WITH CTE1 AS ( SELECT COMPANY_ID,MAX(SALARY) AS MAX_SAL FROM SALARIES GROUP BY COMPANY_ID ), CTE2 AS( SELECT COMPANY_ID AS CID, CASE WHEN MAX_SAL<1000 THEN 0 WHEN MAX_SAL>=1000 AND MAX_SAL<=10000 THEN 24 ELSE 49 END AS INTREST FROM CTE1 ) SELECT COMPANY_ID, EMPLOYEE_ID,EMPLOYEE_NAME,ROUND(SALARY-((SALARY*INTREST)/100)) AS SALARY FROM SALARIES LEFT JOIN CTE2 ON CTE2.CID=COMPANY_ID"
521,Y,Y,"WITH COMPANY_TAX_RATE AS ( SELECT A.COMPANY_ID, CASE WHEN A.MAX_SALARY < 1000 THEN 0 WHEN A.MAX_SALARY BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END AS TAX_RATE FROM ( SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY 1 ) A ) SELECT A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME, ROUND(A.SALARY - A.SALARY * B.TAX_RATE,0) AS SALARY FROM SALARIES A LEFT JOIN COMPANY_TAX_RATE B ON A.COMPANY_ID = B.COMPANY_ID"
522,Y,Y,"WITH T1 AS ( SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY, CASE WHEN MAX(SALARY) <1000 THEN 0 WHEN MAX(SALARY)>=1000 AND MAX(SALARY)<=10000 THEN 0.24 ELSE 0.49 END AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY * (1-T1.TAX_RATE),0) AS SALARY FROM T1 INNER JOIN SALARIES S ON S.COMPANY_ID = T1.COMPANY_ID"
523,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY - (S.SALARY*TAX),0) AS SALARY FROM SALARIES S JOIN( SELECT SALARIES.*, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) >1000 AND MAX(SALARY) < 10000 THEN 0.24 ELSE 0.49 END AS TAX FROM SALARIES GROUP BY COMPANY_ID)SUB ON S.COMPANY_ID = SUB.COMPANY_ID"
524,Y,Y,"WITH T1 AS ( SELECT *, MAX(SALARY) OVER(PARTITION BY COMPANY_ID ORDER BY COMPANY_ID) MX FROM SALARIES ) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MX < 1000 THEN SALARY WHEN MX BETWEEN 1000 AND 9999 THEN SALARY - (SALARY*0.24) WHEN MX > 10000 THEN SALARY - (SALARY*0.49) END) AS SALARY FROM T1 ORDER BY 1,2"
525,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN SUM_COMPANY < 1000 THEN SALARY WHEN SUM_COMPANY BETWEEN 1000 AND 10000 THEN SALARY * 0.76 WHEN SUM_COMPANY > 10000 THEN SALARY * 0.51 END,0) SALARY FROM( SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) SUM_COMPANY FROM SALARIES) ASD"
526,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY - SALARY*RATE, 0) AS SALARY FROM (SELECT *, CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) <1000 THEN 0 WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END AS RATE FROM SALARIES)T"
527,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND( CASE WHEN MAX(SALARY) OVER ( PARTITION BY COMPANY_ID) <1000 THEN SALARY WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) >10000 THEN SALARY*(1-.49) ELSE SALARY*(1-.24) END,0) AS SALARY FROM SALARIES"
528,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX_SALARY < 1000 THEN SALARY WHEN MAX_SALARY >=1000 AND MAX_SALARY < 10000 THEN (SALARY*0.76) WHEN MAX_SALARY > 10000 THEN (SALARY*0.51) END) AS SALARY FROM (SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES) A"
529,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, (CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) >= 1000 AND MAX(SALARY) OVER (PARTITION BY COMPANY_ID) <= 10000 THEN ROUND(SALARY * (1-0.24), 0) ELSE ROUND(SALARY * (1-0.49), 0) END) AS SALARY FROM SALARIES"
530,Y,Y,"SELECT SALARIES.COMPANY_ID AS COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY*(1-TAX_RATE),0) AS SALARY FROM SALARIES LEFT JOIN (SELECT COMPANY_ID, CASE WHEN MAX(SALARY)<1000 THEN 0 WHEN MAX(SALARY)>10000 THEN 0.49 ELSE 0.24 END AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID) TAX_RATES ON SALARIES.COMPANY_ID=TAX_RATES.COMPANY_ID"
531,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY * A.RATIO, 0) SALARY FROM SALARIES JOIN (SELECT COMPANY_ID, (CASE WHEN MAX(SALARY) < 1000 THEN 1 WHEN MAX(SALARY) <= 10000 AND MAX(SALARY) >= 1000 THEN .76 ELSE .51 END) RATIO FROM SALARIES GROUP BY 1 ) A USING(COMPANY_ID)"
532,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) >= 1000 AND MAX(SALARY) OVER (PARTITION BY COMPANY_ID) <= 10000 THEN 0.76*SALARY WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) > 10000 THEN 0.51*MAX(SALARY) END) SALARY FROM SALARIES GROUP BY 1,2,3"
533,Y,Y,"WITH CTE AS ( SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX(SALARY)OVER(PARTITION BY COMPANY_ID) AS MAX_SALARY_COMPANY FROM SALARIES ) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX_SALARY_COMPANY < 1000 THEN SALARY WHEN MAX_SALARY_COMPANY BETWEEN 1000 AND 10000 THEN 0.76*SALARY WHEN MAX_SALARY_COMPANY > 10000 THEN 0.51*SALARY END) AS SALARY FROM CTE"
534,Y,Y,"WITH MAX_S AS ( SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX(SALARY)OVER(PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES ), TAX AS ( SELECT *, CASE WHEN MAX_SALARY < 1000 THEN 0 WHEN MAX_SALARY BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END AS TAX_RATE FROM MAX_S ) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY * (1-TAX_RATE),0) AS SALARY FROM TAX"
535,Y,Y,"WITH CTE AS ( SELECT DISTINCT COMPANY_ID, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES ) SELECT SALARIES.COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME, ROUND(CASE WHEN MAX_SALARY < 1000 THEN SALARY WHEN MAX_SALARY >= 1000 AND MAX_SALARY <= 10000 THEN SALARY - (0.24*SALARY) ELSE SALARY - (0.49*SALARY) END,0) AS SALARY FROM SALARIES LEFT JOIN CTE ON CTE.COMPANY_ID = SALARIES.COMPANY_ID"
536,Y,Y,"WITH TEMP AS ( SELECT *, CASE WHEN MAX_SAL <1000 THEN 1.0 WHEN MAX_SAL >=1000 AND MAX_SAL <= 10000 THEN 0.76 ELSE 0.51 END AS RATE FROM (SELECT COMPANY_ID, MAX(SALARY) AS MAX_SAL FROM SALARIES GROUP BY COMPANY_ID)T) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME,ROUND(S.SALARY*TEMP.RATE,0) AS SALARY FROM SALARIES S JOIN TEMP ON S.COMPANY_ID = TEMP.COMPANY_ID"
537,Y,Y,"WITH A AS( SELECT COMPANY_ID, CASE WHEN MAX(SALARY)<1000 THEN 0 WHEN MAX(SALARY)>10000 THEN 0.49 ELSE 0.24 END AS TAX FROM SALARIES GROUP BY 1) SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY*(1-TAX),0) AS SALARY FROM SALARIES S LEFT JOIN A ON S.COMPANY_ID=A.COMPANY_ID"
538,Y,Y,"SELECT COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME, ROUND(CASE WHEN MAX(SALARY) OVER(PARTITION BY(COMPANY_ID)) < 1000 THEN SALARY WHEN MAX(SALARY) OVER(PARTITION BY(COMPANY_ID)) BETWEEN 1000 AND 10000 THEN 0.76*SALARY WHEN MAX(SALARY) OVER(PARTITION BY(COMPANY_ID)) > 10000 THEN 0.51*SALARY END,0) AS SALARY FROM SALARIES"
539,Y,Y,"SELECT A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME, ROUND(CASE WHEN B.MAXSAL > 10000 THEN 0.51*A.SALARY WHEN B.MAXSAL > 1000 THEN 0.76*A.SALARY ELSE A.SALARY END) AS SALARY FROM SALARIES AS A LEFT JOIN (SELECT COMPANY_ID, MAX(SALARY) AS MAXSAL FROM SALARIES GROUP BY COMPANY_ID) AS B ON A.COMPANY_ID = B.COMPANY_ID"
540,Y,Y,"SELECT SALARIES.COMPANY_ID, SALARIES.EMPLOYEE_ID, SALARIES.EMPLOYEE_NAME, ROUND(SALARIES.SALARY * (1-T1.TAX_RATE),0) AS SALARY FROM SALARIES INNER JOIN ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) >= 1000 AND MAX(SALARY) <= 10000 THEN 0.24 ELSE 0.49 END AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID) T1 USING(COMPANY_ID)"
541,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND( (CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) >= 1000 AND MAX(SALARY) OVER (PARTITION BY COMPANY_ID) <= 10000 THEN SALARY * (1-0.24) WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) > 10000 THEN SALARY * (1-0.49) END), 0) AS SALARY FROM SALARIES"
542,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN (MAX(SALARY) OVER (PARTITION BY COMPANY_ID))<1000 THEN SALARY WHEN (MAX(SALARY) OVER (PARTITION BY COMPANY_ID))<=10000 THEN ROUND(SALARY * (1-0.24),0) ELSE ROUND(SALARY * (1-0.49),0) END AS SALARY FROM SALARIES"
543,Y,Y,"WITH Q AS ( SELECT CASE WHEN MAX(SALARY) < 1000 THEN 0.0 WHEN MAX(SALARY) >= 1000 AND MAX(SALARY) <= 10000 THEN 0.24 WHEN MAX(SALARY) > 10000 THEN 0.49 END AS PERCENTAGE_SALARY, MAX(SALARY) AS MAX_SALARY, COMPANY_ID FROM SALARIES GROUP BY COMPANY_ID ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY - (S.SALARY * Q.PERCENTAGE_SALARY) , 0) AS SALARY FROM SALARIES S INNER JOIN Q ON S.COMPANY_ID = Q.COMPANY_ID"
544,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) < 1000 THEN ROUND(SALARY,0) WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN ROUND(SALARY - (SALARY*0.24),0) WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) > 10000 THEN ROUND(SALARY - (SALARY*0.49),0) END AS SALARY FROM SALARIES"
545,Y,Y,"WITH CTE AS ( SELECT COMPANY_ID, MAX(SALARY ) AS MAX_SALARY FROM SALARIES GROUP BY 1 ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, CASE WHEN CT.MAX_SALARY < 1000 THEN S.SALARY WHEN CT.MAX_SALARY BETWEEN 1000 AND 10000 THEN ROUND(S.SALARY -(24/100) * S.SALARY,0) WHEN CT.MAX_SALARY > 10000 THEN ROUND(S.SALARY - (49/100) * S.SALARY,0) END AS SALARY FROM SALARIES S JOIN CTE CT ON S.COMPANY_ID = CT.COMPANY_ID"
546,Y,Y,"WITH RATES AS ( (SELECT MAX(SALARY) AS MAX_SALARY, COMPANY_ID FROM SALARIES GROUP BY COMPANY_ID) ) SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX_SALARY <1000 THEN SALARY WHEN MAX_SALARY >=1000 AND MAX_SALARY <=10000 THEN SALARY*(1-0.24) WHEN MAX_SALARY > 10000 THEN SALARY*(1-0.49) END,0) AS SALARY FROM SALARIES S LEFT JOIN RATES R ON S.COMPANY_ID = R.COMPANY_ID"
547,Y,Y,"WITH COMPANY_TAX_RATE AS ( SELECT COMPANY_ID , CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) >= 1000 AND MAX(SALARY) < 10000 THEN 24 WHEN MAX(SALARY) >= 10000 THEN 49 ELSE NULL END AS TAX_RATE FROM SALARIES GROUP BY 1 ) SELECT A.COMPANY_ID , EMPLOYEE_ID , EMPLOYEE_NAME , ROUND((1 - TAX_RATE/ 100) * SALARY) AS SALARY FROM SALARIES A JOIN COMPANY_TAX_RATE B ON A.COMPANY_ID = B.COMPANY_ID"
548,Y,Y,"SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND ( CASE WHEN MAX_SALARY > 10000 THEN 0.51 * SALARY WHEN MAX_SALARY BETWEEN 1000 AND 10000 THEN 0.76 * SALARY ELSE SALARY END ) AS SALARY FROM SALARIES S, ( SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID ) AS M WHERE S.COMPANY_ID = M.COMPANY_ID"
549,Y,Y,"WITH TEMP AS ( SELECT COMPANY_ID, MAX(SALARY) AS MSAL FROM SALARIES GROUP BY COMPANY_ID ) SELECT A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME, CASE WHEN MSAL<1000 THEN ROUND(SALARY,0) WHEN MSAL>=1000 AND MSAL<=10000 THEN ROUND(SALARY - .24*SALARY,0) ELSE ROUND(SALARY - .49*SALARY,0) END AS SALARY FROM SALARIES A JOIN TEMP B ON A.COMPANY_ID=B.COMPANY_ID"
550,Y,Y,"WITH CTE1 AS ( SELECT *, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX_SALARY < 1000 THEN SALARY WHEN MAX_SALARY BETWEEN 1000 AND 10000 THEN SALARY*(1-.24) ELSE SALARY*(1-.49) END,0) AS SALARY FROM CTE1"
551,Y,Y,"WITH CTE AS (SELECT COMPANY_ID, MAX(SALARY) AS MAXSL FROM SALARIES GROUP BY COMPANY_ID) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, CASE WHEN M.MAXSL<1000 THEN S.SALARY WHEN M.MAXSL>=1000 AND M.MAXSL<=10000 THEN ROUND(S.SALARY*(1-0.24), 0) ELSE ROUND(S.SALARY*(1-0.49), 0) END AS SALARY FROM SALARIES S LEFT JOIN CTE M USING(COMPANY_ID)"
552,Y,Y,"WITH M_S AS (SELECT COMPANY_ID, MAX(SALARY) AS M_SALARY FROM SALARIES GROUP BY COMPANY_ID), MPP AS (SELECT A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME, A.SALARY,B.M_SALARY FROM SALARIES A JOIN M_S B ON A.COMPANY_ID=B.COMPANY_ID) SELECT COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME, CASE WHEN M_SALARY<1000 THEN 1*SALARY WHEN M_SALARY>10000 THEN ROUND(0.51*SALARY,0) ELSE ROUND(0.76*SALARY,0) END AS SALARY FROM MPP"
553,Y,Y,"SELECT COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME, CASE WHEN A.MAX <1000 THEN ROUND(SALARY) WHEN A.MAX >= 1000 AND A.MAX<=10000 THEN ROUND(0.76*SALARY) WHEN A.MAX>10000 THEN ROUND (0.51*SALARY) END AS SALARY FROM (SELECT *, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX FROM SALARIES) A"
554,Y,Y,"WITH TAX_CTE AS (SELECT COMPANY_ID, MAX(SALARY), (CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) <= 10000 THEN 24 WHEN MAX(SALARY) > 10000 THEN 49 END) AS TAX FROM SALARIES GROUP BY COMPANY_ID) SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND((S.SALARY*(100-TAX)/100), 0) AS SALARY FROM SALARIES S LEFT JOIN TAX_CTE T ON S.COMPANY_ID = T.COMPANY_ID"
555,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND (CASE WHEN MAX_SALARY < 1000 THEN SALARY WHEN MAX_SALARY <=10000 THEN 0.76*SALARY ELSE 0.51*SALARY END) SALARY FROM ( SELECT *, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) MAX_SALARY FROM SALARIES) A"
556,Y,Y,"WITH CTE AS (SELECT COMPANY_ID, CASE WHEN MAX(SALARY)<1000 THEN 0 WHEN MAX(SALARY) BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END AS TAXRATE FROM SALARIES GROUP BY COMPANY_ID ) SELECT A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME, ROUND(A.SALARY*(1-B.TAXRATE)) AS SALARY FROM SALARIES A JOIN CTE B ON A.COMPANY_ID = B.COMPANY_ID"
557,Y,Y,"WITH A AS (SELECT *,MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_SAL FROM SALARIES) SELECT COMPANY_ID,EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN A.MAX_SAL < 1000 THEN SALARY WHEN A.MAX_SAL BETWEEN 1000 AND 10000 THEN ROUND(SALARY*0.76) WHEN A.MAX_SAL > 10000 THEN ROUND(SALARY*0.51) END AS SALARY FROM A"
558,Y,Y,"SELECT COMPANY_ID,EMPLOYEE_ID , EMPLOYEE_NAME, (CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) >= 1000 AND MAX(SALARY) OVER(PARTITION BY COMPANY_ID) <=10000 THEN ROUND(SALARY*(1-.24)) WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) > 10000 THEN ROUND(SALARY*(1-.49)) END )AS SALARY FROM SALARIES"
559,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, CASE WHEN MX < 1000 THEN S.SALARY WHEN MX <= 10000 THEN ROUND(S.SALARY*0.76) ELSE ROUND(S.SALARY*0.51) END AS SALARY FROM SALARIES S LEFT JOIN (SELECT COMPANY_ID, MAX(SALARY) AS MX FROM SALARIES GROUP BY COMPANY_ID) T ON S.COMPANY_ID = T.COMPANY_ID"
560,Y,Y,"WITH BASE AS ( SELECT *, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES ) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX_SALARY < 1000 THEN SALARY WHEN MAX_SALARY BETWEEN 1000 AND 10000 THEN SALARY * (1-0.24) WHEN MAX_SALARY > 10000 THEN SALARY * (1-0.49) END, 0) AS SALARY FROM BASE"
561,Y,Y,"WITH CTE AS ( SELECT MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS COMP , COMPANY_ID , SALARY, EMPLOYEE_ID, EMPLOYEE_NAME FROM SALARIES ) SELECT COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME,CASE WHEN COMP < 1000 THEN ROUND(SALARY) WHEN COMP BETWEEN 1000 AND 10000 THEN ROUND(SALARY - ((SALARY * 24)/100)) WHEN COMP > 10000 THEN ROUND(SALARY - ((SALARY * 49)/ 100)) ELSE ROUND(SALARY) END AS SALARY FROM CTE"
562,Y,Y,"WITH TEMP AS (SELECT COMPANY_ID, CASE WHEN MAX(S1.SALARY) < 1000 THEN 0 WHEN MAX(S1.SALARY) >= 1000 AND MAX(S1.SALARY) <= 10000 THEN 0.24 WHEN MAX(S1.SALARY) > 10000 THEN 0.49 END AS TAX FROM SALARIES S1 GROUP BY COMPANY_ID) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY * (1-TEMP.TAX),0) AS SALARY FROM SALARIES S RIGHT JOIN TEMP ON S.COMPANY_ID = TEMP.COMPANY_ID ORDER BY COMPANY_ID ASC, EMPLOYEE_ID ASC"
563,Y,Y,"WITH A AS (SELECT *, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) MS FROM SALARIES) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MS<1000 THEN ROUND(SALARY) WHEN MS>=1000 AND MS<=10000 THEN ROUND(SALARY*(1-0.24)) WHEN MS>10000 THEN ROUND(SALARY*(1-0.49)) END AS SALARY FROM A"
564,Y,Y,"WITH T0 AS (SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID), T1 AS ( SELECT *, CASE WHEN MAX_SALARY < 1000 THEN 0.0 WHEN MAX_SALARY > 10000 THEN .49 ELSE .24 END AS TAX FROM T0) SELECT SALARIES.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY - (TAX*SALARY)) AS SALARY FROM SALARIES JOIN T1 ON SALARIES.COMPANY_ID = T1.COMPANY_ID"
565,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND( CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) > 10000 THEN SALARY - SALARY * 0.49 ELSE SALARY - SALARY * 0.24 END ) SALARY FROM SALARIES"
566,Y,Y,"WITH S AS ( SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES ), S2 AS ( SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, CASE WHEN MAX_SALARY < 1000 THEN 0 WHEN MAX_SALARY BETWEEN 1000 AND 10000 THEN 24 ELSE 49 END AS TAX_RATE FROM S ) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY * (1 - TAX_RATE/100),0) AS SALARY FROM S2"
567,Y,Y,"WITH CTE AS ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) > 10000 THEN 0.49 ELSE 0.24 END AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(SALARY*(1-CTE.TAX_RATE)) AS SALARY FROM SALARIES S INNER JOIN CTE ON S.COMPANY_ID = CTE.COMPANY_ID"
568,Y,Y,"WITH T1 AS ( SELECT DISTINCT COMPANY_ID, CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) < 1000 THEN 100 WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) > 10000 THEN 51 ELSE 76 END AS RATE FROM SALARIES ) SELECT SALARIES.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY * RATE / 100) AS SALARY FROM SALARIES LEFT OUTER JOIN T1 ON SALARIES.COMPANY_ID = T1.COMPANY_ID"
569,Y,Y,"WITH T1 AS( SELECT *, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX_SALARY < 1000 THEN SALARY WHEN MAX_SALARY >= 1000 AND MAX_SALARY <= 10000 THEN ROUND(SALARY * 0.76, 0) WHEN MAX_SALARY > 10000 THEN ROUND(SALARY * 0.51, 0) END AS SALARY FROM T1"
570,Y,Y,"WITH COMPANY_TAX AS ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) > 10000 THEN 0.49 ELSE 0.24 END AS TAX_RATE FROM SALARIES GROUP BY 1) SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY - (SALARY*TAX_RATE), 0) AS SALARY FROM SALARIES S INNER JOIN COMPANY_TAX CT ON S.COMPANY_ID = CT.COMPANY_ID"
571,Y,Y,"WITH TMP AS ( SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, S.SALARY, CASE WHEN SMAX.MAX_SALARY < 1000 THEN 1 WHEN SMAX.MAX_SALARY BETWEEN 1000 AND 10000 THEN 0.76 ELSE 0.51 END AS TAX_RATE FROM SALARIES S LEFT JOIN (SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID ) SMAX ON S.COMPANY_ID = SMAX.COMPANY_ID ) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY*TAX_RATE,0) SALARY FROM TMP"
572,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY - (S.SALARY*S1.VAT), 0) AS SALARY FROM SALARIES S LEFT JOIN ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) BETWEEN 1000 AND 10000 THEN 0.24 WHEN MAX(SALARY) > 10000 THEN 0.49 END AS VAT FROM SALARIES GROUP BY COMPANY_ID ) S1 ON S.COMPANY_ID=S1.COMPANY_ID ORDER BY 1, 2"
573,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(CASE WHEN T.MAX_SALARY < 1000 THEN SALARY WHEN T.MAX_SALARY > 10000 THEN SALARY - 0.49 * SALARY ELSE SALARY - 0.24 * SALARY END, 0) AS SALARY FROM SALARIES S JOIN ( SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID ) T ON S.COMPANY_ID = T.COMPANY_ID"
574,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND( CASE WHEN MAX(SALARY)OVER(PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY)OVER(PARTITION BY COMPANY_ID) > 10000 THEN SALARY * .51 ELSE SALARY * .76 END) AS SALARY FROM SALARIES"
575,Y,Y,"WITH CTE AS ( SELECT * , ROUND((CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN SALARY*0.76 WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) > 10000 THEN SALARY*0.51 ELSE NULL END)) AS FINAL_SALARY FROM SALARIES ) SELECT COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME,FINAL_SALARY AS SALARY FROM CTE ORDER BY 1,2,4"
576,Y,Y,"SELECT A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME, ROUND((CASE WHEN MAX_SALARY < 1000 THEN SALARY WHEN MAX_SALARY BETWEEN 1000 AND 10000 THEN (1-0.24)*SALARY ELSE (1-0.49)*SALARY END),0) AS SALARY FROM SALARIES A INNER JOIN (SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID) B ON A.COMPANY_ID = B.COMPANY_ID"
577,Y,Y,"WITH CTE AS (SELECT *, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX_SALARY < 1000 THEN SALARY WHEN MAX_SALARY >= 1000 AND MAX_SALARY <= 10000 THEN SALARY*0.76 ELSE SALARY*0.51 END, 0) AS SALARY FROM CTE"
578,Y,Y,"SELECT T1.COMPANY_ID, T1.EMPLOYEE_ID, T1.EMPLOYEE_NAME, ROUND(T1.SALARY * (1 -T2._RATE),0) SALARY FROM SALARIES T1 LEFT JOIN ( SELECT COMPANY_ID, MAX(SALARY) _MAX, CASE WHEN MAX(SALARY) < 1000 THEN 0.00 WHEN MAX(SALARY) BETWEEN 1000 AND 10000 THEN 0.24 WHEN MAX(SALARY) > 10000 THEN 0.49 END _RATE FROM SALARIES GROUP BY 1 ) T2 ON T1.COMPANY_ID = T2.COMPANY_ID"
579,Y,Y,"SELECT DISTINCT COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME, CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN ROUND(SALARY*(1-.24)) WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) > 10000 THEN ROUND(SALARY*(1-.49)) END AS SALARY FROM SALARIES"
580,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY * (1-T.TAX),0) AS SALARY FROM SALARIES S JOIN (SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) >= 1000 AND MAX(SALARY) <= 10000 THEN .24 ELSE .49 END AS TAX FROM SALARIES GROUP BY 1) T ON S.COMPANY_ID = T.COMPANY_ID"
581,Y,Y,"SELECT X.COMPANY_ID,X.EMPLOYEE_ID,X.EMPLOYEE_NAME,ROUND(X.SALARY - 0.01*X.PCT*X.SALARY) AS SALARY FROM (SELECT A.*,CASE WHEN B.MAXIMUM <= 1000 THEN 0 WHEN B.MAXIMUM <= 10000 THEN 24 ELSE 49 END AS PCT FROM SALARIES A JOIN ( SELECT COMPANY_ID,MAX(SALARY) AS MAXIMUM FROM SALARIES GROUP BY COMPANY_ID) B ON A.COMPANY_ID = B.COMPANY_ID)X"
582,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND((CASE WHEN S.MAX_SALARY < 1000 THEN S.SALARY WHEN S.MAX_SALARY > 10000 THEN 0.51 * S.SALARY ELSE 0.76 * S.SALARY END),0) AS SALARY FROM (SELECT *, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES)S"
583,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND((CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) <1000 THEN SALARY WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) >10000 THEN 0.51*SALARY ELSE 0.76*SALARY END),0) AS SALARY FROM SALARIES"
584,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID)< 1000 THEN SALARY - (SALARY * 0/100) WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN SALARY - (SALARY * 24/100) ELSE SALARY - (SALARY * 49/100) END,0) AS SALARY FROM SALARIES"
585,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY - SALARY * (CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID)< 1000 THEN 0.00 WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN 0.24 WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) > 10000 THEN 0.49 END)) AS SALARY FROM SALARIES"
586,Y,Y,"WITH RATES AS ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) >= 1000 AND MAX(SALARY) < 10000 THEN 24 ELSE 49 END AS RATE FROM SALARIES GROUP BY COMPANY_ID ) SELECT SALARIES.COMPANY_ID, SALARIES.EMPLOYEE_ID, SALARIES.EMPLOYEE_NAME, ROUND(SALARIES.SALARY - ((RATES.RATE * SALARIES.SALARY) / 100), 0) AS SALARY FROM SALARIES JOIN RATES ON SALARIES.COMPANY_ID = RATES.COMPANY_ID"
587,Y,Y,"WITH TAX AS( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) >= 1000 AND MAX(SALARY) <= 10000 THEN 0.24 WHEN MAX(SALARY) > 10000 THEN 0.49 END AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID ) SELECT A.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY * (1-TAX_RATE),0) AS SALARY FROM SALARIES A LEFT JOIN TAX B ON A.COMPANY_ID = B.COMPANY_ID"
588,Y,Y,"WITH CTE AS (SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY 1) SELECT A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME, ROUND(CASE WHEN CTE.MAX_SALARY < 1000 THEN A.SALARY WHEN CTE.MAX_SALARY BETWEEN 1000 AND 10000 THEN A.SALARY * 0.76 ELSE A.SALARY * 0.51 END,0) AS SALARY FROM SALARIES A INNER JOIN CTE ON A.COMPANY_ID = CTE.COMPANY_ID"
589,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN SALARY*0.76 WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) > 10000 THEN 0.51*SALARY ELSE 0 END) AS SALARY FROM SALARIES GROUP BY 1,2"
590,Y,Y,"WITH CTE AS (SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS COMP_MAX FROM SALARIES) SELECT COMPANY_ID,EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN COMP_MAX <1000 THEN SALARY WHEN COMP_MAX BETWEEN 1000 AND 10000 THEN SALARY*(1-0.24) WHEN COMP_MAX>10000 THEN SALARY*(1-0.49) END,0) AS SALARY FROM CTE"
591,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY * (1 - T.TAX_RATE)) AS SALARY FROM SALARIES AS S INNER JOIN (SELECT COMPANY_ID, (CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END) AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID ) AS T ON S.COMPANY_ID = T.COMPANY_ID"
592,Y,Y,"WITH T1 AS (SELECT COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MX, ROUND(CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID)<1000 THEN SALARY WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID)>10000 THEN 0.51*SALARY ELSE 0.76*SALARY END,0) AS SALARY FROM SALARIES GROUP BY 1,2,3) SELECT T1.COMPANY_ID,T1.EMPLOYEE_ID,T1.EMPLOYEE_NAME,T1.SALARY FROM T1"
593,Y,Y,"WITH CTE AS( SELECT COMPANY_ID,MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID) SELECT E.COMPANY_ID, E.EMPLOYEE_ID, E.EMPLOYEE_NAME, ROUND((CASE WHEN J.MAX_SALARY <1000 THEN SALARY WHEN J.MAX_SALARY BETWEEN 1000 AND 10000 THEN SALARY-SALARY*0.24 ELSE SALARY-SALARY*0.49 END),0) AS SALARY FROM SALARIES E LEFT JOIN CTE J ON E.COMPANY_ID=J.COMPANY_ID"
594,Y,Y,"WITH CTE AS ( SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAXS FROM SALARIES ), T1 AS ( SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, (CASE WHEN MAXS < 1000 THEN SALARY WHEN MAXS > 10000 THEN (1-0.49)*SALARY ELSE (1-0.24)*SALARY END) AS AFT_SALARY FROM CTE ) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(AFT_SALARY,0) AS SALARY FROM T1"
595,Y,Y,"SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY * T1.TAX_PCT/100,0) AS SALARY FROM ( SELECT COMPANY_ID, CASE WHEN MAX_SALARY < 1000 THEN 100 WHEN MAX_SALARY >1000 AND MAX_SALARY<10000 THEN 76 WHEN MAX_SALARY > 10000 THEN 51 ELSE 0 END AS TAX_PCT FROM ( SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID ) T ) T1 JOIN SALARIES S ON T1.COMPANY_ID=S.COMPANY_ID"
596,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN ROUND(SALARY*(1-.24)) WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) >10000 THEN ROUND(SALARY*(1-.49)) END AS SALARY FROM SALARIES"
597,Y,Y,"WITH CTE1 AS (SELECT *, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES ) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX_SALARY<1000 THEN ROUND(SALARY) WHEN MAX_SALARY BETWEEN 1000 AND 10000 THEN ROUND((SALARY - SALARY*0.24)) ELSE ROUND((SALARY - SALARY*0.49)) END AS SALARY FROM CTE1"
598,Y,Y,"WITH TEMP AS (SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY, CASE WHEN MAX(SALARY) > 10000 THEN 0.49 WHEN MAX(SALARY) < 1000 THEN 0 ELSE 0.24 END AS TAX FROM SALARIES GROUP BY COMPANY_ID) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY*(1-T.TAX), 0) AS SALARY FROM SALARIES AS S LEFT JOIN TEMP AS T ON S.COMPANY_ID = T.COMPANY_ID"
599,Y,Y,"SELECT B.COMPANY_ID, B.EMPLOYEE_ID, B.EMPLOYEE_NAME, ROUND(B.SALARY - (B.SALARY*A.TAX) ,0) AS SALARY FROM (SELECT COMPANY_ID, CASE WHEN MAX(SALARY)<1000 THEN 0 WHEN MAX(SALARY) >= 1000 AND MAX(SALARY)<=10000 THEN 0.24 WHEN MAX(SALARY) > 10000 THEN 0.49 END AS TAX FROM SALARIES GROUP BY COMPANY_ID ) A INNER JOIN SALARIES B ON A.COMPANY_ID = B.COMPANY_ID"
600,Y,Y,"SELECT SALARIES.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY - (SALARY * TAX),0) AS SALARY FROM SALARIES JOIN (SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END AS TAX FROM SALARIES GROUP BY COMPANY_ID) TEMP ON SALARIES.COMPANY_ID = TEMP.COMPANY_ID"
601,Y,Y,"WITH Q1 AS (SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) >=1000 AND MAX(SALARY)<=10000 THEN 0.24 ELSE 0.49 END AS TAX FROM SALARIES GROUP BY COMPANY_ID) SELECT A.COMPANY_ID,A.EMPLOYEE_ID,A.EMPLOYEE_NAME,ROUND((A.SALARY-(A.SALARY*B.TAX))) AS SALARY FROM SALARIES A JOIN Q1 B ON A.COMPANY_ID=B.COMPANY_ID"
602,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX_WAGE<1000 THEN ROUND(ORIG_SALARY,0) WHEN MAX_WAGE>=1000 AND MAX_WAGE<=10000 THEN ROUND(ORIG_SALARY*(1-0.24),0) WHEN MAX_WAGE>10000 THEN ROUND(ORIG_SALARY*(1-0.49),0) END AS SALARY FROM (SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY AS ORIG_SALARY, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_WAGE FROM SALARIES)SUB"
603,Y,Y,"SELECT S.COMPANY_ID , S.EMPLOYEE_ID , S.EMPLOYEE_NAME , ROUND(S.SALARY * TR.TAX_RATE) AS SALARY FROM SALARIES S LEFT OUTER JOIN( SELECT COMPANY_ID , CASE WHEN MAX_SALARY < 1000 THEN 1 ELSE CASE WHEN MAX_SALARY >= 1000 AND MAX_SALARY < 10000 THEN 0.76 ELSE 0.51 END END AS TAX_RATE FROM( SELECT COMPANY_ID , MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY 1 ) MS ) TR ON TR.COMPANY_ID = S.COMPANY_ID"
604,Y,Y,"WITH TAX AS ( SELECT COMPANY_ID, MAX(SALARY) SAL FROM SALARIES GROUP BY 1) SELECT A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME, CASE WHEN SAL < 1000 THEN SALARY WHEN SAL >= 1000 AND SAL <= 10000 THEN ROUND(.76*SALARY,0) WHEN SAL > 10000 THEN ROUND(.51*SALARY,0) END SALARY FROM SALARIES A JOIN TAX B ON A.COMPANY_ID = B.COMPANY_ID ORDER BY 1,2"
605,Y,Y,"WITH CTE AS (SELECT COMPANY_ID,CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END AS RATE FROM SALARIES GROUP BY 1) SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY - RATE * SALARY,0) AS SALARY FROM SALARIES S,CTE WHERE S.COMPANY_ID = CTE.COMPANY_ID"
606,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN SALARY-(SALARY*.24) ELSE SALARY-(SALARY*.49)END,0) AS SALARY FROM SALARIES"
607,Y,Y,"WITH CTE1 AS( SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID), CTE2 AS( SELECT S.*, CTE1.MAX_SALARY FROM SALARIES S LEFT JOIN CTE1 ON S.COMPANY_ID = CTE1.COMPANY_ID) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX_SALARY < 1000 AND MAX_SALARY > 0 THEN SALARY WHEN MAX_SALARY < 10000 AND MAX_SALARY >= 1000 THEN SALARY * 0.76 ELSE SALARY * 0.51 END, 0) AS SALARY FROM CTE2"
608,Y,Y,"WITH M_SAL AS ( SELECT COMPANY_ID, MAX(SALARY) AS SAL_MAX FROM SALARIES GROUP BY COMPANY_ID ) SELECT S.COMPANY_ID , S.EMPLOYEE_ID , S.EMPLOYEE_NAME , CASE WHEN M.SAL_MAX < 1000 THEN ROUND(S.SALARY,0) WHEN M.SAL_MAX BETWEEN 1000 AND 10000 THEN ROUND((S.SALARY-S.SALARY*.24),0) WHEN M.SAL_MAX > 10000 THEN ROUND((S.SALARY-S.SALARY*.49),0) END AS SALARY FROM SALARIES S LEFT JOIN M_SAL M ON S.COMPANY_ID = M.COMPANY_ID"
609,Y,Y,"WITH INTERM_TABLE AS( SELECT *, CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) <1000 THEN 0 WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) >=1000 AND MAX(SALARY) OVER(PARTITION BY COMPANY_ID)<=10000 THEN SALARY*0.24 WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID)>10000 THEN SALARY*0.49 END AS TAX_AMT FROM SALARIES ) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY-TAX_AMT,0) AS SALARY FROM INTERM_TABLE"
610,Y,Y,"SELECT COMPANY_ID,EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN A.MAX_SAL < 1000 THEN SALARY WHEN A.MAX_SAL BETWEEN 1000 AND 10000 THEN ROUND(SALARY*0.76) WHEN A.MAX_SAL > 10000 THEN ROUND(SALARY*0.51) END AS SALARY FROM (SELECT *,MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_SAL FROM SALARIES)A"
611,Y,Y,"WITH D AS( SELECT COMPANY_ID, MAX(SALARY) AS MS FROM SALARIES GROUP BY COMPANY_ID ), E AS( SELECT S.*, CASE WHEN D.MS < 1000 THEN 1 WHEN D.MS>=1000 AND D.MS <=10000 THEN (1-0.24) WHEN D.MS >10000 THEN (1-0.49) END AS TAX FROM SALARIES S LEFT JOIN D ON S.COMPANY_ID=D.COMPANY_ID ) SELECT E.COMPANY_ID, E.EMPLOYEE_ID, E.EMPLOYEE_NAME, ROUND(TAX*E.SALARY,0) AS SALARY FROM E"
612,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) > 10000 THEN ROUND(SALARY*.51) WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) < 1000 THEN SALARY ELSE ROUND(SALARY * .76) END AS SALARY FROM SALARIES ORDER BY COMPANY_ID"
613,Y,Y,"WITH CTE AS (SELECT COMPANY_ID, MAX(SALARY) AS MX FROM SALARIES GROUP BY 1) SELECT S.COMPANY_ID , S.EMPLOYEE_ID, S.EMPLOYEE_NAME, CASE WHEN MX < 1000 THEN SALARY WHEN MX >= 1000 AND MX <= 10000 THEN ROUND(SALARY * 0.76) WHEN MX > 10000 THEN ROUND(SALARY * 0.51) END AS SALARY FROM SALARIES S JOIN CTE USING(COMPANY_ID)"
614,Y,Y,"SELECT S1.COMPANY_ID, S1.EMPLOYEE_ID, S1.EMPLOYEE_NAME, ( CASE WHEN N.COMPANY_MAX < 1000 THEN S1.SALARY WHEN N.COMPANY_MAX >= 10000 THEN ROUND(0.51*S1.SALARY, 0) ELSE ROUND(0.76*S1.SALARY, 0) END) AS SALARY FROM SALARIES AS S1 JOIN (SELECT S2.COMPANY_ID, MAX(S2.SALARY) AS COMPANY_MAX FROM SALARIES AS S2 GROUP BY S2.COMPANY_ID) AS N ON S1.COMPANY_ID = N.COMPANY_ID"
615,Y,Y,"SELECT COMPANY_ID , EMPLOYEE_ID , EMPLOYEE_NAME , ROUND(SALARY*(1-TAX_RATE),0) AS SALARY FROM (SELECT * , CASE WHEN MAX_SALARY<1000 THEN 0 WHEN MAX_SALARY BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END AS TAX_RATE FROM (SELECT * , MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES) AS A) AS B"
616,Y,Y,"SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY * (1 - TAX_RATE), 0) SALARY FROM SALARIES S JOIN ( SELECT COMPANY_ID, CASE WHEN MAX_SALARY > 10000 THEN 0.49 WHEN MAX_SALARY >= 1000 THEN 0.24 ELSE 0.0 END TAX_RATE FROM ( SELECT COMPANY_ID, MAX(SALARY) MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID ) S ) T ON S.COMPANY_ID = T.COMPANY_ID"
617,Y,Y,"SELECT COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME, CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) < 1000 THEN ROUND(SALARY) WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) > 1000 AND MAX(SALARY) OVER (PARTITION BY COMPANY_ID)< 10000 THEN ROUND(SALARY*(1-.24)) WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID)> 10000 THEN ROUND(SALARY*(1-.49)) END AS SALARY FROM SALARIES"
618,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) < 1000 THEN ROUND((SALARY - (SALARY* 0/100)),0) WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN ROUND((SALARY - (SALARY * 24/100)),0) WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) > 10000 THEN ROUND((SALARY - (SALARY* 49/100)),0) ELSE SALARY END AS SALARY FROM SALARIES"
619,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(CASE WHEN Z.SALARY_M<1000 THEN SALARY WHEN Z.SALARY_M>=1000 AND Z.SALARY_M<=10000 THEN SALARY*0.76 WHEN Z.SALARY_M>10000 THEN SALARY*0.51 END,0) AS SALARY FROM SALARIES S JOIN (SELECT COMPANY_ID, MAX(SALARY) AS SALARY_M FROM SALARIES GROUP BY 1)Z ON S.COMPANY_ID=Z.COMPANY_ID"
620,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN SALARY*0.76 ELSE SALARY*0.51 END, 0) AS SALARY FROM SALARIES"
621,Y,Y,"WITH T1 AS (SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_SALARY, SALARY FROM SALARIES) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX_SALARY > 10000 THEN ROUND(SALARY*(1 - 0.49),0) WHEN 10000 >= MAX_SALARY AND MAX_SALARY >= 1000 THEN ROUND(SALARY*(1 - 0.24),0) WHEN MAX_SALARY < 1000 THEN ROUND(SALARY,0) END AS SALARY FROM T1"
622,Y,Y,"WITH A AS (SELECT *, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_S FROM SALARIES) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX_S < 1000 THEN ROUND(SALARY,0) WHEN MAX_S > 10000 THEN ROUND(SALARY*0.51,0) ELSE ROUND(SALARY*0.76,0) END SALARY FROM A"
623,Y,Y,"WITH RATIO AS ( SELECT COMPANY_ID,(CASE WHEN MAX_SALARY<1000 THEN 0 WHEN MAX_SALARY>=1000 AND MAX_SALARY<=10000 THEN 0.24 WHEN MAX_SALARY>10000 THEN 0.49 END) AS NUM FROM ( SELECT COMPANY_ID,MAX(SALARY) MAX_SALARY FROM SALARIES GROUP BY 1) TEMP) SELECT S.COMPANY_ID,S.EMPLOYEE_ID,S.EMPLOYEE_NAME,ROUND(S.SALARY*(1-NUM),0) AS SALARY FROM SALARIES S INNER JOIN RATIO ON S.COMPANY_ID=RATIO.COMPANY_ID"
624,Y,Y,"WITH CTE AS ( SELECT S.COMPANY_ID,S.EMPLOYEE_ID, S.EMPLOYEE_NAME, S.SALARY, S1.MAXSALARY FROM SALARIES S JOIN (SELECT COMPANY_ID , MAX(SALARY) AS MAXSALARY FROM SALARIES GROUP BY COMPANY_ID) S1 ON S.COMPANY_ID = S1.COMPANY_ID ) SELECT COMPANY_ID , EMPLOYEE_ID , EMPLOYEE_NAME, CASE WHEN 10000 < MAXSALARY THEN ROUND(SALARY*0.51) WHEN MAXSALARY BETWEEN 1000 AND 10000 THEN ROUND(SALARY*0.76) ELSE ROUND(SALARY) END AS SALARY FROM CTE"
625,Y,Y,"WITH CTE AS ( SELECT COMPANY_ID, EMPLOYEE_ID,EMPLOYEE_NAME,SALARY, MAX(SALARY) OVER(PARTITION BY COMPANY_ID ORDER BY COMPANY_ID) AS MAX_SALARY FROM SALARIES S ) SELECT COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME, ROUND(SALARY,0) AS SALARY FROM ( SELECT COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME, CASE WHEN MAX_SALARY<1000 THEN SALARY WHEN MAX_SALARY<=10000 AND MAX_SALARY >=1000 THEN SALARY -SALARY*0.24 WHEN MAX_SALARY > 10000 THEN SALARY - SALARY*0.49 END AS SALARY FROM CTE ) TEMP"
626,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID)<1000 THEN SALARY WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN 0.76*SALARY WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID)>10000 THEN 0.51*SALARY ELSE 0 END ,0) AS SALARY FROM SALARIES"
627,Y,Y,"WITH MAX_SAL AS (SELECT COMPANY_ID,MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, CASE WHEN M.MAX_SALARY < 1000 THEN S.SALARY WHEN M.MAX_SALARY >=1000 AND M.MAX_SALARY <=10000 THEN ROUND((0.76*S.SALARY),0) WHEN M.MAX_SALARY > 10000 THEN ROUND((0.51*S.SALARY),0) END AS SALARY FROM SALARIES S JOIN MAX_SAL M ON M.COMPANY_ID = S.COMPANY_ID"
628,Y,Y,"SELECT SALARIES.COMPANY_ID, SALARIES.EMPLOYEE_ID, SALARIES.EMPLOYEE_NAME, ROUND(SALARIES.SALARY * TAX.TAX_SLAB,0) AS SALARY FROM SALARIES LEFT JOIN ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 1 WHEN MAX(SALARY) BETWEEN 1000 AND 10000 THEN (0.76) WHEN MAX(SALARY) > 10000 THEN 0.51 END AS TAX_SLAB FROM SALARIES GROUP BY COMPANY_ID) TAX ON SALARIES.COMPANY_ID = TAX.COMPANY_ID"
629,Y,Y,"WITH A AS (SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX_SALARY < 1000 THEN ROUND(SALARY) WHEN MAX_SALARY >= 1000 AND MAX_SALARY <= 10000 THEN ROUND(SALARY - (SALARY * 0.24)) ELSE ROUND(SALARY - (SALARY * 0.49)) END AS SALARY FROM A"
630,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX(SALARY)OVER(PARTITION BY COMPANY_ID ORDER BY COMPANY_ID ASC)<1000 THEN SALARY WHEN MAX(SALARY)OVER(PARTITION BY COMPANY_ID ORDER BY COMPANY_ID ASC)BETWEEN 1000 AND 10000 THEN 0.76*SALARY WHEN MAX(SALARY)OVER(PARTITION BY COMPANY_ID ORDER BY COMPANY_ID ASC)>10000 THEN 0.51*SALARY END,0) AS SALARY FROM SALARIES"
631,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, (CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) > 10000 THEN ROUND(SALARY*.51, 0) WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) > 1000 THEN ROUND(SALARY*.76, 0) ELSE SALARY END) AS SALARY FROM SALARIES"
632,Y,Y,"WITH CTE AS (SELECT COMPANY_ID , MAX(SALARY) AS MAX_SALARY , (CASE WHEN MAX(SALARY) < 1000 THEN 1 WHEN MAX(SALARY) >= 1000 AND MAX(SALARY) <= 10000 THEN .76 ELSE .51 END) AS TAX FROM SALARIES GROUP BY COMPANY_ID) SELECT SALARIES.COMPANY_ID , SALARIES.EMPLOYEE_ID , SALARIES.EMPLOYEE_NAME , ROUND(SALARIES.SALARY * CTE.TAX, 0) AS SALARY FROM SALARIES LEFT JOIN CTE ON CTE.COMPANY_ID = SALARIES.COMPANY_ID"
633,Y,Y,"SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(S.SALARY - S.SALARY*CTE.TAX,0) AS SALARY FROM SALARIES S LEFT JOIN ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) <= 10000 THEN 0.24 ELSE 0.49 END AS TAX FROM SALARIES GROUP BY COMPANY_ID) CTE USING (COMPANY_ID)"
634,Y,Y,"WITH TEMP AS (SELECT COMPANY_ID, (CASE WHEN MAX(SALARY)<1000 THEN 0 WHEN MAX(SALARY) BETWEEN 1000 AND 10000 THEN 24 ELSE 49 END) AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID) SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY*(1-TAX_RATE/100)) AS SALARY FROM SALARIES S INNER JOIN TEMP T ON S.COMPANY_ID = T.COMPANY_ID"
635,Y,Y,"WITH TAXCUT AS ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 1 WHEN MAX(SALARY) BETWEEN 1000 AND 10000 THEN (1-0.24) WHEN MAX(SALARY) > 10000 THEN (1-0.49) ELSE NULL END AS TAXCUT FROM SALARIES GROUP BY COMPANY_ID) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND(T.TAXCUT*S.SALARY) AS SALARY FROM SALARIES S LEFT JOIN TAXCUT T ON S.COMPANY_ID = T.COMPANY_ID"
636,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY*(1-RATE)) AS SALARY FROM (SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX_SAL, CASE WHEN MAX_SAL<1000 THEN 0 WHEN MAX_SAL BETWEEN 1000 AND 10000 THEN 0.24 WHEN MAX_SAL>10000 THEN 0.49 END AS RATE FROM (SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX_SAL FROM SALARIES) AS MAX ) AS A"
637,Y,Y,"WITH MAX_SAL AS ( SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID ) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX_SALARY < 1000 THEN ROUND(SALARY -0*SALARY,0) WHEN MAX_SALARY <= 10000 THEN ROUND(SALARY -0.24*SALARY,0) ELSE ROUND(SALARY -0.49*SALARY,0) END AS SALARY FROM SALARIES LEFT JOIN MAX_SAL USING(COMPANY_ID)"
638,Y,Y,"WITH CTE AS (SELECT COMPANY_ID , EMPLOYEE_ID , EMPLOYEE_NAME , SALARY ,MAX(SALARY)OVER (PARTITION BY COMPANY_ID ) AS MAX_SALARY FROM SALARIES) SELECT COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME, ROUND(CASE WHEN MAX_SALARY > 10000 THEN (SALARY -SALARY *(49/100)) WHEN MAX_SALARY>1000 AND MAX_SALARY <10000 THEN (SALARY - SALARY*(24/100)) ELSE SALARY END) AS SALARY FROM CTE"
639,Y,Y,"SELECT A.COMPANY_ID AS COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN A.MAX < 1000 THEN SALARY - (SALARY * 0/100) WHEN A.MAX BETWEEN 1000 AND 10000 THEN SALARY - (SALARY * 24/100) ELSE SALARY - (SALARY * 49/100) END,0) AS SALARY FROM SALARIES JOIN (SELECT COMPANY_ID, MAX(SALARY) AS MAX FROM SALARIES GROUP BY COMPANY_ID) A ON SALARIES.COMPANY_ID = A.COMPANY_ID GROUP BY A.COMPANY_ID, EMPLOYEE_ID"
640,Y,Y,"SELECT DISTINCT COMPANY_ID , EMPLOYEE_ID , EMPLOYEE_NAME , CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID)>10000 THEN ROUND(0.51 * SALARY, 0) WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) < 1000 THEN ROUND(SALARY, 0) ELSE ROUND(0.76 * SALARY, 0) END AS SALARY FROM SALARIES GROUP BY COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME"
641,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, (CASE WHEN (SELECT MAX(SALARY) FROM SALARIES WHERE COMPANY_ID=S.COMPANY_ID) > 10000 THEN ROUND(0.51 * SALARY) WHEN (SELECT MAX(SALARY) FROM SALARIES WHERE COMPANY_ID=S.COMPANY_ID) BETWEEN 1000 AND 10000 THEN ROUND(0.76 * SALARY) ELSE SALARY END ) AS SALARY FROM SALARIES S"
642,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND( CASE WHEN MAX <1000 THEN SALARY WHEN MAX BETWEEN 1000 AND 10000 THEN (1-0.24)*SALARY ELSE (1-0.49)*SALARY END, 0) AS SALARY FROM (SELECT *, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX FROM SALARIES) AS A"
643,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN SALARY - SALARY * 0.24 ELSE SALARY * 0.51 END) AS SALARY FROM SALARIES"
644,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(IF(MAX(SALARY)OVER(PARTITION BY COMPANY_ID) < 1000, SALARY, IF(MAX(SALARY)OVER(PARTITION BY COMPANY_ID) >10000, SALARY * 0.51, SALARY * 0.76)),0) SALARY FROM SALARIES"
645,Y,Y,"SELECT S.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(S.SALARY * T.TAX_RATE,0) AS SALARY FROM SALARIES S INNER JOIN( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 1 WHEN MAX(SALARY) > 1000 AND MAX(SALARY) < 10000 THEN 0.76 ELSE 0.51 END AS TAX_RATE FROM SALARIES GROUP BY COMPANY_ID) T ON S.COMPANY_ID = T.COMPANY_ID"
646,Y,Y,"WITH T AS ( SELECT COMPANY_ID, MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, ROUND((CASE WHEN T.MAX_SALARY < 1000 THEN S.SALARY WHEN T.MAX_SALARY>= 1000 AND T.MAX_SALARY <= 10000 THEN S.SALARY * 0.76 ELSE S.SALARY * 0.51 END),0)AS SALARY FROM SALARIES S LEFT JOIN T ON S.COMPANY_ID = T.COMPANY_ID"
647,Y,Y,"WITH CTE1 AS (SELECT COMPANY_ID, MAX(SALARY) AS MAX_S FROM SALARIES GROUP BY 1), CTE2 AS (SELECT S.COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME,SALARY, CASE WHEN MAX_S < 1000 THEN 0 WHEN MAX_S BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END AS TAX FROM SALARIES S JOIN CTE1 ON S.COMPANY_ID = CTE1.COMPANY_ID) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY * (1-TAX),0) AS SALARY FROM CTE2"
648,Y,Y,"WITH MAXIMUM AS (SELECT COMPANY_ID , MAX(SALARY) AS MAX_SALARY FROM SALARIES GROUP BY COMPANY_ID) SELECT S1.COMPANY_ID , S1.EMPLOYEE_ID , S1.EMPLOYEE_NAME , ROUND(CASE WHEN M1.MAX_SALARY >10000 THEN S1.SALARY - (0.49)*S1.SALARY WHEN M1.MAX_SALARY >=1000 AND M1.MAX_SALARY <= 10000 THEN S1.SALARY - (0.24)*S1.SALARY ELSE S1.SALARY END , 0 ) AS SALARY FROM SALARIES S1 INNER JOIN MAXIMUM M1 ON S1.COMPANY_ID = M1.COMPANY_ID"
649,Y,Y,"SELECT A.COMPANY_ID,A.EMPLOYEE_ID,A.EMPLOYEE_NAME, ROUND(CASE WHEN MAXXED <1000 THEN SALARY -((0/100)*SALARY) WHEN MAXXED BETWEEN 1000 AND 10000 THEN SALARY -((24/100)*SALARY) WHEN MAXXED > 10000 THEN SALARY -((49/100)*SALARY) ELSE SALARY END,0) AS SALARY FROM SALARIES A INNER JOIN (SELECT COMPANY_ID,MAX(SALARY) AS MAXXED FROM SALARIES GROUP BY 1) B ON A.COMPANY_ID=B.COMPANY_ID"
650,Y,Y,"WITH MAXX AS ( SELECT COMPANY_ID, MAX(SALARY) AS SSALARY FROM SALARIES GROUP BY COMPANY_ID) SELECT COMPANY_ID, EMPLOYEE_ID,EMPLOYEE_NAME, CASE WHEN(SSALARY)<1000 THEN SALARY WHEN SSALARY>=1000 AND SSALARY<=10000 THEN ROUND(SALARY-SALARY*0.24,0) WHEN (SSALARY)>10000 THEN ROUND(SALARY-SALARY*0.49,0) END AS SALARY FROM SALARIES JOIN MAXX USING(COMPANY_ID)"
651,Y,Y,"WITH AGG1 AS ( SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX_SALARY < 1000 THEN SALARY WHEN MAX_SALARY BETWEEN 1000 AND 10000 THEN SALARY - (0.24 * SALARY) WHEN MAX_SALARY > 10000 THEN SALARY - (0.49 * SALARY) END) AS SALARY FROM AGG1"
652,Y,Y,"SELECT COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME, (CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN ROUND((1-0.24)*SALARY) WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) > 10000 THEN ROUND((1-0.49)*SALARY) END) AS SALARY FROM SALARIES"
653,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX_SALARY < 1000 THEN SALARY WHEN (MAX_SALARY >= 1000 AND MAX_SALARY<=10000) THEN SALARY-((SALARY * 24)/100) WHEN MAX_SALARY > 10000 THEN SALARY-((SALARY * 49)/100) END, 0) AS SALARY FROM ( SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES ) S"
654,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, CASE WHEN MAX_SALARY_PER_DEP < 1000 THEN SALARY WHEN MAX_SALARY_PER_DEP >= 1000 AND MAX_SALARY_PER_DEP <= 10000 THEN ROUND(SALARY * 0.76, 0) WHEN MAX_SALARY_PER_DEP > 10000 THEN ROUND(SALARY * 0.51, 0) END AS SALARY FROM (SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, SALARY, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX_SALARY_PER_DEP FROM SALARIES) T"
655,Y,Y,"WITH TAX AS ( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) > 10000 THEN 49 WHEN MAX(SALARY) >= 1000 AND MAX(SALARY) <=10000 THEN 24 ELSE 0 END TAXES FROM SALARIES GROUP BY COMPANY_ID ) SELECT S.COMPANY_ID, S.EMPLOYEE_ID, S.EMPLOYEE_NAME, CASE WHEN T.TAXES = 0 THEN S.SALARY WHEN T.TAXES != 0 THEN ROUND((S.SALARY - (T.TAXES/100) * S.SALARY)) END SALARY FROM SALARIES S JOIN TAX T ON S.COMPANY_ID = T.COMPANY_ID"
656,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN SAL_MAX < 1000 THEN SALARY*(1-0.00) WHEN SAL_MAX >= 1000 AND SAL_MAX <= 10000 THEN SALARY*(1-0.24) WHEN SAL_MAX > 10000 THEN SALARY*(1-0.49) ELSE 0 END, 0) AS SALARY FROM (SELECT *, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS SAL_MAX FROM SALARIES) TBL1"
657,Y,Y,"SELECT S.COMPANY_ID , S.EMPLOYEE_ID,S.EMPLOYEE_NAME, ROUND((CASE WHEN C.M<1000 THEN S.SALARY WHEN C.M>=1000 AND C.M<=10000 THEN S.SALARY-(S.SALARY*0.24) WHEN C.M>10000 THEN S.SALARY-(S.SALARY*0.49) END)) AS SALARY FROM SALARIES S LEFT JOIN( SELECT MAX(SALARY) AS M,COMPANY_ID FROM SALARIES GROUP BY 2)C ON S. COMPANY_ID =C.COMPANY_ID"
658,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN SALARY - (SALARY * 0.24) WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) > 10000 THEN SALARY - (SALARY * 0.49) END,0) AS SALARY FROM SALARIES"
659,Y,Y,"WITH MAX_SAL AS ( SELECT COMPANY_ID, MAX(SALARY) AS MAX_SAL FROM SALARIES GROUP BY COMPANY_ID ), TAX_RATE AS ( SELECT COMPANY_ID, CASE WHEN MAX_SAL < 1000 THEN 0 WHEN MAX_SAL > 1000 AND MAX_SAL < 10000 THEN 24/100 WHEN MAX_SAL > 10000 THEN 49/100 END AS TAX_RATE FROM MAX_SAL ) SELECT E.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY - SALARY*TAX_RATE) AS SALARY FROM SALARIES E JOIN TAX_RATE T ON E.COMPANY_ID = T.COMPANY_ID"
660,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN SALARY - SALARY * (24/100) WHEN MAX(SALARY) OVER (PARTITION BY COMPANY_ID) > 10000 THEN SALARY - SALARY * (49/100) END) AS SALARY FROM SALARIES GROUP BY 1, 2, 3"
661,Y,Y,"SELECT A.COMPANY_ID, A.EMPLOYEE_ID, A.EMPLOYEE_NAME, ROUND((CASE WHEN A.MAX_SALARY < 1000 THEN A.SALARY WHEN 1000 <= A.MAX_SALARY AND A.MAX_SALARY <= 10000 THEN A.SALARY*0.76 ELSE A.SALARY*0.51 END), 0) AS SALARY FROM (SELECT *, MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX_SALARY FROM SALARIES) A"
662,Y,Y,"WITH A AS (SELECT *, FIRST_VALUE(SALARY) OVER (PARTITION BY COMPANY_ID ORDER BY SALARY DESC) AS F FROM SALARIES) SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY * (1-CASE WHEN F<1000 THEN 0 WHEN F BETWEEN 1000 AND 10000 THEN 0.24 ELSE 0.49 END ),0) AS SALARY FROM A"
663,Y,Y,"SELECT COMPANY_ID , EMPLOYEE_ID ,EMPLOYEE_NAME , ROUND(SALARY - (SALARY*(TAX_PER/100))) AS SALARY FROM ( SELECT COMPANY_ID,EMPLOYEE_ID,EMPLOYEE_NAME,SALARY,MAX(SALARY) OVER(PARTITION BY COMPANY_ID) AS MAX_SALARY, CASE WHEN (MAX(SALARY) OVER(PARTITION BY COMPANY_ID) < 1000) THEN 0 WHEN (MAX(SALARY) OVER(PARTITION BY COMPANY_ID) > 1000 AND MAX(SALARY) OVER(PARTITION BY COMPANY_ID) < 10000) THEN 24 ELSE 49 END AS TAX_PER FROM SALARIES ) A"
664,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN M<1000 THEN SALARY WHEN M<10000 THEN 0.76*SALARY ELSE 0.51*SALARY END, 0) AS SALARY FROM (SELECT *, MAX(SALARY) OVER (PARTITION BY COMPANY_ID) AS M FROM SALARIES) TEMP"
665,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(CASE WHEN MAX(SALARY)OVER(PARTITION BY COMPANY_ID ORDER BY COMPANY_ID ASC)<1000 THEN SALARY WHEN MAX(SALARY)OVER(PARTITION BY COMPANY_ID ORDER BY COMPANY_ID ASC)BETWEEN 1000 AND 10000 THEN 0.76*SALARY WHEN MAX(SALARY)OVER(PARTITION BY COMPANY_ID ORDER BY COMPANY_ID ASC)>10000 THEN 0.51*SALARY END,0) AS SALARY FROM SALARIES GROUP BY 1,2"
666,Y,Y,"SELECT COMPANY_ID , EMPLOYEE_ID , EMPLOYEE_NAME , CASE WHEN MX_SAL<1000 THEN ROUND(SALARY) WHEN MX_SAL >=1000 AND MX_SAL <=10000 THEN ROUND(0.76*SALARY) ELSE ROUND(SALARY*0.51) END AS SALARY FROM (SELECT COMPANY_ID , EMPLOYEE_ID , EMPLOYEE_NAME , SALARY, MAX(SALARY) OVER(PARTITION BY COMPANY_ID ORDER BY SALARY DESC) MX_SAL FROM SALARIES)S"
667,Y,Y,"WITH TEMP AS (SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) >= 1000 AND MAX(SALARY) <= 10000 THEN 24 WHEN MAX(SALARY) > 10000 THEN 49 END AS TAX_PERCENT FROM SALARIES GROUP BY COMPANY_ID) SELECT SAL.COMPANY_ID,SAL.EMPLOYEE_ID,SAL.EMPLOYEE_NAME, ROUND(SAL.SALARY-((SAL.SALARY)*(TAX.TAX_PERCENT/100))) SALARY FROM SALARIES SAL JOIN TEMP TAX ON SAL.COMPANY_ID = TAX.COMPANY_ID"
668,Y,Y,"WITH TAX_R AS( SELECT COMPANY_ID, CASE WHEN MAX(SALARY) < 1000 THEN 0 WHEN MAX(SALARY) <= 10000 AND MAX(SALARY) > 1000 THEN 0.24 WHEN MAX(SALARY) > 10000 THEN 0.49 END AS RATIO FROM SALARIES GROUP BY COMPANY_ID ) SELECT T1.COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME, ROUND(SALARY *(1-RATIO)) AS SALARY FROM SALARIES T1 JOIN TAX_R T2 ON T1.COMPANY_ID = T2.COMPANY_ID"
669,Y,Y,"SELECT COMPANY_ID, EMPLOYEE_ID, EMPLOYEE_NAME ,ROUND(CASE WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) < 1000 THEN SALARY WHEN MAX(SALARY) OVER(PARTITION BY COMPANY_ID) BETWEEN 1000 AND 10000 THEN SALARY*.76 ELSE SALARY*.51 END,0) SALARY FROM SALARIES"
