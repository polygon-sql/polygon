qid,mysql_can_execute?,mysql_correct?,mysql_query
0,Y,Y,"SELECT DISTINCT QUERY_NAME, ROUND(AVG(RATING/POSITION), 2) AS QUALITY, ROUND(SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)/COUNT(QUERY_NAME)*100, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
1,Y,Y,"SELECT DISTINCT QUERY_NAME, QUALITY, ROUND(NUM_GOOD_RESULTS*100/NUM_QUERY_RESULTS,2) AS POOR_QUERY_PERCENTAGE FROM (SELECT *, ROUND(AVG(RATING/POSITION) OVER (PARTITION BY QUERY_NAME),2) AS QUALITY, COUNT(RESULT) OVER (PARTITION BY QUERY_NAME) AS NUM_QUERY_RESULTS, COUNT(CASE WHEN RATING < 3 THEN 1 END) OVER (PARTITION BY QUERY_NAME) AS NUM_GOOD_RESULTS FROM QUERIES) QUERY_RESULTS_TABLE"
2,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND((SUM(CASE WHEN RATING<3 THEN 1 ELSE 0 END)/COUNT(*))*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
3,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(AVG(CASE WHEN RATING <3 THEN 1 ELSE 0 END)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
4,Y,Y,"SELECT A1.QUERY_NAME, ROUND(AVG(A1.TEMP),2) AS QUALITY, ROUND(100*(SUM(A1.Q)/COUNT(A1.Q)),2) AS POOR_QUERY_PERCENTAGE FROM (SELECT QUERY_NAME, RATING/POSITION AS TEMP, CASE WHEN RATING<3 THEN 1 ELSE 0 END AS Q FROM QUERIES) A1 GROUP BY A1.QUERY_NAME"
5,Y,Y,"SELECT DISTINCT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(AVG(RATING < 3 ) *100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
6,Y,Y,"SELECT Q.QUERY_NAME, ROUND(AVG(Q.RATING / Q.POSITION), 2) AS QUALITY , ROUND((SELECT COUNT(Q1.RATING) FROM QUERIES Q1 WHERE Q1.RATING < 3 AND Q1.QUERY_NAME = Q.QUERY_NAME) / (SELECT COUNT(*) FROM QUERIES Q2 WHERE Q2.QUERY_NAME = Q.QUERY_NAME) * 100, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES Q GROUP BY Q.QUERY_NAME"
7,Y,Y,"SELECT Q.QUERY_NAME, ROUND(AVG(Q.RATING / Q.POSITION), 2) AS QUALITY , ROUND(SUM(IF(Q.RATING < 3, 1, 0)) / COUNT(Q.RATING) * 100, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES Q GROUP BY Q.QUERY_NAME"
8,Y,Y,"SELECT Q.QUERY_NAME, ROUND(AVG(Q.RATING/Q.POSITION),2) AS QUALITY, ROUND(AVG(CASE WHEN Q.RATING<3 THEN 1 ELSE 0 END)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES Q GROUP BY Q.QUERY_NAME"
9,Y,N,"SELECT Q1.QUERY_NAME, ROUND(AVG(Q1.RATING/Q1.POSITION),2) AS QUALITY, ROUND(COUNT(DISTINCT Q2.RESULT)/COUNT(DISTINCT Q1.RESULT)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES Q1 LEFT JOIN (SELECT QUERY_NAME, RESULT FROM QUERIES WHERE RATING < 3 ) Q2 ON Q1.QUERY_NAME = Q2.QUERY_NAME GROUP BY Q1.QUERY_NAME"
10,Y,Y,"SELECT QUERY_NAME , ROUND(AVG(RATING*100 / POSITION), 0)/100 AS QUALITY , ROUND(AVG(CASE WHEN RATING < 3 THEN 1 ELSE 0 END )*100, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
11,Y,Y,"SELECT QUERY_NAME ,ROUND(AVG(RATING / POSITION), 2) AS QUALITY ,ROUND(AVG(RATING < 3)* 100, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
12,Y,Y,"SELECT QUERY_NAME ,ROUND(AVG(RATING/POSITION),2) AS QUALITY ,ROUND(SUM(IF(RATING < 3,1,0)) * 100 / COUNT(*),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
13,Y,Y,"SELECT QUERY_NAME ,ROUND(SUM((RATING/POSITION))/COUNT(QUERY_NAME),2) AS QUALITY , ROUND(AVG(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)*100,2)AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
14,Y,Y,"SELECT QUERY_NAME, CAST( AVG(RATING*1.0/POSITION) AS DECIMAL(10,2) ) AS QUALITY, CAST( AVG(CASE WHEN RATING < 3 THEN 100.0 ELSE 0 END) AS DECIMAL(10,2) ) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
15,Y,Y,"SELECT QUERY_NAME, IFNULL(ROUND(AVG(RATING/POSITION),2),0.00) AS QUALITY, IFNULL(ROUND(AVG(RATING<3)*100,2),0.00) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
16,Y,Y,"SELECT QUERY_NAME, ROUND (AVG(RATING/POSITION), 2) AS QUALITY, ROUND ((COUNT(CASE WHEN RATING < 3 THEN 1 END)/COUNT(*)) * 100, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
17,Y,Y,"SELECT QUERY_NAME, ROUND( SUM(RATING / POSITION) / COUNT(QUERY_NAME), 2 ) AS QUALITY, ROUND( 100 * SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)/COUNT(QUERY_NAME) , 2 ) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
18,Y,Y,"SELECT QUERY_NAME, ROUND((SUM(RATING / POSITION) / COUNT(QUERY_NAME)), 2) AS QUALITY, ROUND((COUNT(CASE WHEN RATING < 3 THEN 1 END) / COUNT(QUERY_NAME) * 100), 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
19,Y,Y,"SELECT QUERY_NAME, ROUND((SUM(RATING/POSITION))/COUNT(QUERY_NAME) , 2) AS QUALITY, ROUND((SUM(CASE WHEN RATING<3 THEN 1 ELSE 0 END)*100)/COUNT(QUERY_NAME),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME ORDER BY QUERY_NAME"
20,Y,Y,"SELECT QUERY_NAME, ROUND(AVG((RATING/POSITION)),2) AS QUALITY, ROUND(AVG(CASE WHEN RATING<3 THEN 1 ELSE 0 END)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
21,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(1.0*RATING/POSITION),2) AS QUALITY, ROUND(AVG(RATING<3)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
22,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(QUALITY),2) QUALITY,ROUND(AVG(POOR)*100,2) POOR_QUERY_PERCENTAGE FROM( SELECT QUERY_NAME, RATING/POSITION QUALITY, IF(RATING<3,1,0) POOR FROM QUERIES ) T GROUP BY QUERY_NAME"
23,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING * 100 / POSITION)) / 100 AS QUALITY, ROUND(SUM(RATING < 3) * 100 / COUNT(*), 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME ORDER BY NULL"
24,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING / POSITION), 2) AS QUALITY, ROUND(100 * SUM(IF(RATING < 3, 1, 0)) / COUNT(QUERY_NAME), 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
25,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING / POSITION), 2) AS QUALITY, ROUND(100 * SUM(RATING < 3) / COUNT(RESULT), 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
26,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING / POSITION), 2) AS QUALITY, ROUND(AVG(IF(RATING < 3, 1, 0))*100, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
27,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING / POSITION), 2) AS QUALITY, ROUND(AVG(RATING < 3) * 100, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
28,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING / POSITION), 2) AS QUALITY, ROUND(COUNT(CASE WHEN RATING < 3 THEN RATING ELSE NULL END) / COUNT(1) * 100, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
29,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING / POSITION), 2) AS QUALITY, ROUND(SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END) * 100/ COUNT(RATING), 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
30,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING / POSITION), 2) AS QUALITY, ROUND(SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END) / COUNT(*) * 100, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
31,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING / POSITION), 2) AS QUALITY, ROUND(SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END) / COUNT(QUERY_NAME) * 100, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
32,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING / POSITION), 2) AS QUALITY, ROUND(SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)/ COUNT(RATING) * 100, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
33,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING / POSITION), 2) AS QUALITY, ROUND(SUM(IF(RATING < 3, 1, 0)) / COUNT(*) * 100, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
34,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING / POSITION), 2) AS QUALITY, ROUND(SUM(RATING < 3) / COUNT(*) * 100, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
35,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING / POSITION), 2) AS QUALITY, ROUND(SUM(RATING < 3) / COUNT(RATING) * 100, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
36,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING / POSITION), 2) QUALITY, ROUND(100 * AVG(RATING < 3), 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
37,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING / POSITION),2) AS QUALITY, ROUND( SUM(CASE WHEN RATING<3 THEN 100 ELSE 0 END) / COUNT(*) ,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
38,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION), 2) AS QUALITY, ROUND(100*AVG(RATING < 3),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
39,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION), 2) AS QUALITY, ROUND(AVG(CASE WHEN RATING < 3 THEN 100 ELSE 0 END), 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
40,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION), 2) AS QUALITY, ROUND(AVG(IF(RATING < 3, 1, 0)) * 100, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
41,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(((SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END))/ COUNT(*)) *100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
42,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND((COUNT(CASE WHEN RATING < 3 THEN 1 ELSE NULL END)/COUNT(*))*100, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
43,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND((SUM(IF(RATING<3,1,0))/COUNT(RATING))*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
44,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND((SUM(IF(RATING<3,1,0))/COUNT(*)*100),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
45,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(100 * SUM(IF(RATING<3, 1, 0))/COUNT(*),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME ORDER BY QUERY_NAME"
46,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(100*SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)/COUNT(RATING),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
47,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(100*SUM(CASE WHEN RATING<3 THEN 1 ELSE 0 END)/COUNT(*),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
48,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(100*SUM(IF(RATING < 3, 1, 0))/COUNT(*),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
49,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(SUM((CASE WHEN RATING < 3 THEN 1 ELSE 0 END))/COUNT(*) * 100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
50,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(SUM(CASE WHEN RATING <3 THEN 1 ELSE 0 END)*100/COUNT(*),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
51,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(SUM(CASE WHEN RATING<3 THEN 1 ELSE 0 END)/COUNT(RATING)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
52,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(SUM(IF(RATING < 3, 100, 0))/COUNT(*),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
53,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(SUM(IF(RATING < 3, 100, 0))/COUNT(*),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
54,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(SUM(IF(RATING<3,1,0))/COUNT(RATING)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
55,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY,ROUND((SUM(CASE WHEN RATING<3 THEN 1 ELSE 0 END)/COUNT(QUERY_NAME))*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
56,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY , ROUND(COUNT(CASE WHEN RATING < 3 THEN 1 END)/COUNT(*)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
57,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND((SUM(CASE WHEN RATING<3 THEN 1 ELSE 0 END)/COUNT(*)*100),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
58,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(100*SUM(IF(RATING <3, 1, 0))/COUNT(RATING),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
59,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(*),2) AS QUALITY, ROUND(SUM(RATING<3)/COUNT(*) * 100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
60,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(QUALITY)/COUNT(*), 2) QUALITY, ROUND((SUM(POOR)/COUNT(*)*100), 2) POOR_QUERY_PERCENTAGE FROM (SELECT *, RATING/POSITION QUALITY, CASE WHEN RATING < 3 THEN 1 ELSE 0 END POOR FROM QUERIES) T1 GROUP BY QUERY_NAME"
61,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING / POSITION) / COUNT(*), 2) AS QUALITY, ROUND(100 * SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END) / COUNT(*), 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
62,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING / POSITION) / COUNT(*), 2) AS QUALITY, ROUND(SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END) * 100 / COUNT(*), 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
63,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING / POSITION) / COUNT(*), 2) AS QUALITY, ROUND(SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END) / COUNT(*) * 100, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
64,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING / POSITION) / COUNT(POSITION), 2) AS QUALITY, ROUND(SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)/COUNT(RATING)*100,2 ) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
65,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING / POSITION)/ COUNT(RATING), 2) AS QUALITY, ROUND(SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)/ COUNT(RATING) * 100, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
66,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/ POSITION) / COUNT(QUERY_NAME),2) AS QUALITY, ROUND(SUM(RATING < 3) / COUNT(QUERY_NAME) * 100 , 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
67,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION) / COUNT(POSITION),2) AS QUALITY, ROUND(100*SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END) / COUNT(RATING),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
68,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(*), 2) AS QUALITY, ROUND(SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)/COUNT(*) * 100, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
69,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(*),2) AS QUALITY, ROUND(1.0*100*COUNT(CASE WHEN RATING <3 THEN 1 END)/COUNT(*),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
70,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(QUERY_NAME),2) AS QUALITY, ROUND(SUM(CASE WHEN RATING<3 THEN 1 ELSE 0 END)/COUNT(QUERY_NAME)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
71,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(100*AVG(RATING < 3),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
72,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)*100/COUNT(RATING),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
73,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(RATING), 2) AS QUALITY, ROUND(SUM(CASE WHEN RATING<3 THEN 1 ELSE 0 END) * 100 / COUNT(RATING), 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
74,Y,Y,"SELECT QUERY_NAME, CAST(SUM((RATING* 1.0)/(POSITION*1.0))/COUNT(*) AS DECIMAL(32,2)) QUALITY, CAST((SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END )* 100.00)/COUNT(RATING) AS DECIMAL(32,2)) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
75,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING / POSITION),2) AS QUALITY, ROUND(100 * COUNT(IF(RATING < 3, 1, NULL)) / COUNT(1), 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
76,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION), 2) AS QUALITY, ROUND(COUNT(CASE WHEN RATING < 3 THEN QUERY_NAME END)/COUNT(QUERY_NAME)*100, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
77,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(AVG(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)*100, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
78,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(QUERY_NAME),2) AS QUALITY, ROUND(SUM(IF(RATING<3,1,0))/COUNT(QUERY_NAME)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
79,Y,Y,"SELECT QUERY_NAME,ROUND(AVG(RATING/POSITION),2)AS QUALITY, ROUND(SUM(IF(RATING<3,1,0))/COUNT(1)*100,2)AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
80,Y,N,"SELECT T1.QUERY_NAME , ROUND(AVG(T1.RATING/T1.POSITION), 2) AS QUALITY, ROUND((COUNT(CASE WHEN T1.RATING < 3 THEN 1 END)/ COUNT(*))*100, 2) AS POOR_QUERY_PERCENTAGE FROM (SELECT DISTINCT * FROM QUERIES) T1 GROUP BY T1.QUERY_NAME"
81,Y,Y,"SELECT Q2.QUERY_NAME,ROUND(SUM(Q1.RATING/Q1.POSITION)/ COUNT(Q1.QUERY_NAME),2) AS QUALITY, ROUND((SUM(CASE WHEN Q2.RATING<3 THEN 1 ELSE 0 END)/COUNT(Q2.QUERY_NAME))*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES Q1 INNER JOIN QUERIES Q2 USING (QUERY_NAME) GROUP BY Q2.QUERY_NAME"
82,Y,Y,"SELECT QUERY_NAME AS QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(*),2) AS QUALITY, ROUND(SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)/COUNT(*)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
83,Y,N,"SELECT QUERY_NAME, IFNULL(ROUND(AVG(RATING/POSITION),2),0) AS QUALITY, IFNULL(ROUND((SUM(CASE WHEN RATING <3 THEN 1 ELSE 0 END) / COUNT(*)) *100,2),0) AS POOR_QUERY_PERCENTAGE FROM (SELECT DISTINCT QUERY_NAME,RESULT,POSITION,RATING FROM QUERIES) Q GROUP BY QUERY_NAME"
84,Y,Y,"SELECT QUERY_NAME, COALESCE( ROUND( SUM(RATING/POSITION)/COUNT(QUERY_NAME) ,2) ,0) AS QUALITY, COALESCE( ROUND( SUM(IF(RATING < 3, 1, 0))/COUNT(QUERY_NAME) *100 ,2) ,0) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
85,Y,Y,"SELECT QUERY_NAME, ROUND((SUM(RATING/POSITION))/COUNT(QUERY_NAME),2) AS QUALITY, ROUND(((SUM(IF(RATING<3,1,0)))/COUNT(QUERY_NAME))*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
86,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(SUM( CASE WHEN RATING <3 THEN 1 ELSE 0 END)*100/COUNT(QUERY_NAME),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
87,Y,Y,"SELECT QUERY_NAME, ROUND(AVG((RATING/POSITION)),2) QUALITY , ROUND(AVG(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)*100,2) POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
88,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND((COUNT(CASE WHEN RATING < 3 THEN 1 ELSE NULL END)/COUNT(*))*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
89,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND((SUM(IF(RATING<3,1,0))/COUNT(*))*100,2) POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
90,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY,ROUND((SUM(IF(RATING < 3, 1, 0)) / COUNT(1))* 100, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
91,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(IF(RATING < 3,1,0)) * 100 / COUNT(RATING),2) AS POOR_QUERY_PERCENTAGE, ROUND(SUM(RATING/POSITION)/COUNT(RATING),2) AS QUALITY FROM QUERIES GROUP BY QUERY_NAME"
92,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(*),2) AS QUALITY, ROUND(AVG(CASE WHEN RATING<3 THEN 1 ELSE 0 END)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
93,Y,Y,"SELECT X.QUERY_NAME,ROUND(AVG(X.RATING/X.POSITION),2) AS QUALITY,ROUND(SUM(X.FLAG)/COUNT(*)*100,2) AS POOR_QUERY_PERCENTAGE FROM (SELECT QUERY_NAME,POSITION,RATING, CASE WHEN RATING<3 THEN 1 ELSE 0 END AS FLAG FROM QUERIES) AS X GROUP BY 1"
94,Y,Y,"SELECT X.QUERY_NAME,ROUND(SUM(X.RATING/X.POSITION)/COUNT(X.RATING),2) AS QUALITY, ROUND(SUM(X.FLAG)/COUNT(X.RATING)*100,2) AS POOR_QUERY_PERCENTAGE FROM (SELECT QUERY_NAME,POSITION,RATING, CASE WHEN RATING<3 THEN 1 ELSE 0 END AS FLAG FROM QUERIES) AS X GROUP BY 1"
95,Y,Y,"WITH Q AS( SELECT QUERY_NAME, ROUND(IFNULL(SUM(RATING/POSITION)/COUNT(*), 0), 2) QUALITY , COUNT(*) N_QUERIES FROM QUERIES GROUP BY QUERY_NAME ), P AS( SELECT QUERY_NAME, COUNT(*) POOR_QUERIES FROM QUERIES WHERE RATING < 3 GROUP BY QUERY_NAME ) SELECT N.QUERY_NAME, QUALITY, ROUND(IFNULL(POOR_QUERIES/N_QUERIES*100, 0), 2) POOR_QUERY_PERCENTAGE FROM (SELECT DISTINCT QUERY_NAME FROM QUERIES) N LEFT JOIN P USING(QUERY_NAME) LEFT JOIN Q USING(QUERY_NAME)"
96,Y,N,"WITH Q_CTE AS (SELECT DISTINCT QUERY_NAME,RESULT,POSITION,RATING FROM QUERIES) SELECT QUERY_NAME, ROUND((SUM((RATING)/(POSITION)))/COUNT(*),2) QUALITY, ROUND((SUM(CASE WHEN RATING <3 THEN 1 ELSE 0 END) / COUNT(*))*100,2) POOR_QUERY_PERCENTAGE FROM Q_CTE GROUP BY QUERY_NAME"
97,Y,Y,"WITH QUERIES AS( SELECT QUERY_NAME, RATING / POSITION AS QUALITY, CASE WHEN RATING < 3 THEN 1 ELSE 0 END AS POOR_FLAG FROM QUERIES ) SELECT QUERY_NAME, ROUND(AVG(QUALITY), 2) AS QUALITY, ROUND( SUM(POOR_FLAG) / COUNT(*) * 100 , 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
98,Y,Y,"WITH QUERY_QUALITY AS (SELECT QUERY_NAME, ROUND(SUM(RATING / POSITION) / COUNT(*),2) AS QUALITY FROM QUERIES GROUP BY 1), QUERY_POOR_PERCET AS (SELECT QUERY_NAME, ROUND(100 * SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END) / COUNT(*),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1) SELECT T1.*, T2.POOR_QUERY_PERCENTAGE FROM QUERY_QUALITY T1 INNER JOIN QUERY_POOR_PERCET T2 ON T1.QUERY_NAME = T2.QUERY_NAME"
99,Y,N,"WITH T1 AS (SELECT DISTINCT QUERY_NAME, RESULT, POSITION, RATING FROM QUERIES) SELECT H1 AS QUERY_NAME , ROUND(AVG(S1/S4),2) AS QUALITY, ROUND(COUNT(S2)/COUNT(S1)*100,2) AS POOR_QUERY_PERCENTAGE FROM( SELECT T1.QUERY_NAME AS H1,Q.QUERY_NAME AS H2,T1.RATING AS S1,Q.RATING AS S2,T1.POSITION AS S4 FROM T1 LEFT JOIN (SELECT * FROM T1 WHERE RATING<3 ) AS Q ON T1.QUERY_NAME=Q.QUERY_NAME AND Q.RATING=T1.RATING AND T1.RESULT=Q.RESULT) AS GAMMA GROUP BY H1"
100,Y,Y,"WITH T1 AS (SELECT QUERY_NAME, ROUND(AVG(RATING / POSITION),2) AS QUALITY, ROUND(AVG(RATING < 3)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1) SELECT * FROM T1"
101,N,N,"ROUND(SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)/COUNT(Q.QUERY_NAME)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES Q GROUP BY Q.QUERY_NAME"
102,Y,Y,"SELECT A.QUERY_NAME, A.QUA AS QUALITY, ROUND(POOR*100,2) AS POOR_QUERY_PERCENTAGE FROM (SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(RATING),2) AS QUA FROM QUERIES GROUP BY QUERY_NAME) A JOIN (SELECT QUERY_NAME, (SUM(CASE WHEN RATING<3 THEN 1 ELSE 0 END)/COUNT(RATING)) AS POOR FROM QUERIES GROUP BY QUERY_NAME) B ON A.QUERY_NAME = B.QUERY_NAME"
103,Y,Y,"SELECT A.QUERY_NAME, ROUND(AVG(A.RATING / A.POSITION), 2) QUALITY, ROUND(100*( SELECT COUNT(*) FROM QUERIES B WHERE B.QUERY_NAME=A.QUERY_NAME AND B.RATING < 3) / COUNT(*), 2) POOR_QUERY_PERCENTAGE FROM QUERIES A GROUP BY A.QUERY_NAME"
104,Y,Y,"SELECT A.QUERY_NAME, ROUND(AVG(A.RATING/A.POSITION),2) AS QUALITY,IFNULL(ROUND(B.COUN/COUNT(*)*100,2),0.00) AS POOR_QUERY_PERCENTAGE FROM QUERIES AS A LEFT JOIN ( SELECT QUERY_NAME,COUNT(*) AS COUN FROM QUERIES WHERE RATING<3 GROUP BY QUERY_NAME) AS B ON A.QUERY_NAME = B.QUERY_NAME GROUP BY A.QUERY_NAME"
105,Y,Y,"SELECT DISTINCT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND( SUM(CASE WHEN RATING<3 THEN 1 ELSE 0 END)/COUNT(RATING)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
106,Y,Y,"SELECT DISTINCT(Q.QUERY_NAME), ROUND(AVG(Q.QUALITY),2) QUALITY, ROUND((SUM(Q.QUALITY_INDEX)/COUNT(*))*100,2) POOR_QUERY_PERCENTAGE FROM (SELECT QUERY_NAME,RATING,RATING/POSITION AS QUALITY, IF(RATING <3,1,0) AS QUALITY_INDEX FROM QUERIES) Q GROUP BY QUERY_NAME"
107,Y,Y,"SELECT DISTINCT(QUERY_NAME), ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(100*SUM(IF(RATING<3,1,0))/COUNT(RATING),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
108,Y,Y,"SELECT QUERIES.QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, IFNULL(ROUND((SUM(IF(RATING<3,1,0)*100))/COUNT(*),2),0) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
109,Y,N,"SELECT QUERY_NAME , ROUND(AVG((RATING/POSITION)),2) AS QUALITY , ROUND(COUNT(CASE WHEN RATING < 3 THEN RESULT END)/COUNT(DISTINCT RESULT)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
110,Y,Y,"SELECT QUERY_NAME , ROUND(AVG(R),2) AS QUALITY, ROUND(SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)/COUNT(RATING)*100,2) AS POOR_QUERY_PERCENTAGE FROM( SELECT * , RATING/POSITION AS R FROM QUERIES )A GROUP BY QUERY_NAME"
111,Y,Y,"SELECT QUERY_NAME , ROUND(AVG(RATING/POSITION), 2) AS QUALITY , ROUND(COUNT(CASE WHEN RATING < 3 THEN RESULT ELSE NULL END)/COUNT(RESULT)*100 , 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
112,Y,Y,"SELECT QUERY_NAME , ROUND(AVG(RATING/POSITION),2) AS QUALITY , ROUND((AVG(CASE WHEN RATING<3 THEN 1 ELSE 0 END))*100,2) POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
113,Y,Y,"SELECT QUERY_NAME , ROUND(SUM(RATING/POSITION)/COUNT(*),2) AS QUALITY , COALESCE(ROUND((SUM(CASE WHEN RATING<3 THEN 1 ELSE 0 END)*100/COUNT(*)),2),0) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
114,Y,Y,"SELECT QUERY_NAME , ROUND(SUM(RATING/POSITION)/COUNT(*),2) AS QUALITY , ROUND(AVG(RATING<3)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
115,Y,Y,"SELECT QUERY_NAME , ROUND(SUM(RATING/POSITION)/COUNT(RESULT),2) AS QUALITY, ROUND(SUM(IF(RATING<3,1,0))/COUNT(RESULT)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
116,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION), 2) AS QUALITY, ROUND(SUM(RATING < 3) * 100 / COUNT(*), 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
117,Y,Y,"SELECT QUERY_NAME, CAST(SUM(RATING/POSITION)/COUNT(QUERY_NAME) AS DECIMAL(32,2)) QUALITY, CAST(SUM(CASE WHEN RATING<3 THEN 1 ELSE 0 END)/COUNT(QUERY_NAME)*100 AS DECIMAL(32,2)) POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
118,Y,Y,"SELECT QUERY_NAME, COALESCE(ROUND(AVG(RATING/POSITION),2),0) AS QUALITY, COALESCE(ROUND(SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)*100 / COUNT(*),2),0) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
119,Y,Y,"SELECT QUERY_NAME, ROUND((AVG(RATING/POSITION)),2) AS QUALITY, ROUND(100*SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)/COUNT(*), 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
120,Y,Y,"SELECT QUERY_NAME, ROUND((SUM(RATING/POSITION) / COUNT(QUERY_NAME) ),2) AS QUALITY , ROUND (AVG(RATING<3)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
121,Y,Y,"SELECT QUERY_NAME, ROUND((SUM(RATING/POSITION)/COUNT(*)), 2) QUALITY, ROUND(COUNT(CASE WHEN RATING < 3 THEN RATING END)/COUNT(*)*100 ,2) POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
122,Y,Y,"SELECT QUERY_NAME, ROUND((SUM(RATING/POSITION)/COUNT(*)),2) AS QUALITY, IFNULL(ROUND((SUM(CASE WHEN RATING < 3 THEN 1 ELSE NULL END)/COUNT(*))*100,2),0) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
123,Y,Y,"SELECT QUERY_NAME, ROUND((SUM(RATING/POSITION)/COUNT(QUERY_NAME)),2) AS QUALITY, ROUND(100*(SUM(IF(RATING<3,1,0))/COUNT(QUERY_NAME)),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
124,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(Q.RATING/POSITION),2) AS QUALITY , ROUND((SUM(RATING < 3) / COUNT(QUERY_NAME)) * 100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES Q GROUP BY QUERY_NAME"
125,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(QUA), 2) AS QUALITY, ROUND(AVG(POOR_QUERY)*100, 2) AS POOR_QUERY_PERCENTAGE FROM (SELECT QUERY_NAME, RATING, RATING/POSITION AS QUA ,IF(RATING>=3, 0 ,1) AS POOR_QUERY FROM QUERIES) TEMP GROUP BY QUERY_NAME"
126,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(QUA), 2) QUALITY, ROUND(SUM(RR) / COUNT(QUERY_NAME) * 100, 2) POOR_QUERY_PERCENTAGE FROM ( SELECT QUERY_NAME, RESULT, POSITION, RATING, RATING/POSITION QUA, (CASE WHEN RATING < 3 THEN 1 ELSE 0 END) RR FROM QUERIES) CTE GROUP BY 1"
127,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(QUALITY),2) AS QUALITY, ROUND((AVG(POOR_CHECK) * 100),2) AS POOR_QUERY_PERCENTAGE FROM (SELECT QUERY_NAME, POSITION, RATING, (CASE WHEN RATING < 3 THEN 1 ELSE 0 END ) AS POOR_CHECK, RATING/POSITION AS QUALITY FROM QUERIES )A GROUP BY QUERY_NAME"
128,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(QUALITYRATE),2)AS QUALITY, ROUND(AVG(RATE)*100,2) AS POOR_QUERY_PERCENTAGE FROM( SELECT QUERY_NAME, RESULT, POSITION, RATING, (RATING/POSITION) AS QUALITYRATE, (CASE WHEN RATING<3 THEN 1 ELSE 0 END) AS RATE FROM QUERIES ) TEM GROUP BY QUERY_NAME"
129,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING / POSITION ), 2) AS QUALITY, ROUND(100 * SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END) / COUNT(1), 2) POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
130,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING / POSITION), 2) AS QUALITY, ROUND((SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END) / COUNT(*))*100, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
131,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING / POSITION), 2) AS QUALITY, ROUND((SUM(IF(RATING < 3, 1, 0)) / COUNT(1))* 100, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
132,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING / POSITION), 2) AS QUALITY, ROUND(100 * SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END) / COUNT(*), 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
133,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING / POSITION), 2) AS QUALITY, ROUND(100 * SUM(RATING < 3) / COUNT(*), 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
134,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING / POSITION),2) QUALITY, ROUND((AVG(CASE WHEN RATING<3 THEN 1 ELSE 0 END))*100,2) POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
135,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING / POSITION*1.0), 2) AS QUALITY, ROUND( SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END) * 100.0 / COUNT(*) , 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
136,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING*1.00/POSITION),2) AS QUALITY, ROUND(AVG(RATING <3)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
137,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/ POSITION), 2) QUALITY, ROUND((SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)/ COUNT(1)) * 100 , 2) POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
138,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION) ,2) AS QUALITY, ROUND(100 * SUM(IF(RATING<3,1,0))/COUNT(*), 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
139,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION), 2) AS QUALITY, ROUND((AVG(CASE WHEN RATING < 3 THEN 1 ELSE 0 END))*100, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
140,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION), 2) AS QUALITY, ROUND((AVG(RATING<3)*100),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
141,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION), 2) AS QUALITY, ROUND((SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)/COUNT(1))*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
142,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION), 2) AS QUALITY, ROUND((SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)/COUNT(QUERY_NAME))* 100, 2)POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
143,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION), 2) AS QUALITY, ROUND((SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)/COUNT(RATING))*100, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
144,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION), 2) AS QUALITY, ROUND(100*SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END) / COUNT(RATING), 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
145,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION), 2) AS QUALITY, ROUND(SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)*100 / COUNT(POSITION), 2) POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
146,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION), 2) AS QUALITY, ROUND(SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)/COUNT(*) * 100, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
147,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION), 2) AS QUALITY, ROUND(SUM(CASE WHEN RATING<3 THEN 1 ELSE 0 END)*100/COUNT(*), 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
148,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION), 2) QUALITY, ROUND((SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)/COUNT(*))*100, 2) POOR_QUERY_PERCENTAGE FROM QUERIES Q GROUP BY QUERY_NAME"
149,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND((SUM(CASE WHEN RATING<3 THEN 1 ELSE 0 END)/COUNT(QUERY_NAME))*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
150,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND((SUM(RATING < 3)/COUNT(RATING))*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
151,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND((SUM(RATING <3)/COUNT(*)) * 100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
152,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(100*COUNT(CASE WHEN RATING < 3 THEN 1 END) / COUNT(QUERY_NAME), 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
153,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(AVG(RATING < 3) * 100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME ORDER BY QUERY_NAME"
154,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(COUNT(IF(RATING<3,RESULT,NULL))/COUNT(RESULT)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
155,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)*100/COUNT(POSITION),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
156,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)/COUNT(RESULT)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
157,Y,N,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(SUM(CASE WHEN RATING <3 THEN 1 ELSE 0 END)/COUNT(*)*100,2) AS POOR_QUERY_PERCENTAGE FROM (SELECT DISTINCT * FROM QUERIES) Q GROUP BY 1"
158,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(SUM(CASE WHEN RATING <3 THEN 1 ELSE 0 END)/COUNT(*)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1 ORDER BY 1 DESC"
159,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(SUM(IF(RATING<3, 1, 0))*100/SUM(1),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
160,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(SUM(IF(RATING<3, 100, 0))/COUNT(RATING),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
161,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(SUM(IF(RATING<3,1,0))/COUNT(*) * 100 ,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
162,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(SUM(IF(RATING<3,1,0))/COUNT(QUERY_NAME)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
163,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(SUM(IF(RATING<3,1,0))/COUNT(QUERY_NAME)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
164,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) QUALITY, ROUND((SUM(IF(RATING<3,1,0))/COUNT(QUERY_NAME))*100,2) POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
165,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) QUALITY, ROUND(100*SUM(RATING<3)/COUNT(RATING),2) POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
166,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) QUALITY, ROUND(AVG(CASE WHEN RATING< 3 THEN 1 ELSE 0 END)*100,2) POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
167,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) QUALITY, ROUND(AVG(RATING<3)*100,2) POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
168,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) QUALITY, ROUND(COUNT(CASE WHEN RATING<3 THEN 1 END)/COUNT(QUERY_NAME)*100,2) POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
169,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2)AS QUALITY , ROUND(100*AVG(CASE WHEN RATING < 3 THEN 1 ELSE 0 END),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
170,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RP),2) AS QUALITY, ROUND(SUM(RATING_LT_3)/COUNT(RATING)*100,2) AS POOR_QUERY_PERCENTAGE FROM (SELECT QUERY_NAME, RATING/POSITION AS RP, CASE WHEN RATING < 3 THEN 1 ELSE 0 END AS RATING_LT_3, RATING FROM QUERIES) SUB GROUP BY QUERY_NAME"
171,Y,Y,"SELECT QUERY_NAME, ROUND(COALESCE(AVG(RATING/POSITION), 0),2) QUALITY, ROUND(COALESCE(SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)/COUNT(RATING),0)*100, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
172,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(QUAL)/COUNT(1),2) QUALITY, ROUND(SUM(POOR)/COUNT(1)*100,2) POOR_QUERY_PERCENTAGE FROM ( SELECT QUERY_NAME, (RATING / POSITION ) QUAL, CASE WHEN RATING<3 THEN 1 ELSE 0 END POOR FROM QUERIES) AS BASE GROUP BY QUERY_NAME"
173,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING / POSITION) / COUNT(*), 2) AS QUALITY, ROUND(SUM(IF(RATING < 3, 1, 0)) * 100 / COUNT(*),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
174,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING*1.0/POSITION)/COUNT(1),2) AS QUALITY, ROUND(SUM(CASE WHEN RATING<3 THEN 1 ELSE 0 END)*100/COUNT(1),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
175,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION) /COUNT(QUERY_NAME),2) AS QUALITY, ROUND(100*SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)/COUNT(QUERY_NAME),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
176,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/ COUNT(QUERY_NAME), 2) AS QUALITY, ROUND(COUNT(CASE WHEN RATING < 3 THEN 1 END)/ COUNT(QUERY_NAME)*100, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
177,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(*),2) AS QUALITY, ROUND((SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)/COUNT(*))*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
178,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(*),2) AS QUALITY, ROUND(COUNT(CASE WHEN RATING<3 THEN RATING END)/COUNT(*)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
179,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(*),2) AS QUALITY, ROUND(SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)*100/COUNT(*),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
180,Y,N,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(DISTINCT RESULT),2) AS QUALITY, ROUND((COUNT(CASE WHEN RATING<3 THEN RATING ELSE NULL END)/COUNT(DISTINCT RESULT))*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME ORDER BY QUERY_NAME"
181,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(QUERY_NAME), 2) AS QUALITY, ROUND(100*SUM(IF(RATING < 3, 1, 0))/COUNT(QUERY_NAME), 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
182,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(QUERY_NAME),2) AS QUALITY, ROUND((AVG(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)*100),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
183,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(QUERY_NAME),2) AS QUALITY, COALESCE(ROUND(SUM(CASE WHEN RATING < 3 THEN 1 END)/COUNT(QUERY_NAME)*100,2),0.00000) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
184,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(QUERY_NAME),2) AS QUALITY, ROUND(100 * AVG(RATING < 3), 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
185,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(QUERY_NAME),2) AS QUALITY, ROUND(SUM(IF(RATING<3,1,0))*100/COUNT(QUERY_NAME),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
186,Y,Y,"SELECT QUERY_NAME,ROUND(1.0*AVG(RATING/POSITION), 2) AS QUALITY, ROUND(100.0*SUM(CASE WHEN RATING <3 THEN 1 ELSE 0 END)/COUNT(1),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
187,Y,Y,"SELECT QUERY_NAME,ROUND(AVG(NEW_RATE),2) AS QUALITY,ROUND(SUM(RATING_1)/COUNT(QUERY_NAME)*100,2) AS POOR_QUERY_PERCENTAGE FROM (SELECT QUERY_NAME,RATING/POSITION AS NEW_RATE,CASE WHEN RATING<3 THEN 1 ELSE 0 END AS RATING_1 FROM QUERIES)A GROUP BY QUERY_NAME"
188,Y,Y,"SELECT QUERY_NAME,ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(100*AVG(IF(RATING > 2,0,1)),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
189,Y,Y,"SELECT QUERY_NAME,ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(AVG(POORRATING)*100,2) AS POOR_QUERY_PERCENTAGE FROM ( SELECT QUERY_NAME,POSITION,RATING, (CASE WHEN RATING <3 THEN 1 ELSE 0 END) AS POORRATING FROM QUERIES)TEMP GROUP BY QUERY_NAME"
190,Y,Y,"SELECT QUERY_NAME,ROUND(AVG(RATING/POSITION),2)AS QUALITY,ROUND(SUM(CASE WHEN RATING <3 THEN 1 ELSE 0 END)*100/COUNT(QUERY_NAME),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
191,Y,Y,"SELECT QUERY_NAME,ROUND(AVG(RATING/POSITION),2)QUALITY, ROUND(100 * AVG(RATING < 3),2)POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
192,Y,Y,"SELECT QUERY_NAME,ROUND(SUM(RATING/POSITION)/COUNT(POSITION),2) AS QUALITY, ROUND((SUM(CASE WHEN RATING<3 THEN 1 ELSE 0 END)/COUNT(RATING))*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
193,Y,Y,"SELECT T.QUERY_NAME,ROUND(AVG(QUALITY),2) AS QUALITY,ROUND(SUM(CASE WHEN R.RATING<3 THEN 1 ELSE 0 END)/COUNT(R.RATING)*100,2) AS POOR_QUERY_PERCENTAGE FROM (SELECT QUERY_NAME, RATING/POSITION AS QUALITY FROM QUERIES ) T, QUERIES R WHERE R.QUERY_NAME = T.QUERY_NAME GROUP BY T.QUERY_NAME"
194,Y,Y,"SELECT T1.QUERY_NAME, ROUND(T1.QUALITY_SUM/T2.CNT,2) AS QUALITY, ROUND((T1.POOR_QUERY/T2.CNT)*100,2) AS POOR_QUERY_PERCENTAGE FROM ( (SELECT QUERY_NAME, SUM(RATIO) AS QUALITY_SUM, SUM(POOR) AS POOR_QUERY FROM ( SELECT QUERY_NAME, RATING/POSITION AS RATIO, CASE WHEN RATING<3 THEN 1 ELSE 0 END AS POOR FROM QUERIES ) AS A GROUP BY QUERY_NAME) AS T1 LEFT JOIN (SELECT QUERY_NAME,COUNT(*) AS CNT FROM QUERIES GROUP BY QUERY_NAME) AS T2 ON T1.QUERY_NAME = T2.QUERY_NAME )"
195,Y,Y,"WITH CTE AS ( SELECT QUERY_NAME, RATING, POSITION, RESULT, CASE WHEN RATING < 3 THEN 1 ELSE 0 END AS POOR_QUALITY_NUMBER FROM QUERIES ) SELECT QUERY_NAME, ROUND(SUM(RATING / POSITION)/COUNT(RESULT),2) AS QUALITY, ROUND(100*SUM(POOR_QUALITY_NUMBER)/COUNT(RESULT),2) AS POOR_QUERY_PERCENTAGE FROM CTE GROUP BY QUERY_NAME"
196,Y,Y,"WITH A AS( SELECT QUERY_NAME, (COUNT(CASE WHEN RATING<3 THEN 1 ELSE NULL END)/COUNT(RATING))*100 AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME), B AS ( SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(RATING),2) AS QUALITY FROM QUERIES GROUP BY QUERY_NAME) SELECT B.QUERY_NAME,B.QUALITY, ROUND(A.POOR_QUERY_PERCENTAGE,2) AS POOR_QUERY_PERCENTAGE FROM A JOIN B ON B.QUERY_NAME = A.QUERY_NAME"
197,Y,Y,"WITH CTE AS( SELECT QUERY_NAME, COUNT(*) AS TOTAL_COUNT, SUM(RATING/POSITION) AS TOTAL_POSITION, SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END) AS TOTAL_RATING FROM QUERIES GROUP BY QUERY_NAME ) SELECT QUERY_NAME, ROUND((TOTAL_POSITION/TOTAL_COUNT), 2) AS QUALITY, ROUND((TOTAL_RATING/TOTAL_COUNT)*100.00, 2) AS POOR_QUERY_PERCENTAGE FROM CTE"
198,Y,Y,"WITH CTE AS ( SELECT * , ROUND(AVG(RATING/POSITION) OVER (PARTITION BY QUERY_NAME),2) AS QUALITY, COUNT(RESULT) OVER (PARTITION BY QUERY_NAME) AS TOTAL, COUNT(CASE WHEN RATING<3 THEN 1 END) OVER (PARTITION BY QUERY_NAME) AS GOOD FROM QUERIES ) SELECT DISTINCT QUERY_NAME, QUALITY, ROUND(GOOD*100/TOTAL,2) AS POOR_QUERY_PERCENTAGE FROM CTE"
199,Y,Y,"WITH CTE AS ( SELECT QUERY_NAME, RATING/POSITION AS RATIO, RATING, POSITION FROM QUERIES ) SELECT QUERY_NAME, ROUND(AVG(RATIO),2) AS QUALITY, ROUND((SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END) / COUNT(*)) * 100,2) AS POOR_QUERY_PERCENTAGE FROM CTE GROUP BY QUERY_NAME"
200,Y,Y,"WITH CTE AS ( SELECT QUERY_NAME,RESULT,POSITION,RATING, CASE WHEN RATING<3 THEN 1 ELSE 0 END AS STATUS FROM QUERIES ) SELECT QUERY_NAME,ROUND(SUM(RATING/POSITION)/COUNT(*),2) AS QUALITY, ROUND((SUM(STATUS)/COUNT(*))*100,2) AS POOR_QUERY_PERCENTAGE FROM CTE GROUP BY QUERY_NAME"
201,Y,Y,"WITH CTE_QUALITY AS ( SELECT QUERY_NAME, ROUND( AVG(RATING / POSITION), 2 ) AS QUALITY, ROUND( 100 * AVG(RATING < 3), 2 ) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1 ) SELECT * FROM CTE_QUALITY"
202,Y,Y,"WITH METRICS AS ( SELECT *, RATING *1.0 / POSITION AS QUALITY, IF(RATING < 3,1,0) AS IS_POOR_QUERY FROM QUERIES ) SELECT QUERY_NAME, ROUND(AVG(QUALITY),2) AS QUALITY, ROUND(AVG(IS_POOR_QUERY)*100,2) AS POOR_QUERY_PERCENTAGE FROM METRICS GROUP BY 1"
203,Y,Y,"WITH QUALITY AS ( SELECT DISTINCT QUERY_NAME, ROUND(AVG(RATING/POSITION) OVER (PARTITION BY QUERY_NAME),2) AS QUALITY FROM QUERIES) SELECT A.QUERY_NAME, QUALITY, ROUND((SUM(A.POOR_QUERY)/COUNT(A.QUERY_NAME))*100,2) AS POOR_QUERY_PERCENTAGE FROM ( SELECT QUERY_NAME, CASE WHEN RATING<3 THEN 1 ELSE 0 END AS POOR_QUERY FROM QUERIES ) A LEFT JOIN QUALITY ON QUALITY.QUERY_NAME=A.QUERY_NAME GROUP BY A.QUERY_NAME, QUALITY"
204,Y,Y,"WITH TEMP AS ( SELECT QUERY_NAME, RATING/POSITION AS QUALITY, CASE WHEN RATING<3 THEN 1 ELSE 0 END AS POOR FROM QUERIES ) SELECT QUERY_NAME, ROUND(AVG(QUALITY),2) AS QUALITY, ROUND(AVG(POOR)*100,2) AS POOR_QUERY_PERCENTAGE FROM TEMP GROUP BY QUERY_NAME"
205,Y,Y,"WITH TMP AS (SELECT QUERY_NAME, ROUND(IFNULL(AVG(RATING/POSITION), 0.00), 2) AS QUALITY FROM QUERIES GROUP BY QUERY_NAME), TB1 AS( SELECT QUERY_NAME, COUNT(RATING) AS NUMER1 FROM QUERIES WHERE RATING < 3 GROUP BY QUERY_NAME), TB2 AS ( SELECT QUERY_NAME, COUNT(RATING) AS DENOM FROM QUERIES GROUP BY QUERY_NAME), TB3 AS( SELECT QUERY_NAME, 0 AS NUMER2 FROM QUERIES WHERE RATING >= 3 GROUP BY QUERY_NAME), TB4 AS ( SELECT QUERY_NAME, NUMER1 AS NUMER3 FROM TB1 UNION ALL SELECT QUERY_NAME, NUMER2 FROM TB3), TB5 AS ( SELECT QUERY_NAME, SUM(NUMER3) AS NUMER FROM TB4 GROUP BY QUERY_NAME) SELECT TMP.QUERY_NAME, QUALITY, ROUND(IFNULL(NUMER / DENOM * 100, 0.00), 2) AS POOR_QUERY_PERCENTAGE FROM TMP LEFT JOIN TB5 ON TB5.QUERY_NAME = TMP.QUERY_NAME LEFT JOIN TB2 ON TMP.QUERY_NAME = TB2.QUERY_NAME"
206,Y,Y,"WITH X AS ( SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(*),2) AS QUALITY FROM QUERIES GROUP BY 1 ), Y AS ( SELECT Q.QUERY_NAME, ROUND((COUNT(RATING)/(SELECT COUNT(*) FROM QUERIES WHERE Q.QUERY_NAME = QUERY_NAME GROUP BY QUERY_NAME))*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES AS Q WHERE RATING < 3 GROUP BY 1 ) SELECT X.QUERY_NAME,X.QUALITY, CASE WHEN Y.POOR_QUERY_PERCENTAGE IS NULL THEN 0 ELSE Y.POOR_QUERY_PERCENTAGE END AS POOR_QUERY_PERCENTAGE FROM X LEFT JOIN Y ON X.QUERY_NAME = Y.QUERY_NAME"
207,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING / POSITION), 2) AS QUALITY, ROUND(COUNT(IF(RATING < 3, 1, NULL)) / COUNT(*) * 100, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
208,Y,Y,"WITH A AS ( SELECT * , IF(RATING < 3, 1, 0) AS IS_POOR_QUALITY FROM QUERIES ) SELECT QUERY_NAME , ROUND(AVG(RATING / POSITION), 2) AS QUALITY , ROUND(SUM(IS_POOR_QUALITY) / COUNT(1) * 100, 2) AS POOR_QUERY_PERCENTAGE FROM A GROUP BY QUERY_NAME"
209,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND( 100.0* COUNT( CASE WHEN RATING <3 THEN 1 ELSE NULL END) / COUNT(*) ,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
210,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION), 2) AS QUALITY, ROUND(COUNT(IF(RATING<3, RATING, NULL))/COUNT(RATING)*100, 2)AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
211,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/ POSITION)/COUNT(*),2) QUALITY, ROUND(SUM((RATING < 3) = TRUE)/COUNT(*)*100,2) POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
212,Y,Y,"SELECT QUERY_NAME , ROUND(AVG(RATING / POSITION), 2) AS QUALITY , ROUND(100*AVG(CASE WHEN RATING < 3 THEN 1 ELSE 0 END), 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
213,Y,Y,"WITH A AS(SELECT QUERY_NAME, RATING, RATING/POSITION AS QUALITY, CASE WHEN RATING < 3 THEN 1 ELSE 0 END AS POOR_QUERY FROM QUERIES) SELECT QUERY_NAME,ROUND(SUM(QUALITY)/COUNT(QUALITY),2) AS QUALITY, ROUND(SUM(POOR_QUERY)/COUNT(POOR_QUERY)*100,2) AS POOR_QUERY_PERCENTAGE FROM A GROUP BY QUERY_NAME"
214,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(QUALITY)/COUNT(*),2) AS QUALITY , ROUND(100*AVG(CASE WHEN RATING <3 THEN 1 ELSE 0 END),2) AS POOR_QUERY_PERCENTAGE FROM ( SELECT QUERY_NAME, RATING, RATING/POSITION AS QUALITY FROM QUERIES) AS MT GROUP BY QUERY_NAME"
215,Y,Y,"WITH NEW AS (SELECT QUERY_NAME, POSITION, RATING, CASE WHEN RATING < 3 THEN 1 ELSE 0 END AS POORORNOT, RATING / POSITION AS RATIO FROM QUERIES) SELECT QUERY_NAME, ROUND(AVG(RATIO), 2) AS QUALITY, ROUND(SUM(POORORNOT = 1) / COUNT(POORORNOT) * 100, 2) AS POOR_QUERY_PERCENTAGE FROM NEW GROUP BY QUERY_NAME"
216,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING / POSITION), 2) AS QUALITY, ROUND(100 * SUM(RATING < 3)/ COUNT(RATING), 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
217,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(1), 2) AS QUALITY, ROUND(SUM(IF(RATING<3, 1, 0))/COUNT(1) * 100, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
218,Y,Y,"SELECT DISTINCT(QUERY_NAME), ROUND(AVG(RATING/POSITION), 2) AS QUALITY, ROUND(100*SUM(RATING<3)/COUNT(RATING), 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
219,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2)QUALITY, ROUND(SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)*100/COUNT(*),2) POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
220,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(100*SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END) / COUNT(*) ,2) POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
221,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(QUALITY),2) AS QUALITY, ROUND(AVG(PCT) * 100, 2) AS POOR_QUERY_PERCENTAGE FROM ( SELECT QUERY_NAME, RATING/POSITION AS QUALITY, CASE WHEN RATING < 3 THEN 1 ELSE 0 END AS PCT FROM QUERIES ) T GROUP BY QUERY_NAME"
222,Y,Y,"SELECT QUERY_NAME , ROUND(AVG(RATING / POSITION), 2) AS QUALITY , ROUND(SUM(IF(RATING < 3, 1, 0)) / COUNT(1) * 100, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
223,Y,Y,"SELECT QUERY_NAME, ROUND((AVG(RATING/POSITION)),2) QUALITY, ROUND((AVG(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)*100),2) POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
224,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(*),2) AS QUALITY, ROUND(SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)*100.00/COUNT(*),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
225,Y,Y,"SELECT QUERY_NAME, ROUND((AVG(RATING/POSITION)),2) AS QUALITY, ROUND(((SUM(CASE WHEN RATING<3 THEN 1 ELSE 0 END))/COUNT(*))*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
226,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(RATING),2) AS QUALITY , ROUND((SUM(CASE WHEN RATING<3 THEN 1 ELSE 0 END)/COUNT(RATING))*100, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
227,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(QUERY_NAME),2) QUALITY, ROUND(SUM(IF(RATING<3,1,0))/COUNT(QUERY_NAME)*100,2) POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
228,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND((SUM(CASE WHEN RATING <3 THEN 1 ELSE 0 END)*100/COUNT(*)),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
229,Y,Y,"SELECT DISTINCT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(AVG(CASE WHEN RATING<3 THEN 1 ELSE 0 END)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
230,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING / POSITION)/COUNT(*),2) QUALITY, ROUND(SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)/COUNT(*)*100,2) POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
231,Y,Y,"SELECT QUERY_NAME, ROUND((SUM(RATING/POSITION))/COUNT(RESULT),2) AS QUALITY, ROUND(SUM(RATING<3)*100 / COUNT(RATING), 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
232,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(*),2) AS QUALITY, ROUND((SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)/COUNT(*))*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME ORDER BY QUERY_NAME"
233,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(RATING), 2) AS QUALITY, ROUND((SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)/COUNT(RATING)) * 100, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
234,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(*),2) AS QUALITY , ROUND(SUM(RATING<3)/COUNT(*)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
235,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(IFNULL(RATING /POSITION, 0)),2) AS QUALITY, ROUND(AVG(IF(RATING < 3, 1, 0))*100.0, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
236,Y,Y,"SELECT QUERY_NAME, ROUND((SUM(RATING/POSITION))/COUNT(*), 2) AS QUALITY, ROUND(SUM(RATING < 3)/(COUNT(*))*100, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
237,Y,Y,"SELECT QUERY_NAME, ROUND((SUM(RATING / POSITION) / COUNT(QUERY_NAME)),2) AS QUALITY, ROUND(SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END ) / COUNT(QUERY_NAME) *100 , 2)AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
238,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(100*SUM(IF(RATING<3,1,0))/COUNT(RATING),2) POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
239,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING / POSITION), 2) QUALITY, ROUND((SUM(POOR_COUNT) / TOTAL * 100), 2) AS POOR_QUERY_PERCENTAGE FROM ( SELECT QUERY_NAME, POSITION, RATING, COUNT(QUERY_NAME) OVER(PARTITION BY(QUERY_NAME)) TOTAL, CASE WHEN RATING < 3 THEN 1 ELSE 0 END AS POOR_COUNT FROM QUERIES ) A GROUP BY QUERY_NAME"
240,Y,Y,"WITH CTE AS (SELECT QUERY_NAME, RATING,POSITION, CASE WHEN RATING <3 THEN 1 ELSE 0 END AS POOR_QUERY_PERCENTAGE FROM QUERIES) SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(SUM(POOR_QUERY_PERCENTAGE)/ COUNT(POOR_QUERY_PERCENTAGE)*100,2) AS POOR_QUERY_PERCENTAGE FROM CTE GROUP BY QUERY_NAME"
241,Y,Y,"SELECT DISTINCT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) QUALITY, ROUND((COUNT(IF(RATING<3,1,NULL))/COUNT(*))*100,2) POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
242,Y,Y,"SELECT QUERY_NAME , ROUND(SUM(RATING/POSITION)/COUNT(*),2) AS QUALITY, ROUND((SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)/COUNT(*))*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
243,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING / POSITION), 2) AS QUALITY, ROUND( COUNT(CASE WHEN RATING < 3 THEN 1 ELSE NULL END) * 100 / COUNT(*), 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
244,Y,Y,"SELECT QUERY_NAME, ROUND((SUM(RATING/ POSITION)/COUNT(POSITION)),2) AS QUALITY, ROUND((SUM(CASE WHEN RATING<3 THEN 1 ELSE 0 END)/ COUNT(RATING)*100),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
245,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) QUALITY, ROUND(AVG(RATING<3),4)*100 POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
246,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(100*IFNULL(SUM(CASE WHEN RATING<3 THEN 1 ELSE 0 END),0)/COUNT(RATING),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
247,Y,Y,"WITH A AS (SELECT QUERY_NAME, COUNT(CASE WHEN RATING < 3 THEN 1 END) AS POOR_RATING_COUNT FROM QUERIES GROUP BY QUERY_NAME) SELECT QUERIES.QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(QUERIES.QUERY_NAME),2) AS QUALITY, ROUND(A.POOR_RATING_COUNT/COUNT(QUERIES.QUERY_NAME)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES, A WHERE A.QUERY_NAME = QUERIES.QUERY_NAME GROUP BY QUERIES.QUERY_NAME"
248,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION), 2) QUALITY, ROUND(SUM(IF(RATING < 3, 1, 0))/COUNT(*)*100, 2) POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
249,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(*), 2) AS QUALITY, ROUND(SUM(IF(RATING < 3, 1, 0)) * 100 / COUNT(*), 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
250,Y,Y,"SELECT QUERY_NAME, ROUND((SUM(RATING/POSITION)/COUNT(QUERY_NAME)),2) AS QUALITY , ROUND((SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)/COUNT(QUERY_NAME))*100 ,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
251,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(RESULT), 2) AS QUALITY, ROUND(COUNT(IF(RATING < 3, RATING, NULL))/COUNT(RATING) * 100, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
252,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND((SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)/COUNT(1)) *100,2 ) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
253,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(SUM(RATING < 3)*100/COUNT(RATING) , 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
254,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING / POSITION), 2) QUALITY, ROUND(AVG(CASE WHEN RATING < 3 THEN 1 ELSE 0 END) * 100, 2) POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
255,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING / POSITION), 2) AS QUALITY, ROUND(COUNT(CASE WHEN RATING < 3 THEN 1 ELSE NULL END) / COUNT(*) * 100, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
256,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(*),2) QUALITY, ROUND(AVG(IF(RATING<3,1,0))*100,2) POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
257,Y,Y,"WITH CTE AS (SELECT *, RATING/POSITION AS QUAL, CASE WHEN RATING < 3 THEN 1 ELSE 0 END AS POOR FROM QUERIES) SELECT QUERY_NAME, ROUND(AVG(QUAL),2) AS QUALITY, ROUND(100*SUM(POOR)/COUNT(*), 2) AS POOR_QUERY_PERCENTAGE FROM CTE GROUP BY QUERY_NAME"
258,Y,Y,"SELECT DISTINCT SUB.QUERY_NAME, ROUND(AVG(SUB.QUALITY),2) AS QUALITY, ROUND((COUNT(SUB.BAD)/(COUNT(SUB.QUALITY)))*100,2) AS POOR_QUERY_PERCENTAGE FROM (SELECT QUERY_NAME, RATING/POSITION AS QUALITY, CASE WHEN RATING < 3 THEN 1 ELSE NULL END AS BAD FROM QUERIES) SUB GROUP BY 1"
259,Y,Y,"SELECT DISTINCT QUERY_NAME, ROUND((SUM(RATING/POSITION) / COUNT(RATING)),2) AS QUALITY, ROUND(SUM(CASE WHEN RATING<3 THEN 1 ELSE 0 END)*100/ COUNT(QUERY_NAME),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
260,Y,Y,"SELECT DISTINCT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(SUM(CASE WHEN RATING<3 THEN 1 ELSE 0 END)/COUNT(*)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
261,Y,Y,"SELECT QUERY_NAME , CAST( AVG( RATING /POSITION ) AS DECIMAL(5, 2) ) AS QUALITY , CAST( SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END ) / COUNT(*) AS DECIMAL(10, 4) ) * 100 AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
262,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY,ROUND(SUM(RATING <3)*100/COUNT(QUERY_NAME),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
263,Y,Y,"SELECT QUERY_NAME,ROUND((SUM(RATING/POSITION)*1.0/COUNT(QUERY_NAME)),2) AS QUALITY,ROUND( (SUM(CASE WHEN RATING<3 THEN 1 ELSE 0 END)/COUNT(QUERY_NAME))*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
264,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(*),2) AS QUALITY , ROUND(SUM(CASE WHEN RATING <3 THEN 1 ELSE 0 END)*100/COUNT(*),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME ORDER BY QUERY_NAME ASC"
265,Y,Y,"SELECT A.QUERY_NAME, ROUND(SUM(A.RATIO)/COUNT(A.RATIO),2) AS QUALITY ,ROUND(SUM(A.POOR)/COUNT(A.POOR)*100,2) AS POOR_QUERY_PERCENTAGE FROM (SELECT QUERY_NAME,RESULT,(RATING/POSITION)AS RATIO, (CASE WHEN RATING<3 THEN 1 ELSE 0 END) AS POOR FROM QUERIES) AS A GROUP BY A.QUERY_NAME"
266,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND((SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)*100)/COUNT(RATING),2)AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
267,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING / POSITION), 2) AS QUALITY, ROUND(COUNT(CASE WHEN RATING < 3 THEN 1 END)/COUNT(QUERY_NAME)*100, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
268,Y,Y,"SELECT QUERIES.QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(QUERIES.QUERY_NAME),2) AS QUALITY, ROUND(A.POOR_RATING_COUNT/COUNT(QUERIES.QUERY_NAME)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES, (SELECT QUERY_NAME, COUNT(CASE WHEN RATING < 3 THEN 1 END) AS POOR_RATING_COUNT FROM QUERIES GROUP BY QUERY_NAME) A WHERE A.QUERY_NAME = QUERIES.QUERY_NAME GROUP BY QUERIES.QUERY_NAME"
269,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(1),2) AS QUALITY, ROUND(100*SUM(IF(RATING<3,1,0))/COUNT(1),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
270,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(COUNT(IF(RATING<3,QUERY_NAME,NULL))/COUNT(*)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
271,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND( SUM( CASE ((RATING) < 3) WHEN TRUE THEN 1 ELSE 0 END ) / COUNT(*)*100,2) POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
272,Y,Y,"WITH CTE AS (SELECT QUERY_NAME, RATING/POSITION AS RATIO, CASE WHEN RATING < 3 THEN 1 ELSE 0 END AS POOR FROM QUERIES) SELECT QUERY_NAME, ROUND(AVG(RATIO), 2) AS QUALITY, ROUND(SUM(POOR)/COUNT(*)*100, 2) AS POOR_QUERY_PERCENTAGE FROM CTE GROUP BY QUERY_NAME"
273,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION), 2) AS QUALITY, ROUND(AVG(IF(RATING < 3, 1, 0)*100), 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
274,Y,Y,"WITH A AS ( SELECT QUERY_NAME, COUNT(RATING) AS POOR_RATING FROM QUERIES WHERE RATING < 3 GROUP BY QUERY_NAME ) SELECT Q.QUERY_NAME, ROUND(AVG(RATING / POSITION),2) AS QUALITY, ROUND(100.0 * IFNULL(A.POOR_RATING, 0) / COUNT(RATING),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES Q LEFT JOIN A ON Q.QUERY_NAME = A.QUERY_NAME GROUP BY QUERY_NAME"
275,Y,Y,"SELECT QUERY_NAME, ROUND(AVG((RATING/POSITION)), 2) AS QUALITY, ROUND(SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)/COUNT(RATING)*100, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
276,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING*1.0/POSITION), 2) AS QUALITY, ROUND(SUM(IF(RATING<3, 1,0))*100.0/COUNT(*),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
277,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING / POSITION), 2) QUALITY, ROUND(AVG(IF(RATING<3, 1, 0))*100, 2) POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
278,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) QUALITY, ROUND(SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)/ COUNT(*)*100,2) POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
279,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(*),2) AS QUALITY, ROUND(AVG(B)*100,2) POOR_QUERY_PERCENTAGE FROM( SELECT QUERY_NAME,IF(RATING<3,1,0) B,RATING,POSITION FROM QUERIES) C GROUP BY QUERY_NAME"
280,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(*),2) AS QUALITY, ROUND(COUNT(IF(RATING<3,RATING,NULL))*100/COUNT(*),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
281,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(COUNT(CASE WHEN RATING <3 THEN 1 ELSE NULL END)/COUNT(*)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
282,Y,Y,"SELECT QUERY_NAME , ROUND(AVG(RATING*100 / POSITION), 0)/100 AS QUALITY , ROUND(SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END )*100 / COUNT(*), 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
283,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION) / COUNT(*),2) AS QUALITY, ROUND(SUM(RATING < 3)*100 / COUNT(RATING),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
284,Y,N,"SELECT QUERY_NAME,ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND((CAST(COUNT(CASE WHEN RATING < 3 THEN 1 ELSE NULL END) AS FLOAT)/COUNT(*))*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME ORDER BY QUERY_NAME"
285,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(CASE WHEN RATING <3 THEN 1 ELSE 0 END)*100/COUNT(RATING),2) AS POOR_QUERY_PERCENTAGE, ROUND(AVG(RATING/POSITION),2) AS QUALITY FROM QUERIES GROUP BY QUERY_NAME"
286,Y,Y,"SELECT QUERY_NAME, ROUND((SUM(RATING/POSITION)/COUNT(QUERY_NAME)),2) AS QUALITY, ROUND(SUM(CASE WHEN RATING<3 THEN 1 ELSE 0 END)/COUNT(*)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
287,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING / POSITION), 2) AS QUALITY, ROUND(SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END) / COUNT(1) * 100.0, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
288,Y,Y,"WITH CTE AS ( SELECT QUERY_NAME, SUM(RATING/POSITION) QUALITY, COUNT(*) CNT , SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END ) AS POOR_QUALITY FROM QUERIES GROUP BY 1) SELECT QUERY_NAME, ROUND(QUALITY/CNT,2) AS POOR_QUERY_PERCENTAGE, ROUND((POOR_QUALITY/CNT)*100,2) AS QUALITY FROM CTE"
289,Y,N,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/SUM(1),2) AS QUALITY, ROUND(SUM(CASE WHEN RATING<3 THEN 1 ELSE 0 END)*100/SUM(1),2) AS POOR_QUERY_PERCENTAGE FROM (SELECT DISTINCT RESULT, QUERY_NAME,POSITION, RATING FROM QUERIES) Q GROUP BY QUERY_NAME"
290,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(100.0*SUM(RATING<3)/COUNT(*),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
291,Y,Y,"SELECT QUERY_NAME , IFNULL(ROUND(AVG(RATING/POSITION),2),0) AS QUALITY , IFNULL(ROUND(SUM(CASE WHEN RATING <3 THEN 1 ELSE 0 END)/ COUNT(*)*100,2),0) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
292,Y,Y,"WITH QUERY_AGGS AS (SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY FROM QUERIES GROUP BY QUERY_NAME ) SELECT A.QUERY_NAME, B.QUALITY, ROUND(COUNT(CASE WHEN RATING < 3 THEN 1 ELSE NULL END)/COUNT(A.QUERY_NAME) * 100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES AS A INNER JOIN QUERY_AGGS AS B ON A.QUERY_NAME = B.QUERY_NAME GROUP BY A.QUERY_NAME"
293,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING / POSITION) / COUNT(*), 2) AS QUALITY, ROUND((SUM(IF(RATING < 3, 1, 0))/ COUNT(*)) *100, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
294,Y,Y,"SELECT QUERY_NAME, ROUND(COALESCE(AVG(RATING/POSITION),0),2) AS QUALITY, ROUND(100*(COUNT(CASE WHEN RATING < 3 THEN 1 ELSE NULL END)/COUNT(RATING)),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
295,Y,N,"SELECT QUERY_NAME , ROUND(AVG(RATING/POSITION),2) AS QUALITY , ROUND((SUM(POOR_RATING)/COUNT(*))*100 , 2) AS POOR_QUERY_PERCENTAGE FROM (SELECT DISTINCT QUERY_NAME, RESULT, POSITION, RATING, CASE WHEN RATING < 3 THEN 1 ELSE 0 END AS POOR_RATING FROM QUERIES ) A GROUP BY 1"
296,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(*), 2) QUALITY, ROUND(SUM(RATING < 3)/COUNT(*)*100, 2) POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
297,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY , ROUND((SUM(CASE WHEN RATING <3 THEN 1 ELSE 0 END)*100/COUNT(*)),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
298,Y,Y,"WITH PART1 AS ( SELECT QUERY_NAME ,POSITION ,RATING ,RATING/POSITION AS PRE_QUALITY ,CASE WHEN RATING < 3 THEN 1 ELSE 0 END AS POOR_QUERY FROM QUERIES ) SELECT QUERY_NAME ,ROUND(AVG(PRE_QUALITY), 2) AS QUALITY ,ROUND(100 * AVG(POOR_QUERY), 2) AS POOR_QUERY_PERCENTAGE FROM PART1 GROUP BY QUERY_NAME"
299,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION), 2) AS QUALITY, ROUND(100* (SUM(IF(RATING < 3, 1, 0)) / COUNT(RATING)), 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
300,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(COUNT(CASE WHEN RATING<3 THEN QUERY_NAME END)*100/ COUNT(QUERY_NAME),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
301,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(*),2) AS QUALITY, ROUND(AVG(CASE WHEN RATING < 3 THEN 100.0 ELSE 0 END),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
302,Y,N,"SELECT QUERY_NAME ,ROUND (SUM(RATING/POSITION)/COUNT(DISTINCT RESULT),2) AS QUALITY ,ROUND (100*SUM(CASE WHEN RATING<3 THEN 1 ELSE 0 END)/COUNT(DISTINCT RESULT),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
303,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION), 2) AS QUALITY, ROUND(SUM(RATING<3)/COUNT(QUERY_NAME)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
304,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING / POSITION) / COUNT(1), 2) AS QUALITY, ROUND(100 * SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END) / COUNT(1), 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
305,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING / POSITION), 2) AS QUALITY, IFNULL(ROUND((SUM(CASE WHEN RATING < 3 THEN 1 END) / COUNT(RATING)) * 100, 2), 0) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
306,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(SUM(IF(RATING < 3, 1, 0))*100/COUNT(*),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
307,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING / POSITION) / COUNT(QUERY_NAME), 2) QUALITY, ROUND(COUNT(CASE WHEN RATING < 3 THEN 1 ELSE NULL END) / COUNT(QUERY_NAME) * 100, 2) POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
308,Y,Y,"SELECT QUERY_NAME, IFNULL(ROUND(AVG(RATING/POSITION),2),0) AS QUALITY, IFNULL(ROUND(SUM(IF(RATING<3,1,0))*100/COUNT(*),2),0) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
309,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(IFNULL(100*SUM(CASE WHEN RATING < 3 THEN 1 END)/COUNT(RATING),0),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
310,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(SUM(CASE WHEN RATING<3 THEN 1 ELSE 0 END)*100.0/COUNT(RATING),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
311,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(100*IFNULL(SUM(RATING<3),0)/COUNT(RATING),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
312,Y,Y,"SELECT QUERY_NAME, ROUND((SUM(RATING/POSITION) / COUNT(*) ),2) AS QUALITY, ROUND(100.0*SUM(IF(RATING < 3, 1,0))/COUNT(*),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
313,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION), 2) AS QUALITY, ROUND(AVG(IF(RATING < 3, 100, 0)), 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
314,Y,Y,"SELECT DISTINCT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(100*SUM(RATING < 3)/COUNT(RATING),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
315,Y,Y,"SELECT QUERY_NAME, ROUND( AVG(RATING / POSITION) , 2) AS QUALITY, ROUND( ( SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END) / COUNT(*) ) * 100.00 , 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
316,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND((SUM(RATING<3)/COUNT(QUERY_NAME) * 100),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
317,Y,Y,"WITH RES1 AS ( SELECT QUERY_NAME , ROUND(SUM(RATING/POSITION)/COUNT(RESULT),2)AS QUALITY, COUNT(RESULT) AS NUM FROM QUERIES GROUP BY QUERY_NAME), POOR AS ( SELECT QUERY_NAME ,COUNT(RATING)AS POOR_NUM FROM QUERIES WHERE RATING < 3 GROUP BY QUERY_NAME ) SELECT RES1.QUERY_NAME ,RES1.QUALITY ,IFNULL(ROUND((POOR.POOR_NUM/RES1.NUM)* 100,2),0) AS POOR_QUERY_PERCENTAGE FROM RES1 LEFT JOIN POOR ON RES1.QUERY_NAME = POOR.QUERY_NAME"
318,Y,Y,"SELECT QUERY_NAME, ROUND(IFNULL((SUM(RATING/POSITION )/COUNT(*)),0),2) AS QUALITY, ROUND(IFNULL((SUM(CASE WHEN RATING<3 THEN 1 ELSE NULL END)/COUNT(*)*100),0),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
319,Y,Y,"SELECT QUERY_NAME , ROUND(AVG(RATING/POSITION),2) QUALITY , ROUND(SUM(CASE WHEN RATING <3 THEN 1 ELSE 0 END)/COUNT(*)*100,2) POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
320,Y,Y,"SELECT QUERY_NAME, ROUND(1.00 * AVG( RATING/POSITION ), 2) AS QUALITY, ROUND( 100.00 * SUM( CASE WHEN RATING < 3 THEN 1 ELSE 0 END ) / COUNT(QUERY_NAME) ,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
321,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND((SELECT COUNT(QUERY_NAME) FROM QUERIES WHERE RATING<3 AND QUERY_NAME = Q.QUERY_NAME) / COUNT(QUERY_NAME)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES Q GROUP BY QUERY_NAME"
322,Y,Y,"WITH INTM AS ( SELECT QUERY_NAME, RESULT, RATING/POSITION AS QLTY, IF(RATING<3, 1, 0) AS POOR_QUERY FROM QUERIES ) SELECT QUERY_NAME, ROUND(AVG(QLTY),2) AS QUALITY , ROUND(AVG(POOR_QUERY) *100,2) AS POOR_QUERY_PERCENTAGE FROM INTM GROUP BY QUERY_NAME"
323,Y,Y,"SELECT DISTINCT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(*),2) AS QUALITY, ROUND(COUNT(CASE WHEN RATING < 3 THEN 1 END)/COUNT(*)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
324,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(*), 2) AS QUALITY, ROUND(SUM(IF(RATING < 3, 1, 0))/COUNT(*)*100, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
325,Y,N,"WITH CTE AS (SELECT QUERY_NAME, ROUND(SUM((RATING/POSITION))/COUNT(DISTINCT RESULT),2) AS QUALITY , ROUND(((SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)/COUNT(DISTINCT RESULT))*100),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME) SELECT QUERY_NAME, QUALITY , POOR_QUERY_PERCENTAGE FROM CTE ORDER BY QUERY_NAME DESC"
326,Y,Y,"WITH LESS_THAN3 AS (SELECT QUERY_NAME, COUNT(RATING) COUNT_LESS3 FROM QUERIES WHERE RATING<3 GROUP BY QUERY_NAME), COUNTS AS (SELECT QUERY_NAME, COUNT(RATING) COUNT_RATING FROM QUERIES GROUP BY QUERY_NAME), QUAL AS (SELECT QUERY_NAME, ROUND(AVG(QUALITY),2) QUALITY FROM (SELECT QUERY_NAME, RATING/POSITION QUALITY FROM QUERIES) Q GROUP BY QUERY_NAME) SELECT C.QUERY_NAME, Q.QUALITY, IFNULL(ROUND(100*(T.COUNT_LESS3/C.COUNT_RATING),2),0) POOR_QUERY_PERCENTAGE FROM COUNTS C LEFT JOIN LESS_THAN3 T ON C.QUERY_NAME=T.QUERY_NAME JOIN QUAL Q ON Q.QUERY_NAME=C.QUERY_NAME"
327,Y,Y,"WITH NUMERATOR AS ( SELECT QUERY_NAME, COUNT(*) AS NUM FROM QUERIES WHERE RATING < 3 GROUP BY QUERY_NAME) SELECT Q.QUERY_NAME, ROUND(AVG(Q.RATING/Q.POSITION),2) AS QUALITY, ROUND(IFNULL(((SELECT N.NUM FROM NUMERATOR N WHERE N.QUERY_NAME = Q.QUERY_NAME)/(SELECT COUNT(*) FROM QUERIES Q1 WHERE Q1.QUERY_NAME = Q.QUERY_NAME))*100,0),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES Q GROUP BY QUERY_NAME"
328,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) QUALITY, ROUND((100 * SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)/COUNT(*)),2) POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
329,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) QUALITY, ROUND(AVG(CASE WHEN RATING < 3 THEN 1 ELSE 0 END) * 100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
330,Y,N,"WITH QUERIES_DISTINCT AS (SELECT DISTINCT * FROM QUERIES) SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(SUM(CASE WHEN RATING <3 THEN 1 ELSE 0 END)/COUNT(RATING) * 100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES_DISTINCT GROUP BY QUERY_NAME"
331,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(1.0 * RATING / POSITION), 2) QUALITY, ROUND(SUM(IF(RATING < 3, 100.0, 0.0)) / COUNT(1), 2) POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
332,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND((SUM(CASE WHEN RATING < 3 THEN 100 ELSE 0 END)/ COUNT(RATING)),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
333,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION) / COUNT(QUERY_NAME), 2) AS QUALITY, ROUND(AVG(CASE WHEN RATING < 3 THEN 1 ELSE 0 END) * 100 , 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
334,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(*) ,2) AS QUALITY, ROUND((COUNT(CASE WHEN RATING<3 THEN RATING ELSE NULL END)/COUNT(*)) * 100 ,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
335,Y,N,"WITH WLS AS( SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(DISTINCT RESULT),2) AS QUALITY, ROUND(SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)/COUNT(DISTINCT RESULT)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME ) SELECT * FROM WLS"
336,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(SUM(CASE WHEN RATING<3 THEN 1 ELSE 0 END)/COUNT(Q.RATING)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES Q GROUP BY 1"
337,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(100* AVG(IF(RATING < '3',1,0)),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
338,Y,Y,"WITH T1(QUERY_NAME,RESULT,POSITION,RATING,LOWQ) AS (SELECT QUERY_NAME,RESULT,POSITION,RATING, CASE WHEN RATING < 3 THEN 1 ELSE 0 END AS LOWQ FROM QUERIES) SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY,ROUND(AVG(LOWQ*100),2)AS POOR_QUERY_PERCENTAGE FROM T1 GROUP BY QUERY_NAME"
339,Y,Y,"WITH POOR_QP AS(SELECT * , CASE WHEN RATING < 3 THEN 1 ELSE 0 END AS POOR_QP_COUNT FROM QUERIES) SELECT QUERY_NAME , ROUND(AVG(RATING / POSITION), 2) AS QUALITY , ROUND(AVG(POOR_QP_COUNT) * 100, 2) AS POOR_QUERY_PERCENTAGE FROM POOR_QP GROUP BY QUERY_NAME"
340,Y,Y,"SELECT Q.QUERY_NAME, Q.QUALITY, ROUND(100*IFNULL(Q.PR,0)/Q.NR, 2) AS POOR_QUERY_PERCENTAGE FROM (SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, COUNT(RATING) AS NR, SUM(CASE WHEN RATING<3 THEN 1 ELSE 0 END) AS PR FROM QUERIES GROUP BY QUERY_NAME ) AS Q"
341,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION), 2) AS QUALITY, ROUND((AVG(RATING<3))*100, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
342,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(*), 2) QUALITY, ROUND(COUNT(IF(RATING < 3, 1, NULL)) * 100 / COUNT(*), 2) POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
343,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION), 2) AS QUALITY, ROUND((SUM(IF(RATING<3, 1, 0))/COUNT(*))*100, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
344,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING / POSITION)/COUNT(*), 2) QUALITY, ROUND(SUM(RATING<3)/COUNT(*)*100, 2) POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
345,Y,Y,"SELECT QUERY_NAME, ROUND ( (SUM(RATING/POSITION)/COUNT(*)) ,2) AS QUALITY, ROUND ( ( SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)/COUNT(*) )*100 ,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
346,Y,Y,"WITH RATING_QUALITIES AS ( SELECT QUERY_NAME, CASE WHEN RATING < 3 THEN POOR ELSE GOOD END AS RATING_QUALITY, RATING, POSITION FROM QUERIES ) SELECT QUERY_NAME, ROUND(100*SUM(CASE WHEN RATING_QUALITY = 'POOR' THEN 1 ELSE 0 END) / COUNT(*),2) AS POOR_QUERY_PERCENTAGE, ROUND(AVG(RATING/POSITION),2) AS QUALITY FROM RATING_QUALITIES GROUP BY 1"
347,Y,Y,"SELECT QUERY_NAME, ROUND( AVG(RATING / POSITION),2) AS QUALITY, ROUND( SUM(IF(RATING < 3, 1, 0)) * 100 / COUNT(1), 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
348,Y,Y,"WITH TEMP AS ( SELECT QUERY_NAME, RATING / POSITION AS QUALITY, CASE WHEN RATING < 3 THEN 1 ELSE 0 END AS POOR_BOOL FROM QUERIES ) SELECT QUERY_NAME, ROUND(AVG(QUALITY), 2) AS QUALITY, ROUND(AVG(POOR_BOOL) * 100, 2) AS POOR_QUERY_PERCENTAGE FROM TEMP GROUP BY QUERY_NAME"
349,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(ABS(RATING/POSITION)) / COUNT(*),2) AS QUALITY , ROUND((SUM(IF(RATING < 3, 1,0)) / COUNT(*)*100), 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
350,Y,Y,"SELECT QUERY_NAME , ROUND((SUM(RATING/POSITION) / COUNT(RATING)),2) AS QUALITY, ROUND(((SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END) / COUNT(RATING) ) * 100),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
351,Y,Y,"WITH T AS (SELECT QUERY_NAME, COUNT(*) AS BAD FROM QUERIES WHERE RATING < 3 GROUP BY 1 ),T2 AS (SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION) / COUNT(*),2) AS QUALITY FROM QUERIES GROUP BY 1), T3 AS (SELECT Q.QUERY_NAME, IFNULL(ROUND(T.BAD / COUNT(*) * 100,2),0) AS POOR_QUERY_PERCENTAGE FROM QUERIES Q LEFT JOIN T ON Q.QUERY_NAME = T.QUERY_NAME GROUP BY 1 ) SELECT T2.QUERY_NAME, T2. QUALITY, T3.POOR_QUERY_PERCENTAGE FROM T2 LEFT JOIN T3 ON T2.QUERY_NAME = T3.QUERY_NAME"
352,Y,Y,"WITH QUALITY_TABLE AS( SELECT QUERY_NAME, RATING/POSITION AS QUALITY, CASE WHEN RATING < 3 THEN 1 ELSE 0 END AS POOR_QUERY FROM QUERIES ) SELECT QUERY_NAME, ROUND(AVG(QUALITY), 2) AS QUALITY, ROUND(AVG(POOR_QUERY) * 100, 2) AS POOR_QUERY_PERCENTAGE FROM QUALITY_TABLE GROUP BY QUERY_NAME"
353,Y,Y,"SELECT QUERY_NAME, ROUND(DEV/Q_CNT,2) AS QUALITY, ROUND(POOR_CNT/Q_CNT*100,2) AS POOR_QUERY_PERCENTAGE FROM ( SELECT QUERY_NAME, SUM(RATING/POSITION) AS DEV, COUNT(*) AS Q_CNT, SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END) AS POOR_CNT FROM QUERIES GROUP BY QUERY_NAME ) A GROUP BY QUERY_NAME"
354,Y,Y,"SELECT QUERY_NAME, ROUND(SUM((RATING/POSITION))/COUNT(*),2) AS QUALITY, ROUND(COUNT(CASE WHEN RATING < 3 THEN RESULT END)*100/COUNT(*),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
355,Y,Y,"SELECT QUERY_NAME, COALESCE(CAST(SUM(RATING *1.0/POSITION)/COUNT(RATING) AS DECIMAL(10,2)),0) AS QUALITY, COALESCE(CAST(SUM(CASE WHEN RATING < 3 THEN 1 END)*100/COUNT(POSITION) AS DECIMAL(10,2)),0) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
356,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING / POSITION) / COUNT(*), 2) AS QUALITY, ROUND((SUM(RATING < 3) / COUNT(RATING))*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
357,Y,Y,"SELECT QUERY_NAME, ROUND((SUM(RATING/POSITION)/COUNT(*)),2) AS QUALITY, ROUND((SUM(RATING<3)/COUNT(*))*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
358,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING / POSITION)*1.00,2) AS QUALITY, ROUND(COUNT(CASE WHEN RATING < 3 THEN RATING ELSE NULL END)/COUNT(RATING)*100.00, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
359,Y,Y,"SELECT QUERY_NAME, (ROUND(IFNULL(AVG(RATING/POSITION), 0), 2)) AS QUALITY, ROUND((IFNULL((SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END) / COUNT(RATING)), 0) * 100), 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
360,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(RATING),2) AS QUALITY, ROUND((SUM(IF(RATING<3,1, 0))/COUNT(RATING))*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
361,Y,Y,"SELECT QUERY_NAME, ROUND((SUM(RATING / POSITION) / COUNT(*)), 2) QUALITY, ROUND(((SUM(RATING < 3)/COUNT(*)) * 100), 2) POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
362,Y,Y,"SELECT QUERY_NAME, ROUND((SUM(RATING/POSITION) / COUNT(*)), 2) AS QUALITY, ROUND((SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END) *100) / COUNT(*), 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
363,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/(COUNT(*)),2) AS QUALITY, ROUND(100*SUM(CASE WHEN RATING<3 THEN 1 ELSE 0 END)/(COUNT(*)),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
364,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(*),2) AS QUALITY, ROUND(SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)/COUNT(RATING)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
365,Y,Y,"WITH T1 AS (SELECT DISTINCT QUERY_NAME, ROUND(SUM(QUALITY)/COUNT(*),2) AS TOTAL_QUALITY FROM (SELECT QUERY_NAME, RATING/POSITION AS QUALITY FROM QUERIES) TEMP GROUP BY 1), T2 AS (SELECT QUERY_NAME, ROUND(POOR_COUNT/TOTAL_COUNT*100,2) AS POOR_QUERY_PERCENTAGE FROM (SELECT DISTINCT QUERY_NAME, SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END) AS POOR_COUNT, COUNT(*) AS TOTAL_COUNT FROM QUERIES GROUP BY 1) TEMP) SELECT T1.QUERY_NAME, TOTAL_QUALITY AS QUALITY, POOR_QUERY_PERCENTAGE FROM T1 LEFT JOIN T2 ON T1.QUERY_NAME = T2.QUERY_NAME"
366,Y,Y,"WITH TEMP AS ( SELECT *, RATING / POSITION AS QUALITY_PER_QUERY FROM QUERIES ) SELECT QUERY_NAME, ROUND(AVG(QUALITY_PER_QUERY), 2) AS QUALITY, ROUND(100 * SUM(IF(RATING < 3, 1, 0)) / COUNT(1), 2) AS POOR_QUERY_PERCENTAGE FROM TEMP GROUP BY QUERY_NAME"
367,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND((100* COUNT(CASE WHEN RATING < 3 THEN 1 END)/ COUNT(RATING)),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
368,Y,Y,"SELECT QUERY_NAME ,ROUND(SUM(RATING/POSITION)/COUNT(*),2) AS QUALITY ,ROUND(COUNT(CASE WHEN RATING < 3 THEN QUERY_NAME END) /COUNT(*) * 100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
369,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(*),2) QUALITY, ROUND(100*SUM(CASE WHEN RATING<3 THEN 1 ELSE 0 END)/COUNT(*),2) POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
370,Y,Y,"WITH QUALITY AS ( SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY FROM QUERIES GROUP BY 1), POOR_RATING AS ( SELECT QUERY_NAME, SUM(CASE WHEN RATING<3 THEN 1 ELSE 0 END) AS POOR_QUERY, COUNT(*) AS TOTAL_QUERIES FROM QUERIES GROUP BY 1) SELECT A.QUERY_NAME, A.QUALITY, ROUND((B.POOR_QUERY*100/B.TOTAL_QUERIES),2) AS POOR_QUERY_PERCENTAGE FROM QUALITY AS A JOIN POOR_RATING AS B ON A.QUERY_NAME = B.QUERY_NAME GROUP BY 1, 2"
371,Y,Y,"SELECT QUERY_NAME, ROUND(COALESCE(AVG(RATING/POSITION), 0), 2) QUALITY, ROUND(COALESCE(AVG(RATING<3) * 100, 0), 2) POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
372,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(POSITION),2) AS QUALITY, ROUND(SUM(CASE WHEN RATING <3 THEN 1 ELSE 0 END)*100/COUNT(*),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
373,Y,Y,"SELECT A.QUERY_NAME, ROUND(SUM(A.RATING/A.POSITION)/COUNT(A.RESULT),2) AS QUALITY, ROUND(COUNT(CASE WHEN A.RATING<3 THEN A.RESULT END)*100/COUNT(A.RESULT),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES A GROUP BY 1"
374,Y,Y,"SELECT DISTINCT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(100*AVG(CASE WHEN RATING < 3 THEN 1 ELSE 0 END),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
375,Y,Y,"WITH T1 AS (SELECT DISTINCT QUERY_NAME, ROUND(SUM(QUALITY)/COUNT(*),2) AS TOTAL_QUALITY FROM (SELECT QUERY_NAME, RATING/POSITION AS QUALITY FROM QUERIES) TEMP GROUP BY 1), T2 AS (SELECT DISTINCT QUERY_NAME, ROUND(SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)/COUNT(*)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1) SELECT T1.QUERY_NAME, TOTAL_QUALITY AS QUALITY, POOR_QUERY_PERCENTAGE FROM T1 LEFT JOIN T2 ON T1.QUERY_NAME = T2.QUERY_NAME"
376,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/ COUNT(RATING), 2) AS QUALITY, ROUND(100*SUM(IF(RATING < 3,1,0)) / COUNT(RATING), 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
377,Y,N,"SELECT QUERY_NAME, ROUND(SUM(RA)/SUM(CNT),2) AS QUALITY, ROUND((SUM(P)/SUM(CNT))*100,2) AS POOR_QUERY_PERCENTAGE FROM ( SELECT QUERY_NAME,POSITION,RATING,SUM(RATING)/SUM(POSITION) AS RA,SUM(RATING <3) AS P, COUNT(QUERY_NAME) AS CNT FROM QUERIES GROUP BY RESULT)M GROUP BY 1"
378,Y,Y,"SELECT QUERY_NAME , ROUND(AVG(RATING/POSITION),2) AS QUALITY , 100*ROUND(SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)/COUNT(*),4) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
379,Y,Y,"SELECT A.QUERY_NAME, A.QUALITY, B.POOR_QUERY_PERCENTAGE FROM( SELECT QUERY_NAME, ROUND(IFNULL(AVG(RATING/POSITION),0),2) AS QUALITY FROM QUERIES GROUP BY QUERY_NAME) A JOIN( SELECT QUERY_NAME, ROUND(IFNULL(SUM(RATING<3)/COUNT(*)*100,0),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME) B ON A.QUERY_NAME=B.QUERY_NAME"
380,Y,N,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION), 2) AS QUALITY, ROUND(SUM(100 * CASE WHEN RATING < 3 THEN 1 ELSE 0 END)/COUNT(DISTINCT RESULT), 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
381,Y,Y,"WITH TEMP AS ( SELECT QUERY_NAME, RESULT, POSITION, RATING, RATING / POSITION AS RAT_POS, (CASE WHEN RATING < 3 THEN 1 ELSE 0 END) AS IS_POOR FROM QUERIES ) SELECT QUERY_NAME, ROUND(SUM(RAT_POS) / COUNT(*),2) AS QUALITY, ROUND(SUM(IS_POOR) *100 / COUNT(*), 2) AS POOR_QUERY_PERCENTAGE FROM TEMP GROUP BY 1"
382,Y,Y,"SELECT QUERY_NAME, CAST(SUM(RATING/POSITION)/COUNT(1) AS DECIMAL(5,2)) AS QUALITY, CAST(SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)/COUNT(1) * 100 AS DECIMAL(5,2)) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
383,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(QUALITY)/COUNT(QUALITY),2) AS QUALITY, ROUND(SUM(POOR_RATING)/COUNT(QUALITY)*100,2) AS POOR_QUERY_PERCENTAGE FROM (SELECT QUERY_NAME, RESULT, RATING/POSITION AS QUALITY, CASE WHEN RATING <3 THEN 1 ELSE 0 END AS POOR_RATING FROM QUERIES) AS Q GROUP BY QUERY_NAME"
384,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION ),2) AS QUALITY , ROUND(100*AVG(IF(RATING<3,1,0)),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
385,Y,Y,"WITH CTE1 AS ( SELECT QUERY_NAME, POSITION, RATING, RATING/POSITION AS RATIO FROM QUERIES ) SELECT QUERY_NAME, ROUND(AVG(RATIO),2) AS QUALITY, ROUND(SUM(CASE WHEN RATING<3 THEN 1 ELSE 0 END)/COUNT(RATING)*100,2) AS POOR_QUERY_PERCENTAGE FROM CTE1 GROUP BY 1"
386,Y,Y,"SELECT Q.QUERY_NAME, ROUND(AVG(Q.RATING/Q.POSITION),2) AS QUALITY , ROUND(100*AVG(Q.RATING<3),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES Q GROUP BY 1"
387,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(RATING),2) AS QUALITY, ROUND(COUNT(IF (RATING <3,RATING,NULL))/COUNT(RATING)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
388,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING / POSITION),2) AS QUALITY , ROUND(AVG(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)*100,2) POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
389,Y,Y,"SELECT A.QUERY_NAME, ROUND((SUM(A.QUAL)/ COUNT(*)), 2) AS QUALITY, ROUND((SUM(CASE WHEN A.RATING < 3 THEN 1 ELSE 0 END)*100/ COUNT(*)), 2) AS POOR_QUERY_PERCENTAGE FROM (SELECT QUERY_NAME, RATING/POSITION AS QUAL, RATING FROM QUERIES)A GROUP BY A.QUERY_NAME"
390,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING / POSITION), 2) AS QUALITY, ROUND( (SELECT COUNT(1) FROM QUERIES WHERE QUERY_NAME = Q.QUERY_NAME AND RATING < 3) / (SELECT COUNT(1) FROM QUERIES WHERE QUERY_NAME = Q.QUERY_NAME) * 100, 2 ) AS POOR_QUERY_PERCENTAGE FROM QUERIES Q GROUP BY QUERY_NAME"
391,Y,Y,"SELECT Q1.QUERY_NAME, ROUND((SUM((RATING / POSITION)) / COUNT(*)), 2) AS QUALITY, ROUND(SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END) * 100 / COUNT(*), 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES Q1 GROUP BY Q1.QUERY_NAME"
392,Y,Y,"SELECT QUERY_NAME , CAST(SUM(RATING / POSITION) / COUNT(*) AS DECIMAL(10, 2)) AS QUALITY , CAST(100 * SUM(RATING < 3) / COUNT(*) AS DECIMAL(10, 2)) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
393,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(SUM(DUMMY)/COUNT(*)*100,2) AS POOR_QUERY_PERCENTAGE FROM (SELECT *, CASE WHEN RATING<3 THEN 1 ELSE 0 END AS DUMMY FROM QUERIES) AS T1 GROUP BY QUERY_NAME"
394,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, COALESCE(ROUND(SUM(CASE WHEN RATING < 3 THEN 1 END)/COUNT(*)*100,2),0) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
395,Y,Y,"SELECT QUERY_NAME, ROUND((AVG(RATING/POSITION)),2) AS QUALITY, ROUND(SUM(RATING<3)/COUNT(QUERY_NAME)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
396,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) QUALITY, ROUND(SUM(CASE WHEN RATING<3 THEN 1 ELSE 0 END)/COUNT(QUERY_NAME)*100,2) POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
397,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(*),2) AS QUALITY, ROUND(100 * SUM(RATING<3)/COUNT(*),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
398,Y,Y,"WITH Q AS ( SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(*),2) AS QUALITY FROM QUERIES GROUP BY 1 ) , P AS ( SELECT QUERY_NAME, COUNT(*) AS BADNUM FROM QUERIES WHERE RATING <3 GROUP BY 1 ), N AS ( SELECT QUERY_NAME, COUNT(*) NUM FROM QUERIES GROUP BY 1 ) SELECT N.QUERY_NAME, Q.QUALITY, COALESCE(ROUND(P.BADNUM/N.NUM*100,2),0) AS POOR_QUERY_PERCENTAGE FROM N LEFT JOIN P ON N.QUERY_NAME=P.QUERY_NAME JOIN Q ON Q.QUERY_NAME=N.QUERY_NAME"
399,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND((SUM(IF(RATING < 3, 1, 0))/COUNT(QUERY_NAME))*100, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES Q GROUP BY QUERY_NAME"
400,Y,Y,"WITH TEMP AS ( SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(*),2) AS QUALITY, SUM(CASE WHEN RATING<3 THEN 1 ELSE 0 END) AS LESS, SUM(CASE WHEN RATING IS NOT NULL THEN 1 ELSE 0 END) AS ALLL FROM QUERIES GROUP BY QUERY_NAME ) SELECT QUERY_NAME, QUALITY, ROUND((LESS/ALLL)*100,2) AS POOR_QUERY_PERCENTAGE FROM TEMP"
401,Y,Y,"SELECT Q.QUERY_NAME, ROUND(AVG(RATING/POSITION), 2) QUALITY, IFNULL(ROUND(SUB1.CNT / COUNT(*) * 100, 2), 0.00) POOR_QUERY_PERCENTAGE FROM QUERIES Q LEFT JOIN ( SELECT QUERY_NAME, COUNT(*) CNT FROM QUERIES WHERE RATING < 3 GROUP BY QUERY_NAME) SUB1 ON Q.QUERY_NAME = SUB1.QUERY_NAME GROUP BY QUERY_NAME"
402,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND((SUM(IF(RATING<3,1,0))/COUNT(QUERY_NAME))*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
403,Y,Y,"SELECT DISTINCT QUERIES.QUERY_NAME ,ROUND(AVG(QUERIES.RATING/POSITION),2) AS QUALITY ,ROUND(AVG(QUERIES.RATING<3)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERIES.QUERY_NAME"
404,Y,Y,"SELECT QUERIES.QUERY_NAME, ROUND( AVG( QUERIES.RATING / QUERIES.POSITION), 2 ) AS QUALITY, ROUND( SUM( QUERIES.RATING < 3 ) * 100 / COUNT( QUERIES.RATING ) , 2 ) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
405,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(*),2) AS QUALITY, ROUND(AVG(IF(RATING < 3,1,0))*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
406,Y,Y,"SELECT Q.QUERY_NAME, Q.QUALITY, ROUND(100*IFNULL(P.PR,0)/Q.NR, 2) AS POOR_QUERY_PERCENTAGE FROM (SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, COUNT(RATING) AS NR FROM QUERIES GROUP BY QUERY_NAME ) AS Q LEFT JOIN (SELECT QUERY_NAME, COUNT(RATING) AS PR FROM QUERIES WHERE RATING < 3 GROUP BY QUERY_NAME ) AS P ON P.QUERY_NAME = Q.QUERY_NAME"
407,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION), 2) AS QUALITY, ROUND((SELECT SUM(RATING < 3)) * 100 / COUNT(*), 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
408,Y,Y,"SELECT SUB.QUERY_NAME, ROUND(AVG(SUB.QUALITY),2) AS QUALITY, ROUND(100*SUM(POOR_QUAL_OR_NOT)/COUNT(SUB.POSITION),2) AS POOR_QUERY_PERCENTAGE FROM (SELECT QUERY_NAME, POSITION, RATING/POSITION AS QUALITY, CASE WHEN RATING <3 THEN 1 ELSE 0 END AS POOR_QUAL_OR_NOT FROM QUERIES) SUB GROUP BY 1"
409,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) QUALITY, ROUND(SUM(RATING < 3)/COUNT(*) * 100, 2) POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
410,Y,Y,"WITH QUALITY AS (SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY FROM QUERIES GROUP BY 1), PQP AS (SELECT Q1.QUERY_NAME, ROUND((SUM(CASE WHEN RATING <3 THEN 1 ELSE 0 END)/RES)*100,2) AS PQP FROM QUERIES Q1 JOIN (SELECT QUERY_NAME,COUNT(RESULT) AS RES FROM QUERIES GROUP BY QUERY_NAME) Q ON Q1.QUERY_NAME=Q.QUERY_NAME GROUP BY 1 ) SELECT QUALITY.QUERY_NAME,QUALITY.QUALITY,PQP.PQP AS POOR_QUERY_PERCENTAGE FROM QUALITY JOIN PQP ON QUALITY.QUERY_NAME=PQP.QUERY_NAME"
411,Y,Y,"SELECT QUERY_NAME, ROUND((SUM(RATING/POSITION))/COUNT(*),2) AS QUALITY, ROUND((AVG(RATING < 3) * 100 ),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
412,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(POSITION),2) QUALITY, ROUND((SUM(IF(RATING<3, 1, 0))/COUNT(*))*100,2) POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
413,Y,Y,"SELECT QUERY_NAME,ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND((COUNT(CASE WHEN RATING < 3 THEN RATING END)/COUNT(QUERY_NAME))*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
414,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATIO),2) AS QUALITY, ROUND(SUM(POOR_QUERY)*100/COUNT(*),2) AS POOR_QUERY_PERCENTAGE FROM ( SELECT *, RATING/POSITION AS RATIO , CASE WHEN RATING < 3 THEN 1 ELSE 0 END AS POOR_QUERY FROM QUERIES ) A GROUP BY QUERY_NAME"
415,Y,Y,"WITH CTE AS ( SELECT QUERY_NAME, RATING, POSITION, CASE WHEN RATING < 3 THEN 1 ELSE 0 END AS RATING_MIN_COUNT FROM QUERIES ) SELECT QUERY_NAME,ROUND(SUM(RATING / POSITION) / COUNT(*), 2) AS QUALITY, ROUND((SUM(RATING_MIN_COUNT)/COUNT(RATING))*100,2) AS POOR_QUERY_PERCENTAGE FROM CTE GROUP BY QUERY_NAME"
416,Y,Y,"SELECT QUERY_NAME, ROUND( (SUM(RATING/POSITION)/COUNT(*)), 2) AS QUALITY, ROUND( (SUM( IF(RATING<3, 1, 0) )/ COUNT(*))*100, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
417,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(CAST(SUM(RATING < 3) AS DECIMAL)*100/COUNT(*),2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
418,Y,Y,"SELECT QUERY_NAME , ROUND(AVG(QUALITY),2) AS QUALITY, ROUND(AVG(CASE WHEN RATING<3 THEN 1 ELSE 0 END),4)*100 AS POOR_QUERY_PERCENTAGE FROM (SELECT *, RATING/POSITION AS QUALITY FROM QUERIES) AS Q1 GROUP BY QUERY_NAME"
419,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(*),2) QUALITY, ROUND(100*SUM(RATING <3)/COUNT(*),2)POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
420,Y,Y,"SELECT QUERY_NAME,ROUND(AVG(RATING/POSITION),2) QUALITY,ROUND(SUM(CASE WHEN RATING<3 THEN 1 ELSE 0 END)*100/COUNT(*),2) POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
421,Y,Y,"SELECT QUERY_NAME, ROUND((AVG(RATING / POSITION)), 2) AS QUALITY, ROUND(((SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)) / COUNT(*)) * 100.0, 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
422,Y,N,"WITH TMP AS ( SELECT DISTINCT QUERY_NAME, RESULT, POSITION,RATING FROM QUERIES ) SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(100*AVG(RATING < 3),2) AS POOR_QUERY_PERCENTAGE FROM TMP GROUP BY QUERY_NAME"
423,Y,Y,"SELECT QUERY_NAME, ROUND(SUM(RATING/POSITION)/COUNT(RATING),2) AS QUALITY, ROUND((SUM(CASE WHEN RATING <3 THEN 1 ELSE 0 END))/COUNT(RATING)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
424,Y,Y,"SELECT QUERY_NAME ,ROUND(AVG(RATING/POSITION),2) AS QUALITY ,ROUND(COUNT(IF(RATING < 3,RATING,NULL))/COUNT(RATING)*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
425,Y,Y,"WITH CTE AS ( SELECT QUERY_NAME, RATING, POSITION, CASE WHEN RATING < 3 THEN 1 ELSE 0 END AS RATING_MIN_COUNT FROM QUERIES ) SELECT QUERY_NAME,ROUND(SUM(RATING / POSITION) / COUNT(QUERY_NAME), 2) AS QUALITY, ROUND((SUM(RATING_MIN_COUNT)/COUNT(RATING))*100,2) AS POOR_QUERY_PERCENTAGE FROM CTE GROUP BY QUERY_NAME"
426,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY ,ROUND(AVG(CASE WHEN RATING<3 THEN 1 ELSE 0 END)*100,2) POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY 1"
427,Y,Y,"WITH QUALITY_RESULTS AS (SELECT QUERY_NAME,ROUND(AVG(RATING/POSITION),2) AS QUALITY FROM QUERIES GROUP BY QUERY_NAME), POOR_QUERY_PERC AS (SELECT QUERY_NAME,ROUND((SUM(CASE WHEN RATING < 3 THEN 1 ELSE 0 END)/COUNT(RATING))*100,2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME) SELECT R.QUERY_NAME,QUALITY,POOR_QUERY_PERCENTAGE FROM QUALITY_RESULTS R, POOR_QUERY_PERC P WHERE R.QUERY_NAME=P.QUERY_NAME"
428,Y,N,"WITH CTE AS( SELECT DISTINCT QUERY_NAME, RESULT, POSITION, RATING FROM QUERIES) SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(SUM(CASE WHEN RATING<3 THEN 1 ELSE 0 END)/COUNT(*)*100,2) AS POOR_QUERY_PERCENTAGE FROM CTE GROUP BY QUERY_NAME"
429,Y,Y,"SELECT S1.QUERY_NAME,S1.QUALITY,S2.POOR_QUERY_PERCENTAGE FROM (SELECT A.QUERY_NAME,ROUND((A.SUM1/B.CNT),2) AS QUALITY FROM (SELECT QUERY_NAME, SUM(RATING/POSITION) AS SUM1 FROM QUERIES GROUP BY 1)A INNER JOIN (SELECT QUERY_NAME ,COUNT(QUERY_NAME) AS CNT FROM QUERIES GROUP BY 1)B ON A.QUERY_NAME=B.QUERY_NAME) S1 INNER JOIN (SELECT A.QUERY_NAME, ROUND(((COALESCE(B.CNT1,0)/A.CNT)*100),2) AS POOR_QUERY_PERCENTAGE FROM (SELECT QUERY_NAME, COUNT(QUERY_NAME) AS CNT FROM QUERIES GROUP BY 1) A LEFT JOIN (SELECT QUERY_NAME, COUNT(QUERY_NAME) AS CNT1 FROM QUERIES WHERE RATING < 3 GROUP BY 1) B ON A.QUERY_NAME=B.QUERY_NAME) S2 ON S1.QUERY_NAME=S2.QUERY_NAME"
430,Y,Y,"SELECT QUERY_NAME, ROUND(AVG(RATING/POSITION),2) AS QUALITY, ROUND(AVG((RATING < 3) * 100), 2) AS POOR_QUERY_PERCENTAGE FROM QUERIES GROUP BY QUERY_NAME"
