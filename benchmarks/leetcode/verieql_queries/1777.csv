qid,mysql_can_execute?,mysql_correct?,mysql_query
0,Y,Y,"SELECT DISTINCT A.PRODUCT_ID, B.PRICE AS STORE1, C.PRICE AS STORE2, D.PRICE AS STORE3 FROM PRODUCTS AS A LEFT JOIN PRODUCTS AS B ON A.PRODUCT_ID = B.PRODUCT_ID AND B.STORE = 'store1' LEFT JOIN PRODUCTS AS C ON A.PRODUCT_ID = C.PRODUCT_ID AND C.STORE = 'store2' LEFT JOIN PRODUCTS AS D ON A.PRODUCT_ID = D.PRODUCT_ID AND D.STORE = 'store3'"
1,Y,Y,"SELECT DISTINCT DISTINCT PRODUCT_ID, MAX(CASE WHEN STORE = 'store1' THEN PRICE END) AS STORE1, MAX(CASE WHEN STORE = 'store2' THEN PRICE END) AS STORE2, MAX(CASE WHEN STORE = 'store3' THEN PRICE END) AS STORE3 FROM PRODUCTS GROUP BY 1"
2,Y,Y,"SELECT DISTINCT P.PRODUCT_ID, A.PRICE AS STORE1, B.PRICE AS STORE2, C.PRICE AS STORE3 FROM PRODUCTS P LEFT JOIN (SELECT PRODUCT_ID, PRICE FROM PRODUCTS WHERE STORE = 'store1') A ON P.PRODUCT_ID = A.PRODUCT_ID LEFT JOIN (SELECT PRODUCT_ID, PRICE FROM PRODUCTS WHERE STORE = 'store2') B ON B.PRODUCT_ID = P.PRODUCT_ID LEFT JOIN (SELECT PRODUCT_ID, PRICE FROM PRODUCTS WHERE STORE = 'store3') C ON C.PRODUCT_ID = P.PRODUCT_ID"
3,Y,Y,"SELECT DISTINCT PRODUCT_ID, MAX(CASE WHEN STORE='store1' THEN PRICE END) AS STORE1, MAX(CASE WHEN STORE='store2' THEN PRICE END) AS STORE2, MAX(CASE WHEN STORE='store3' THEN PRICE END) AS STORE3 FROM PRODUCTS GROUP BY 1 ORDER BY 1"
4,Y,Y,"SELECT DISTINCT PRODUCT_ID, SUM(CASE WHEN STORE = 'store1' THEN PRICE ELSE NULL END) AS STORE1, SUM(CASE WHEN STORE = 'store2' THEN PRICE ELSE NULL END) AS STORE2, SUM(CASE WHEN STORE = 'store3' THEN PRICE ELSE NULL END) AS STORE3 FROM PRODUCTS GROUP BY 1"
5,Y,Y,"SELECT DISTINCT PRODUCT_ID, SUM(CASE WHEN STORE='store1' THEN PRICE ELSE NULL END) AS STORE1, SUM(CASE WHEN STORE='store2' THEN PRICE ELSE NULL END) AS STORE2, SUM(CASE WHEN STORE='store3' THEN PRICE ELSE NULL END) AS STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID"
6,Y,Y,"SELECT P.PRODUCT_ID, STORE1, STORE2, STORE3 FROM (SELECT DISTINCT(PRODUCT_ID) FROM PRODUCTS) AS P LEFT JOIN (SELECT PRODUCT_ID, PRICE AS STORE1 FROM PRODUCTS WHERE STORE = 'store1') T1 ON P.PRODUCT_ID = T1.PRODUCT_ID LEFT JOIN (SELECT PRODUCT_ID, PRICE AS STORE2 FROM PRODUCTS WHERE STORE = 'store2') T2 ON P.PRODUCT_ID = T2.PRODUCT_ID LEFT JOIN (SELECT PRODUCT_ID, PRICE AS STORE3 FROM PRODUCTS WHERE STORE = 'store3') T3 ON P.PRODUCT_ID = T3.PRODUCT_ID"
7,Y,Y,"SELECT PRODUCT_ID, MAX(CASE WHEN STORE='store1' THEN PRICE ELSE NULL END) STORE1 , MAX(CASE WHEN STORE='store2' THEN PRICE ELSE NULL END) STORE2 , MAX(CASE WHEN STORE='store3' THEN PRICE ELSE NULL END) STORE3 FROM PRODUCTS GROUP BY 1"
8,Y,Y,"SELECT DISTINCT A.PRODUCT_ID, B.STORE1, C.STORE2,D.STORE3 FROM PRODUCTS A LEFT JOIN (SELECT PRODUCT_ID, PRICE AS STORE1 FROM PRODUCTS WHERE STORE = 'store1') B ON A.PRODUCT_ID = B.PRODUCT_ID LEFT JOIN (SELECT PRODUCT_ID, PRICE AS STORE2 FROM PRODUCTS WHERE STORE = 'store2') C ON A.PRODUCT_ID = C.PRODUCT_ID LEFT JOIN (SELECT PRODUCT_ID, PRICE AS STORE3 FROM PRODUCTS WHERE STORE = 'store3') D ON A.PRODUCT_ID = D.PRODUCT_ID"
9,Y,Y,"SELECT DISTINCT PRODUCT_ID, (SELECT PRICE FROM PRODUCTS Q WHERE STORE = 'store1' AND Q.PRODUCT_ID = P.PRODUCT_ID ) AS STORE1, (SELECT PRICE FROM PRODUCTS Q WHERE STORE = 'store2' AND Q.PRODUCT_ID = P.PRODUCT_ID ) AS STORE2, (SELECT PRICE FROM PRODUCTS Q WHERE STORE = 'store3' AND Q.PRODUCT_ID = P.PRODUCT_ID ) AS STORE3 FROM PRODUCTS AS P"
10,Y,Y,"SELECT DISTINCT PRODUCT_ID, MAX(CASE WHEN STORE = 'store1' THEN PRICE ELSE NULL END) AS STORE1, MAX(CASE WHEN STORE = 'store2' THEN PRICE ELSE NULL END) AS STORE2, MAX(CASE WHEN STORE = 'store3' THEN PRICE ELSE NULL END) AS STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID"
11,N,N,"SELECT P.PRODUCT_ID, P1.PRICE AS STORE1 ,P2.PRICE AS STORE2 ,P3.PRICE AS STORE3 FROM PRODUCTS P LEFT JOIN PRODUCTS P1 ON P1.PRODUCT_ID = P.PRODUCT_ID AND P1.STORE = 'store1' LEFT JOIN PRODUCTS P2 ON P2.PRODUCT_ID = P.PRODUCT_ID AND P2.STORE = 'store2' LEFT JOIN PRODUCTS P3 ON P3.PRODUCT_ID = P.PRODUCT_ID AND P3.STORE = 'store3' GROUP BY P.PRODUCT_ID"
12,Y,Y,"SELECT PRODUCT_ID , MAX(CASE WHEN STORE = 'store1' THEN PRICE END) AS STORE1, MAX(CASE WHEN STORE = 'store2' THEN PRICE END) AS STORE2, MAX(CASE WHEN STORE = 'store3' THEN PRICE END) AS STORE3 FROM PRODUCTS GROUP BY 1"
13,Y,Y,"SELECT PRODUCT_ID , SUM(CASE WHEN STORE = 'store1' THEN PRICE ELSE NULL END) AS STORE1 , SUM(CASE WHEN STORE = 'store2' THEN PRICE ELSE NULL END) AS STORE2 , SUM(CASE WHEN STORE = 'store3' THEN PRICE ELSE NULL END) AS STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID"
14,Y,Y,"SELECT PRODUCT_ID , SUM(CASE WHEN STORE='store1' THEN PRICE END) AS STORE1 , SUM(CASE WHEN STORE='store2' THEN PRICE END) AS STORE2 , SUM(CASE WHEN STORE='store3' THEN PRICE END) AS STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID"
15,Y,Y,"SELECT PRODUCT_ID , MAX(CASE WHEN STORE = 'store1' THEN PRICE ELSE NULL END) AS STORE1 , MAX(CASE WHEN STORE = 'store2' THEN PRICE ELSE NULL END) AS STORE2 , MAX(CASE WHEN STORE = 'store3' THEN PRICE ELSE NULL END) AS STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID"
16,Y,Y,"SELECT PRODUCT_ID ,SUM(CASE WHEN STORE ='store1' THEN PRICE END )AS STORE1, SUM(CASE WHEN STORE ='store2' THEN PRICE END )AS STORE2, SUM(CASE WHEN STORE ='store3' THEN PRICE END )AS STORE3 FROM PRODUCTS GROUP BY 1"
17,Y,Y,"SELECT PRODUCT_ID ,SUM(IF(STORE = 'store1',PRICE,NULL)) AS STORE1 ,SUM(IF(STORE = 'store2',PRICE,NULL)) AS STORE2 ,SUM(IF(STORE = 'store3',PRICE,NULL)) AS STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID"
18,Y,Y,"SELECT PRODUCT_ID AS PRODUCT_ID , MAX(IF(STORE = 'store1' ,PRICE, NULL)) AS STORE1 , MAX(IF(STORE = 'store2' ,PRICE, NULL)) AS STORE2 , MAX(IF(STORE = 'store3' ,PRICE, NULL)) AS STORE3 FROM PRODUCTS GROUP BY 1"
19,Y,Y,"SELECT PRODUCT_ID, (SELECT PRICE FROM PRODUCTS Q WHERE STORE = 'store1' AND Q.PRODUCT_ID = P.PRODUCT_ID ) AS STORE1, (SELECT PRICE FROM PRODUCTS Q WHERE STORE = 'store2' AND Q.PRODUCT_ID = P.PRODUCT_ID ) AS STORE2, (SELECT PRICE FROM PRODUCTS Q WHERE STORE = 'store3' AND Q.PRODUCT_ID = P.PRODUCT_ID ) AS STORE3 FROM PRODUCTS AS P GROUP BY PRODUCT_ID"
20,Y,Y,"SELECT PRODUCT_ID, CASE WHEN SUM(STORE = 'store1') = 0 THEN NULL ELSE SUM((STORE = 'store1') * PRICE) END AS STORE1, CASE WHEN SUM(STORE = 'store2') = 0 THEN NULL ELSE SUM((STORE = 'store2') * PRICE) END AS STORE2, CASE WHEN SUM(STORE = 'store3') = 0 THEN NULL ELSE SUM((STORE = 'store3') * PRICE) END AS STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID"
21,Y,Y,"SELECT PRODUCT_ID, MAX(CASE WHEN STORE = 'store1' THEN PRICE END) AS STORE1, MAX(CASE WHEN STORE = 'store2' THEN PRICE END) AS STORE2, MAX(CASE WHEN STORE = 'store3' THEN PRICE END) AS STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID"
22,Y,Y,"SELECT PRODUCT_ID, MAX(CASE WHEN STORE = 'store1' THEN PRICE END) AS STORE1, MAX(CASE WHEN STORE = 'store2' THEN PRICE END) AS STORE2, MAX(CASE WHEN STORE = 'store3' THEN PRICE END) AS STORE3 FROM PRODUCTS P GROUP BY PRODUCT_ID"
23,Y,Y,"SELECT PRODUCT_ID, MAX(CASE WHEN STORE = 'store1' THEN PRICE END) STORE1, MAX(CASE WHEN STORE = 'store2' THEN PRICE END) STORE2, MAX(CASE WHEN STORE = 'store3' THEN PRICE END) STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID"
24,Y,Y,"SELECT PRODUCT_ID, MAX(CASE STORE WHEN 'store1' THEN PRICE END) AS STORE1, MAX(CASE STORE WHEN 'store2' THEN PRICE END) AS STORE2, MAX(CASE STORE WHEN 'store3' THEN PRICE END) AS STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID"
25,Y,Y,"SELECT PRODUCT_ID, MAX(STORE1) STORE1, MAX(STORE2) STORE2, MAX(STORE3) STORE3 FROM (SELECT PRODUCT_ID, PRICE STORE1, NULL STORE2, NULL STORE3 FROM PRODUCTS WHERE STORE = 'store1' UNION SELECT PRODUCT_ID, NULL STORE1, PRICE STORE2, NULL STORE3 FROM PRODUCTS WHERE STORE = 'store2' UNION SELECT PRODUCT_ID, NULL STORE1, NULL STORE2, PRICE STORE3 FROM PRODUCTS WHERE STORE = 'store3') U GROUP BY PRODUCT_ID"
26,Y,Y,"SELECT PRODUCT_ID, MIN(CASE WHEN STORE = 'store1' THEN PRICE END) AS STORE1, MIN(CASE WHEN STORE = 'store2' THEN PRICE END) AS STORE2, MIN(CASE WHEN STORE = 'store3' THEN PRICE END) AS STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID"
27,Y,Y,"SELECT PRODUCT_ID, MIN(CASE STORE WHEN 'store1' THEN PRICE END) AS STORE1, MIN(CASE STORE WHEN 'store2' THEN PRICE END) AS STORE2, MIN(CASE STORE WHEN 'store3' THEN PRICE END) AS STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID"
28,Y,Y,"SELECT PRODUCT_ID, MIN(IF(STORE='store1', PRICE, NULL)) AS STORE1, MIN(IF(STORE='store2', PRICE, NULL)) AS STORE2, MIN(IF(STORE='store3', PRICE, NULL)) AS STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID"
29,Y,Y,"SELECT PRODUCT_ID, NULLIF(SUM(IF(STORE='store1', PRICE, 0)), 0) AS STORE1, NULLIF(SUM(IF(STORE='store2', PRICE, 0)), 0) AS STORE2, NULLIF(SUM(IF(STORE='store3', PRICE, 0)), 0) AS STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID ORDER BY PRODUCT_ID"
30,Y,Y,"SELECT PRODUCT_ID, SUM( CASE WHEN STORE = 'store1' THEN PRICE ELSE NULL END) STORE1, SUM( CASE WHEN STORE = 'store2' THEN PRICE ELSE NULL END) STORE2, SUM( CASE WHEN STORE = 'store3' THEN PRICE ELSE NULL END) STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID"
31,Y,Y,"SELECT PRODUCT_ID, SUM(CASE WHEN STORE = 'store1' THEN PRICE ELSE NULL END) AS STORE1, SUM(CASE WHEN STORE = 'store2' THEN PRICE ELSE NULL END) AS STORE2, SUM(CASE WHEN STORE = 'store3' THEN PRICE ELSE NULL END) AS STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID ORDER BY PRODUCT_ID"
32,Y,Y,"SELECT PRODUCT_ID, SUM(CASE WHEN STORE = 'store1' THEN PRICE ELSE NULL END) AS STORE1, SUM(CASE WHEN STORE = 'store2' THEN PRICE ELSE NULL END) AS STORE2, SUM(CASE WHEN STORE = 'store3' THEN PRICE ELSE NULL END) AS STORE3 FROM PRODUCTS GROUP BY PRODUCTS.PRODUCT_ID"
33,Y,Y,"SELECT PRODUCT_ID, MAX(CASE WHEN STORE = 'store1' THEN PRICE ELSE NULL END) AS STORE1, MAX(CASE WHEN STORE = 'store2' THEN PRICE ELSE NULL END) AS STORE2, MAX(CASE WHEN STORE = 'store3' THEN PRICE ELSE NULL END) AS STORE3 FROM PRODUCTS GROUP BY 1"
34,Y,Y,"SELECT PRODUCT_ID, MAX(IF(STORE='store1', PRICE, NULL)) AS STORE1, MAX(IF(STORE='store2', PRICE, NULL)) AS STORE2, MAX(IF(STORE='store3', PRICE, NULL)) AS STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID"
35,Y,Y,"SELECT PRODUCT_ID, SUM(CASE WHEN STORE = 'store1' THEN PRICE ELSE NULL END) AS STORE1, SUM(CASE WHEN STORE = 'store2' THEN PRICE END) AS STORE2, SUM(CASE WHEN STORE = 'store3' THEN PRICE END) AS STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID"
36,Y,Y,"SELECT TEMP.PRODUCT_ID AS PRODUCT_ID, TEMP1.STORE1 AS STORE1, TEMP2.STORE2 AS STORE2, TEMP3.STORE3 AS STORE3 FROM (SELECT DISTINCT PRODUCT_ID FROM PRODUCTS) TEMP LEFT JOIN (SELECT PRODUCT_ID, PRICE AS STORE1 FROM PRODUCTS WHERE STORE='store1') TEMP1 ON TEMP.PRODUCT_ID = TEMP1.PRODUCT_ID LEFT JOIN (SELECT PRODUCT_ID, PRICE AS STORE2 FROM PRODUCTS WHERE STORE='store2') TEMP2 ON TEMP.PRODUCT_ID = TEMP2.PRODUCT_ID LEFT JOIN (SELECT PRODUCT_ID, PRICE AS STORE3 FROM PRODUCTS WHERE STORE='store3') TEMP3 ON TEMP.PRODUCT_ID = TEMP3.PRODUCT_ID"
37,Y,Y,"SELECT DISTINCT PRODUCT_ID, MAX(CASE WHEN STORE='store1' THEN PRICE END) AS STORE1, MAX(CASE WHEN STORE='store2' THEN PRICE END) AS STORE2, MAX(CASE WHEN STORE='store3' THEN PRICE END) AS STORE3 FROM PRODUCTS GROUP BY 1"
38,Y,Y,"SELECT PRODUCT_ID, SUM(CASE WHEN STORE = 'store1' THEN PRICE END) STORE1 , SUM(CASE WHEN STORE = 'store2' THEN PRICE END) STORE2 , SUM(CASE WHEN STORE = 'store3' THEN PRICE END) STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID"
39,Y,Y,"SELECT PRODUCT_ID, SUM(IF(STORE = 'store1', PRICE, NULL)) AS STORE1, SUM(IF(STORE = 'store2', PRICE, NULL)) AS STORE2, SUM(IF(STORE = 'store3', PRICE, NULL)) AS STORE3 FROM PRODUCTS P GROUP BY PRODUCT_ID"
40,Y,Y,"WITH S0 AS (SELECT DISTINCT PRODUCT_ID FROM PRODUCTS), S1 AS (SELECT PRODUCT_ID, PRICE AS STORE1 FROM PRODUCTS WHERE STORE='store1'), S2 AS (SELECT PRODUCT_ID, PRICE AS STORE2 FROM PRODUCTS WHERE STORE='store2'), S3 AS (SELECT PRODUCT_ID, PRICE AS STORE3 FROM PRODUCTS WHERE STORE='store3') SELECT S0.PRODUCT_ID, S1.STORE1, S2.STORE2, S3.STORE3 FROM S0 LEFT JOIN S1 ON S0.PRODUCT_ID=S1.PRODUCT_ID LEFT JOIN S2 ON S0.PRODUCT_ID=S2.PRODUCT_ID LEFT JOIN S3 ON S0.PRODUCT_ID=S3.PRODUCT_ID"
41,Y,Y,"WITH S1 AS ( SELECT PRODUCT_ID, PRICE AS STORE1 FROM PRODUCTS WHERE STORE = 'store1' ), S2 AS ( SELECT PRODUCT_ID, PRICE AS STORE2 FROM PRODUCTS WHERE STORE = 'store2' ), S3 AS ( SELECT PRODUCT_ID, PRICE AS STORE3 FROM PRODUCTS WHERE STORE = 'store3' ), DISTINCT_PROD AS ( SELECT DISTINCT(PRODUCT_ID) FROM PRODUCTS ) SELECT DP.PRODUCT_ID, S1.STORE1, S2.STORE2, S3.STORE3 FROM DISTINCT_PROD AS DP LEFT JOIN S1 ON DP.PRODUCT_ID = S1.PRODUCT_ID LEFT JOIN S2 ON DP.PRODUCT_ID = S2.PRODUCT_ID LEFT JOIN S3 ON DP.PRODUCT_ID = S3.PRODUCT_ID"
42,Y,Y,"WITH T0 AS (SELECT DISTINCT PRODUCT_ID FROM PRODUCTS), T1 AS (SELECT PRODUCT_ID, PRICE AS PRICE1 FROM PRODUCTS WHERE STORE='store1'), T2 AS (SELECT PRODUCT_ID, PRICE AS PRICE2 FROM PRODUCTS WHERE STORE='store2'), T3 AS (SELECT PRODUCT_ID, PRICE AS PRICE3 FROM PRODUCTS WHERE STORE='store3') SELECT T0.PRODUCT_ID, T1.PRICE1 AS STORE1, T2.PRICE2 AS STORE2, T3.PRICE3 AS STORE3 FROM T0 LEFT JOIN T1 ON T0.PRODUCT_ID=T1.PRODUCT_ID LEFT JOIN T2 ON T0.PRODUCT_ID=T2.PRODUCT_ID LEFT JOIN T3 ON T0.PRODUCT_ID=T3.PRODUCT_ID ORDER BY PRODUCT_ID"
43,Y,Y,"WITH EXPLODED AS ( SELECT PRODUCT_ID, CASE WHEN STORE = 'store1' THEN PRICE END AS STORE1, CASE WHEN STORE = 'store2' THEN PRICE END AS STORE2, CASE WHEN STORE = 'store3' THEN PRICE END AS STORE3 FROM PRODUCTS ) SELECT PRODUCT_ID, SUM(STORE1) AS STORE1, SUM(STORE2) AS STORE2, SUM(STORE3) AS STORE3 FROM EXPLODED GROUP BY PRODUCT_ID"
44,Y,Y,"WITH NEW_PRODUCTS AS( SELECT PRODUCT_ID , CASE WHEN STORE = 'store1' THEN PRICE ELSE NULL END AS STORE1 , CASE WHEN STORE = 'store2' THEN PRICE ELSE NULL END AS STORE2 , CASE WHEN STORE = 'store3' THEN PRICE ELSE NULL END AS STORE3 FROM PRODUCTS ) SELECT PRODUCT_ID , SUM(STORE1) AS STORE1 , SUM(STORE2) AS STORE2 , SUM(STORE3) AS STORE3 FROM NEW_PRODUCTS GROUP BY 1"
45,Y,Y,"WITH S1 AS (SELECT PRODUCT_ID, PRICE AS STORE1 FROM PRODUCTS WHERE STORE='store1'), S2 AS (SELECT PRODUCT_ID, PRICE AS STORE2 FROM PRODUCTS WHERE STORE='store2'), S3 AS (SELECT PRODUCT_ID, PRICE AS STORE3 FROM PRODUCTS WHERE STORE='store3'), P AS (SELECT DISTINCT PRODUCT_ID FROM PRODUCTS) SELECT P.PRODUCT_ID, STORE1, STORE2, STORE3 FROM P LEFT JOIN S1 USING(PRODUCT_ID) LEFT JOIN S2 USING(PRODUCT_ID) LEFT JOIN S3 USING(PRODUCT_ID)"
46,Y,Y,"WITH SUB AS (SELECT DISTINCT PRODUCT_ID, CASE WHEN STORE = 'store1' THEN PRICE END AS STORE1 , CASE WHEN STORE = 'store2' THEN PRICE END AS STORE2 , CASE WHEN STORE = 'store3' THEN PRICE END AS STORE3 FROM PRODUCTS ) SELECT PRODUCT_ID, SUM(STORE1) AS STORE1, SUM(STORE2) AS STORE2, SUM(STORE3) AS STORE3 FROM SUB GROUP BY PRODUCT_ID"
47,Y,Y,"WITH T1 AS (SELECT PRODUCT_ID, CASE WHEN STORE = 'store1' THEN PRICE ELSE NULL END AS STOR1, CASE WHEN STORE = 'store2' THEN PRICE ELSE NULL END AS STOR2, CASE WHEN STORE = 'store3' THEN PRICE ELSE NULL END AS STOR3 FROM PRODUCTS) SELECT PRODUCT_ID, MAX(STOR1) STORE1, MAX(STOR2) STORE2, MAX(STOR3) STORE3 FROM T1 GROUP BY PRODUCT_ID"
48,Y,Y,"WITH T1 AS (SELECT PRODUCT_ID, CASE WHEN STORE='store1' THEN PRICE ELSE NULL END AS STORE1, CASE WHEN STORE='store2' THEN PRICE ELSE NULL END AS STORE2, CASE WHEN STORE='store3' THEN PRICE ELSE NULL END AS STORE3 FROM PRODUCTS) SELECT PRODUCT_ID, MAX(STORE1) AS STORE1, MAX(STORE2) AS STORE2, MAX(STORE3) AS STORE3 FROM T1 GROUP BY PRODUCT_ID"
49,Y,Y,"SELECT A.PRODUCT_ID, SUM(STORE1) AS STORE1, SUM(STORE2) AS STORE2, SUM(STORE3) AS STORE3 FROM ( SELECT PRODUCT_ID, CASE WHEN STORE='store1' THEN PRICE ELSE NULL END AS STORE1 , CASE WHEN STORE='store2' THEN PRICE ELSE NULL END AS STORE2 , CASE WHEN STORE='store3' THEN PRICE ELSE NULL END AS STORE3 FROM PRODUCTS ) A GROUP BY A.PRODUCT_ID"
50,Y,Y,"SELECT A.PRODUCT_ID,B.PRICE AS STORE1,C.PRICE AS STORE2, D.PRICE AS STORE3 FROM PRODUCTS A LEFT JOIN PRODUCTS B ON A.PRODUCT_ID=B.PRODUCT_ID AND B.STORE = 'store1' LEFT JOIN PRODUCTS C ON A.PRODUCT_ID=C.PRODUCT_ID AND C.STORE = 'store2' LEFT JOIN PRODUCTS D ON A.PRODUCT_ID=D.PRODUCT_ID AND D.STORE = 'store3' GROUP BY 1,2,3,4"
51,Y,Y,"SELECT A.PRODUCT_ID,SUM(A.STORE1) AS STORE1,SUM(A.STORE2) AS STORE2,SUM(A.STORE3) AS STORE3 FROM (SELECT PRODUCT_ID, (CASE WHEN STORE='store1' THEN PRICE END) AS STORE1, (CASE WHEN STORE='store2' THEN PRICE END) AS STORE2, (CASE WHEN STORE='store3' THEN PRICE END) AS STORE3 FROM PRODUCTS) A GROUP BY A.PRODUCT_ID"
52,Y,Y,"SELECT DISTINCT P.PRODUCT_ID, P1.PRICE AS STORE1, P2.PRICE AS STORE2, P3.PRICE AS STORE3 FROM PRODUCTS P LEFT JOIN PRODUCTS P1 ON P.PRODUCT_ID = P1.PRODUCT_ID AND P1.STORE = 'store1' LEFT JOIN PRODUCTS P2 ON P.PRODUCT_ID = P2.PRODUCT_ID AND P2.STORE = 'store2' LEFT JOIN PRODUCTS P3 ON P.PRODUCT_ID = P3.PRODUCT_ID AND P3.STORE = 'store3'"
53,Y,Y,"SELECT DISTINCT P.PRODUCT_ID, STORE1, STORE2, STORE3 FROM PRODUCTS P LEFT JOIN (SELECT PRODUCT_ID, PRICE AS STORE1 FROM PRODUCTS WHERE STORE = 'store1') S1 ON P.PRODUCT_ID = S1.PRODUCT_ID LEFT JOIN (SELECT PRODUCT_ID, PRICE AS STORE2 FROM PRODUCTS WHERE STORE = 'store2') S2 ON P.PRODUCT_ID = S2.PRODUCT_ID LEFT JOIN (SELECT PRODUCT_ID, PRICE AS STORE3 FROM PRODUCTS WHERE STORE = 'store3') S3 ON P.PRODUCT_ID = S3.PRODUCT_ID"
54,Y,Y,"SELECT DISTINCT P.PRODUCT_ID,T1.PRICE AS STORE1,T2.PRICE AS STORE2,T3.PRICE AS STORE3 FROM PRODUCTS P LEFT JOIN ( SELECT PRODUCT_ID,PRICE FROM PRODUCTS WHERE STORE='store1') T1 ON P.PRODUCT_ID=T1.PRODUCT_ID LEFT JOIN ( SELECT PRODUCT_ID,PRICE FROM PRODUCTS WHERE STORE='store2') T2 ON P.PRODUCT_ID=T2.PRODUCT_ID LEFT JOIN ( SELECT PRODUCT_ID,PRICE FROM PRODUCTS WHERE STORE='store3') T3 ON P.PRODUCT_ID=T3.PRODUCT_ID"
55,Y,Y,"SELECT DISTINCT P1.PRODUCT_ID, SUM(CASE WHEN P1.STORE = 'store1' THEN P1.PRICE ELSE NULL END) AS STORE1, SUM(CASE WHEN P1.STORE = 'store2' THEN P1.PRICE ELSE NULL END) AS STORE2, SUM(CASE WHEN P1.STORE = 'store3' THEN P1.PRICE ELSE NULL END) AS STORE3 FROM PRODUCTS P1 GROUP BY P1.PRODUCT_ID"
56,Y,Y,"SELECT DISTINCT PRODUCT_ID, (SELECT PRICE FROM PRODUCTS P1 WHERE STORE='store1'AND P.PRODUCT_ID=P1.PRODUCT_ID) AS STORE1, (SELECT PRICE FROM PRODUCTS P2 WHERE STORE='store2' AND P.PRODUCT_ID=P2.PRODUCT_ID) AS STORE2, (SELECT PRICE FROM PRODUCTS P3 WHERE STORE='store3' AND P.PRODUCT_ID=P3.PRODUCT_ID) AS STORE3 FROM PRODUCTS P"
57,Y,Y,"SELECT DISTINCT PRODUCT_ID, SUM(CASE WHEN STORE= 'store1' THEN COALESCE(PRICE,0) END) AS STORE1, SUM(CASE WHEN STORE= 'store2' THEN COALESCE(PRICE,0) END) AS STORE2, SUM(CASE WHEN STORE= 'store3' THEN COALESCE(PRICE,0) END) AS STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID"
58,Y,Y,"SELECT DISTINCT PRODUCT_ID, SUM(CASE WHEN STORE= 'store1' THEN COALESCE(PRICE,NULL) END) AS STORE1, SUM(CASE WHEN STORE= 'store2' THEN COALESCE(PRICE,NULL) END) AS STORE2, SUM(CASE WHEN STORE= 'store3' THEN COALESCE(PRICE,NULL) END) AS STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID"
59,Y,Y,"SELECT DISTINCT X.PRODUCT_ID, A.STORE1, B.STORE2, C.STORE3 FROM PRODUCTS X LEFT JOIN (SELECT PRODUCT_ID, PRICE AS STORE1 FROM PRODUCTS WHERE STORE='store1') A ON X.PRODUCT_ID = A.PRODUCT_ID LEFT JOIN (SELECT PRODUCT_ID, PRICE AS STORE2 FROM PRODUCTS WHERE STORE='store2') B ON X.PRODUCT_ID = B.PRODUCT_ID LEFT JOIN (SELECT PRODUCT_ID, PRICE AS STORE3 FROM PRODUCTS WHERE STORE='store3') C ON X.PRODUCT_ID = C.PRODUCT_ID"
60,Y,Y,"SELECT DISTINCT(PRODUCT_ID) AS PRODUCT_ID, MAX(CASE WHEN STORE = 'store1' THEN PRICE END) AS STORE1, MAX(CASE WHEN STORE = 'store2' THEN PRICE END) AS STORE2, MAX(CASE WHEN STORE = 'store3' THEN PRICE END) AS STORE3 FROM PRODUCTS GROUP BY 1"
61,Y,Y,"SELECT F1.PRODUCT_ID, STORE1, STORE2, STORE3 FROM ( SELECT DISTINCT PRODUCT_ID FROM PRODUCTS) F1 LEFT JOIN ( SELECT PRODUCT_ID, SUM(CASE WHEN STORE = 'store1' THEN PRICE END) STORE1 FROM PRODUCTS GROUP BY PRODUCT_ID) F2 ON F1.PRODUCT_ID = F2.PRODUCT_ID LEFT JOIN ( SELECT PRODUCT_ID, SUM(CASE WHEN STORE = 'store2' THEN PRICE END) STORE2 FROM PRODUCTS GROUP BY PRODUCT_ID) F3 ON F1.PRODUCT_ID = F3.PRODUCT_ID LEFT JOIN ( SELECT PRODUCT_ID, SUM(CASE WHEN STORE = 'store3' THEN PRICE END) STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID) F4 ON F1.PRODUCT_ID = F4.PRODUCT_ID"
62,N,N,"SELECT P.PRODUCT_ID, A.PRICE AS STORE1, B.PRICE AS STORE2, C.PRICE AS STORE3 FROM PRODUCTS P LEFT JOIN (SELECT PRICE,PRODUCT_ID FROM PRODUCTS WHERE STORE='store1') A ON P.PRODUCT_ID=A.PRODUCT_ID LEFT JOIN (SELECT PRICE,PRODUCT_ID FROM PRODUCTS WHERE STORE='store2') B ON P.PRODUCT_ID=B.PRODUCT_ID LEFT JOIN (SELECT PRICE,PRODUCT_ID FROM PRODUCTS WHERE STORE='store3') C ON P.PRODUCT_ID=C.PRODUCT_ID GROUP BY P.PRODUCT_ID"
63,Y,Y,"SELECT PRODUCT_ID , MAX(IF(STORE='store1', PRICE, NULL)) AS STORE1 , MAX(IF(STORE='store2', PRICE, NULL)) AS STORE2 , MAX(IF(STORE='store3', PRICE, NULL)) AS STORE3 FROM PRODUCTS GROUP BY 1"
64,Y,Y,"SELECT PRODUCT_ID , SUM(CASE WHEN STORE = 'store1' THEN PRICE ELSE NULL END) AS STORE1 , SUM(CASE WHEN STORE = 'store2' THEN PRICE ELSE NULL END) AS STORE2 , SUM(CASE WHEN STORE = 'store3' THEN PRICE ELSE NULL END) AS STORE3 FROM PRODUCTS AS P GROUP BY PRODUCT_ID"
65,Y,Y,"SELECT PRODUCT_ID ,SUM( IF (STORE = 'store1', PRICE, NULL)) AS STORE1 ,SUM( IF (STORE = 'store2' , PRICE , NULL)) AS STORE2 ,SUM( IF (STORE = 'store3' , PRICE , NULL)) AS STORE3 FROM PRODUCTS GROUP BY 1 ORDER BY 1"
66,Y,Y,"SELECT PRODUCT_ID ,AVG(CASE WHEN STORE = 'store1' THEN PRICE END) AS STORE1 ,AVG(CASE WHEN STORE = 'store2' THEN PRICE END) AS STORE2 ,AVG(CASE WHEN STORE = 'store3' THEN PRICE END) AS STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID"
67,Y,Y,"SELECT PRODUCT_ID AS PRODUCT_ID, MAX(CASE WHEN STORE = 'store1' THEN PRICE ELSE NULL END) AS STORE1, MAX(CASE WHEN STORE = 'store2' THEN PRICE ELSE NULL END) AS STORE2, MIN(CASE WHEN STORE = 'store3' THEN PRICE ELSE NULL END) AS STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID"
68,Y,Y,"SELECT PRODUCT_ID, MAX(CASE WHEN STORE = 'store1' THEN PRICE END) STORE1 , MAX(CASE WHEN STORE = 'store2' THEN PRICE END) STORE2 , MAX(CASE WHEN STORE = 'store3' THEN PRICE END) STORE3 FROM PRODUCTS GROUP BY 1 ORDER BY 1"
69,Y,Y,"SELECT PRODUCT_ID, AVG(CASE WHEN STORE = 'store1' THEN PRICE ELSE NULL END) STORE1, AVG(CASE WHEN STORE = 'store2' THEN PRICE ELSE NULL END) STORE2, AVG(CASE WHEN STORE = 'store3' THEN PRICE ELSE NULL END) STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID"
70,Y,Y,"SELECT PRODUCT_ID, CASE WHEN SUM(STORE1) = 0 THEN NULL ELSE SUM(STORE1) END AS STORE1, CASE WHEN SUM(STORE2) = 0 THEN NULL ELSE SUM(STORE2) END AS STORE2, CASE WHEN SUM(STORE3) = 0 THEN NULL ELSE SUM(STORE3) END AS STORE3 FROM (SELECT PRODUCT_ID, PRICE AS STORE1, 0 AS STORE2, 0 AS STORE3 FROM PRODUCTS WHERE STORE = 'store1' UNION ALL SELECT PRODUCT_ID, 0 AS STORE1, PRICE AS STORE2, 0 AS STORE3 FROM PRODUCTS WHERE STORE = 'store2' UNION ALL SELECT PRODUCT_ID, 0 AS STORE1, 0 AS STORE2, PRICE AS STORE3 FROM PRODUCTS WHERE STORE = 'store3') C GROUP BY PRODUCT_ID"
71,Y,Y,"SELECT PRODUCT_ID, MAX((CASE WHEN STORE ='store1'THEN PRICE END)) AS STORE1, MAX((CASE WHEN STORE ='store2'THEN PRICE END)) AS STORE2, MAX((CASE WHEN STORE ='store3'THEN PRICE END)) AS STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID"
72,Y,Y,"SELECT PRODUCT_ID, MAX(CASE WHEN STORE = 'store1' THEN PRICE ELSE NULL END) AS STORE1, MAX(CASE WHEN STORE = 'store2' THEN PRICE ELSE NULL END) AS STORE2, MAX(CASE WHEN STORE = 'store3' THEN PRICE ELSE NULL END) AS STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID ORDER BY PRODUCT_ID"
73,Y,Y,"SELECT PRODUCT_ID, MAX(CASE WHEN STORE = 'store1' THEN PRICE ELSE NULL END) STORE1, MAX(CASE WHEN STORE = 'store2' THEN PRICE ELSE NULL END) STORE2, MAX(CASE WHEN STORE = 'store3' THEN PRICE ELSE NULL END) STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID"
74,Y,Y,"SELECT PRODUCT_ID, MAX(IF(STORE='store1', PRICE, NULL)) STORE1, MAX(IF(STORE='store2', PRICE, NULL)) STORE2, MAX(IF(STORE='store3', PRICE, NULL)) STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID"
75,Y,Y,"SELECT PRODUCT_ID, MAX(STORE1) AS STORE1,MAX(STORE2) AS STORE2, MAX(STORE3) AS STORE3 FROM (SELECT PRODUCT_ID , CASE WHEN STORE = 'store1' THEN PRICE END AS STORE1, CASE WHEN STORE = 'store2' THEN PRICE END AS STORE2, CASE WHEN STORE = 'store3' THEN PRICE END AS STORE3 FROM PRODUCTS) Z GROUP BY PRODUCT_ID ORDER BY PRODUCT_ID"
76,Y,Y,"SELECT PRODUCT_ID, MIN(CASE WHEN STORE = 'store1' THEN PRICE ELSE NULL END) STORE1, MIN(CASE WHEN STORE = 'store2' THEN PRICE ELSE NULL END) STORE2, MIN(CASE WHEN STORE = 'store3' THEN PRICE ELSE NULL END) STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID"
77,Y,Y,"SELECT PRODUCT_ID, MIN(CASE WHEN STORE = 'store1' THEN PRICE END) AS STORE1, MAX(CASE WHEN STORE = 'store2' THEN PRICE END) AS STORE2, MAX(CASE WHEN STORE = 'store3' THEN PRICE END) AS STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID"
78,Y,Y,"SELECT PRODUCT_ID, MIN(CASE WHEN STORE='store1' THEN PRICE END) AS STORE1, MAX(CASE WHEN STORE='store2' THEN PRICE END) AS STORE2, MAX(CASE WHEN STORE='store3' THEN PRICE END) AS STORE3 FROM PRODUCTS GROUP BY 1"
79,Y,Y,"SELECT PRODUCT_ID, SUM(CASE STORE WHEN 'store1' THEN PRICE ELSE NULL END) AS STORE1, SUM(CASE STORE WHEN 'store2' THEN PRICE ELSE NULL END) AS STORE2, SUM(CASE STORE WHEN 'store3' THEN PRICE ELSE NULL END) AS STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID"
80,Y,Y,"SELECT PRODUCT_ID, SUM(CASE WHEN STORE = 'store1' THEN PRICE END) AS STORE1, SUM(CASE WHEN STORE = 'store2' THEN PRICE END) AS STORE2, SUM(CASE WHEN STORE = 'store3' THEN PRICE END) AS STORE3 FROM PRODUCTS GROUP BY 1 ORDER BY 1"
81,Y,Y,"SELECT PRODUCT_ID, SUM(CASE WHEN STORE='store1' THEN COALESCE(PRICE,0) END) AS STORE1, SUM(CASE WHEN STORE='store2' THEN COALESCE(PRICE,0) END) AS STORE2, SUM(CASE WHEN STORE='store3' THEN COALESCE(PRICE,0) END) AS STORE3 FROM PRODUCTS GROUP BY 1"
82,Y,Y,"SELECT PRODUCT_ID, SUM(CASE WHEN STORE='store1' THEN COALESCE(PRICE,NULL) END) AS STORE1 , SUM(CASE WHEN STORE='store2' THEN PRICE ELSE NULL END) AS STORE2 , SUM(CASE WHEN STORE='store3' THEN PRICE ELSE NULL END) AS STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID"
83,Y,Y,"SELECT PRODUCT_ID, SUM(CASE WHEN STORE='store1' THEN PRICE ELSE NULL END) AS STORE1, SUM(CASE WHEN STORE='store2' THEN PRICE ELSE NULL END) AS STORE2, SUM(CASE WHEN STORE='store3' THEN PRICE ELSE NULL END) AS STORE3 FROM PRODUCTS P GROUP BY PRODUCT_ID"
84,Y,Y,"SELECT PRODUCT_ID, SUM(CASE WHEN STORE='store1' THEN PRICE ELSE NULL END) STORE1,SUM(CASE WHEN STORE='store2' THEN PRICE ELSE NULL END) STORE2, SUM(CASE WHEN STORE='store3' THEN PRICE ELSE NULL END) STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID ORDER BY PRODUCT_ID"
85,Y,Y,"SELECT PRODUCT_ID, SUM(IF(STORE = 'store1', PRICE, NULL)) STORE1, SUM(IF(STORE = 'store2', PRICE, NULL)) STORE2, SUM(IF(STORE = 'store3', PRICE, NULL)) STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID"
86,Y,Y,"SELECT PRODUCT_ID, SUM(IF(STORE = 'store1', PRICE, NULL)) STORE1, SUM(IF(STORE = 'store2', PRICE, NULL)) STORE2, SUM(IF(STORE = 'store3', PRICE, NULL)) STORE3 FROM PRODUCTS GROUP BY 1"
87,Y,Y,"SELECT PRODUCT_ID, SUM(IF(STORE = 'store1', PRICE,NULL)) AS STORE1, SUM(IF(STORE = 'store2', PRICE,NULL)) AS STORE2, SUM(IF(STORE = 'store3', PRICE,NULL)) AS STORE3 FROM PRODUCTS GROUP BY 1"
88,Y,Y,"SELECT PRODUCT_ID, SUM(STORE1) AS STORE1, SUM(STORE2) AS STORE2, SUM(STORE3) AS STORE3 FROM (SELECT PRODUCTS.*, CASE WHEN STORE = 'store1' THEN PRICE END AS STORE1, CASE WHEN STORE = 'store2' THEN PRICE END AS STORE2, CASE WHEN STORE = 'store3' THEN PRICE END AS STORE3 FROM PRODUCTS) AS P_TEST GROUP BY PRODUCT_ID"
89,Y,Y,"SELECT PRODUCT_ID,SUM(STORE1) STORE1,SUM(STORE2) STORE2,SUM(STORE3) STORE3 FROM (SELECT PRODUCT_ID, CASE WHEN STORE = 'store1' THEN PRICE END AS STORE1, CASE WHEN STORE='store2' THEN PRICE END AS STORE2, CASE WHEN STORE='store3' THEN PRICE END AS STORE3 FROM PRODUCTS)A GROUP BY 1"
90,Y,Y,"SELECT S0.PRODUCT_ID, S1.PRICE STORE1, S2.PRICE STORE2, S3.PRICE STORE3 FROM (SELECT DISTINCT PRODUCT_ID FROM PRODUCTS) S0 LEFT JOIN PRODUCTS S1 ON S0.PRODUCT_ID = S1.PRODUCT_ID AND S1.STORE = 'store1' LEFT JOIN PRODUCTS S2 ON S0.PRODUCT_ID = S2.PRODUCT_ID AND S2.STORE = 'store2' LEFT JOIN PRODUCTS S3 ON S0.PRODUCT_ID = S3.PRODUCT_ID AND S3.STORE = 'store3'"
91,Y,Y,"WITH C AS ( SELECT DISTINCT PRODUCT_ID FROM PRODUCTS GROUP BY PRODUCT_ID) SELECT C.PRODUCT_ID, P1.PRICE AS STORE1, P2.PRICE AS STORE2, P3.PRICE AS STORE3 FROM C LEFT JOIN PRODUCTS P1 ON (C.PRODUCT_ID=P1.PRODUCT_ID AND P1.STORE='store1') LEFT JOIN PRODUCTS P2 ON (C.PRODUCT_ID=P2.PRODUCT_ID AND P2.STORE='store2') LEFT JOIN PRODUCTS P3 ON (C.PRODUCT_ID=P3.PRODUCT_ID AND P3.STORE='store3')"
92,Y,Y,"WITH CTE AS ( SELECT PRODUCT_ID, CASE WHEN STORE = 'store1' THEN PRICE ELSE IF(PRODUCT_ID IS NOT NULL,0,NULL) END AS STORE1, CASE WHEN STORE = 'store2' THEN PRICE ELSE IF(PRODUCT_ID IS NOT NULL,0,NULL)END AS STORE2, CASE WHEN STORE = 'store3' THEN PRICE ELSE IF(PRODUCT_ID IS NOT NULL,0,NULL) END AS STORE3 FROM PRODUCTS ) SELECT PRODUCT_ID , IF(SUM(STORE1) = 0,NULL,SUM(STORE1)) AS STORE1, IF(SUM(STORE2) = 0,NULL,SUM(STORE2)) AS STORE2, IF(SUM(STORE3) = 0 ,NULL,SUM(STORE3)) AS STORE3 FROM CTE GROUP BY PRODUCT_ID"
93,Y,Y,"WITH CTE AS ( SELECT DISTINCT PRODUCT_ID, CASE WHEN STORE='store1' THEN PRICE ELSE NULL END AS STORE1, CASE WHEN STORE='store2' THEN PRICE ELSE NULL END AS STORE2, CASE WHEN STORE='store3' THEN PRICE ELSE NULL END AS STORE3 FROM PRODUCTS) SELECT PRODUCT_ID, SUM(STORE1) STORE1, SUM(STORE2) STORE2, SUM(STORE3) STORE3 FROM CTE GROUP BY PRODUCT_ID"
94,Y,Y,"WITH T0 AS (SELECT DISTINCT PRODUCT_ID FROM PRODUCTS), T1 AS (SELECT PRODUCT_ID, PRICE AS PRICE1 FROM PRODUCTS WHERE STORE = 'store1'), T2 AS (SELECT PRODUCT_ID, PRICE AS PRICE2 FROM PRODUCTS WHERE STORE = 'store2'), T3 AS (SELECT PRODUCT_ID, PRICE AS PRICE3 FROM PRODUCTS WHERE STORE = 'store3') SELECT T0.PRODUCT_ID, T1.PRICE1 AS STORE1, T2.PRICE2 AS STORE2, T3.PRICE3 AS STORE3 FROM T0 LEFT JOIN T1 ON T0.PRODUCT_ID = T1.PRODUCT_ID LEFT JOIN T2 ON T0.PRODUCT_ID = T2.PRODUCT_ID LEFT JOIN T3 ON T0.PRODUCT_ID = T3.PRODUCT_ID ORDER BY T0.PRODUCT_ID"
95,Y,Y,"WITH T0 AS (SELECT DISTINCT PRODUCT_ID FROM PRODUCTS), T1 AS (SELECT PRODUCT_ID, PRICE AS STORE1 FROM PRODUCTS WHERE STORE = 'store1'), T2 AS (SELECT PRODUCT_ID, PRICE AS STORE2 FROM PRODUCTS WHERE STORE = 'store2'), T3 AS (SELECT PRODUCT_ID, PRICE AS STORE3 FROM PRODUCTS WHERE STORE = 'store3') SELECT T0.PRODUCT_ID, STORE1, STORE2, STORE3 FROM T0 LEFT JOIN T1 USING (PRODUCT_ID) LEFT JOIN T2 USING (PRODUCT_ID) LEFT JOIN T3 USING (PRODUCT_ID)"
96,N,N,"WITH T1 AS(SELECT PRODUCT_ID, SUM(PRICE)AS STORE1 FROM PRODUCTS WHERE STORE='store1' GROUP BY 1), T2 AS (SELECT PRODUCT_ID, SUM(PRICE)AS STORE2 FROM PRODUCTS WHERE STORE='store2' GROUP BY 1), T3 AS (SELECT PRODUCT_ID, SUM(PRICE)AS STORE3 FROM PRODUCTS WHERE STORE='store3' GROUP BY 1), T4 AS (SELECT DISTINCT PRODUCT_ID FROM T1 UNION ALL SELECT DISTINCT PRODUCT_ID FROM T2 UNION ALL SELECT DISTINCT PRODUCT_ID FROM T3) SELECT DISTINCT PRODUCT_ID,STORE1,STORE2,STORE3 FROM T4 LEFT JOIN T1 USING (PRODUCT_ID) LEFT JOIN T2 USING (PRODUCT_ID) LEFT JOIN T3 USING (PRODUCT_ID) GROUP BY 1"
97,Y,Y,"WITH TEMP AS(SELECT PRODUCT_ID, CASE WHEN STORE = 'store1' THEN PRICE ELSE NULL END AS STORE1, CASE WHEN STORE = 'store2' THEN PRICE ELSE NULL END AS STORE2, CASE WHEN STORE = 'store3' THEN PRICE ELSE NULL END AS STORE3 FROM PRODUCTS) SELECT PRODUCT_ID, SUM(STORE1) AS STORE1, SUM(STORE2) AS STORE2, SUM(STORE3) AS STORE3 FROM TEMP GROUP BY PRODUCT_ID"
98,Y,Y,"WITH TMP AS (SELECT PRODUCT_ID, CASE WHEN STORE='store1' THEN PRICE ELSE NULL END STORE1, CASE WHEN STORE='store2' THEN PRICE ELSE NULL END STORE2, CASE WHEN STORE='store3' THEN PRICE ELSE NULL END STORE3 FROM PRODUCTS) SELECT PRODUCT_ID, SUM(STORE1) STORE1, SUM(STORE2) STORE2, SUM(STORE3) STORE3 FROM TMP GROUP BY PRODUCT_ID"
99,Y,Y,"SELECT PRODUCT_ID, MAX(STORE1) AS STORE1, MAX(STORE2) AS STORE2, MAX(STORE3) AS STORE3 FROM ( SELECT PRODUCT_ID, CASE WHEN STORE = 'store1' THEN PRICE END AS STORE1, CASE WHEN STORE = 'store2' THEN PRICE END AS STORE2, CASE WHEN STORE = 'store3' THEN PRICE END AS STORE3 FROM PRODUCTS ) A GROUP BY 1"
100,Y,Y,"SELECT P.PRODUCT_ID, STORE1, STORE2, STORE3 FROM ( SELECT DISTINCT PRODUCT_ID FROM PRODUCTS) P LEFT JOIN (SELECT PRODUCT_ID, PRICE AS STORE1 FROM PRODUCTS WHERE STORE LIKE STORE1 ) S1 ON P.PRODUCT_ID=S1.PRODUCT_ID LEFT JOIN (SELECT PRODUCT_ID, PRICE AS STORE2 FROM PRODUCTS WHERE STORE LIKE STORE2 ) S2 ON P.PRODUCT_ID=S2.PRODUCT_ID LEFT JOIN (SELECT PRODUCT_ID, PRICE AS STORE3 FROM PRODUCTS WHERE STORE LIKE STORE3 ) S3 ON P.PRODUCT_ID=S3.PRODUCT_ID"
101,Y,Y,"SELECT DISTINCT PRODUCT_ID , SUM(CASE WHEN STORE = 'store1' THEN PRICE ELSE NULL END) STORE1 , SUM(CASE WHEN STORE = 'store2' THEN PRICE ELSE NULL END) STORE2 , SUM(CASE WHEN STORE = 'store3' THEN PRICE ELSE NULL END) STORE3 FROM PRODUCTS GROUP BY 1"
102,Y,Y,"WITH CTE AS (SELECT DISTINCT(PRODUCT_ID) FROM PRODUCTS), TABLE_1 AS (SELECT PRODUCT_ID, PRICE FROM PRODUCTS WHERE STORE = 'store1'), TABLE_2 AS (SELECT PRODUCT_ID, PRICE FROM PRODUCTS WHERE STORE = 'store2'), TABLE_3 AS (SELECT PRODUCT_ID, PRICE FROM PRODUCTS WHERE STORE = 'store3') SELECT CTE.PRODUCT_ID, TABLE_1.PRICE AS STORE1 , TABLE_2.PRICE AS STORE2 , TABLE_3.PRICE AS STORE3 FROM CTE LEFT JOIN TABLE_1 ON CTE.PRODUCT_ID = TABLE_1.PRODUCT_ID LEFT JOIN TABLE_2 ON CTE.PRODUCT_ID = TABLE_2.PRODUCT_ID LEFT JOIN TABLE_3 ON CTE.PRODUCT_ID = TABLE_3.PRODUCT_ID"
103,Y,Y,"SELECT DISTINCT(P.PRODUCT_ID) AS PRODUCT_ID, P1.PRICE AS STORE1, P2.PRICE AS STORE2, P3.PRICE AS STORE3 FROM PRODUCTS P LEFT JOIN PRODUCTS P1 ON P.PRODUCT_ID = P1.PRODUCT_ID AND P1.STORE = 'store1' LEFT JOIN PRODUCTS P2 ON P.PRODUCT_ID = P2.PRODUCT_ID AND P2.STORE = 'store2' LEFT JOIN PRODUCTS P3 ON P.PRODUCT_ID = P3.PRODUCT_ID AND P3.STORE = 'store3'"
104,Y,Y,"SELECT PRODUCT_ID, SUM(IF(STORE LIKE STORE1 , PRICE, NULL)) AS STORE1, SUM(IF(STORE LIKE STORE2 , PRICE, NULL)) AS STORE2, SUM(IF(STORE LIKE STORE3 , PRICE, NULL)) AS STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID"
105,Y,Y,"SELECT PRODUCT_ID, COALESCE(MAX(CASE WHEN STORE = 'store1' THEN PRICE END), NULL) STORE1, COALESCE(MAX(CASE WHEN STORE = 'store2' THEN PRICE END), NULL) STORE2, COALESCE(MAX(CASE WHEN STORE = 'store3' THEN PRICE END), NULL) STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID"
106,Y,Y,"SELECT DISTINCT P.PRODUCT_ID, S1.STORE1, S2.STORE2, S3.STORE3 FROM PRODUCTS AS P LEFT JOIN (SELECT PRODUCT_ID, PRICE AS STORE1 FROM PRODUCTS WHERE STORE='store1')AS S1 ON P.PRODUCT_ID=S1.PRODUCT_ID LEFT JOIN (SELECT PRODUCT_ID, PRICE AS STORE2 FROM PRODUCTS WHERE STORE='store2')AS S2 ON P.PRODUCT_ID=S2.PRODUCT_ID LEFT JOIN (SELECT PRODUCT_ID, PRICE AS STORE3 FROM PRODUCTS WHERE STORE='store3')AS S3 ON P.PRODUCT_ID=S3.PRODUCT_ID"
107,Y,Y,"WITH STORE1 AS ( SELECT * FROM PRODUCTS WHERE STORE = 'store1' ), STORE2 AS ( SELECT * FROM PRODUCTS WHERE STORE = 'store2' ), STORE3 AS ( SELECT * FROM PRODUCTS WHERE STORE = 'store3' ), DISTINCTPRODUCTIDS AS ( SELECT DISTINCT PRODUCT_ID FROM PRODUCTS ) SELECT P.PRODUCT_ID, S1.PRICE AS STORE1, S2.PRICE AS STORE2, S3.PRICE AS STORE3 FROM DISTINCTPRODUCTIDS AS P LEFT JOIN STORE1 AS S1 USING (PRODUCT_ID) LEFT JOIN STORE2 AS S2 USING (PRODUCT_ID) LEFT JOIN STORE3 AS S3 USING (PRODUCT_ID)"
108,Y,Y,"WITH PRODUCTZ AS ( SELECT DISTINCT(PRODUCT_ID) PRODUCT_ID FROM PRODUCTS ) SELECT P.PRODUCT_ID, S1.PRICE STORE1, S2.PRICE STORE2, S3.PRICE STORE3 FROM PRODUCTZ P LEFT JOIN PRODUCTS S1 ON S1.STORE = 'store1' AND S1.PRODUCT_ID = P.PRODUCT_ID LEFT JOIN PRODUCTS S2 ON S2.STORE = 'store2' AND S2.PRODUCT_ID = P.PRODUCT_ID LEFT JOIN PRODUCTS S3 ON S3.STORE = 'store3' AND S3.PRODUCT_ID = P.PRODUCT_ID"
109,Y,Y,"SELECT DISTINCT PRODUCT_ID, SUM(CASE WHEN STORE='store1' THEN IFNULL(PRICE,0) END) AS STORE1 , SUM(CASE WHEN STORE='store2' THEN IFNULL(PRICE,0) END) AS STORE2 , SUM(CASE WHEN STORE='store3' THEN IFNULL(PRICE,0) END) AS STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID"
110,Y,Y,"WITH CTE AS ( SELECT PRODUCT_ID, SUM(CASE WHEN STORE = 'store1' THEN PRICE END) AS STORE1, SUM(CASE WHEN STORE = 'store2' THEN PRICE END) AS STORE2, SUM(CASE WHEN STORE = 'store3' THEN PRICE END) AS STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID ) SELECT * FROM CTE"
111,Y,Y,"WITH STORE1 AS ( SELECT PRODUCT_ID, PRICE AS STORE1 FROM PRODUCTS WHERE STORE = 'store1' ), STORE2 AS ( SELECT PRODUCT_ID, PRICE AS STORE2 FROM PRODUCTS WHERE STORE = 'store2' ), STORE3 AS ( SELECT PRODUCT_ID, PRICE AS STORE3 FROM PRODUCTS WHERE STORE = 'store3' ) SELECT T.PRODUCT_ID, STORE1, STORE2, STORE3 FROM (SELECT DISTINCT PRODUCT_ID FROM PRODUCTS) T LEFT JOIN STORE1 S1 ON T.PRODUCT_ID = S1.PRODUCT_ID LEFT JOIN STORE2 S2 ON T.PRODUCT_ID = S2.PRODUCT_ID LEFT JOIN STORE3 S3 ON T.PRODUCT_ID = S3.PRODUCT_ID"
112,Y,Y,"SELECT PRODUCT_ID, SUM(CASE WHEN STORE = 'store1' THEN PRICE ELSE NULL END) STORE1 , SUM(CASE WHEN STORE = 'store2' THEN PRICE ELSE NULL END) AS STORE2 , SUM(CASE WHEN STORE = 'store3' THEN PRICE ELSE NULL END) AS STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID"
113,Y,Y,"WITH TMP1 AS (SELECT PRODUCT_ID, PRICE AS STORE1 FROM PRODUCTS WHERE STORE = 'store1'), TMP2 AS (SELECT PRODUCT_ID, PRICE AS STORE2 FROM PRODUCTS WHERE STORE = 'store2'), TMP3 AS (SELECT PRODUCT_ID, PRICE AS STORE3 FROM PRODUCTS WHERE STORE = 'store3') SELECT DISTINCT(A.PRODUCT_ID), B.STORE1, C.STORE2, D.STORE3 FROM PRODUCTS A LEFT JOIN TMP1 B ON A.PRODUCT_ID = B.PRODUCT_ID LEFT JOIN TMP2 C ON A.PRODUCT_ID = C.PRODUCT_ID LEFT JOIN TMP3 D ON A.PRODUCT_ID = D.PRODUCT_ID"
114,Y,Y,"SELECT A.PRODUCT_ID, SUM(CASE WHEN A.STORE='store1' THEN A.PRICE END) AS STORE1, SUM(CASE WHEN A.STORE='store2' THEN A.PRICE END )AS STORE2, SUM(CASE WHEN A.STORE='store3' THEN A.PRICE END) AS STORE3 FROM PRODUCTS A GROUP BY A.PRODUCT_ID"
115,Y,Y,"WITH CTE_PROD AS ( SELECT DISTINCT PRODUCT_ID FROM PRODUCTS ), CTE_STORE1 AS ( SELECT PRODUCT_ID, STORE, PRICE FROM PRODUCTS WHERE STORE = 'store1' ), CTE_STORE2 AS ( SELECT PRODUCT_ID, STORE, PRICE FROM PRODUCTS WHERE STORE = 'store2' ), CTE_STORE3 AS ( SELECT PRODUCT_ID, STORE, PRICE FROM PRODUCTS WHERE STORE = 'store3' ) SELECT A.PRODUCT_ID, B.PRICE AS STORE1, C.PRICE AS STORE2, D.PRICE AS STORE3 FROM CTE_PROD A LEFT JOIN CTE_STORE1 B ON A.PRODUCT_ID = B.PRODUCT_ID LEFT JOIN CTE_STORE2 C ON A.PRODUCT_ID = C.PRODUCT_ID LEFT JOIN CTE_STORE3 D ON A.PRODUCT_ID = D.PRODUCT_ID"
116,Y,Y,"SELECT PRODUCT_ID, MIN(CASE WHEN STORE ='store1' THEN PRICE ELSE NULL END ) AS STORE1, MIN(CASE WHEN STORE ='store2'THEN PRICE ELSE NULL END ) AS STORE2, MIN(CASE WHEN STORE = 'store3' THEN PRICE ELSE NULL END) AS STORE3 FROM PRODUCTS GROUP BY 1"
117,Y,Y,"SELECT PRODUCT_ID, AVG(IF(STORE='store1', PRICE, NULL)) AS STORE1, MIN(IF(STORE='store2', PRICE, NULL)) AS STORE2, SUM(IF(STORE='store3', PRICE, NULL)) AS STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID"
118,Y,Y,"SELECT R.PRODUCT_ID, SUM(R.STORE1) AS STORE1, SUM(R.STORE2) AS STORE2, SUM(R.STORE3) AS STORE3 FROM (SELECT PRODUCT_ID, CASE WHEN STORE = 'store1' THEN PRICE END AS STORE1, CASE WHEN STORE = 'store2' THEN PRICE END AS STORE2, CASE WHEN STORE = 'store3' THEN PRICE END AS STORE3 FROM PRODUCTS) R GROUP BY PRODUCT_ID"
119,Y,Y,"WITH S1 AS ( SELECT PRODUCT_ID, PRICE AS STORE1 FROM PRODUCTS WHERE STORE = 'store1' ), S2 AS ( SELECT PRODUCT_ID, PRICE AS STORE2 FROM PRODUCTS WHERE STORE = 'store2' ), S3 AS ( SELECT PRODUCT_ID, PRICE AS STORE3 FROM PRODUCTS WHERE STORE = 'store3' ), COLTAB AS ( SELECT DISTINCT PRODUCT_ID FROM PRODUCTS ), TEMP1 AS ( SELECT COLTAB.*, S1.STORE1 FROM COLTAB LEFT OUTER JOIN S1 ON COLTAB.PRODUCT_ID = S1.PRODUCT_ID ), TEMP2 AS ( SELECT TEMP1.*, S2.STORE2 FROM TEMP1 LEFT OUTER JOIN S2 ON TEMP1.PRODUCT_ID = S2.PRODUCT_ID ), TEMP3 AS ( SELECT TEMP2.*, S3.STORE3 FROM TEMP2 LEFT OUTER JOIN S3 ON TEMP2.PRODUCT_ID = S3.PRODUCT_ID ) SELECT * FROM TEMP3"
120,Y,Y,"WITH T0 AS (SELECT *, CASE WHEN STORE = 'store1' THEN PRICE ELSE NULL END AS STORE1, CASE WHEN STORE = 'store2' THEN PRICE ELSE NULL END AS STORE2, CASE WHEN STORE = 'store3' THEN PRICE ELSE NULL END AS STORE3 FROM PRODUCTS) SELECT PRODUCT_ID, SUM(STORE1) AS STORE1, SUM(STORE2) AS STORE2, SUM(STORE3) AS STORE3 FROM T0 GROUP BY PRODUCT_ID"
121,Y,Y,"SELECT PRODUCT_ID, ROUND(AVG(CASE WHEN STORE = 'store1' THEN PRICE END), 0) AS STORE1, ROUND(AVG(CASE WHEN STORE = 'store2' THEN PRICE END), 0) AS STORE2, ROUND(AVG(CASE WHEN STORE = 'store3' THEN PRICE END), 0) AS STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID"
122,Y,Y,"SELECT PRODUCT_ID, MIN(CASE WHEN STORE='store1' THEN PRICE ELSE NULL END) AS STORE1, MIN(CASE WHEN STORE='store2' THEN PRICE ELSE NULL END) AS STORE2, MIN(CASE WHEN STORE='store3' THEN PRICE ELSE NULL END) AS STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID"
123,Y,Y,"SELECT DISTINCT P.PRODUCT_ID, STORE1, STORE2, STORE3 FROM PRODUCTS P LEFT JOIN (SELECT PRODUCT_ID, PRICE AS STORE1 FROM PRODUCTS WHERE STORE = 'store1') S1 USING (PRODUCT_ID) LEFT JOIN (SELECT PRODUCT_ID, PRICE AS STORE2 FROM PRODUCTS WHERE STORE = 'store2') S2 USING (PRODUCT_ID) LEFT JOIN (SELECT PRODUCT_ID, PRICE AS STORE3 FROM PRODUCTS WHERE STORE = 'store3') S3 USING (PRODUCT_ID)"
124,Y,Y,"SELECT DISTINCT P.PRODUCT_ID, A.AP AS STORE1, B.AP AS STORE2, C.AP AS STORE3 FROM PRODUCTS P LEFT JOIN (SELECT PRODUCT_ID, STORE, AVG(PRICE) AP FROM PRODUCTS WHERE STORE='store1' GROUP BY PRODUCT_ID, STORE) A ON P.PRODUCT_ID = A.PRODUCT_ID LEFT JOIN (SELECT PRODUCT_ID, STORE, AVG(PRICE) AP FROM PRODUCTS WHERE STORE='store2' GROUP BY PRODUCT_ID, STORE) B ON P.PRODUCT_ID = B.PRODUCT_ID LEFT JOIN (SELECT PRODUCT_ID, STORE, AVG(PRICE) AP FROM PRODUCTS WHERE STORE='store3' GROUP BY PRODUCT_ID, STORE) C ON P.PRODUCT_ID = C.PRODUCT_ID"
125,Y,Y,"SELECT PRODUCT_ID, SUM(STORE1) AS STORE1, SUM(STORE2) AS STORE2, SUM(STORE3) AS STORE3 FROM (SELECT PRODUCT_ID, CASE WHEN STORE = 'store1' THEN PRICE ELSE NULL END AS STORE1, CASE WHEN STORE = 'store2' THEN PRICE ELSE NULL END AS STORE2, CASE WHEN STORE = 'store3' THEN PRICE ELSE NULL END AS STORE3 FROM PRODUCTS) X GROUP BY PRODUCT_ID"
126,Y,Y,"SELECT PRODUCT_ID,SUM(STORE1) AS STORE1,SUM(STORE2) AS STORE2,SUM(STORE3) AS STORE3 FROM ( SELECT PRODUCT_ID, CASE WHEN STORE='store1' THEN PRICE ELSE NULL END AS STORE1, CASE WHEN STORE='store2' THEN PRICE ELSE NULL END AS STORE2, CASE WHEN STORE='store3' THEN PRICE ELSE NULL END AS STORE3 FROM PRODUCTS ) AS A GROUP BY PRODUCT_ID"
127,Y,Y,"SELECT DISTINCT PRODUCT_ID, MAX( CASE WHEN(STORE='store1') THEN PRICE END) AS STORE1, MAX( CASE WHEN(STORE='store2') THEN PRICE END) AS STORE2, MAX(CASE WHEN(STORE='store3') THEN PRICE END) AS STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID"
128,Y,Y,"SELECT PRODUCT_ID, SUM((CASE WHEN STORE = 'store1' THEN PRICE END)) AS STORE1, SUM((CASE WHEN STORE = 'store2' THEN PRICE END)) AS STORE2, SUM((CASE WHEN STORE = 'store3' THEN PRICE END)) AS STORE3 FROM PRODUCTS GROUP BY 1"
129,Y,Y,"WITH TMP AS (SELECT *, IF(STORE = 'store1', PRICE, NULL) STORE1, IF(STORE = 'store2', PRICE, NULL) STORE2, IF(STORE = 'store3', PRICE, NULL) STORE3 FROM PRODUCTS) SELECT PRODUCT_ID, SUM(STORE1) STORE1, SUM(STORE2) STORE2, SUM(STORE3) STORE3 FROM TMP GROUP BY PRODUCT_ID"
130,Y,Y,"SELECT PRODUCT_ID, SUM(IF(STORE='store1', PRICE, NULL)) AS STORE1, SUM(IF(STORE='store2', PRICE, NULL)) AS STORE2, SUM(IF(STORE='store3', PRICE, NULL)) AS STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID ORDER BY PRODUCT_ID"
131,Y,Y,"SELECT PRODUCT_ID, SUM(CASE WHEN STORE = 'store1' THEN PRICE END) AS STORE1, SUM(CASE WHEN STORE = 'store2' THEN PRICE END) AS STORE2, SUM(CASE WHEN STORE = 'store3' THEN PRICE END) AS STORE3 FROM PRODUCTS P1 GROUP BY PRODUCT_ID"
132,Y,Y,"SELECT PRODUCT_ID, ROUND(AVG(CASE WHEN STORE='store1' THEN PRICE END),0) AS STORE1, ROUND(AVG(CASE WHEN STORE='store2' THEN PRICE END),0) AS STORE2, ROUND(AVG(CASE WHEN STORE='store3' THEN PRICE END),0) AS STORE3 FROM PRODUCTS GROUP BY 1"
133,Y,Y,"SELECT PRODUCT_ID,MAX(CASE WHEN STORE='store1' THEN PRICE END) STORE1, MAX(CASE WHEN STORE='store2' THEN PRICE END) STORE2, MAX(CASE WHEN STORE='store3' THEN PRICE END) STORE3 FROM PRODUCTS GROUP BY 1"
134,Y,Y,"SELECT PRODUCT_ID, SUM(CASE WHEN STORE='store1' THEN PRICE END ) STORE1, SUM(CASE WHEN STORE='store2' THEN PRICE END ) STORE2, SUM(CASE WHEN STORE='store3' THEN PRICE END ) STORE3 FROM PRODUCTS GROUP BY 1 ORDER BY 1"
135,Y,Y,"SELECT PRODUCT_ID, SUM(CASE WHEN STORE = 'store1' THEN PRICE END) STORE1, SUM(CASE WHEN STORE = 'store2' THEN PRICE END) STORE2, SUM(CASE WHEN STORE = 'store3' THEN PRICE END) STORE3 FROM PRODUCTS GROUP BY 1"
136,Y,Y,"SELECT PRODUCT_ID, SUM(STORE1) STORE1, SUM(STORE2) STORE2, SUM(STORE3) STORE3 FROM( SELECT PRODUCT_ID, CASE WHEN STORE='store1' THEN PRICE ELSE NULL END AS STORE1, CASE WHEN STORE='store2' THEN PRICE ELSE NULL END AS STORE2, CASE WHEN STORE='store3' THEN PRICE ELSE NULL END AS STORE3 FROM PRODUCTS ) T GROUP BY PRODUCT_ID"
137,Y,Y,"WITH CTE AS ( SELECT DISTINCT PRODUCT_ID FROM PRODUCTS ) SELECT CTE.PRODUCT_ID, A.PRICE AS STORE1 , B.PRICE AS STORE2 , C.PRICE AS STORE3 FROM CTE LEFT JOIN PRODUCTS AS A ON CTE.PRODUCT_ID = A.PRODUCT_ID AND A.STORE = 'store1' LEFT JOIN PRODUCTS AS B ON CTE.PRODUCT_ID = B.PRODUCT_ID AND B.STORE = 'store2' LEFT JOIN PRODUCTS AS C ON CTE.PRODUCT_ID = C.PRODUCT_ID AND C.STORE = 'store3'"
138,Y,Y,"SELECT PRODUCT_ID, AVG(CASE WHEN STORE = 'store1' THEN PRICE ELSE NULL END ) AS STORE1, AVG(CASE WHEN STORE = 'store2' THEN PRICE ELSE NULL END ) AS STORE2, AVG(CASE WHEN STORE = 'store3' THEN PRICE ELSE NULL END ) AS STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID"
139,Y,Y,"SELECT PRODUCT_ID, MAX(CASE WHEN STORE = 'store1' THEN PRICE END) AS STORE1, MAX(CASE WHEN STORE = 'store2' THEN PRICE END) AS STORE2, MAX(CASE WHEN STORE = 'store3' THEN PRICE END) AS STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID ORDER BY PRODUCT_ID"
140,Y,Y,"SELECT PRODUCT_ID , SUM(CASE WHEN (PRODUCT_ID,STORE) IN (SELECT PRODUCT_ID,STORE FROM PRODUCTS WHERE STORE = 'store1') THEN PRICE END) AS STORE1 , SUM(CASE WHEN (PRODUCT_ID,STORE) IN (SELECT PRODUCT_ID,STORE FROM PRODUCTS WHERE STORE = 'store2') THEN PRICE END) AS STORE2 , SUM(CASE WHEN (PRODUCT_ID,STORE) IN (SELECT PRODUCT_ID,STORE FROM PRODUCTS WHERE STORE = 'store3') THEN PRICE END) AS STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID"
141,Y,Y,"SELECT DISTINCT PRODUCT_ID, SUM(CASE WHEN STORE='store1' THEN PRICE END) AS STORE1, SUM(CASE WHEN STORE='store2' THEN PRICE END) AS STORE2, SUM(CASE WHEN STORE='store3' THEN PRICE END) AS STORE3 FROM PRODUCTS GROUP BY 1"
142,Y,Y,"SELECT PRODUCT_ID, AVG(CASE WHEN STORE='store1' THEN PRICE END) STORE1, AVG(CASE WHEN STORE='store2' THEN PRICE END) STORE2, AVG(CASE WHEN STORE='store3' THEN PRICE END) STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID"
143,Y,Y,"SELECT PRODUCT_ID,MAX(STORE1) STORE1,MAX(STORE2) STORE2,MAX(STORE3) STORE3 FROM ( SELECT PRODUCT_ID,PRICE AS STORE1,NULL AS STORE2, NULL AS STORE3 FROM PRODUCTS WHERE STORE ='store1' UNION ALL SELECT PRODUCT_ID,NULL AS STORE1,PRICE AS STORE2, NULL AS STORE3 FROM PRODUCTS WHERE STORE ='store2' UNION ALL SELECT PRODUCT_ID,NULL AS STORE1,NULL AS STORE2, PRICE AS STORE3 FROM PRODUCTS WHERE STORE ='store3' )T GROUP BY 1"
144,Y,Y,"SELECT PRODUCT_ID, MAX(IF(STORE='store1', PRICE, NULL)) AS STORE1, MIN(IF(STORE='store2', PRICE, NULL)) AS STORE2, SUM(IF(STORE='store3', PRICE, NULL)) AS STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID"
145,Y,Y,"WITH CTE1 AS (SELECT PRODUCT_ID, CASE WHEN STORE = 'store1' THEN PRICE ELSE NULL END AS STORE1, CASE WHEN STORE = 'store2' THEN PRICE ELSE NULL END AS STORE2, CASE WHEN STORE = 'store3' THEN PRICE ELSE NULL END AS STORE3 FROM PRODUCTS) SELECT PRODUCT_ID, MAX(STORE1) AS STORE1, MAX(STORE2) AS STORE2, MAX(STORE3) AS STORE3 FROM CTE1 GROUP BY PRODUCT_ID"
146,Y,Y,"SELECT PRODUCT_ID , SUM(CASE WHEN (PRICE,STORE) IN (SELECT PRICE,STORE FROM PRODUCTS WHERE STORE = 'store1') THEN PRICE END) AS STORE1 ,SUM(CASE WHEN (PRICE,STORE) IN (SELECT PRICE,STORE FROM PRODUCTS WHERE STORE = 'store2') THEN PRICE END) AS STORE2 ,SUM(CASE WHEN (PRICE,STORE) IN (SELECT PRICE,STORE FROM PRODUCTS WHERE STORE = 'store3') THEN PRICE END) AS STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID"
147,Y,Y,"SELECT PRODUCT_ID, MAX(CASE WHEN PRODUCTS.STORE = 'store1' THEN PRODUCTS.PRICE END) STORE1, MAX(CASE WHEN PRODUCTS.STORE = 'store2' THEN PRODUCTS.PRICE END) STORE2, MAX(CASE WHEN PRODUCTS.STORE = 'store3' THEN PRODUCTS.PRICE END) STORE3 FROM PRODUCTS GROUP BY PRODUCTS.PRODUCT_ID"
148,Y,Y,"SELECT DISTINCT P1.PRODUCT_ID, P2.PRICE STORE1, P3.PRICE STORE2, P4.PRICE STORE3 FROM PRODUCTS P1 LEFT JOIN PRODUCTS P2 ON P1.PRODUCT_ID=P2.PRODUCT_ID AND P2.STORE='store1' LEFT JOIN PRODUCTS P3 ON P1.PRODUCT_ID=P3.PRODUCT_ID AND P3.STORE='store2' LEFT JOIN PRODUCTS P4 ON P1.PRODUCT_ID=P4.PRODUCT_ID AND P4.STORE='store3'"
149,Y,Y,"SELECT PRODUCT_ID, SUM(CASE WHEN STORE='store1' THEN PRICE END) AS STORE1 , SUM(CASE WHEN STORE='store2' THEN PRICE END) AS STORE2 , SUM(CASE WHEN STORE='store3' THEN PRICE END) AS STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID ORDER BY PRODUCT_ID"
150,Y,Y,"SELECT PRODUCT_ID,NULLIF(SUM(CASE WHEN STORE='store1' THEN PRICE ELSE 0 END),0) AS STORE1, NULLIF(SUM(CASE WHEN STORE='store2' THEN PRICE ELSE 0 END),0) AS STORE2, NULLIF(SUM(CASE WHEN STORE='store3' THEN PRICE ELSE 0 END),0) AS STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID"
151,Y,Y,"SELECT PRODUCT_ID, MAX(CASE WHEN STORE = 'store1' THEN PRICE END) AS STORE1, MAX(CASE WHEN STORE = 'store2' THEN PRICE END) AS STORE2, MAX(CASE WHEN STORE = 'store3' THEN PRICE END) AS STORE3 FROM PRODUCTS GROUP BY 1 ORDER BY NULL"
152,Y,Y,"SELECT PRODUCT_ID, (SELECT P.PRICE FROM PRODUCTS P WHERE P.PRODUCT_ID = P2.PRODUCT_ID AND P.STORE='store1' LIMIT 1) AS STORE1,(SELECT P.PRICE FROM PRODUCTS P WHERE P.PRODUCT_ID = P2.PRODUCT_ID AND P.STORE='store2' LIMIT 1) AS STORE2, (SELECT P.PRICE FROM PRODUCTS P WHERE P.PRODUCT_ID = P2.PRODUCT_ID AND P.STORE='store3' LIMIT 1) AS STORE3 FROM PRODUCTS P2 GROUP BY PRODUCT_ID"
153,Y,Y,"WITH T AS (SELECT PRODUCT_ID, CASE WHEN STORE = 'store1' THEN PRICE END AS STORE1, CASE WHEN STORE = 'store2' THEN PRICE END AS STORE2, CASE WHEN STORE = 'store3' THEN PRICE END AS STORE3 FROM PRODUCTS) SELECT PRODUCT_ID, SUM(STORE1) AS STORE1, SUM(STORE2) AS STORE2, SUM(STORE3) AS STORE3 FROM T GROUP BY PRODUCT_ID"
154,Y,Y,"SELECT PRODUCTS.PRODUCT_ID, MAX(CASE WHEN PRODUCTS.STORE = 'store1' THEN PRODUCTS.PRICE END) STORE1, MAX(CASE WHEN PRODUCTS.STORE = 'store2' THEN PRODUCTS.PRICE END) STORE2, MAX(CASE WHEN PRODUCTS.STORE = 'store3' THEN PRODUCTS.PRICE END) STORE3 FROM PRODUCTS GROUP BY PRODUCTS.PRODUCT_ID"
155,Y,Y,"SELECT PRODUCT_ID, MAX(CASE WHEN STORE = 'store1' THEN PRICE ELSE NULL END) AS STORE1, MAX(CASE WHEN STORE = 'store2' THEN PRICE ELSE NULL END) AS STORE2, MAX(CASE WHEN STORE = 'store3' THEN PRICE ELSE NULL END) AS STORE3 FROM PRODUCTS GROUP BY 1 ORDER BY 1"
156,Y,Y,"SELECT PRODUCT_ID, MAX((CASE WHEN STORE = 'store1' THEN PRICE END)) AS STORE1, MAX(CASE WHEN STORE = 'store2' THEN PRICE END) AS STORE2, MAX(CASE WHEN STORE = 'store3' THEN PRICE END) AS STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID"
157,Y,Y,"SELECT PRODUCTS_TABLE.PRODUCT_ID, STORE1, STORE2, STORE3 FROM (SELECT PRODUCT_ID FROM PRODUCTS GROUP BY(PRODUCT_ID)) AS PRODUCTS_TABLE LEFT JOIN (SELECT PRODUCT_ID , PRICE AS STORE1 FROM PRODUCTS WHERE STORE='store1') AS A ON PRODUCTS_TABLE.PRODUCT_ID=A.PRODUCT_ID LEFT JOIN (SELECT PRODUCT_ID , PRICE AS STORE2 FROM PRODUCTS WHERE STORE='store2') AS B ON PRODUCTS_TABLE.PRODUCT_ID=B.PRODUCT_ID LEFT JOIN (SELECT PRODUCT_ID , PRICE AS STORE3 FROM PRODUCTS WHERE STORE='store3') AS C ON PRODUCTS_TABLE.PRODUCT_ID=C.PRODUCT_ID"
158,Y,Y,"WITH CTE AS (SELECT DISTINCT PRODUCT_ID, CASE WHEN STORE = 'store1' THEN PRICE ELSE NULL END AS STORE1, CASE WHEN STORE = 'store2' THEN PRICE ELSE NULL END AS STORE2, CASE WHEN STORE = 'store3' THEN PRICE ELSE NULL END AS STORE3 FROM PRODUCTS ) SELECT PRODUCT_ID, SUM(STORE1) AS STORE1, SUM(STORE2) AS STORE2, SUM(STORE3) AS STORE3 FROM CTE GROUP BY PRODUCT_ID"
159,Y,Y,"WITH T AS( SELECT PRODUCT_ID, CASE WHEN STORE='store1' THEN PRICE ELSE NULL END AS STORE1, CASE WHEN STORE='store2' THEN PRICE ELSE NULL END AS STORE2, CASE WHEN STORE='store3' THEN PRICE ELSE NULL END AS STORE3 FROM PRODUCTS ) SELECT PRODUCT_ID, SUM(STORE1) AS STORE1, SUM(STORE2) AS STORE2, SUM(STORE3) AS STORE3 FROM T GROUP BY PRODUCT_ID"
160,Y,Y,"SELECT T.PRODUCT_ID, T1.STORE1, T2.STORE2, T3.STORE3 FROM (SELECT DISTINCT PRODUCT_ID FROM PRODUCTS) T LEFT JOIN (SELECT PRODUCT_ID, PRICE AS STORE1 FROM PRODUCTS WHERE STORE = 'store1') T1 ON T.PRODUCT_ID = T1.PRODUCT_ID LEFT JOIN (SELECT PRODUCT_ID, PRICE AS STORE2 FROM PRODUCTS WHERE STORE = 'store2') T2 ON T.PRODUCT_ID = T2.PRODUCT_ID LEFT JOIN (SELECT PRODUCT_ID, PRICE AS STORE3 FROM PRODUCTS WHERE STORE = 'store3') T3 ON T.PRODUCT_ID = T3.PRODUCT_ID"
161,Y,Y,"SELECT PRODUCT_ID, MAX(DISTINCT CASE WHEN STORE = 'store1' THEN PRICE ELSE NULL END) AS STORE1, MAX(CASE WHEN STORE = 'store2' THEN PRICE ELSE NULL END) AS STORE2, MAX(CASE WHEN STORE = 'store3' THEN PRICE ELSE NULL END) AS STORE3 FROM PRODUCTS GROUP BY 1"
162,Y,Y,"WITH CTE1 AS ( SELECT P1.PRODUCT_ID, P1.PRICE AS STORE1 FROM PRODUCTS P1 WHERE P1.STORE = 'store1'), CTE2 AS ( SELECT P2.PRODUCT_ID, P2.PRICE AS STORE2 FROM PRODUCTS P2 WHERE P2.STORE = 'store2'), CTE3 AS ( SELECT P3.PRODUCT_ID, P3.PRICE AS STORE3 FROM PRODUCTS P3 WHERE P3.STORE = 'store3') SELECT DISTINCT P.PRODUCT_ID, CTE1.STORE1, CTE2.STORE2, CTE3.STORE3 FROM PRODUCTS P LEFT OUTER JOIN CTE1 ON P.PRODUCT_ID = CTE1.PRODUCT_ID LEFT OUTER JOIN CTE2 ON P.PRODUCT_ID = CTE2.PRODUCT_ID LEFT OUTER JOIN CTE3 ON P.PRODUCT_ID = CTE3.PRODUCT_ID"
163,Y,Y,"WITH IDS AS ( SELECT DISTINCT PRODUCT_ID FROM PRODUCTS ), STORE1 AS (SELECT PRODUCT_ID, PRICE AS STORE1 FROM PRODUCTS WHERE STORE = 'store1'), STORE2 AS (SELECT PRODUCT_ID, PRICE AS STORE2 FROM PRODUCTS WHERE STORE = 'store2'), STORE3 AS ( SELECT PRODUCT_ID, PRICE AS STORE3 FROM PRODUCTS WHERE STORE = 'store3' ) SELECT IDS.PRODUCT_ID, STORE1.STORE1, STORE2.STORE2, STORE3.STORE3 FROM IDS LEFT JOIN STORE1 ON IDS.PRODUCT_ID = STORE1.PRODUCT_ID LEFT JOIN STORE2 ON IDS.PRODUCT_ID = STORE2.PRODUCT_ID LEFT JOIN STORE3 ON IDS.PRODUCT_ID = STORE3.PRODUCT_ID"
164,Y,Y,"SELECT PRODUCT_ID, SUM(CASE WHEN STORE = 'store1' THEN PRICE ELSE NULL END) AS STORE1, SUM(CASE WHEN STORE = 'store2' THEN PRICE ELSE NULL END) AS STORE2, SUM(CASE WHEN STORE = 'store3' THEN PRICE ELSE NULL END) AS STORE3 FROM PRODUCTS GROUP BY PRODUCT_ID ORDER BY PRODUCT_ID ASC"
165,Y,Y,"SELECT PRODUCT_ID, SUM(CASE WHEN STORE = 'store1' THEN PRICE END ) AS STORE1, SUM(CASE WHEN STORE = 'store2' THEN PRICE END) AS STORE2, SUM(CASE WHEN STORE = 'store3' THEN PRICE END) AS STORE3 FROM PRODUCTS P GROUP BY 1"
